(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"/6Yf":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return s});var r=n("mrSG"),i=n("qOnz"),o=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),s=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.a;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(u){}try{for(var i=Object(r.g)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=Object(r.e)(o.value,2),a=s[1],c=this.normalizeInstanceIdentifier(s[0]);try{var l=this.getOrInitializeService({instanceIdentifier:c});a.resolve(l)}catch(u){}}}catch(h){t={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return Object(r.b)(this,void 0,void 0,function(){var e;return Object(r.d)(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Object(r.f)(Object(r.f)([],Object(r.e)(e.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))),Object(r.e)(e.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))))];case 1:return t.sent(),[2]}})})},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e="[DEFAULT]"),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e="[DEFAULT]"),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,o=void 0===i?{}:i,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:s,options:o});try{for(var c=Object(r.g)(this.instancesDeferred.entries()),l=c.next();!l.done;l=c.next()){var u=Object(r.e)(l.value,2),h=u[1];s===this.normalizeInstanceIdentifier(u[0])&&h.resolve(a)}}catch(d){t={error:d}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&e(o,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,o=this.onInitCallbacks.get(t);if(o)try{for(var s=Object(r.g)(o),a=s.next();!a.done;a=s.next()){var c=a.value;try{c(e,t)}catch(l){}}}catch(u){n={error:u}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,"[DEFAULT]"===t?void 0:t),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(s){}return o||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e="[DEFAULT]"),this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}(),a=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new s(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}()},0:function(e,t,n){e.exports=n("zUnb")},"2QA8":function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())()},"2fFW":function(e,t,n){"use strict";n.d(t,"a",function(){return i});let r=!1;const i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=e},get useDeprecatedSynchronousErrorHandling(){return r}}},"3N8a":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("quSY");class i extends r.a{constructor(e,t){super()}schedule(e,t=0){return this}}class o extends i{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n,r=!1;try{this.work(e)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n}_unsubscribe(){const e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}},"3UD+":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"5+tZ":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("lJxs"),i=n("Cfvw"),o=n("zx2A");function s(e,t,n=Number.POSITIVE_INFINITY){return"function"==typeof t?o=>o.pipe(s((n,o)=>Object(i.a)(e(n,o)).pipe(Object(r.a)((e,r)=>t(n,e,o,r))),n)):("number"==typeof t&&(n=t),t=>t.lift(new a(e,n)))}class a{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new c(e,this.project,this.concurrent))}}class c extends o.b{constructor(e,t,n=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new o.a(this),n=this.destination;n.add(t);const r=Object(o.c)(e,t);r!==t&&n.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},"6Uf2":function(e,t,n){"use strict";(function(e){var t=n("zIRd"),r=n("/6Yf"),i=n("qOnz"),o=n("mrSG"),s=n("q/0M"),a="";function c(e){a=e}var l,u=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(i.I)(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(i.C)(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),h=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Object(i.h)(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),d=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new u(t)}}catch(n){}return new h},f=d("localStorage"),p=d("sessionStorage"),g=new s.b("@firebase/database"),m=(l=1,function(){return l++}),y=function(e){var t=Object(i.H)(e),n=new i.c;n.update(t);var r=n.digest();return i.f.encodeByteArray(r)},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var o=e[r];Array.isArray(o)||o&&"object"==typeof o&&"number"==typeof o.length?n+=v.apply(null,o):n+="object"==typeof o?Object(i.I)(o):o,n+=" "}return n},b=null,_=!0,w=function(e,t){Object(i.d)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(g.logLevel=s.a.VERBOSE,b=g.log.bind(g),t&&p.set("logging_enabled",!0)):"function"==typeof e?b=e:(b=null,p.remove("logging_enabled"))},C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===_&&(_=!1,null===b&&!0===p.get("logging_enabled")&&w(!0)),b){var n=v.apply(null,e);b(n)}},E=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];C.apply(void 0,Object(o.f)([e],Object(o.e)(t)))}},O=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+v.apply(void 0,Object(o.f)([],Object(o.e)(e)));g.error(n)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+v.apply(void 0,Object(o.f)([],Object(o.e)(e)));throw g.error(n),new Error(n)},P=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+v.apply(void 0,Object(o.f)([],Object(o.e)(e)));g.warn(n)},I=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},T="[MIN_NAME]",A="[MAX_NAME]",k=function(e,t){if(e===t)return 0;if(e===T||t===A)return-1;if(t===T||e===A)return 1;var n=F(e),r=F(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},N=function(e,t){return e===t?0:e<t?-1:1},M=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(i.I)(t))},x=function(e){if("object"!=typeof e||null===e)return Object(i.I)(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",o=0;o<t.length;o++)0!==o&&(r+=","),r+=Object(i.I)(t[o]),r+=":",r+=x(e[t[o]]);return r+"}"},R=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function D(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var L=function(e){var t,n,r,o,s;Object(i.d)(!I(e),"Invalid JSON number"),0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(o=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();var c=a.join(""),l="";for(s=0;s<64;s+=8){var u=parseInt(c.substr(s,8),2).toString(16);1===u.length&&(u="0"+u),l+=u}return l.toLowerCase()},B=new RegExp("^-?(0*)\\d{1,10}$"),F=function(e){if(B.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},j=function(e){try{e()}catch(t){setTimeout(function(){throw P("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},U=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},V=function(){function e(e,t){var n=this;this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(function(e){return n.appCheck=e})}return e.prototype.getToken=function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(n,r){setTimeout(function(){t.appCheck?t.getToken(e).then(n,r):n(null)},0)})},e.prototype.addTokenChangeListener=function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(function(t){return t.addTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){P('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},e}(),z=function(){function e(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(function(e){return r.auth_=e})}return e.prototype.getToken=function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(C("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(n,r){setTimeout(function(){t.auth_?t.getToken(e).then(n,r):n(null)},0)})},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)})},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';P(e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},e}(),H=function(){function e(e){this.accessToken=e}return e.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},e.prototype.addTokenChangeListener=function(e){e(this.accessToken)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.OWNER="owner",e}(),G=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,$=function(){function e(e,t,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f.get("host:"+e)||this._host}return e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&f.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host+"/"+(this.includeNamespaceInQueryParams?"?ns="+this.namespace:"")},e}();function q(e,t,n){var r;if(Object(i.d)("string"==typeof t,"typeof type must == string"),Object(i.d)("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var o=[];return D(n,function(e,t){o.push(e+"="+t)}),r+o.join("&")}var W=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Object(i.h)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Object(i.k)(this.counters_)},e}(),Z={},Q={};function Y(e){var t=e.toString();return Z[t]||(Z[t]=new W),Z[t]}var K=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&j(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},e}(),J=function(){function e(e,t,n,r,i,o,s){var a=this;this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(e),this.stats_=Y(t),this.urlFn=function(e){return a.appCheckToken&&(e.ac=a.appCheckToken),q(t,"long_polling",e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new K(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(Object(i.x)()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new X(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(o.e)(e,5),i=r[0],s=r[1],a=r[2];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=s,n.password=a;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(o.e)(e,2),i=r[0],s=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,s)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&G.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!(Object(i.x)()||!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Object(i.I)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=Object(i.g)(t),r=R(n,1840),o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!Object(i.x)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Object(i.I)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),X=function(){function e(t,n,r,o){if(this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(i.x)())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=m(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(s='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(c){C("frame writing exception"),c.stack&&C(c.stack),C(c)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||C("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(t+=n,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},e.prototype.addTag=function(e,t){var n=this;Object(i.x)()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){C("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))},e}(),ee=null;"undefined"!=typeof MozWebSocket?ee=MozWebSocket:"undefined"!=typeof WebSocket&&(ee=WebSocket);var te=function(){function e(t,n,r,i,o,s,a){this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=Y(n),this.connURL=e.connectionURL_(n,s,a,i),this.nodeAdmin=n.nodeAdmin}return e.connectionURL_=function(e,t,n,r){var o={v:"5"};return!Object(i.x)()&&"undefined"!=typeof location&&location.hostname&&G.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o.ac=r),q(e,"websocket",o)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if(Object(i.x)()){var r={headers:{"User-Agent":"Firebase/5/"+a+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(r.headers.Authorization="Bearer "+this.authToken),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var o=process.env,s=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;s&&(r.proxy={origin:s}),this.mySock=new ee(this.connURL,[],r)}else this.mySock=new ee(this.connURL,[],r={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(l){this.log_("Error instantiating WebSocket.");var c=l.message||l.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==ee&&!e.forceDisallow_},e.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Object(i.C)(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(Object(i.d)(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Object(i.I)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=R(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),ne=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[J,te]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=te&&te.isAvailable(),s=i&&!te.previouslyFailed();if(t.webSocketOnly&&(i||P("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[te];else{var a=this.transports_=[];try{for(var c=Object(o.g)(e.ALL_TRANSPORTS),l=c.next();!l.done;l=c.next()){var u=l.value;u&&u.isAvailable()&&a.push(u)}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),re=function(){function e(e,t,n,r,i,o,s,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new ne(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=U(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){this.sendData_({t:"d",d:e})},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=M("t",e),n=M("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=M("t",e),n=M("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=M("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?O("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):O("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&P("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),U(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):U(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),ie=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.refreshAppCheckToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),oe=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Object(i.d)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=Object(o.f)([],Object(o.e)(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){Object(i.d)(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),se=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(i.v)()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return Object(o.c)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(i.d)("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(oe),ae=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();function ce(){return new ae("")}function le(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ue(e){return e.pieces_.length-e.pieceNum_}function he(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new ae(e.pieces_,t)}function de(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function fe(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function pe(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ae(t,0)}function ge(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof ae)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new ae(n,0)}function me(e){return e.pieceNum_>=e.pieces_.length}function ye(e,t){var n=le(e),r=le(t);if(null===n)return t;if(n===r)return ye(he(e),he(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function ve(e,t){for(var n=fe(e,0),r=fe(t,0),i=0;i<n.length&&i<r.length;i++){var o=k(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function be(e,t){if(ue(e)!==ue(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function _e(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(ue(e)>ue(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var we=function(){return function(e,t){this.errorPrefix_=t,this.parts_=fe(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(i.G)(this.parts_[n]);Ce(this)}}();function Ce(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ee(e))}function Ee(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var Oe,Se,Pe=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))},!1),r}return Object(o.c)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(i.d)("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(oe),Ie=function(e){function t(n,r,o,s,a,c,l,u){var h=e.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=o,h.onConnectStatus_=s,h.onServerInfoUpdate_=a,h.authTokenProvider_=c,h.appCheckTokenProvider_=l,h.authOverride_=u,h.id=t.nextPersistentConnectionId_++,h.log_=E("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=1e3,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,u&&!Object(i.x)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Pe.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&se.getInstance().on("online",h.onOnline_,h),h}return Object(o.c)(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,o={r,a:e,b:t};this.log_(Object(i.I)(o)),Object(i.d)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),n&&(this.requestCBHash_[r]=n)},t.prototype.get=function(e){var t=this;this.initConnection_();var n=new i.a,r={p:e._path.toString(),q:e._queryObject},o={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;var s=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=t.outstandingGets_[s];void 0!==e&&o===e&&(delete t.outstandingGets_[s],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(s),n.promise},t.prototype.listen=function(e,t,n,r){this.initConnection_();var o=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+o),this.listens.has(s)||this.listens.set(s,new Map),Object(i.d)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(i.d)(!this.listens.get(s).has(o),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(o,a),this.connected_&&this.sendListen_(a)},t.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var s={p:i};e.tag&&(s.q=r._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,function(s){var a=s.d,c=s.s;t.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",s),"ok"!==c&&n.removeListen_(i,o),e.onComplete&&e.onComplete(c,a))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&Object(i.h)(e,"w")){var n=Object(i.F)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();P("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+o+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||Object(i.p)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.refreshAppCheckToken=function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=Object(i.B)(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},t.prototype.tryAppCheck=function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)})},t.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(i.d)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){this.initConnection_();var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Object(i.I)(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):O("Unrecognized action received from server: "+Object(i.I)(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Object(i.d)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){return Object(o.b)(this,void 0,void 0,function(){var e,n,r,s,a,c,l,u,h,d,f,p,g,m=this;return Object(o.d)(this,function(y){switch(y.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,a=this.lastSessionId,c=!1,l=null,this.realtime_={close:u=function(){l?l.close():(c=!0,r())},sendRequest:function(e){Object(i.d)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)}},h=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)])];case 2:return d=o.e.apply(void 0,[y.sent(),2]),f=d[0],p=d[1],c?C("getToken() completed but was canceled"):(C("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=p&&p.token,l=new re(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,function(e){P(e+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")},a)),[3,4];case 3:return g=y.sent(),this.log_("Failed to get token: "+g),c||(this.repoInfo_.nodeAdmin&&P(g),u()),[3,4];case 4:return[2]}})})},t.prototype.interrupt=function(e){C("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){C("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(i.t)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return x(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new ae(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){C("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onAppCheckRevoked_=function(e,t){C("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=Object(o.g)(this.listens.values()),s=i.next();!s.done;s=i.next()){var a=s.value;try{for(var c=(n=void 0,Object(o.g)(a.values())),l=c.next();!l.done;l=c.next())this.sendListen_(l.value)}catch(d){n={error:d}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var u=0;u<this.outstandingPuts_.length;u++)this.outstandingPuts_[u]&&this.sendPut_(u);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)},t.prototype.sendConnectStats_=function(){var e={},t="js";Object(i.x)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+a.replace(/\./g,"-")]=1,Object(i.v)()?e["framework.cordova"]=1:Object(i.y)()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=se.getInstance().currentlyOnline();return Object(i.t)(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(ie),Te=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),Ae=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new Te(T,e),r=new Te(T,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return Te.MIN},e}(),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Oe},set:function(e){Oe=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return k(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Object(i.e)("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return Te.MIN},t.prototype.maxPost=function(){return new Te(A,Oe)},t.prototype.makePost=function(e,t){return Object(i.d)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Te(e,Oe)},t.prototype.toString=function(){return".key"},t}(Ae),Ne=new ke,Me=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),xe=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:De.EMPTY_NODE,this.right=null!=o?o:De.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return De.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return De.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Re=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new xe(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),De=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,xe.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,xe.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Me(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Me(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Me(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Me(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Re,e}();function Le(e,t){return k(e.name,t.name)}function Be(e,t){return k(e,t)}var Fe,je,Ue,Ve,ze,He=function(e){return"number"==typeof e?"number:"+L(e):"string:"+e},Ge=function(e){if(e.isLeafNode()){var t=e.val();Object(i.d)("string"==typeof t||"number"==typeof t||"object"==typeof t&&Object(i.h)(t,".sv"),"Priority must be a string or number.")}else Object(i.d)(e===Se||e.isEmpty(),"priority of unexpected type.");Object(i.d)(e===Se||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},$e=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Object(i.d)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Ge(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return Fe},set:function(e){Fe=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return me(t)?this:".priority"===le(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=le(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(i.d)(".priority"!==r||1===ue(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(he(t),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+He(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?L(this.value_):this.value_,this.lazyHash_=y(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Object(i.d)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,o=e.VALUE_TYPE_ORDER.indexOf(n),s=e.VALUE_TYPE_ORDER.indexOf(r);return Object(i.d)(o>=0,"Unknown leaf type: "+n),Object(i.d)(s>=0,"Unknown leaf type: "+r),o===s?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),qe=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?k(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return Te.MIN},t.prototype.maxPost=function(){return new Te(A,new $e("[PRIORITY-POST]",Ue))},t.prototype.makePost=function(e,t){var n=je(e);return new Te(t,new $e("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Ae)),We=Math.log(2),Ze=function(){function e(e){this.count=parseInt(Math.log(e+1)/We,10),this.current_=this.count-1;var t=parseInt(Array(this.count+1).join("1"),2);this.bits_=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Qe=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,s,a=r-t;if(0===a)return null;if(1===a)return o=e[t],s=n?n(o):o,new xe(s,o.node,xe.BLACK,null,null);var c=parseInt(a/2,10)+t,l=i(t,c),u=i(c+1,r);return o=e[c],s=n?n(o):o,new xe(s,o.node,xe.BLACK,l,u)},o=function(t){for(var r=null,o=null,s=e.length,a=function(t,r){var o=s-t,a=s;s-=t;var l=i(o+1,a),u=e[o],h=n?n(u):u;c(new xe(h,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(o=e,r=e)},l=0;l<t.count;++l){var u=t.nextBitIsOne(),h=Math.pow(2,t.count-(l+1));u?a(h,xe.BLACK):(a(h,xe.BLACK),a(h,xe.RED))}return o}(new Ze(e.length));return new De(r||t,o)},Ye={},Ke=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Object(i.d)(Ye&&qe,"ChildrenNode.ts has not been loaded"),Ve=Ve||new e({".priority":Ye},{".priority":qe})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=Object(i.F)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof De?t:null},e.prototype.hasIndex=function(e){return Object(i.h)(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){Object(i.d)(t!==Ne,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,s=[],a=!1,c=n.getIterator(Te.Wrap),l=c.getNext();l;)a=a||t.isDefinedOn(l.node),s.push(l),l=c.getNext();r=a?Qe(s,t.getCompare()):Ye;var u=t.toString(),h=Object(o.a)({},this.indexSet_);h[u]=t;var d=Object(o.a)({},this.indexes_);return d[u]=r,new e(d,h)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(Object(i.D)(this.indexes_,function(e,o){var s=Object(i.F)(r.indexSet_,o);if(Object(i.d)(s,"Missing index implementation for "+o),e===Ye){if(s.isDefinedOn(t.node)){for(var a=[],c=n.getIterator(Te.Wrap),l=c.getNext();l;)l.name!==t.name&&a.push(l),l=c.getNext();return a.push(t),Qe(a,s.getCompare())}return Ye}var u=n.get(t.name),h=e;return u&&(h=h.remove(new Te(t.name,u))),h.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e(Object(i.D)(this.indexes_,function(e){if(e===Ye)return e;var r=n.get(t.name);return r?e.remove(new Te(t.name,r)):e}),this.indexSet_)},e}(),Je=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ge(this.priorityNode_),this.children_.isEmpty()&&Object(i.d)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return ze||(ze=new e(new De(Be),null,Ke.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||ze},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?ze:t},e.prototype.getChild=function(e){var t=le(e);return null===t?this:this.getImmediateChild(t).getChild(he(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(Object(i.d)(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new Te(t,n),o=void 0,s=void 0;n.isEmpty()?(o=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(t,n),s=this.indexMap_.addToIndexes(r,this.children_));var a=o.isEmpty()?ze:this.priorityNode_;return new e(o,a,s)},e.prototype.updateChild=function(e,t){var n=le(e);if(null===n)return t;Object(i.d)(".priority"!==le(e)||1===ue(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(he(e),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(qe,function(s,a){n[s]=a.val(t),r++,o&&e.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1}),!t&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+He(this.getPriority().val())+":"),this.forEachChild(qe,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":y(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Te(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new Te(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new Te(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,Te.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,Te.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xe?-1:0},e.prototype.withIndex=function(t){if(t===Ne||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===Ne||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(qe),r=t.getIterator(qe),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Ne?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Xe=new(function(e){function t(){return e.call(this,new De(Be),Je.EMPTY_NODE,Ke.Default)||this}return Object(o.c)(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return Je.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(Je));function et(e,t){if(void 0===t&&(t=null),null===e)return Je.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Object(i.d)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new $e(e,et(t));if(e instanceof Array){var n=Je.EMPTY_NODE;return D(e,function(t,r){if(Object(i.h)(e,t)&&"."!==t.substring(0,1)){var o=et(r);!o.isLeafNode()&&o.isEmpty()||(n=n.updateImmediateChild(t,o))}}),n.updatePriority(et(t))}var r=[],o=!1;if(D(e,function(e,t){if("."!==e.substring(0,1)){var n=et(t);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),r.push(new Te(e,n)))}}),0===r.length)return Je.EMPTY_NODE;var s=Qe(r,Le,function(e){return e.name},Be);if(o){var a=Qe(r,qe.getCompare());return new Je(s,et(t),new Ke({".priority":a},{".priority":qe}))}return new Je(s,et(t),Ke.Default)}Object.defineProperties(Te,{MIN:{value:new Te(T,Je.EMPTY_NODE)},MAX:{value:new Te(A,Xe)}}),ke.__EMPTY_NODE=Je.EMPTY_NODE,$e.__childrenNodeConstructor=Je,Se=Xe,Ue=Xe,je=et;var tt,nt,rt=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,Object(i.d)(!me(t)&&".priority"!==le(t),"Can't create PathIndex with empty path or .priority key"),n}return Object(o.c)(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?k(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=et(e),r=Je.EMPTY_NODE.updateChild(this.indexPath_,n);return new Te(t,r)},t.prototype.maxPost=function(){var e=Je.EMPTY_NODE.updateChild(this.indexPath_,Xe);return new Te(A,e)},t.prototype.toString=function(){return fe(this.indexPath_,0).join("/")},t}(Ae),it=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?k(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return Te.MIN},t.prototype.maxPost=function(){return Te.MAX},t.prototype.makePost=function(e,t){var n=et(e);return new Te(t,n)},t.prototype.toString=function(){return".value"},t}(Ae)),ot="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",st=(tt=0,nt=[],function(e){var t,n=e===tt;tt=e;var r=new Array(8);for(t=7;t>=0;t--)r[t]=ot.charAt(e%64),e=Math.floor(e/64);Object(i.d)(0===e,"Cannot push at time == 0");var o=r.join("");if(n){for(t=11;t>=0&&63===nt[t];t--)nt[t]=0;nt[t]++}else for(t=0;t<12;t++)nt[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)o+=ot.charAt(nt[t]);return Object(i.d)(20===o.length,"nextPushId: Length should be 20."),o}),at=function(e){if("2147483647"===e)return"-";var t=F(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return A;var o=ot.charAt(ot.indexOf(n[i])+1);return n[i]=o,n.slice(0,i+1).join("")},ct=function(e){if("-2147483648"===e)return T;var t=F(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=ot.charAt(ot.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function lt(e){return{type:"value",snapshotNode:e}}function ut(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function ht(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function dt(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var ft=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,o,s){Object(i.d)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(ht(t,a)):Object(i.d)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ut(t,n)):s.trackChildChange(dt(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(qe,function(e,r){t.hasChild(e)||n.trackChildChange(ht(e,r))}),t.isLeafNode()||t.forEachChild(qe,function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(dt(t,r,i))}else n.trackChildChange(ut(t,r))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?Je.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),pt=function(){function e(t){this.indexedFilter_=new ft(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new Te(t,n))||(n=Je.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Je.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Je.EMPTY_NODE);var i=this;return t.forEachChild(qe,function(e,t){i.matches(new Te(e,t))||(r=r.updateImmediateChild(e,Je.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),gt=function(){function e(e){this.rangedFilter_=new pt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new Te(t,n))||(n=Je.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Je.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=Je.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Je.EMPTY_NODE);var a=void 0,c=void 0,l=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var u=this.index_.getCompare();l=function(e,t){return u(t,e)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)s=i.getNext(),!h&&l(a,s)<=0&&(h=!0),h&&o<this.limit_&&l(s,c)<=0?o++:r=r.updateImmediateChild(s.name,Je.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,o){var s;if(this.reverse_){var a=this.index_.getCompare();s=function(e,t){return a(t,e)}}else s=this.index_.getCompare();var c=e;Object(i.d)(c.numChildren()===this.limit_,"");var l=new Te(t,n),u=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(c.hasChild(t)){for(var d=c.getImmediateChild(t),f=r.getChildAfterChild(this.index_,u,this.reverse_);null!=f&&(f.name===t||c.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:s(f,l);if(h&&!n.isEmpty()&&p>=0)return null!=o&&o.trackChildChange(dt(t,n,d)),c.updateImmediateChild(t,n);null!=o&&o.trackChildChange(ht(t,d));var g=c.updateImmediateChild(t,Je.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=o&&o.trackChildChange(ut(f.name,f.node)),g.updateImmediateChild(f.name,f.node)):g}return n.isEmpty()?e:h&&s(u,l)>=0?(null!=o&&(o.trackChildChange(ht(u.name,u.node)),o.trackChildChange(ut(t,n))),c.updateImmediateChild(t,n).updateImmediateChild(u.name,Je.EMPTY_NODE)):e},e}(),mt=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return Object(i.d)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Object(i.d)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:T},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Object(i.d)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Object(i.d)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Object(i.d)(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===qe},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();function yt(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function vt(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function bt(e,t){var n=e.copy();return n.index_=t,n}function _t(e){var t,n={};return e.isDefault()||(e.index_===qe?t="$priority":e.index_===it?t="$value":e.index_===Ne?t="$key":(Object(i.d)(e.index_ instanceof rt,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Object(i.I)(t),e.startSet_&&(n.startAt=Object(i.I)(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+Object(i.I)(e.indexStartName_))),e.endSet_&&(n.endAt=Object(i.I)(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+Object(i.I)(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function wt(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==qe&&(t.i=e.index_.toString()),t}var Ct=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.repoInfo_=t,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=E("p:rest:"),o.listens_={},o}return Object(o.c)(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Object(i.d)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},t.prototype.listen=function(e,n,r,o){var s=this,a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);var c=t.getListenId_(e,r),l={};this.listens_[c]=l;var u=_t(e._queryParams);this.restRequest_(a+".json",u,function(e,t){var n=t;404===e&&(n=null,e=null),null===e&&s.onDataUpdate_(a,n,!1,r),Object(i.F)(s.listens_,c)===l&&o(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.get=function(e){var t=this,n=_t(e._queryParams),r=e._path.toString(),o=new i.a;return this.restRequest_(r+".json",n,function(e,n){var i=n;404===e&&(i=null,e=null),null===e?(t.onDataUpdate_(r,i,!1,null),o.resolve(i)):o.reject(new Error(i))}),o.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;return void 0===t&&(t={}),t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(s){var a=Object(o.e)(s,2),c=a[0],l=a[1];c&&c.accessToken&&(t.auth=c.accessToken),l&&l.token&&(t.ac=l.token);var u=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+Object(i.E)(t);r.log_("Sending REST request for "+u);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+u+" received. status:",h.status,"response:",h.responseText);var e=null;if(h.status>=200&&h.status<300){try{e=Object(i.C)(h.responseText)}catch(t){P("Failed to parse JSON response for "+u+": "+h.responseText)}n(null,e)}else 401!==h.status&&404!==h.status&&P("Got unsuccessful REST response for "+u+" Status: "+h.status),n(h.status);n=null}},h.open("GET",u,!0),h.send()})},t}(ie),Et=function(){function e(){this.rootNode_=Je.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();function Ot(){return{value:null,children:new Map}}function St(e,t,n){if(me(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=le(t);e.children.has(r)||e.children.set(r,Ot()),St(e.children.get(r),t=he(t),n)}}function Pt(e,t){if(me(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(qe,function(t,n){St(e,new ae(t),n)}),Pt(e,t)}if(e.children.size>0){var r=le(t);return t=he(t),e.children.has(r)&&Pt(e.children.get(r),t)&&e.children.delete(r),0===e.children.size}return!0}function It(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(function(e,n){t(n,e)})}(e,function(e,r){It(r,new ae(t.toString()+"/"+e),n)})}var Tt=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Object(o.a)({},e);return this.last_&&D(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t},e}(),At=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Tt(e);var n=1e4+2e4*Math.random();U(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;D(t,function(t,o){o>0&&Object(i.h)(e.statsToReport_,t)&&(n[t]=o,r=!0)}),r&&this.server_.reportStats(n),U(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}(),kt=function(e){return e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",e}({});function Nt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var Mt,xt=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=kt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e.prototype.operationForChild=function(t){if(me(this.path)){if(null!=this.affectedTree.value)return Object(i.d)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new ae(t));return new e(ce(),n,this.revert)}return Object(i.d)(le(this.path)===t,"operationForChild called for unrelated child."),new e(he(this.path),this.affectedTree,this.revert)},e}(),Rt=function(){function e(e,t){this.source=e,this.path=t,this.type=kt.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return me(this.path)?new e(this.source,ce()):new e(this.source,he(this.path))},e}(),Dt=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=kt.OVERWRITE}return e.prototype.operationForChild=function(t){return me(this.path)?new e(this.source,ce(),this.snap.getImmediateChild(t)):new e(this.source,he(this.path),this.snap)},e}(),Lt=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=kt.MERGE}return e.prototype.operationForChild=function(t){if(me(this.path)){var n=this.children.subtree(new ae(t));return n.isEmpty()?null:n.value?new Dt(this.source,ce(),n.value):new e(this.source,ce(),n)}return Object(i.d)(le(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,he(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),Bt=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(me(e))return this.isFullyInitialized()&&!this.filtered_;var t=le(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),Ft=function(){return function(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}();function jt(e,t,n,r,o,s){var a=r.filter(function(e){return e.type===n});a.sort(function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw Object(i.e)("Should only compare child_ events.");var r=new Te(t.childName,t.snapshotNode),o=new Te(n.childName,n.snapshotNode);return e.index_.compare(r,o)}(e,t,n)}),a.forEach(function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);o.forEach(function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function Ut(e,t){return{eventCache:e,serverCache:t}}function Vt(e,t,n,r){return Ut(new Bt(t,n,r),e.serverCache)}function zt(e,t,n,r){return Ut(e.eventCache,new Bt(t,n,r))}function Ht(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Gt(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var $t=function(){function e(e,t){void 0===t&&(Mt||(Mt=new De(N)),t=Mt),this.value=e,this.children=t}return e.fromObject=function(t){var n=new e(null);return D(t,function(e,t){n=n.set(new ae(e),t)}),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:ce(),value:this.value};if(me(e))return null;var n=le(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(he(e),t);return null!=i?{path:ge(new ae(n),i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(me(t))return this;var n=le(t),r=this.children.get(n);return null!==r?r.subtree(he(t)):new e(null)},e.prototype.set=function(t,n){if(me(t))return new e(n,this.children);var r=le(t),i=(this.children.get(r)||new e(null)).set(he(t),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(me(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=le(t),r=this.children.get(n);if(r){var i=r.remove(he(t)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(me(e))return this.value;var t=le(e),n=this.children.get(t);return n?n.get(he(e)):null},e.prototype.setTree=function(t,n){if(me(t))return n;var r,i=le(t),o=(this.children.get(i)||new e(null)).setTree(he(t),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new e(this.value,r)},e.prototype.fold=function(e){return this.fold_(ce(),e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(ge(e,r),t)}),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,ce(),t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(me(e))return null;var i=le(e),o=this.children.get(i);return o?o.findOnPath_(he(e),ge(t,i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,ce(),t)},e.prototype.foreachOnPath_=function(t,n,r){if(me(t))return this;this.value&&r(n,this.value);var i=le(t),o=this.children.get(i);return o?o.foreachOnPath_(he(t),ge(n,i),r):new e(null)},e.prototype.foreach=function(e){this.foreach_(ce(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(ge(e,n),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})},e}(),qt=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new $t(null))},e}();function Wt(e,t,n){if(me(t))return new qt(new $t(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,s=ye(i,t);return o=o.updateChild(s,n),new qt(e.writeTree_.set(i,o))}var a=new $t(n),c=e.writeTree_.setTree(t,a);return new qt(c)}function Zt(e,t,n){var r=e;return D(n,function(e,n){r=Wt(r,ge(t,e),n)}),r}function Qt(e,t){if(me(t))return qt.empty();var n=e.writeTree_.setTree(t,new $t(null));return new qt(n)}function Yt(e,t){return null!=Kt(e,t)}function Kt(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(ye(n.path,t)):null}function Jt(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(qe,function(e,n){t.push(new Te(e,n))}):e.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new Te(e,n.value))}),t}function Xt(e,t){if(me(t))return e;var n=Kt(e,t);return new qt(null!=n?new $t(n):e.writeTree_.subtree(t))}function en(e){return e.writeTree_.isEmpty()}function tn(e,t){return nn(ce(),e.writeTree_,t)}function nn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal(function(t,o){".priority"===t?(Object(i.d)(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):n=nn(ge(e,t),o,n)}),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(ge(e,".priority"),r)),n}function rn(e,t){return gn(t,e)}function on(e,t){if(e.snap)return _e(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&_e(ge(e.path,n),t))return!0;return!1}function sn(e){return e.visible}function an(e,t,n){for(var r=qt.empty(),o=0;o<e.length;++o){var s=e[o];if(t(s)){var a=s.path,c=void 0;if(s.snap)_e(n,a)?r=Wt(r,c=ye(n,a),s.snap):_e(a,n)&&(c=ye(a,n),r=Wt(r,ce(),s.snap.getChild(c)));else{if(!s.children)throw Object(i.e)("WriteRecord should have .snap or .children");if(_e(n,a))r=Zt(r,c=ye(n,a),s.children);else if(_e(a,n))if(me(c=ye(a,n)))r=Zt(r,ce(),s.children);else{var l=Object(i.F)(s.children,le(c));if(l){var u=l.getChild(he(c));r=Wt(r,ce(),u)}}}}}return r}function cn(e,t,n,r,i){if(r||i){var o=Xt(e.visibleWrites,t);return!i&&en(o)?n:i||null!=n||Yt(o,ce())?tn(an(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(_e(e.path,t)||_e(t,e.path))},t),n||Je.EMPTY_NODE):null}var s=Kt(e.visibleWrites,t);if(null!=s)return s;var a=Xt(e.visibleWrites,t);return en(a)?n:null!=n||Yt(a,ce())?tn(a,n||Je.EMPTY_NODE):null}function ln(e,t,n,r){return cn(e.writeTree,e.treePath,t,n,r)}function un(e,t){return function(e,t,n){var r=Je.EMPTY_NODE,i=Kt(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(qe,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var o=Xt(e.visibleWrites,t);return n.forEachChild(qe,function(e,t){var n=tn(Xt(o,new ae(e)),t);r=r.updateImmediateChild(e,n)}),Jt(o).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return Jt(Xt(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function hn(e,t,n,r){return function(e,t,n,r,o){Object(i.d)(r||o,"Either existingEventSnap or existingServerSnap must exist");var s=ge(t,n);if(Yt(e.visibleWrites,s))return null;var a=Xt(e.visibleWrites,s);return en(a)?o.getChild(n):tn(a,o.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function dn(e,t){return function(e,t){return Kt(e.visibleWrites,t)}(e.writeTree,ge(e.treePath,t))}function fn(e,t,n){return function(e,t,n,r){var i=ge(t,n),o=Kt(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?tn(Xt(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function pn(e,t){return gn(ge(e.treePath,t),e.writeTree)}function gn(e,t){return{treePath:e,writeTree:t}}var mn=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Object(i.d)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Object(i.d)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var o=r.type;if("child_added"===t&&"child_removed"===o)this.changeMap.set(n,dt(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===o)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===o)this.changeMap.set(n,ht(n,r.oldSnap));else if("child_changed"===t&&"child_added"===o)this.changeMap.set(n,ut(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==o)throw Object(i.e)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,dt(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),yn=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),vn=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Bt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fn(this.writes_,e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Gt(this.viewCache_),i=function(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){var a,c=Xt(e.visibleWrites,t),l=Kt(c,ce());if(null!=l)a=l;else{if(null==n)return[];a=tn(c,n)}if((a=a.withIndex(s)).isEmpty()||a.isLeafNode())return[];for(var u=[],h=s.getCompare(),d=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),f=d.getNext();f&&u.length<1;)0!==h(f,r)&&u.push(f),f=d.getNext();return u}(e.writeTree,e.treePath,t,n,0,i,o)}(this.writes_,r,t,0,n,e);return 0===i.length?null:i[0]},e}();function bn(e,t,n,r,o,s){var a=t.eventCache;if(null!=dn(r,n))return t;var c=void 0,l=void 0;if(me(n))if(Object(i.d)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var u=Gt(t),h=un(r,u instanceof Je?u:Je.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),h,s)}else{var d=ln(r,Gt(t));c=e.filter.updateFullNode(t.eventCache.getNode(),d,s)}else{var f=le(n);if(".priority"===f){Object(i.d)(1===ue(n),"Can't have a priority with additional path components");var p=a.getNode(),g=hn(r,n,p,l=t.serverCache.getNode());c=null!=g?e.filter.updatePriority(p,g):a.getNode()}else{var m=he(n),y=void 0;if(a.isCompleteForChild(f)){l=t.serverCache.getNode();var v=hn(r,n,a.getNode(),l);y=null!=v?a.getNode().getImmediateChild(f).updateChild(m,v):a.getNode().getImmediateChild(f)}else y=fn(r,f,t.serverCache);c=null!=y?e.filter.updateChild(a.getNode(),f,y,m,o,s):a.getNode()}}return Vt(t,c,a.isFullyInitialized()||me(n),e.filter.filtersNodes())}function _n(e,t,n,r,i,o,s,a){var c,l=t.serverCache,u=s?e.filter:e.filter.getIndexedFilter();if(me(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){var h=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),h,null)}else{var d=le(n);if(!l.isCompleteForPath(n)&&ue(n)>1)return t;var f=he(n),p=l.getNode().getImmediateChild(d).updateChild(f,r);c=".priority"===d?u.updatePriority(l.getNode(),p):u.updateChild(l.getNode(),d,p,f,yn,null)}var g=zt(t,c,l.isFullyInitialized()||me(n),u.filtersNodes());return bn(e,g,n,i,new vn(i,g,o),a)}function wn(e,t,n,r,i,o,s){var a,c,l=t.eventCache,u=new vn(i,t,o);if(me(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,s),a=Vt(t,c,!0,e.filter.filtersNodes());else{var h=le(n);if(".priority"===h)c=e.filter.updatePriority(t.eventCache.getNode(),r),a=Vt(t,c,l.isFullyInitialized(),l.isFiltered());else{var d=he(n),f=l.getNode().getImmediateChild(h),p=void 0;if(me(d))p=r;else{var g=u.getCompleteChild(h);p=null!=g?".priority"===de(d)&&g.getChild(pe(d)).isEmpty()?g:g.updateChild(d,r):Je.EMPTY_NODE}a=f.equals(p)?t:Vt(t,e.filter.updateChild(l.getNode(),h,p,d,u,s),l.isFullyInitialized(),e.filter.filtersNodes())}}return a}function Cn(e,t){return e.eventCache.isCompleteForChild(t)}function En(e,t,n){return n.foreach(function(e,n){t=t.updateChild(e,n)}),t}function On(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var c,l=t;c=me(n)?r:new $t(null).setTree(n,r);var u=t.serverCache.getNode();return c.children.inorderTraversal(function(n,r){if(u.hasChild(n)){var c=En(0,t.serverCache.getNode().getImmediateChild(n),r);l=_n(e,l,new ae(n),c,i,o,s,a)}}),c.children.inorderTraversal(function(n,r){var c=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!u.hasChild(n)&&!c){var h=En(0,t.serverCache.getNode().getImmediateChild(n),r);l=_n(e,l,new ae(n),h,i,o,s,a)}}),l}var Sn,Pn=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new ft(r.getIndex()),o=(n=r).loadsAllData()?new ft(n.getIndex()):n.hasLimit()?new gt(n):new pt(n);this.processor_=function(e){return{filter:e}}(o);var s=t.serverCache,a=t.eventCache,c=i.updateFullNode(Je.EMPTY_NODE,s.getNode(),null),l=o.updateFullNode(Je.EMPTY_NODE,a.getNode(),null),u=new Bt(c,s.isFullyInitialized(),i.filtersNodes()),h=new Bt(l,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ut(h,u),this.eventGenerator_=new Ft(this.query_)}return Object.defineProperty(e.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),e}();function In(e,t){var n=Gt(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!me(t)&&!n.getImmediateChild(le(t)).isEmpty())?n.getChild(t):null}function Tn(e){return 0===e.eventRegistrations_.length}function An(e,t,n){var r=[];if(n){Object(i.d)(null==t,"A cancel should cancel all event registrations.");var o=e.query._path;e.eventRegistrations_.forEach(function(e){var t=e.createCancelEvent(n,o);t&&r.push(t)})}if(t){for(var s=[],a=0;a<e.eventRegistrations_.length;++a){var c=e.eventRegistrations_[a];if(c.matches(t)){if(t.hasAnyCallback()){s=s.concat(e.eventRegistrations_.slice(a+1));break}}else s.push(c)}e.eventRegistrations_=s}else e.eventRegistrations_=[];return r}function kn(e,t,n,r){t.type===kt.MERGE&&null!==t.source.queryId&&(Object(i.d)(Gt(e.viewCache_),"We should always have a full cache before handling merges"),Object(i.d)(Ht(e.viewCache_),"Missing event cache, even though we have a server cache"));var o,s,a=e.viewCache_,c=function(e,t,n,r,o){var s,a,c=new mn;if(n.type===kt.OVERWRITE){var l=n;l.source.fromUser?s=wn(e,t,l.path,l.snap,r,o,c):(Object(i.d)(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!me(l.path),s=_n(e,t,l.path,l.snap,r,o,a,c))}else if(n.type===kt.MERGE){var u=n;u.source.fromUser?s=function(e,t,n,r,i,o,s){var a=t;return r.foreach(function(r,c){var l=ge(n,r);Cn(t,le(l))&&(a=wn(e,a,l,c,i,o,s))}),r.foreach(function(r,c){var l=ge(n,r);Cn(t,le(l))||(a=wn(e,a,l,c,i,o,s))}),a}(e,t,u.path,u.children,r,o,c):(Object(i.d)(u.source.fromServer,"Unknown source."),a=u.source.tagged||t.serverCache.isFiltered(),s=On(e,t,u.path,u.children,r,o,a,c))}else if(n.type===kt.ACK_USER_WRITE){var h=n;s=h.revert?function(e,t,n,r,o,s){var a;if(null!=dn(r,n))return t;var c=new vn(r,t,o),l=t.eventCache.getNode(),u=void 0;if(me(n)||".priority"===le(n)){var h=void 0;if(t.serverCache.isFullyInitialized())h=ln(r,Gt(t));else{var d=t.serverCache.getNode();Object(i.d)(d instanceof Je,"serverChildren would be complete if leaf node"),h=un(r,d)}u=e.filter.updateFullNode(l,h=h,s)}else{var f=le(n),p=fn(r,f,t.serverCache);null==p&&t.serverCache.isCompleteForChild(f)&&(p=l.getImmediateChild(f)),(u=null!=p?e.filter.updateChild(l,f,p,he(n),c,s):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(l,f,Je.EMPTY_NODE,he(n),c,s):l).isEmpty()&&t.serverCache.isFullyInitialized()&&(a=ln(r,Gt(t))).isLeafNode()&&(u=e.filter.updateFullNode(u,a,s))}return a=t.serverCache.isFullyInitialized()||null!=dn(r,ce()),Vt(t,u,a,e.filter.filtersNodes())}(e,t,h.path,r,o,c):function(e,t,n,r,i,o,s){if(null!=dn(i,n))return t;var a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(me(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return _n(e,t,n,c.getNode().getChild(n),i,o,a,s);if(me(n)){var l=new $t(null);return c.getNode().forEachChild(Ne,function(e,t){l=l.set(new ae(e),t)}),On(e,t,n,l,i,o,a,s)}return t}var u=new $t(null);return r.foreach(function(e,t){var r=ge(n,e);c.isCompleteForPath(r)&&(u=u.set(e,c.getNode().getChild(r)))}),On(e,t,n,u,i,o,a,s)}(e,t,h.path,h.affectedTree,r,o,c)}else{if(n.type!==kt.LISTEN_COMPLETE)throw Object(i.e)("Unknown operation type: "+n.type);s=function(e,t,n,r,i){var o=t.serverCache;return bn(e,zt(t,o.getNode(),o.isFullyInitialized()||me(n),o.isFiltered()),n,r,yn,i)}(e,t,n.path,r,c)}var d=c.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Ht(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(lt(Ht(t)))}}(t,s,d),{viewCache:s,changes:d}}(e.processor_,a,t,n,r);return o=e.processor_,s=c.viewCache,Object(i.d)(s.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Object(i.d)(s.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Object(i.d)(c.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=c.viewCache,Nn(e,c.changes,c.viewCache.eventCache.getNode(),null)}function Nn(e,t,n,r){return function(e,t,n,r){var i=[],o=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push({type:"child_moved",snapshotNode:t.snapshotNode,childName:t.childName})}),jt(e,i,"child_removed",t,r,n),jt(e,i,"child_added",t,r,n),jt(e,i,"child_moved",o,r,n),jt(e,i,"child_changed",t,r,n),jt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,r?[r]:e.eventRegistrations_)}var Mn,xn=function(){return function(){this.views=new Map}}();function Rn(e,t,n,r){var s,a,c=t.source.queryId;if(null!==c){var l=e.views.get(c);return Object(i.d)(null!=l,"SyncTree gave us an op for an invalid query."),kn(l,t,n,r)}var u=[];try{for(var h=Object(o.g)(e.views.values()),d=h.next();!d.done;d=h.next())u=u.concat(kn(l=d.value,t,n,r))}catch(f){s={error:f}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(s)throw s.error}}return u}function Dn(e,t,n,r,i){var o=e.views.get(t._queryIdentifier);if(!o){var s=ln(n,i?r:null),a=!1;s?a=!0:r instanceof Je?(s=un(n,r),a=!1):(s=Je.EMPTY_NODE,a=!1);var c=Ut(new Bt(s,a,!1),new Bt(r,i,!1));return new Pn(t,c)}return o}function Ln(e){var t,n,r=[];try{for(var i=Object(o.g)(e.views.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Bn(e,t){var n,r,i=null;try{for(var s=Object(o.g)(e.views.values()),a=s.next();!a.done;a=s.next())i=i||In(a.value,t)}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i}function Fn(e,t){return t._queryParams.loadsAllData()?Vn(e):e.views.get(t._queryIdentifier)}function jn(e,t){return null!=Fn(e,t)}function Un(e){return null!=Vn(e)}function Vn(e){var t,n;try{for(var r=Object(o.g)(e.views.values()),i=r.next();!i.done;i=r.next()){var s=i.value;if(s.query._queryParams.loadsAllData())return s}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}var zn=1,Hn=function(){return function(e){this.listenProvider_=e,this.syncPointTree_=new $t(null),this.pendingWriteTree_={visibleWrites:qt.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}();function Gn(e,t,n,r,o){return function(e,t,n,r,o){Object(i.d)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:o}),o&&(e.visibleWrites=Wt(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,o),o?Yn(e,new Dt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function $n(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){var n=e.allWrites.findIndex(function(e){return e.writeId===t});Object(i.d)(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var o=r.visible,s=!1,a=e.allWrites.length-1;o&&a>=0;){var c=e.allWrites[a];c.visible&&(a>=n&&on(c,r.path)?o=!1:_e(r.path,c.path)&&(s=!0)),a--}return!!o&&(s?(function(e){e.visibleWrites=an(e.allWrites,sn,ce()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=Qt(e.visibleWrites,r.path):D(r.children,function(t){e.visibleWrites=Qt(e.visibleWrites,ge(r.path,t))}),!0))}(e.pendingWriteTree_,t)){var o=new $t(null);return null!=r.snap?o=o.set(ce(),!0):D(r.children,function(e){o=o.set(new ae(e),!0)}),Yn(e,new xt(r.path,o,n))}return[]}function qn(e,t,n){return Yn(e,new Dt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Wn(e,t,n,r){var s=t._path,a=e.syncPointTree_.get(s),c=[];if(a&&("default"===t._queryIdentifier||jn(a,t))){var l=function(e,t,n,r){var s,a,c=t._queryIdentifier,l=[],u=[],h=Un(e);if("default"===c)try{for(var d=Object(o.g)(e.views.entries()),f=d.next();!f.done;f=d.next()){var p,g=Object(o.e)(f.value,2),m=g[0];u=u.concat(An(p=g[1],n,r)),Tn(p)&&(e.views.delete(m),p.query._queryParams.loadsAllData()||l.push(p.query))}}catch(y){s={error:y}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(s)throw s.error}}else(p=e.views.get(c))&&(u=u.concat(An(p,n,r)),Tn(p)&&(e.views.delete(c),p.query._queryParams.loadsAllData()||l.push(p.query)));return h&&!Un(e)&&l.push(new(Object(i.d)(Sn,"Reference.ts has not been loaded"),Sn)(t._repo,t._path)),{removed:l,events:u}}(a,t,n,r);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));var u=l.removed;c=l.events;var h=-1!==u.findIndex(function(e){return e._queryParams.loadsAllData()}),d=e.syncPointTree_.findOnPath(s,function(e,t){return Un(t)});if(h&&!d){var f=e.syncPointTree_.subtree(s);if(!f.isEmpty())for(var p=function(e){return e.fold(function(e,t,n){if(t&&Un(t))return[Vn(t)];var r=[];return t&&(r=Ln(t)),D(n,function(e,t){r=r.concat(t)}),r})}(f),g=0;g<p.length;++g){var m=p[g],y=m.query,v=Xn(e,m);e.listenProvider_.startListening(or(y),er(e,y),v.hashFn,v.onComplete)}}!d&&u.length>0&&!r&&(h?e.listenProvider_.stopListening(or(t),null):u.forEach(function(t){var n=e.queryToTagMap.get(tr(t));e.listenProvider_.stopListening(or(t),n)})),function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=tr(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}(e,u)}return c}function Zn(e,t,n){var r=t._path,o=null,s=!1;e.syncPointTree_.foreachOnPath(r,function(e,t){var n=ye(e,r);o=o||Bn(t,n),s=s||Un(t)});var a,c=e.syncPointTree_.get(r);c?(s=s||Un(c),o=o||Bn(c,ce())):(c=new xn,e.syncPointTree_=e.syncPointTree_.set(r,c)),null!=o?a=!0:(a=!1,o=Je.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild(function(e,t){var n=Bn(t,ce());n&&(o=o.updateImmediateChild(e,n))}));var l=jn(c,t);if(!l&&!t._queryParams.loadsAllData()){var u=tr(t);Object(i.d)(!e.queryToTagMap.has(u),"View does not exist, but we have a tag");var h=zn++;e.queryToTagMap.set(u,h),e.tagToQueryMap.set(h,u)}var d=function(e,t,n,r,i,o){var s=Dn(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,s),function(e,t){e.eventRegistrations_.push(t)}(s,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(qe,function(e,t){r.push(ut(e,t))}),n.isFullyInitialized()&&r.push(lt(n.getNode())),Nn(e,r,n.getNode(),t)}(s,n)}(c,t,n,rn(e.pendingWriteTree_,r),o,a);if(!l&&!s){var f=Fn(c,t);d=d.concat(function(e,t,n){var r=t._path,o=er(e,t),s=Xn(e,n),a=e.listenProvider_.startListening(or(t),o,s.hashFn,s.onComplete),c=e.syncPointTree_.subtree(r);if(o)Object(i.d)(!Un(c.value),"If we're adding a query, it shouldn't be shadowed");else for(var l=c.fold(function(e,t,n){if(!me(e)&&t&&Un(t))return[Vn(t).query];var r=[];return t&&(r=r.concat(Ln(t).map(function(e){return e.query}))),D(n,function(e,t){r=r.concat(t)}),r}),u=0;u<l.length;++u){var h=l[u];e.listenProvider_.stopListening(or(h),er(e,h))}return a}(e,t,f))}return d}function Qn(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,function(e,n){var r=Bn(n,ye(e,t));if(r)return r});return cn(r,t,i,n,!0)}function Yn(e,t){return Kn(t,e.syncPointTree_,null,rn(e.pendingWriteTree_,ce()))}function Kn(e,t,n,r){if(me(e.path))return Jn(e,t,n,r);var i=t.get(ce());null==n&&null!=i&&(n=Bn(i,ce()));var o=[],s=le(e.path),a=e.operationForChild(s),c=t.children.get(s);if(c&&a){var l=n?n.getImmediateChild(s):null,u=pn(r,s);o=o.concat(Kn(a,c,l,u))}return i&&(o=o.concat(Rn(i,e,r,n))),o}function Jn(e,t,n,r){var i=t.get(ce());null==n&&null!=i&&(n=Bn(i,ce()));var o=[];return t.children.inorderTraversal(function(t,i){var s=n?n.getImmediateChild(t):null,a=pn(r,t),c=e.operationForChild(t);c&&(o=o.concat(Jn(c,i,s,a)))}),i&&(o=o.concat(Rn(i,e,r,n))),o}function Xn(e,t){var n=t.query,r=er(e,n);return{hashFn:function(){return(function(e){return e.viewCache_.serverCache.getNode()}(t)||Je.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=nr(e,n);if(r){var i=rr(r),o=i.path,s=i.queryId,a=ye(o,t);return ir(e,o,new Rt(Nt(s),a))}return[]}(e,n._path,r):function(e,t){return Yn(e,new Rt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Wn(e,n,null,i)}}}function er(e,t){var n=tr(t);return e.queryToTagMap.get(n)}function tr(e){return e._path.toString()+"$"+e._queryIdentifier}function nr(e,t){return e.tagToQueryMap.get(t)}function rr(e){var t=e.indexOf("$");return Object(i.d)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ae(e.substr(0,t))}}function ir(e,t,n){var r=e.syncPointTree_.get(t);return Object(i.d)(r,"Missing sync point for query tag that we're tracking"),Rn(r,n,rn(e.pendingWriteTree_,t),null)}function or(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Object(i.d)(Mn,"Reference.ts has not been loaded"),Mn)(e._repo,e._path):e}var sr=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),ar=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var n=ge(this.path_,t);return new e(this.syncTree_,n)},e.prototype.node=function(){return Qn(this.syncTree_,this.path_)},e}(),cr=function(e,t,n){return e&&"object"==typeof e?(Object(i.d)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?lr(e[".sv"],t,n):"object"==typeof e[".sv"]?ur(e[".sv"],t):void Object(i.d)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},lr=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Object(i.d)(!1,"Unexpected server value: "+e)}},ur=function(e,t,n){e.hasOwnProperty("increment")||Object(i.d)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&Object(i.d)(!1,"Unexpected increment value: "+r);var o=t.node();if(Object(i.d)(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;var s=o.getValue();return"number"!=typeof s?r:s+r},hr=function(e,t,n,r){return fr(t,new ar(n,e),r)},dr=function(e,t,n){return fr(e,new sr(t),n)};function fr(e,t,n){var r,i=e.getPriority().val(),o=cr(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var s=e,a=cr(s.getValue(),t,n);return a!==s.getValue()||o!==s.getPriority().val()?new $e(a,et(o)):e}var c=e;return r=c,o!==c.getPriority().val()&&(r=r.updatePriority(new $e(o))),c.forEachChild(qe,function(e,i){var o=fr(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))}),r}var pr=function(){return function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n}}();function gr(e,t){for(var n=t instanceof ae?t:new ae(t),r=e,o=le(n);null!==o;){var s=Object(i.F)(r.node.children,o)||{children:{},childCount:0};r=new pr(o,r,s),o=le(n=he(n))}return r}function mr(e){return e.node.value}function yr(e,t){e.node.value=t,Cr(e)}function vr(e){return e.node.childCount>0}function br(e,t){D(e.node.children,function(n,r){t(new pr(n,e,r))})}function _r(e,t,n,r){n&&!r&&t(e),br(e,function(e){_r(e,t,!0,r)}),n&&r&&t(e)}function wr(e){return new ae(null===e.parent?e.name:wr(e.parent)+"/"+e.name)}function Cr(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===mr(e)&&!vr(e)}(n),o=Object(i.h)(e.node.children,t);r&&o?(delete e.node.children[t],e.node.childCount--,Cr(e)):r||o||(e.node.children[t]=n.node,e.node.childCount++,Cr(e))}(e.parent,e.name,e)}var Er=/[\[\].#$\/\u0000-\u001F\u007F]/,Or=/[\[\].#$\u0000-\u001F\u007F]/,Sr=function(e){return"string"==typeof e&&0!==e.length&&!Er.test(e)},Pr=function(e){return"string"==typeof e&&0!==e.length&&!Or.test(e)},Ir=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!I(e)||e&&"object"==typeof e&&Object(i.h)(e,".sv")},Tr=function(e,t,n,r){r&&void 0===t||Ar(Object(i.m)(e,"value"),t,n)},Ar=function(e,t,n){var r=n instanceof ae?new we(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Ee(r));if("function"==typeof t)throw new Error(e+"contains a function "+Ee(r)+" with contents = "+t.toString());if(I(t))throw new Error(e+"contains "+t.toString()+" "+Ee(r));if("string"==typeof t&&t.length>10485760/3&&Object(i.G)(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Ee(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var o=!1,s=!1;if(D(t,function(t,n){if(".value"===t)o=!0;else if(".priority"!==t&&".sv"!==t&&(s=!0,!Sr(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ee(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,c;!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Object(i.G)(t),Ce(e)}(r,t),Ar(e,n,r),c=(a=r).parts_.pop(),a.byteLength_-=Object(i.G)(c),a.parts_.length>0&&(a.byteLength_-=1)}),o&&s)throw new Error(e+' contains ".value" child '+Ee(r)+" in addition to actual children.")}},kr=function(e,t,n,r){if(!r||void 0!==t){var o=Object(i.m)(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(o+" must be an object containing the children to replace.");var s=[];D(t,function(e,t){var r=new ae(e);if(Ar(o,t,ge(n,r)),".priority"===de(r)&&!Ir(t))throw new Error(o+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=fe(r=t[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Sr(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(ve);var s=null;for(n=0;n<t.length;n++){if(r=t[n],null!==s&&_e(s,r))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(o,s)}},Nr=function(e,t,n){if(!n||void 0!==t){if(I(t))throw new Error(Object(i.m)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ir(t))throw new Error(Object(i.m)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Mr=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(i.m)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},xr=function(e,t,n,r){if(!(r&&void 0===n||Sr(n)))throw new Error(Object(i.m)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Rr=function(e,t,n,r){if(!(r&&void 0===n||Pr(n)))throw new Error(Object(i.m)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Dr=function(e,t){if(".info"===le(t))throw new Error(e+" failed = Can't modify data under /.info/")},Lr=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Sr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Pr(e)}(n))throw new Error(Object(i.m)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Br=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(i.m)(e,t)+"must be a boolean.")},Fr=function(){return function(){this.eventLists_=[],this.recursionDepth_=0}}();function jr(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||be(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function Ur(e,t,n){jr(e,n),zr(e,function(e){return be(e,t)})}function Vr(e,t,n){jr(e,n),zr(e,function(e){return _e(e,t)||_e(t,e)})}function zr(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(Hr(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function Hr(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();b&&C("event: "+n.toString()),j(r)}}}var Gr=function(){function e(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Fr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ot(),this.transactionQueueTree_=new pr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e}();function $r(e){var t=e.infoData_.getNode(new ae(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function qr(e){return(t=(t={timestamp:$r(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Wr(e,t,n,r,o){e.dataUpdateCount++;var s=new ae(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var a=[];if(o)if(r){var c=Object(i.D)(n,function(e){return et(e)});a=function(e,t,n,r){var i=nr(e,r);if(i){var o=rr(i),s=o.path,a=o.queryId,c=ye(s,t),l=$t.fromObject(n);return ir(e,s,new Lt(Nt(a),c,l))}return[]}(e.serverSyncTree_,s,c,o)}else{var l=et(n);a=function(e,t,n,r){var i=nr(e,r);if(null!=i){var o=rr(i),s=o.path,a=o.queryId,c=ye(s,t);return ir(e,s,new Dt(Nt(a),c,n))}return[]}(e.serverSyncTree_,s,l,o)}else if(r){var u=Object(i.D)(n,function(e){return et(e)});a=function(e,t,n){var r=$t.fromObject(n);return Yn(e,new Lt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,u)}else{var h=et(n);a=qn(e.serverSyncTree_,s,h)}var d=s;a.length>0&&(d=si(e,s)),Vr(e.eventQueue_,d,a)}function Zr(e,t){Qr(e,"connected",t),!1===t&&function(e){ni(e,"onDisconnectEvents");var t=qr(e),n=Ot();It(e.onDisconnect_,ce(),function(r,i){var o=hr(r,i,e.serverSyncTree_,t);St(n,r,o)});var r=[];It(n,ce(),function(t,n){r=r.concat(qn(e.serverSyncTree_,t,n));var i=hi(e,t);si(e,i)}),e.onDisconnect_=Ot(),Vr(e.eventQueue_,ce(),r)}(e)}function Qr(e,t,n){var r=new ae("/.info/"+t),i=et(n);e.infoData_.updateSnapshot(r,i);var o=qn(e.infoSyncTree_,r,i);Vr(e.eventQueue_,r,o)}function Yr(e){return e.nextWriteId_++}function Kr(e,t,n,r,i){ni(e,"set",{path:t.toString(),value:n,priority:r});var o=qr(e),s=et(n,r),a=Qn(e.serverSyncTree_,t),c=dr(s,a,o),l=Yr(e),u=Gn(e.serverSyncTree_,t,c,l,!0);jr(e.eventQueue_,u),e.server_.put(t.toString(),s.val(!0),function(n,r){var o="ok"===n;o||P("set at "+t+" failed: "+n);var s=$n(e.serverSyncTree_,l,!o);Vr(e.eventQueue_,t,s),ri(0,i,n,r)});var h=hi(e,t);si(e,h),Vr(e.eventQueue_,h,[])}function Jr(e,t,n){e.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&Pt(e.onDisconnect_,t),ri(0,n,r,i)})}function Xr(e,t,n,r){var i=et(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),function(n,o){"ok"===n&&St(e.onDisconnect_,t,i),ri(0,r,n,o)})}function ei(e,t,n){var r;r=".info"===le(t._path)?Wn(e.infoSyncTree_,t,n):Wn(e.serverSyncTree_,t,n),Ur(e.eventQueue_,t._path,r)}function ti(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}function ni(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),C.apply(void 0,Object(o.f)([r],Object(o.e)(t)))}function ri(e,t,n,r){t&&j(function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}})}function ii(e,t,n){return Qn(e.serverSyncTree_,t,n)||Je.EMPTY_NODE}function oi(e,t){if(void 0===t&&(t=e.transactionQueueTree_),t||ui(e,t),mr(t)){var n=ci(e,t);Object(i.d)(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(e,t,n){for(var r=n.map(function(e){return e.currentWriteId}),o=ii(e,t,r),s=o,a=o.hash(),c=0;c<n.length;c++){var l=n[c];Object(i.d)(0===l.status,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;var u=ye(t,l.path);s=s.updateChild(u,l.currentOutputSnapshotRaw)}var h=s.val(!0),d=t;e.server_.put(d.toString(),h,function(r){ni(e,"transaction put response",{path:d.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=function(t){n[t].status=2,i=i.concat($n(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push(function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)}),n[t].unwatcher()},a=0;a<n.length;a++)s(a);for(ui(e,gr(e.transactionQueueTree_,t)),oi(e,e.transactionQueueTree_),Vr(e.eventQueue_,t,i),a=0;a<o.length;a++)j(o[a])}else{if("datastale"===r)for(a=0;a<n.length;a++)n[a].status=3===n[a].status?4:0;else for(P("transaction at "+d.toString()+" failed: "+r),a=0;a<n.length;a++)n[a].status=4,n[a].abortReason=r;si(e,t)}},a)}(e,wr(t),n)}else vr(t)&&br(t,function(t){oi(e,t)})}function si(e,t){var n=ai(e,t),r=wr(n);return function(e,t,n){if(0!==t.length){for(var r=[],o=[],s=t.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),a=function(a){var c,l=t[a],u=ye(n,l.path),h=!1;if(Object(i.d)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,c=l.abortReason,o=o.concat($n(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)h=!0,c="maxretry",o=o.concat($n(e.serverSyncTree_,l.currentWriteId,!0));else{var d=ii(e,l.path,s);l.currentInputSnapshot=d;var f=t[a].update(d.val());if(void 0!==f){Ar("transaction failed: Data returned ",f,l.path);var p=et(f);"object"==typeof f&&null!=f&&Object(i.h)(f,".priority")||(p=p.updatePriority(d.getPriority()));var g=l.currentWriteId,m=qr(e),y=dr(p,d,m);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=y,l.currentWriteId=Yr(e),s.splice(s.indexOf(g),1),o=(o=o.concat(Gn(e.serverSyncTree_,l.path,y,l.currentWriteId,l.applyLocally))).concat($n(e.serverSyncTree_,g,!0))}else h=!0,c="nodata",o=o.concat($n(e.serverSyncTree_,l.currentWriteId,!0))}Vr(e.eventQueue_,n,o),o=[],h&&(t[a].status=2,setTimeout(t[a].unwatcher,Math.floor(0)),t[a].onComplete&&r.push("nodata"===c?function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)}:function(){return t[a].onComplete(new Error(c),!1,null)}))},c=0;c<t.length;c++)a(c);for(ui(e,e.transactionQueueTree_),c=0;c<r.length;c++)j(r[c]);oi(e,e.transactionQueueTree_)}}(e,ci(e,n),r),r}function ai(e,t){var n,r=e.transactionQueueTree_;for(n=le(t);null!==n&&void 0===mr(r);)r=gr(r,n),n=le(t=he(t));return r}function ci(e,t){var n=[];return li(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function li(e,t,n){var r=mr(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);br(t,function(t){li(e,t,n)})}function ui(e,t){var n=mr(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,yr(t,n.length>0?n:void 0)}br(t,function(t){ui(e,t)})}function hi(e,t){var n=wr(ai(e,t)),r=gr(e.transactionQueueTree_,t);return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,function(t){di(e,t)}),di(e,r),_r(r,function(t){di(e,t)}),n}function di(e,t){var n=mr(t);if(n){for(var r=[],o=[],s=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?(Object(i.d)(s===a-1,"All SENT items should be at beginning of queue."),s=a,n[a].status=3,n[a].abortReason="set"):(Object(i.d)(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),o=o.concat($n(e.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));for(-1===s?yr(t,void 0):n.length=s+1,Vr(e.eventQueue_,wr(t),o),a=0;a<r.length;a++)j(r[a])}}var fi=function(e,t){var n=pi(e),r=n.namespace;return"firebase.com"===n.domain&&S(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&P("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new $(n.host,n.secure,r,t,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new ae(n.pathString)}},pi=function(e){var t="",n="",r="",i="",s="",a=!0,c="https",l=443;if("string"==typeof e){var u=e.indexOf("//");u>=0&&(c=e.substring(0,u-1),e=e.substring(u+2));var h=e.indexOf("/");-1===h&&(h=e.length);var d=e.indexOf("?");-1===d&&(d=e.length),t=e.substring(0,Math.min(h,d)),h<d&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}(e.substring(h,d)));var f=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Object(o.g)(e.split("&")),s=i.next();!s.done;s=i.next()){var a=s.value;if(0!==a.length){var c=a.split("=");2===c.length?r[decodeURIComponent(c[0])]=decodeURIComponent(c[1]):P("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch(l){t={error:l}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,d)));(u=t.indexOf(":"))>=0?(a="https"===c||"wss"===c,l=parseInt(t.substring(u+1),10)):u=t.length;var p=t.slice(0,u);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var g=t.indexOf(".");r=t.substring(0,g).toLowerCase(),n=t.substring(g+1),s=r}"ns"in f&&(s=f.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:a,scheme:c,pathString:i,namespace:s}},gi=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(i.I)(this.snapshot.exportVal())},e}(),mi=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),yi=function(){function e(e,t){this.snapshotCallback=e,this.cancelCallback=t}return e.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},e.prototype.onCancel=function(e){return Object(i.d)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(e.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),e.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},e}(),vi=function(){function e(e,t){this._repo=e,this._path=t}return e.prototype.cancel=function(){var e=new i.a;return Jr(this._repo,this._path,e.wrapCallback(function(){})),e.promise},e.prototype.remove=function(){Dr("OnDisconnect.remove",this._path);var e=new i.a;return Xr(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise},e.prototype.set=function(e){Dr("OnDisconnect.set",this._path),Tr("OnDisconnect.set",e,this._path,!1);var t=new i.a;return Xr(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise},e.prototype.setWithPriority=function(e,t){Dr("OnDisconnect.setWithPriority",this._path),Tr("OnDisconnect.setWithPriority",e,this._path,!1),Nr("OnDisconnect.setWithPriority",t,!1);var n=new i.a;return function(e,t,n,r,i){var o=et(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),function(n,r){"ok"===n&&St(e.onDisconnect_,t,o),ri(0,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(function(){})),n.promise},e.prototype.update=function(e){Dr("OnDisconnect.update",this._path),kr("OnDisconnect.update",e,this._path,!1);var t=new i.a;return function(e,t,n,r){if(Object(i.t)(n))return C("onDisconnect().update() called with empty data.  Don't do anything."),void ri(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,function(i,o){"ok"===i&&D(n,function(n,r){var i=et(r);St(e.onDisconnect_,ge(t,n),i)}),ri(0,r,i,o)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise},e}(),bi=function(){function e(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(e.prototype,"key",{get:function(){return me(this._path)?null:de(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ei(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryIdentifier",{get:function(){var e=wt(this._queryParams),t=x(e);return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryObject",{get:function(){return wt(this._queryParams)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!((t=Object(i.n)(t))instanceof e))return!1;var n=this._repo===t._repo,r=be(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier},e.prototype.toJSON=function(){return this.toString()},e.prototype.toString=function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)},e}();function _i(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function wi(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Ne){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==T)throw new Error(r);if("string"!=typeof t)throw new Error(o)}if(e.hasEnd()){if(e.getIndexEndName()!==A)throw new Error(r);if("string"!=typeof n)throw new Error(o)}}else if(e.getIndex()===qe){if(null!=t&&!Ir(t)||null!=n&&!Ir(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(i.d)(e.getIndex()instanceof rt||e.getIndex()===it,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ci(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Ei=function(e){function t(t,n){return e.call(this,t,n,new mt,!1)||this}return Object(o.c)(t,e),Object.defineProperty(t.prototype,"parent",{get:function(){var e=pe(this._path);return null===e?null:new t(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),t}(bi),Oi=function(){function e(e,t,n){this._node=e,this.ref=t,this._index=n}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),e.prototype.child=function(t){var n=new ae(t),r=Ii(this.ref,t);return new e(this._node.getChild(n),r,qe)},e.prototype.exists=function(){return!this._node.isEmpty()},e.prototype.exportVal=function(){return this._node.val(!0)},e.prototype.forEach=function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,function(r,i){return t(new e(i,Ii(n.ref,r),qe))})},e.prototype.hasChild=function(e){var t=new ae(e);return!this._node.getChild(t).isEmpty()},e.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},e.prototype.toJSON=function(){return this.exportVal()},e.prototype.val=function(){return this._node.val()},e}();function Si(e,t){return(e=Object(i.n)(e))._checkNotDeleted("ref"),void 0!==t?Ii(e._root,t):e._root}function Pi(e,t){(e=Object(i.n)(e))._checkNotDeleted("refFromURL");var n=fi(t,e._repo.repoInfo_.nodeAdmin);Lr("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||S("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Si(e,n.path.toString())}function Ii(e,t){var n;return null===le((e=Object(i.n)(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Rr("child","path",n,!1)):Rr("child","path",t,!1),new Ei(e._repo,ge(e._path,t))}function Ti(e,t){e=Object(i.n)(e),Dr("push",e._path),Tr("push",t,e._path,!0);var n,r=$r(e._repo),o=st(r),s=Ii(e,o),a=Ii(e,o);return n=null!=t?ki(a,t).then(function(){return a}):Promise.resolve(a),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),s}function Ai(e){return Dr("remove",e._path),ki(e,null)}function ki(e,t){e=Object(i.n)(e),Dr("set",e._path),Tr("set",t,e._path,!1);var n=new i.a;return Kr(e._repo,e._path,t,null,n.wrapCallback(function(){})),n.promise}function Ni(e,t){e=Object(i.n)(e),Dr("setPriority",e._path),Nr("setPriority",t,!1);var n=new i.a;return Kr(e._repo,ge(e._path,".priority"),t,null,n.wrapCallback(function(){})),n.promise}function Mi(e,t,n){if(Dr("setWithPriority",e._path),Tr("setWithPriority",t,e._path,!1),Nr("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new i.a;return Kr(e._repo,e._path,t,n,r.wrapCallback(function(){})),r.promise}function xi(e,t){kr("update",t,e._path,!1);var n=new i.a;return function(e,t,n,r){ni(e,"update",{path:t.toString(),value:n});var o=!0,s=qr(e),a={};if(D(n,function(n,r){o=!1,a[n]=hr(ge(t,n),et(r),e.serverSyncTree_,s)}),o)C("update() called with empty data.  Don't do anything."),ri(0,r,"ok",void 0);else{var c=Yr(e),l=function(e,t,n,r){!function(e,t,n,r){Object(i.d)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Zt(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var o=$t.fromObject(n);return Yn(e,new Lt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,o))}(e.serverSyncTree_,t,a,c);jr(e.eventQueue_,l),e.server_.merge(t.toString(),n,function(n,i){var o="ok"===n;o||P("update at "+t+" failed: "+n);var s=$n(e.serverSyncTree_,c,!o),a=s.length>0?si(e,t):t;Vr(e.eventQueue_,a,s),ri(0,r,n,i)}),D(n,function(n){var r=hi(e,ge(t,n));si(e,r)}),Vr(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback(function(){})),n.promise}var Ri=function(){function e(e){this.callbackContext=e}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new gi("value",this,new Oi(e.snapshotNode,new Ei(t._repo,t._path),n))},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new mi(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))},e.prototype.hasAnyCallback=function(){return null!==this.callbackContext},e}(),Di=function(){function e(e,t){this.eventType=e,this.callbackContext=t}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return this.eventType===("children_removed"===t?"child_removed":t)},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new mi(this,e,t):null},e.prototype.createEvent=function(e,t){Object(i.d)(null!=e.childName,"Child events should have a childName.");var n=Ii(new Ei(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new gi(e.type,this,new Oi(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}},e.prototype.matches=function(t){return t instanceof e&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))},e.prototype.hasAnyCallback=function(){return!!this.callbackContext},e}();function Li(e,t,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var s=n,a=function(t,n){ei(e._repo,e,l),s(t,n)};a.userCallback=n.userCallback,a.context=n.context,n=a}var c=new yi(n,o||void 0),l="value"===t?new Ri(c):new Di(t,c);return function(e,t,n){var r;r=".info"===le(t._path)?Zn(e.infoSyncTree_,t,n):Zn(e.serverSyncTree_,t,n),Ur(e.eventQueue_,t._path,r)}(e._repo,e,l),function(){return ei(e._repo,e,l)}}function Bi(e,t,n,r){return Li(e,"value",t,n,r)}function Fi(e,t,n,r){return Li(e,"child_added",t,n,r)}function ji(e,t,n,r){return Li(e,"child_changed",t,n,r)}function Ui(e,t,n,r){return Li(e,"child_moved",t,n,r)}function Vi(e,t,n,r){return Li(e,"child_removed",t,n,r)}function zi(e,t,n){var r=null,i=n?new yi(n):null;"value"===t?r=new Ri(i):t&&(r=new Di(t,i)),ei(e._repo,e,r)}var Hi=function(){return function(){}}(),Gi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Tr("endAt",this._value,e._path,!0);var t=vt(e._queryParams,this._value,this._key);if(Ci(t),wi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)},t}(Hi);function $i(e,t){return xr("endAt","key",t,!0),new Gi(e,t)}var qi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Tr("endBefore",this._value,e._path,!1);var t,n,r,i,o=(n=this._value,r=this._key,(t=e._queryParams).index_===Ne?("string"==typeof n&&(n=ct(n)),i=vt(t,n,r)):i=vt(t,n,null==r?T:ct(r)),i.endBeforeSet_=!0,i);if(Ci(o),wi(o),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,o,e._orderByCalled)},t}(Hi);function Wi(e,t){return xr("endBefore","key",t,!0),new qi(e,t)}var Zi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Tr("startAt",this._value,e._path,!0);var t=yt(e._queryParams,this._value,this._key);if(Ci(t),wi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)},t}(Hi);function Qi(e,t){return void 0===e&&(e=null),xr("startAt","key",t,!0),new Zi(e,t)}var Yi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Tr("startAfter",this._value,e._path,!1);var t,n,r,i,o=(n=this._value,r=this._key,(t=e._queryParams).index_===Ne?("string"==typeof n&&(n=at(n)),i=yt(t,n,r)):i=yt(t,n,null==r?A:at(r)),i.startAfterSet_=!0,i);if(Ci(o),wi(o),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new bi(e._repo,e._path,o,e._orderByCalled)},t}(Hi);function Ki(e,t){return xr("startAfter","key",t,!0),new Yi(e,t)}var Ji=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(o.c)(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,(t=this._limit,(n=e._queryParams.copy()).limitSet_=!0,n.limit_=t,n.viewFrom_="l",n),e._orderByCalled);var t,n},t}(Hi);function Xi(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Ji(e)}var eo=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(o.c)(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,(t=this._limit,(n=e._queryParams.copy()).limitSet_=!0,n.limit_=t,n.viewFrom_="r",n),e._orderByCalled);var t,n},t}(Hi);function to(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new eo(e)}var no=function(e){function t(t){var n=e.call(this)||this;return n._path=t,n}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByChild");var t=new ae(this._path);if(me(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new rt(t),r=bt(e._queryParams,n);return wi(r),new bi(e._repo,e._path,r,!0)},t}(Hi);function ro(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Rr("orderByChild","path",e,!1),new no(e)}var io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByKey");var t=bt(e._queryParams,Ne);return wi(t),new bi(e._repo,e._path,t,!0)},t}(Hi);function oo(){return new io}var so=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByPriority");var t=bt(e._queryParams,qe);return wi(t),new bi(e._repo,e._path,t,!0)},t}(Hi);function ao(){return new so}var co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByValue");var t=bt(e._queryParams,it);return wi(t),new bi(e._repo,e._path,t,!0)},t}(Hi);function lo(){return new co}var uo=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){if(Tr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Gi(this._value,this._key)._apply(new Zi(this._value,this._key)._apply(e))},t}(Hi);function ho(e,t){return xr("equalTo","key",t,!0),new uo(e,t)}function fo(e){for(var t,n,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var a=Object(i.n)(e);try{for(var c=Object(o.g)(r),l=c.next();!l.done;l=c.next()){var u=l.value;a=u._apply(a)}}catch(h){t={error:h}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a}!function(e){Object(i.d)(!Sn,"__referenceConstructor has already been defined"),Sn=e}(Ei),function(e){Object(i.d)(!Mn,"__referenceConstructor has already been defined"),Mn=e}(Ei);var po={},go=!1;function mo(e,t,n,r,i){var o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||S("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),C("Using default host for project ",e.options.projectId),o=e.options.projectId+"-default-rtdb.firebaseio.com");var s,a=fi(o,i),c=a.repoInfo,l=void 0;"undefined"!=typeof process&&(l=process.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(s=!0,c=(a=fi(o="http://"+l+"?ns="+c.namespace,i)).repoInfo):s=!a.repoInfo.secure;var u=i&&s?new H(H.OWNER):new z(e.name,e.options,t);Lr("Invalid Firebase Database URL",a),me(a.path)||S("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=po[t.name];i||(po[t.name]=i={});var o=i[e.toURLString()];return o&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Gr(e,go,n,r),i[e.toURLString()]=o,o}(c,e,u,new V(e.name,n));return new yo(h,e)}var yo=function(){function e(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}return Object.defineProperty(e.prototype,"_repo",{get:function(){return this._instanceStarted||(function(e,t,n){if(e.stats_=Y(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ct(e.repoInfo_,function(t,n,r,i){Wr(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(function(){return Zr(e,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(i.I)(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}e.persistentConnection_=new Ie(e.repoInfo_,t,function(t,n,r,i){Wr(e,t,n,r,i)},function(t){Zr(e,t)},function(t){!function(e,t){D(t,function(t,n){Qr(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,o;e.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(function(t){e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=(r=function(){return new At(e.stats_,e.server_)},o=e.repoInfo_.toString(),Q[o]||(Q[o]=r()),Q[o]),e.infoData_=new Et,e.infoSyncTree_=new Hn({startListening:function(t,n,r,i){var o=[],s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=qn(e.infoSyncTree_,t._path,s),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),Qr(e,"connected",!1),e.serverSyncTree_=new Hn({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,function(n,r){var o=i(n,r);Vr(e.eventQueue_,t._path,o)}),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Ei(this._repo,ce())),this._rootInternal},enumerable:!1,configurable:!0}),e.prototype._delete=function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,(n=po[t=this.app.name])&&n[e.key]===e||S("Database "+t+"("+e.repoInfo_+") has already been deleted."),ti(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()},e.prototype._checkNotDeleted=function(e){null===this._rootInternal&&S("Cannot call "+e+" on a deleted database.")},e}();function vo(e){(e=Object(i.n)(e))._checkNotDeleted("goOffline"),ti(e._repo)}function bo(e){var t;(e=Object(i.n)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume("repo_interrupt")}var _o={".sv":"timestamp"},wo=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();function Co(e,t,n){var r;if(e=Object(i.n)(e),Dr("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var o=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new i.a,a=Bi(e,function(){});return function(t,n,r,o,a,c){ni(t,"transaction on "+n);var l={path:n,update:r,onComplete:function(t,n,r){var i=null;t?s.reject(t):(i=new Oi(r,new Ei(e._repo,e._path),qe),s.resolve(new wo(n,i)))},status:null,order:m(),applyLocally:c,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=ii(t,n,void 0);l.currentInputSnapshot=u;var h=l.update(u.val());if(void 0===h)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{Ar("transaction failed: Data returned ",h,l.path),l.status=0;var d=gr(t.transactionQueueTree_,n),f=mr(d)||[];f.push(l),yr(d,f);var p=void 0;"object"==typeof h&&null!==h&&Object(i.h)(h,".priority")?(p=Object(i.F)(h,".priority"),Object(i.d)(Ir(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(Qn(t.serverSyncTree_,n)||Je.EMPTY_NODE).getPriority().val();var g=qr(t),y=et(h,p),v=dr(y,u,g);l.currentOutputSnapshotRaw=y,l.currentOutputSnapshotResolved=v,l.currentWriteId=Yr(t);var b=Gn(t.serverSyncTree_,n,v,l.currentWriteId,l.applyLocally);Vr(t.eventQueue_,n,b),oi(t,t.transactionQueueTree_)}}(e._repo,e._path,t,0,a,o),s.promise}var Eo=function(){function e(e){this._delegate=e}return e.prototype.cancel=function(e){Object(i.J)("OnDisconnect.cancel",0,1,arguments.length),Object(i.K)("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then(function(){return e(null)},function(t){return e(t)}),t},e.prototype.remove=function(e){Object(i.J)("OnDisconnect.remove",0,1,arguments.length),Object(i.K)("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then(function(){return e(null)},function(t){return e(t)}),t},e.prototype.set=function(e,t){Object(i.J)("OnDisconnect.set",1,2,arguments.length),Object(i.K)("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},e.prototype.setWithPriority=function(e,t,n){Object(i.J)("OnDisconnect.setWithPriority",2,3,arguments.length),Object(i.K)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then(function(){return n(null)},function(e){return n(e)}),r},e.prototype.update=function(e,t){if(Object(i.J)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,P("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(i.K)("OnDisconnect.update","onComplete",t,!0);var o=this._delegate.update(e);return t&&o.then(function(){return t(null)},function(e){return t(e)}),o},e}(),Oo=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return Object(i.J)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),So=function(){function e(e,t){this._database=e,this._delegate=t}return e.prototype.val=function(){return Object(i.J)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},e.prototype.exportVal=function(){return Object(i.J)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},e.prototype.toJSON=function(){return Object(i.J)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.exists=function(){return Object(i.J)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},e.prototype.child=function(t){return Object(i.J)("DataSnapshot.child",0,1,arguments.length),t=String(t),Rr("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))},e.prototype.hasChild=function(e){return Object(i.J)("DataSnapshot.hasChild",1,1,arguments.length),Rr("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},e.prototype.getPriority=function(){return Object(i.J)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},e.prototype.forEach=function(t){var n=this;return Object(i.J)("DataSnapshot.forEach",1,1,arguments.length),Object(i.K)("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(function(r){return t(new e(n._database,r))})},e.prototype.hasChildren=function(){return Object(i.J)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(e.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return Object(i.J)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},e.prototype.getRef=function(){return Object(i.J)("DataSnapshot.ref",0,0,arguments.length),new Io(this._database,this._delegate.ref)},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),Po=function(){function e(e,t){this.database=e,this._delegate=t}return e.prototype.on=function(t,n,r,o){var s,a=this;Object(i.J)("Query.on",2,4,arguments.length),Object(i.K)("Query.on","callback",n,!1);var c=e.getCancelAndContextArgs_("Query.on",r,o),l=function(e,t){n.call(c.context,new So(a.database,e),t)};l.userCallback=n,l.context=c.context;var u=null===(s=c.cancel)||void 0===s?void 0:s.bind(c.context);switch(t){case"value":return Bi(this._delegate,l,u),n;case"child_added":return Fi(this._delegate,l,u),n;case"child_removed":return Vi(this._delegate,l,u),n;case"child_changed":return ji(this._delegate,l,u),n;case"child_moved":return Ui(this._delegate,l,u),n;default:throw new Error(Object(i.m)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.prototype.off=function(e,t,n){if(Object(i.J)("Query.off",0,3,arguments.length),Mr("Query.off",e,!0),Object(i.K)("Query.off","callback",t,!0),Object(i.L)("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,zi(this._delegate,e,r)}else zi(this._delegate,e)},e.prototype.get=function(){var e=this;return function(e){return function(e,t){var n=function(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,function(e,t){var i=ye(e,n);r=r||Bn(t,i)});var i=e.syncPointTree_.get(n);i?r=r||Bn(i,ce()):(i=new xn,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,s=o?new Bt(r,!0,!1):null;return Ht(Dn(i,t,rn(e.pendingWriteTree_,t._path),o?s.getNode():Je.EMPTY_NODE,o).viewCache_)}(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then(function(n){var r=et(n).withIndex(t._queryParams.getIndex()),i=qn(e.serverSyncTree_,t._path,r);return Ur(e.eventQueue_,t._path,i),Promise.resolve(r)},function(n){return ni(e,"get for query "+Object(i.I)(t)+" failed: "+n),Promise.reject(new Error(n))})}((e=Object(i.n)(e))._repo,e).then(function(t){return new Oi(t,new Ei(e._repo,e._path),e._queryParams.getIndex())})}(this._delegate).then(function(t){return new So(e.database,t)})},e.prototype.once=function(t,n,r,o){var s=this;Object(i.J)("Query.once",1,4,arguments.length),Object(i.K)("Query.once","callback",n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,o),c=new i.a,l=function(e,t){var r=new So(s.database,e);n&&n.call(a.context,r,t),c.resolve(r)};l.userCallback=n,l.context=a.context;var u=function(e){a.cancel&&a.cancel.call(a.context,e),c.reject(e)};switch(t){case"value":Bi(this._delegate,l,u,{onlyOnce:!0});break;case"child_added":Fi(this._delegate,l,u,{onlyOnce:!0});break;case"child_removed":Vi(this._delegate,l,u,{onlyOnce:!0});break;case"child_changed":ji(this._delegate,l,u,{onlyOnce:!0});break;case"child_moved":Ui(this._delegate,l,u,{onlyOnce:!0});break;default:throw new Error(Object(i.m)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise},e.prototype.limitToFirst=function(t){return Object(i.J)("Query.limitToFirst",1,1,arguments.length),new e(this.database,fo(this._delegate,Xi(t)))},e.prototype.limitToLast=function(t){return Object(i.J)("Query.limitToLast",1,1,arguments.length),new e(this.database,fo(this._delegate,to(t)))},e.prototype.orderByChild=function(t){return Object(i.J)("Query.orderByChild",1,1,arguments.length),new e(this.database,fo(this._delegate,ro(t)))},e.prototype.orderByKey=function(){return Object(i.J)("Query.orderByKey",0,0,arguments.length),new e(this.database,fo(this._delegate,oo()))},e.prototype.orderByPriority=function(){return Object(i.J)("Query.orderByPriority",0,0,arguments.length),new e(this.database,fo(this._delegate,ao()))},e.prototype.orderByValue=function(){return Object(i.J)("Query.orderByValue",0,0,arguments.length),new e(this.database,fo(this._delegate,lo()))},e.prototype.startAt=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.startAt",0,2,arguments.length),new e(this.database,fo(this._delegate,Qi(t,n)))},e.prototype.startAfter=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.startAfter",0,2,arguments.length),new e(this.database,fo(this._delegate,Ki(t,n)))},e.prototype.endAt=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.endAt",0,2,arguments.length),new e(this.database,fo(this._delegate,$i(t,n)))},e.prototype.endBefore=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.endBefore",0,2,arguments.length),new e(this.database,fo(this._delegate,Wi(t,n)))},e.prototype.equalTo=function(t,n){return Object(i.J)("Query.equalTo",1,2,arguments.length),new e(this.database,fo(this._delegate,ho(t,n)))},e.prototype.toString=function(){return Object(i.J)("Query.toString",0,0,arguments.length),this._delegate.toString()},e.prototype.toJSON=function(){return Object(i.J)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.isEqual=function(t){if(Object(i.J)("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Object(i.K)(e,"cancel",r.cancel,!0),r.context=n,Object(i.L)(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Object(i.m)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return new Io(this.database,new Ei(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),e}(),Io=function(e){function t(t,n){var r=e.call(this,t,new bi(n._repo,n._path,new mt,!1))||this;return r.database=t,r._delegate=n,r}return Object(o.c)(t,e),t.prototype.getKey=function(){return Object(i.J)("Reference.key",0,0,arguments.length),this._delegate.key},t.prototype.child=function(e){return Object(i.J)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new t(this.database,Ii(this._delegate,e))},t.prototype.getParent=function(){Object(i.J)("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new t(this.database,e):null},t.prototype.getRoot=function(){return Object(i.J)("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)},t.prototype.set=function(e,t){Object(i.J)("Reference.set",1,2,arguments.length),Object(i.K)("Reference.set","onComplete",t,!0);var n=ki(this._delegate,e);return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},t.prototype.update=function(e,t){if(Object(i.J)("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,P("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Dr("Reference.update",this._delegate._path),Object(i.K)("Reference.update","onComplete",t,!0);var o=xi(this._delegate,e);return t&&o.then(function(){return t(null)},function(e){return t(e)}),o},t.prototype.setWithPriority=function(e,t,n){Object(i.J)("Reference.setWithPriority",2,3,arguments.length),Object(i.K)("Reference.setWithPriority","onComplete",n,!0);var r=Mi(this._delegate,e,t);return n&&r.then(function(){return n(null)},function(e){return n(e)}),r},t.prototype.remove=function(e){Object(i.J)("Reference.remove",0,1,arguments.length),Object(i.K)("Reference.remove","onComplete",e,!0);var t=Ai(this._delegate);return e&&t.then(function(){return e(null)},function(t){return e(t)}),t},t.prototype.transaction=function(e,t,n){var r=this;Object(i.J)("Reference.transaction",1,3,arguments.length),Object(i.K)("Reference.transaction","transactionUpdate",e,!1),Object(i.K)("Reference.transaction","onComplete",t,!0),Br("Reference.transaction","applyLocally",n,!0);var o=Co(this._delegate,e,{applyLocally:n}).then(function(e){return new Oo(e.committed,new So(r.database,e.snapshot))});return t&&o.then(function(e){return t(null,e.committed,e.snapshot)},function(e){return t(e,!1,null)}),o},t.prototype.setPriority=function(e,t){Object(i.J)("Reference.setPriority",1,2,arguments.length),Object(i.K)("Reference.setPriority","onComplete",t,!0);var n=Ni(this._delegate,e);return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},t.prototype.push=function(e,n){var r=this;Object(i.J)("Reference.push",0,2,arguments.length),Object(i.K)("Reference.push","onComplete",n,!0);var o=Ti(this._delegate,e),s=o.then(function(e){return new t(r.database,e)});n&&s.then(function(){return n(null)},function(e){return n(e)});var a=new t(this.database,o);return a.then=s.then.bind(s),a.catch=s.catch.bind(s,void 0),a},t.prototype.onDisconnect=function(){return Dr("Reference.onDisconnect",this._delegate._path),new Eo(new vi(this._delegate._repo,this._delegate._path))},Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(Po),To=function(){function e(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),function(e,t,n,r){void 0===r&&(r={}),(e=Object(i.n)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&S("Cannot call useEmulator() after instance has already been initialized.");var o=e._repoInternal,s=void 0;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&S('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new H(H.OWNER);else if(r.mockUserToken){var a="string"==typeof r.mockUserToken?r.mockUserToken:Object(i.i)(r.mockUserToken,e.app.options.projectId);s=new H(a)}!function(e,t,n,r){e.repoInfo_=new $(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(o,t,n,s)}(this._delegate,e,t,n)},e.prototype.ref=function(e){if(Object(i.J)("database.ref",0,1,arguments.length),e instanceof Io){var t=Pi(this._delegate,e.toString());return new Io(this,t)}return t=Si(this._delegate,e),new Io(this,t)},e.prototype.refFromURL=function(e){var t="database.refFromURL";Object(i.J)(t,1,1,arguments.length);var n=Pi(this._delegate,e);return new Io(this,n)},e.prototype.goOffline=function(){return Object(i.J)("database.goOffline",0,0,arguments.length),vo(this._delegate)},e.prototype.goOnline=function(){return Object(i.J)("database.goOnline",0,0,arguments.length),bo(this._delegate)},e.ServerValue={TIMESTAMP:_o,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}},e}(),Ao=Object.freeze({__proto__:null,forceLongPolling:function(){te.forceDisallow(),J.forceAllow()},forceWebSockets:function(){J.forceDisallow()},isWebSocketsAvailable:function(){return te.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var n;t?(e.statsListener_||(e.statsListener_=new Tt(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();var r=Object.keys(n).reduce(function(e,t){return Math.max(t.length,e)},0);D(n,function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)})}}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){e.stats_.incrementCounter(t),e.statsReporter_.statsToReport_[t]=!0}(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function(e){var t=e.app,n=e.url,i=e.customAuthImpl,o=e.namespace,s=e.nodeAdmin,a=void 0!==s&&s;c(e.version);var l=new r.c("auth-internal",new r.b("database-standalone"));return l.setComponent(new r.a("auth-internal",function(){return i},"PRIVATE")),{instance:new To(mo(t,l,void 0,n,a),t),namespace:o}}}),ko=Ie;Ie.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Ie.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var No=Object.freeze({__proto__:null,DataConnection:ko,RealTimeConnection:re,hijackHash:function(e){var t=Ie.prototype.put;return Ie.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Ie.prototype.put=t}},ConnectionTarget:$,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){!function(e){go=e}(e)}}),Mo=To.ServerValue;!function(t){c(t.SDK_VERSION);var n=t.INTERNAL.registerComponent(new r.a("database",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new To(mo(r,i,o,n),r)},"PUBLIC").setServiceProps({Reference:Io,Query:Po,Database:To,DataSnapshot:So,enableLogging:w,INTERNAL:Ao,ServerValue:Mo,TEST_ACCESS:No}).setMultipleInstances(!0));t.registerVersion("@firebase/database","0.11.0"),Object(i.x)()&&(e.exports=n)}(t.a)}).call(this,n("3UD+")(e))},"6nsN":function(e,t,n){"use strict";n.r(t);var r=n("zIRd");(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},n=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}return globalThis}(this);function i(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function o(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:i(e)}}!function(e,r){if(r){var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];s in i||(i[s]={}),i=i[s]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Promise",function(e){function t(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function r(){this.a=null}function i(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;r.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c(function(){t.g()})}this.a.push(e)};var s=n.setTimeout;r.prototype.c=function(e){s(e,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(e){this.c(function(){throw e})},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.m),reject:e(this.g)}},t.prototype.m=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.s(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.v(e):this.h(e)}},t.prototype.v=function(e){var t=void 0;try{t=e.then}catch(n){return void this.g(n)}"function"==typeof t?this.u(t,e):this.h(e)},t.prototype.g=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)a.b(this.a[e]);this.a=null}};var a=new r;return t.prototype.s=function(e){var t=this.f();e.Ra(t.resolve,t.reject)},t.prototype.u=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(n){o(n)}}:t}var i,o,s=new t(function(e,t){i=e,o=t});return this.Ra(r(e,i),r(n,o)),s},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Ra=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},t.resolve=i,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var r=o(e),s=r.next();!s.done;s=r.next())i(s.value).Ra(t,n)})},t.all=function(e){var n=o(e),r=n.next();return r.done?i([]):new t(function(e,t){function o(t){return function(n){s[t]=n,0==--a&&e(s)}}var s=[],a=0;do{s.push(void 0),a++,i(r.value).Ra(o(s.length-1),t),r=n.next()}while(!r.done)})},t});var s=s||{},a=this||self,c=/^[\w+/_-]+[=]{0,2}$/,l=null;function u(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&c.test(e)?e:""}function h(){}function d(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function f(e){var t=d(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){return"function"==d(e)}function g(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function m(e){return Object.prototype.hasOwnProperty.call(e,y)&&e[y]||(e[y]=++v)}var y="closure_uid_"+(1e9*Math.random()>>>0),v=0;function b(e,t,n){return e.call.apply(e.bind,arguments)}function _(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function w(e,t,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:_).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var E=Date.now;function O(e,t){function n(){}n.prototype=t.prototype,e.bb=t.prototype,e.prototype=new n,e.prototype.constructor=e}function S(e){return e}function P(e,t,n){this.code=A+e,this.message=t||k[e]||"",this.a=n||null}function I(e){var t=e&&e.code;return t?new P(t.substring(A.length),e.message,e.serverResponse):null}O(P,Error),P.prototype.w=function(){var e={code:this.code,message:this.message};return this.a&&(e.serverResponse=this.a),e},P.prototype.toJSON=function(){return this.w()};var T,A="auth/",k={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},N={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function M(e){for(var t in N)if(N[t].id===e)return{firebaseEndpoint:(e=N[t]).Ua,secureTokenEndpoint:e.$a,identityPlatformEndpoint:e.Xa};return null}function x(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}}function R(e){if(Error.captureStackTrace)Error.captureStackTrace(this,R);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function D(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");R.call(this,n+e[r])}function L(e,t){throw new D("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function B(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function F(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function j(){this.b=this.a=null}T=M("__EID__")?"__EID__":void 0,O(R,Error),R.prototype.name="CustomError",O(D,R),D.prototype.name="AssertionError",B.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var U=new B(function(){return new z},function(e){e.reset()});function V(){var e=vt,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function z(){this.next=this.b=this.a=null}j.prototype.add=function(e,t){var n=U.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},z.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},z.prototype.reset=function(){this.next=this.b=this.a=null};var H=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},G=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)},$=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=[],i=0,o="string"==typeof e?e.split(""):e,s=0;s<n;s++)if(s in o){var a=o[s];t.call(void 0,a,s,e)&&(r[i++]=a)}return r},q=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"==typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},W=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function Z(e,t){return 0<=H(e,t)}function Q(e,t){var n;return(n=0<=(t=H(e,t)))&&Array.prototype.splice.call(e,t,1),n}function Y(e,t){!function(e,t){for(var n="string"==typeof e?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(e,function(n,r){t.call(void 0,n,r,e)&&Array.prototype.splice.call(e,r,1)})}function K(e){return Array.prototype.concat.apply([],arguments)}function J(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var X,ee=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},te=/&/g,ne=/</g,re=/>/g,ie=/"/g,oe=/'/g,se=/\x00/g,ae=/[\x00&<>"']/;function ce(e,t){return-1!=e.indexOf(t)}function le(e,t){return e<t?-1:e>t?1:0}e:{var ue=a.navigator;if(ue){var he=ue.userAgent;if(he){X=he;break e}}X=""}function de(e){return ce(X,e)}function fe(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function pe(e){for(var t in e)return!1;return!0}function ge(e){var t,n={};for(t in e)n[t]=e[t];return n}var me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<me.length;o++)n=me[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ve(e,t){e:{try{var n=e&&e.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||a).Element&&r.Location){var i=r;break e}}catch(s){}i=null}if(i&&void 0!==i[t]&&(!e||!(e instanceof i[t])&&(e instanceof i.Location||e instanceof i.Element))){if(g(e))try{var o=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(s){o="<object could not be stringified>"}else o=void 0===e?"undefined":null===e?"null":typeof e;L("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,o)}}function be(e,t){this.a=e===Ee&&t||"",this.b=Ce}function _e(e){return e instanceof be&&e.constructor===be&&e.b===Ce?e.a:(L("expected object of type Const, got '"+e+"'"),"type_error:Const")}be.prototype.ta=!0,be.prototype.sa=function(){return this.a},be.prototype.toString=function(){return"Const{"+this.a+"}"};var we,Ce={},Ee={};function Oe(){if(void 0===we){var e=null,t=a.trustedTypes;if(t&&t.createPolicy){try{e=t.createPolicy("goog#html",{createHTML:S,createScript:S,createScriptURL:S})}catch(n){a.console&&a.console.error(n.message)}we=e}else we=e}return we}function Se(e,t){this.a=t===ke?e:""}function Pe(e){return e instanceof Se&&e.constructor===Se?e.a:(L("expected object of type TrustedResourceUrl, got '"+e+"' of type "+d(e)),"type_error:TrustedResourceUrl")}function Ie(e,t){var n=_e(e);if(!Ae.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(e){var t=Oe();return new Se(e=t?t.createScriptURL(e):e,ke)}(e=n.replace(Te,function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof be?_e(e):encodeURIComponent(String(e))}))}Se.prototype.ta=!0,Se.prototype.sa=function(){return this.a.toString()},Se.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Te=/%{(\w+)}/g,Ae=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ke={};function Ne(e,t){this.a=t===Fe?e:""}function Me(e){return e instanceof Ne&&e.constructor===Ne?e.a:(L("expected object of type SafeUrl, got '"+e+"' of type "+d(e)),"type_error:SafeUrl")}Ne.prototype.ta=!0,Ne.prototype.sa=function(){return this.a.toString()},Ne.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var xe=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Re=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,De=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Le(e){if(e instanceof Ne)return e;if(e="object"==typeof e&&e.ta?e.sa():String(e),De.test(e))e=new Ne(e,Fe);else{var t=(e=(e=String(e)).replace(/(%0A|%0D)/g,"")).match(Re);e=t&&xe.test(t[1])?new Ne(e,Fe):null}return e}function Be(e){return e instanceof Ne?e:(e="object"==typeof e&&e.ta?e.sa():String(e),De.test(e)||(e="about:invalid#zClosurez"),new Ne(e,Fe))}var Fe={},je=new Ne("about:invalid#zClosurez",Fe);function Ue(e,t,n){this.a=n===Ve?e:""}Ue.prototype.ta=!0,Ue.prototype.sa=function(){return this.a.toString()},Ue.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ve={};function ze(e,t,n,r){return e=e instanceof Ne?e:Be(e),t=t||a,n=n instanceof be?_e(n):n||"",t.open(Me(e),n,r,void 0)}function He(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ge(e){return ae.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(te,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(ne,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(re,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(ie,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(oe,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(se,"&#0;"))),e}function $e(e){return $e[" "](e),e}$e[" "]=h;var qe,We,Ze=de("Opera"),Qe=de("Trident")||de("MSIE"),Ye=de("Edge"),Ke=Ye||Qe,Je=de("Gecko")&&!(ce(X.toLowerCase(),"webkit")&&!de("Edge"))&&!(de("Trident")||de("MSIE"))&&!de("Edge"),Xe=ce(X.toLowerCase(),"webkit")&&!de("Edge");function et(){var e=a.document;return e?e.documentMode:void 0}e:{var tt="",nt=(We=X,Je?/rv:([^\);]+)(\)|;)/.exec(We):Ye?/Edge\/([\d\.]+)/.exec(We):Qe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(We):Xe?/WebKit\/(\S+)/.exec(We):Ze?/(?:Version)[ \/]?(\S+)/.exec(We):void 0);if(nt&&(tt=nt?nt[1]:""),Qe){var rt=et();if(null!=rt&&rt>parseFloat(tt)){qe=String(rt);break e}}qe=tt}var it={};function ot(e){return function(e,t){var n=it;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,function(){for(var t=0,n=ee(String(qe)).split("."),r=ee(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;t=le(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||le(0==s[2].length,0==a[2].length)||le(s[2],a[2]),s=s[3],a=a[3]}while(0==t)}return 0<=t})}var st=a.document&&Qe&&(et()||parseInt(qe,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(We){}var at=!Qe||9<=Number(st);function ct(e){var t=document;return"string"==typeof e?t.getElementById(e):e}function lt(e,t){fe(t,function(t,n){t&&"object"==typeof t&&t.ta&&(t=t.sa()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:dt.hasOwnProperty(n)?e.setAttribute(dt[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t})}var ut,ht,dt={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ft(e,t,n){function r(n){n&&t.appendChild("string"==typeof n?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!f(o)||g(o)&&0<o.nodeType)r(o);else{e:{if(o&&"number"==typeof o.length){if(g(o)){var s="function"==typeof o.item||"string"==typeof o.item;break e}if(p(o)){s="function"==typeof o.item;break e}}s=!1}G(s?J(o):o,r)}}}function pt(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function gt(e){a.setTimeout(function(){throw e},0)}function mt(e,t){ht||function(){if(a.Promise&&a.Promise.resolve){var e=a.Promise.resolve(void 0);ht=function(){e.then(bt)}}else ht=function(){var e=bt;!p(a.setImmediate)||a.Window&&a.Window.prototype&&!de("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ut||(ut=function(){var e=a.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!de("Presto")&&(e=function(){var e=pt(document,"IFRAME");e.style.display="none",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=w(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!de("Trident")&&!de("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).Hb;n.Hb=null,e()}},function(e){r.next={Hb:e},r=r.next,t.port2.postMessage(0)}}return function(e){a.setTimeout(e,0)}}()),ut(e)):a.setImmediate(e)}}(),yt||(ht(),yt=!0),vt.add(e,t)}var yt=!1,vt=new j;function bt(){for(var e;e=V();){try{e.a.call(e.b)}catch(t){gt(t)}F(U,e)}yt=!1}function _t(e,t){if(this.a=wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=h)try{var n=this;e.call(t,function(e){Rt(n,Ct,e)},function(e){if(!(e instanceof Vt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(t){}Rt(n,Et,e)})}catch(r){Rt(this,Et,r)}}var wt=0,Ct=2,Et=3;function Ot(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ot.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var St=new B(function(){return new Ot},function(e){e.reset()});function Pt(e,t,n){var r=St.get();return r.g=e,r.b=t,r.f=n,r}function It(e){if(e instanceof _t)return e;var t=new _t(h);return Rt(t,Ct,e),t}function Tt(e){return new _t(function(t,n){n(e)})}function At(e,t,n){Dt(e,t,n,null)||mt(C(t,e))}function kt(e){return new _t(function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--,r[e]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&t(r)},o=0;o<e.length;o++)At(e[o],C(i,o,!0),C(i,o,!1));else t(r)})}function Nt(e,t){if(e.a==wt)if(e.c){var n=e.c;if(n.b){for(var r=0,i=null,o=null,s=n.b;s&&(s.c||(r++,s.a==e&&(i=s),!(i&&1<r)));s=s.next)i||(o=s);i&&(n.a==wt&&1==r?Nt(n,t):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):Bt(n),Ft(n,i,Et,t)))}e.c=null}else Rt(e,Et,t)}function Mt(e,t){e.b||e.a!=Ct&&e.a!=Et||Lt(e),e.f?e.f.next=t:e.b=t,e.f=t}function xt(e,t,n,r){var i=Pt(null,null,null);return i.a=new _t(function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(s){o(s)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof Vt?o(t):e(i)}catch(s){o(s)}}:o}),i.a.c=e,Mt(e,i),i.a}function Rt(e,t,n){e.a==wt&&(e===n&&(t=Et,n=new TypeError("Promise cannot resolve to itself")),e.a=1,Dt(n,e.$c,e.ad,e)||(e.i=n,e.a=t,e.c=null,Lt(e),t!=Et||n instanceof Vt||function(e,t){e.g=!0,mt(function(){e.g&&Ut.call(null,t)})}(e,n)))}function Dt(e,t,n,r){if(e instanceof _t)return Mt(e,Pt(t||h,n||null,r)),!0;if(x(e))return e.then(t,n,r),!0;if(g(e))try{var i=e.then;if(p(i))return function(e,t,n,r,i){function o(e){s||(s=!0,r.call(i,e))}var s=!1;try{t.call(e,function(e){s||(s=!0,n.call(i,e))},o)}catch(a){o(a)}}(e,i,t,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Lt(e){e.h||(e.h=!0,mt(e.gc,e))}function Bt(e){var t=null;return e.b&&(e.b=(t=e.b).next,t.next=null),e.b||(e.f=null),t}function Ft(e,t,n,r){if(n==Et&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,jt(t,n,r);else try{t.c?t.g.call(t.f):jt(t,n,r)}catch(i){Ut.call(null,i)}F(St,t)}function jt(e,t,n){t==Ct?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}_t.prototype.then=function(e,t,n){return xt(this,p(e)?e:null,p(t)?t:null,n)},_t.prototype.$goog_Thenable=!0,(e=_t.prototype).oa=function(e,t){return(e=Pt(e,e,t)).c=!0,Mt(this,e),this},e.o=function(e,t){return xt(this,null,e,t)},e.cancel=function(e){if(this.a==wt){var t=new Vt(e);mt(function(){Nt(this,t)},this)}},e.$c=function(e){this.a=wt,Rt(this,Ct,e)},e.ad=function(e){this.a=wt,Rt(this,Et,e)},e.gc=function(){for(var e;e=Bt(this);)Ft(this,e,this.a,this.i);this.h=!1};var Ut=gt;function Vt(e){R.call(this,e)}function zt(){0!=Ht&&(Gt[m(this)]=this),this.ya=this.ya,this.pa=this.pa}O(Vt,R),Vt.prototype.name="cancel";var Ht=0,Gt={};function $t(e){if(!e.ya&&(e.ya=!0,e.Da(),0!=Ht)){var t=m(e);if(0!=Ht&&e.pa&&0<e.pa.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Gt[t]}}zt.prototype.ya=!1,zt.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var qt=Object.freeze||function(e){return e},Wt=!Qe||9<=Number(st),Zt=Qe&&!ot("9"),Qt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",h,t),a.removeEventListener("test",h,t)}catch(n){}return e}();function Yt(e,t){this.type=e,this.b=this.target=t,this.defaultPrevented=!1}function Kt(e,t){if(Yt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(Je){e:{try{$e(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Jt[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}Yt.prototype.preventDefault=function(){this.defaultPrevented=!0},O(Kt,Yt);var Jt=qt({2:"touch",3:"pen",4:"mouse"});Kt.prototype.preventDefault=function(){Kt.bb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Zt)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}},Kt.prototype.g=function(){return this.a};var Xt="closure_listenable_"+(1e6*Math.random()|0),en=0;function tn(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Wa=i,this.key=++en,this.wa=this.Qa=!1}function nn(e){e.wa=!0,e.listener=null,e.proxy=null,e.src=null,e.Wa=null}function rn(e){this.src=e,this.a={},this.b=0}function on(e,t){var n=t.type;n in e.a&&Q(e.a[n],t)&&(nn(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function sn(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.wa&&o.listener==t&&o.capture==!!n&&o.Wa==r)return i}return-1}rn.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var s=sn(e,t,r,i);return-1<s?(t=e[s],n||(t.Qa=!1)):((t=new tn(t,this.src,o,!!r,i)).Qa=n,e.push(t)),t};var an="closure_lm_"+(1e6*Math.random()|0),cn={};function ln(e,t,n,r,i){if(r&&r.once)hn(e,t,n,r,i);else if(Array.isArray(t))for(var o=0;o<t.length;o++)ln(e,t[o],n,r,i);else n=_n(n),e&&e[Xt]?Cn(e,t,n,g(r)?!!r.capture:!!r,i):un(e,t,n,!1,r,i)}function un(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=g(i)?!!i.capture:!!i,a=vn(e);if(a||(e[an]=a=new rn(e)),!(n=a.add(t,n,r,s,o)).proxy)if(r=function(){var e=yn,t=Wt?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Qt||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(pn(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function hn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)hn(e,t[o],n,r,i);else n=_n(n),e&&e[Xt]?En(e,t,n,g(r)?!!r.capture:!!r,i):un(e,t,n,!0,r,i)}function dn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)dn(e,t[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=_n(n),e&&e[Xt]?(e=e.v,(t=String(t).toString())in e.a&&-1<(n=sn(o=e.a[t],n,r,i))&&(nn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):e&&(e=vn(e))&&(t=e.a[t.toString()],e=-1,t&&(e=sn(t,n,r,i)),(n=-1<e?t[e]:null)&&fn(n))}function fn(e){if("number"!=typeof e&&e&&!e.wa){var t=e.src;if(t&&t[Xt])on(t.v,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(pn(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=vn(t))?(on(n,e),0==n.b&&(n.src=null,t[an]=null)):nn(e)}}}function pn(e){return e in cn?cn[e]:cn[e]="on"+e}function gn(e,t,n,r){var i=!0;if((e=vn(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.wa&&(o=mn(o,r),i=i&&!1!==o)}return i}function mn(e,t){var n=e.listener,r=e.Wa||e.src;return e.Qa&&fn(e),n.call(r,t)}function yn(e,t){if(e.wa)return!0;if(!Wt){if(!t)e:{t=["window","event"];for(var n=a,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new Kt(r=t,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(s){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=gn(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=gn(r[i],e,!1,t),n=n&&o}return n}return mn(e,new Kt(t,this))}function vn(e){return(e=e[an])instanceof rn?e:null}var bn="__closure_events_fn_"+(1e9*Math.random()>>>0);function _n(e){return p(e)?e:(e[bn]||(e[bn]=function(t){return e.handleEvent(t)}),e[bn])}function wn(){zt.call(this),this.v=new rn(this),this.bc=this,this.hb=null}function Cn(e,t,n,r,i){e.v.add(String(t),n,!1,r,i)}function En(e,t,n,r,i){e.v.add(String(t),n,!0,r,i)}function On(e,t,n,r){if(!(t=e.v.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.wa&&s.capture==n){var a=s.listener,c=s.Wa||s.src;s.Qa&&on(e.v,s),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}function Sn(e,t,n){if(p(e))n&&(e=w(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=w(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function Pn(e){var t=null;return new _t(function(n,r){-1==(t=Sn(function(){n(void 0)},e))&&r(Error("Failed to schedule timer."))}).o(function(e){throw a.clearTimeout(t),e})}function In(e){if(e.X&&"function"==typeof e.X)return e.X();if("string"==typeof e)return e.split("");if(f(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function Tn(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.X||"function"!=typeof e.X){if(f(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function An(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof An)for(n=e.Y(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function kn(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Nn(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Nn(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Nn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}O(wn,zt),wn.prototype[Xt]=!0,wn.prototype.addEventListener=function(e,t,n,r){ln(this,e,t,n,r)},wn.prototype.removeEventListener=function(e,t,n,r){dn(this,e,t,n,r)},wn.prototype.dispatchEvent=function(e){var t,n=this.hb;if(n)for(t=[];n;n=n.hb)t.push(n);n=this.bc;var r=e.type||e;if("string"==typeof e)e=new Yt(e,n);else if(e instanceof Yt)e.target=e.target||n;else{var i=e;ye(e=new Yt(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var s=e.b=t[o];i=On(s,r,!0,e)&&i}if(i=On(s=e.b=n,r,!0,e)&&i,i=On(s,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=On(s=e.b=t[o],r,!1,e)&&i;return i},wn.prototype.Da=function(){if(wn.bb.Da.call(this),this.v){var e,t=this.v;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)nn(n[r]);delete t.a[e],t.b--}}this.hb=null},(e=An.prototype).X=function(){kn(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.Y=function(){return kn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return Nn(this.b,e)?this.b[e]:t},e.set=function(e,t){Nn(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Mn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xn(e,t){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,e instanceof xn?(this.i=void 0!==t?t:e.i,Rn(this,e.c),this.l=e.l,this.a=e.a,Dn(this,e.g),this.f=e.f,Ln(this,tr(e.b)),this.h=e.h):e&&(n=String(e).match(Mn))?(this.i=!!t,Rn(this,n[1]||"",!0),this.l=Vn(n[2]||""),this.a=Vn(n[3]||"",!0),Dn(this,n[4]),this.f=Vn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.h=Vn(n[7]||"")):(this.i=!!t,this.b=new Qn(null,this.i))}function Rn(e,t,n){e.c=n?Vn(t,!0):t,e.c&&(e.c=e.c.replace(/:$/,""))}function Dn(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.g=t}else e.g=null}function Ln(e,t,n){t instanceof Qn?(e.b=t,function(e,t){t&&!e.f&&(Yn(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Jn(this,t),er(this,n,e))},e)),e.f=t}(e.b,e.i)):(n||(t=zn(t,Wn)),e.b=new Qn(t,e.i))}function Bn(e,t,n){e.b.set(t,n)}function Fn(e,t){return e.b.get(t)}function jn(e){return e instanceof xn?new xn(e):new xn(e,void 0)}function Un(e,t,n,r){var i=new xn(null,void 0);return e&&Rn(i,e),t&&(i.a=t),n&&Dn(i,n),r&&(i.f=r),i}function Vn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function zn(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Hn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Hn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xn.prototype.toString=function(){var e=[],t=this.c;t&&e.push(zn(t,Gn,!0),":");var n=this.a;return(n||"file"==t)&&(e.push("//"),(t=this.l)&&e.push(zn(t,Gn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&e.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&e.push("/"),e.push(zn(n,"/"==n.charAt(0)?qn:$n,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.h)&&e.push("#",zn(n,Zn)),e.join("")},xn.prototype.resolve=function(e){var t=new xn(this),n=!!e.c;n?Rn(t,e.c):n=!!e.l,n?t.l=e.l:n=!!e.a,n?t.a=e.a:n=null!=e.g;var r=e.f;if(n)Dn(t,e.g);else if(n=!!e.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=t.f.lastIndexOf("/");-1!=i&&(r=t.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ce(i,"./")||ce(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?t.f=r:n=""!==e.b.toString(),n?Ln(t,tr(e.b)):n=!!e.h,n&&(t.h=e.h),t};var Gn=/[#\/\?@]/g,$n=/[#\?:]/g,qn=/[#\?]/g,Wn=/[#\?@]/g,Zn=/#/g;function Qn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Yn(e){e.a||(e.a=new An,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Kn(e){var t=Tn(e);if(void 0===t)throw Error("Keys are undefined");var n=new Qn(null,void 0);e=In(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];Array.isArray(o)?er(n,i,o):n.add(i,o)}return n}function Jn(e,t){Yn(e),t=nr(e,t),Nn(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Nn((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&kn(e)))}function Xn(e,t){return Yn(e),t=nr(e,t),Nn(e.a.b,t)}function er(e,t,n){Jn(e,t),0<n.length&&(e.c=null,e.a.set(nr(e,t),J(n)),e.b+=n.length)}function tr(e){var t=new Qn;return t.c=e.c,e.a&&(t.a=new An(e.a),t.b=e.b),t}function nr(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function rr(e){var t=[];return or(new ir,e,t),t.join("")}function ir(){}function or(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(Array.isArray(t)){var r=t;t=r.length,n.push("[");for(var i="",o=0;o<t;o++)n.push(i),or(e,r[o],n),i=",";return void n.push("]")}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){for(r in n.push("{"),i="",t)Object.prototype.hasOwnProperty.call(t,r)&&"function"!=typeof(o=t[r])&&(n.push(i),cr(r,n),n.push(":"),or(e,o,n),i=",");return void n.push("}")}t=t.valueOf()}switch(typeof t){case"string":cr(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}(e=Qn.prototype).add=function(e,t){Yn(this),this.c=null,e=nr(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(e,t){Yn(this),this.a.forEach(function(n,r){G(n,function(n){e.call(t,n,r,this)},this)},this)},e.Y=function(){Yn(this);for(var e=this.a.X(),t=this.a.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.X=function(e){Yn(this);var t=[];if("string"==typeof e)Xn(this,e)&&(t=K(t,this.a.get(nr(this,e))));else{e=this.a.X();for(var n=0;n<e.length;n++)t=K(t,e[n])}return t},e.set=function(e,t){return Yn(this),this.c=null,Xn(this,e=nr(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return e&&0<(e=this.X(e)).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.Y(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),e.push(s)}}return this.c=e.join("&")};var sr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},ar=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function cr(e,t){t.push('"',e.replace(ar,function(e){var t=sr[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),sr[e]=t),t}),'"')}function lr(){var e=Tr();return Qe&&!!st&&11==st||/Edge\/\d+/.test(e)}function ur(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function hr(e,t){t=t||a.window;var n="about:blank";e&&(n=Me(Le(e)||je)),t.location.href=n}function dr(e,t){var n,r=[];for(n in e)n in t?typeof e[n]!=typeof t[n]?r.push(n):"object"==typeof e[n]&&null!=e[n]&&null!=t[n]?0<dr(e[n],t[n]).length&&r.push(n):e[n]!==t[n]&&r.push(n):r.push(n);for(n in t)n in e||r.push(n);return r}function fr(e){return!!((e=(e||Tr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function pr(e){e=e||a.window;try{e.close()}catch(t){}}function gr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(s in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Tr().toLowerCase(),r&&(t.target=r,ce(n,"crios/")&&(t.target="_blank")),Sr(Tr())==Or&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof Ne?n:Le(void 0!==n.href?n.href:String(n))||je,n=e.target||n.target,i=[],e)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+e[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(e[s]?1:0))}var s=i.join(",");if((de("iPhone")&&!de("iPod")&&!de("iPad")||de("iPad")||de("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(ve(s=pt(document,"A"),"HTMLAnchorElement"),t=t instanceof Ne?t:Be(t),s.href=Me(t),s.setAttribute("target",n),e.noreferrer&&s.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(e),s={}):e.noreferrer?(s=ze("",r,n,s),e=Me(t),s&&(Ke&&ce(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),s.opener=null,e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ge(e)+'">',e=new Ue(e=(r=Oe())?r.createHTML(e):e,null,Ve),r=s.document)&&(r.write(function(e){return e instanceof Ue&&e.constructor===Ue?e.a:(L("expected object of type SafeHtml, got '"+e+"' of type "+d(e)),"type_error:SafeHtml")}(e)),r.close())):(s=ze(t,r,n,s))&&e.noopener&&(s.opener=null),s)try{s.focus()}catch(a){}return s}var mr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yr=/^[^@]+@[^@]+$/;function vr(){var e=null;return new _t(function(t){"complete"==a.document.readyState?t():(e=function(){t()},hn(window,"load",e))}).o(function(t){throw dn(window,"load",e),t})}function br(e){return e=e||Tr(),!("file:"!==xr()&&"ionic:"!==xr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function _r(){var e=a.window;try{return!(!e||e==e.top)}catch(t){return!1}}function wr(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function Cr(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":wr()?"Worker":"Browser"}function Er(){var e=Cr();return"ReactNative"===e||"Node"===e}var Or="Firefox";function Sr(e){var t=e.toLowerCase();return ce(t,"opera/")||ce(t,"opr/")||ce(t,"opios/")?"Opera":ce(t,"iemobile")?"IEMobile":ce(t,"msie")||ce(t,"trident/")?"IE":ce(t,"edge/")?"Edge":ce(t,"firefox/")?Or:ce(t,"silk/")?"Silk":ce(t,"blackberry")?"Blackberry":ce(t,"webos")?"Webos":!ce(t,"safari/")||ce(t,"chrome/")||ce(t,"crios/")||ce(t,"android")?!ce(t,"chrome/")&&!ce(t,"crios/")||ce(t,"edge/")?ce(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":"Chrome":"Safari"}var Pr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Ir(e,t){t=t||[];var n,r=[],i={};for(n in Pr)i[Pr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=Cr())?r=Sr(i=Tr()):"Worker"===r&&(r=Sr(i=Tr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function Tr(){return a.navigator&&a.navigator.userAgent||""}function Ar(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function kr(){try{var e=a.localStorage,t=Fr();if(e)return e.setItem(t,"1"),e.removeItem(t),!lr()||!!a.indexedDB}catch(n){return wr()&&!!a.indexedDB}return!1}function Nr(){return(Mr()||"chrome-extension:"===xr()||br())&&!Er()&&kr()&&!wr()}function Mr(){return"http:"===xr()||"https:"===xr()}function xr(){return a.location&&a.location.protocol||null}function Rr(e){return!fr(e=e||Tr())&&Sr(e)!=Or}function Dr(e){return void 0===e?null:rr(e)}function Lr(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!=e[t]&&(n[t]=e[t]);return n}function Br(e){if(null!==e)return JSON.parse(e)}function Fr(e){return e||Math.floor(1e9*Math.random()).toString()}function jr(e){return"Safari"!=Sr(e=e||Tr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Ur(){var e=a.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function Vr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=Tr(),t=Cr(),this.b=fr(e)||"ReactNative"===t}function zr(){var e=a.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function Hr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(n){}return null}function Gr(){return!(!Ar("fireauth.oauthhelper",a)&&!Ar("fireauth.iframe",a))}Vr.prototype.get=function(){var e=a.navigator;return!e||"boolean"!=typeof e.onLine||!Mr()&&"chrome-extension:"!==xr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var $r,qr={};function Wr(e){qr[e]||(qr[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}try{var Zr={};Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:2}),$r=2==Zr.abcd}catch(We){$r=!1}function Qr(e,t,n){$r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Yr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Qr(e,n,t[n])}function Kr(e){var t={};return Yr(t,e),t}function Jr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)Qr(t,n,Jr(e[n]));return t}function Xr(e){var t=e&&(e[ii]?"phone":null);if(!(t&&e&&e[ri]))throw new P("internal-error","Internal assert: invalid MultiFactorInfo object");Qr(this,"uid",e[ri]),Qr(this,"displayName",e[ti]||null);var n=null;e[ni]&&(n=new Date(e[ni]).toUTCString()),Qr(this,"enrollmentTime",n),Qr(this,"factorId",t)}function ei(e){try{var t=new oi(e)}catch(n){t=null}return t}Xr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ti="displayName",ni="enrolledAt",ri="mfaEnrollmentId",ii="phoneInfo";function oi(e){Xr.call(this,e),Qr(this,"phoneNumber",e[ii])}function si(e){var t={},n=e[ui],r=e[di],i=e[fi];if(e=ei(e[hi]),!i||i!=ci&&i!=li&&!n||i==li&&!r||i==ai&&!e)throw Error("Invalid checkActionCode response!");i==li?(t[gi]=n||null,t[yi]=n||null,t[pi]=r):(t[gi]=r||null,t[yi]=r||null,t[pi]=n||null),t[mi]=e||null,Qr(this,bi,i),Qr(this,vi,Jr(t))}O(oi,Xr),oi.prototype.w=function(){var e=oi.bb.w.call(this);return e.phoneNumber=this.phoneNumber,e};var ai="REVERT_SECOND_FACTOR_ADDITION",ci="EMAIL_SIGNIN",li="VERIFY_AND_CHANGE_EMAIL",ui="email",hi="mfaInfo",di="newEmail",fi="requestType",pi="email",gi="fromEmail",mi="multiFactorInfo",yi="previousEmail",vi="data",bi="operation";function _i(e){var t=Fn(e=jn(e),wi)||null,n=Fn(e,Ci)||null,r=Fn(e,Si)||null;if(r=r&&Ii[r]||null,!t||!n||!r)throw new P("argument-error",wi+", "+Ci+"and "+Si+" are required in a valid action code URL.");Yr(this,{apiKey:t,operation:r,code:n,continueUrl:Fn(e,Ei)||null,languageCode:Fn(e,Oi)||null,tenantId:Fn(e,Pi)||null})}var wi="apiKey",Ci="oobCode",Ei="continueUrl",Oi="languageCode",Si="mode",Pi="tenantId",Ii={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ai,signIn:ci,verifyAndChangeEmail:li,verifyEmail:"VERIFY_EMAIL"};function Ti(e){try{return new _i(e)}catch(t){return null}}function Ai(e){var t=e[Ri];if(void 0===t)throw new P("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new P("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[ki];if(n&&"object"==typeof n){t=n[Bi];var r=n[Di];if(n=n[Li],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new P("argument-error",Di+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new P("argument-error",Li+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new P("argument-error",Bi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new P("missing-android-pkg-name")}}else if(void 0!==n)throw new P("argument-error",ki+" property must be a non null object when specified.");if(this.f=null,(t=e[xi])&&"object"==typeof t){if("string"==typeof(t=t[Fi])&&t.length)this.f=t;else if(void 0!==t)throw new P("argument-error",Fi+" property must be a non empty string when specified.")}else if(void 0!==t)throw new P("argument-error",xi+" property must be a non null object when specified.");if(void 0!==(t=e[Mi])&&"boolean"!=typeof t)throw new P("argument-error",Mi+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[Ni])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new P("argument-error",Ni+" property must be a non empty string when specified.");this.i=e||null}var ki="android",Ni="dynamicLinkDomain",Mi="handleCodeInApp",xi="iOS",Ri="url",Di="installApp",Li="minimumVersion",Bi="packageName",Fi="bundleId";function ji(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i,t)null===t[n]&&delete t[n];return t}var Ui=null;function Vi(e){var t=Hi(e);if(!(t&&t.sub&&t.iss&&t.aud&&t.exp))throw Error("Invalid JWT");this.h=e,this.a=t.exp,this.i=t.sub,e=Date.now()/1e3,this.g=t.iat||(e>this.a?this.a:e),this.b=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.f=t.firebase&&t.firebase.tenant||null,this.c=!!t.is_anonymous||"anonymous"==this.b}function zi(e){try{return new Vi(e)}catch(t){return null}}function Hi(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{var r=function(e){var t=[];return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=Ui[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}!function(){if(!Ui){Ui={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=e.concat(t[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ui[o]&&(Ui[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;t(i<<2|o>>4),64!=s&&(t(o<<4&240|s>>2),64!=a&&t(s<<6&192|a))}}(e,function(e){t.push(e)}),t}(e);for(e=[],n=t=0;t<r.length;){var i=r[t++];if(128>i)e[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[t++];var s=r[t++],a=((7&i)<<18|(63&o)<<12|(63&s)<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(a>>10)),e[n++]=String.fromCharCode(56320+(1023&a))}else o=r[t++],s=r[t++],e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}return JSON.parse(e.join(""))}catch(c){}return null}Vi.prototype.T=function(){return this.f},Vi.prototype.l=function(){return this.c},Vi.prototype.toString=function(){return this.h};var Gi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),$i=["client_id","response_type","scope","redirect_uri","state"],qi={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:$i},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:$i},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:$i},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Gi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Wi(e){for(var t in qi)if(qi[t].fa==e)return qi[t];return null}function Zi(e){var t={};t["facebook.com"]=Xi,t["google.com"]=to,t["github.com"]=eo,t["twitter.com"]=no;var n=e&&e[Yi];try{if(n)return t[n]?new t[n](e):new Ji(e);if(void 0!==e[Qi])return new Ki(e)}catch(r){}return null}var Qi="idToken",Yi="providerId";function Ki(e){var t=e[Yi];if(!t&&e[Qi]){var n=zi(e[Qi]);n&&n.b&&(t=n.b)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),Qr(this,"providerId",t),Qr(this,"isNewUser",n)}function Ji(e){Ki.call(this,e),Qr(this,"profile",Jr((e=Br(e.rawUserInfo||"{}"))||{}))}function Xi(e){if(Ji.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function eo(e){if(Ji.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Qr(this,"username",this.profile&&this.profile.login||null)}function to(e){if(Ji.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function no(e){if(Ji.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Qr(this,"username",e.screenName||null)}function ro(e){var t=jn(e),n=Fn(t,"link"),r=Fn(jn(n),"link");return t=Fn(t,"deep_link_id"),Fn(jn(t),"link")||t||r||n||e}function io(e,t){if(!e&&!t)throw new P("internal-error","Internal assert: no raw session string available");if(e&&t)throw new P("internal-error","Internal assert: unable to determine the session type");this.a=e||null,this.b=t||null,this.type=this.a?oo:so}O(Ji,Ki),O(Xi,Ji),O(eo,Ji),O(to,Ji),O(no,Ji);var oo="enroll",so="signin";function ao(){}function co(e,t){return e.then(function(e){if(e[Qs]){var n=zi(e[Qs]);if(!n||t!=n.i)throw new P("user-mismatch");return e}throw new P("user-mismatch")}).o(function(e){throw e&&e.code&&e.code==A+"user-not-found"?new P("user-mismatch"):e})}function lo(e,t){if(!t)throw new P("internal-error","failed to construct a credential");this.a=t,Qr(this,"providerId",e),Qr(this,"signInMethod",e)}function uo(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function ho(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new lo(e.providerId,e.pendingToken)}catch(t){}return null}function fo(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&Qr(this,"idToken",t.idToken),t.accessToken&&Qr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&Qr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new P("internal-error","failed to construct a credential");Qr(this,"accessToken",t.oauthToken),Qr(this,"secret",t.oauthTokenSecret)}Qr(this,"providerId",e),Qr(this,"signInMethod",n)}function po(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:Kn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function go(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new fo(e.providerId,t,e.signInMethod)}catch(n){}}return null}function mo(e,t){this.Qc=t||[],Yr(this,{providerId:e,isOAuthProvider:!0}),this.Jb={},this.qb=(Wi(e)||{}).Ja||null,this.pb=null}function yo(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new P("argument-error",'SAML provider IDs must be prefixed with "saml."');mo.call(this,e,[])}function vo(e){mo.call(this,e,$i),this.a=[]}function bo(){vo.call(this,"facebook.com")}function _o(e){if(!e)throw new P("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return g(e)&&(t=e.accessToken),(new bo).credential({accessToken:t})}function wo(){vo.call(this,"github.com")}function Co(e){if(!e)throw new P("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return g(e)&&(t=e.accessToken),(new wo).credential({accessToken:t})}function Eo(){vo.call(this,"google.com"),this.Ca("profile")}function Oo(e,t){var n=e;return g(e)&&(n=e.idToken,t=e.accessToken),(new Eo).credential({idToken:n,accessToken:t})}function So(){mo.call(this,"twitter.com",Gi)}function Po(e,t){var n=e;if(g(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new P("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new fo("twitter.com",n,"twitter.com")}function Io(e,t,n){this.a=e,this.f=t,Qr(this,"providerId","password"),Qr(this,"signInMethod",n===Ao.EMAIL_LINK_SIGN_IN_METHOD?Ao.EMAIL_LINK_SIGN_IN_METHOD:Ao.EMAIL_PASSWORD_SIGN_IN_METHOD)}function To(e){return e&&e.email&&e.password?new Io(e.email,e.password,e.signInMethod):null}function Ao(){Yr(this,{providerId:"password",isOAuthProvider:!1})}function ko(e,t){if(!(t=No(t)))throw new P("argument-error","Invalid email link!");return new Io(e,t.code,Ao.EMAIL_LINK_SIGN_IN_METHOD)}function No(e){return(e=Ti(e=ro(e)))&&e.operation===ci?e:null}function Mo(e){if(!(e.fb&&e.eb||e.La&&e.ea))throw new P("internal-error");this.a=e,Qr(this,"providerId","phone"),this.fa="phone",Qr(this,"signInMethod","phone")}function xo(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var t={};return G(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){e[n]&&(t[n]=e[n])}),new Mo(t)}return null}function Ro(e){return e.a.La&&e.a.ea?{temporaryProof:e.a.La,phoneNumber:e.a.ea}:{sessionInfo:e.a.fb,code:e.a.eb}}function Do(e){try{this.a=e||r.a.auth()}catch(t){throw new P("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Yr(this,{providerId:"phone",isOAuthProvider:!1})}function Lo(e,t){if(!e)throw new P("missing-verification-id");if(!t)throw new P("missing-verification-code");return new Mo({fb:e,eb:t})}function Bo(e){if(e.temporaryProof&&e.phoneNumber)return new Mo({La:e.temporaryProof,ea:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,s=e&&e.pendingToken;try{switch(t){case"google.com":return Oo(o,n);case"facebook.com":return _o(n);case"github.com":return Co(n);case"twitter.com":return Po(n,r);default:return n||r||o||s?s?0==t.indexOf("saml.")?new lo(t,s):new fo(t,{pendingToken:s,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new vo(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(a){return null}}function Fo(e){if(!e.isOAuthProvider)throw new P("invalid-oauth-provider")}function jo(e,t,n,r,i,o,s){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,!this.g&&!this.a)throw new P("invalid-auth-event");if(this.g&&this.a)throw new P("invalid-auth-event");if(this.g&&!this.f)throw new P("invalid-auth-event")}function Uo(e){return(e=e||{}).type?new jo(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&I(e.error),e.postBody,e.tenantId):null}function Vo(){this.b=null,this.a=[]}io.prototype.Ha=function(){return It(this.a?this.a:this.b)},io.prototype.w=function(){return this.type==oo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ao.prototype.ka=function(){},ao.prototype.b=function(){},ao.prototype.c=function(){},ao.prototype.w=function(){},lo.prototype.ka=function(e){return ma(e,uo(this))},lo.prototype.b=function(e,t){var n=uo(this);return n.idToken=t,ya(e,n)},lo.prototype.c=function(e,t){return co(va(e,uo(this)),t)},lo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},fo.prototype.ka=function(e){return ma(e,po(this))},fo.prototype.b=function(e,t){var n=po(this);return n.idToken=t,ya(e,n)},fo.prototype.c=function(e,t){return co(va(e,po(this)),t)},fo.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},mo.prototype.Ka=function(e){return this.Jb=ge(e),this},O(yo,mo),O(vo,mo),vo.prototype.Ca=function(e){return Z(this.a,e)||this.a.push(e),this},vo.prototype.Rb=function(){return J(this.a)},vo.prototype.credential=function(e,t){var n;if(!(n=g(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!n.accessToken)throw new P("argument-error","credential failed: must provide the ID token and/or the access token.");return new fo(this.providerId,n,this.providerId)},O(bo,vo),Qr(bo,"PROVIDER_ID","facebook.com"),Qr(bo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),O(wo,vo),Qr(wo,"PROVIDER_ID","github.com"),Qr(wo,"GITHUB_SIGN_IN_METHOD","github.com"),O(Eo,vo),Qr(Eo,"PROVIDER_ID","google.com"),Qr(Eo,"GOOGLE_SIGN_IN_METHOD","google.com"),O(So,mo),Qr(So,"PROVIDER_ID","twitter.com"),Qr(So,"TWITTER_SIGN_IN_METHOD","twitter.com"),Io.prototype.ka=function(e){return this.signInMethod==Ao.EMAIL_LINK_SIGN_IN_METHOD?Xa(e,Pa,{email:this.a,oobCode:this.f}):Xa(e,Za,{email:this.a,password:this.f})},Io.prototype.b=function(e,t){return this.signInMethod==Ao.EMAIL_LINK_SIGN_IN_METHOD?Xa(e,Ia,{idToken:t,email:this.a,oobCode:this.f}):Xa(e,Ua,{idToken:t,email:this.a,password:this.f})},Io.prototype.c=function(e,t){return co(this.ka(e),t)},Io.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Yr(Ao,{PROVIDER_ID:"password"}),Yr(Ao,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Yr(Ao,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Mo.prototype.ka=function(e){return e.gb(Ro(this))},Mo.prototype.b=function(e,t){var n=Ro(this);return n.idToken=t,Xa(e,Ya,n)},Mo.prototype.c=function(e,t){var n=Ro(this);return n.operation="REAUTH",co(e=Xa(e,Ka,n),t)},Mo.prototype.w=function(){var e={providerId:"phone"};return this.a.fb&&(e.verificationId=this.a.fb),this.a.eb&&(e.verificationCode=this.a.eb),this.a.La&&(e.temporaryProof=this.a.La),this.a.ea&&(e.phoneNumber=this.a.ea),e},Do.prototype.gb=function(e,t){var n=this.a.a;return It(t.verify()).then(function(r){if("string"!=typeof r)throw new P("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":var i=g(e)?e.session:null,o=g(e)?e.phoneNumber:e;return(i&&i.type==oo?i.Ha().then(function(e){return function(e,t){return Xa(e,za,t).then(function(e){return e.phoneSessionInfo.sessionInfo})}(n,{idToken:e,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})}):i&&i.type==so?i.Ha().then(function(t){return function(e,t){return Xa(e,Ha,t).then(function(e){return e.phoneResponseInfo.sessionInfo})}(n,{mfaPendingCredential:t,mfaEnrollmentId:e.multiFactorHint&&e.multiFactorHint.uid||e.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})}):function(e,t){return Xa(e,Fa,t)}(n,{phoneNumber:o,recaptchaToken:r})).then(function(e){return"function"==typeof t.reset&&t.reset(),e},function(e){throw"function"==typeof t.reset&&t.reset(),e});default:throw new P("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Yr(Do,{PROVIDER_ID:"phone"}),Yr(Do,{PHONE_SIGN_IN_METHOD:"phone"}),jo.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},jo.prototype.T=function(){return this.h},jo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var zo,Ho=null;function Go(e){var t="unauthorized-domain",n=void 0,r=jn(e);e=r.a,"chrome-extension"==(r=r.c)?n=He("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=He("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",P.call(this,t,n)}function $o(e,t,n){P.call(this,e,n),(e=t||{}).Kb&&Qr(this,"email",e.Kb),e.ea&&Qr(this,"phoneNumber",e.ea),e.credential&&Qr(this,"credential",e.credential),e.$b&&Qr(this,"tenantId",e.$b)}function qo(e){if(e.code){var t=e.code||"";0==t.indexOf(A)&&(t=t.substring(A.length));var n={credential:Bo(e),$b:e.tenantId};if(e.email)n.Kb=e.email;else if(e.phoneNumber)n.ea=e.phoneNumber;else if(!n.credential)return new P(t,e.message||void 0);return new $o(t,n,e.message)}return null}function Wo(){}function Zo(){}function Qo(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function Yo(){}function Ko(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=w(this.qc,this),this.a.onerror=w(this.Tb,this),this.a.onprogress=w(this.rc,this),this.a.ontimeout=w(this.vc,this)}function Jo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Xo(e,t,n){this.reset(e,t,n,void 0,void 0)}function es(e){this.f=e,this.b=this.c=this.a=null}function ts(e,t){this.name=e,this.value=t}O(Go,P),O($o,P),$o.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.w();return t&&ye(e,t),e},$o.prototype.toJSON=function(){return this.w()},Wo.prototype.c=null,O(Zo,Wo),Zo.prototype.a=function(){var e=Qo(this);return e?new ActiveXObject(e):new XMLHttpRequest},Zo.prototype.b=function(){var e={};return Qo(this)&&(e[0]=!0,e[1]=!0),e},zo=new Zo,O(Yo,Wo),Yo.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new Ko;throw Error("Unsupported browser")},Yo.prototype.b=function(){return{}},(e=Ko.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Jo(this,4)},e.Tb=function(){this.status=500,this.response=this.responseText="",Jo(this,4)},e.vc=function(){this.Tb()},e.rc=function(){this.status=200,Jo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Xo.prototype.a=null,Xo.prototype.reset=function(e,t,n,r,i){r||E(),delete this.a},ts.prototype.toString=function(){return this.name};var ns=new ts("SEVERE",1e3),rs=new ts("WARNING",900),is=new ts("CONFIG",700),os=new ts("FINE",500);function ss(e){return e.c?e.c:e.a?ss(e.a):(L("Root logger has no level set."),null)}es.prototype.log=function(e,t,n){if(e.value>=ss(this).value)for(p(t)&&(t=t()),e=new Xo(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var as={},cs=null;function ls(e){var t;if(cs||(cs=new es(""),as[""]=cs,cs.c=is),!(t=as[e])){t=new es(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=ls(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,as[e]=t}return t}function us(e,t){e&&e.log(os,t,void 0)}function hs(e){this.f=e}function ds(e){wn.call(this),this.u=e,this.h=void 0,this.readyState=fs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=ls("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}O(hs,Wo),hs.prototype.a=function(){return new ds(this.f)},hs.prototype.b=function(e){return function(){return e}}({}),O(ds,wn);var fs=0;function ps(e){e.c.read().then(e.pc.bind(e)).catch(e.Va.bind(e))}function gs(e){e.readyState=4,e.g=null,e.c=null,e.m=null,ms(e)}function ms(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function ys(e){wn.call(this),this.headers=new An,this.D=e||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=vs,this.u=this.S=!1}(e=ds.prototype).open=function(e,t){if(this.readyState!=fs)throw this.abort(),Error("Error reopening a connection");this.s=e,this.f=t,this.readyState=1,ms(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.f,t)).then(this.uc.bind(this),this.Va.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,gs(this)),this.readyState=fs},e.uc=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,ms(this)),this.a&&(this.readyState=3,ms(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==a.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.m=new TextDecoder,ps(this)):e.text().then(this.tc.bind(this),this.Va.bind(this)))))},e.pc=function(e){if(this.a){var t=this.m.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.response=this.responseText+=t),e.done?gs(this):ms(this),3==this.readyState&&ps(this)}},e.tc=function(e){this.a&&(this.response=this.responseText=e,gs(this))},e.sc=function(e){this.a&&(this.response=e,gs(this))},e.Va=function(e){var t=this.i;t&&t.log(rs,"Failed to fetch url "+this.f,e instanceof Error?e:Error(e)),this.a&&gs(this)},e.setRequestHeader=function(e,t){this.l.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.i)&&e.log(rs,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.i;return e&&e.log(rs,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ds.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),O(ys,wn);var vs="";ys.prototype.b=ls("goog.net.XhrIo");var bs=/^https?$/i,_s=["POST","PUT"];function ws(e){return"content-type"==e.toLowerCase()}function Cs(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,Es(e),Ss(e)}function Es(e){e.J||(e.J=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Os(e){if(e.c&&void 0!==s)if(e.C[1]&&4==Is(e)&&2==Ts(e))us(e.b,As(e,"Local request error detected and ignored"));else if(e.i&&4==Is(e))Sn(e.Wb,0,e);else if(e.dispatchEvent("readystatechange"),4==Is(e)){us(e.b,As(e,"Request complete")),e.c=!1;try{var t,n=Ts(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.l).match(Mn)[1]||null;if(!o&&a.self&&a.self.location){var c=a.self.location.protocol;o=c.substr(0,c.length-1)}i=!bs.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var l=2<Is(e)?e.a.statusText:""}catch(u){us(e.b,"Can not get status: "+u.message),l=""}e.h=l+" ["+Ts(e)+"]",Es(e)}}finally{Ss(e)}}}function Ss(e,t){if(e.a){Ps(e);var n=e.a,r=e.C[0]?h:null;e.a=null,e.C=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(e=e.b)&&e.log(ns,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function Ps(e){e.a&&e.u&&(e.a.ontimeout=null),e.s&&(a.clearTimeout(e.s),e.s=null)}function Is(e){return e.a?e.a.readyState:0}function Ts(e){try{return 2<Is(e)?e.a.status:-1}catch(t){return-1}}function As(e,t){return t+" ["+e.P+" "+e.l+" "+Ts(e)+"]"}function ks(e){var t=Vs;this.g=[],this.u=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Ns(e,t,n){e.a=!0,e.c=n,e.f=!t,Ds(e)}function Ms(e){if(e.a){if(!e.v)throw new Ls(e);e.v=!1}}function xs(e,t,n,r){e.g.push([t,n,r]),e.a&&Ds(e)}function Rs(e){return W(e.g,function(e){return p(e[1])})}function Ds(e){if(e.h&&e.a&&Rs(e)){var t=e.h,n=js[t];n&&(a.clearTimeout(n.a),delete js[t]),e.h=0}e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],s=i[1];if(i=i[2],o=e.f?s:o)try{var c=o.call(i||e.s,t);void 0!==c&&(e.f=e.f&&(c==t||c instanceof Error),e.c=t=c),(x(t)||"function"==typeof a.Promise&&t instanceof a.Promise)&&(r=!0,e.i=!0)}catch(l){t=l,e.f=!0,Rs(e)||(n=!0)}}e.c=t,r&&(c=w(e.m,e,!0),r=w(e.m,e,!1),t instanceof ks?(xs(t,c,r),t.C=!0):t.then(c,r)),n&&(t=new Fs(t),js[t.a]=t,e.h=t.a)}function Ls(){R.call(this)}function Bs(){R.call(this)}function Fs(e){this.a=a.setTimeout(w(this.c,this),0),this.b=e}(e=ys.prototype).Ma=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",us(this.b,As(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(us(this.b,As(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ss(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ss(this,!0)),ys.bb.Da.call(this)},e.Wb=function(){this.ya||(this.N||this.i||this.f?Os(this):this.Jc())},e.Jc=function(){Os(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case vs:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(ns,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return us(this.b,"Can not get response: "+t.message),null}},ks.prototype.cancel=function(e){if(this.a)this.c instanceof ks&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(e=new Bs(this),Ms(this),Ns(this,!1,e))}},ks.prototype.m=function(e,t){this.i=!1,Ns(this,e,t)},ks.prototype.then=function(e,t,n){var r,i,o=new _t(function(e,t){r=e,i=t});return xs(this,r,function(e){e instanceof Bs?o.cancel():i(e)}),o.then(e,t,n)},ks.prototype.$goog_Thenable=!0,O(Ls,R),Ls.prototype.message="Deferred has already fired",Ls.prototype.name="AlreadyCalledError",O(Bs,R),Bs.prototype.message="Deferred was canceled",Bs.prototype.name="CanceledError",Fs.prototype.c=function(){throw delete js[this.a],this.b};var js={};function Us(e){var t={},n=t.document||document,r=Pe(e).toString(),i=pt(document,"SCRIPT"),o={Xb:i,Ma:void 0},s=new ks(o),c=null,h=null!=t.timeout?t.timeout:5e3;return 0<h&&(c=window.setTimeout(function(){zs(i,!0);var e=new $s(Gs,"Timeout reached for loading script "+r);Ms(s),Ns(s,!1,e)},h),o.Ma=c),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(zs(i,t.xd||!1,c),Ms(s),Ns(s,!0,null))},i.onerror=function(){zs(i,!0,c);var e=new $s(Hs,"Error while loading script "+r);Ms(s),Ns(s,!1,e)},ye(o=t.attributes||{},{type:"text/javascript",charset:"UTF-8"}),lt(i,o),function(e,t){ve(e,"HTMLScriptElement"),e.src=Pe(t),(t=e.ownerDocument&&e.ownerDocument.defaultView)&&t!=a?t=u(t.document):(null===l&&(l=u(a.document)),t=l),t&&e.setAttribute("nonce",t)}(i,e),function(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}(n).appendChild(i),s}function Vs(){if(this&&this.Xb){var e=this.Xb;e&&"SCRIPT"==e.tagName&&zs(e,!0,this.Ma)}}function zs(e,t,n){null!=n&&a.clearTimeout(n),e.onload=h,e.onerror=h,e.onreadystatechange=h,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var Hs=0,Gs=1;function $s(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),R.call(this,n),this.code=e}function qs(e){this.f=e}function Ws(e,t,n){if(this.c=e,this.l=(e=t||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||Ys,this.g=ge(e.secureTokenHeaders||Ks),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=e.firebaseTimeout||Js,this.a=ge(e.firebaseHeaders||Xs),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Cr(),!(n=a.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest)&&!wr())throw new P("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=wr()?new hs(self):Er()?new qs(n):new Yo,this.b=null}O($s,R),O(qs,Wo),qs.prototype.a=function(){return new this.f},qs.prototype.b=function(){return{}};var Zs,Qs="idToken",Ys=new Vr(3e4,6e4),Ks={"Content-Type":"application/x-www-form-urlencoded"},Js=new Vr(3e4,6e4),Xs={"Content-Type":"application/json"};function ea(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function ta(e,t){t&&(e.l=na("https://securetoken.googleapis.com/v1/token",t),e.h=na("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",t),e.i=na("https://identitytoolkit.googleapis.com/v2/",t))}function na(e,t){return e=jn(e),t=jn(t.url),e.f=e.a+e.f,Rn(e,t.c),e.a=t.a,Dn(e,t.g),e.toString()}function ra(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function ia(e,t,n,r,i,o,s){(function(){var e=Tr();return!((e="Chrome"!=Sr(e)?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e||Qe&&st&&!(9<st))})()||wr()?e=w(e.u,e):(Zs||(Zs=new _t(function(e,t){!function(e,t){((window.gapi||{}).client||{}).request?e():(a[sa]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},function(e,t){xs(e,null,t,void 0)}(Us(Ie(oa,{onload:sa})),function(){t(Error("CORS_UNSUPPORTED"))}))}(e,t)})),e=w(e.s,e)),e(t,n,r,i,o,s)}Ws.prototype.T=function(){return this.b},Ws.prototype.u=function(e,t,n,r,i,o){if(wr()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new P("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new ys(this.f);if(o){s.g=Math.max(0,o);var c=setTimeout(function(){s.dispatchEvent("timeout")},o)}Cn(s,"complete",function(){c&&clearTimeout(c);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return us(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(n){e=null}t&&t(e)}),En(s,"ready",function(){c&&clearTimeout(c),$t(this)}),En(s,"timeout",function(){c&&clearTimeout(c),$t(this),t&&t(null)}),function(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.P=n,e.J=!1,e.c=!0,e.a=e.D?e.D.a():zo.a(),e.C=function(e){return e.c||(e.c=e.b())}(e.D?e.D:zo),e.a.onreadystatechange=w(e.Wb,e);try{us(e.b,As(e,"Opening Xhr")),e.N=!0,e.a.open(n,String(t),!0),e.N=!1}catch(s){return us(e.b,As(e,"Error opening Xhr: "+s.message)),void Cs(e,s)}t=r||"";var o=new An(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(f(e)||"string"==typeof e)G(e,t,void 0);else for(var n=Tn(e),r=In(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,function(e,t){o.set(t,e)}),i=function(e){e:{for(var t=ws,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(o.Y()),r=a.FormData&&t instanceof a.FormData,!Z(_s,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.S&&(e.a.withCredentials=e.S);try{Ps(e),0<e.g&&(e.u=function(e){return Qe&&ot(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(e.a),us(e.b,As(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.u)),e.u?(e.a.timeout=e.g,e.a.ontimeout=w(e.Ma,e)):e.s=Sn(e.Ma,e.g,e)),us(e.b,As(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(s){us(e.b,As(e,"Send error: "+s.message)),Cs(e,s)}}(s,e,n,r,i)};var oa=new be(Ee,"https://apis.google.com/js/client.js?onload=%{onload}"),sa="__fcb"+Math.floor(1e6*Math.random()).toString();function aa(e){if("string"!=typeof(e=e.email)||!yr.test(e))throw new P("invalid-email")}function ca(e){"email"in e&&aa(e)}function la(e){if(!e[Qs]){if(e.mfaPendingCredential)throw new P("multi-factor-auth-required",null,ge(e));throw new P("internal-error")}}function ua(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new P("internal-error")}else{if(!e.sessionInfo)throw new P("missing-verification-id");if(!e.code)throw new P("missing-verification-code")}}Ws.prototype.s=function(e,t,n,r,i){var o=this;Zs.then(function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(s),t&&t(e)}})}).o(function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},Ws.prototype.Ab=function(){return Xa(this,Va,{})},Ws.prototype.Cb=function(e,t){return Xa(this,ja,{idToken:e,email:t})},Ws.prototype.Db=function(e,t){return Xa(this,Ua,{idToken:e,password:t})};var ha={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function da(e){if(!e.phoneVerificationInfo)throw new P("internal-error");if(!e.phoneVerificationInfo.sessionInfo)throw new P("missing-verification-id");if(!e.phoneVerificationInfo.code)throw new P("missing-verification-code")}function fa(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new P("internal-error")}function pa(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&Xn(e=new Qn(e.postBody),"nonce")&&(t.nonce=e.get("nonce"))),t}function ga(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=qo(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=qo(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=qo(e)):e.errorMessage&&(t=ec(e.errorMessage)),t)throw t;la(e)}function ma(e,t){return t.returnIdpCredential=!0,Xa(e,Ga,t)}function ya(e,t){return t.returnIdpCredential=!0,Xa(e,qa,t)}function va(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Xa(e,$a,t)}function ba(e){if(!e.oobCode)throw new P("invalid-action-code")}(e=Ws.prototype).Eb=function(e,t){var n={idToken:e},r=[];return fe(ha,function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Xa(this,ja,n)},e.wb=function(e,t){return ye(e={requestType:"PASSWORD_RESET",email:e},t),Xa(this,Ra,e)},e.xb=function(e,t){return ye(e={requestType:"EMAIL_SIGNIN",email:e},t),Xa(this,Na,e)},e.vb=function(e,t){return ye(e={requestType:"VERIFY_EMAIL",idToken:e},t),Xa(this,Ma,e)},e.Fb=function(e,t,n){return ye(e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:t},n),Xa(this,xa,e)},e.gb=function(e){return Xa(this,Qa,e)},e.ob=function(e,t){return Xa(this,Ba,{oobCode:e,newPassword:t})},e.Sa=function(e){return Xa(this,wa,{oobCode:e})},e.kb=function(e){return Xa(this,_a,{oobCode:e})};var _a={endpoint:"setAccountInfo",A:ba,Z:"email",B:!0},wa={endpoint:"resetPassword",A:ba,G:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t&&"VERIFY_AND_CHANGE_EMAIL"!=t)throw new P("internal-error")},B:!0},Ca={endpoint:"signupNewUser",A:function(e){if(aa(e),!e.password)throw new P("weak-password")},G:la,V:!0,B:!0},Ea={endpoint:"createAuthUri",B:!0},Oa={endpoint:"deleteAccount",O:["idToken"]},Sa={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(e){if(!Array.isArray(e.deleteProvider))throw new P("internal-error")}},Pa={endpoint:"emailLinkSignin",O:["email","oobCode"],A:aa,G:la,V:!0,B:!0},Ia={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:aa,G:la,V:!0},Ta={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:da,G:la,B:!0,Na:!0},Aa={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:da,G:la,B:!0,Na:!0},ka={endpoint:"getAccountInfo"},Na={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new P("internal-error");aa(e)},Z:"email",B:!0},Ma={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new P("internal-error")},Z:"email",B:!0},xa={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(e){if("VERIFY_AND_CHANGE_EMAIL"!=e.requestType)throw new P("internal-error")},Z:"email",B:!0},Ra={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(e){if("PASSWORD_RESET"!=e.requestType)throw new P("internal-error");aa(e)},Z:"email",B:!0},Da={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},La={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(e){if(!e.recaptchaSiteKey)throw new P("internal-error")}},Ba={endpoint:"resetPassword",A:ba,Z:"email",B:!0},Fa={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},ja={endpoint:"setAccountInfo",O:["idToken"],A:ca,V:!0},Ua={endpoint:"setAccountInfo",O:["idToken"],A:function(e){if(ca(e),!e.password)throw new P("weak-password")},G:la,V:!0},Va={endpoint:"signupNewUser",G:la,V:!0,B:!0},za={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(e){if(!e.phoneEnrollmentInfo)throw new P("internal-error");if(!e.phoneEnrollmentInfo.phoneNumber)throw new P("missing-phone-number");if(!e.phoneEnrollmentInfo.recaptchaToken)throw new P("missing-app-credential")},G:function(e){if(!e.phoneSessionInfo||!e.phoneSessionInfo.sessionInfo)throw new P("internal-error")},B:!0,Na:!0},Ha={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(e){if(!e.phoneSignInInfo||!e.phoneSignInInfo.recaptchaToken)throw new P("missing-app-credential")},G:function(e){if(!e.phoneResponseInfo||!e.phoneResponseInfo.sessionInfo)throw new P("internal-error")},B:!0,Na:!0},Ga={endpoint:"verifyAssertion",A:fa,Za:pa,G:ga,V:!0,B:!0},$a={endpoint:"verifyAssertion",A:fa,Za:pa,G:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new P("user-not-found");if(e.errorMessage)throw ec(e.errorMessage);la(e)},V:!0,B:!0},qa={endpoint:"verifyAssertion",A:function(e){if(fa(e),!e.idToken)throw new P("internal-error")},Za:pa,G:ga,V:!0},Wa={endpoint:"verifyCustomToken",A:function(e){if(!e.token)throw new P("invalid-custom-token")},G:la,V:!0,B:!0},Za={endpoint:"verifyPassword",A:function(e){if(aa(e),!e.password)throw new P("wrong-password")},G:la,V:!0,B:!0},Qa={endpoint:"verifyPhoneNumber",A:ua,G:la,B:!0},Ya={endpoint:"verifyPhoneNumber",A:function(e){if(!e.idToken)throw new P("internal-error");ua(e)},G:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",qo(e);la(e)}},Ka={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ua,G:la,B:!0},Ja={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(e){if(!!e[Qs]^!!e.refreshToken)throw new P("internal-error")},B:!0,Na:!0};function Xa(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return!1}return!0}(n,t.O))return Tt(new P("internal-error"));var r,i=!!t.Na,o=t.Vb||"POST";return It(n).then(t.A).then(function(){return t.V&&(n.returnSecureToken=!0),t.B&&e.b&&void 0===n.tenantId&&(n.tenantId=e.b),function(e,t,n,r,i,o,s){var a=jn(t+n);Bn(a,"key",e.c),s&&Bn(a,"cb",Date.now().toString());var c="GET"==r;if(c)for(var l in i)i.hasOwnProperty(l)&&Bn(a,l,i[l]);return new _t(function(t,n){ia(e,a.toString(),function(e){e?e.error?n(tc(e,o||{})):t(e):n(new P("network-request-failed"))},r,c?void 0:rr(Lr(i)),e.a,e.v.get())})}(e,i?e.i:e.h,t.endpoint,o,n,t.Ib,t.mb||!1)}).then(function(e){return r=e,t.Za?t.Za(n,r):r}).then(t.G).then(function(){if(!t.Z)return r;if(!(t.Z in r))throw new P("internal-error");return r[t.Z]})}function ec(e){return tc({error:{errors:[{message:e}],code:400,message:e}})}function tc(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new P(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",ye(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new P(r[i],t);return!t&&e&&(t=Dr(e)),new P("internal-error",t)}function nc(e){this.b=e,this.a=null,this.sb=function(e){return(sc||(sc=new _t(function(e,t){function n(){Ur(),Ar("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Ur(),t(Error("Network Error"))},timeout:ic.get()})}if(Ar("gapi.iframes.Iframe"))e();else if(Ar("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){Ar("gapi.load")?n():t(Error("Network Error"))},It(Us(r=Ie(rc,{onload:r}))).o(function(){t(Error("Network Error"))})}}).o(function(e){throw sc=null,e}))).then(function(){return new _t(function(t,n){Ar("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:Ar("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},oc.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}var rc=new be(Ee,"https://apis.google.com/js/api.js?onload=%{onload}"),ic=new Vr(3e4,6e4),oc=new Vr(5e3,15e3),sc=null;function ac(e,t,n,r){this.l=e,this.h=t,this.i=n,this.g=r,this.f=null,e=this.g?Un((e=jn(this.g.url)).c,e.a,e.g,"/emulator/auth/iframe"):Un("https",this.l,null,"/__/auth/iframe"),this.a=e,Bn(this.a,"apiKey",this.h),Bn(this.a,"appName",this.i),this.b=null,this.c=[]}function cc(e,t,n,r,i,o){this.u=e,this.s=t,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function lc(e){try{return r.a.app(e).auth().Ga()}catch(t){return[]}}function uc(e,t,n,r,i,o){this.s=e,this.g=t,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function hc(e){var t=ur();return function(e){return Xa(e,Da,{}).then(function(e){return e.authorizedDomains||[]})}(e).then(function(e){e:{var n=jn(t),r=n.c;n=n.a;for(var i=0;i<e.length;i++){var o=e[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=jn(o).a==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:mr.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){e=!0;break e}}e=!1}if(!e)throw new Go(ur())})}function dc(e){return e.m||(e.m=vr().then(function(){if(!e.u){var t=e.c,n=e.i,r=lc(e.b),i=new ac(e.s,e.g,e.b,e.f);i.f=t,i.b=n,i.c=J(r||[]),e.u=i.toString()}e.v=new nc(e.u),function(e){if(!e.v)throw Error("IfcHandler must be initialized!");!function(e,t){e.sb.then(function(){e.a.register("authEvent",t,Ar("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(e.v,function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=Uo(t.authEvent),n=0;n<e.h.length;n++)r=e.h[n](t)||r;return(n={}).status=r?"ACK":"ERROR",It(n)}return n.status="ERROR",It(n)})}(e)})),e.m}function fc(e){return e.l||(e.C=e.c?Ir(e.c,lc(e.b)):null,e.l=new Ws(e.g,M(e.i),e.C),e.f&&ta(e.l,e.f)),e.l}function pc(e,t,n,r,i,o,s,a,c,l,u,h){return(e=new cc(e,t,n,r,i,h)).l=o,e.g=s,e.i=a,e.b=ge(c||null),e.f=l,e.zb(u).toString()}function gc(e){if(this.a=e||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new P("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function mc(e){this.b=e,this.a={},this.f=w(this.c,this)}ac.prototype.toString=function(){return this.f?Bn(this.a,"v",this.f):Jn(this.a.b,"v"),this.b?Bn(this.a,"eid",this.b):Jn(this.a.b,"eid"),this.c.length?Bn(this.a,"fw",this.c.join(",")):Jn(this.a.b,"fw"),this.a.toString()},cc.prototype.zb=function(e){return this.h=e,this},cc.prototype.toString=function(){if(this.v){var e=jn(this.v.url);e=Un(e.c,e.a,e.g,"/emulator/auth/handler")}else e=Un("https",this.u,null,"/__/auth/handler");if(Bn(e,"apiKey",this.s),Bn(e,"appName",this.c),Bn(e,"authType",this.m),this.a.isOAuthProvider){var t=this.a;try{var n=r.a.app(this.c).auth().la()}catch(c){n=null}for(var i in t.pb=n,Bn(e,"providerId",this.a.providerId),t=Lr((n=this.a).Jb))t[i]=t[i].toString();i=n.Qc,t=ge(t);for(var o=0;o<i.length;o++){var s=i[o];s in t&&delete t[s]}n.qb&&n.pb&&!t[n.qb]&&(t[n.qb]=n.pb),pe(t)||Bn(e,"customParameters",Dr(t))}if("function"==typeof this.a.Rb&&(n=this.a.Rb()).length&&Bn(e,"scopes",n.join(",")),this.l?Bn(e,"redirectUrl",this.l):Jn(e.b,"redirectUrl"),this.g?Bn(e,"eventId",this.g):Jn(e.b,"eventId"),this.i?Bn(e,"v",this.i):Jn(e.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Fn(e,a)&&Bn(e,a,this.b[a]);return this.h?Bn(e,"tid",this.h):Jn(e.b,"tid"),this.f?Bn(e,"eid",this.f):Jn(e.b,"eid"),(a=lc(this.c)).length&&Bn(e,"fw",a.join(",")),e.toString()},(e=uc.prototype).Pb=function(e,t,n){var r=new P("popup-closed-by-user"),i=new P("web-storage-unsupported"),o=this,s=!1;return this.ma().then(function(){(function(e){var t={type:"webStorageSupport"};return dc(e).then(function(){return function(e,t){return e.sb.then(function(){return new _t(function(n){e.a.send(t.type,t,n,Ar("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(e.v,t)}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(e&&pr(e),t(i),s=!0)})}).o(function(){}).then(function(){if(!s)return function(e){return new _t(function(t){return function n(){Pn(2e3).then(function(){if(e&&!e.closed)return n();t()})}()})}(e)}).then(function(){if(!s)return Pn(n).then(function(){t(r)})})},e.Yb=function(){var e=Tr();return!Rr(e)&&!jr(e)},e.Ub=function(){return!1},e.Nb=function(e,t,n,r,i,o,s,a){if(!e)return Tt(new P("popup-blocked"));if(s&&!Rr())return this.ma().o(function(t){pr(e),i(t)}),r(),It();this.a||(this.a=hc(fc(this)));var c=this;return this.a.then(function(){var t=c.ma().o(function(t){throw pr(e),i(t),t});return r(),t}).then(function(){Fo(n),s||hr(pc(c.s,c.g,c.b,t,n,null,o,c.c,void 0,c.i,a,c.f),e)}).o(function(e){throw"auth/network-request-failed"==e.code&&(c.a=null),e})},e.Ob=function(e,t,n,r){this.a||(this.a=hc(fc(this)));var i=this;return this.a.then(function(){Fo(t),hr(pc(i.s,i.g,i.b,e,t,ur(),n,i.c,void 0,i.i,r,i.f))}).o(function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e})},e.ma=function(){var e=this;return dc(this).then(function(){return e.v.sb}).o(function(){throw e.a=null,new P("network-request-failed")})},e.ac=function(){return!0},e.Ea=function(e){this.h.push(e)},e.Ta=function(e){Y(this.h,function(t){return t==e})},(e=gc.prototype).get=function(e){return It(this.a.getItem(e)).then(function(e){return e&&Br(e)})},e.set=function(e,t){return It(this.a.setItem(e,Dr(t)))},e.U=function(e){return It(this.a.removeItem(e))},e.ca=function(){},e.ia=function(){};var yc,vc=[];function bc(e,t,n){pe(e.a)&&e.b.addEventListener("message",e.f),void 0===e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function _c(e){this.a=e}function wc(e){this.c=e,this.b=!1,this.a=[]}function Cc(e,t,n,r){var i,o,s,a,c=n||{},l=null;if(e.b)return Tt(Error("connection_unavailable"));var u=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new _t(function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),s=setTimeout(function(){r(Error("unsupported_event"))},u),e.a.push(l={messageChannel:h,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(s),a=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===e.data.status?(clearTimeout(a),void 0!==e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:c},[h.port2])):r(Error("connection_unavailable"))}).then(function(t){return Ec(e,l),t}).o(function(t){throw Ec(e,l),t})}function Ec(e,t){if(t){var n=t.messageChannel;n&&(n.port1.removeEventListener("message",t.onMessage),n.port1.close()),Y(e.a,function(e){return e==t})}}function Oc(){if(!Tc())throw new P("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=a.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var e=this;wr()&&self?(this.v=function(){var e=wr()?self:null;if(G(vc,function(n){n.b==e&&(t=n)}),!t){var t=new mc(e);vc.push(t)}return t}(),bc(this.v,"keyChanged",function(t,n){return xc(e).then(function(t){return 0<t.length&&G(e.a,function(e){e(t)}),{keyProcessed:Z(t,n.key)}})}),bc(this.v,"ping",function(){return It(["keyChanged"])})):function(){var e=a.navigator;return e&&e.serviceWorker?It().then(function(){return e.serviceWorker.ready}).then(function(e){return e.active||null}).o(function(){return null}):It(null)}().then(function(t){(e.h=t)&&(e.g=new wc(new _c(t)),Cc(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&Z(t[0].value,"keyChanged")&&(e.s=!0)}).o(function(){}))})}function Sc(e){return new _t(function(t,n){var r=e.m.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(t){}n(Error(e.target.error))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(r):function(e){return new _t(function(t,n){var r=e.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}})}(e).then(function(){return Sc(e)}).then(function(e){t(e)}).o(function(e){n(e)})}})}function Pc(e){return e.i||(e.i=Sc(e)),e.i}function Ic(e,t){var n=0;return new _t(function r(i,o){Pc(e).then(t).then(i).o(function(t){if(!(3<++n))return Pc(e).then(function(t){return t.close(),e.i=void 0,r(i,o)}).o(function(e){o(e)});o(t)})})}function Tc(){try{return!!a.indexedDB}catch(We){return!1}}function Ac(e){return e.objectStore("firebaseLocalStorage")}function kc(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function Nc(e){return new _t(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}})}function Mc(e,t){return e.g&&e.h&&function(){var e=a.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}()===e.h?Cc(e.g,"keyChanged",{key:t},e.s).then(function(){}).o(function(){}):It()}function xc(e){return Pc(e).then(function(e){var t=Ac(kc(e,!1));return t.getAll?Nc(t.getAll()):new _t(function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}})}).then(function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=dr(e.c,n),e.c=n}return r})}function Rc(e){e.l&&e.l.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Dc(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=It().then(function(){if(Tc()){var e=Fr(),r="__sak"+e;return yc||(yc=new Oc),(n=yc).set(r,e).then(function(){return n.get(r)}).then(function(t){if(t!==e)throw Error("indexedDB not supported!");return n.U(r)}).then(function(){return n}).o(function(){return t.c})}return t.c}).then(function(e){return t.type=e.type,e.ca(function(e){G(t.a,function(t){t(e)})}),e})}function Lc(){this.a={},this.type="inMemory"}function Bc(){if(!function(){var e="Node"==Cr();if(!(e=Fc()||e&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Cr())throw new P("internal-error","The LocalStorage compatibility library was not found.");throw new P("web-storage-unsupported")}this.a=Fc()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function Fc(){try{var e=a.localStorage,t=Fr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function jc(){this.type="nullStorage"}function Uc(){if(!function(){var e="Node"==Cr();if(!(e=Vc()||e&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Cr())throw new P("internal-error","The SessionStorage compatibility library was not found.");throw new P("web-storage-unsupported")}this.a=Vc()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Vc(){try{var e=a.sessionStorage,t=Fr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function zc(){var e={};e.Browser=$c,e.Node=qc,e.ReactNative=Wc,e.Worker=Zc,this.a=e[Cr()]}mc.prototype.c=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];G(r,function(t){i.push(It().then(function(){return t(e.origin,e.data.data)}))}),kt(i).then(function(r){var i=[];G(r,function(e){i.push({fulfilled:e.Qb,value:e.value,reason:e.reason?e.reason.message:void 0})}),G(i,function(e){for(var t in e)void 0===e[t]&&delete e[t]}),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})})}},_c.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},wc.prototype.close=function(){for(;0<this.a.length;)Ec(this,this.a[0]);this.b=!0},(e=Oc.prototype).set=function(e,t){var n=this,r=!1;return Ic(this,function(t){return Nc((t=Ac(kc(t,!0))).get(e))}).then(function(i){return Ic(n,function(o){if(o=Ac(kc(o,!0)),i)return i.value=t,Nc(o.put(i));n.b++,r=!0;var s={};return s.fbase_key=e,s.value=t,Nc(o.add(s))})}).then(function(){return n.c[e]=t,Mc(n,e)}).oa(function(){r&&n.b--})},e.get=function(e){return Ic(this,function(t){return Nc(Ac(kc(t,!1)).get(e))}).then(function(e){return e&&e.value})},e.U=function(e){var t=this,n=!1;return Ic(this,function(r){return n=!0,t.b++,Nc(Ac(kc(r,!0)).delete(e))}).then(function(){return delete t.c[e],Mc(t,e)}).oa(function(){n&&t.b--})},e.ca=function(e){0==this.a.length&&function(e){Rc(e),function t(){e.f=setTimeout(function(){e.l=xc(e).then(function(t){0<t.length&&G(e.a,function(e){e(t)})}).then(function(){t()}).o(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()}(this),this.a.push(e)},e.ia=function(e){Y(this.a,function(t){return t==e}),0==this.a.length&&Rc(this)},(e=Dc.prototype).get=function(e){return this.b.then(function(t){return t.get(e)})},e.set=function(e,t){return this.b.then(function(n){return n.set(e,t)})},e.U=function(e){return this.b.then(function(t){return t.U(e)})},e.ca=function(e){this.a.push(e)},e.ia=function(e){Y(this.a,function(t){return t==e})},(e=Lc.prototype).get=function(e){return It(this.a[e])},e.set=function(e,t){return this.a[e]=t,It()},e.U=function(e){return delete this.a[e],It()},e.ca=function(){},e.ia=function(){},(e=Bc.prototype).get=function(e){var t=this;return It().then(function(){return Br(t.a.getItem(e))})},e.set=function(e,t){var n=this;return It().then(function(){var r=Dr(t);null===r?n.U(e):n.a.setItem(e,r)})},e.U=function(e){var t=this;return It().then(function(){t.a.removeItem(e)})},e.ca=function(e){a.window&&ln(a.window,"storage",e)},e.ia=function(e){a.window&&dn(a.window,"storage",e)},(e=jc.prototype).get=function(){return It(null)},e.set=function(){return It()},e.U=function(){return It()},e.ca=function(){},e.ia=function(){},(e=Uc.prototype).get=function(e){var t=this;return It().then(function(){return Br(t.a.getItem(e))})},e.set=function(e,t){var n=this;return It().then(function(){var r=Dr(t);null===r?n.U(e):n.a.setItem(e,r)})},e.U=function(e){var t=this;return It().then(function(){t.a.removeItem(e)})},e.ca=function(){},e.ia=function(){};var Hc,Gc,$c={F:Bc,cb:Uc},qc={F:Bc,cb:Uc},Wc={F:gc,cb:jc},Zc={F:Bc,cb:jc},Qc={rd:"local",NONE:"none",td:"session"};function Yc(){var e=!(jr(Tr())||!_r()),t=Rr(),n=kr();this.m=e,this.h=t,this.l=n,this.a={},Hc||(Hc=new zc),e=Hc;try{this.g=!lr()&&Gr()||!a.indexedDB?new e.a.F:new Dc(wr()?new Lc:new e.a.F)}catch(r){this.g=new Lc,this.h=!0}try{this.i=new e.a.cb}catch(r){this.i=new Lc}this.v=new Lc,this.f=w(this.Zb,this),this.b={}}function Kc(){return Gc||(Gc=new Yc),Gc}function Jc(e,t){switch(t){case"session":return e.i;case"none":return e.v;default:return e.g}}function Xc(e,t){return"firebase:"+e.name+(t?":"+t:"")}function el(e,t,n){return n=Xc(t,n),"local"==t.F&&(e.b[n]=null),Jc(e,t.F).U(n)}function tl(e){e.c&&(clearInterval(e.c),e.c=null)}function nl(e){this.a=e,this.b=Kc()}(e=Yc.prototype).get=function(e,t){return Jc(this,e.F).get(Xc(e,t))},e.set=function(e,t,n){var r=Xc(e,n),i=this,o=Jc(this,e.F);return o.set(r,t).then(function(){return o.get(r)}).then(function(t){"local"==e.F&&(i.b[r]=t)})},e.addListener=function(e,t,n){e=Xc(e,t),this.l&&(this.b[e]=a.localStorage.getItem(e)),pe(this.a)&&(Jc(this,"local").ca(this.f),this.h||(lr()||!Gr())&&a.indexedDB||!this.l||function(e){tl(e),e.c=setInterval(function(){for(var t in e.a){var n=a.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new Kt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Zb(n))}},1e3)}(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=Xc(e,t),this.a[e]&&(Y(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),pe(this.a)&&(Jc(this,"local").ia(this.f),tl(this))},e.Zb=function(e){if(e&&e.g){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?Jc(this,"local").ia(this.f):tl(this),this.m)if(n=a.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?a.localStorage.setItem(t,r):a.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===a.localStorage.getItem(t)||(o.b[t]=a.localStorage.getItem(t),o.nb(t))},Qe&&st&&10==st&&a.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else G(e,w(this.nb,this))},e.nb=function(e){this.a[e]&&G(this.a[e],function(e){e()})};var rl,il={name:"authEvent",F:"local"};function ol(){this.a=Kc()}function sl(e,t){this.b=al,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===rl&&(rl=a.Int32Array?new Int32Array(pl):pl),this.reset()}O(sl,function(){this.b=-1});for(var al=64,cl=al-1,ll=[],ul=0;ul<cl;ul++)ll[ul]=0;var hl=K(128,ll);function dl(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){var o=(0|n[t-16])+(((i=0|n[t-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[t-7])+(((r=0|n[t-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+s|0}r=0|e.a[0],i=0|e.a[1];var a=0|e.a[2],c=0|e.a[3],l=0|e.a[4],u=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var d=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))|0)+((s=(s=l&u^~l&h)+(0|rl[t])|0)+(0|n[t])|0)|0,o=h,h=u,u=l,l=c+s|0,c=a,a=i,i=r,r=s+d|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+a|0,e.a[3]=e.a[3]+c|0,e.a[4]=e.a[4]+l|0,e.a[5]=e.a[5]+u|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function fl(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if("string"==typeof t)for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(dl(e),i=0);else{if(!f(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(dl(e),i=0)}}e.c=i,e.g+=n}sl.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):J(this.h)};var pl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function gl(){sl.call(this,8,ml)}O(gl,sl);var ml=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function yl(e,t,n,r,i,o){this.v=e,this.i=t,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=t+":"+n,this.C=new ol,this.g=new nl(this.h),this.f=null,this.b=[],this.a=this.c=null}function vl(e){return new P("invalid-cordova-configuration",e)}function bl(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(r){}}function _l(e){return e.f||(e.f=e.ma().then(function(){return new _t(function(t){e.Ea(function n(r){return t(r),e.Ta(n),!1}),function(e){function t(t){r=!0,i&&i.cancel(),wl(e).then(function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=ro(t.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Br(Fn(o=jn(i),"firebaseError")||null))?I(o):null)?new jo(r.c,r.b,null,null,o,null,r.T()):new jo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}bl(e,i)})}var n=new jo("unknown",null,null,null,new P("no-auth-event")),r=!1,i=Pn(500).then(function(){return wl(e).then(function(){r||bl(e,n)})}),o=a.handleOpenURL;a.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(Ar("BuildInfo.packageName",a).toLowerCase()+"://")&&t({url:e}),"function"==typeof o)try{o(e)}catch(n){console.error(n)}},Ho||(Ho=new Vo),function(e){var t=Ho;t.a.push(e),t.b||(t.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"==typeof(e=Ar("universalLinks.subscribe",a))&&e(null,t.b))}(t)}(e)})})),e.f}function wl(e){var t=null;return function(e){return e.b.get(il,e.a).then(function(e){return Uo(e)})}(e.g).then(function(n){return t=n,el((n=e.g).b,il,n.a)}).then(function(){return t})}function Cl(e){this.a=e,this.b=Kc()}(e=yl.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(br(void 0)?vr().then(function(){return new _t(function(e,t){var n=a.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):Tt(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof Ar("universalLinks.subscribe",a))throw vl("cordova-universal-links-plugin-fix is not installed");if(void 0===Ar("BuildInfo.packageName",a))throw vl("cordova-plugin-buildinfo is not installed");if("function"!=typeof Ar("cordova.plugins.browsertab.openUrl",a))throw vl("cordova-plugin-browsertab is not installed");if("function"!=typeof Ar("cordova.InAppBrowser.open",a))throw vl("cordova-plugin-inappbrowser is not installed")},function(){throw new P("cordova-not-ready")})},e.Pb=function(e,t){return t(new P("operation-not-supported-in-this-environment")),It()},e.Nb=function(){return Tt(new P("operation-not-supported-in-this-environment"))},e.ac=function(){return!1},e.Yb=function(){return!0},e.Ub=function(){return!0},e.Ob=function(e,t,n,r){if(this.c)return Tt(new P("redirect-operation-pending"));var i=this,o=a.document,s=null,c=null,l=null,u=null;return this.c=It().then(function(){return Fo(t),_l(i)}).then(function(){return function(e,t,n,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),s=new jo(t,r,null,o,new P("no-auth-event"),null,i),c=Ar("BuildInfo.packageName",a);if("string"!=typeof c)throw new P("invalid-cordova-configuration");var l=Ar("BuildInfo.displayName",a),u={};if(Tr().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=c;else{if(!Tr().toLowerCase().match(/android/))return Tt(new P("operation-not-supported-in-this-environment"));u.apn=c}l&&(u.appDisplayName=l),o=function(e){var t=new gl;fl(t,e),e=[];var n=8*t.g;fl(t,hl,56>t.c?56-t.c:t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(dl(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return function(e){return q(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}(e)}(o),u.sessionId=o;var h=pc(e.v,e.i,e.l,t,n,null,r,e.m,u,e.u,i,e.s);return e.ma().then(function(){var t=e.h;return e.C.a.set(il,s.w(),t)}).then(function(){var t=Ar("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof t)throw new P("invalid-cordova-configuration");var n=null;t(function(t){if(t){if("function"!=typeof(n=Ar("cordova.plugins.browsertab.openUrl",a)))throw new P("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Ar("cordova.InAppBrowser.open",a)))throw new P("invalid-cordova-configuration");t=Tr(),e.a=n(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,e,t,n,r)}).then(function(){return new _t(function(e,t){c=function(){var t=Ar("cordova.plugins.browsertab.close",a);return e(),"function"==typeof t&&t(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(c),u=function(){zr()&&l()},o.addEventListener("resume",l=function(){s||(s=Pn(2e3).then(function(){t(new P("redirect-cancelled-by-user"))}))},!1),Tr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",u,!1)}).o(function(e){return wl(i).then(function(){throw e})})}).oa(function(){l&&o.removeEventListener("resume",l,!1),u&&o.removeEventListener("visibilitychange",u,!1),s&&s.cancel(),c&&i.Ta(c),i.c=null})},e.Ea=function(e){this.b.push(e),_l(this).o(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new jo("unknown",null,null,null,new P("no-auth-event")),e(t))})},e.Ta=function(e){Y(this.b,function(t){return t==e})};var El={name:"pendingRedirect",F:"session"};function Ol(e){return el(e.b,El,e.a)}function Sl(e,t,n,r){this.i={},this.u=0,this.D=e,this.v=t,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=w(this.s,this),this.b=new Ul,this.C=new $l,this.g=new Cl(Fl(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Pl(this.D,this.v,this.m,T,this.J)}function Pl(e,t,n,i,o){var s=r.a.SDK_VERSION||null;return br()?new yl(e,t,n,s,i,o):new uc(e,t,n,s,i,o)}function Il(e){e.f||(e.f=!0,e.a.Ea(e.l));var t=e.a;return e.a.ma().o(function(n){throw e.a==t&&e.reset(),n})}function Tl(e){e.a.Yb()&&Il(e).o(function(t){var n=new jo("unknown",null,null,null,new P("operation-not-supported-in-this-environment"));Rl(t)&&e.s(n)}),e.a.Ub()||Vl(e.b)}function Al(e,t){Z(e.h,t)||e.h.push(t),e.f||function(e){return e.b.get(El,e.a).then(function(e){return"pending"==e})}(e.g).then(function(t){t?Ol(e.g).then(function(){Il(e).o(function(t){var n=new jo("unknown",null,null,null,new P("operation-not-supported-in-this-environment"));Rl(t)&&e.s(n)})}):Tl(e)}).o(function(){Tl(e)})}function kl(e,t){Y(e.h,function(e){return e==t})}Sl.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Pl(this.D,this.v,this.m,null,this.J),this.i={}},Sl.prototype.s=function(e){if(!e)throw new P("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=Date.now())),t=!0;break}}return Vl(this.b),t};var Nl=new Vr(2e3,1e4),Ml=new Vr(3e4,6e4);function xl(e,t,n,r,i,o,s){return e.a.Nb(t,n,r,function(){e.f||(e.f=!0,e.a.Ea(e.l))},function(){e.reset()},i,o,s)}function Rl(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function Dl(e,t,n,r,i){var o;return function(e){return e.b.set(El,"pending",e.a)}(e.g).then(function(){return e.a.Ob(t,n,r,i).o(function(t){if(Rl(t))throw new P("operation-not-supported-in-this-environment");return o=t,Ol(e.g).then(function(){throw o})}).then(function(){return e.a.ac()?new _t(function(){}):Ol(e.g).then(function(){return e.ra()}).then(function(){}).o(function(){})})})}function Ll(e,t,n,r,i){return e.a.Pb(r,function(e){t.na(n,null,e,i)},Nl.get())}Sl.prototype.ra=function(){return this.b.ra()};var Bl={};function Fl(e,t,n){return e=e+":"+t,n&&(e=e+":"+n.url),e}function jl(e,t,n,r){var i=Fl(t,n,r);return Bl[i]||(Bl[i]=new Sl(e,t,n,r)),Bl[i]}function Ul(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Vl(e){e.g||(e.g=!0,Gl(e,!1,null,null))}function zl(e){e.g&&!e.i&&Gl(e,!1,null,null)}function Hl(e,t){if(e.b=function(){return It(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Gl(e,t,n,r){t?r?function(e,t){if(e.b=function(){return Tt(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):Hl(e,n):Hl(e,{user:null}),e.f=[],e.c=[]}function $l(){}function ql(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(e){this.jb=e},enumerable:!1})}function Wl(e,t){this.a=t,Qr(this,"verificationId",e)}function Zl(e,t,n,r){return new Do(e).gb(t,n).then(function(e){return new Wl(e,r)})}function Ql(e){var t=Hi(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new P("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Yr(this,{token:e,expirationTime:Hr(1e3*t.exp),authTime:Hr(1e3*t.auth_time),issuedAtTime:Hr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,signInSecondFactor:t.firebase&&t.firebase.sign_in_second_factor?t.firebase.sign_in_second_factor:null,claims:t})}function Yl(e,t,n){var r=t&&t[Jl];if(!r)throw new P("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=e,this.f=ge(t),this.g=n,this.c=new io(null,r),this.b=[];var i=this;G(t[Kl]||[],function(e){(e=ei(e))&&i.b.push(e)}),Qr(this,"auth",this.a),Qr(this,"session",this.c),Qr(this,"hints",this.b)}Ul.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Ul.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(Gl(this,!0,null,e.a),It()):t.Fa(n,r)?function(e,t,n){n=n.Fa(t.c,t.b);var r=t.g,i=t.f,o=t.i,s=t.T(),a=!!t.c.match(/Redirect$/);n(r,i,s,o).then(function(t){Gl(e,a,t,null)}).o(function(t){Gl(e,a,null,t)})}(this,e,t):Tt(new P("invalid-auth-event")):(Gl(this,!1,null,null),It())}else Tt(new P("invalid-auth-event"))},Ul.prototype.ra=function(){var e=this;return new _t(function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),function(e){var t=new P("timeout");e.a&&e.a.cancel(),e.a=Pn(Ml.get()).then(function(){e.b||(e.g=!0,Gl(e,!0,null,t))})}(e))})},$l.prototype.h=function(e,t){if(e){var n=e.c,r=e.b;e.a?(t.na(e.c,null,e.a,e.b),It()):t.Fa(n,r)?function(e,t){var n=e.b,r=e.c;t.Fa(r,n)(e.g,e.f,e.T(),e.i).then(function(e){t.na(r,e,null,n)}).o(function(e){t.na(r,null,e,n)})}(e,t):Tt(new P("invalid-auth-event"))}else Tt(new P("invalid-auth-event"))},Wl.prototype.confirm=function(e){return e=Lo(this.verificationId,e),this.a(e)};var Kl="mfaInfo",Jl="mfaPendingCredential";function Xl(e,t,n,r){P.call(this,"multi-factor-auth-required",r,t),this.b=new Yl(e,t,n),Qr(this,"resolver",this.b)}function eu(e,t,n){if(e&&g(e.serverResponse)&&"auth/multi-factor-auth-required"===e.code)try{return new Xl(t,e.serverResponse,n,e.message)}catch(r){}return null}function tu(){}function nu(e){Qr(this,"factorId",e.fa),this.a=e}function ru(e){if(nu.call(this,e),this.a.fa!=Do.PROVIDER_ID)throw new P("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function iu(e,t){for(var n in Yt.call(this,e),t)this[n]=t[n]}function ou(e,t){this.a=e,this.b=[],this.c=w(this.yc,this),ln(this.a,"userReloaded",this.c);var n=[];t&&t.multiFactor&&t.multiFactor.enrolledFactors&&G(t.multiFactor.enrolledFactors,function(e){var t=null,r={};if(e){e.uid&&(r[ri]=e.uid),e.displayName&&(r[ti]=e.displayName),e.enrollmentTime&&(r[ni]=new Date(e.enrollmentTime).toISOString()),e.phoneNumber&&(r[ii]=e.phoneNumber);try{t=new oi(r)}catch(i){}e=t}else e=null;e&&n.push(e)}),su(this,n)}function su(e,t){e.b=t,Qr(e,"enrolledFactors",t)}function au(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function cu(e,t){e.stop(),e.b=Pn(function(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}(e,t)).then(function(){return function(){var e=a.document,t=null;return zr()||!e?It():new _t(function(n){t=function(){zr()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)}).o(function(n){throw e.removeEventListener("visibilitychange",t,!1),n})}()}).then(function(){return e.h()}).then(function(){cu(e,!0)}).o(function(t){e.i(t)&&cu(e,!1)})}function lu(e){this.f=e,this.b=this.a=null,this.c=Date.now()}function uu(e,t){void 0===t&&(t=e.b?(t=e.b).a-t.g:0),e.c=Date.now()+1e3*t}function hu(e,t){e.b=zi(t[Qs]||""),e.a=t.refreshToken,uu(e,void 0!==(t=t.expiresIn)?Number(t):void 0)}function du(e,t){this.a=e||null,this.b=t||null,Yr(this,{lastSignInTime:Hr(t||null),creationTime:Hr(e||null)})}function fu(e,t,n,r,i,o){Yr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function pu(e,t,n){this.N=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var i=r.a.SDK_VERSION?Ir(r.a.SDK_VERSION):null;this.a=new Ws(this.l,M(T),i),(this.u=e.emulatorConfig||null)&&ta(this.a,this.u),this.h=new lu(this.a),Eu(this,t[Qs]),hu(this.h,t),Qr(this,"refreshToken",this.h.a),Pu(this,n||{}),wn.call(this),this.P=!1,this.s&&Nr()&&(this.b=jl(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(e){return new au(function(){return e.I(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var t=e.h.c-Date.now()-3e5;return 0<t?t:0})}(this),this.ba=w(this.ib,this);var o=this;this.za=null,this.Pa=function(e){o.xa(e.h)},this.qa=null,this.Ba=function(e){gu(o,e.c)},this.$=null,this.aa=[],this.Oa=function(e){vu(o,e.f)},this.ja=null,this.S=new ou(this,n),Qr(this,"multiFactor",this.S)}function gu(e,t){e.u=t,ta(e.a,t),e.b&&(t=e.b,e.b=jl(e.s,e.l,e.m,e.u),e.P&&(kl(t,e),Al(e.b,e)))}function mu(e,t){e.qa&&dn(e.qa,"languageCodeChanged",e.Pa),(e.qa=t)&&ln(t,"languageCodeChanged",e.Pa)}function yu(e,t){e.$&&dn(e.$,"emulatorConfigChanged",e.Ba),(e.$=t)&&ln(t,"emulatorConfigChanged",e.Ba)}function vu(e,t){e.aa=t,ra(e.a,r.a.SDK_VERSION?Ir(r.a.SDK_VERSION,e.aa):null)}function bu(e,t){e.ja&&dn(e.ja,"frameworkChanged",e.Oa),(e.ja=t)&&ln(t,"frameworkChanged",e.Oa)}function _u(e){try{return r.a.app(e.m).auth()}catch(t){throw new P("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function wu(e){e.J||e.D.b||(e.D.start(),dn(e,"tokenChanged",e.ba),ln(e,"tokenChanged",e.ba))}function Cu(e){dn(e,"tokenChanged",e.ba),e.D.stop()}function Eu(e,t){e.Aa=t,Qr(e,"_lat",t)}function Ou(e){for(var t=[],n=0;n<e.W.length;n++)t.push(e.W[n](e));return kt(t).then(function(){return e})}function Su(e){e.b&&!e.P&&(e.P=!0,Al(e.b,e))}function Pu(e,t){Yr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new du(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function Iu(){}function Tu(e){return It().then(function(){if(e.J)throw new P("app-deleted")})}function Au(e){return q(e.providerData,function(e){return e.providerId})}function ku(e,t){t&&(Nu(e,t.providerId),e.providerData.push(t))}function Nu(e,t){Y(e.providerData,function(e){return e.providerId==t})}function Mu(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Qr(e,t,n)}function xu(e,t){e!=t&&(Yr(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),Qr(e,"metadata",t.metadata?function(e){return new du(e.a,e.b)}(t.metadata):new du),G(t.providerData,function(t){ku(e,t)}),function(e,t){e.b=t.b,e.a=t.a,e.c=t.c}(e.h,t.h),Qr(e,"refreshToken",e.h.a),su(e.S,t.S.b))}function Ru(e){return e.I().then(function(t){var n=e.isAnonymous;return function(e,t){return Xa(e.a,ka,{idToken:t}).then(w(e.Kc,e))}(e,t).then(function(){return n||Mu(e,"isAnonymous",!1),t})})}function Du(e,t){t[Qs]&&e.Aa!=t[Qs]&&(hu(e.h,t),e.dispatchEvent(new iu("tokenChanged")),Eu(e,t[Qs]),Mu(e,"refreshToken",e.h.a))}function Lu(e,t){return Ru(e).then(function(){if(Z(Au(e),t))return Ou(e).then(function(){throw new P("provider-already-linked")})})}function Bu(e,t,n){return Kr({user:e,credential:Bo(t),additionalUserInfo:t=Zi(t),operationType:n})}function Fu(e,t){return Du(e,t),e.reload().then(function(){return e})}function ju(e,t,n,i,o){if(!Nr())return Tt(new P("operation-not-supported-in-this-environment"));if(e.i&&!o)return Tt(e.i);var s=Wi(n.providerId),a=Fr(e.uid+":::"),c=null;(!Rr()||_r())&&e.s&&n.isOAuthProvider&&(c=pc(e.s,e.l,e.m,t,n,null,a,r.a.SDK_VERSION||null,null,null,e.tenantId,e.u));var l=gr(c,s&&s.va,s&&s.ua);return i=i().then(function(){if(Vu(e),!o)return e.I().then(function(){})}).then(function(){return xl(e.b,l,t,n,a,!!c,e.tenantId)}).then(function(){return new _t(function(n,r){e.na(t,null,new P("cancelled-popup-request"),e.g||null),e.f=n,e.C=r,e.g=a,e.c=Ll(e.b,e,t,l,a)})}).then(function(e){return l&&pr(l),e?Kr(e):null}).o(function(e){throw l&&pr(l),e}),zu(e,i,o)}function Uu(e,t,n,r,i){if(!Nr())return Tt(new P("operation-not-supported-in-this-environment"));if(e.i&&!i)return Tt(e.i);var o=null,s=Fr(e.uid+":::");return r=r().then(function(){if(Vu(e),!i)return e.I().then(function(){})}).then(function(){return e.ga=s,Ou(e)}).then(function(t){return e.ha&&(t=(t=e.ha).b.set($u,e.w(),t.a)),t}).then(function(){return Dl(e.b,t,n,s,e.tenantId)}).o(function(t){if(o=t,e.ha)return qu(e.ha);throw o}).then(function(){if(o)throw o}),zu(e,r,i)}function Vu(e){if(!e.b||!e.P){if(e.b&&!e.P)throw new P("internal-error");throw new P("auth-domain-config-required")}}function zu(e,t,n){var r=function(e,t,n){return e.i&&!n?(t.cancel(),Tt(e.i)):t.o(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.i||e.dispatchEvent(new iu("userInvalidated")),e.i=t),t})}(e,t,n);return e.N.push(r),r.oa(function(){Q(e.N,r)}),r.o(function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=eu(t.w(),_u(e),w(e.jc,e))),n||t})}function Hu(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName,emulatorConfig:e.emulatorConfig},n={};if(!e.stsTokenManager||!e.stsTokenManager.accessToken)return null;n[Qs]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null;var r=e.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new pu(t,n,e);return e.providerData&&G(e.providerData,function(e){e&&ku(i,Kr(e))}),e.redirectEventId&&(i.ga=e.redirectEventId),i}function Gu(e){this.a=e,this.b=Kc()}Yl.prototype.Rc=function(e){var t=this;return e.tb(this.a.a,this.c).then(function(e){var n=ge(t.f);return delete n[Kl],delete n[Jl],ye(n,e),t.g(n)})},O(Xl,P),tu.prototype.tb=function(e,t,n){return t.type==oo?function(e,t,n,r){return n.Ha().then(function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),ye(n,{phoneVerificationInfo:Ro(e.a)}),Xa(t,Ta,n)})}(this,e,t,n):function(e,t,n){return n.Ha().then(function(n){return ye(n={mfaPendingCredential:n},{phoneVerificationInfo:Ro(e.a)}),Xa(t,Aa,n)})}(this,e,t)},O(nu,tu),O(ru,nu),O(iu,Yt),(e=ou.prototype).yc=function(e){su(this,function(e){var t=[];return G(e.mfaInfo||[],function(e){(e=ei(e))&&t.push(e)}),t}(e.hd))},e.Sb=function(){return this.a.I().then(function(e){return new io(e,null)})},e.fc=function(e,t){var n=this,r=this.a.a;return this.Sb().then(function(n){return e.tb(r,n,t)}).then(function(e){return Du(n.a,e),n.a.reload()})},e.bd=function(e){var t=this,n="string"==typeof e?e:e.uid,r=this.a.a;return this.a.I().then(function(e){return Xa(r,Ja,{idToken:e,mfaEnrollmentId:n})}).then(function(e){var r=$(t.b,function(e){return e.uid!=n});return su(t,r),Du(t.a,e),t.a.reload().o(function(e){if("auth/user-token-expired"!=e.code)throw e})})},e.w=function(){return{multiFactor:{enrolledFactors:q(this.b,function(e){return e.w()})}}},au.prototype.start=function(){this.a=this.c,cu(this,!0)},au.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},lu.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},lu.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?Tt(new P("user-token-expired")):e||!this.b||Date.now()>this.c-3e4?this.a?function(e,t){return function(e,t){return new _t(function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?ia(e,e.l+"?key="+encodeURIComponent(e.c),function(e){e?e.error?r(tc(e)):e.access_token&&e.refresh_token?n(e):r(new P("internal-error")):r(new P("network-request-failed"))},"POST",Kn(t).toString(),e.g,e.m.get()):r(new P("internal-error"))})}(e.f,t).then(function(t){return e.b=zi(t.access_token),e.a=t.refresh_token,uu(e,t.expires_in),{accessToken:e.b.toString(),refreshToken:e.a}}).o(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t})}(this,{grant_type:"refresh_token",refresh_token:this.a}):It(null):It({accessToken:this.b.toString(),refreshToken:this.a})},du.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},O(pu,wn),pu.prototype.xa=function(e){this.za=e,ea(this.a,e)},pu.prototype.la=function(){return this.za},pu.prototype.Ga=function(){return J(this.aa)},pu.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Qr(pu.prototype,"providerId","firebase"),(e=pu.prototype).reload=function(){var e=this;return zu(this,Tu(this).then(function(){return Ru(e).then(function(){return Ou(e)}).then(Iu)}))},e.oc=function(e){return this.I(e).then(function(e){return new Ql(e)})},e.I=function(e){var t=this;return zu(this,Tu(this).then(function(){return t.h.getToken(e)}).then(function(e){if(!e)throw new P("internal-error");return e.accessToken!=t.Aa&&(Eu(t,e.accessToken),t.dispatchEvent(new iu("tokenChanged"))),Mu(t,"refreshToken",e.refreshToken),e.accessToken}))},e.Kc=function(e){if(!(e=e.users)||!e.length)throw new P("internal-error");Pu(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t=function(e){return(e=e.providerUserInfo)&&e.length?q(e,function(e){return new fu(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[]}(e),n=0;n<t.length;n++)ku(this,t[n]);Mu(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new iu("userReloaded",{hd:e}))},e.Lc=function(e){return Wr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(e)},e.ub=function(e){var t=this,n=null;return zu(this,e.c(this.a,this.uid).then(function(e){return Du(t,e),n=Bu(t,e,"reauthenticate"),t.i=null,t.reload()}).then(function(){return n}),!0)},e.Cc=function(e){return Wr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(e)},e.rb=function(e){var t=this,n=null;return zu(this,Lu(this,e.providerId).then(function(){return t.I()}).then(function(n){return e.b(t.a,n)}).then(function(e){return n=Bu(t,e,"link"),Fu(t,e)}).then(function(){return n}))},e.Dc=function(e,t){var n=this;return zu(this,Lu(this,"phone").then(function(){return Zl(_u(n),e,t,w(n.rb,n))}))},e.Mc=function(e,t){var n=this;return zu(this,It().then(function(){return Zl(_u(n),e,t,w(n.ub,n))}),!0)},e.Cb=function(e){var t=this;return zu(this,this.I().then(function(n){return t.a.Cb(n,e)}).then(function(e){return Du(t,e),t.reload()}))},e.ed=function(e){var t=this;return zu(this,this.I().then(function(n){return e.b(t.a,n)}).then(function(e){return Du(t,e),t.reload()}))},e.Db=function(e){var t=this;return zu(this,this.I().then(function(n){return t.a.Db(n,e)}).then(function(e){return Du(t,e),t.reload()}))},e.Eb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return Tu(this);var t=this;return zu(this,this.I().then(function(n){return t.a.Eb(n,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(e){return Du(t,e),Mu(t,"displayName",e.displayName||null),Mu(t,"photoURL",e.photoUrl||null),G(t.providerData,function(e){"password"===e.providerId&&(Qr(e,"displayName",t.displayName),Qr(e,"photoURL",t.photoURL))}),Ou(t)}).then(Iu))},e.cd=function(e){var t=this;return zu(this,Ru(this).then(function(n){return Z(Au(t),e)?function(e,t,n){return Xa(e,Sa,{idToken:t,deleteProvider:n})}(t.a,n,[e]).then(function(e){var n={};return G(e.providerUserInfo||[],function(e){n[e.providerId]=!0}),G(Au(t),function(e){n[e]||Nu(t,e)}),n[Do.PROVIDER_ID]||Qr(t,"phoneNumber",null),Ou(t)}):Ou(t).then(function(){throw new P("no-such-provider")})}))},e.delete=function(){var e=this;return zu(this,this.I().then(function(t){return Xa(e.a,Oa,{idToken:t})}).then(function(){e.dispatchEvent(new iu("userDeleted"))})).then(function(){for(var t=0;t<e.N.length;t++)e.N[t].cancel("app-deleted");mu(e,null),yu(e,null),bu(e,null),e.N=[],e.J=!0,Cu(e),Qr(e,"refreshToken",null),e.b&&kl(e.b,e)})},e.Gb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.ga||null)==t||"reauthViaRedirect"==e&&(this.ga||null)==t)},e.na=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?w(this.Lb,this):"reauthViaPopup"==e&&t==(this.g||null)?w(this.Mb,this):"linkViaRedirect"==e&&(this.ga||null)==t?w(this.Lb,this):"reauthViaRedirect"==e&&(this.ga||null)==t?w(this.Mb,this):null},e.Ec=function(e){var t=this;return ju(this,"linkViaPopup",e,function(){return Lu(t,e.providerId).then(function(){return Ou(t)})},!1)},e.Nc=function(e){return ju(this,"reauthViaPopup",e,function(){return It()},!0)},e.Fc=function(e){var t=this;return Uu(this,"linkViaRedirect",e,function(){return Lu(t,e.providerId)},!1)},e.Oc=function(e){return Uu(this,"reauthViaRedirect",e,function(){return It()},!0)},e.Lb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return zu(this,this.I().then(function(n){return ya(i.a,{requestUri:e,postBody:r,sessionId:t,idToken:n})}).then(function(e){return o=Bu(i,e,"link"),Fu(i,e)}).then(function(){return o}))},e.Mb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return zu(this,It().then(function(){return co(va(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)}).then(function(e){return o=Bu(i,e,"reauthenticate"),Du(i,e),i.i=null,i.reload()}).then(function(){return o}),!0)},e.vb=function(e){var t=this,n=null;return zu(this,this.I().then(function(t){return n=t,void 0===e||pe(e)?{}:ji(new Ai(e))}).then(function(e){return t.a.vb(n,e)}).then(function(e){if(t.email!=e)return t.reload()}).then(function(){}))},e.Fb=function(e,t){var n=this,r=null;return zu(this,this.I().then(function(e){return r=e,void 0===t||pe(t)?{}:ji(new Ai(t))}).then(function(t){return n.a.Fb(r,e,t)}).then(function(e){if(n.email!=e)return n.reload()}).then(function(){}))},e.jc=function(e){var t=null,n=this;return zu(this,e=co(It(e),n.uid).then(function(e){return t=Bu(n,e,"reauthenticate"),Du(n,e),n.i=null,n.reload()}).then(function(){return t}),!0)},e.toJSON=function(){return this.w()},e.w=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&ye(e,this.metadata.w()),G(this.providerData,function(t){e.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(t))}),ye(e,this.S.w()),e};var $u={name:"redirectUser",F:"session"};function qu(e){return el(e.b,$u,e.a)}function Wu(e){this.a=e,this.b=Kc(),this.c=null,this.f=function(e){var t=Yu("local"),n=Yu("session"),r=Yu("none");return function(e,t,n){var r=Xc(t,n),i=Jc(e,t.F);return e.get(t,n).then(function(o){var s=null;try{s=Br(a.localStorage.getItem(r))}catch(c){}if(s&&!o)return a.localStorage.removeItem(r),e.set(t,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)})}(e.b,t,e.a).then(function(){return e.b.get(n,e.a)}).then(function(i){return i?n:e.b.get(r,e.a).then(function(n){return n?r:e.b.get(t,e.a).then(function(n){return n?t:e.b.get(Qu,e.a).then(function(e){return e?Yu(e):t})})})}).then(function(t){return e.c=t,Zu(e,t.F)}).o(function(){e.c||(e.c=t)})}(this),this.b.addListener(Yu("local"),this.a,w(this.g,this))}function Zu(e,t){var n,r=[];for(n in Qc)Qc[n]!==t&&r.push(el(e.b,Yu(Qc[n]),e.a));return r.push(el(e.b,Qu,e.a)),function(e){return new _t(function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--,i[e]=n,0==r&&t(i)},s=function(e){n(e)},a=0;a<e.length;a++)At(e[a],C(o,a),s);else t(i)})}(r)}Wu.prototype.g=function(){var e=this,t=Yu("local");eh(this,function(){return It().then(function(){return e.c&&"local"!=e.c.F?e.b.get(t,e.a):null}).then(function(n){if(n)return Zu(e,"local").then(function(){e.c=t})})})};var Qu={name:"persistence",F:"session"};function Yu(e){return{name:"authUser",F:e}}function Ku(e,t){return eh(e,function(){return e.b.set(e.c,t.w(),e.a)})}function Ju(e){return eh(e,function(){return el(e.b,e.c,e.a)})}function Xu(e,t,n){return eh(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),e&&n&&(e.emulatorConfig=n),Hu(e||{})})})}function eh(e,t){return e.f=e.f.then(t,t),e.f}function th(e){if(this.l=!1,Qr(this,"settings",new ql),Qr(this,"app",e),!lh(this).options||!lh(this).options.apiKey)throw new P("invalid-api-key");e=r.a.SDK_VERSION?Ir(r.a.SDK_VERSION):null,this.a=new Ws(lh(this).options&&lh(this).options.apiKey,M(T),e),this.P=[],this.s=[],this.N=[],this.Pa=r.a.INTERNAL.createSubscribe(w(this.zc,this)),this.W=void 0,this.ib=r.a.INTERNAL.createSubscribe(w(this.Ac,this)),ah(this,null),this.i=new Wu(lh(this).options.apiKey+":"+lh(this).name),this.D=new Gu(lh(this).options.apiKey+":"+lh(this).name),this.$=fh(this,function(e){var t=lh(e).options.authDomain,n=function(e){var t=function(e,t){return e.b.get($u,e.a).then(function(e){return e&&t&&(e.authDomain=t),Hu(e||{})})}(e.D,lh(e).options.authDomain).then(function(t){return(e.m=t)&&(t.ha=e.D),qu(e.D)});return fh(e,t)}(e).then(function(){return Xu(e.i,t,e.R)}).then(function(t){return t?(t.ha=e.D,e.m&&(e.m.ga||null)==(t.ga||null)?t:t.reload().then(function(){return Ku(e.i,t).then(function(){return t})}).o(function(n){return"auth/network-request-failed"==n.code?t:Ju(e.i)})):null}).then(function(t){ah(e,t||null)});return fh(e,n)}(this)),this.h=fh(this,function(e){return e.$.then(function(){return sh(e)}).o(function(){}).then(function(){if(!e.l)return e.ja()}).o(function(){}).then(function(){if(!e.l){e.ba=!0;var t=e.i;t.b.addListener(Yu("local"),t.a,e.ja)}})}(this)),this.ba=!1,this.ja=w(this.Zc,this),this.Ba=w(this.da,this),this.qa=w(this.mc,this),this.za=w(this.wc,this),this.Aa=w(this.xc,this),this.b=null,function(e){var t=lh(e).options.authDomain,n=lh(e).options.apiKey;t&&Nr()&&(e.Oa=e.$.then(function(){if(!e.l){if(e.b=jl(t,n,lh(e).name,e.R),Al(e.b,e),uh(e)&&Su(uh(e)),e.m){Su(e.m);var r=e.m;r.xa(e.la()),mu(r,e),vu(r=e.m,e.J),bu(r,e),gu(r=e.m,e.R),yu(r,e),e.m=null}return e.b}}))}(this),this.INTERNAL={},this.INTERNAL.delete=w(this.delete,this),this.INTERNAL.logFramework=w(this.Gc,this),this.u=0,wn.call(this),function(e){Object.defineProperty(e,"lc",{get:function(){return this.la()},set:function(e){this.xa(e)},enumerable:!1}),e.aa=null,Object.defineProperty(e,"ti",{get:function(){return this.T()},set:function(e){this.zb(e)},enumerable:!1}),e.S=null,Object.defineProperty(e,"emulatorConfig",{get:function(){if(this.R){var e=jn(this.R.url);e=Kr({protocol:e.c,host:e.a,port:e.g,options:Kr({disableWarnings:this.R.ec})})}else e=null;return e},enumerable:!1})}(this),this.J=[],this.R=null}function nh(e){Yt.call(this,"languageCodeChanged"),this.h=e}function rh(e){Yt.call(this,"emulatorConfigChanged"),this.c=e}function ih(e){Yt.call(this,"frameworkChanged"),this.f=e}function oh(e){return e.Oa||Tt(new P("auth-domain-config-required"))}function sh(e){if(!Nr())return Tt(new P("operation-not-supported-in-this-environment"));var t=oh(e).then(function(){return e.b.ra()}).then(function(e){return e?Kr(e):null});return fh(e,t)}function ah(e,t){uh(e)&&(function(e,t){Y(e.W,function(e){return e==t})}(uh(e),e.Ba),dn(uh(e),"tokenChanged",e.qa),dn(uh(e),"userDeleted",e.za),dn(uh(e),"userInvalidated",e.Aa),Cu(uh(e))),t&&(t.W.push(e.Ba),ln(t,"tokenChanged",e.qa),ln(t,"userDeleted",e.za),ln(t,"userInvalidated",e.Aa),0<e.u&&wu(t)),Qr(e,"currentUser",t),t&&(t.xa(e.la()),mu(t,e),vu(t,e.J),bu(t,e),gu(t,e.R),yu(t,e))}function ch(e,t){var n=null,r=null;return fh(e,t.then(function(t){return n=Bo(t),r=Zi(t),function(e,t){var n={};return n.apiKey=lh(e).options.apiKey,n.authDomain=lh(e).options.authDomain,n.appName=lh(e).name,e.R&&(n.emulatorConfig=e.R),e.$.then(function(){return function(e,t,n,r){var i=new pu(e,t);return n&&(i.ha=n),r&&vu(i,r),i.reload().then(function(){return i})}(n,t,e.D,e.Ga())}).then(function(t){return uh(e)&&t.uid==uh(e).uid?(xu(uh(e),t),e.da(t)):(ah(e,t),Su(t),e.da(t))}).then(function(){dh(e)})}(e,t)},function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=eu(t.w(),e,w(e.kc,e))),n||t}).then(function(){return Kr({user:uh(e),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function lh(e){return e.app}function uh(e){return e.currentUser}function hh(e){return uh(e)&&uh(e)._lat||null}function dh(e){if(e.ba){for(var t=0;t<e.s.length;t++)e.s[t]&&e.s[t](hh(e));if(e.W!==e.getUid()&&e.N.length)for(e.W=e.getUid(),t=0;t<e.N.length;t++)e.N[t]&&e.N[t](hh(e))}}function fh(e,t){return e.P.push(t),t.oa(function(){Q(e.P,t)}),t}function ph(){}function gh(){this.a={},this.b=1e12}Wu.prototype.yb=function(e){var t=null,n=this;return function(e){var t=new P("invalid-persistence-type"),n=new P("unsupported-persistence-type");e:{for(r in Qc)if(Qc[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(Cr()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;case"Worker":if("session"===e||!Tc()&&"none"!==e)throw n;break;default:if(!kr()&&"none"!==e)throw n}}(e),eh(this,function(){return e!=n.c.F?n.b.get(n.c,n.a).then(function(r){return t=r,Zu(n,e)}).then(function(){if(n.c=Yu(e),t)return n.b.set(n.c,t,n.a)}):It()})},O(th,wn),O(nh,Yt),O(rh,Yt),O(ih,Yt),(e=th.prototype).yb=function(e){return fh(this,e=this.i.yb(e))},e.xa=function(e){this.aa===e||this.l||(this.aa=e,ea(this.a,this.aa),this.dispatchEvent(new nh(this.la())))},e.la=function(){return this.aa},e.fd=function(){var e=a.navigator;this.xa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.gd=function(e,t){if(!this.R){if(!/^https?:\/\//.test(e))throw new P("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(e){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),a.document&&!e&&vr().then(function(){var e=a.document.createElement("div");e.innerText="Running in emulator mode. Do not use with production credentials.",e.style.position="fixed",e.style.width="100%",e.style.backgroundColor="#ffffff",e.style.border=".1em solid #000000",e.style.color="#b50000",e.style.bottom="0px",e.style.left="0px",e.style.margin="0px",e.style.zIndex=1e4,e.style.textAlign="center",e.classList.add("firebase-emulator-warning"),a.document.body.appendChild(e)})})(t=!!t&&!!t.disableWarnings),this.R={url:e,ec:t},this.settings.jb=!0,ta(this.a,this.R),this.dispatchEvent(new rh(this.R))}},e.Gc=function(e){this.J.push(e),ra(this.a,r.a.SDK_VERSION?Ir(r.a.SDK_VERSION,this.J):null),this.dispatchEvent(new ih(this.J))},e.Ga=function(){return J(this.J)},e.zb=function(e){this.S===e||this.l||(this.S=e,this.a.b=this.S)},e.T=function(){return this.S},e.toJSON=function(){return{apiKey:lh(this).options.apiKey,authDomain:lh(this).options.authDomain,appName:lh(this).name,currentUser:uh(this)&&uh(this).w()}},e.Gb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},e.na=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?w(this.ic,this):null},e.ic=function(e,t,n,r){var i=this,o={requestUri:e,postBody:r,sessionId:t,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then(function(){return ch(i,ma(i.a,o))})},e.Xc=function(e){if(!Nr())return Tt(new P("operation-not-supported-in-this-environment"));var t=this,n=Wi(e.providerId),i=Fr(),o=null;(!Rr()||_r())&&lh(this).options.authDomain&&e.isOAuthProvider&&(o=pc(lh(this).options.authDomain,lh(this).options.apiKey,lh(this).name,"signInViaPopup",e,null,i,r.a.SDK_VERSION||null,null,null,this.T(),this.R));var s=gr(o,n&&n.va,n&&n.ua);return fh(this,n=oh(this).then(function(n){return xl(n,s,"signInViaPopup",e,i,!!o,t.T())}).then(function(){return new _t(function(e,n){t.na("signInViaPopup",null,new P("cancelled-popup-request"),t.g),t.f=e,t.C=n,t.g=i,t.c=Ll(t.b,t,"signInViaPopup",s,i)})}).then(function(e){return s&&pr(s),e?Kr(e):null}).o(function(e){throw s&&pr(s),e}))},e.Yc=function(e){if(!Nr())return Tt(new P("operation-not-supported-in-this-environment"));var t=this;return fh(this,oh(this).then(function(){return function(e){return eh(e,function(){return e.b.set(Qu,e.c.F,e.a)})}(t.i)}).then(function(){return Dl(t.b,"signInViaRedirect",e,void 0,t.T())}))},e.ra=function(){var e=this;return sh(this).then(function(t){return e.b&&zl(e.b.b),t}).o(function(t){throw e.b&&zl(e.b.b),t})},e.dd=function(e){if(!e)return Tt(new P("null-user"));if(this.S!=e.tenantId)return Tt(new P("tenant-id-mismatch"));var t=this,n={};n.apiKey=lh(this).options.apiKey,n.authDomain=lh(this).options.authDomain,n.appName=lh(this).name;var r=function(e,t,n,r){var i=e.h,o={};return o[Qs]=i.b&&i.b.toString(),o.refreshToken=i.a,t=new pu(t||{apiKey:e.l,authDomain:e.s,appName:e.m},o),n&&(t.ha=n),r&&vu(t,r),xu(t,e),t}(e,n,t.D,t.Ga());return fh(this,this.h.then(function(){if(lh(t).options.apiKey!=e.l)return r.reload()}).then(function(){return uh(t)&&e.uid==uh(t).uid?(xu(uh(t),e),t.da(e)):(ah(t,r),Su(r),t.da(r))}).then(function(){dh(t)}))},e.Bb=function(){var e=this;return fh(this,this.h.then(function(){return e.b&&zl(e.b.b),uh(e)?(ah(e,null),Ju(e.i).then(function(){dh(e)})):It()}))},e.Zc=function(){var e=this;return Xu(this.i,lh(this).options.authDomain).then(function(t){if(!e.l){var n;if(n=uh(e)&&t){n=uh(e).uid;var r=t.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return xu(uh(e),t),uh(e).I();(uh(e)||t)&&(ah(e,t),t&&(Su(t),t.ha=e.D),e.b&&Al(e.b,e),dh(e))}})},e.da=function(e){return Ku(this.i,e)},e.mc=function(){dh(this),this.da(uh(this))},e.wc=function(){this.Bb()},e.xc=function(){this.Bb()},e.kc=function(e){var t=this;return this.h.then(function(){return ch(t,It(e))})},e.zc=function(e){var t=this;this.addAuthTokenListener(function(){e.next(uh(t))})},e.Ac=function(e){var t=this;!function(e,t){e.N.push(t),fh(e,e.h.then(function(){!e.l&&Z(e.N,t)&&e.W!==e.getUid()&&(e.W=e.getUid(),t(hh(e)))}))}(this,function(){e.next(uh(t))})},e.Ic=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof e?e(uh(r)):"function"==typeof e.next&&e.next(uh(r))}),this.Pa(e,t,n)},e.Hc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){r.W=r.getUid(),"function"==typeof e?e(uh(r)):"function"==typeof e.next&&e.next(uh(r))}),this.ib(e,t,n)},e.nc=function(e){var t=this;return fh(this,this.h.then(function(){return uh(t)?uh(t).I(e).then(function(e){return{accessToken:e}}):null}))},e.Tc=function(e){var t=this;return this.h.then(function(){return ch(t,Xa(t.a,Wa,{token:e}))}).then(function(e){var n=e.user;return Mu(n,"isAnonymous",!1),t.da(n),e})},e.Uc=function(e,t){var n=this;return this.h.then(function(){return ch(n,Xa(n.a,Za,{email:e,password:t}))})},e.dc=function(e,t){var n=this;return this.h.then(function(){return ch(n,Xa(n.a,Ca,{email:e,password:t}))})},e.ab=function(e){var t=this;return this.h.then(function(){return ch(t,e.ka(t.a))})},e.Sc=function(e){return Wr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(e)},e.Ab=function(){var e=this;return this.h.then(function(){var t=uh(e);if(t&&t.isAnonymous){var n=Kr({providerId:null,isNewUser:!1});return Kr({user:t,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ch(e,e.a.Ab()).then(function(t){var n=t.user;return Mu(n,"isAnonymous",!0),e.da(n),t})})},e.getUid=function(){return uh(this)&&uh(this).uid||null},e.cc=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&uh(this)&&wu(uh(this))},e.Pc=function(e){var t=this;G(this.s,function(n){n==e&&t.u--}),0>this.u&&(this.u=0),0==this.u&&uh(this)&&Cu(uh(this)),this.removeAuthTokenListener(e)},e.addAuthTokenListener=function(e){var t=this;this.s.push(e),fh(this,this.h.then(function(){t.l||Z(t.s,e)&&e(hh(t))}))},e.removeAuthTokenListener=function(e){Y(this.s,function(t){return t==e})},e.delete=function(){this.l=!0;for(var e=0;e<this.P.length;e++)this.P[e].cancel("app-deleted");return this.P=[],this.i&&(e=this.i).b.removeListener(Yu("local"),e.a,this.ja),this.b&&(kl(this.b,this),zl(this.b.b)),Promise.resolve()},e.hc=function(e){return fh(this,function(e,t){return Xa(e,Ea,{identifier:t,continueUri:Mr()?ur():"http://localhost"}).then(function(e){return e.signinMethods||[]})}(this.a,e))},e.Bc=function(e){return!!No(e)},e.xb=function(e,t){var n=this;return fh(this,It().then(function(){var e=new Ai(t);if(!e.c)throw new P("argument-error",Mi+" must be true when sending sign in link to email");return ji(e)}).then(function(t){return n.a.xb(e,t)}).then(function(){}))},e.jd=function(e){return this.Sa(e).then(function(e){return e.data.email})},e.ob=function(e,t){return fh(this,this.a.ob(e,t).then(function(){}))},e.Sa=function(e){return fh(this,this.a.Sa(e).then(function(e){return new si(e)}))},e.kb=function(e){return fh(this,this.a.kb(e).then(function(){}))},e.wb=function(e,t){var n=this;return fh(this,It().then(function(){return void 0===t||pe(t)?{}:ji(new Ai(t))}).then(function(t){return n.a.wb(e,t)}).then(function(){}))},e.Wc=function(e,t){return fh(this,Zl(this,e,t,w(this.ab,this)))},e.Vc=function(e,t){var n=this;return fh(this,It().then(function(){var r=t||ur(),i=ko(e,r);if(!(r=No(r)))throw new P("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new P("tenant-id-mismatch");return n.ab(i)}))},ph.prototype.render=function(){},ph.prototype.reset=function(){},ph.prototype.getResponse=function(){},ph.prototype.execute=function(){};var mh=null;function yh(e,t){return(t=vh(t))&&e.a[t]||null}function vh(e){return(e=void 0===e?1e12:e)?e.toString():null}function bh(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ct(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():ln(this.f,"click",this.i)}function _h(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function wh(){}function Ch(){}gh.prototype.render=function(e,t){return this.a[this.b.toString()]=new bh(e,t),this.b++},gh.prototype.reset=function(e){var t=yh(this,e);e=vh(e),t&&e&&(t.delete(),delete this.a[e])},gh.prototype.getResponse=function(e){return(e=yh(this,e))?e.getResponse():null},gh.prototype.execute=function(e){(e=yh(this,e))&&e.execute()},bh.prototype.getResponse=function(){return _h(this),this.b},bh.prototype.execute=function(){_h(this);var e=this;this.a||(this.a=setTimeout(function(){e.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(r){}e.a=setTimeout(function(){if(e.a=null,e.b=null,n)try{n()}catch(r){}e.h&&e.execute()},6e4)},500))},bh.prototype.delete=function(){_h(this),this.g=!0,clearTimeout(this.a),this.a=null,dn(this.f,"click",this.i)},Qr(wh,"FACTOR_ID","phone"),Ch.prototype.g=function(){return mh||(mh=new gh),It(mh)},Ch.prototype.c=function(){};var Eh=null;function Oh(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Sh=new be(Ee,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Ph=new Vr(3e4,6e4);Oh.prototype.g=function(e){var t=this;return new _t(function(n,r){var i=setTimeout(function(){r(new P("network-request-failed"))},Ph.get());!a.grecaptcha||e!==t.f&&!t.b?(a[t.a]=function(){if(a.grecaptcha){t.f=e;var o=a.grecaptcha.render;a.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new P("internal-error"));delete a[t.a]},It(Us(Ie(Sh,{onload:t.a,hl:e||""}))).o(function(){clearTimeout(i),r(new P("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(a.grecaptcha))})},Oh.prototype.c=function(){this.b--};var Ih=null;function Th(e,t,n,r,i,o,s){if(Qr(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=t,this.g=null,s?(Eh||(Eh=new Ch),s=Eh):(Ih||(Ih=new Oh),s=Ih),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Nh])throw new P("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Mh],!a.document)throw new P("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ct(t)||!this.i&&ct(t).hasChildNodes())throw new P("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Ws(e,o||null,i||null),this.u=r||function(){return null};var c=this;this.l=[];var l=this.a[Ah];this.a[Ah]=function(e){if(xh(c,e),"function"==typeof l)l(e);else if("string"==typeof l){var t=Ar(l,a);"function"==typeof t&&t(e)}};var u=this.a[kh];this.a[kh]=function(){if(xh(c,null),"function"==typeof u)u();else if("string"==typeof u){var e=Ar(u,a);"function"==typeof e&&e()}}}var Ah="callback",kh="expired-callback",Nh="sitekey",Mh="size";function xh(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(r){}}function Rh(e,t){return e.h.push(t),t.oa(function(){Q(e.h,t)}),t}function Dh(e){if(e.J)throw new P("internal-error","RecaptchaVerifier instance has been destroyed.")}function Lh(e,t,n){var i=!1;try{this.b=n||r.a.app()}catch(a){throw new P("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new P("invalid-api-key");n=this.b.options.apiKey;var o=this,s=null;try{s=this.b.auth().Ga()}catch(a){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}s=r.a.SDK_VERSION?Ir(r.a.SDK_VERSION,s):null,Th.call(this,n,e,t,function(){try{var e=o.b.auth().la()}catch(t){e=null}return e},s,M(T),i)}function Bh(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<t.length;s++)if(t[s].optional)o=!0;else{if(o)throw new P("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],0>i||i>=Fh.length)throw new P("internal-error","Argument validator received an unsupported number of arguments.");n=Fh[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new P("argument-error",e+" failed: "+r)}(e=Th.prototype).Ia=function(){var e=this;return this.f?this.f:this.f=Rh(this,It().then(function(){if(Mr()&&!wr())return vr();throw new P("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return e.m.g(e.u())}).then(function(t){return e.g=t,Xa(e.s,La,{})}).then(function(t){e.a[Nh]=t.recaptchaSiteKey}).o(function(t){throw e.f=null,t}))},e.render=function(){Dh(this);var e=this;return Rh(this,this.Ia().then(function(){if(null===e.c){var t=e.v;if(!e.i){var n=ct(t);t=function(e,t,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!at&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',Ge(s.name),'"'),s.type){o.push(' type="',Ge(s.type),'"');var a={};ye(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=pt(i,o),s&&("string"==typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):lt(o,s)),2<r.length&&ft(i,o,r),o}("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c}))},e.verify=function(){Dh(this);var e=this;return Rh(this,this.render().then(function(t){return new _t(function(n){var r=e.g.getResponse(t);if(r)n(r);else{var i=function(t){t&&(function(e,t){Y(e.l,function(e){return e==t})}(e,i),n(t))};e.l.push(i),e.i&&e.g.execute(e.c)}})}))},e.reset=function(){Dh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Dh(this),this.J=!0,this.m.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=ct(this.v);for(var t;t=e.firstChild;)e.removeChild(t)}},O(Lh,Th);var Fh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function jh(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:function(e){return"string"==typeof e}}}function Uh(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:function(e){return"boolean"==typeof e}}}function Vh(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:g}}function zh(e,t){return{name:e||"",K:"a function",optional:!!t,M:function(e){return"function"==typeof e}}}function Hh(e,t){return{name:e||"",K:"null",optional:!!t,M:function(e){return null===e}}}function Gh(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){return!!t&&!(!t.ka||e&&t.providerId!==e)}}}function $h(e,t){return g(e)&&"string"==typeof e.type&&e.type===t&&"function"==typeof e.Ha}function qh(e){return g(e)&&"string"==typeof e.uid}function Wh(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function Zh(e,t){for(var n in t){var r=t[n].name;e[r]=Kh(r,e[n],t[n].j)}}function Qh(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:C(function(e){return this[e]},n),set:C(function(e,t,n,r){Bh(e,[n],[r],!0),this[t]=r},r,n,t[n].lb),enumerable:!0})}}function Yh(e,t,n,r){e[t]=Kh(t,n,r)}function Kh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return Bh(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=function(e){return(e=e.split("."))[e.length-1]}(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}Zh(th.prototype,{kb:{name:"applyActionCode",j:[jh("code")]},Sa:{name:"checkActionCode",j:[jh("code")]},ob:{name:"confirmPasswordReset",j:[jh("code"),jh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[jh("email"),jh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[jh("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[jh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Wh(Vh(),zh(),"nextOrObserver"),zh("opt_error",!0),zh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Wh(Vh(),zh(),"nextOrObserver"),zh("opt_error",!0),zh("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[jh("email"),Wh(Vh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[jh("email"),Vh("actionCodeSettings")]},yb:{name:"setPersistence",j:[jh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Gh()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Gh()]},Tc:{name:"signInWithCustomToken",j:[jh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[jh("email"),jh("password")]},Vc:{name:"signInWithEmailLink",j:[jh("email"),jh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Wh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof pu)}},Hh(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[jh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[jh("url"),Vh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[jh("code")]}}),Qh(th.prototype,{lc:{name:"languageCode",lb:Wh(jh(),Hh(),"languageCode")},ti:{name:"tenantId",lb:Wh(jh(),Hh(),"tenantId")}}),(th.Persistence=Qc).LOCAL="local",th.Persistence.SESSION="session",th.Persistence.NONE="none",Zh(pu.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Uh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Uh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Gh()]},rb:{name:"linkWithCredential",j:[Gh()]},Dc:{name:"linkWithPhoneNumber",j:[jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Gh()]},ub:{name:"reauthenticateWithCredential",j:[Gh()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[Wh(Vh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[jh(null,!0)]},cd:{name:"unlink",j:[jh("provider")]},Cb:{name:"updateEmail",j:[jh("email")]},Db:{name:"updatePassword",j:[jh("password")]},ed:{name:"updatePhoneNumber",j:[Gh("phone")]},Eb:{name:"updateProfile",j:[Vh("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[jh("email"),Wh(Vh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]}}),Zh(gh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zh(ph.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zh(_t.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Qh(ql.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Uh("appVerificationDisabledForTesting")}}),Zh(Wl.prototype,{confirm:{name:"confirm",j:[jh("verificationCode")]}}),Yh(ao,"fromJSON",function(e){e="string"==typeof e?JSON.parse(e):e;for(var t,n=[go,To,xo,ho],r=0;r<n.length;r++)if(t=n[r](e))return t;return null},[Wh(jh(),Vh(),"json")]),Yh(Ao,"credential",function(e,t){return new Io(e,t)},[jh("email"),jh("password")]),Zh(Io.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Zh(bo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(bo,"credential",_o,[Wh(jh(),Vh(),"token")]),Yh(Ao,"credentialWithLink",ko,[jh("email"),jh("emailLink")]),Zh(wo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(wo,"credential",Co,[Wh(jh(),Vh(),"token")]),Zh(Eo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(Eo,"credential",Oo,[Wh(jh(),Wh(Vh(),Hh()),"idToken"),Wh(jh(),Hh(),"accessToken",!0)]),Zh(So.prototype,{Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(So,"credential",Po,[Wh(jh(),Vh(),"token"),jh("secret",!0)]),Zh(vo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},credential:{name:"credential",j:[Wh(jh(),Wh(Vh(),Hh()),"optionsOrIdToken"),Wh(jh(),Hh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Zh(fo.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Zh(lo.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Yh(Do,"credential",Lo,[jh("verificationId"),jh("verificationCode")]),Zh(Do.prototype,{gb:{name:"verifyPhoneNumber",j:[Wh(jh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(e){return!!e&&(e.session&&e.phoneNumber?$h(e.session,oo)&&"string"==typeof e.phoneNumber:e.session&&e.multiFactorHint?$h(e.session,so)&&qh(e.multiFactorHint):e.session&&e.multiFactorUid?$h(e.session,so)&&"string"==typeof e.multiFactorUid:!!e.phoneNumber&&"string"==typeof e.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]}}),Zh(Mo.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Zh(P.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh($o.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(Go.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(Xl.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(Yl.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.tb}}]}}),Zh(ou.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.tb}},jh("displayName",!0)]},bd:{name:"unenroll",j:[Wh({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:qh},jh(),"multiFactorInfoIdentifier")]}}),Zh(Lh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Yh(_i,"parseLink",Ti,[jh("link")]),Yh(wh,"assertion",function(e){return new ru(e)},[Gh("phone")]),function(){if(void 0===r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ci,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ai,VERIFY_AND_CHANGE_EMAIL:li,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:th,AuthCredential:ao,Error:P};Yh(e,"EmailAuthProvider",Ao,[]),Yh(e,"FacebookAuthProvider",bo,[]),Yh(e,"GithubAuthProvider",wo,[]),Yh(e,"GoogleAuthProvider",Eo,[]),Yh(e,"TwitterAuthProvider",So,[]),Yh(e,"OAuthProvider",vo,[jh("providerId")]),Yh(e,"SAMLAuthProvider",yo,[jh("providerId")]),Yh(e,"PhoneAuthProvider",Do,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof th)}}]),Yh(e,"RecaptchaVerifier",Lh,[Wh(jh(),{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Vh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof r.a.app.App)}}]),Yh(e,"ActionCodeURL",_i,[]),Yh(e,"PhoneMultiFactorGenerator",wh,[]),r.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new th(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(e){e.getProvider("auth-internal").initialize()}}),r.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:w((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:w(e.nc,e),addAuthTokenListener:w(e.cc,e),removeAuthTokenListener:w(e.Pc,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.a.registerVersion("@firebase/auth","0.16.8"),r.a.INTERNAL.extendNamespace({User:pu})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},"7o/Q":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("n6bG"),i=n("gRHU"),o=n("quSY"),s=n("2QA8"),a=n("2fFW"),c=n("NJ4a");class l extends o.a{constructor(e,t,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=i.a;break;case 1:if(!e){this.destination=i.a;break}if("object"==typeof e){e instanceof l?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,e,t,n)}}[s.a](){return this}static create(e,t,n){const r=new l(e,t,n);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class u extends l{constructor(e,t,n,o){let s;super(),this._parentSubscriber=e;let a=this;Object(r.a)(t)?s=t:t&&(s=t.next,n=t.error,o=t.complete,t!==i.a&&(a=Object.create(t),Object(r.a)(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=s,this._error=n,this._complete=o}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;a.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:n}=a.a;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):Object(c.a)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;Object(c.a)(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);a.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),a.a.useDeprecatedSynchronousErrorHandling)throw n;Object(c.a)(n)}}__tryOrSetError(e,t,n){if(!a.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return a.a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(Object(c.a)(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}},"9ppp":function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})()},Cfvw:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n("HDdC"),i=n("SeVD"),o=n("quSY"),s=n("kJWO"),a=n("jZKg"),c=n("Lhse"),l=n("c2HN"),u=n("I55L");function h(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[s.a]}(e))return function(e,t){return new r.a(n=>{const r=new o.a;return r.add(t.schedule(()=>{const i=e[s.a]();r.add(i.subscribe({next(e){r.add(t.schedule(()=>n.next(e)))},error(e){r.add(t.schedule(()=>n.error(e)))},complete(){r.add(t.schedule(()=>n.complete()))}}))})),r})}(e,t);if(Object(l.a)(e))return function(e,t){return new r.a(n=>{const r=new o.a;return r.add(t.schedule(()=>e.then(e=>{r.add(t.schedule(()=>{n.next(e),r.add(t.schedule(()=>n.complete()))}))},e=>{r.add(t.schedule(()=>n.error(e)))}))),r})}(e,t);if(Object(u.a)(e))return Object(a.a)(e,t);if(function(e){return e&&"function"==typeof e[c.a]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new r.a(n=>{const r=new o.a;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(t.schedule(()=>{i=e[c.a](),r.add(t.schedule(function(){if(n.closed)return;let e,t;try{const n=i.next();e=n.value,t=n.done}catch(r){return void n.error(r)}t?n.complete():(n.next(e),this.schedule())}))})),r})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof r.a?e:new r.a(Object(i.a)(e))}},D0XW:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("3N8a");const i=new(n("IjjT").a)(r.a)},DH7j:function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r=(()=>Array.isArray||(e=>e&&"number"==typeof e.length))()},EQ5u:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return c});var r=n("XNiG"),i=n("HDdC"),o=(n("7o/Q"),n("quSY")),s=n("x+ZX");class a extends i.a{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new o.a,e.add(this.source.subscribe(new l(this.getSubject(),this))),e.closed&&(this._connection=null,e=o.a.EMPTY)),e}refCount(){return Object(s.a)()(this)}}const c=(()=>{const e=a.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class l extends r.b{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}},EY2u:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n("HDdC");const i=new r.a(e=>e.complete());function o(e){return e?function(e){return new r.a(t=>e.schedule(()=>t.complete()))}(e):i}},HDdC:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("7o/Q"),i=n("2QA8"),o=n("gRHU"),s=n("kJWO"),a=n("SpAZ"),c=n("2fFW");let l=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const n=new e;return n.source=this,n.operator=t,n}subscribe(e,t,n){const{operator:s}=this,a=function(e,t,n){if(e){if(e instanceof r.a)return e;if(e[i.a])return e[i.a]()}return e||t||n?new r.a(e,t,n):new r.a(o.a)}(e,t,n);if(a.add(s?s.call(a,this.source):this.source||c.a.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),c.a.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(e){try{return this._subscribe(e)}catch(t){c.a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:n,isStopped:i}=e;if(t||i)return!1;e=n&&n instanceof r.a?n:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=u(t))((t,n)=>{let r;r=this.subscribe(t=>{try{e(t)}catch(i){n(i),r&&r.unsubscribe()}},n,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[s.a](){return this}pipe(...e){return 0===e.length?this:(0===(t=e).length?a.a:1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)})(this);var t}toPromise(e){return new(e=u(e))((e,t)=>{let n;this.subscribe(e=>n=e,e=>t(e),()=>e(n))})}}return e.create=t=>new e(t),e})();function u(e){if(e||(e=c.a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},Hfs6:function(e,t,n){var r,i,o;!function(s){if("object"==typeof e.exports){var a=s(0,t);void 0!==a&&(e.exports=a)}else i=[n,t],void 0===(o="function"==typeof(r=s)?r.apply(t,i):r)||(e.exports=o)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},I55L:function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r=e=>e&&"number"==typeof e.length&&"function"!=typeof e},IjjT:function(e,t,n){"use strict";n.d(t,"a",function(){return i});let r=(()=>{class e{constructor(t,n=e.now){this.SchedulerAction=t,this.now=n}schedule(e,t=0,n){return new this.SchedulerAction(this,e).schedule(n,t)}}return e.now=()=>Date.now(),e})();class i extends r{constructor(e,t=r.now){super(e,()=>i.delegate&&i.delegate!==this?i.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,n){return i.delegate&&i.delegate!==this?i.delegate.schedule(e,t,n):super.schedule(e,t,n)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}},Jgta:function(e,t,n){"use strict";var r=n("zIRd");n.d(t,"a",function(){return r.a}),r.a.registerVersion("firebase","8.10.0","app"),r.a.SDK_VERSION="8.10.0"},LRne:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("z+Ro"),i=n("yCtX"),o=n("jZKg");function s(...e){let t=e[e.length-1];return Object(r.a)(t)?(e.pop(),Object(o.a)(e,t)):Object(i.a)(e)}},Lhse:function(e,t,n){"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(t,"a",function(){return i});const i=r()},NJ4a:function(e,t,n){"use strict";function r(e){setTimeout(()=>{throw e},0)}n.d(t,"a",function(){return r})},S0Ta:function(e,t,n){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++)n=null==arguments[r]?{}:arguments[r],r%2?t(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))});return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){var e;return null!==(e=h)&&void 0!==e?e:document}var c={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},l=n({},c),u={},h=null,d=function(){function e(t){var n=this;r(this,e),this.element=a().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),o=["notification",this.extraClasses];if(this.type&&o.push(this.type),this.animate&&this.animate.in){var s="animate__".concat(this.animate.in),c=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";o.push("animate__animated ".concat(s," ").concat(c)),this.onAnimationEnd(function(){return n.element.classList.remove(s)})}if(this.element.className=o.join(" "),this.dismissible){var l=a().createElement("button");l.className="delete",l.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",l)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var u=new f(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){u.pause()}),this.element.addEventListener("mouseout",function(){u.resume()}))}return o(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete u.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete u.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),f=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return o(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){l=n({},c)},e.setDefaults=function(e){l=n(n({},c),e)},e.setDoc=function(e){for(var t in u)u[t].remove();u={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},l),e),r=new d(t),i=function(e,t,n,r,i,o){if(u.position)return u.position;var s=a().createElement("div");return s.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,o)),e.appendChild(s),u.position=s,s}(t.appendTo||a().body,t.position||l.position,t.offsetTop||l.offsetTop,t.offsetBottom||l.offsetBottom,t.offsetLeft||l.offsetLeft,t.offsetRight||l.offsetRight);if(t.single)for(var o=i.lastElementChild;o;)i.removeChild(o),o=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},SeVD:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n("ngJS"),i=n("NJ4a"),o=n("Lhse"),s=n("kJWO"),a=n("I55L"),c=n("c2HN"),l=n("XoHu");const u=e=>{if(e&&"function"==typeof e[s.a])return u=e,e=>{const t=u[s.a]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Object(a.a)(e))return Object(r.a)(e);if(Object(c.a)(e))return n=e,e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,i.a),e);if(e&&"function"==typeof e[o.a])return t=e,e=>{const n=t[o.a]();for(;;){let t;try{t=n.next()}catch(r){return e.error(r),e}if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e};{const t=Object(l.a)(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var t,n,u}},SpAZ:function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",function(){return r})},VRyK:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("HDdC"),i=n("z+Ro"),o=n("bHdf"),s=n("yCtX");function a(...e){let t=Number.POSITIVE_INFINITY,n=null,a=e[e.length-1];return Object(i.a)(a)?(n=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof a&&(t=e.pop()),null===n&&1===e.length&&e[0]instanceof r.a?e[0]:Object(o.a)(t)(Object(s.a)(e,n))}},XNiG:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u});var r=n("HDdC"),i=n("7o/Q"),o=n("quSY"),s=n("9ppp"),a=n("Ylt2"),c=n("2QA8");class l extends i.a{constructor(e){super(e),this.destination=e}}let u=(()=>{class e extends r.a{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[c.a](){return new l(this)}lift(e){const t=new h(this,this);return t.operator=e,t}next(e){if(this.closed)throw new s.a;if(!this.isStopped){const{observers:t}=this,n=t.length,r=t.slice();for(let i=0;i<n;i++)r[i].next(e)}}error(e){if(this.closed)throw new s.a;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,n=t.length,r=t.slice();for(let i=0;i<n;i++)r[i].error(e);this.observers.length=0}complete(){if(this.closed)throw new s.a;this.isStopped=!0;const{observers:e}=this,t=e.length,n=e.slice();for(let r=0;r<t;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new s.a;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new s.a;return this.hasError?(e.error(this.thrownError),o.a.EMPTY):this.isStopped?(e.complete(),o.a.EMPTY):(this.observers.push(e),new a.a(this,e))}asObservable(){const e=new r.a;return e.source=this,e}}return e.create=(e,t)=>new h(e,t),e})();class h extends u{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):o.a.EMPTY}}},XoHu:function(e,t,n){"use strict";function r(e){return null!==e&&"object"==typeof e}n.d(t,"a",function(){return r})},Ylt2:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("quSY");class i extends r.a{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},bHdf:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("5+tZ"),i=n("SpAZ");function o(e=Number.POSITIVE_INFINITY){return Object(r.a)(i.a,e)}},c2HN:function(e,t,n){"use strict";function r(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}n.d(t,"a",function(){return r})},fXoL:function(e,t,n){"use strict";n.d(t,"a",function(){return sn}),n.d(t,"b",function(){return Zl}),n.d(t,"c",function(){return Hl}),n.d(t,"d",function(){return Vl}),n.d(t,"e",function(){return zl}),n.d(t,"f",function(){return Vu}),n.d(t,"g",function(){return Nu}),n.d(t,"h",function(){return Mc}),n.d(t,"i",function(){return ou}),n.d(t,"j",function(){return nc}),n.d(t,"k",function(){return Kl}),n.d(t,"l",function(){return sc}),n.d(t,"m",function(){return Or}),n.d(t,"n",function(){return _l}),n.d(t,"o",function(){return Oo}),n.d(t,"p",function(){return Sn}),n.d(t,"q",function(){return k}),n.d(t,"r",function(){return on}),n.d(t,"s",function(){return Uo}),n.d(t,"t",function(){return Sc}),n.d(t,"u",function(){return Ic}),n.d(t,"v",function(){return Yl}),n.d(t,"w",function(){return Hc}),n.d(t,"x",function(){return xu}),n.d(t,"y",function(){return zc}),n.d(t,"z",function(){return Pu}),n.d(t,"A",function(){return cu}),n.d(t,"B",function(){return Pn}),n.d(t,"C",function(){return Wl}),n.d(t,"D",function(){return ql}),n.d(t,"E",function(){return lc}),n.d(t,"F",function(){return cc}),n.d(t,"G",function(){return kr}),n.d(t,"H",function(){return hc}),n.d(t,"I",function(){return yr}),n.d(t,"J",function(){return In}),n.d(t,"K",function(){return Lu}),n.d(t,"L",function(){return Fc}),n.d(t,"M",function(){return gu}),n.d(t,"N",function(){return an}),n.d(t,"O",function(){return fc}),n.d(t,"P",function(){return dc}),n.d(t,"Q",function(){return $c}),n.d(t,"R",function(){return L}),n.d(t,"S",function(){return Iu}),n.d(t,"T",function(){return Ou}),n.d(t,"U",function(){return f}),n.d(t,"V",function(){return Eu}),n.d(t,"W",function(){return ju}),n.d(t,"X",function(){return vu}),n.d(t,"Y",function(){return Ql}),n.d(t,"Z",function(){return Po}),n.d(t,"ab",function(){return Ks}),n.d(t,"bb",function(){return m}),n.d(t,"cb",function(){return gr}),n.d(t,"db",function(){return Kn}),n.d(t,"eb",function(){return jn}),n.d(t,"fb",function(){return Vn}),n.d(t,"gb",function(){return $n}),n.d(t,"hb",function(){return Hn}),n.d(t,"ib",function(){return zn}),n.d(t,"jb",function(){return Gn}),n.d(t,"kb",function(){return Ws}),n.d(t,"lb",function(){return Fu}),n.d(t,"mb",function(){return Zs}),n.d(t,"nb",function(){return Qs}),n.d(t,"ob",function(){return Un}),n.d(t,"pb",function(){return V}),n.d(t,"qb",function(){return Yo}),n.d(t,"rb",function(){return bs}),n.d(t,"sb",function(){return ys}),n.d(t,"tb",function(){return vs}),n.d(t,"ub",function(){return qs}),n.d(t,"vb",function(){return Oe}),n.d(t,"wb",function(){return u}),n.d(t,"xb",function(){return Fn}),n.d(t,"yb",function(){return zo}),n.d(t,"zb",function(){return ve}),n.d(t,"Ab",function(){return Xa}),n.d(t,"Bb",function(){return Si}),n.d(t,"Cb",function(){return ns}),n.d(t,"Db",function(){return Ms}),n.d(t,"Eb",function(){return Rl}),n.d(t,"Fb",function(){return X}),n.d(t,"Gb",function(){return se}),n.d(t,"Hb",function(){return w}),n.d(t,"Ib",function(){return C}),n.d(t,"Jb",function(){return re}),n.d(t,"Kb",function(){return ae}),n.d(t,"Lb",function(){return cs}),n.d(t,"Mb",function(){return fs}),n.d(t,"Nb",function(){return gs}),n.d(t,"Ob",function(){return ps}),n.d(t,"Pb",function(){return ds}),n.d(t,"Qb",function(){return hs}),n.d(t,"Rb",function(){return ms}),n.d(t,"Sb",function(){return en}),n.d(t,"Tb",function(){return zs}),n.d(t,"Ub",function(){return Ha}),n.d(t,"Vb",function(){return $a}),n.d(t,"Wb",function(){return za}),n.d(t,"Xb",function(){return Ga}),n.d(t,"Yb",function(){return Va}),n.d(t,"Zb",function(){return Cn}),n.d(t,"ac",function(){return nn}),n.d(t,"bc",function(){return Ul}),n.d(t,"cc",function(){return _s}),n.d(t,"dc",function(){return Dl}),n.d(t,"ec",function(){return bt}),n.d(t,"fc",function(){return Es}),n.d(t,"gc",function(){return fl}),n.d(t,"hc",function(){return pl}),n.d(t,"ic",function(){return gl}),n.d(t,"jc",function(){return ml}),n.d(t,"kc",function(){return Ps}),n.d(t,"lc",function(){return Ss}),n.d(t,"mc",function(){return ls}),n.d(t,"nc",function(){return Is}),n.d(t,"oc",function(){return Ts}),n.d(t,"pc",function(){return As}),n.d(t,"qc",function(){return sl}),n.d(t,"rc",function(){return al}),n.d(t,"sc",function(){return cl}),n.d(t,"tc",function(){return ll}),n.d(t,"uc",function(){return Ml}),n.d(t,"vc",function(){return as}),n.d(t,"wc",function(){return Ge}),n.d(t,"xc",function(){return vr}),n.d(t,"yc",function(){return br}),n.d(t,"zc",function(){return ie}),n.d(t,"Ac",function(){return ss}),n.d(t,"Bc",function(){return jl}),n.d(t,"Cc",function(){return Bs}),n.d(t,"Dc",function(){return Fs}),n.d(t,"Ec",function(){return js}),n.d(t,"Fc",function(){return Us}),n.d(t,"Gc",function(){return Vs}),n.d(t,"Hc",function(){return xl});var r=n("XNiG"),i=n("quSY"),o=n("HDdC"),s=n("VRyK"),a=n("w1tV");function c(e){for(let t in e)if(e[t]===c)return t;throw Error("Could not find renamed property on target object.")}function l(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function u(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(u).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function h(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const d=c({__forward_ref__:c});function f(e){return e.__forward_ref__=f,e.toString=function(){return u(this())},e}function p(e){return g(e)?e():e}function g(e){return"function"==typeof e&&e.hasOwnProperty(d)&&e.__forward_ref__===f}class m extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function y(e){return"string"==typeof e?e:null==e?"":String(e)}function v(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():y(e)}function b(e,t){const n=t?` in ${t}`:"";throw new m("201",`No provider for ${v(e)} found${n}`)}function _(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}function w(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function C(e){return{providers:e.providers||[],imports:e.imports||[]}}function E(e){return O(e,P)||O(e,T)}function O(e,t){return e.hasOwnProperty(t)?e[t]:null}function S(e){return e&&(e.hasOwnProperty(I)||e.hasOwnProperty(A))?e[I]:null}const P=c({"\u0275prov":c}),I=c({"\u0275inj":c}),T=c({ngInjectableDef:c}),A=c({ngInjectorDef:c});var k=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});let N;function M(e){const t=N;return N=e,t}function x(e,t,n){const r=E(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&k.Optional?null:void 0!==t?t:void b(u(e),"Injector")}function R(e){return{toString:e}.toString()}var D=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}({}),L=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}({});const B="undefined"!=typeof globalThis&&globalThis,F="undefined"!=typeof window&&window,j="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,U="undefined"!=typeof global&&global,V=B||U||F||j,z={},H=[],G=[],$=c({"\u0275cmp":c}),q=c({"\u0275dir":c}),W=c({"\u0275pipe":c}),Z=c({"\u0275mod":c}),Q=c({"\u0275loc":c}),Y=c({"\u0275fac":c}),K=c({__NG_ELEMENT_ID__:c});let J=0;function X(e){return R(()=>{const t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===D.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||G,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||L.Emulated,id:"c",styles:e.styles||G,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,o=e.pipes;return n.id+=J++,n.inputs=oe(e.inputs,t),n.outputs=oe(e.outputs),i&&i.forEach(e=>e(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(ee):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(te):null,n})}function ee(e){return ce(e)||function(e){return e[q]||null}(e)}function te(e){return function(e){return e[W]||null}(e)}const ne={};function re(e){const t={type:e.type,bootstrap:e.bootstrap||G,declarations:e.declarations||G,imports:e.imports||G,exports:e.exports||G,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&R(()=>{ne[e.id]=e.type}),t}function ie(e,t){return R(()=>{const n=le(e,!0);n.declarations=t.declarations||G,n.imports=t.imports||G,n.exports=t.exports||G})}function oe(e,t){if(null==e)return z;const n={};for(const r in e)if(e.hasOwnProperty(r)){let i=e[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,t&&(t[i]=o)}return n}const se=X;function ae(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function ce(e){return e[$]||null}function le(e,t){const n=e[Z]||null;if(!n&&!0===t)throw new Error(`Type ${u(e)} does not have '\u0275mod' property.`);return n}function ue(e){return Array.isArray(e)&&"object"==typeof e[1]}function he(e){return Array.isArray(e)&&!0===e[1]}function de(e){return 0!=(8&e.flags)}function fe(e){return 2==(2&e.flags)}function pe(e){return 1==(1&e.flags)}function ge(e){return null!==e.template}function me(e,t){return e.hasOwnProperty(Y)?e[Y]:null}class ye{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function ve(){return be}function be(e){return e.type.prototype.ngOnChanges&&(e.setInput=we),_e}function _e(){const e=Ce(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===z)e.previous=t;else for(let e in t)n[e]=t[e];e.current=null,this.ngOnChanges(t)}}function we(e,t,n,r){const i=Ce(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:z,current:null}),o=i.current||(i.current={}),s=i.previous,a=this.declaredInputs[n],c=s[a];o[a]=new ye(c&&c.currentValue,t,s===z),e[r]=t}function Ce(e){return e.__ngSimpleChanges__||null}let Ee;function Oe(e){Ee=e}function Se(){return void 0!==Ee?Ee:"undefined"!=typeof document?document:void 0}function Pe(e){return!!e.listen}ve.ngInherit=!0;const Ie={createRenderer:(e,t)=>Se()};function Te(e){for(;Array.isArray(e);)e=e[0];return e}function Ae(e,t){return Te(t[e])}function ke(e,t){return Te(t[e.index])}function Ne(e,t){return e.data[t]}function Me(e,t){return e[t]}function xe(e,t){const n=t[e];return ue(n)?n:n[0]}function Re(e){const t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function De(e){return 4==(4&e[2])}function Le(e){return 128==(128&e[2])}function Be(e,t){return null==t?null:e[t]}function Fe(e){e[18]=0}function je(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const Ue={lFrame:dt(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ve(){return Ue.bindingsEnabled}function ze(){return Ue.lFrame.lView}function He(){return Ue.lFrame.tView}function Ge(e){Ue.lFrame.contextLView=e}function $e(){let e=qe();for(;null!==e&&64===e.type;)e=e.parent;return e}function qe(){return Ue.lFrame.currentTNode}function We(){const e=Ue.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Ze(e,t){const n=Ue.lFrame;n.currentTNode=e,n.isParent=t}function Qe(){return Ue.lFrame.isParent}function Ye(){Ue.lFrame.isParent=!1}function Ke(){return Ue.isInCheckNoChangesMode}function Je(e){Ue.isInCheckNoChangesMode=e}function Xe(){const e=Ue.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function et(){return Ue.lFrame.bindingIndex}function tt(){return Ue.lFrame.bindingIndex++}function nt(e){const t=Ue.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function rt(e){Ue.lFrame.inI18n=e}function it(e,t){const n=Ue.lFrame;n.bindingIndex=n.bindingRootIndex=e,ot(t)}function ot(e){Ue.lFrame.currentDirectiveIndex=e}function st(){return Ue.lFrame.currentQueryIndex}function at(e){Ue.lFrame.currentQueryIndex=e}function ct(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function lt(e,t,n){if(n&k.SkipSelf){let r=t,i=e;for(;r=r.parent,!(null!==r||n&k.Host||(r=ct(i),null===r)||(i=i[15],10&r.type)););if(null===r)return!1;t=r,e=i}const r=Ue.lFrame=ht();return r.currentTNode=t,r.lView=e,!0}function ut(e){const t=ht(),n=e[1];Ue.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function ht(){const e=Ue.lFrame,t=null===e?null:e.child;return null===t?dt(e):t}function dt(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function ft(){const e=Ue.lFrame;return Ue.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const pt=ft;function gt(){const e=ft();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function mt(){return Ue.lFrame.selectedIndex}function yt(e){Ue.lFrame.selectedIndex=e}function vt(){const e=Ue.lFrame;return Ne(e.tView,e.selectedIndex)}function bt(){Ue.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function _t(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const t=e.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:o,ngAfterViewChecked:s,ngOnDestroy:a}=t;r&&(e.contentHooks||(e.contentHooks=[])).push(-n,r),i&&((e.contentHooks||(e.contentHooks=[])).push(n,i),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,i)),o&&(e.viewHooks||(e.viewHooks=[])).push(-n,o),s&&((e.viewHooks||(e.viewHooks=[])).push(n,s),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,s)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(n,a)}}function wt(e,t,n){Ot(e,t,3,n)}function Ct(e,t,n,r){(3&e[2])===n&&Ot(e,t,n,r)}function Et(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function Ot(e,t,n,r){const i=null!=r?r:-1,o=t.length-1;let s=0;for(let a=void 0!==r?65535&e[18]:0;a<o;a++)if("number"==typeof t[a+1]){if(s=t[a],null!=r&&s>=r)break}else t[a]<0&&(e[18]+=65536),(s<i||-1==i)&&(St(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function St(e,t,n,r){const i=n[r]<0,o=n[r+1],s=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{o.call(s)}finally{}}}else try{o.call(s)}finally{}}class Pt{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function It(e,t,n){const r=Pe(e);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const s=n[i++],a=n[i++],c=n[i++];r?e.setAttribute(t,a,c,s):t.setAttributeNS(s,a,c)}else{const s=o,a=n[++i];At(s)?r&&e.setProperty(t,s,a):r?e.setAttribute(t,s,a):t.setAttribute(s,a),i++}}return i}function Tt(e){return 3===e||4===e||6===e}function At(e){return 64===e.charCodeAt(0)}function kt(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?n=i:0===n||Nt(e,n,i,null,-1===n||2===n?t[++r]:null)}}return e}function Nt(e,t,n,r,i){let o=0,s=e.length;if(-1===t)s=-1;else for(;o<e.length;){const n=e[o++];if("number"==typeof n){if(n===t){s=-1;break}if(n>t){s=o-1;break}}}for(;o<e.length;){const t=e[o];if("number"==typeof t)break;if(t===n){if(null===r)return void(null!==i&&(e[o+1]=i));if(r===e[o+1])return void(e[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(e.splice(s,0,t),o=s+1),e.splice(o++,0,n),null!==r&&e.splice(o++,0,r),null!==i&&e.splice(o++,0,i)}function Mt(e){return-1!==e}function xt(e){return 32767&e}function Rt(e,t){let n=e>>16,r=t;for(;n>0;)r=r[15],n--;return r}let Dt=!0;function Lt(e){const t=Dt;return Dt=e,t}let Bt=0;function Ft(e,t){const n=Ut(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,jt(r.data,e),jt(t,null),jt(r.blueprint,null));const i=Vt(e,t),o=e.injectorIndex;if(Mt(i)){const e=xt(i),n=Rt(i,t),r=n[1].data;for(let i=0;i<8;i++)t[o+i]=n[e+i]|r[e+i]}return t[o+8]=i,o}function jt(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Ut(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Vt(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,i=t;for(;null!==i;){const e=i[1],t=e.type;if(r=2===t?e.declTNode:1===t?i[6]:null,null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function zt(e,t,n){!function(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(K)&&(r=n[K]),null==r&&(r=n[K]=Bt++);const i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function Ht(e,t,n){if(n&k.Optional)return e;b(t,"NodeInjector")}function Gt(e,t,n,r){if(n&k.Optional&&void 0===r&&(r=null),0==(n&(k.Self|k.Host))){const i=e[9],o=M(void 0);try{return i?i.get(t,r,n&k.Optional):x(t,r,n&k.Optional)}finally{M(o)}}return Ht(r,t,n)}function $t(e,t,n,r=k.Default,i){if(null!==e){const o=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(K)?e[K]:void 0;return"number"==typeof t?t>=0?255&t:Wt:t}(n);if("function"==typeof o){if(!lt(t,e,r))return r&k.Host?Ht(i,n,r):Gt(t,n,r,i);try{const e=o();if(null!=e||r&k.Optional)return e;b(n)}finally{pt()}}else if("number"==typeof o){let i=null,s=Ut(e,t),a=-1,c=r&k.Host?t[16][6]:null;for((-1===s||r&k.SkipSelf)&&(a=-1===s?Vt(e,t):t[s+8],-1!==a&&Jt(r,!1)?(i=t[1],s=xt(a),t=Rt(a,t)):s=-1);-1!==s;){const e=t[1];if(Kt(o,s,e.data)){const e=Zt(s,t,n,i,r,c);if(e!==qt)return e}a=t[s+8],-1!==a&&Jt(r,t[1].data[s+8]===c)&&Kt(o,s,t)?(i=e,s=xt(a),t=Rt(a,t)):s=-1}}}return Gt(t,n,r,i)}const qt={};function Wt(){return new Xt($e(),ze())}function Zt(e,t,n,r,i,o){const s=t[1],a=s.data[e+8],c=Qt(a,s,n,null==r?fe(a)&&Dt:r!=s&&0!=(3&a.type),i&k.Host&&o===a);return null!==c?Yt(t,s,c,a):qt}function Qt(e,t,n,r,i){const o=e.providerIndexes,s=t.data,a=1048575&o,c=e.directiveStart,l=o>>20,u=i?a+l:e.directiveEnd;for(let h=r?a:a+l;h<u;h++){const e=s[h];if(h<c&&n===e||h>=c&&e.type===n)return h}if(i){const e=s[c];if(e&&ge(e)&&e.type===n)return c}return null}function Yt(e,t,n,r){let i=e[n];const o=t.data;if(i instanceof Pt){const s=i;s.resolving&&function(e,t){throw new m("200",`Circular dependency in DI detected for ${e}`)}(v(o[n]));const a=Lt(s.canSeeViewProviders);s.resolving=!0;const c=s.injectImpl?M(s.injectImpl):null;lt(e,r,k.Default);try{i=e[n]=s.factory(void 0,o,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=t.type.prototype;if(r){const r=be(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,o[n],t)}finally{null!==c&&M(c),Lt(a),s.resolving=!1,pt()}}return i}function Kt(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Jt(e,t){return!(e&k.Self||e&k.Host&&t)}class Xt{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return $t(this._tNode,this._lView,e,void 0,t)}}function en(e){return R(()=>{const t=e.prototype.constructor,n=t[Y]||tn(t),r=Object.prototype;let i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){const e=i[Y]||tn(i);if(e&&e!==n)return e;i=Object.getPrototypeOf(i)}return e=>new e})}function tn(e){return g(e)?()=>{const t=tn(p(e));return t&&t()}:me(e)}function nn(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const e=n.length;let r=0;for(;r<e;){const i=n[r];if(Tt(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<e&&"string"==typeof n[r];)r++;else{if(i===t)return n[r+1];r+=2}}}return null}($e(),e)}function rn(e,t,n){return R(()=>{const r=function(e){return function(...t){if(e){const n=e(...t);for(const e in n)this[e]=n[e]}}}(t);function i(...e){if(this instanceof i)return r.apply(this,e),this;const t=new i(...e);return n.annotation=t,n;function n(e,n,r){const i=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(t),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}class on{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=w({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const sn=new on("AnalyzeForEntryComponents"),an=Function;function cn(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),cn(r,t)):t!==e&&t.push(r)}return t}function ln(e,t){e.forEach(e=>Array.isArray(e)?ln(e,t):t(e))}function un(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function hn(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function dn(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function fn(e,t,n){let r=gn(e,t);return r>=0?e[1|r]=n:(r=~r,function(e,t,n,r){let i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function pn(e,t){const n=gn(e,t);if(n>=0)return e[1|n]}function gn(e,t){return function(e,t,n){let r=0,i=e.length>>1;for(;i!==r;){const n=r+(i-r>>1),o=e[n<<1];if(t===o)return n<<1;o>t?i=n:r=n+1}return~(i<<1)}(e,t)}const mn={},yn=/\n/gm,vn=c({provide:String,useValue:c});let bn;function _n(e){const t=bn;return bn=e,t}function wn(e,t=k.Default){if(void 0===bn)throw new Error("inject() must be called from an injection context");return null===bn?x(e,void 0,t):bn.get(e,t&k.Optional?null:void 0,t)}function Cn(e,t=k.Default){return(N||wn)(p(e),t)}function En(e){const t=[];for(let n=0;n<e.length;n++){const r=p(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let e,n=k.Default;for(let t=0;t<r.length;t++){const i=r[t],o=i.__NG_DI_FLAG__;"number"==typeof o?-1===o?e=i.token:n|=o:e=i}t.push(Cn(e,n))}else t.push(Cn(r))}return t}function On(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}const Sn=On(rn("Inject",e=>({token:e})),-1),Pn=On(rn("Optional"),8),In=On(rn("SkipSelf"),4);let Tn,An;function kn(e){var t;return(null===(t=function(){if(void 0===Tn&&(Tn=null,V.trustedTypes))try{Tn=V.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(t){}return Tn}())||void 0===t?void 0:t.createHTML(e))||e}function Nn(e){var t;return(null===(t=function(){if(void 0===An&&(An=null,V.trustedTypes))try{An=V.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(t){}return An}())||void 0===t?void 0:t.createHTML(e))||e}class Mn{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class xn extends Mn{getTypeName(){return"HTML"}}class Rn extends Mn{getTypeName(){return"Style"}}class Dn extends Mn{getTypeName(){return"Script"}}class Ln extends Mn{getTypeName(){return"URL"}}class Bn extends Mn{getTypeName(){return"ResourceURL"}}function Fn(e){return e instanceof Mn?e.changingThisBreaksApplicationSecurity:e}function jn(e,t){const n=Un(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}function Un(e){return e instanceof Mn&&e.getTypeName()||null}function Vn(e){return new xn(e)}function zn(e){return new Rn(e)}function Hn(e){return new Dn(e)}function Gn(e){return new Ln(e)}function $n(e){return new Bn(e)}function qn(e){const t=new Zn(e);return function(){try{return!!(new window.DOMParser).parseFromString(kn(""),"text/html")}catch(e){return!1}}()?new Wn(t):t}class Wn{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(kn(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class Zn{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const t=this.inertDocument.createElement("body");e.appendChild(t)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=kn(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=kn(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const n=t.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||e.removeAttribute(n)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Qn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Yn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Kn(e){return(e=String(e)).match(Qn)||e.match(Yn)?e:"unsafe:"+e}function Jn(e){return(e=String(e)).split(",").map(e=>Kn(e.trim())).join(", ")}function Xn(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function er(...e){const t={};for(const n of e)for(const e in n)n.hasOwnProperty(e)&&(t[e]=!0);return t}const tr=Xn("area,br,col,hr,img,wbr"),nr=Xn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),rr=Xn("rp,rt"),ir=er(rr,nr),or=er(tr,er(nr,Xn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),er(rr,Xn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ir),sr=Xn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ar=Xn("srcset"),cr=er(sr,ar,Xn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Xn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),lr=Xn("script,style,template");class ur{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!or.hasOwnProperty(t))return this.sanitizedSomething=!0,!lr.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const e=n.item(r),t=e.name,i=t.toLowerCase();if(!cr.hasOwnProperty(i)){this.sanitizedSomething=!0;continue}let o=e.value;sr[i]&&(o=Kn(o)),ar[i]&&(o=Jn(o)),this.buf.push(" ",t,'="',fr(o),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();or.hasOwnProperty(t)&&!tr.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(fr(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const hr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,dr=/([^\#-~ |!])/g;function fr(e){return e.replace(/&/g,"&amp;").replace(hr,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(dr,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let pr;function gr(e,t){let n=null;try{pr=pr||qn(e);let r=t?String(t):"";n=pr.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=pr.getInertBodyElement(r)}while(r!==o);return kn((new ur).sanitizeChildren(mr(n)||n))}finally{if(n){const e=mr(n)||n;for(;e.firstChild;)e.removeChild(e.firstChild)}}}function mr(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var yr=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}({});function vr(e){const t=_r();return t?Nn(t.sanitize(yr.HTML,e)||""):jn(e,"HTML")?Nn(Fn(e)):gr(Se(),y(e))}function br(e){const t=_r();return t?t.sanitize(yr.URL,e)||"":jn(e,"URL")?Fn(e):Kn(y(e))}function _r(){const e=ze();return e&&e[12]}function wr(e){return e.ngDebugContext}function Cr(e){return e.ngOriginalError}function Er(e,...t){e.error(...t)}class Or{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||Er}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(e){return e?wr(e)?wr(e):this._findContext(Cr(e)):null}_findOriginalError(e){let t=Cr(e);for(;t&&Cr(t);)t=Cr(t);return t}}const Sr=/^>|^->|<!--|-->|--!>|<!-$/g,Pr=/(<|>)/;function Ir(e,t){e.__ngContext__=t}const Tr=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(V))();function Ar(e){return e instanceof Function?e():e}var kr=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}({});let Nr;function Mr(e,t){return Nr(e,t)}function xr(e){const t=e[3];return he(t)?t[3]:t}function Rr(e){return Lr(e[13])}function Dr(e){return Lr(e[4])}function Lr(e){for(;null!==e&&!he(e);)e=e[4];return e}function Br(e,t,n,r,i){if(null!=r){let o,s=!1;he(r)?o=r:ue(r)&&(s=!0,r=r[0]);const a=Te(r);0===e&&null!==n?null==i?Qr(t,n,a):Zr(t,n,a,i||null,!0):1===e&&null!==n?Zr(t,n,a,i||null,!0):2===e?ai(t,a,s):3===e&&t.destroyNode(a),null!=o&&function(e,t,n,r,i){const o=n[7];o!==Te(n)&&Br(t,e,r,o,i);for(let s=10;s<n.length;s++){const i=n[s];li(i[1],i,e,t,r,o)}}(t,e,o,n,i)}}function Fr(e,t){return Pe(e)?e.createText(t):e.createTextNode(t)}function jr(e,t,n){Pe(e)?e.setValue(t,n):t.textContent=n}function Ur(e,t){return e.createComment(function(e){return e.replace(Sr,e=>e.replace(Pr,"\u200b$1\u200b"))}(t))}function Vr(e,t,n){return Pe(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function zr(e,t){const n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,je(i,-1)),n.splice(r,1)}function Hr(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const o=r[17];null!==o&&o!==e&&zr(o,r),t>0&&(e[n-1][4]=r[4]);const s=hn(e,10+t);li(r[1],i=r,i[11],2,null,null),i[0]=null,i[6]=null;const a=s[19];null!==a&&a.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}var i;return r}function Gr(e,t){if(!(256&t[2])){const n=t[11];Pe(n)&&n.destroyNode&&li(e,t,n,3,null,null),function(e){let t=e[13];if(!t)return $r(e[1],e);for(;t;){let n=null;if(ue(t))n=t[13];else{const e=t[10];e&&(n=e)}if(!n){for(;t&&!t[4]&&t!==e;)ue(t)&&$r(t[1],t),t=t[3];null===t&&(t=e),ue(t)&&$r(t[1],t),n=t&&t[4]}t=n}}(t)}}function $r(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const e=t[n[r]];if(!(e instanceof Pt)){const t=n[r+1];if(Array.isArray(t))for(let n=0;n<t.length;n+=2){const r=e[t[n]],i=t[n+1];try{i.call(r)}finally{}}else try{t.call(e)}finally{}}}}(e,t),function(e,t){const n=e.cleanup,r=t[7];let i=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const e=n[o+1],s="function"==typeof e?e(t):Te(t[e]),a=r[i=n[o+2]],c=n[o+3];"boolean"==typeof c?s.removeEventListener(n[o],a,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),o+=2}else{const e=r[i=n[o+1]];n[o].call(e)}if(null!==r){for(let e=i+1;e<r.length;e++)(0,r[e])();t[7]=null}}(e,t),1===t[1].type&&Pe(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&he(t[3])){n!==t[3]&&zr(n,t);const r=t[19];null!==r&&r.detachView(e)}}}function qr(e,t,n){return Wr(e,t.parent,n)}function Wr(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const t=e.data[r.directiveStart].encapsulation;if(t===L.None||t===L.Emulated)return null}return ke(r,n)}function Zr(e,t,n,r,i){Pe(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function Qr(e,t,n){Pe(e)?e.appendChild(t,n):t.appendChild(n)}function Yr(e,t,n,r,i){null!==r?Zr(e,t,n,r,i):Qr(e,t,n)}function Kr(e,t){return Pe(e)?e.parentNode(t):t.parentNode}function Jr(e,t,n){return ti(e,t,n)}function Xr(e,t,n){return 40&e.type?ke(e,n):null}let ei,ti=Xr;function ni(e,t){ti=e,ei=t}function ri(e,t,n,r){const i=qr(e,r,t),o=t[11],s=Jr(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)Yr(o,i,n[a],s,!1);else Yr(o,i,n,s,!1);void 0!==ei&&ei(o,r,t,n,i)}function ii(e,t){if(null!==t){const n=t.type;if(3&n)return ke(t,e);if(4&n)return si(-1,e[t.index]);if(8&n){const n=t.child;if(null!==n)return ii(e,n);{const n=e[t.index];return he(n)?si(-1,n):Te(n)}}if(32&n)return Mr(t,e)()||Te(e[t.index]);{const n=oi(e,t);return null!==n?Array.isArray(n)?n[0]:ii(xr(e[16]),n):ii(e,t.next)}}return null}function oi(e,t){return null!==t?e[16][6].projection[t.projection]:null}function si(e,t){const n=10+e+1;if(n<t.length){const e=t[n],r=e[1].firstChild;if(null!==r)return ii(e,r)}return t[7]}function ai(e,t,n){const r=Kr(e,t);r&&function(e,t,n,r){Pe(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function ci(e,t,n,r,i,o,s){for(;null!=n;){const a=r[n.index],c=n.type;if(s&&0===t&&(a&&Ir(Te(a),r),n.flags|=4),64!=(64&n.flags))if(8&c)ci(e,t,n.child,r,i,o,!1),Br(t,e,i,a,o);else if(32&c){const s=Mr(n,r);let c;for(;c=s();)Br(t,e,i,c,o);Br(t,e,i,a,o)}else 16&c?ui(e,t,r,n,i,o):Br(t,e,i,a,o);n=s?n.projectionNext:n.next}}function li(e,t,n,r,i,o){ci(n,r,e.firstChild,t,i,o,!1)}function ui(e,t,n,r,i,o){const s=n[16],a=s[6].projection[r.projection];if(Array.isArray(a))for(let c=0;c<a.length;c++)Br(t,e,i,a[c],o);else ci(e,t,a,s[3],i,o,!0)}function hi(e,t,n){Pe(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function di(e,t,n){Pe(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function fi(e,t,n){let r=e.length;for(;;){const i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){const n=t.length;if(i+n===r||e.charCodeAt(i+n)<=32)return i}n=i+1}}function pi(e,t,n){let r=0;for(;r<e.length;){let i=e[r++];if(n&&"class"===i){if(i=e[r],-1!==fi(i.toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function gi(e){return 4===e.type&&"ng-template"!==e.value}function mi(e,t,n){return t===(4!==e.type||n?e.value:"ng-template")}function yi(e,t,n){let r=4;const i=e.attrs||[],o=function(e){for(let t=0;t<e.length;t++)if(Tt(e[t]))return t;return e.length}(i);let s=!1;for(let a=0;a<t.length;a++){const c=t[a];if("number"!=typeof c){if(!s)if(4&r){if(r=2|1&r,""!==c&&!mi(e,c,n)||""===c&&1===t.length){if(vi(r))return!1;s=!0}}else{const l=8&r?c:t[++a];if(8&r&&null!==e.attrs){if(!pi(e.attrs,l,n)){if(vi(r))return!1;s=!0}continue}const u=bi(8&r?"class":c,i,gi(e),n);if(-1===u){if(vi(r))return!1;s=!0;continue}if(""!==l){let e;e=u>o?"":i[u+1].toLowerCase();const t=8&r?e:null;if(t&&-1!==fi(t,l,0)||2&r&&l!==e){if(vi(r))return!1;s=!0}}}}else{if(!s&&!vi(r)&&!vi(c))return!1;if(s&&vi(c))continue;s=!1,r=c|1&r}}return vi(r)||s}function vi(e){return 0==(1&e)}function bi(e,t,n,r){if(null===t)return-1;let i=0;if(r||!n){let n=!1;for(;i<t.length;){const r=t[i];if(r===e)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let e=t[++i];for(;"string"==typeof e;)e=t[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function _i(e,t,n=!1){for(let r=0;r<t.length;r++)if(yi(e,t[r],n))return!0;return!1}function wi(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let t=0;t<e.length;t++)if(e[t]!==r[t])continue e;return!0}}return!1}function Ci(e,t){return e?":not("+t.trim()+")":t}function Ei(e){let t=e[0],n=1,r=2,i="",o=!1;for(;n<e.length;){let s=e[n];if("string"==typeof s)if(2&r){const t=e[++n];i+="["+s+(t.length>0?'="'+t+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""===i||vi(s)||(t+=Ci(o,i),i=""),r=s,o=o||!vi(r);n++}return""!==i&&(t+=Ci(o,i)),t}const Oi={};function Si(e){Pi(He(),ze(),mt()+e,Ke())}function Pi(e,t,n,r){if(!r)if(3==(3&t[2])){const r=e.preOrderCheckHooks;null!==r&&wt(t,r,n)}else{const r=e.preOrderHooks;null!==r&&Ct(t,r,0,n)}yt(n)}function Ii(e,t){return e<<17|t<<2}function Ti(e){return e>>17&32767}function Ai(e){return 2|e}function ki(e){return(131068&e)>>2}function Ni(e,t){return-131069&e|t<<2}function Mi(e){return 1|e}function xi(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const n=e.data[o];at(i),n.contentQueries(2,t[o],o)}}}function Ri(e,t,n,r,i,o,s,a,c,l){const u=t.blueprint.slice();return u[0]=i,u[2]=140|r,Fe(u),u[3]=u[15]=e,u[8]=n,u[10]=s||e&&e[10],u[11]=a||e&&e[11],u[12]=c||e&&e[12]||null,u[9]=l||e&&e[9]||null,u[6]=o,u[16]=2==t.type?e[16]:u,u}function Di(e,t,n,r,i){let o=e.data[t];if(null===o)o=Li(e,t,n,r,i),Ue.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const e=We();o.injectorIndex=null===e?-1:e.injectorIndex}return Ze(o,!0),o}function Li(e,t,n,r,i){const o=qe(),s=Qe(),a=e.data[t]=function(e,t,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=a),null!==o&&(s?null==o.child&&null!==a.parent&&(o.child=a):null===o.next&&(o.next=a)),a}function Bi(e,t,n,r){if(0===n)return-1;const i=t.length;for(let o=0;o<n;o++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Fi(e,t,n){ut(t);try{const r=e.viewQuery;null!==r&&mo(1,r,n);const i=e.template;null!==i&&Vi(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&xi(e,t),e.staticViewQueries&&mo(2,e.viewQuery,n);const o=e.components;null!==o&&function(e,t){for(let n=0;n<t.length;n++)uo(e,t[n])}(t,o)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),r}finally{t[2]&=-5,gt()}}function ji(e,t,n,r){const i=t[2];if(256==(256&i))return;ut(t);const o=Ke();try{Fe(t),Ue.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&Vi(e,t,n,2,r);const s=3==(3&i);if(!o)if(s){const n=e.preOrderCheckHooks;null!==n&&wt(t,n,null)}else{const n=e.preOrderHooks;null!==n&&Ct(t,n,0,null),Et(t,0)}if(function(e){for(let t=Rr(e);null!==t;t=Dr(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const n=e[t],r=n[3];0==(1024&n[2])&&je(r,1),n[2]|=1024}}}(t),function(e){for(let t=Rr(e);null!==t;t=Dr(t))for(let e=10;e<t.length;e++){const n=t[e],r=n[1];Le(n)&&ji(r,n,r.template,n[8])}}(t),null!==e.contentQueries&&xi(e,t),!o)if(s){const n=e.contentCheckHooks;null!==n&&wt(t,n)}else{const n=e.contentHooks;null!==n&&Ct(t,n,1),Et(t,1)}!function(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let e=0;e<n.length;e++){const r=n[e];if(r<0)yt(~r);else{const i=r,o=n[++e],s=n[++e];it(o,i),s(2,t[i])}}}finally{yt(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let n=0;n<t.length;n++)co(e,t[n])}(t,a);const c=e.viewQuery;if(null!==c&&mo(2,c,r),!o)if(s){const n=e.viewCheckHooks;null!==n&&wt(t,n)}else{const n=e.viewHooks;null!==n&&Ct(t,n,2),Et(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,je(t[3],-1))}finally{gt()}}function Ui(e,t,n,r){const i=t[10],o=!Ke(),s=De(t);try{o&&!s&&i.begin&&i.begin(),s&&Fi(e,t,r),ji(e,t,n,r)}finally{o&&!s&&i.end&&i.end()}}function Vi(e,t,n,r,i){const o=mt(),s=2&r;try{yt(-1),s&&t.length>20&&Pi(e,t,20,Ke()),n(r,i)}finally{yt(o)}}function zi(e,t,n){if(de(t)){const r=t.directiveEnd;for(let i=t.directiveStart;i<r;i++){const t=e.data[i];t.contentQueries&&t.contentQueries(1,n[i],i)}}}function Hi(e,t,n){Ve()&&(function(e,t,n,r){const i=n.directiveStart,o=n.directiveEnd;e.firstCreatePass||Ft(n,t),Ir(r,t);const s=n.initialInputs;for(let a=i;a<o;a++){const r=e.data[a],o=ge(r);o&&ro(t,n,r);const c=Yt(t,e,a,n);Ir(c,t),null!==s&&oo(0,a-i,c,r,0,s),o&&(xe(n.index,t)[8]=c)}}(e,t,n,ke(n,t)),128==(128&n.flags)&&function(e,t,n){const r=n.directiveStart,i=n.directiveEnd,o=n.index,s=Ue.lFrame.currentDirectiveIndex;try{yt(o);for(let n=r;n<i;n++){const r=e.data[n],i=t[n];ot(n),null===r.hostBindings&&0===r.hostVars&&null===r.hostAttrs||Ji(r,i)}}finally{yt(-1),ot(s)}}(e,t,n))}function Gi(e,t,n=ke){const r=t.localNames;if(null!==r){let i=t.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],a=-1===s?n(t,e):e[s];e[i++]=a}}}function $i(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=qi(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function qi(e,t,n,r,i,o,s,a,c,l){const u=20+r,h=u+i,d=function(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:Oi);return n}(u,h),f="function"==typeof l?l():l;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:f,incompleteFirstPass:!1}}function Wi(e,t,n,r){const i=vo(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&bo(e).push(r,i.length-1))}function Zi(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Qi(e,t,n,r,i,o,s,a){const c=ke(t,n);let l,u=t.inputs;var h;!a&&null!=u&&(l=u[r])?(wo(e,n,l,r,i),fe(t)&&function(e,t){const n=xe(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=s?s(i,t.value||"",r):i,Pe(o)?o.setProperty(c,r,i):At(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function Yi(e,t,n,r){let i=!1;if(Ve()){const o=function(e,t,n){const r=e.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];_i(n,s.selectors,!1)&&(i||(i=[]),zt(Ft(n,t),e,s.type),ge(s)?(Xi(e,n),i.unshift(s)):i.push(s))}return i}(e,t,n),s=null===r?null:{"":-1};if(null!==o){i=!0,to(n,e.data.length,o.length);for(let e=0;e<o.length;e++){const t=o[e];t.providersResolver&&t.providersResolver(t)}let r=!1,a=!1,c=Bi(e,t,o.length,null);for(let i=0;i<o.length;i++){const l=o[i];n.mergedAttrs=kt(n.mergedAttrs,l.hostAttrs),no(e,n,t,c,l),eo(c,l,s),null!==l.contentQueries&&(n.flags|=8),null===l.hostBindings&&null===l.hostAttrs&&0===l.hostVars||(n.flags|=128);const u=l.type.prototype;!r&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),r=!0),a||!u.ngOnChanges&&!u.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),a=!0),c++}!function(e,t){const n=t.directiveEnd,r=e.data,i=t.attrs,o=[];let s=null,a=null;for(let c=t.directiveStart;c<n;c++){const e=r[c],n=e.inputs,l=null===i||gi(t)?null:so(n,i);o.push(l),s=Zi(n,c,s),a=Zi(e.outputs,c,a)}null!==s&&(s.hasOwnProperty("class")&&(t.flags|=16),s.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=s,t.outputs=a}(e,n)}s&&function(e,t,n){if(t){const r=e.localNames=[];for(let e=0;e<t.length;e+=2){const i=n[t[e+1]];if(null==i)throw new m("301",`Export of name '${t[e+1]}' not found!`);r.push(t[e],i)}}}(n,r,s)}return n.mergedAttrs=kt(n.mergedAttrs,n.attrs),i}function Ki(e,t,n,r,i,o){const s=o.hostBindings;if(s){let n=e.hostBindingOpCodes;null===n&&(n=e.hostBindingOpCodes=[]);const o=~t.index;(function(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(n)!=o&&n.push(o),n.push(r,i,s)}}function Ji(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Xi(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function eo(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ge(t)&&(n[""]=e)}}function to(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function no(e,t,n,r,i){e.data[r]=i;const o=i.factory||(i.factory=me(i.type)),s=new Pt(o,ge(i),null);e.blueprint[r]=s,n[r]=s,Ki(e,t,0,r,Bi(e,n,i.hostVars,Oi),i)}function ro(e,t,n){const r=ke(t,e),i=$i(n),o=e[10],s=ho(e,Ri(e,i,null,n.onPush?64:16,r,t,o,o.createRenderer(r,n),null,null));e[t.index]=s}function io(e,t,n,r,i,o,s){if(null==o)Pe(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{const a=null==s?y(o):s(o,r||"",i);Pe(e)?e.setAttribute(t,i,a,n):n?t.setAttributeNS(n,i,a):t.setAttribute(i,a)}}function oo(e,t,n,r,i,o){const s=o[t];if(null!==s){const e=r.setInput;for(let t=0;t<s.length;){const i=s[t++],o=s[t++],a=s[t++];null!==e?r.setInput(n,a,i,o):n[o]=a}}}function so(e,t){let n=null,r=0;for(;r<t.length;){const i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function ao(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function co(e,t){const n=xe(t,e);if(Le(n)){const e=n[1];80&n[2]?ji(e,n,e.template,n[8]):n[5]>0&&lo(n)}}function lo(e){for(let n=Rr(e);null!==n;n=Dr(n))for(let e=10;e<n.length;e++){const t=n[e];if(1024&t[2]){const e=t[1];ji(e,t,e.template,t[8])}else t[5]>0&&lo(t)}const t=e[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=xe(t[n],e);Le(r)&&r[5]>0&&lo(r)}}function uo(e,t){const n=xe(t,e),r=n[1];!function(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n),Fi(r,n,n[8])}function ho(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function fo(e){for(;e;){e[2]|=64;const t=xr(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function po(e,t,n){const r=t[10];r.begin&&r.begin();try{ji(e,t,e.template,n)}catch(i){throw _o(t,i),i}finally{r.end&&r.end()}}function go(e){!function(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=Re(n),i=r[1];Ui(i,r,i.template,n)}}(e[8])}function mo(e,t,n){at(0),t(e,n)}const yo=(()=>Promise.resolve(null))();function vo(e){return e[7]||(e[7]=[])}function bo(e){return e.cleanup||(e.cleanup=[])}function _o(e,t){const n=e[9],r=n?n.get(Or,null):null;r&&r.handleError(t)}function wo(e,t,n,r,i){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],c=t[s],l=e.data[s];null!==l.setInput?l.setInput(c,i,r,a):c[a]=i}}function Co(e,t,n){const r=Ae(t,e);jr(e[11],r,n)}function Eo(e,t,n){let r=n?e.styles:null,i=n?e.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const e=t[s];"number"==typeof e?o=e:1==o?i=h(i,e):2==o&&(r=h(r,e+": "+t[++s]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}const Oo=new on("INJECTOR",-1);class So{get(e,t=mn){if(t===mn){const t=new Error(`NullInjectorError: No provider for ${u(e)}!`);throw t.name="NullInjectorError",t}return t}}const Po=new on("Set Injector scope."),Io={},To={},Ao=[];let ko;function No(){return void 0===ko&&(ko=new So),ko}function Mo(e,t=null,n=null,r){return new xo(e,n,t||No(),r)}class xo{constructor(e,t,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];t&&ln(t,n=>this.processProvider(n,e,t)),ln([e],e=>this.processInjectorType(e,[],i)),this.records.set(Oo,Lo(void 0,this));const o=this.records.get(Po);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:u(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=mn,n=k.Default){this.assertNotDestroyed();const r=_n(this);try{if(!(n&k.SkipSelf)){let t=this.records.get(e);if(void 0===t){const n=("function"==typeof(i=e)||"object"==typeof i&&i instanceof on)&&E(e);t=n&&this.injectableDefInScope(n)?Lo(Ro(e),Io):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(n&k.Self?No():this.parent).get(e,t=n&k.Optional&&t===mn?null:t)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(u(e)),r)throw o;return function(e,t,n,r){const i=e.ngTempTokenPath;throw t.__source&&i.unshift(t.__source),e.message=function(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let i=u(t);if(Array.isArray(t))i=t.map(u).join(" -> ");else if("object"==typeof t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push(n+":"+("string"==typeof r?JSON.stringify(r):u(r)))}i=`{${e.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${e.replace(yn,"\n  ")}`}("\n"+e.message,i,n,r),e.ngTokenPath=i,e.ngTempTokenPath=null,e}(o,e,"R3InjectorError",this.source)}throw o}finally{_n(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,n)=>e.push(u(n))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,n){if(!(e=p(e)))return!1;let r=S(e);const i=null==r&&e.ngModule||void 0,o=void 0===i?e:i,s=-1!==n.indexOf(o);if(void 0!==i&&(r=S(i)),null==r)return!1;if(null!=r.imports&&!s){let e;n.push(o);try{ln(r.imports,r=>{this.processInjectorType(r,t,n)&&(void 0===e&&(e=[]),e.push(r))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:n,providers:r}=e[t];ln(r,e=>this.processProvider(e,n,r||Ao))}}this.injectorDefTypes.add(o);const a=me(o)||(()=>new o);this.records.set(o,Lo(a,Io));const c=r.providers;if(null!=c&&!s){const t=e;ln(c,e=>this.processProvider(e,t,c))}return void 0!==i&&void 0!==e.providers}processProvider(e,t,n){let r=Fo(e=p(e))?e:p(e&&e.provide);const i=function(e,t,n){return Bo(e)?Lo(void 0,e.useValue):Lo(Do(e),Io)}(e);if(Fo(e)||!0!==e.multi)this.records.get(r);else{let t=this.records.get(r);t||(t=Lo(void 0,Io,!0),t.factory=()=>En(t.multi),this.records.set(r,t)),r=e,t.multi.push(e)}this.records.set(r,i)}hydrate(e,t){var n;return t.value===Io&&(t.value=To,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}function Ro(e){const t=E(e),n=null!==t?t.factory:me(e);if(null!==n)return n;if(e instanceof on)throw new Error(`Token ${u(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const n=dn(t,"?");throw new Error(`Can't resolve all parameters for ${u(e)}: (${n.join(", ")}).`)}const n=function(e){const t=e&&(e[P]||e[T]);if(t){const n=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Error("unreachable")}function Do(e,t,n){let r;if(Fo(e)){const t=p(e);return me(t)||Ro(t)}if(Bo(e))r=()=>p(e.useValue);else if((i=e)&&i.useFactory)r=()=>e.useFactory(...En(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))r=()=>Cn(p(e.useExisting));else{const t=p(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return me(t)||Ro(t);r=()=>new t(...En(e.deps))}var i;return r}function Lo(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Bo(e){return null!==e&&"object"==typeof e&&vn in e}function Fo(e){return"function"==typeof e}const jo=function(e,t,n){return function(e,t=null,n=null,r){const i=Mo(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)};let Uo=(()=>{class e{static create(e,t){return Array.isArray(e)?jo(e,t,""):jo(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=mn,e.NULL=new So,e.\u0275prov=w({token:e,providedIn:"any",factory:()=>Cn(Oo)}),e.__NG_ELEMENT_ID__=-1,e})();function Vo(e,t){_t(Re(e)[1],$e())}function zo(e){let t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0;const r=[e];for(;t;){let i;if(ge(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);const t=e;t.inputs=Ho(e.inputs),t.declaredInputs=Ho(e.declaredInputs),t.outputs=Ho(e.outputs);const n=i.hostBindings;n&&qo(e,n);const o=i.viewQuery,s=i.contentQueries;if(o&&Go(e,o),s&&$o(e,s),l(e.inputs,i.inputs),l(e.declaredInputs,i.declaredInputs),l(e.outputs,i.outputs),ge(i)&&i.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(i.data.animation)}}const t=i.features;if(t)for(let r=0;r<t.length;r++){const i=t[r];i&&i.ngInherit&&i(e),i===zo&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=kt(i.hostAttrs,n=kt(n,i.hostAttrs))}}(r)}function Ho(e){return e===z?{}:e===G?[]:e}function Go(e,t){const n=e.viewQuery;e.viewQuery=n?(e,r)=>{t(e,r),n(e,r)}:t}function $o(e,t){const n=e.contentQueries;e.contentQueries=n?(e,r,i)=>{t(e,r,i),n(e,r,i)}:t}function qo(e,t){const n=e.hostBindings;e.hostBindings=n?(e,r)=>{t(e,r),n(e,r)}:t}let Wo=null;function Zo(){if(!Wo){const e=V.Symbol;if(e&&e.iterator)Wo=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Wo=n)}}}return Wo}class Qo{constructor(e){this.wrapped=e}static wrap(e){return new Qo(e)}static unwrap(e){return Qo.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Qo}}function Yo(e){return!!Ko(e)&&(Array.isArray(e)||!(e instanceof Map)&&Zo()in e)}function Ko(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Jo(e,t,n){return e[t]=n}function Xo(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function es(e,t,n,r){const i=Xo(e,t,n);return Xo(e,t+1,r)||i}function ts(e,t,n,r,i){const o=es(e,t,n,r);return Xo(e,t+2,i)||o}function ns(e,t,n,r){const i=ze();return Xo(i,tt(),t)&&(He(),function(e,t,n,r,i,o){const s=ke(e,t);io(t[11],s,o,e.value,n,r,i)}(vt(),i,e,t,n,r)),ns}function rs(e,t,n,r){return Xo(e,tt(),n)?t+y(n)+r:Oi}function is(e,t,n,r,i,o){const s=es(e,et(),n,i);return nt(2),s?t+y(n)+r+y(i)+o:Oi}function os(e,t,n,r,i,o,s,a){const c=ts(e,et(),n,i,s);return nt(3),c?t+y(n)+r+y(i)+o+y(s)+a:Oi}function ss(e,t,n,r,i,o,s,a){const c=ze(),l=He(),u=e+20,h=l.firstCreatePass?function(e,t,n,r,i,o,s,a,c){const l=t.consts,u=Di(t,e,4,s||null,Be(l,a));Yi(t,n,u,Be(l,c)),_t(t,u);const h=u.tViews=qi(2,u,r,i,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,l);return null!==t.queries&&(t.queries.template(t,u),h.queries=t.queries.embeddedTView(u)),u}(u,l,c,t,n,r,i,o,s):l.data[u];Ze(h,!1);const d=c[11].createComment("");ri(l,c,d,h),Ir(d,c),ho(c,c[u]=ao(d,c,d,h)),pe(h)&&Hi(l,c,h),null!=s&&Gi(c,h,a)}function as(e){return Me(Ue.lFrame.contextLView,20+e)}function cs(e,t=k.Default){const n=ze();return null===n?Cn(e,t):$t($e(),n,p(e),t)}function ls(e,t,n){const r=ze();return Xo(r,tt(),t)&&Qi(He(),vt(),r,e,t,r[11],n,!1),ls}function us(e,t,n,r,i){const o=i?"class":"style";wo(e,n,t.inputs[o],o,r)}function hs(e,t,n,r){const i=ze(),o=He(),s=20+e,a=i[11],c=i[s]=Vr(a,t,Ue.lFrame.currentNamespace),l=o.firstCreatePass?function(e,t,n,r,i,o,s){const a=t.consts,c=Di(t,e,2,i,Be(a,o));return Yi(t,n,c,Be(a,s)),null!==c.attrs&&Eo(c,c.attrs,!1),null!==c.mergedAttrs&&Eo(c,c.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,c),c}(s,o,i,0,t,n,r):o.data[s];Ze(l,!0);const u=l.mergedAttrs;null!==u&&It(a,c,u);const h=l.classes;null!==h&&di(a,c,h);const d=l.styles;null!==d&&hi(a,c,d),64!=(64&l.flags)&&ri(o,i,c,l),0===Ue.lFrame.elementDepthCount&&Ir(c,i),Ue.lFrame.elementDepthCount++,pe(l)&&(Hi(o,i,l),zi(o,l,i)),null!==r&&Gi(i,l)}function ds(){let e=$e();Qe()?Ye():(e=e.parent,Ze(e,!1));const t=e;Ue.lFrame.elementDepthCount--;const n=He();n.firstCreatePass&&(_t(n,e),de(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&us(n,t,ze(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&us(n,t,ze(),t.stylesWithoutHost,!1)}function fs(e,t,n,r){hs(e,t,n,r),ds()}function ps(e,t,n){const r=ze(),i=He(),o=e+20,s=i.firstCreatePass?function(e,t,n,r,i){const o=t.consts,s=Be(o,r),a=Di(t,e,8,"ng-container",s);return null!==s&&Eo(a,s,!0),Yi(t,n,a,Be(o,i)),null!==t.queries&&t.queries.elementStart(t,a),a}(o,i,r,t,n):i.data[o];Ze(s,!0);const a=r[o]=r[11].createComment("");ri(i,r,a,s),Ir(a,r),pe(s)&&(Hi(i,r,s),zi(i,s,r)),null!=n&&Gi(r,s)}function gs(){let e=$e();const t=He();Qe()?Ye():(e=e.parent,Ze(e,!1)),t.firstCreatePass&&(_t(t,e),de(e)&&t.queries.elementEnd(e))}function ms(){return ze()}function ys(e){return!!e&&"function"==typeof e.then}function vs(e){return!!e&&"function"==typeof e.subscribe}const bs=vs;function _s(e,t,n=!1,r){const i=ze(),o=He(),s=$e();return function(e,t,n,r,i,o,s=!1,a){const c=pe(r),l=e.firstCreatePass&&bo(e),u=vo(t);let h=!0;if(3&r.type){const d=ke(r,t),f=a?a(d):z,p=f.target||d,g=u.length,m=a?e=>a(Te(e[r.index])).target:r.index;if(Pe(n)){let s=null;if(!a&&c&&(s=function(e,t,n,r){const i=e.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const e=i[o];if(e===n&&i[o+1]===r){const e=t[7],n=i[o+2];return e.length>n?e[n]:null}"string"==typeof e&&(o+=2)}return null}(e,t,i,r.index)),null!==s)(s.__ngLastListenerFn__||s).__ngNextListenerFn__=o,s.__ngLastListenerFn__=o,h=!1;else{o=Cs(r,t,0,o,!1);const e=n.listen(f.name||p,i,o);u.push(o,e),l&&l.push(i,m,g,g+1)}}else o=Cs(r,t,0,o,!0),p.addEventListener(i,o,s),u.push(o),l&&l.push(i,m,g,s)}else o=Cs(r,t,0,o,!1);const d=r.outputs;let f;if(h&&null!==d&&(f=d[i])){const e=f.length;if(e)for(let n=0;n<e;n+=2){const e=t[f[n]][f[n+1]].subscribe(o),s=u.length;u.push(o,e),l&&l.push(i,r.index,s,-(s+1))}}}(o,i,i[11],s,e,t,n,r),_s}function ws(e,t,n,r){try{return!1!==n(r)}catch(i){return _o(e,i),!1}}function Cs(e,t,n,r,i){return function n(o){if(o===Function)return r;const s=2&e.flags?xe(e.index,t):t;0==(32&t[2])&&fo(s);let a=ws(t,0,r,o),c=n.__ngNextListenerFn__;for(;c;)a=ws(t,0,c,o)&&a,c=c.__ngNextListenerFn__;return i&&!1===a&&(o.preventDefault(),o.returnValue=!1),a}}function Es(e=1){return function(e){return(Ue.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ue.lFrame.contextLView))[8]}(e)}function Os(e,t){let n=null;const r=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let i=0;i<t.length;i++){const o=t[i];if("*"!==o){if(null===r?_i(e,o,!0):wi(r,o))return i}else n=i}return n}function Ss(e){const t=ze()[16][6];if(!t.projection){const n=t.projection=dn(e?e.length:1,null),r=n.slice();let i=t.child;for(;null!==i;){const t=e?Os(i,e):0;null!==t&&(r[t]?r[t].projectionNext=i:n[t]=i,r[t]=i),i=i.next}}}function Ps(e,t=0,n){const r=ze(),i=He(),o=Di(i,20+e,16,null,n||null);null===o.projection&&(o.projection=t),Ye(),64!=(64&o.flags)&&function(e,t,n){ui(t[11],0,t,n,qr(e,n,t),Jr(n.parent||t[6],n,t))}(i,r,o)}function Is(e,t,n,r,i){const o=ze(),s=rs(o,t,n,r);return s!==Oi&&Qi(He(),vt(),o,e,s,o[11],i,!1),Is}function Ts(e,t,n,r,i,o,s){const a=ze(),c=is(a,t,n,r,i,o);return c!==Oi&&Qi(He(),vt(),a,e,c,a[11],s,!1),Ts}function As(e,t,n,r,i,o,s,a,c){const l=ze(),u=os(l,t,n,r,i,o,s,a);return u!==Oi&&Qi(He(),vt(),l,e,u,l[11],c,!1),As}function ks(e,t,n,r,i){const o=e[n+1],s=null===t;let a=r?Ti(o):ki(o),c=!1;for(;0!==a&&(!1===c||s);){const n=e[a+1];Ns(e[a],t)&&(c=!0,e[a+1]=r?Mi(n):Ai(n)),a=r?Ti(n):ki(n)}c&&(e[n+1]=r?Ai(o):Mi(o))}function Ns(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&gn(e,t)>=0}function Ms(e,t){return function(e,t,n,r){const i=ze(),o=He(),s=nt(2);o.firstUpdatePass&&function(e,t,n,r){const i=e.data;if(null===i[n+1]){const r=i[mt()],o=function(e,t){return t>=e.expandoStartIndex}(e,n);(function(e,t){return 0!=(16&e.flags)})(r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){const i=function(e){const t=Ue.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let o=t.residualClasses;if(null===i)0===t.classBindings&&(n=Rs(n=xs(null,e,t,n,true),t.attrs,true),o=null);else{const r=t.directiveStylingLast;if(-1===r||e[r]!==i)if(n=xs(i,e,t,n,true),null===o){let n=function(e,t,n){const r=t.classBindings;if(0!==ki(r))return e[Ti(r)]}(e,t);void 0!==n&&Array.isArray(n)&&(n=xs(null,e,t,n[1],true),n=Rs(n,t.attrs,true),function(e,t,n,r){e[Ti(t.classBindings)]=r}(e,t,0,n))}else o=function(e,t,n){let r;const i=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<i;o++)r=Rs(r,e[o].hostAttrs,true);return Rs(r,t.attrs,true)}(e,t)}return void 0!==o&&(t.residualClasses=o),n}(i,r,t),function(e,t,n,r,i,o){let s=t.classBindings,a=Ti(s),c=ki(s);e[r]=n;let l,u=!1;if(Array.isArray(n)){const e=n;l=e[1],(null===l||gn(e,l)>0)&&(u=!0)}else l=n;if(i)if(0!==c){const t=Ti(e[a+1]);e[r+1]=Ii(t,a),0!==t&&(e[t+1]=Ni(e[t+1],r)),e[a+1]=131071&e[a+1]|r<<17}else e[r+1]=Ii(a,0),0!==a&&(e[a+1]=Ni(e[a+1],r)),a=r;else e[r+1]=Ii(c,0),0===a?a=r:e[c+1]=Ni(e[c+1],r),c=r;u&&(e[r+1]=Ai(e[r+1])),ks(e,l,r,!0),ks(e,l,r,!1),function(e,t,n,r,i){const o=e.residualClasses;null!=o&&"string"==typeof t&&gn(o,t)>=0&&(n[r+1]=Mi(n[r+1]))}(t,l,e,r),s=Ii(a,c),t.classBindings=s}(i,r,t,n,o)}}(o,e,s),t!==Oi&&Xo(i,s,t)&&function(e,t,n,r,i,o,s,a){if(!(3&t.type))return;const c=e.data,l=c[a+1];Ls(1==(1&l)?Ds(c,t,n,i,ki(l),true):void 0)||(Ls(o)||function(e){return 2==(2&e)}(l)&&(o=Ds(c,null,n,i,a,true)),function(e,t,n,r,i){const o=Pe(e);i?o?e.addClass(n,r):n.classList.add(r):o?e.removeClass(n,r):n.classList.remove(r)}(r,0,Ae(mt(),n),i,o))}(o,o.data[mt()],i,i[11],e,i[s+1]=function(e,t){return null==e||"object"==typeof e&&(e=u(Fn(e))),e}(t),0,s)}(e,t),Ms}function xs(e,t,n,r,i){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=t[a],r=Rs(r,o.hostAttrs,i),o!==e);)a++;return null!==e&&(n.directiveStylingLast=a),r}function Rs(e,t,n){const r=n?1:2;let i=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?i=s:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),fn(e,s,!!n||t[++o]))}return void 0===e?null:e}function Ds(e,t,n,r,i,o){const s=null===t;let a;for(;i>0;){const t=e[i],o=Array.isArray(t),c=o?t[1]:t,l=null===c;let u=n[i+1];u===Oi&&(u=l?H:void 0);let h=l?pn(u,r):c===r?u:void 0;if(o&&!Ls(h)&&(h=pn(t,r)),Ls(h)&&(a=h,s))return a;const d=e[i+1];i=s?Ti(d):ki(d)}if(null!==t){let e=o?t.residualClasses:t.residualStyles;null!=e&&(a=pn(e,r))}return a}function Ls(e){return void 0!==e}function Bs(e,t=""){const n=ze(),r=He(),i=e+20,o=r.firstCreatePass?Di(r,i,1,t,null):r.data[i],s=n[i]=Fr(n[11],t);ri(r,n,s,o),Ze(o,!1)}function Fs(e){return js("",e,""),Fs}function js(e,t,n){const r=ze(),i=rs(r,e,t,n);return i!==Oi&&Co(r,mt(),i),js}function Us(e,t,n,r,i){const o=ze(),s=is(o,e,t,n,r,i);return s!==Oi&&Co(o,mt(),s),Us}function Vs(e,t,n,r,i,o,s){const a=ze(),c=os(a,e,t,n,r,i,o,s);return c!==Oi&&Co(a,mt(),c),Vs}function zs(e,t,n){const r=ze();return Xo(r,tt(),t)&&Qi(He(),vt(),r,e,t,r[11],n,!0),zs}const Hs=void 0;var Gs=["en",[["a","p"],["AM","PM"],Hs],[["AM","PM"],Hs,Hs],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Hs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Hs,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Hs,"{1} 'at' {0}",Hs],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){let t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let $s={};function qs(e,t,n){"string"!=typeof t&&(n=t,t=e[Ks.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),$s[t]=e,n&&($s[t][Ks.ExtraData]=n)}function Ws(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=Ys(t);if(n)return n;const r=t.split("-")[0];if(n=Ys(r),n)return n;if("en"===r)return Gs;throw new Error(`Missing locale data for the locale "${e}".`)}function Zs(e){return Ws(e)[Ks.CurrencyCode]||null}function Qs(e){return Ws(e)[Ks.PluralCase]}function Ys(e){return e in $s||($s[e]=V.ng&&V.ng.common&&V.ng.common.locales&&V.ng.common.locales[e]),$s[e]}var Ks=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}({});const Js=["zero","one","two","few","many"],Xs={marker:"element"},ea={marker:"ICU"};var ta=function(e){return e[e.SHIFT=2]="SHIFT",e[e.APPEND_EAGERLY=1]="APPEND_EAGERLY",e[e.COMMENT=2]="COMMENT",e}({});let na="en-US";function ra(e){var t;null==(t=e)&&_("Expected localeId to be defined",t,null,"!="),"string"==typeof e&&(na=e.toLowerCase().replace(/_/g,"-"))}function ia(e,t,n){const r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?Xr(e,0,n):Te(n[i])}function oa(e,t,n,r,i){const o=t.insertBeforeIndex;if(Array.isArray(o)){let s=r,a=null;if(3&t.type||(a=s,s=i),null!==s&&0==(2&t.flags))for(let t=1;t<o.length;t++)Zr(e,s,n[o[t]],a,!1)}}function sa(e,t){if(e.push(t),e.length>1)for(let n=e.length-2;n>=0;n--){const r=e[n];aa(r)||ca(r,t)&&null===la(r)&&ua(r,t.index)}}function aa(e){return!(64&e.type)}function ca(e,t){return aa(t)||e.index>t.index}function la(e){const t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function ua(e,t){const n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(ni(ia,oa),e.insertBeforeIndex=t)}function ha(e,t){const n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function da(e,t,n){const r=Li(e,n,64,null,null);return sa(t,r),r}function fa(e,t){const n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}let pa=0,ga=0;function ma(e,t,n,r){const i=n[11];let o,s=null;for(let a=0;a<t.length;a++){const c=t[a];if("string"==typeof c){const e=t[++a];null===n[e]&&(n[e]=Fr(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=c>>>17;let u,h;if(null===s&&(s=l,o=Kr(i,r)),l===s?(u=r,h=o):(u=null,h=Te(n[l])),null!==h){const t=(131070&c)>>>1;Zr(i,h,n[t],u,!1);const r=ha(e,t);if(null!==r&&"object"==typeof r){const t=fa(r,n);null!==t&&ma(e,r.create[t],n,n[r.anchorIdx])}}break;case 1:const d=t[++a],f=t[++a];io(i,Ae(c>>>1,n),null,null,d,f,null);break;default:throw new Error(`Unable to determine the type of mutate operation for "${c}"`)}else switch(c){case ea:const e=t[++a],r=t[++a];null===n[r]&&Ir(n[r]=Ur(i,e),n);break;case Xs:const o=t[++a],s=t[++a];null===n[s]&&Ir(n[s]=Vr(i,o,null),n)}}}function ya(e,t,n,r,i){for(let o=0;o<n.length;o++){const s=n[o],a=n[++o];if(s&i){let i="";for(let s=o+1;s<=o+a;s++){const o=n[s];if("string"==typeof o)i+=o;else if("number"==typeof o)if(o<0)i+=y(t[r-o]);else{const a=o>>>2;switch(3&o){case 1:const o=n[++s],c=n[++s],l=e.data[a];"string"==typeof l?io(t[11],t[a],null,l,o,i,c):Qi(e,l,t,o,i,t[11],c,!1);break;case 0:const u=t[a];null!==u&&jr(t[11],u,i);break;case 2:ba(e,ha(e,a),t,i);break;case 3:va(e,ha(e,a),r,t)}}}}else{const i=n[o+1];if(i>0&&3==(3&i)){const n=ha(e,i>>>2);t[n.currentCaseLViewIndex]<0&&va(e,n,r,t)}}o+=a}}function va(e,t,n,r){let i=r[t.currentCaseLViewIndex];if(null!==i){let o=pa;i<0&&(i=r[t.currentCaseLViewIndex]=~i,o=-1),ya(e,r,t.update[i],n,o)}}function ba(e,t,n,r){const i=function(e,t){let n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:{const r=function(e,t){const n=Qs(t)(parseInt(e,10)),r=Js[n];return void 0!==r?r:"other"}(t,na);n=e.cases.indexOf(r),-1===n&&"other"!==r&&(n=e.cases.indexOf("other"));break}case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(fa(t,n)!==i&&(_a(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const r=n[t.anchorIdx];r&&ma(e,t.create[i],n,r)}}function _a(e,t,n){let r=fa(t,n);if(null!==r){const i=t.remove[r];for(let t=0;t<i.length;t++){const r=i[t];if(r>0){const e=Ae(r,n);null!==e&&ai(n[11],e)}else _a(e,ha(e,~r),n)}}}const wa=/\ufffd(\d+):?\d*\ufffd/gi,Ca=/\ufffd(\d+)\ufffd/,Ea=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Oa=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,Sa=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Pa=/\uE500/g;function Ia(e,t,n,r,i,o,s){const a=Bi(e,r,1,null);let c=a<<ta.SHIFT,l=We();t===l&&(l=null),null===l&&(c|=ta.APPEND_EAGERLY),s&&(c|=ta.COMMENT,void 0===Nr&&(Nr=function(){const e=[];let t,n,r=-1;function i(e,t){r=0;const i=fa(e,t);n=null!==i?e.remove[i]:G}function o(){if(r<n.length){const s=n[r++];return s>0?t[s]:(e.push(r,n),i(t[1].data[~s],t),o())}return 0===e.length?null:(n=e.pop(),r=e.pop(),o())}return function(n,r){for(t=r;e.length;)e.pop();return i(n.value,r),o}}())),i.push(c,null===o?"":o);const u=Li(e,a,s?32:1,null===o?"":o,null);sa(n,u);const h=u.index;return Ze(u,!1),null!==l&&t!==l&&function(e,t){let n=e.insertBeforeIndex;var r;null===n?(ni(ia,oa),n=e.insertBeforeIndex=[null,t]):("Expecting array here",(r=Array.isArray(n))!=!0&&_("Expecting array here",r,true,"=="),n.push(t))}(l,h),u}function Ta(e,t,n,r,i,o,s){const a=s.match(wa),c=Ia(e,t,n,o,r,a?null:s,!1);a&&Aa(i,s,c.index,null,0,null)}function Aa(e,t,n,r,i,o){const s=e.length,a=s+1;e.push(null,null);const c=s+2,l=t.split(wa);let u=0;for(let h=0;h<l.length;h++){const t=l[h];if(1&h){const n=i+parseInt(t,10);e.push(-1-n),u|=ka(n)}else""!==t&&e.push(t)}return e.push(n<<2|(r?1:0)),r&&e.push(r,o),e[s]=u,e[a]=e.length-c,u}function ka(e){return 1<<Math.min(e,31)}function Na(e){let t,n,r="",i=0,o=!1;for(;null!==(t=Oa.exec(e));)o?t[0]===`\ufffd/*${n}\ufffd`&&(i=t.index,o=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],o=!0);return r+=e.substr(i),r}function Ma(e,t,n,r,i,o){let s=0;const a={type:i.type,currentCaseLViewIndex:Bi(e,t,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};!function(e,t,n){e.push(ka(t.mainBinding),2,-1-t.mainBinding,n<<2|2)}(n,i,o),function(e,t,n){const r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,o,a);const c=i.values;for(let l=0;l<c.length;l++){const o=c[l],u=[];for(let e=0;e<o.length;e++){const t=o[e];if("string"!=typeof t){const n=u.push(t)-1;o[e]=`\x3c!--\ufffd${n}\ufffd--\x3e`}}s=Da(e,a,t,n,r,i.cases[l],o.join(""),u)|s}s&&function(e,t,n){e.push(t,1,n<<2|3)}(n,s,o)}function xa(e){const t=[],n=[];let r=1,i=0;const o=Ra(e=e.replace(Ea,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""}));for(let s=0;s<o.length;){let e=o[s++].trim();1===r&&(e=e.replace(/\s*(?:=)?(\w+)\s*/,"$1")),e.length&&t.push(e);const i=Ra(o[s++]);t.length>n.length&&n.push(i)}return{type:r,mainBinding:i,cases:t,values:n}}function Ra(e){if(!e)return[];let t=0;const n=[],r=[],i=/[{}]/g;let o;for(i.lastIndex=0;o=i.exec(e);){const i=o.index;if("}"==o[0]){if(n.pop(),0==n.length){const n=e.substring(t,i);Ea.test(n)?r.push(xa(n)):r.push(n),t=i+1}}else{if(0==n.length){const n=e.substring(t,i);r.push(n),t=i+1}n.push("{")}}const s=e.substring(t);return r.push(s),r}function Da(e,t,n,r,i,o,s,a){const c=[],l=[],u=[];t.cases.push(o),t.create.push(c),t.remove.push(l),t.update.push(u);const h=qn(Se()).getInertBodyElement(s),d=mr(h)||h;return d?La(e,t,n,r,c,l,u,d,i,a,0):0}function La(e,t,n,r,i,o,s,a,c,l,u){let h=0,d=a.firstChild;for(;d;){const a=Bi(e,n,1,null);switch(d.nodeType){case Node.ELEMENT_NODE:const f=d,p=f.tagName.toLowerCase();if(or.hasOwnProperty(p)){ja(i,Xs,p,c,a),e.data[a]=p;const g=f.attributes;for(let e=0;e<g.length;e++){const t=g.item(e),n=t.name.toLowerCase();t.value.match(wa)?cr.hasOwnProperty(n)&&Aa(s,t.value,a,t.name,0,sr[n]?Kn:ar[n]?Jn:null):Ua(i,a,t)}h=La(e,t,n,r,i,o,s,d,a,l,u+1)|h,Ba(o,a,u)}break;case Node.TEXT_NODE:const g=d.textContent||"",m=g.match(wa);ja(i,null,m?"":g,c,a),Ba(o,a,u),m&&(h=Aa(s,g,a,null,0,null)|h);break;case Node.COMMENT_NODE:const y=Ca.exec(d.textContent||"");if(y){const t=l[parseInt(y[1],10)];ja(i,ea,"",c,a),Ma(e,n,r,c,t,a),Fa(o,a,u)}}d=d.nextSibling}return h}function Ba(e,t,n){0===n&&e.push(t)}function Fa(e,t,n){0===n&&(e.push(~t),e.push(t))}function ja(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,0|r<<17|i<<1)}function Ua(e,t,n){e.push(t<<1|1,n.name,n.value)}function Va(e,t,n=-1){const r=He(),i=ze(),o=20+e,s=Be(r.consts,t),a=We();r.firstCreatePass&&function(e,t,n,r,i,o){const s=We(),a=[],c=[],l=[[]],u=(h=i=function(e,t){if(function(e){return-1===e}(t))return Na(e);{const n=e.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=e.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return Na(e.substring(n,r))}}(i,o),h.replace(Pa," ")).split(Sa);var h;for(let d=0;d<u.length;d++){let r=u[d];if(0==(1&d)){const o=Ra(r);for(let r=0;r<o.length;r++){let u=o[r];if(0==(1&r)){const t=u;""!==t&&Ta(e,s,l[0],a,c,n,t)}else{const r=u;if("object"!=typeof r)throw new Error(`Unable to parse ICU expression in "${i}" message.`);Ma(e,n,c,t,r,Ia(e,s,l[0],n,a,"",!0).index)}}}else{const t=47===r.charCodeAt(0),n=(r.charCodeAt(t?1:0),20+Number.parseInt(r.substring(t?2:1)));if(t)l.shift(),Ze(We(),!1);else{const t=da(e,l[0],n);l.unshift([]),Ze(t,!0)}}}e.data[r]={create:a,update:c}}(r,null===a?0:a.index,i,o,s,n);const c=r.data[o],l=Wr(r,a===i[6]?null:a,i);!function(e,t,n,r){const i=e[11];for(let o=0;o<t.length;o++){const s=t[o++],a=t[o],c=(s&ta.COMMENT)===ta.COMMENT,l=(s&ta.APPEND_EAGERLY)===ta.APPEND_EAGERLY,u=s>>>ta.SHIFT;let h=e[u];null===h&&(h=e[u]=c?i.createComment(a):Fr(i,a)),l&&null!==n&&Zr(i,n,h,r,!1)}}(i,c.create,l,a&&8&a.type?i[a.index]:null),rt(!0)}function za(){rt(!1)}function Ha(e,t,n){Va(e,t,n),za()}function Ga(e){return Xo(ze(),tt(),e)&&(pa|=1<<Math.min(ga,31)),ga++,Ga}function $a(e){!function(e,t,n){if(ga>0){const r=e.data[n];ya(e,t,Array.isArray(r)?r:r.update,et()-ga-1,pa)}pa=0,ga=0}(He(),ze(),e+20)}function qa(e,t,n,r,i){if(e=p(e),Array.isArray(e))for(let o=0;o<e.length;o++)qa(e[o],t,n,r,i);else{const o=He(),s=ze();let a=Fo(e)?e:p(e.provide),c=Do(e);const l=$e(),u=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(Fo(e)||!e.multi){const r=new Pt(c,i,cs),f=Qa(a,t,i?u:u+d,h);-1===f?(zt(Ft(l,s),o,a),Wa(o,e,t.length),t.push(a),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(r),s.push(r)):(n[f]=r,s[f]=r)}else{const f=Qa(a,t,u+d,h),p=Qa(a,t,u,u+d),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){zt(Ft(l,s),o,a);const u=function(e,t,n,r,i){const o=new Pt(e,n,cs);return o.multi=[],o.index=t,o.componentProviders=0,Za(o,i,r&&!n),o}(i?Ka:Ya,n.length,i,r,c);!i&&m&&(n[p].providerFactory=u),Wa(o,e,t.length,0),t.push(a),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(u),s.push(u)}else Wa(o,e,f>-1?f:p,Za(n[i?p:f],c,!i&&r));!i&&r&&m&&n[p].componentProviders++}}}function Wa(e,t,n,r){const i=Fo(t);if(i||t.useClass){const o=(t.useClass||t).prototype.ngOnDestroy;if(o){const s=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){const e=s.indexOf(n);-1===e?s.push(n,[r,o]):s[e+1].push(r,o)}else s.push(n,o)}}}function Za(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Qa(e,t,n,r){for(let i=n;i<r;i++)if(t[i]===e)return i;return-1}function Ya(e,t,n,r){return Ja(this.multi,[])}function Ka(e,t,n,r){const i=this.multi;let o;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Yt(n,n[1],this.providerFactory.index,r);o=t.slice(0,e),Ja(i,o);for(let n=e;n<t.length;n++)o.push(t[n])}else o=[],Ja(i,o);return o}function Ja(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function Xa(e,t=[]){return n=>{n.providersResolver=(n,r)=>function(e,t,n){const r=He();if(r.firstCreatePass){const i=ge(e);qa(n,r.data,r.blueprint,i,!0),qa(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}class ec{}class tc{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${u(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(e)}}let nc=(()=>{class e{}return e.NULL=new tc,e})();function rc(...e){}function ic(e,t){return new sc(ke(e,t))}const oc=function(){return ic($e(),ze())};let sc=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=oc,e})();function ac(e){return e instanceof sc?e.nativeElement:e}class cc{}let lc=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>uc(),e})();const uc=function(){const e=ze(),t=xe($e().index,e);return function(e){return e[11]}(ue(t)?t:e)};let hc=(()=>{class e{}return e.\u0275prov=w({token:e,providedIn:"root",factory:()=>null}),e})();class dc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const fc=new dc("11.2.14");class pc{constructor(){}supports(e){return Yo(e)}create(e){return new mc(e)}}const gc=(e,t)=>t;class mc{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||gc}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,i=null;for(;t||n;){const o=!n||t&&t.currentIndex<_c(n,r,i)?t:n,s=_c(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);const e=s-r,t=a-r;if(e!=t){for(let n=0;n<e;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;t<=o&&o<e&&(i[n]=r+1)}i[o.previousIndex]=t-e}}s!==a&&e(o,s,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Yo(e))throw new Error(`Error trying to diff '${u(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,n,r,i=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)n=e[t],r=this._trackByFn(t,n),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,t)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,t),o=!0),i=i._next}else t=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Zo()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(e,e=>{r=this._trackByFn(t,e),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,e,r,t)),Object.is(i.item,e)||this._addIdentityChange(i,e)):(i=this._mismatch(i,e,r,t),o=!0),i=i._next,t++}),this.length=t;return this._truncate(i),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new yc(t,n),i,r),e}_verifyReinsertion(e,t,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new bc),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new bc),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class yc{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class vc{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class bc{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new vc,this.map.set(t,n)),n.add(e)}get(e,t){const n=this.map.get(e);return n?n.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function _c(e,t,n){const r=e.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+t+i}class wc{constructor(){}supports(e){return e instanceof Map||Ko(e)}create(){return new Cc}}class Cc{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Ko(e)))throw new Error(`Error trying to diff '${u(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,n)=>{if(t&&t.key===n)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const r=this._getOrCreateRecordForKey(n,e);t=this._insertBeforeOrAppend(t,r)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const n=this._records.get(e);this._maybeAddToChanges(n,t);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Ec(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class Ec{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Oc(){return new Sc([new pc])}let Sc=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(null!=n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||Oc()),deps:[[e,new In,new Pn]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${n=e,n.name||typeof n}'`);var n}}return e.\u0275prov=w({token:e,providedIn:"root",factory:Oc}),e})();function Pc(){return new Ic([new wc])}let Ic=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||Pc()),deps:[[e,new In,new Pn]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=w({token:e,providedIn:"root",factory:Pc}),e})();function Tc(e,t,n,r,i=!1){for(;null!==n;){const o=t[n.index];if(null!==o&&r.push(Te(o)),he(o))for(let e=10;e<o.length;e++){const t=o[e],n=t[1].firstChild;null!==n&&Tc(t[1],t,n,r)}const s=n.type;if(8&s)Tc(e,t,n.child,r);else if(32&s){const e=Mr(n,t);let i;for(;i=e();)r.push(i)}else if(16&s){const e=oi(t,n);if(Array.isArray(e))r.push(...e);else{const n=xr(t[16]);Tc(n[1],n,e,r,!0)}}n=i?n.projectionNext:n.next}return r}class Ac{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Tc(t,e,t.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(he(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Hr(e,n),hn(t,n))}this._attachedToViewContainer=!1}Gr(this._lView[1],this._lView)}onDestroy(e){Wi(this._lView[1],this._lView,null,e)}markForCheck(){fo(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){po(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,n){Je(!0);try{po(e,t,n)}finally{Je(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,li(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class kc extends Ac{constructor(e){super(e),this._view=e}detectChanges(){go(this._view)}checkNoChanges(){!function(e){Je(!0);try{go(e)}finally{Je(!1)}}(this._view)}get context(){return null}}const Nc=xc;let Mc=(()=>{class e{}return e.__NG_ELEMENT_ID__=Nc,e.__ChangeDetectorRef__=!0,e})();function xc(e=!1){return function(e,t,n){if(!n&&fe(e)){const n=xe(e.index,t);return new Ac(n,n)}return 47&e.type?new Ac(t[16],t):null}($e(),ze(),e)}const Rc=[new wc],Dc=new Sc([new pc]),Lc=new Ic(Rc),Bc=function(){return Vc($e(),ze())};let Fc=(()=>{class e{}return e.__NG_ELEMENT_ID__=Bc,e})();const jc=Fc,Uc=class extends jc{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=Ri(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Fi(t,n,e),new Ac(n)}};function Vc(e,t){return 4&e.type?new Uc(t,e,ic(e,t)):null}class zc{}class Hc{}const Gc=function(){return Yc($e(),ze())};let $c=(()=>{class e{}return e.__NG_ELEMENT_ID__=Gc,e})();const qc=$c,Wc=class extends qc{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return ic(this._hostTNode,this._hostLView)}get injector(){return new Xt(this._hostTNode,this._hostLView)}get parentInjector(){const e=Vt(this._hostTNode,this._hostLView);if(Mt(e)){const t=Rt(e,this._hostLView),n=xt(e);return new Xt(t[1].data[n+8],t)}return new Xt(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Zc(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,i){const o=n||this.parentInjector;if(!i&&null==e.ngModule&&o){const e=o.get(zc,null);e&&(i=e)}const s=e.create(o,r,void 0,i);return this.insert(s.hostView,t),s}insert(e,t){const n=e._lView,r=n[1];if(he(n[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=n[3],r=new Wc(t,t[6],t[3]);r.detach(r.indexOf(e))}}const i=this._adjustIndex(t),o=this._lContainer;!function(e,t,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=t),r<o-10?(t[4]=n[i],un(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const s=t[17];null!==s&&n!==s&&function(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(s,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,n,o,i);const s=si(i,o),a=n[11],c=Kr(a,o[7]);return null!==c&&function(e,t,n,r,i,o){r[0]=i,r[6]=t,li(e,r,n,1,i,o)}(r,o[6],a,n,c,s),e.attachToViewContainerRef(),un(Qc(o),i,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Zc(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Hr(this._lContainer,t);n&&(hn(Qc(this._lContainer),t),Gr(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=Hr(this._lContainer,t);return n&&null!=hn(Qc(this._lContainer),t)?new Ac(n):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Zc(e){return e[8]}function Qc(e){return e[8]||(e[8]=[])}function Yc(e,t){let n;const r=t[e.index];if(he(r))n=r;else{let i;if(8&e.type)i=Te(r);else{const n=t[11];i=n.createComment("");const r=ke(e,t);Zr(n,Kr(n,r),i,function(e,t){return Pe(e)?e.nextSibling(t):t.nextSibling}(n,r),!1)}t[e.index]=n=ao(r,t,i,e),ho(t,n)}return new Wc(n,e,t)}const Kc={};class Jc extends nc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ce(e);return new tl(t,this.ngModule)}}function Xc(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}const el=new on("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Tr});class tl extends ec{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(Ei).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Xc(this.componentDef.inputs)}get outputs(){return Xc(this.componentDef.outputs)}create(e,t,n,r){const i=(r=r||this.ngModule)?function(e,t){return{get:(n,r,i)=>{const o=e.get(n,Kc,i);return o!==Kc||r===Kc?o:t.get(n,r,i)}}}(e,r.injector):e,o=i.get(cc,Ie),s=i.get(hc,null),a=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",l=n?function(e,t,n){if(Pe(e))return e.selectRootElement(t,n===L.ShadowDom);let r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(a,n,this.componentDef.encapsulation):Vr(o.createRenderer(null,this.componentDef),c,function(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(c)),u=this.componentDef.onPush?576:528,h={components:[],scheduler:Tr,clean:yo,playerHandler:null,flags:0},d=qi(0,null,null,1,0,null,null,null,null,null),f=Ri(null,d,h,u,null,null,o,a,s,i);let p,g;ut(f);try{const e=function(e,t,n,r,i,o){const s=n[1];n[20]=e;const a=Di(s,20,2,"#host",null),c=a.mergedAttrs=t.hostAttrs;null!==c&&(Eo(a,c,!0),null!==e&&(It(i,e,c),null!==a.classes&&di(i,e,a.classes),null!==a.styles&&hi(i,e,a.styles)));const l=r.createRenderer(e,t),u=Ri(n,$i(t),null,t.onPush?64:16,n[20],a,r,l,null,null);return s.firstCreatePass&&(zt(Ft(a,n),s,t.type),Xi(s,a),to(a,n.length,1)),ho(n,u),n[20]=u}(l,this.componentDef,f,o,a);if(l)if(n)It(a,l,["ng-version",fc.full]);else{const{attrs:e,classes:t}=function(e){const t=[],n=[];let r=1,i=2;for(;r<e.length;){let o=e[r];if("string"==typeof o)2===i?""!==o&&t.push(o,e[++r]):8===i&&n.push(o);else{if(!vi(i))break;i=o}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);e&&It(a,l,e),t&&t.length>0&&di(a,l,t.join(" "))}if(g=Ne(d,20),void 0!==t){const e=g.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=t[n];e.push(null!=r?Array.from(r):null)}}p=function(e,t,n,r,i){const o=n[1],s=function(e,t,n){const r=$e();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),no(e,r,t,Bi(e,t,1,null),n));const i=Yt(t,e,r.directiveStart,r);Ir(i,t);const o=ke(r,t);return o&&Ir(o,t),i}(o,n,t);if(r.components.push(s),e[8]=s,i&&i.forEach(e=>e(s,t)),t.contentQueries){const e=$e();t.contentQueries(1,s,e.directiveStart)}const a=$e();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(yt(a.index),Ki(n[1],a,0,a.directiveStart,a.directiveEnd,t),Ji(t,s)),s}(e,this.componentDef,f,h,[Vo]),Fi(d,f,null)}finally{gt()}return new nl(this.componentType,p,ic(g,f),f,g)}}class nl extends class{}{constructor(e,t,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=t,this.hostView=this.changeDetectorRef=new kc(r),this.componentType=e}get injector(){return new Xt(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const rl=new Map;class il extends zc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Jc(this);const n=le(e),r=e[Q]||null;r&&ra(r),this._bootstrapComponents=Ar(n.bootstrap),this._r3Injector=Mo(e,t,[{provide:zc,useValue:this},{provide:nc,useValue:this.componentFactoryResolver}],u(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Uo.THROW_IF_NOT_FOUND,n=k.Default){return e===Uo||e===zc||e===Oo?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class ol extends Hc{constructor(e){super(),this.moduleType=e,null!==le(e)&&function(e){const t=new Set;!function e(n){const r=le(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${u(t)} vs ${u(t.name)}`)}(i,rl.get(i),n),rl.set(i,n));const o=Ar(r.imports);for(const s of o)t.has(s)||(t.add(s),e(s))}(e)}(e)}create(e){return new il(this.moduleType,e)}}function sl(e,t,n){const r=Xe()+e,i=ze();return i[r]===Oi?Jo(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function al(e,t,n,r){return hl(ze(),Xe(),e,t,n,r)}function cl(e,t,n,r,i){return dl(ze(),Xe(),e,t,n,r,i)}function ll(e,t,n,r,i,o,s){return function(e,t,n,r,i,o,s,a,c){const l=t+n;return function(e,t,n,r,i,o){const s=es(e,t,n,r);return es(e,t+2,i,o)||s}(e,l,i,o,s,a)?Jo(e,l+4,c?r.call(c,i,o,s,a):r(i,o,s,a)):ul(e,l+4)}(ze(),Xe(),e,t,n,r,i,o,s)}function ul(e,t){const n=e[t];return n===Oi?void 0:n}function hl(e,t,n,r,i,o){const s=t+n;return Xo(e,s,i)?Jo(e,s+1,o?r.call(o,i):r(i)):ul(e,s+1)}function dl(e,t,n,r,i,o,s){const a=t+n;return es(e,a,i,o)?Jo(e,a+2,s?r.call(s,i,o):r(i,o)):ul(e,a+2)}function fl(e,t){const n=He();let r;const i=e+20;n.firstCreatePass?(r=function(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}throw new m("302",`The pipe '${e}' could not be found!`)}(t,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const o=r.factory||(r.factory=me(r.type)),s=M(cs);try{const e=Lt(!1),t=o();return Lt(e),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,ze(),i,t),t}finally{M(s)}}function pl(e,t,n){const r=e+20,i=ze(),o=Me(i,r);return vl(i,yl(i,r)?hl(i,Xe(),t,o.transform,n,o):o.transform(n))}function gl(e,t,n,r){const i=e+20,o=ze(),s=Me(o,i);return vl(o,yl(o,i)?dl(o,Xe(),t,s.transform,n,r,s):s.transform(n,r))}function ml(e,t,n,r,i){const o=e+20,s=ze(),a=Me(s,o);return vl(s,yl(s,o)?function(e,t,n,r,i,o,s,a){const c=t+n;return ts(e,c,i,o,s)?Jo(e,c+3,a?r.call(a,i,o,s):r(i,o,s)):ul(e,c+3)}(s,Xe(),t,a.transform,n,r,i,a):a.transform(n,r,i))}function yl(e,t){return e[1].data[t].pure}function vl(e,t){return Qo.isWrapped(t)&&(t=Qo.unwrap(t),e[et()]=Oi),t}function bl(e){return t=>{setTimeout(e,void 0,t)}}const _l=class extends r.a{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var r,o,s;let a=e,c=t||(()=>null),l=n;if(e&&"object"==typeof e){const t=e;a=null===(r=t.next)||void 0===r?void 0:r.bind(t),c=null===(o=t.error)||void 0===o?void 0:o.bind(t),l=null===(s=t.complete)||void 0===s?void 0:s.bind(t)}this.__isAsync&&(c=bl(c),a&&(a=bl(a)),l&&(l=bl(l)));const u=super.subscribe({next:a,error:c,complete:l});return e instanceof i.a&&e.add(u),u}};function wl(){return this._results[Zo()]()}class Cl{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Zo(),n=Cl.prototype;n[t]||(n[t]=wl)}get changes(){return this._changes||(this._changes=new _l)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const n=cn(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],o=t[r];if(n&&(i=n(i),o=n(o)),o!==i)return!1}return!0}(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class El{constructor(e){this.queryList=e,this.matches=null}clone(){return new El(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ol{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let e=0;e<n;e++){const n=t.getByIndex(e);r.push(this.queries[n.indexInDeclarationView].clone())}return new Ol(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Fl(e,t).matches&&this.queries[t].setDirty()}}class Sl{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class Pl{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,i=this.getByIndex(n).embeddedTView(e,r);i&&(i.indexInDeclarationView=n,null!==t?t.push(i):t=[i])}return null!==t?new Pl(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Il{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Il(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];this.matchTNodeWithReadOption(e,t,Tl(t,i)),this.matchTNodeWithReadOption(e,t,Qt(t,e,i,!1,!1))}else n===Fc?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Qt(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===sc||r===$c||r===Fc&&4&t.type)this.addMatch(t.index,-2);else{const n=Qt(t,e,r,!1,!1);null!==n&&this.addMatch(t.index,n)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Tl(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function Al(e,t,n,r){return-1===n?function(e,t){return 11&e.type?ic(e,t):4&e.type?Vc(e,t):null}(t,e):-2===n?function(e,t,n){return n===sc?ic(t,e):n===Fc?Vc(t,e):n===$c?Yc(t,e):void 0}(e,t,r):Yt(e,e[1],n,t)}function kl(e,t,n,r){const i=t[19].queries[r];if(null===i.matches){const r=e.data,o=n.matches,s=[];for(let e=0;e<o.length;e+=2){const i=o[e];s.push(i<0?null:Al(t,r[i],o[e+1],n.metadata.read))}i.matches=s}return i.matches}function Nl(e,t,n,r){const i=e.queries.getByIndex(n),o=i.matches;if(null!==o){const s=kl(e,t,i,n);for(let e=0;e<o.length;e+=2){const n=o[e];if(n>0)r.push(s[e/2]);else{const i=o[e+1],s=t[-n];for(let e=10;e<s.length;e++){const t=s[e];t[17]===t[3]&&Nl(t[1],t,i,r)}if(null!==s[9]){const e=s[9];for(let t=0;t<e.length;t++){const n=e[t];Nl(n[1],n,i,r)}}}}}return r}function Ml(e){const t=ze(),n=He(),r=st();at(r+1);const i=Fl(n,r);if(e.dirty&&De(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{const o=i.crossesNgTemplate?Nl(n,t,r,[]):kl(n,t,i,r);e.reset(o,ac),e.notifyOnChanges()}return!0}return!1}function xl(e,t,n){const r=He();r.firstCreatePass&&(Bl(r,new Sl(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),Ll(r,ze(),t)}function Rl(e,t,n,r){const i=He();if(i.firstCreatePass){const o=$e();Bl(i,new Sl(t,n,r),o.index),function(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(i,e),2==(2&n)&&(i.staticContentQueries=!0)}Ll(i,ze(),n)}function Dl(){return e=ze(),t=st(),e[19].queries[t].queryList;var e,t}function Ll(e,t,n){const r=new Cl(4==(4&n));Wi(e,t,r,r.destroy),null===t[19]&&(t[19]=new Ol),t[19].queries.push(new El(r))}function Bl(e,t,n){null===e.queries&&(e.queries=new Pl),e.queries.track(new Il(t,n))}function Fl(e,t){return e.queries.getByIndex(t)}function jl(e,t){return Vc(e,t)}function Ul(e=k.Default){const t=xc(!0);if(null!=t||e&k.Optional)return t;b("ChangeDetectorRef")}const Vl=new on("Application Initializer");let zl=(()=>{class e{constructor(e){this.appInits=e,this.resolve=rc,this.reject=rc,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const t=this.appInits[n]();ys(t)&&e.push(t)}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(Cn(Vl,8))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();const Hl=new on("AppId"),Gl={provide:Hl,useFactory:function(){return`${$l()}${$l()}${$l()}`},deps:[]};function $l(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ql=new on("Platform Initializer"),Wl=new on("Platform ID"),Zl=new on("appBootstrapListener");let Ql=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();const Yl=new on("LocaleId"),Kl=new on("DefaultCurrencyCode");class Jl{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const Xl=function(e){return new ol(e)},eu=Xl,tu=function(e){return Promise.resolve(Xl(e))},nu=function(e){const t=Xl(e),n=Ar(le(e).declarations).reduce((e,t)=>{const n=ce(t);return n&&e.push(new tl(n)),e},[]);return new Jl(t,n)},ru=nu,iu=function(e){return Promise.resolve(nu(e))};let ou=(()=>{class e{constructor(){this.compileModuleSync=eu,this.compileModuleAsync=tu,this.compileModuleAndAllComponentsSync=ru,this.compileModuleAndAllComponentsAsync=iu}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();const su=(()=>Promise.resolve(0))();function au(e){"undefined"==typeof Zone?su.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class cu{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _l(!1),this.onMicrotaskEmpty=new _l(!1),this.onStable=new _l(!1),this.onError=new _l(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=!n&&t,this.shouldCoalesceRunChangeDetection=n,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let e=V.requestAnimationFrame,t=V.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(V,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,hu(e),uu(e)},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),hu(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,s,a)=>{try{return du(e),n.invokeTask(i,o,s,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),fu(e)}},onInvoke:(n,r,i,o,s,a,c)=>{try{return du(e),n.invoke(i,o,s,a,c)}finally{e.shouldCoalesceRunChangeDetection&&t(),fu(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,hu(e),uu(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!cu.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(cu.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,lu,rc,rc);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const lu={};function uu(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function hu(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function du(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function fu(e){e._nesting--,uu(e)}class pu{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _l,this.onMicrotaskEmpty=new _l,this.onStable=new _l,this.onError=new _l}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}let gu=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{cu.assertNotInAngularZone(),au(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())au(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,n){let r=-1;t&&t>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==r),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}whenStable(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,n){return[]}}return e.\u0275fac=function(t){return new(t||e)(Cn(cu))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})(),mu=(()=>{class e{constructor(){this._applications=new Map,_u.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return _u.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();class yu{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}function vu(e){_u=e}let bu,_u=new yu,wu=!0,Cu=!1;function Eu(){return Cu=!0,wu}function Ou(){if(Cu)throw new Error("Cannot enable prod mode after platform setup.");wu=!1}const Su=new on("AllowMultipleToken");class Pu{constructor(e,t){this.name=e,this.token=t}}function Iu(e,t,n=[]){const r=`Platform: ${t}`,i=new on(r);return(t=[])=>{let o=Tu();if(!o||o.injector.get(Su,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{const e=n.concat(t).concat({provide:i,useValue:!0},{provide:Po,useValue:"platform"});!function(e){if(bu&&!bu.destroyed&&!bu.injector.get(Su,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");bu=e.get(Au);const t=e.get(ql,null);t&&t.forEach(e=>e())}(Uo.create({providers:e,name:r}))}return function(e){const t=Tu();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function Tu(){return bu&&!bu.destroyed?bu:null}let Au=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const n=function(e,t){let n;return n="noop"===e?new pu:("zone.js"===e?void 0:e)||new cu({enableLongStackTrace:Eu(),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),r=[{provide:cu,useValue:n}];return n.run(()=>{const t=Uo.create({providers:r,parent:this.injector,name:e.moduleType.name}),i=e.create(t),o=i.injector.get(Or,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const e=n.onError.subscribe({next:e=>{o.handleError(e)}});i.onDestroy(()=>{Mu(this._modules,i),e.unsubscribe()})}),function(e,t,n){try{const r=n();return ys(r)?r.catch(n=>{throw t.runOutsideAngular(()=>e.handleError(n)),n}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(o,n,()=>{const e=i.injector.get(zl);return e.runInitializers(),e.donePromise.then(()=>(ra(i.injector.get(Yl,"en-US")||"en-US"),this._moduleDoBootstrap(i),i))})})}bootstrapModule(e,t=[]){const n=ku({},t);return function(e,t,n){const r=new ol(n);return Promise.resolve(r)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,n))}_moduleDoBootstrap(e){const t=e.injector.get(Nu);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${u(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(Cn(Uo))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();function ku(e,t){return Array.isArray(t)?t.reduce(ku,e):Object.assign(Object.assign({},e),t)}let Nu=(()=>{class e{constructor(e,t,n,r,i){this._zone=e,this._injector=t,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const c=new o.a(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),l=new o.a(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{cu.assertNotInAngularZone(),au(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{cu.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),n.unsubscribe()}});this.isStable=Object(s.a)(c,l.pipe(Object(a.a)()))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=e instanceof ec?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(zc),i=n.create(Uo.NULL,[],t||n.selector,r),o=i.location.nativeElement,s=i.injector.get(gu,null),a=s&&i.injector.get(mu);return s&&a&&a.registerApplication(o,s),i.onDestroy(()=>{this.detachView(i.hostView),Mu(this.components,i),a&&a.unregisterApplication(o)}),this._loadComponent(i),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Mu(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Zl,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(Cn(cu),Cn(Uo),Cn(Or),Cn(nc),Cn(zl))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();function Mu(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class xu{}class Ru{}const Du={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Lu=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||Du}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,r]=e.split("#");return void 0===r&&(r="default"),n("zn8P")(t).then(e=>e[r]).then(e=>Bu(e,t,r)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,r]=e.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[r+i]).then(e=>Bu(e,t,r))}}return e.\u0275fac=function(t){return new(t||e)(Cn(ou),Cn(Ru,8))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e})();function Bu(e,t,n){if(!e)throw new Error(`Cannot find '${n}' in '${t}'`);return e}const Fu=function(e){return null},ju=Iu(null,"core",[{provide:Wl,useValue:"unknown"},{provide:Au,deps:[Uo]},{provide:mu,deps:[]},{provide:Ql,deps:[]}]),Uu=[{provide:Nu,useClass:Nu,deps:[cu,Uo,Or,nc,zl]},{provide:el,deps:[cu],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:zl,useClass:zl,deps:[[new Pn,Vl]]},{provide:ou,useClass:ou,deps:[]},Gl,{provide:Sc,useFactory:function(){return Dc},deps:[]},{provide:Ic,useFactory:function(){return Lc},deps:[]},{provide:Yl,useFactory:function(e){return ra(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new Sn(Yl),new Pn,new In]]},{provide:Kl,useValue:"USD"}];let Vu=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(Cn(Nu))},e.\u0275mod=re({type:e}),e.\u0275inj=C({providers:Uu}),e})()},gRHU:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("2fFW"),i=n("NJ4a");const o={closed:!0,next(e){},error(e){if(r.a.useDeprecatedSynchronousErrorHandling)throw e;Object(i.a)(e)},complete(){}}},jZKg:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("HDdC"),i=n("quSY");function o(e,t){return new r.a(n=>{const r=new i.a;let o=0;return r.add(t.schedule(function(){o!==e.length?(n.next(e[o++]),n.closed||r.add(this.schedule())):n.complete()})),r})}},kJWO:function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")()},lJxs:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("7o/Q");function i(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(e,t))}}class o{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new s(e,this.project,this.thisArg))}}class s extends r.a{constructor(e,t,n){super(e),this.project=t,this.count=0,this.thisArg=n||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}},mrSG:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return a}),n.d(t,"g",function(){return c}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return u});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})}function a(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}},n6bG:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,"a",function(){return r})},ngJS:function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r=e=>t=>{for(let n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}},pxpQ:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n("7o/Q"),i=n("EY2u"),o=n("LRne"),s=n("HDdC");let a=(()=>{class e{constructor(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}accept(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}toObservable(){switch(this.kind){case"N":return Object(o.a)(this.value);case"E":return e=this.error,new s.a(t=>t.error(e));case"C":return Object(i.b)()}var e;throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}static createError(t){return new e("E",void 0,t)}static createComplete(){return e.completeNotification}}return e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e})();function c(e,t=0){return function(n){return n.lift(new l(e,t))}}class l{constructor(e,t=0){this.scheduler=e,this.delay=t}call(e,t){return t.subscribe(new u(e,this.scheduler,this.delay))}}class u extends r.a{constructor(e,t,n=0){super(e),this.scheduler=t,this.delay=n}static dispatch(e){const{notification:t,destination:n}=e;t.observe(n),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(u.dispatch,this.delay,new h(e,this.destination)))}_next(e){this.scheduleMessage(a.createNext(e))}_error(e){this.scheduleMessage(a.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(a.createComplete()),this.unsubscribe()}}class h{constructor(e,t){this.notification=e,this.destination=t}}},"q/0M":function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var i;n.d(t,"a",function(){return s}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return f});var o=[],s=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}({}),a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},c=s.INFO,l=((i={})[s.DEBUG]="log",i[s.VERBOSE]="log",i[s.INFO]="info",i[s.WARN]="warn",i[s.ERROR]="error",i),u=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString(),s=l[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[s].apply(console,r(["["+o+"]  "+e.name+":"],n))}},h=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=u,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in s))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.DEBUG],e)),this._logHandler.apply(this,r([this,s.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.VERBOSE],e)),this._logHandler.apply(this,r([this,s.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.INFO],e)),this._logHandler.apply(this,r([this,s.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.WARN],e)),this._logHandler.apply(this,r([this,s.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.ERROR],e)),this._logHandler.apply(this,r([this,s.ERROR],e))},e}();function d(e){o.forEach(function(t){t.setLogLevel(e)})}function f(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=a[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(function(e){return e}).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:s[n].toLowerCase(),message:a,args:i,type:t.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qOnz:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return I}),n.d(t,"c",function(){return U}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"g",function(){return c}),n.d(t,"h",function(){return D}),n.d(t,"i",function(){return p}),n.d(t,"j",function(){return V}),n.d(t,"k",function(){return h}),n.d(t,"l",function(){return d}),n.d(t,"m",function(){return $}),n.d(t,"n",function(){return Y}),n.d(t,"o",function(){return g}),n.d(t,"p",function(){return R}),n.d(t,"q",function(){return v}),n.d(t,"r",function(){return b}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return B}),n.d(t,"u",function(){return C}),n.d(t,"v",function(){return m}),n.d(t,"w",function(){return y}),n.d(t,"x",function(){return O}),n.d(t,"y",function(){return _}),n.d(t,"z",function(){return S}),n.d(t,"A",function(){return E}),n.d(t,"B",function(){return x}),n.d(t,"C",function(){return k}),n.d(t,"D",function(){return F}),n.d(t,"E",function(){return j}),n.d(t,"F",function(){return L}),n.d(t,"G",function(){return Q}),n.d(t,"H",function(){return Z}),n.d(t,"I",function(){return N}),n.d(t,"J",function(){return G}),n.d(t,"K",function(){return q}),n.d(t,"L",function(){return W});var r=n("mrSG"),i=function(e,t){if(!e)throw o(t)},o=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],s=i+1<e.length,a=s?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,u=(15&a)<<2|l>>6,h=63&l;c||(h=64,s||(u=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[u],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{o=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,c=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==c)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(s<<4&240|a>>2),64!==c&&r.push(a<<6&192|c))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},c=function(e){var t=s(e);return a.encodeByteArray(t,!0)},l=function(e){return c(e).replace(/\./g,"")},u=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(e){return d(void 0,e)}function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=d(e[n],t[n]));return e}var f=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}();function p(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",i=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=Object(r.a)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function m(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function y(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function v(){return"object"==typeof self&&self.self===self}function b(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function w(){return g().indexOf("Electron/")>=0}function C(){var e=g();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function E(){return g().indexOf("MSAppHost/")>=0}function O(){return!1}function S(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var P=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,I.prototype.create),o}return Object(r.c)(t,e),t}(Error),I=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],s=o?T(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",c=new P(i,a,r);return c},e}();function T(e,t){return e.replace(A,function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"})}var A=/\{\$([^}]+)}/g;function k(e){return JSON.parse(e)}function N(e){return JSON.stringify(e)}var M=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=k(u(o[0])||""),n=k(u(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(s){}return{header:t,claims:n,data:r,signature:i}},x=function(e){var t=M(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},R=function(e){var t=M(e).claims;return"object"==typeof t&&!0===t.admin};function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function B(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function F(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function j(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""}var U=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,s=this.chain_[0],a=this.chain_[1],c=this.chain_[2],l=this.chain_[3],u=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=l^a&(c^l),o=1518500249):(i=a^c^l,o=1859775393):r<60?(i=a&c|l&(a|c),o=2400959708):(i=a^c^l,o=3395469782);var h=(s<<5|s>>>27)+i+u+o+n[r]&4294967295;u=l,l=c,c=4294967295&(a<<30|a>>>2),a=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function V(e,t){var n=new z(e,t);return n.subscribe.bind(n)}var z=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=H),void 0===r.error&&(r.error=H),void 0===r.complete&&(r.complete=H);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function H(){}var G=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function $(e,t){return e+" failed: "+t+" argument "}function q(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error($(e,t)+"must be a valid function.")}function W(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error($(e,t)+"must be a valid context object.")}var Z=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319){var s=o-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(s<<10)+(e.charCodeAt(r)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},Q=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Y(e){return e&&e._delegate?e._delegate:e}},qgXg:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n("3N8a");class i extends r.a{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(e,t,n):e.flush(this)}}var o=n("IjjT");class s extends o.a{}const a=new s(i),c=a},quSY:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("DH7j"),i=n("XoHu"),o=n("n6bG");const s=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();let a=(()=>{class e{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:a,_unsubscribe:l,_subscriptions:u}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(let e=0;e<n.length;++e)n[e].remove(this);if(Object(o.a)(l)){a&&(this._unsubscribe=void 0);try{l.call(this)}catch(h){t=h instanceof s?c(h.errors):[h]}}if(Object(r.a)(u)){let e=-1,n=u.length;for(;++e<n;){const n=u[e];if(Object(i.a)(n))try{n.unsubscribe()}catch(h){t=t||[],h instanceof s?t=t.concat(c(h.errors)):t.push(h)}}}if(t)throw new s(t)}add(t){let n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){const t=n;n=new e,n._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof e){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(e){const t=this._subscriptions;if(t){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}var t;return e.EMPTY=((t=new e).closed=!0,t),e})();function c(e){return e.reduce((e,t)=>e.concat(t instanceof s?t.errors:t),[])}},spgP:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return P}),n.d(t,"b",function(){return b}),n.d(t,"c",function(){return v}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return y}),n.d(t,"f",function(){return O}),n.d(t,"g",function(){return w}),n.d(t,"h",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"j",function(){return C});var r=n("qgXg"),i=n("D0XW"),o=n("vkgz"),s=n("tf+s"),a=n("pxpQ"),c=n("fXoL"),l=n("Jgta");function u(){}class h{constructor(e,t=r.b){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const r=this.zone;return this.delegate.schedule(function(t){r.runGuarded(()=>{e.apply(this,[t])})},t,n)}}class d{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",u,{},u,u)),t.pipe(Object(o.a)({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}class f{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new h(Zone.current)),this.insideAngular=e.run(()=>new h(Zone.current,i.a))}}function p(e){return function(t){return(t=t.lift(new d(e.ngZone))).pipe(Object(s.a)(e.outsideAngular),Object(a.b)(e.insideAngular))}}const g=["ngOnDestroy"],m=(e,t,n,r={})=>new Proxy(e,{get:(i,o)=>n.runOutsideAngular(()=>{var i;if(e[o])return(null===(i=null==r?void 0:r.spy)||void 0===i?void 0:i.get)&&r.spy.get(o,e[o]),e[o];if(g.indexOf(o)>-1)return()=>{};const s=t.toPromise().then(e=>{const t=e&&e[o];return"function"==typeof t?t.bind(e):t&&t.then?t.then(e=>n.run(()=>e)):n.run(()=>t)});return new Proxy(()=>{},{get:(e,t)=>s[t],apply:(e,t,n)=>s.then(e=>{var t;const i=e&&e(...n);return(null===(t=null==r?void 0:r.spy)||void 0===t?void 0:t.apply)&&r.spy.apply(o,n,i),i})})})}),y=(e,t)=>{t.forEach(t=>{Object.getOwnPropertyNames(t.prototype||t).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype||t,n))})})},v=new c.r("angularfire2.app.options"),b=new c.r("angularfire2.app.nameOrConfig"),_=new c.P("6.1.5");function w(t,n,r){const i="object"==typeof r&&r||{};i.name=i.name||"string"==typeof r&&r||"[DEFAULT]";const o=l.a.apps.filter(e=>e&&e.name===i.name)[0]||n.runOutsideAngular(()=>l.a.initializeApp(t,i));try{JSON.stringify(t)!==JSON.stringify(o.options)&&E("error",`${o.name} Firebase App already initialized with different options${e.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(s){}return o}const C=()=>{E("warn","You may need to import 'firebase/auth' manually in your component rather than rely on AngularFireAuth's dynamic import, when using the emulator suite https://github.com/angular/angularfire/issues/2656")},E=(e,...t)=>{Object(c.V)()&&"undefined"!=typeof console&&console[e](...t)};function O(t,n,r,i,o){const[s,...a]=globalThis.\u0275AngularfireInstanceCache.get(t)||[];if(s){try{o.some((e,t)=>{const n=a[t];return e&&"object"==typeof e?JSON.stringify(e)!==JSON.stringify(n):e!==n})&&E("error",`${n} was already initialized on the ${r.name} Firebase App instance with different settings.${e.hot?" You may need to reload as Firebase is not HMR aware.":""}`)}catch(c){}return s}{const e=i();return globalThis.\u0275AngularfireInstanceCache.set(t,[e,...o]),e}}globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=new Map);const S={provide:class{},useFactory:w,deps:[v,c.A,[new c.B,b]]};let P=(()=>{class e{constructor(e){l.a.registerVersion("angularfire",_.full,e.toString()),l.a.registerVersion("angular",c.O.full)}static initializeApp(t,n){return{ngModule:e,providers:[{provide:v,useValue:t},{provide:b,useValue:n}]}}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(c.C))},e.\u0275mod=c.Jb({type:e}),e.\u0275inj=c.Ib({providers:[S]}),e})()}).call(this,n("3UD+")(e))},"tf+s":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n("HDdC");let i=1;const o=(()=>Promise.resolve())(),s={};function a(e){return e in s&&(delete s[e],!0)}const c={setImmediate(e){const t=i++;return s[t]=!0,o.then(()=>a(t)&&e()),t},clearImmediate(e){a(e)}};var l=n("3N8a");class u extends l.a{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e.scheduled||(e.scheduled=c.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(c.clearImmediate(t),e.scheduled=void 0)}}var h=n("IjjT");class d extends h.a{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let n,r=-1,i=t.length;e=e||t.shift();do{if(n=e.execute(e.state,e.delay))break}while(++r<i&&(e=t.shift()));if(this.active=!1,n){for(;++r<i&&(e=t.shift());)e.unsubscribe();throw n}}}const f=new d(u);var p=n("DH7j");class g extends r.a{constructor(e,t=0,n=f){var r;super(),this.source=e,this.delayTime=t,this.scheduler=n,r=t,(Object(p.a)(r)||!(r-parseFloat(r)+1>=0)||t<0)&&(this.delayTime=0),n&&"function"==typeof n.schedule||(this.scheduler=f)}static create(e,t=0,n=f){return new g(e,t,n)}static dispatch(e){const{source:t,subscriber:n}=e;return this.add(t.subscribe(n))}_subscribe(e){return this.scheduler.schedule(g.dispatch,this.delayTime,{source:this.source,subscriber:e})}}function m(e,t=0){return function(n){return n.lift(new y(e,t))}}class y{constructor(e,t){this.scheduler=e,this.delay=t}call(e,t){return new g(t,this.delay,this.scheduler).subscribe(e)}}},vkgz:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("7o/Q");function i(){}var o=n("n6bG");function s(e,t,n){return function(r){return r.lift(new a(e,t,n))}}class a{constructor(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}call(e,t){return t.subscribe(new c(e,this.nextOrObserver,this.error,this.complete))}}class c extends r.a{constructor(e,t,n,r){super(e),this._tapNext=i,this._tapError=i,this._tapComplete=i,this._tapError=n||i,this._tapComplete=r||i,Object(o.a)(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||i,this._tapError=t.error||i,this._tapComplete=t.complete||i)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}},w1tV:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("EQ5u"),i=n("x+ZX"),o=n("XNiG");function s(){return new o.a}function a(){return e=>{return Object(i.a)()((t=s,function(e){let n;n="function"==typeof t?t:function(){return t};const i=Object.create(e,r.b);return i.source=e,i.subjectFactory=n,i})(e));var t}}},"x+ZX":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("7o/Q");function i(){return function(e){return e.lift(new o(e))}}class o{constructor(e){this.connectable=e}call(e,t){const{connectable:n}=this;n._refCount++;const r=new s(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class s extends r.a{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:n}=this,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}},yCtX:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("HDdC"),i=n("ngJS"),o=n("jZKg");function s(e,t){return t?Object(o.a)(e,t):new r.a(Object(i.a)(e))}},"z+Ro":function(e,t,n){"use strict";function r(e){return e&&"function"==typeof e.schedule}n.d(t,"a",function(){return r})},zIRd:function(e,t,n){"use strict";var r,i,o=n("mrSG"),s=n("qOnz"),a=n("/6Yf"),c=n("q/0M"),l=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),u=new s.b("app","Firebase",l),h=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/app-check"]="fire-app-check",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),d=new c.b("@firebase/app"),f=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Object(s.k)(e),this.container=new a.b(t.name),this._addComponent(new a.a("app",function(){return r},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(e){return r._addComponent(e)})}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,t){var n;void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t="[DEFAULT]"),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){d.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},e}();f.prototype.name&&f.prototype.options||f.prototype.delete||console.log("dc");var p=function e(){var t=function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;if("string"!=typeof a||!a)throw u.create("bad-app-name",{appName:String(a)});if(Object(s.h)(t,a))throw u.create("duplicate-app",{appName:a});var c=new e(n,o,r);return t[a]=c,c},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=h[e])&&void 0!==r?r:e;n&&(i+="-"+n);var s=i.match(/\s|\//),c=t.match(/\s|\//);if(s||c){var l=['Unable to register library "'+i+'" with version "'+t+'":'];return s&&l.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&c&&l.push("and"),c&&l.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void d.warn(l.join(" "))}o(new a.a(i+"-version",function(){return{library:i,version:t}},"VERSION"))},setLogLevel:c.c,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw u.create("invalid-log-argument");Object(c.d)(e,t)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){return"serverAuth"===t?null:t}}};function i(e){if(e=e||"[DEFAULT]",!Object(s.h)(t,e))throw u.create("no-app",{appName:e});return t[e]}function o(o){var a=o.name;if(n.has(a))return d.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===o.type?r[a]:null;if(n.set(a,o),"PUBLIC"===o.type){var c=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[a])throw u.create("invalid-app-argument",{appName:a});return e[a]()};void 0!==o.serviceProps&&Object(s.l)(c,o.serviceProps),r[a]=c,e.prototype[a]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,a).apply(this,o.multipleInstances?e:[])}}for(var l=0,h=Object.keys(t);l<h.length;l++)t[h[l]]._addComponent(o);return"PUBLIC"===o.type?r[a]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map(function(e){return t[e]})}}),i.App=e,r}(f);return t.INTERNAL=Object(o.a)(Object(o.a)({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Object(s.l)(t,e)},createSubscribe:s.j,ErrorFactory:s.b,deepExtend:s.l}),t}(),g=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null}).filter(function(e){return e}).join(" ")},e}();if(Object(s.q)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var y=p.initializeApp;p.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(s.w)()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),y.apply(void 0,e)};var v=p;!function(e,t){e.INTERNAL.registerComponent(new a.a("platform-logger",function(e){return new g(e)},"PRIVATE")),e.registerVersion("@firebase/app","0.6.30",void 0),e.registerVersion("fire-js","")}(v),t.a=v},zUnb:function(e,t,n){"use strict";n.r(t);var r=n("fXoL");let i=null;function o(){return i}const s=new r.r("DocumentToken");let a=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(r.Hb)({factory:c,token:e,providedIn:"platform"}),e})();function c(){return Object(r.Zb)(u)}const l=new r.r("Location Initialized");let u=(()=>{class e extends a{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=o().getLocation(),this._history=o().getHistory()}getBaseHrefFromDOM(){return o().getBaseHref(this._doc)}onPopState(e){o().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}onHashChange(e){o().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,n){h()?this._history.pushState(e,t,n):this.location.hash=n}replaceState(e,t,n){h()?this._history.replaceState(e,t,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s))},e.\u0275prov=Object(r.Hb)({factory:d,token:e,providedIn:"platform"}),e})();function h(){return!!window.history.pushState}function d(){return new u(Object(r.Zb)(s))}function f(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function p(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function g(e){return e&&"?"!==e[0]?"?"+e:e}let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(r.Hb)({factory:y,token:e,providedIn:"root"}),e})();function y(e){const t=Object(r.Zb)(s).location;return new b(Object(r.Zb)(a),t&&t.origin||"")}const v=new r.r("appBaseHref");let b=(()=>{class e extends m{constructor(e,t){if(super(),this._platformLocation=e,null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}onPopState(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return f(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+g(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?`${t}${n}`:t}pushState(e,t,n,r){const i=this.prepareExternalUrl(n+g(r));this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){const i=this.prepareExternalUrl(n+g(r));this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(a),r.Zb(v,8))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),_=(()=>{class e extends m{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",null!=t&&(this._baseHref=t)}onPopState(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=f(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,n,r){let i=this.prepareExternalUrl(n+g(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){let i=this.prepareExternalUrl(n+g(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(a),r.Zb(v,8))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),w=(()=>{class e{constructor(e,t){this._subject=new r.n,this._urlChangeListeners=[],this._platformStrategy=e;const n=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=p(E(n)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+g(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,E(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",n=null){this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+g(t)),n)}replaceState(e,t="",n=null){this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+g(t)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)}))}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(n=>n(e,t))}subscribe(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(m),r.Zb(a))},e.normalizeQueryParams=g,e.joinWithSlash=f,e.stripTrailingSlash=p,e.\u0275prov=Object(r.Hb)({factory:C,token:e,providedIn:"root"}),e})();function C(){return new w(Object(r.Zb)(m),Object(r.Zb)(a))}function E(e){return e.replace(/\/index.html$/,"")}var O=function(e){return e[e.Decimal=0]="Decimal",e[e.Percent=1]="Percent",e[e.Currency=2]="Currency",e[e.Scientific=3]="Scientific",e}({}),S=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Few=3]="Few",e[e.Many=4]="Many",e[e.Other=5]="Other",e}({}),P=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}({}),I=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}({}),T=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}({}),A=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e[1/0]=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}({});function k(e,t){return L(Object(r.kb)(e)[r.ab.DateFormat],t)}function N(e,t){return L(Object(r.kb)(e)[r.ab.TimeFormat],t)}function M(e,t){return L(Object(r.kb)(e)[r.ab.DateTimeFormat],t)}function x(e,t){const n=Object(r.kb)(e),i=n[r.ab.NumberSymbols][t];if(void 0===i){if(t===A.CurrencyDecimal)return n[r.ab.NumberSymbols][A.Decimal];if(t===A.CurrencyGroup)return n[r.ab.NumberSymbols][A.Group]}return i}const R=r.nb;function D(e){if(!e[r.ab.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[r.ab.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function L(e,t){for(let n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function B(e){const[t,n]=e.split(":");return{hours:+t,minutes:+n}}const F=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,j={},U=/((?:[^GyYMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var V=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}({}),z=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}({}),H=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}({});function G(e,t,n,r){let i=function(e){if(re(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[t,n=1,r=1]=e.split("-").map(e=>+e);return $(t,n-1,r)}const t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let n;if(n=e.match(F))return function(e){const t=new Date(0);let n=0,r=0;const i=e[8]?t.setUTCFullYear:t.setFullYear,o=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const s=Number(e[4]||0)-n,a=Number(e[5]||0)-r,c=Number(e[6]||0),l=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return o.call(t,s,a,c,l),t}(n)}const t=new Date(e);if(!re(t))throw new Error(`Unable to convert "${e}" into a date`);return t}(e);t=q(n,t)||t;let o,s=[];for(;t;){if(o=U.exec(t),!o){s.push(t);break}{s=s.concat(o.slice(1));const e=s.pop();if(!e)break;t=e}}let a=i.getTimezoneOffset();r&&(a=ne(r,a),i=function(e,t,n){const r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(ne(t,r)-r))}(i,r));let c="";return s.forEach(e=>{const t=function(e){if(te[e])return te[e];let t;switch(e){case"G":case"GG":case"GGG":t=Y(H.Eras,I.Abbreviated);break;case"GGGG":t=Y(H.Eras,I.Wide);break;case"GGGGG":t=Y(H.Eras,I.Narrow);break;case"y":t=Q(z.FullYear,1,0,!1,!0);break;case"yy":t=Q(z.FullYear,2,0,!0,!0);break;case"yyy":t=Q(z.FullYear,3,0,!1,!0);break;case"yyyy":t=Q(z.FullYear,4,0,!1,!0);break;case"Y":t=ee(1);break;case"YY":t=ee(2,!0);break;case"YYY":t=ee(3);break;case"YYYY":t=ee(4);break;case"M":case"L":t=Q(z.Month,1,1);break;case"MM":case"LL":t=Q(z.Month,2,1);break;case"MMM":t=Y(H.Months,I.Abbreviated);break;case"MMMM":t=Y(H.Months,I.Wide);break;case"MMMMM":t=Y(H.Months,I.Narrow);break;case"LLL":t=Y(H.Months,I.Abbreviated,P.Standalone);break;case"LLLL":t=Y(H.Months,I.Wide,P.Standalone);break;case"LLLLL":t=Y(H.Months,I.Narrow,P.Standalone);break;case"w":t=X(1);break;case"ww":t=X(2);break;case"W":t=X(1,!0);break;case"d":t=Q(z.Date,1);break;case"dd":t=Q(z.Date,2);break;case"E":case"EE":case"EEE":t=Y(H.Days,I.Abbreviated);break;case"EEEE":t=Y(H.Days,I.Wide);break;case"EEEEE":t=Y(H.Days,I.Narrow);break;case"EEEEEE":t=Y(H.Days,I.Short);break;case"a":case"aa":case"aaa":t=Y(H.DayPeriods,I.Abbreviated);break;case"aaaa":t=Y(H.DayPeriods,I.Wide);break;case"aaaaa":t=Y(H.DayPeriods,I.Narrow);break;case"b":case"bb":case"bbb":t=Y(H.DayPeriods,I.Abbreviated,P.Standalone,!0);break;case"bbbb":t=Y(H.DayPeriods,I.Wide,P.Standalone,!0);break;case"bbbbb":t=Y(H.DayPeriods,I.Narrow,P.Standalone,!0);break;case"B":case"BB":case"BBB":t=Y(H.DayPeriods,I.Abbreviated,P.Format,!0);break;case"BBBB":t=Y(H.DayPeriods,I.Wide,P.Format,!0);break;case"BBBBB":t=Y(H.DayPeriods,I.Narrow,P.Format,!0);break;case"h":t=Q(z.Hours,1,-12);break;case"hh":t=Q(z.Hours,2,-12);break;case"H":t=Q(z.Hours,1);break;case"HH":t=Q(z.Hours,2);break;case"m":t=Q(z.Minutes,1);break;case"mm":t=Q(z.Minutes,2);break;case"s":t=Q(z.Seconds,1);break;case"ss":t=Q(z.Seconds,2);break;case"S":t=Q(z.FractionalSeconds,1);break;case"SS":t=Q(z.FractionalSeconds,2);break;case"SSS":t=Q(z.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=K(V.Short);break;case"ZZZZZ":t=K(V.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=K(V.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=K(V.Long);break;default:return null}return te[e]=t,t}(e);c+=t?t(i,n,a):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function $(e,t,n){const r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function q(e,t){const n=function(e){return Object(r.kb)(e)[r.ab.LocaleId]}(e);if(j[n]=j[n]||{},j[n][t])return j[n][t];let i="";switch(t){case"shortDate":i=k(e,T.Short);break;case"mediumDate":i=k(e,T.Medium);break;case"longDate":i=k(e,T.Long);break;case"fullDate":i=k(e,T.Full);break;case"shortTime":i=N(e,T.Short);break;case"mediumTime":i=N(e,T.Medium);break;case"longTime":i=N(e,T.Long);break;case"fullTime":i=N(e,T.Full);break;case"short":const t=q(e,"shortTime"),n=q(e,"shortDate");i=W(M(e,T.Short),[t,n]);break;case"medium":const r=q(e,"mediumTime"),o=q(e,"mediumDate");i=W(M(e,T.Medium),[r,o]);break;case"long":const s=q(e,"longTime"),a=q(e,"longDate");i=W(M(e,T.Long),[s,a]);break;case"full":const c=q(e,"fullTime"),l=q(e,"fullDate");i=W(M(e,T.Full),[c,l])}return i&&(j[n][t]=i),i}function W(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function Z(e,t,n="-",r,i){let o="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,o=n));let s=String(e);for(;s.length<t;)s="0"+s;return r&&(s=s.substr(s.length-t)),o+s}function Q(e,t,n=0,r=!1,i=!1){return function(o,s){let a=function(e,t){switch(e){case z.FullYear:return t.getFullYear();case z.Month:return t.getMonth();case z.Date:return t.getDate();case z.Hours:return t.getHours();case z.Minutes:return t.getMinutes();case z.Seconds:return t.getSeconds();case z.FractionalSeconds:return t.getMilliseconds();case z.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,o);if((n>0||a>-n)&&(a+=n),e===z.Hours)0===a&&-12===n&&(a=12);else if(e===z.FractionalSeconds)return c=t,Z(a,3).substr(0,c);var c;const l=x(s,A.MinusSign);return Z(a,t,l,r,i)}}function Y(e,t,n=P.Format,i=!1){return function(o,s){return function(e,t,n,i,o,s){switch(n){case H.Months:return function(e,t,n){const i=Object(r.kb)(e),o=L([i[r.ab.MonthsFormat],i[r.ab.MonthsStandalone]],t);return L(o,n)}(t,o,i)[e.getMonth()];case H.Days:return function(e,t,n){const i=Object(r.kb)(e),o=L([i[r.ab.DaysFormat],i[r.ab.DaysStandalone]],t);return L(o,n)}(t,o,i)[e.getDay()];case H.DayPeriods:const a=e.getHours(),c=e.getMinutes();if(s){const e=function(e){const t=Object(r.kb)(e);return D(t),(t[r.ab.ExtraData][2]||[]).map(e=>"string"==typeof e?B(e):[B(e[0]),B(e[1])])}(t),n=function(e,t,n){const i=Object(r.kb)(e);D(i);const o=L([i[r.ab.ExtraData][0],i[r.ab.ExtraData][1]],t)||[];return L(o,n)||[]}(t,o,i),s=e.findIndex(e=>{if(Array.isArray(e)){const[t,n]=e,r=a>=t.hours&&c>=t.minutes,i=a<n.hours||a===n.hours&&c<n.minutes;if(t.hours<n.hours){if(r&&i)return!0}else if(r||i)return!0}else if(e.hours===a&&e.minutes===c)return!0;return!1});if(-1!==s)return n[s]}return function(e,t,n){const i=Object(r.kb)(e),o=L([i[r.ab.DayPeriodsFormat],i[r.ab.DayPeriodsStandalone]],t);return L(o,n)}(t,o,i)[a<12?0:1];case H.Eras:return function(e,t){return L(Object(r.kb)(e)[r.ab.Eras],t)}(t,i)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(o,s,e,t,n,i)}}function K(e){return function(t,n,r){const i=-1*r,o=x(n,A.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case V.Short:return(i>=0?"+":"")+Z(s,2,o)+Z(Math.abs(i%60),2,o);case V.ShortGMT:return"GMT"+(i>=0?"+":"")+Z(s,1,o);case V.Long:return"GMT"+(i>=0?"+":"")+Z(s,2,o)+":"+Z(Math.abs(i%60),2,o);case V.Extended:return 0===r?"Z":(i>=0?"+":"")+Z(s,2,o)+":"+Z(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${e}"`)}}}function J(e){return $(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function X(e,t=!1){return function(n,r){let i;if(t){const e=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,t=n.getDate();i=1+Math.floor((t+e)/7)}else{const e=J(n),t=function(e){const t=$(e,0,1).getDay();return $(e,0,1+(t<=4?4:11)-t)}(e.getFullYear()),r=e.getTime()-t.getTime();i=1+Math.round(r/6048e5)}return Z(i,e,x(r,A.MinusSign))}}function ee(e,t=!1){return function(n,r){return Z(J(n).getFullYear(),e,x(r,A.MinusSign),t)}}const te={};function ne(e,t){e=e.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function re(e){return e instanceof Date&&!isNaN(e.valueOf())}const ie=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function oe(e){const t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}class se{}let ae=(()=>{class e extends se{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(R(t||this.locale)(e)){case S.Zero:return"zero";case S.One:return"one";case S.Two:return"two";case S.Few:return"few";case S.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(r.v))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();function ce(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const e=n.indexOf("="),[r,i]=-1==e?[n,""]:[n.slice(0,e),n.slice(e+1)];if(r.trim()===t)return decodeURIComponent(i)}return null}let le=(()=>{class e{constructor(e,t,n,r){this._iterableDiffers=e,this._keyValueDiffers=t,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Object(r.qb)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachChangedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachRemovedItem(e=>{e.previousValue&&this._toggleClass(e.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(e=>{if("string"!=typeof e.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Object(r.wb)(e.item)}`);this._toggleClass(e.item,!0)}),e.forEachRemovedItem(e=>this._toggleClass(e.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!0)):Object.keys(e).forEach(t=>this._toggleClass(t,!!e[t])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!1)):Object.keys(e).forEach(e=>this._toggleClass(e,!1)))}_toggleClass(e,t){(e=e.trim())&&e.split(/\s+/g).forEach(e=>{t?this._renderer.addClass(this._ngEl.nativeElement,e):this._renderer.removeClass(this._ngEl.nativeElement,e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.t),r.Lb(r.u),r.Lb(r.l),r.Lb(r.E))},e.\u0275dir=r.Gb({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class ue{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let he=(()=>{class e{constructor(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${n}' of type '${e=n,e.name||typeof e}'. NgFor only supports binding to Iterables such as Arrays.`)}}var e;if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,n,r)=>{if(null==e.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new ue(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new de(e,n);t.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new de(e,i);t.push(o)}});for(let n=0;n<t.length;n++)this._perViewChange(t[n].view,t[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const e=this._viewContainer.get(n);e.context.index=n,e.context.count=r,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.Q),r.Lb(r.L),r.Lb(r.t))},e.\u0275dir=r.Gb({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class de{constructor(e,t){this.record=e,this.view=t}}let fe=(()=>{class e{constructor(e,t){this._viewContainer=e,this._context=new pe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){ge("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){ge("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.Q),r.Lb(r.L))},e.\u0275dir=r.Gb({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class pe{constructor(){this.$implicit=null,this.ngIf=null}}function ge(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Object(r.wb)(t)}'.`)}function me(e,t){return Error(`InvalidPipeArgument: '${t}' for pipe '${Object(r.wb)(e)}'`)}let ye=(()=>{class e{constructor(e){this.locale=e}transform(t,n="mediumDate",r,i){if(null==t||""===t||t!=t)return null;try{return G(t,n,i||this.locale,r)}catch(o){throw me(e,o.message)}}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.v))},e.\u0275pipe=r.Kb({name:"date",type:e,pure:!0}),e})(),ve=(()=>{class e{constructor(e){this._locale=e}transform(t,n,i){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;i=i||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,o,s=!1){let a="",c=!1;if(isFinite(e)){let l=function(e){let t,n,r,i,o,s=Math.abs(e)+"",a=0;for((n=s.indexOf("."))>-1&&(s=s.replace(".","")),(r=s.search(/e/i))>0?(n<0&&(n=r),n+=+s.slice(r+1),s=s.substring(0,r)):n<0&&(n=s.length),r=0;"0"===s.charAt(r);r++);if(r===(o=s.length))t=[0],n=1;else{for(o--;"0"===s.charAt(o);)o--;for(n-=r,t=[],i=0;r<=o;r++,i++)t[i]=Number(s.charAt(r))}return n>22&&(t=t.splice(0,21),a=n-1,n=1),{digits:t,exponent:a,integerLen:n}}(e);s&&(l=function(e){if(0===e.digits[0])return e;const t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(l));let u=t.minInt,h=t.minFrac,d=t.maxFrac;if(o){const e=o.match(ie);if(null===e)throw new Error(`${o} is not a valid digit info`);const t=e[1],n=e[3],r=e[5];null!=t&&(u=oe(t)),null!=n&&(h=oe(n)),null!=r?d=oe(r):null!=n&&h>d&&(d=h)}!function(e,t,n){if(t>n)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${n}).`);let r=e.digits,i=r.length-e.integerLen;const o=Math.min(Math.max(t,i),n);let s=o+e.integerLen,a=r[s];if(s>0){r.splice(Math.max(e.integerLen,s));for(let e=s;e<r.length;e++)r[e]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,s=o+1),r[0]=0;for(let e=1;e<s;e++)r[e]=0}if(a>=5)if(s-1<0){for(let t=0;t>s;t--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[s-1]++;for(;i<Math.max(0,o);i++)r.push(0);let c=0!==o;const l=t+e.integerLen,u=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,c&&(0===r[n]&&n>=l?r.pop():c=!1),t>=10?1:0},0);u&&(r.unshift(u),e.integerLen++)}(l,h,d);let f=l.digits,p=l.integerLen;const g=l.exponent;let m=[];for(c=f.every(e=>!e);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?m=f.splice(p,f.length):(m=f,f=[0]);const y=[];for(f.length>=t.lgSize&&y.unshift(f.splice(-t.lgSize,f.length).join(""));f.length>t.gSize;)y.unshift(f.splice(-t.gSize,f.length).join(""));f.length&&y.unshift(f.join("")),a=y.join(x(n,r)),m.length&&(a+=x(n,i)+m.join("")),g&&(a+=x(n,A.Exponential)+"+"+g)}else a=x(n,A.Infinity);return a=e<0&&!c?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(e,function(e,t="-"){const n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],o=r[1],s=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=s[0],c=s[1]||"";n.posPre=a.substr(0,a.indexOf("#"));for(let u=0;u<c.length;u++){const e=c.charAt(u);"0"===e?n.minFrac=n.maxFrac=u+1:"#"===e?n.maxFrac=u+1:n.posSuf+=e}const l=a.split(",");if(n.gSize=l[1]?l[1].length:0,n.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const e=i.length-n.posPre.length-n.posSuf.length,t=o.indexOf("#");n.negPre=o.substr(0,t).replace(/'/g,""),n.negSuf=o.substr(t+e).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return Object(r.kb)(e)[r.ab.NumberFormats][t]}(t,O.Decimal),x(t,A.MinusSign)),t,A.Group,A.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error(`${e} is not a number`);return e}(t),i,n)}catch(o){throw me(e,o.message)}}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.v))},e.\u0275pipe=r.Kb({name:"number",type:e,pure:!0}),e})(),be=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({providers:[{provide:se,useClass:ae}]}),e})();function _e(e){return"server"===e}let we=(()=>{class e{}return e.\u0275prov=Object(r.Hb)({token:e,providedIn:"root",factory:()=>new Ce(Object(r.Zb)(s),window)}),e})();class Ce{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const n=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const e=r.shadowRoot;if(e){const n=e.getElementById(t)||e.querySelector(`[name="${t}"]`);if(n)return n}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Ee(this.window.history)||Ee(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function Ee(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class Oe extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var e;e=new Oe,i||(i=e)}getProperty(e,t){return e[t]}log(e){window.console&&window.console.log&&window.console.log(e)}logGroup(e){window.console&&window.console.group&&window.console.group(e)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){return e.parentNode&&e.parentNode.removeChild(e),e}getValue(e){return e.value}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(e){const t=Pe||(Pe=document.querySelector("base"),Pe)?Pe.getAttribute("href"):null;return null==t?null:(n=t,Se||(Se=document.createElement("a")),Se.setAttribute("href",n),"/"===Se.pathname.charAt(0)?Se.pathname:"/"+Se.pathname);var n}resetBaseElement(){Pe=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(e){return ce(document.cookie,e)}}let Se,Pe=null;const Ie=new r.r("TRANSITION_ID"),Te=[{provide:r.d,useFactory:function(e,t,n){return()=>{n.get(r.e).donePromise.then(()=>{const n=o();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>n.remove(e))})}},deps:[Ie,s,r.s],multi:!0}];class Ae{static init(){Object(r.X)(new Ae)}addToWindow(e){r.pb.getAngularTestability=(t,n=!0)=>{const r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},r.pb.getAllAngularTestabilities=()=>e.getAllTestabilities(),r.pb.getAllAngularRootElements=()=>e.getAllRootElements(),r.pb.frameworkStabilizers||(r.pb.frameworkStabilizers=[]),r.pb.frameworkStabilizers.push(e=>{const t=r.pb.getAllAngularTestabilities();let n=t.length,i=!1;const o=function(t){i=i||t,n--,0==n&&e(i)};t.forEach(function(e){e.whenStable(o)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:n?o().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}const ke=new r.r("EventManagerPlugins");let Ne=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}addGlobalEventListener(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const n=this._plugins;for(let r=0;r<n.length;r++){const t=n[r];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(ke),r.Zb(r.A))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();class Me{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=o().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let xe=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),Re=(()=>{class e extends xe{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,t,n){e.forEach(e=>{const r=this._doc.createElement("style");r.textContent=e,n.push(t.appendChild(r))})}addHost(e){const t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}removeHost(e){const t=this._hostNodes.get(e);t&&t.forEach(De),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((t,n)=>{this._addStylesToHost(e,n,t)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(De))}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();function De(e){o().remove(e)}const Le={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Be=/%COMP%/g;function Fe(e,t,n){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?Fe(e,i,n):(i=i.replace(Be,e),n.push(i))}return n}function je(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Ue=(()=>{class e{constructor(e,t,n){this.eventManager=e,this.sharedStylesHost=t,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Ve(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case r.R.Emulated:{let n=this.rendererByCompId.get(t.id);return n||(n=new ze(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n}case 1:case r.R.ShadowDom:return new He(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=Fe(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Ne),r.Zb(Re),r.Zb(r.c))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();class Ve{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Le[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const i=Le[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Le[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(r.G.DashCase|r.G.Important)?e.style.setProperty(t,n,i&r.G.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&r.G.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,je(n)):this.eventManager.addEventListener(e,t,je(n))}}class ze extends Ve{constructor(e,t,n,r){super(e),this.component=n;const i=Fe(r+"-"+n.id,n.styles,[]);t.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(Be,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(Be,r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class He extends Ve{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Fe(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const e=document.createElement("style");e.textContent=i[o],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Ge=(()=>{class e extends Me{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,n){return e.addEventListener(t,n,!1),()=>this.removeEventListener(e,t,n)}removeEventListener(e,t,n){return e.removeEventListener(t,n)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();const $e=["alt","control","meta","shift"],qe={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},We={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ze={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Qe=(()=>{class e extends Me{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,n,r){const i=e.parseEventName(n),s=e.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>o().onAndCancel(t,i.domEventName,s))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=e._normalizeKey(n.pop());let o="";if($e.forEach(e=>{const t=n.indexOf(e);t>-1&&(n.splice(t,1),o+=e+".")}),o+=i,0!=n.length||0===i.length)return null;const s={};return s.domEventName=r,s.fullKey=o,s}static getEventFullKey(e){let t="",n=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&We.hasOwnProperty(t)&&(t=We[t]))}return qe[t]||t}(e);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),$e.forEach(r=>{r!=n&&(0,Ze[r])(e)&&(t+=r+".")}),t+=n,t}static eventCallback(t,n,r){return i=>{e.getEventFullKey(i)===t&&r.runGuarded(()=>n(i))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),Ye=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(r.Hb)({factory:function(){return Object(r.Zb)(Ke)},token:e,providedIn:"root"}),e})(),Ke=(()=>{class e extends Ye{constructor(e){super(),this._doc=e}sanitize(e,t){if(null==t)return null;switch(e){case r.I.NONE:return t;case r.I.HTML:return Object(r.eb)(t,"HTML")?Object(r.xb)(t):Object(r.cb)(this._doc,String(t)).toString();case r.I.STYLE:return Object(r.eb)(t,"Style")?Object(r.xb)(t):t;case r.I.SCRIPT:if(Object(r.eb)(t,"Script"))return Object(r.xb)(t);throw new Error("unsafe value used in a script context");case r.I.URL:return Object(r.ob)(t),Object(r.eb)(t,"URL")?Object(r.xb)(t):Object(r.db)(String(t));case r.I.RESOURCE_URL:if(Object(r.eb)(t,"ResourceURL"))return Object(r.xb)(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return Object(r.fb)(e)}bypassSecurityTrustStyle(e){return Object(r.ib)(e)}bypassSecurityTrustScript(e){return Object(r.hb)(e)}bypassSecurityTrustUrl(e){return Object(r.jb)(e)}bypassSecurityTrustResourceUrl(e){return Object(r.gb)(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s))},e.\u0275prov=Object(r.Hb)({factory:function(){return e=Object(r.Zb)(r.o),new Ke(e.get(s));var e},token:e,providedIn:"root"}),e})();const Je=[{provide:r.C,useValue:"browser"},{provide:r.D,useValue:function(){Oe.makeCurrent(),Ae.init()},multi:!0},{provide:s,useFactory:function(){return Object(r.vb)(document),document},deps:[]}],Xe=Object(r.S)(r.W,"browser",Je),et=[[],{provide:r.Z,useValue:"root"},{provide:r.m,useFactory:function(){return new r.m},deps:[]},{provide:ke,useClass:Ge,multi:!0,deps:[s,r.A,r.C]},{provide:ke,useClass:Qe,multi:!0,deps:[s]},[],{provide:Ue,useClass:Ue,deps:[Ne,Re,r.c]},{provide:r.F,useExisting:Ue},{provide:xe,useExisting:Re},{provide:Re,useClass:Re,deps:[s]},{provide:r.M,useClass:r.M,deps:[r.A]},{provide:Ne,useClass:Ne,deps:[ke,r.A]},[]];let tt=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:r.c,useValue:t.appId},{provide:Ie,useExisting:r.c},Te]}}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(e,12))},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({providers:et,imports:[be,r.f]}),e})();"undefined"!=typeof window&&window;var nt=n("Cfvw"),rt=n("HDdC"),it=n("DH7j"),ot=n("lJxs"),st=n("XoHu");function at(e,t){return new rt.a(n=>{const r=e.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,s=0;for(let a=0;a<r;a++){const c=Object(nt.a)(e[a]);let l=!1;n.add(c.subscribe({next:e=>{l||(l=!0,s++),i[a]=e},error:e=>n.error(e),complete:()=>{o++,o!==r&&l||(s===r&&n.next(t?t.reduce((e,t,n)=>(e[t]=i[n],e),{}):i),n.complete())}}))}})}class ct{}const lt=new r.r("NgValueAccessor"),ut={provide:lt,useExisting:Object(r.U)(()=>dt),multi:!0},ht=new r.r("CompositionEventMode");let dt=(()=>{class e{constructor(e,t,n){this._renderer=e,this._elementRef=t,this._compositionMode=n,this.onChange=e=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=o()?o().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.E),r.Lb(r.l),r.Lb(ht,8))},e.\u0275dir=r.Gb({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&r.cc("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[r.Ab([ut])]}),e})();function ft(e){return null==e||0===e.length}function pt(e){return null!=e&&"number"==typeof e.length}const gt=new r.r("NgValidators"),mt=new r.r("NgAsyncValidators"),yt=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class vt{static min(e){return function(e){return t=>{if(ft(t.value)||ft(e))return null;const n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(e)}static max(e){return function(e){return t=>{if(ft(t.value)||ft(e))return null;const n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(e)}static required(e){return bt(e)}static requiredTrue(e){return function(e){return!0===e.value?null:{required:!0}}(e)}static email(e){return function(e){return ft(e.value)||yt.test(e.value)?null:{email:!0}}(e)}static minLength(e){return function(e){return t=>ft(t.value)||!pt(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}(e)}static maxLength(e){return _t(e)}static pattern(e){return function(e){if(!e)return wt;let t,n;return"string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),e=>{if(ft(e.value))return null;const r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return It(e)}static composeAsync(e){return At(e)}}function bt(e){return ft(e.value)?{required:!0}:null}function _t(e){return t=>pt(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}function wt(e){return null}function Ct(e){return null!=e}function Et(e){const t=Object(r.sb)(e)?Object(nt.a)(e):e;return Object(r.rb)(t),t}function Ot(e){let t={};return e.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function St(e,t){return t.map(t=>t(e))}function Pt(e){return e.map(e=>function(e){return!e.validate}(e)?e:t=>e.validate(t))}function It(e){if(!e)return null;const t=e.filter(Ct);return 0==t.length?null:function(e){return Ot(St(e,t))}}function Tt(e){return null!=e?It(Pt(e)):null}function At(e){if(!e)return null;const t=e.filter(Ct);return 0==t.length?null:function(e){return function(...e){if(1===e.length){const t=e[0];if(Object(it.a)(t))return at(t,null);if(Object(st.a)(t)&&Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);return at(e.map(e=>t[e]),e)}}if("function"==typeof e[e.length-1]){const t=e.pop();return at(e=1===e.length&&Object(it.a)(e[0])?e[0]:e,null).pipe(Object(ot.a)(e=>t(...e)))}return at(e,null)}(St(e,t).map(Et)).pipe(Object(ot.a)(Ot))}}function kt(e){return null!=e?At(Pt(e)):null}function Nt(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function Mt(e){return e._rawValidators}function xt(e){return e._rawAsyncValidators}let Rt=(()=>{class e{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Tt(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=kt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.Gb({type:e}),e})(),Dt=(()=>{class e extends Rt{get formDirective(){return null}get path(){return null}}return e.\u0275fac=function(t){return Lt(t||e)},e.\u0275dir=r.Gb({type:e,features:[r.yb]}),e})();const Lt=r.Sb(Dt);class Bt extends Rt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Ft{constructor(e){this._cd=e}is(e){var t,n;return!!(null===(n=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===n?void 0:n[e])}}let jt=(()=>{class e extends Ft{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Bt,2))},e.\u0275dir=r.Gb({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&r.Db("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[r.yb]}),e})(),Ut=(()=>{class e extends Ft{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Dt,10))},e.\u0275dir=r.Gb({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&r.Db("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[r.yb]}),e})();function Vt(e,t){return[...t.path,e]}function zt(e,t){$t(e,t,!0),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Wt(e,t)})}(e,t),function(e,t){const n=(e,n)=>{t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Wt(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){const n=e=>{t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function Ht(e,t,n=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),qt(e,t,!0),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function Gt(e,t){e.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function $t(e,t,n){const r=Mt(e);null!==t.validator?e.setValidators(Nt(r,t.validator)):"function"==typeof r&&e.setValidators([r]);const i=xt(e);if(null!==t.asyncValidator?e.setAsyncValidators(Nt(i,t.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]),n){const n=()=>e.updateValueAndValidity();Gt(t._rawValidators,n),Gt(t._rawAsyncValidators,n)}}function qt(e,t,n){let r=!1;if(null!==e){if(null!==t.validator){const n=Mt(e);if(Array.isArray(n)&&n.length>0){const i=n.filter(e=>e!==t.validator);i.length!==n.length&&(r=!0,e.setValidators(i))}}if(null!==t.asyncValidator){const n=xt(e);if(Array.isArray(n)&&n.length>0){const i=n.filter(e=>e!==t.asyncValidator);i.length!==n.length&&(r=!0,e.setAsyncValidators(i))}}}if(n){const e=()=>{};Gt(t._rawValidators,e),Gt(t._rawAsyncValidators,e)}return r}function Wt(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Zt(e,t){$t(e,t,!1)}function Qt(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Yt(e,t){e._syncPendingControls(),t.forEach(e=>{const t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Kt(e,t){if(!t)return null;let n,r,i;return Array.isArray(t),t.forEach(e=>{e.constructor===dt?n=e:Object.getPrototypeOf(e.constructor)===ct?r=e:i=e}),i||r||n||null}function Jt(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function Xt(e){return(rn(e)?e.validators:e)||null}function en(e){return Array.isArray(e)?Tt(e):e||null}function tn(e,t){return(rn(t)?t.asyncValidators:e)||null}function nn(e){return Array.isArray(e)?kt(e):e||null}function rn(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class on{constructor(e,t){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=en(this._rawValidators),this._composedAsyncValidatorFn=nn(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=en(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=nn(e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(t=>{t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild(t=>{t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;const t=Et(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(t,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,n){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;let r=e;return t.forEach(e=>{r=r instanceof an?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof cn&&r.at(e)||null}),r}(this,e)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new r.n,this.statusChanges=new r.n}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){rn(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class sn extends on{constructor(e=null,t,n){super(Xt(t),tn(n,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Jt(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Jt(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class an extends on{constructor(e,t,n){super(Xt(t),tn(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t instanceof sn?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const n=this.controls[t];if(this.contains(t)&&e(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,n)=>((t.enabled||this.disabled)&&(e[n]=t.value),e))}_reduceChildren(e,t){let n=e;return this._forEachChild((e,r)=>{n=t(n,e,r)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class cn extends on{constructor(e,t,n){super(Xt(t),tn(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}at(e){return this.controls[e]}push(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}insert(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}removeAt(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((e,n)=>{this.at(n)&&this.at(n).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof sn?e.value:e.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const ln={provide:Dt,useExisting:Object(r.U)(()=>hn)},un=(()=>Promise.resolve(null))();let hn=(()=>{class e extends Dt{constructor(e,t){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new r.n,this.form=new an({},Tt(e),kt(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){un.then(()=>{const t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),zt(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){un.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name),Jt(this._directives,e)})}addFormGroup(e){un.then(()=>{const t=this._findContainer(e.path),n=new an({});Zt(n,e),t.registerControl(e.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){un.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){un.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,Yt(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(gt,10),r.Lb(mt,10))},e.\u0275dir=r.Gb({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&r.cc("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[r.Ab([ln]),r.yb]}),e})();const dn={provide:Bt,useExisting:Object(r.U)(()=>pn)},fn=(()=>Promise.resolve(null))();let pn=(()=>{class e extends Bt{constructor(e,t,n,i){super(),this.control=new sn,this._registered=!1,this.update=new r.n,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=Kt(0,i)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),Qt(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?Vt(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){zt(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){fn.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,n=""===t||t&&"false"!==t;fn.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Dt,9),r.Lb(gt,10),r.Lb(mt,10),r.Lb(lt,10))},e.\u0275dir=r.Gb({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[r.Ab([dn]),r.yb,r.zb]}),e})(),gn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.Gb({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),mn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({}),e})();const yn={provide:lt,useExisting:Object(r.U)(()=>vn),multi:!0};let vn=(()=>{class e extends ct{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.E),r.Lb(r.l))},e.\u0275dir=r.Gb({type:e,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&r.cc("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[r.Ab([yn]),r.yb]}),e})();const bn=new r.r("NgModelWithFormControlWarning"),_n={provide:Dt,useExisting:Object(r.U)(()=>wn)};let wn=(()=>{class e extends Dt{constructor(e,t){super(),this.validators=e,this.asyncValidators=t,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new r.n,this._setValidators(e),this._setAsyncValidators(t)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(qt(this.form,this,!1),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const t=this.form.get(e.path);return zt(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}getControl(e){return this.form.get(e.path)}removeControl(e){Ht(e.control||null,e,!1),Jt(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,t){this.form.get(e.path).setValue(t)}onSubmit(e){return this.submitted=!0,Yt(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const t=e.control,n=this.form.get(e.path);t!==n&&(Ht(t||null,e),n instanceof sn&&(zt(n,e),e.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const t=this.form.get(e.path);Zt(t,e),t.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const t=this.form.get(e.path);t&&function(e,t){return qt(e,t,!1)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){$t(this.form,this,!1),this._oldForm&&qt(this._oldForm,this,!1)}_checkFormPresent(){}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(gt,10),r.Lb(mt,10))},e.\u0275dir=r.Gb({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&r.cc("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[r.Ab([_n]),r.yb,r.zb]}),e})();const Cn={provide:Bt,useExisting:Object(r.U)(()=>En)};let En=(()=>{class e extends Bt{constructor(e,t,n,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new r.n,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=Kt(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),Qt(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Vt(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Dt,13),r.Lb(gt,10),r.Lb(mt,10),r.Lb(lt,10),r.Lb(bn,8))},e.\u0275dir=r.Gb({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[r.Ab([Cn]),r.yb,r.zb]}),e._ngModelWarningSentOnce=!1,e})();const On={provide:lt,useExisting:Object(r.U)(()=>Pn),multi:!0};function Sn(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Pn=(()=>{class e extends ct{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=Sn(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.E),r.Lb(r.l))},e.\u0275dir=r.Gb({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&r.cc("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[r.Ab([On]),r.yb]}),e})(),In=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Sn(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.l),r.Lb(r.E),r.Lb(Pn,9))},e.\u0275dir=r.Gb({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Tn={provide:lt,useExisting:Object(r.U)(()=>kn),multi:!0};function An(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let kn=(()=>{class e extends ct{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const n=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(n.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const n=[];if(void 0!==t.selectedOptions){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const r=e.item(t),i=this._getOptionValue(r.value);n.push(i)}}else{const e=t.options;for(let t=0;t<e.length;t++){const r=e.item(t);if(r.selected){const e=this._getOptionValue(r.value);n.push(e)}}}this.value=n,e(n)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.E),r.Lb(r.l))},e.\u0275dir=r.Gb({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&r.cc("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[r.Ab([Tn]),r.yb]}),e})(),Nn=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(An(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(An(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.l),r.Lb(r.E),r.Lb(kn,9))},e.\u0275dir=r.Gb({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Mn={provide:gt,useExisting:Object(r.U)(()=>xn),multi:!0};let xn=(()=>{class e{constructor(){this._required=!1}get required(){return this._required}set required(e){this._required=null!=e&&!1!==e&&"false"!=`${e}`,this._onChange&&this._onChange()}validate(e){return this.required?bt(e):null}registerOnValidatorChange(e){this._onChange=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.Gb({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&r.Cb("required",t.required?"":null)},inputs:{required:"required"},features:[r.Ab([Mn])]}),e})();const Rn={provide:gt,useExisting:Object(r.U)(()=>Dn),multi:!0};let Dn=(()=>{class e{constructor(){this._validator=wt}ngOnChanges(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}validate(e){return null!=this.maxlength?this._validator(e):null}registerOnValidatorChange(e){this._onChange=e}_createValidator(){this._validator=_t("number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.Gb({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&r.Cb("maxlength",t.maxlength?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[r.Ab([Rn]),r.zb]}),e})(),Ln=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({imports:[[mn]]}),e})(),Bn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({imports:[Ln]}),e})(),Fn=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:bn,useValue:t.warnOnNgModelWithFormControl}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({imports:[Ln]}),e})(),jn=(()=>{class e{group(e,t=null){const n=this._reduceControls(e);let r,i=null,o=null;return null!=t&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(t)?(i=null!=t.validators?t.validators:null,o=null!=t.asyncValidators?t.asyncValidators:null,r=null!=t.updateOn?t.updateOn:void 0):(i=null!=t.validator?t.validator:null,o=null!=t.asyncValidator?t.asyncValidator:null)),new an(n,{asyncValidators:o,updateOn:r,validators:i})}control(e,t,n){return new sn(e,t,n)}array(e,t,n){const r=e.map(e=>this._createControl(e));return new cn(r,t,n)}_reduceControls(e){const t={};return Object.keys(e).forEach(n=>{t[n]=this._createControl(e[n])}),t}_createControl(e){return e instanceof sn||e instanceof an||e instanceof cn?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(r.Hb)({factory:function(){return new e},token:e,providedIn:Fn}),e})();var Un=n("LRne"),Vn=n("5+tZ");function zn(e,t){return Object(Vn.a)(e,t,1)}var Hn=n("7o/Q");function Gn(e,t){return function(n){return n.lift(new $n(e,t))}}class $n{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new qn(e,this.predicate,this.thisArg))}}class qn extends Hn.a{constructor(e,t,n){super(e),this.predicate=t,this.thisArg=n,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}class Wn{}class Zn{}class Qn{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const n=e.slice(0,t),r=n.toLowerCase(),i=e.slice(t+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Qn?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Qn;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Qn?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const i=e.value;if(i){let e=this.headers.get(t);if(!e)return;e=e.filter(e=>-1===i.indexOf(e)),0===e.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Yn{encodeKey(e){return Kn(e)}encodeValue(e){return Kn(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}function Kn(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class Jn{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Yn,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(e=>{const r=e.indexOf("="),[i,o]=-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],s=n.get(i)||[];s.push(o),n.set(i,s)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(e=>{t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Jn({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(e.value),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const n=t.indexOf(e.value);-1!==n&&t.splice(n,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}function Xn(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function er(e){return"undefined"!=typeof Blob&&e instanceof Blob}function tr(e){return"undefined"!=typeof FormData&&e instanceof FormData}class nr{constructor(e,t,n,r){let i;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new Qn),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const n=t.indexOf("?");this.urlWithParams=t+(-1===n?"?":n<t.length-1?"&":"")+e}}else this.params=new Jn,this.urlWithParams=t}serializeBody(){return null===this.body?null:Xn(this.body)||er(this.body)||tr(this.body)||"string"==typeof this.body?this.body:this.body instanceof Jn?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||tr(this.body)?null:er(this.body)?this.body.type||null:Xn(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Jn?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,i=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,s=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let a=e.headers||this.headers,c=e.params||this.params;return void 0!==e.setHeaders&&(a=Object.keys(e.setHeaders).reduce((t,n)=>t.set(n,e.setHeaders[n]),a)),e.setParams&&(c=Object.keys(e.setParams).reduce((t,n)=>t.set(n,e.setParams[n]),c)),new nr(t,n,i,{params:c,headers:a,reportProgress:s,responseType:r,withCredentials:o})}}var rr=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}({});class ir{constructor(e,t=200,n="OK"){this.headers=e.headers||new Qn,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class or extends ir{constructor(e={}){super(e),this.type=rr.ResponseHeader}clone(e={}){return new or({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class sr extends ir{constructor(e={}){super(e),this.type=rr.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new sr({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ar extends ir{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function cr(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let lr=(()=>{class e{constructor(e){this.handler=e}request(e,t,n={}){let r;if(e instanceof nr)r=e;else{let i,o;i=n.headers instanceof Qn?n.headers:new Qn(n.headers),n.params&&(o=n.params instanceof Jn?n.params:new Jn({fromObject:n.params})),r=new nr(e,t,void 0!==n.body?n.body:null,{headers:i,params:o,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Object(Un.a)(r).pipe(zn(e=>this.handler.handle(e)));if(e instanceof nr||"events"===n.observe)return i;const o=i.pipe(Gn(e=>e instanceof sr));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return o.pipe(Object(ot.a)(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return o.pipe(Object(ot.a)(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return o.pipe(Object(ot.a)(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return o.pipe(Object(ot.a)(e=>e.body))}case"response":return o;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new Jn).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,n={}){return this.request("PATCH",e,cr(n,t))}post(e,t,n={}){return this.request("POST",e,cr(n,t))}put(e,t,n={}){return this.request("PUT",e,cr(n,t))}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Wn))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();class ur{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const hr=new r.r("HTTP_INTERCEPTORS");let dr=(()=>{class e{intercept(e,t){return t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();const fr=/^\)\]\}',?\n/;class pr{}let gr=(()=>{class e{constructor(){}build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),mr=(()=>{class e{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new rt.a(t=>{const n=this.xhrFactory.build();if(n.open(e.method,e.urlWithParams),e.withCredentials&&(n.withCredentials=!0),e.headers.forEach((e,t)=>n.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&n.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();n.responseType="json"!==t?t:"text"}const r=e.serializeBody();let i=null;const o=()=>{if(null!==i)return i;const t=1223===n.status?204:n.status,r=n.statusText||"OK",o=new Qn(n.getAllResponseHeaders()),s=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(n)||e.url;return i=new or({headers:o,status:t,statusText:r,url:s}),i},s=()=>{let{headers:r,status:i,statusText:s,url:a}=o(),c=null;204!==i&&(c=void 0===n.response?n.responseText:n.response),0===i&&(i=c?200:0);let l=i>=200&&i<300;if("json"===e.responseType&&"string"==typeof c){const e=c;c=c.replace(fr,"");try{c=""!==c?JSON.parse(c):null}catch(u){c=e,l&&(l=!1,c={error:u,text:c})}}l?(t.next(new sr({body:c,headers:r,status:i,statusText:s,url:a||void 0})),t.complete()):t.error(new ar({error:c,headers:r,status:i,statusText:s,url:a||void 0}))},a=e=>{const{url:r}=o(),i=new ar({error:e,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});t.error(i)};let c=!1;const l=r=>{c||(t.next(o()),c=!0);let i={type:rr.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===e.responseType&&n.responseText&&(i.partialText=n.responseText),t.next(i)},u=e=>{let n={type:rr.UploadProgress,loaded:e.loaded};e.lengthComputable&&(n.total=e.total),t.next(n)};return n.addEventListener("load",s),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),e.reportProgress&&(n.addEventListener("progress",l),null!==r&&n.upload&&n.upload.addEventListener("progress",u)),n.send(r),t.next({type:rr.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",s),n.removeEventListener("timeout",a),e.reportProgress&&(n.removeEventListener("progress",l),null!==r&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(pr))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();const yr=new r.r("XSRF_COOKIE_NAME"),vr=new r.r("XSRF_HEADER_NAME");class br{}let _r=(()=>{class e{constructor(e,t,n){this.doc=e,this.platform=t,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=ce(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s),r.Zb(r.C),r.Zb(yr))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),wr=(()=>{class e{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);const r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(br),r.Zb(vr))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),Cr=(()=>{class e{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(hr,[]);this.chain=e.reduceRight((e,t)=>new ur(e,t),this.backend)}return this.chain.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Zn),r.Zb(r.s))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),Er=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:wr,useClass:dr}]}}static withOptions(t={}){return{ngModule:e,providers:[t.cookieName?{provide:yr,useValue:t.cookieName}:[],t.headerName?{provide:vr,useValue:t.headerName}:[]]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({providers:[wr,{provide:hr,useExisting:wr,multi:!0},{provide:br,useClass:_r},{provide:yr,useValue:"XSRF-TOKEN"},{provide:vr,useValue:"X-XSRF-TOKEN"}]}),e})(),Or=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({providers:[lr,{provide:Wn,useClass:Cr},mr,{provide:Zn,useExisting:mr},gr,{provide:pr,useExisting:gr}],imports:[[Er.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})();var Sr=n("XNiG"),Pr=n("9ppp");class Ir extends Sr.a{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Pr.a;return this._value}next(e){super.next(this._value=e)}}var Tr=n("z+Ro");class Ar extends Hn.a{notifyNext(e,t,n,r,i){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class kr extends Hn.a{constructor(e,t,n){super(),this.parent=e,this.outerValue=t,this.outerIndex=n,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Nr=n("SeVD");function Mr(e,t,n,r,i=new kr(e,n,r)){if(!i.closed)return t instanceof rt.a?t.subscribe(i):Object(Nr.a)(t)(i)}var xr=n("yCtX");const Rr={};class Dr{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Lr(e,this.resultSelector))}}class Lr extends Ar{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(Rr),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let n=0;n<t;n++)this.add(Mr(this,e[n],void 0,n))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,n){const r=this.values,i=this.toRespond?r[n]===Rr?--this.toRespond:this.toRespond:0;r[n]=t,0===i&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}const Br=(()=>{function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e})();var Fr=n("bHdf");function jr(...e){return Object(Fr.a)(1)(Object(Un.a)(...e))}var Ur=n("EY2u");function Vr(e){return new rt.a(t=>{let n;try{n=e()}catch(r){return void t.error(r)}return(n?Object(nt.a)(n):Object(Ur.b)()).subscribe(t)})}var zr=n("EQ5u"),Hr=n("zx2A");function Gr(e,t){return"function"==typeof t?n=>n.pipe(Gr((n,r)=>Object(nt.a)(e(n,r)).pipe(Object(ot.a)((e,i)=>t(n,e,r,i))))):t=>t.lift(new $r(e))}class $r{constructor(e){this.project=e}call(e,t){return t.subscribe(new qr(e,this.project))}}class qr extends Hr.b{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const n=new Hr.a(this),r=this.destination;r.add(n),this.innerSubscription=Object(Hr.c)(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;e&&!e.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const Wr=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function Zr(e){return t=>0===e?Object(Ur.b)():t.lift(new Qr(e))}class Qr{constructor(e){if(this.total=e,this.total<0)throw new Wr}call(e,t){return t.subscribe(new Yr(e,this.total))}}class Yr extends Hn.a{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}function Kr(...e){const t=e[e.length-1];return Object(Tr.a)(t)?(e.pop(),n=>jr(e,n,t)):t=>jr(e,t)}function Jr(e,t){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Xr(e,t,n))}}class Xr{constructor(e,t,n=!1){this.accumulator=e,this.seed=t,this.hasSeed=n}call(e,t){return t.subscribe(new ei(e,this.accumulator,this.seed,this.hasSeed))}}class ei extends Hn.a{constructor(e,t,n,r){super(e),this.accumulator=t,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let n;try{n=this.accumulator(this.seed,e,t)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function ti(e){return function(t){const n=new ni(e),r=t.lift(n);return n.caught=r}}class ni{constructor(e){this.selector=e}call(e,t){return t.subscribe(new ri(e,this.selector,this.caught))}}class ri extends Hr.b{constructor(e,t,n){super(e),this.selector=t,this.caught=n}error(e){if(!this.isStopped){let n;try{n=this.selector(e,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const r=new Hr.a(this);this.add(r);const i=Object(Hr.c)(n,r);i!==r&&this.add(i)}}}function ii(e){return function(t){return 0===e?Object(Ur.b)():t.lift(new oi(e))}}class oi{constructor(e){if(this.total=e,this.total<0)throw new Wr}call(e,t){return t.subscribe(new si(e,this.total))}}class si extends Hn.a{constructor(e,t){super(e),this.total=t,this.ring=new Array,this.count=0}_next(e){const t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e}_complete(){const e=this.destination;let t=this.count;if(t>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=t++%n;e.next(r[i])}}e.complete()}}function ai(e=ui){return t=>t.lift(new ci(e))}class ci{constructor(e){this.errorFactory=e}call(e,t){return t.subscribe(new li(e,this.errorFactory))}}class li extends Hn.a{constructor(e,t){super(e),this.errorFactory=t,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(aO){e=aO}this.destination.error(e)}}}function ui(){return new Br}function hi(e=null){return t=>t.lift(new di(e))}class di{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new fi(e,this.defaultValue))}}class fi extends Hn.a{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var pi=n("SpAZ");function gi(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Gn((t,n)=>e(t,n,r)):pi.a,Zr(1),n?hi(t):ai(()=>new Br))}var mi=n("vkgz"),yi=n("x+ZX"),vi=n("quSY");class bi{constructor(e){this.callback=e}call(e,t){return t.subscribe(new _i(e,this.callback))}}class _i extends Hn.a{constructor(e,t){super(e),this.add(new vi.a(t))}}class wi{constructor(e,t){this.id=e,this.url=t}}class Ci extends wi{constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ei extends wi{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Oi extends wi{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Si extends wi{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Pi extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ii extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ti extends wi{constructor(e,t,n,r,i){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ai extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ki extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ni{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Mi{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class xi{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ri{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Di{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Li{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Bi{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Fi{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ji(e){return new Fi(e)}function Ui(e){const t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function Vi(e,t,n){const r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const i={};for(let o=0;o<r.length;o++){const t=r[o],n=e[o];if(t.startsWith(":"))i[t.substring(1)]=n;else if(t!==n.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function zi(e,t){const n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!Hi(e[i],t[i]))return!1;return!0}function Hi(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((e,t)=>r[t]===e)}return e===t}function Gi(e){return Array.prototype.concat.apply([],e)}function $i(e){return e.length>0?e[e.length-1]:null}function qi(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Wi(e){return Object(r.rb)(e)?e:Object(r.sb)(e)?Object(nt.a)(Promise.resolve(e)):Object(Un.a)(e)}function Zi(e,t,n){return n?function(e,t){return zi(e,t)}(e.queryParams,t.queryParams)&&Qi(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>Hi(e[n],t[n]))}(e.queryParams,t.queryParams)&&Yi(e.root,t.root)}function Qi(e,t){if(!to(e.segments,t.segments))return!1;if(e.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children){if(!e.children[n])return!1;if(!Qi(e.children[n],t.children[n]))return!1}return!0}function Yi(e,t){return Ki(e,t,t.segments)}function Ki(e,t,n){if(e.segments.length>n.length)return!!to(e.segments.slice(0,n.length),n)&&!t.hasChildren();if(e.segments.length===n.length){if(!to(e.segments,n))return!1;for(const n in t.children){if(!e.children[n])return!1;if(!Yi(e.children[n],t.children[n]))return!1}return!0}{const r=n.slice(0,e.segments.length),i=n.slice(e.segments.length);return!!to(e.segments,r)&&!!e.children.primary&&Ki(e.children.primary,t,i)}}class Ji{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ji(this.queryParams)),this._queryParamMap}toString(){return io.serialize(this)}}class Xi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,qi(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return oo(this)}}class eo{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ji(this.parameters)),this._parameterMap}toString(){return fo(this)}}function to(e,t){return e.length===t.length&&e.every((e,n)=>e.path===t[n].path)}class no{}class ro{parse(e){const t=new vo(e);return new Ji(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){var t;return`/${so(e.root,!0)}${function(e){const t=Object.keys(e).map(t=>{const n=e[t];return Array.isArray(n)?n.map(e=>`${co(t)}=${co(e)}`).join("&"):`${co(t)}=${co(n)}`});return t.length?`?${t.join("&")}`:""}(e.queryParams)}${"string"==typeof e.fragment?`#${t=e.fragment,encodeURI(t)}`:""}`}}const io=new ro;function oo(e){return e.segments.map(e=>fo(e)).join("/")}function so(e,t){if(!e.hasChildren())return oo(e);if(t){const t=e.children.primary?so(e.children.primary,!1):"",n=[];return qi(e.children,(e,t)=>{"primary"!==t&&n.push(`${t}:${so(e,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function(e,t){let n=[];return qi(e.children,(e,r)=>{"primary"===r&&(n=n.concat(t(e,r)))}),qi(e.children,(e,r)=>{"primary"!==r&&(n=n.concat(t(e,r)))}),n}(e,(t,n)=>"primary"===n?[so(e.children.primary,!1)]:[`${n}:${so(t,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children.primary?`${oo(e)}/${t[0]}`:`${oo(e)}/(${t.join("//")})`}}function ao(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function co(e){return ao(e).replace(/%3B/gi,";")}function lo(e){return ao(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function uo(e){return decodeURIComponent(e)}function ho(e){return uo(e.replace(/\+/g,"%20"))}function fo(e){return`${lo(e.path)}${t=e.parameters,Object.keys(t).map(e=>`;${lo(e)}=${lo(t[e])}`).join("")}`;var t}const po=/^[^\/()?;=#]+/;function go(e){const t=e.match(po);return t?t[0]:""}const mo=/^[^=?&#]+/,yo=/^[^?&#]+/;class vo{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Xi([],{}):new Xi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n.primary=new Xi(e,t)),n}parseSegment(){const e=go(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new eo(uo(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=go(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const e=go(this.remaining);e&&(n=e,this.capture(n))}e[uo(t)]=uo(n)}parseQueryParam(e){const t=function(e){const t=e.match(mo);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(yo);return t?t[0]:""}(this.remaining);e&&(n=e,this.capture(n))}const r=ho(t),i=ho(n);if(e.hasOwnProperty(r)){let t=e[r];Array.isArray(t)||(t=[t],e[r]=t),t.push(i)}else e[r]=i}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=go(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i="primary");const o=this.parseChildren();t[i]=1===Object.keys(o).length?o.primary:new Xi([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class bo{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=_o(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=_o(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=wo(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return wo(e,this._root).map(e=>e.value)}}function _o(e,t){if(e===t.value)return t;for(const n of t.children){const t=_o(e,n);if(t)return t}return null}function wo(e,t){if(e===t.value)return[t];for(const n of t.children){const r=wo(e,n);if(r.length)return r.unshift(t),r}return[]}class Co{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Eo(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class Oo extends bo{constructor(e,t){super(e),this.snapshot=t,ko(this,e)}toString(){return this.snapshot.toString()}}function So(e,t){const n=function(e,t){const n=new To([],{},{},"",{},"primary",t,null,e.root,-1,{});return new Ao("",new Co(n,[]))}(e,t),r=new Ir([new eo("",{})]),i=new Ir({}),o=new Ir({}),s=new Ir({}),a=new Ir(""),c=new Po(r,i,s,a,o,"primary",t,n.root);return c.snapshot=n.root,new Oo(new Co(c,[]),n)}class Po{constructor(e,t,n,r,i,o,s,a){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Object(ot.a)(e=>ji(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Object(ot.a)(e=>ji(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Io(e,t="emptyOnly"){const n=e.pathFromRoot;let r=0;if("always"!==t)for(r=n.length-1;r>=1;){const e=n[r],t=n[r-1];if(e.routeConfig&&""===e.routeConfig.path)r--;else{if(t.component)break;r--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class To{constructor(e,t,n,r,i,o,s,a,c,l,u){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this.routeConfig=a,this._urlSegment=c,this._lastPathIndex=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ji(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ji(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ao extends bo{constructor(e,t){super(t),this.url=e,ko(this,t)}toString(){return No(this._root)}}function ko(e,t){t.value._routerState=e,t.children.forEach(t=>ko(e,t))}function No(e){const t=e.children.length>0?` { ${e.children.map(No).join(", ")} } `:"";return`${e.value}${t}`}function Mo(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,zi(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),zi(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!zi(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),zi(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function xo(e,t){return zi(e.params,t.params)&&function(e,t){return to(e,t)&&e.every((e,n)=>zi(e.parameters,t[n].parameters))}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||xo(e.parent,t.parent))}function Ro(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const i=function(e,t,n){return t.children.map(t=>{for(const r of n.children)if(e.shouldReuseRoute(t.value,r.value.snapshot))return Ro(e,t,r);return Ro(e,t)})}(e,t,n);return new Co(r,i)}{if(e.shouldAttach(t.value)){const n=e.retrieve(t.value);if(null!==n){const e=n.route;return Do(t,e),e}}const n=new Po(new Ir((r=t.value).url),new Ir(r.params),new Ir(r.queryParams),new Ir(r.fragment),new Ir(r.data),r.outlet,r.component,r),i=t.children.map(t=>Ro(e,t));return new Co(n,i)}var r}function Do(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(let n=0;n<e.children.length;++n)Do(e.children[n],t.children[n])}function Lo(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Bo(e){return"object"==typeof e&&null!=e&&e.outlets}function Fo(e,t,n,r,i){let o={};return r&&qi(r,(e,t)=>{o[t]=Array.isArray(e)?e.map(e=>`${e}`):`${e}`}),new Ji(n.root===e?t:jo(n.root,e,t),o,i)}function jo(e,t,n){const r={};return qi(e.children,(e,i)=>{r[i]=e===t?n:jo(e,t,n)}),new Xi(e.segments,r)}class Uo{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Lo(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(Bo);if(r&&r!==$i(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Vo{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function zo(e,t,n){if(e||(e=new Xi([],{})),0===e.segments.length&&e.hasChildren())return Ho(e,t,n);const r=function(e,t,n){let r=0,i=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=n.length)return o;const t=e.segments[i],s=n[r];if(Bo(s))break;const a=`${s}`,c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===a)break;if(a&&c&&"object"==typeof c&&void 0===c.outlets){if(!Wo(a,c,t))return o;r+=2}else{if(!Wo(a,{},t))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const t=new Xi(e.segments.slice(0,r.pathIndex),{});return t.children.primary=new Xi(e.segments.slice(r.pathIndex),e.children),Ho(t,0,i)}return r.match&&0===i.length?new Xi(e.segments,{}):r.match&&!e.hasChildren()?Go(e,t,n):r.match?Ho(e,0,i):Go(e,t,n)}function Ho(e,t,n){if(0===n.length)return new Xi(e.segments,{});{const r=function(e){return Bo(e[0])?e[0].outlets:{primary:e}}(n),i={};return qi(r,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(i[r]=zo(e.children[r],t,n))}),qi(e.children,(e,t)=>{void 0===r[t]&&(i[t]=e)}),new Xi(e.segments,i)}}function Go(e,t,n){const r=e.segments.slice(0,t);let i=0;for(;i<n.length;){const o=n[i];if(Bo(o)){const e=$o(o.outlets);return new Xi(r,e)}if(0===i&&Lo(n[0])){r.push(new eo(e.segments[t].path,qo(n[0]))),i++;continue}const s=Bo(o)?o.outlets.primary:`${o}`,a=i<n.length-1?n[i+1]:null;s&&a&&Lo(a)?(r.push(new eo(s,qo(a))),i+=2):(r.push(new eo(s,{})),i++)}return new Xi(r,{})}function $o(e){const t={};return qi(e,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[n]=Go(new Xi([],{}),0,e))}),t}function qo(e){const t={};return qi(e,(e,n)=>t[n]=`${e}`),t}function Wo(e,t,n){return e==n.path&&zi(t,n.parameters)}class Zo{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Mo(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=Eo(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,r[t],n),delete r[t]}),qi(r,(e,t)=>{this.deactivateRouteAndItsChildren(e,n)})}deactivateRoutes(e,t,n){const r=e.value,i=t?t.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(e,t,i.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet);if(n&&n.outlet){const t=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:r})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=Eo(e);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=Eo(t);e.children.forEach(e=>{this.activateRoutes(e,r[e.value.outlet],n),this.forwardEvent(new Li(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Ri(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,i=t?t.value:null;if(Mo(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,i.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const t=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const e=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),Qo(e.route)}else{const n=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;t.attachRef=null,t.route=r,t.resolver=i,t.outlet&&t.outlet.activateWith(r,i),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,n)}}function Qo(e){Mo(e.value),e.children.forEach(Qo)}class Yo{constructor(e,t){this.routes=e,this.module=t}}function Ko(e){return"function"==typeof e}function Jo(e){return e instanceof Ji}const Xo=Symbol("INITIAL_VALUE");function es(){return Gr(e=>function(...e){let t,n;return Object(Tr.a)(e[e.length-1])&&(n=e.pop()),"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&Object(it.a)(e[0])&&(e=e[0]),Object(xr.a)(e,n).lift(new Dr(t))}(e.map(e=>e.pipe(Zr(1),Kr(Xo)))).pipe(Jr((e,t)=>{let n=!1;return t.reduce((e,r,i)=>{if(e!==Xo)return e;if(r===Xo&&(n=!0),!n){if(!1===r)return r;if(i===t.length-1||Jo(r))return r}return e},e)},Xo),Gn(e=>e!==Xo),Object(ot.a)(e=>Jo(e)?e:!0===e),Zr(1)))}let ts=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&r.Mb(0,"router-outlet")},directives:function(){return[Ys]},encapsulation:2}),e})();function ns(e,t=""){for(let n=0;n<e.length;n++){const r=e[n];rs(r,is(t,r))}}function rs(e,t){e.children&&ns(e.children,t)}function is(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function os(e){const t=e.children&&e.children.map(os),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=ts),n}function ss(e){return e.outlet||"primary"}function as(e,t){const n=e.filter(e=>ss(e)===t);return n.push(...e.filter(e=>ss(e)!==t)),n}const cs={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function ls(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},cs):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const i=(t.matcher||Vi)(n,e,t);if(!i)return Object.assign({},cs);const o={};qi(i.posParams,(e,t)=>{o[t]=e.path});const s=i.consumed.length>0?Object.assign(Object.assign({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:s,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function us(e,t,n,r,i="corrected"){if(n.length>0&&function(e,t,n){return n.some(n=>hs(e,t,n)&&"primary"!==ss(n))}(e,n,r)){const i=new Xi(t,function(e,t,n,r){const i={};i.primary=r,r._sourceSegment=e,r._segmentIndexShift=t.length;for(const o of n)if(""===o.path&&"primary"!==ss(o)){const n=new Xi([],{});n._sourceSegment=e,n._segmentIndexShift=t.length,i[ss(o)]=n}return i}(e,t,r,new Xi(n,e.children)));return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(n=>hs(e,t,n))}(e,n,r)){const o=new Xi(e.segments,function(e,t,n,r,i,o){const s={};for(const a of r)if(hs(e,n,a)&&!i[ss(a)]){const n=new Xi([],{});n._sourceSegment=e,n._segmentIndexShift="legacy"===o?e.segments.length:t.length,s[ss(a)]=n}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}const o=new Xi(e.segments,e.children);return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}function hs(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function ds(e,t,n,r){return!!(ss(e)===r||"primary"!==r&&hs(t,n,e))&&("**"===e.path||ls(t,e,n).matched)}function fs(e,t,n){return 0===t.length&&!e.children[n]}class ps{constructor(e){this.segmentGroup=e||null}}class gs{constructor(e){this.urlTree=e}}function ms(e){return new rt.a(t=>t.error(new ps(e)))}function ys(e){return new rt.a(t=>t.error(new gs(e)))}function vs(e){return new rt.a(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class bs{constructor(e,t,n,i,o){this.configLoader=t,this.urlSerializer=n,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=e.get(r.y)}apply(){const e=us(this.urlTree.root,[],[],this.config).segmentGroup,t=new Xi(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,"primary").pipe(Object(ot.a)(e=>this.createUrlTree(_s(e),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ti(e=>{if(e instanceof gs)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof ps)throw this.noMatchError(e);throw e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(Object(ot.a)(t=>this.createUrlTree(_s(t),e.queryParams,e.fragment))).pipe(ti(e=>{if(e instanceof ps)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new Xi([],{primary:e}):e;return new Ji(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Object(ot.a)(e=>new Xi([],e))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const i of Object.keys(n.children))"primary"===i?r.unshift(i):r.push(i);return Object(nt.a)(r).pipe(zn(r=>{const i=n.children[r],o=as(t,r);return this.expandSegmentGroup(e,o,i,r).pipe(Object(ot.a)(e=>({segment:e,outlet:r})))}),Jr((e,t)=>(e[t.outlet]=t.segment,e),{}),function(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Gn((t,n)=>e(t,n,r)):pi.a,ii(1),n?hi(t):ai(()=>new Br))}())}expandSegment(e,t,n,r,i,o){return Object(nt.a)(n).pipe(zn(s=>this.expandSegmentAgainstRoute(e,t,n,s,r,i,o).pipe(ti(e=>{if(e instanceof ps)return Object(Un.a)(null);throw e}))),gi(e=>!!e),ti((e,n)=>{if(e instanceof Br||"EmptyError"===e.name){if(fs(t,r,i))return Object(Un.a)(new Xi([],{}));throw new ps(t)}throw e}))}expandSegmentAgainstRoute(e,t,n,r,i,o,s){return ds(r,t,i,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,o):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o):ms(t):ms(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?ys(i):this.lineralizeSegments(n,i).pipe(Object(Vn.a)(n=>{const i=new Xi(n,{});return this.expandSegment(e,i,t,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o){const{matched:s,consumedSegments:a,lastChild:c,positionalParamSegments:l}=ls(t,r,i);if(!s)return ms(t);const u=this.applyRedirectCommands(a,r.redirectTo,l);return r.redirectTo.startsWith("/")?ys(u):this.lineralizeSegments(r,u).pipe(Object(Vn.a)(r=>this.expandSegment(e,t,n,r.concat(i.slice(c)),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,i){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Object(Un.a)(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Object(ot.a)(e=>(n._loadedConfig=e,new Xi(r,{})))):Object(Un.a)(new Xi(r,{}));const{matched:o,consumedSegments:s,lastChild:a}=ls(t,n,r);if(!o)return ms(t);const c=r.slice(a);return this.getChildConfig(e,n,r).pipe(Object(Vn.a)(e=>{const r=e.module,o=e.routes,{segmentGroup:a,slicedSegments:l}=us(t,s,c,o),u=new Xi(a.segments,a.children);if(0===l.length&&u.hasChildren())return this.expandChildren(r,o,u).pipe(Object(ot.a)(e=>new Xi(s,e)));if(0===o.length&&0===l.length)return Object(Un.a)(new Xi(s,{}));const h=ss(n)===i;return this.expandSegment(r,u,o,l,h?"primary":i,!0).pipe(Object(ot.a)(e=>new Xi(s.concat(e.segments),e.children)))}))}getChildConfig(e,t,n){return t.children?Object(Un.a)(new Yo(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Object(Un.a)(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Object(Vn.a)(n=>n?this.configLoader.load(e.injector,t).pipe(Object(ot.a)(e=>(t._loadedConfig=e,e))):function(e){return new rt.a(t=>t.error(Ui(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`)))}(t))):Object(Un.a)(new Yo([],e))}runCanLoadGuards(e,t,n){const r=t.canLoad;if(!r||0===r.length)return Object(Un.a)(!0);const i=r.map(r=>{const i=e.get(r);let o;if(function(e){return e&&Ko(e.canLoad)}(i))o=i.canLoad(t,n);else{if(!Ko(i))throw new Error("Invalid CanLoad guard");o=i(t,n)}return Wi(o)});return Object(Un.a)(i).pipe(es(),Object(mi.a)(e=>{if(!Jo(e))return;const t=Ui(`Redirecting to "${this.urlSerializer.serialize(e)}"`);throw t.url=e,t}),Object(ot.a)(e=>!0===e))}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Object(Un.a)(n);if(r.numberOfChildren>1||!r.children.primary)return vs(e.redirectTo);r=r.children.primary}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const i=this.createSegmentGroup(e,t.root,n,r);return new Ji(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return qi(e,(e,r)=>{if("string"==typeof e&&e.startsWith(":")){const i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}createSegmentGroup(e,t,n,r){const i=this.createSegments(e,t.segments,n,r);let o={};return qi(t.children,(t,i)=>{o[i]=this.createSegmentGroup(e,t,n,r)}),new Xi(i,o)}createSegments(e,t,n,r){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,r):this.findOrReturn(t,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function _s(e){const t={};for(const n of Object.keys(e.children)){const r=_s(e.children[n]);(r.segments.length>0||r.hasChildren())&&(t[n]=r)}return function(e){if(1===e.numberOfChildren&&e.children.primary){const t=e.children.primary;return new Xi(e.segments.concat(t.segments),t.children)}return e}(new Xi(e.segments,t))}class ws{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Cs{constructor(e,t){this.component=e,this.route=t}}function Es(e,t,n){const r=e._root;return Ss(r,t?t._root:null,n,[r.value])}function Os(e,t,n){const r=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function Ss(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=Eo(t);return e.children.forEach(e=>{!function(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,s=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!to(e.url,t.url);case"pathParamsOrQueryParamsChange":return!to(e.url,t.url)||!zi(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xo(e,t)||!zi(e.queryParams,t.queryParams);case"paramsChange":default:return!xo(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new ws(r)):(o.data=s.data,o._resolvedData=s._resolvedData),Ss(e,t,o.component?a?a.children:null:n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Cs(a.outlet.component,s))}else s&&Ps(t,a,i),i.canActivateChecks.push(new ws(r)),Ss(e,null,o.component?a?a.children:null:n,r,i)}(e,o[e.value.outlet],n,r.concat([e.value]),i),delete o[e.value.outlet]}),qi(o,(e,t)=>Ps(e,n.getContext(t),i)),i}function Ps(e,t,n){const r=Eo(e),i=e.value;qi(r,(e,r)=>{Ps(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new Cs(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}class Is{}function Ts(e){return new rt.a(t=>t.error(e))}class As{constructor(e,t,n,r,i,o){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}recognize(){const e=us(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary");if(null===t)return null;const n=new To([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Co(n,t),i=new Ao(this.url,r);return this.inheritParamsAndData(i._root),i}inheritParamsAndData(e){const t=e.value,n=Io(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const i of Object.keys(t.children)){const r=t.children[i],o=as(e,i),s=this.processSegmentGroup(o,r,i);if(null===s)return null;n.push(...s)}const r=Ns(n);return r.sort((e,t)=>"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)),r}processSegment(e,t,n,r){for(const i of e){const e=this.processSegmentAgainstRoute(i,t,n,r);if(null!==e)return e}return fs(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!ds(e,t,n,r))return null;let i,o=[],s=[];if("**"===e.path){const r=n.length>0?$i(n).parameters:{};i=new To(n,r,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Rs(e),ss(e),e.component,e,Ms(t),xs(t)+n.length,Ds(e))}else{const r=ls(t,e,n);if(!r.matched)return null;o=r.consumedSegments,s=n.slice(r.lastChild),i=new To(o,r.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Rs(e),ss(e),e.component,e,Ms(t),xs(t)+o.length,Ds(e))}const a=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:l}=us(t,o,s,a.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution);if(0===l.length&&c.hasChildren()){const e=this.processChildren(a,c);return null===e?null:[new Co(i,e)]}if(0===a.length&&0===l.length)return[new Co(i,[])];const u=ss(e)===r,h=this.processSegment(a,c,l,u?"primary":r);return null===h?null:[new Co(i,h)]}}function ks(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Ns(e){const t=[],n=new Set;for(const r of e){if(!ks(r)){t.push(r);continue}const e=t.find(e=>r.value.routeConfig===e.value.routeConfig);void 0!==e?(e.children.push(...r.children),n.add(e)):t.push(r)}for(const r of n){const e=Ns(r.children);t.push(new Co(r.value,e))}return t.filter(e=>!n.has(e))}function Ms(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function xs(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function Rs(e){return e.data||{}}function Ds(e){return e.resolve||{}}function Ls(e){return Gr(t=>{const n=e(t);return n?Object(nt.a)(n).pipe(Object(ot.a)(()=>t)):Object(Un.a)(t)})}class Bs extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Fs=new r.r("ROUTES");class js{constructor(e,t,n,r){this.loader=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const n=this.loadModuleFactory(t.loadChildren).pipe(Object(ot.a)(n=>{this.onLoadEndListener&&this.onLoadEndListener(t);const i=n.create(e);return new Yo(Gi(i.injector.get(Fs,void 0,r.q.Self|r.q.Optional)).map(os),i)}),ti(e=>{throw t._loader$=void 0,e}));return t._loader$=new zr.a(n,()=>new Sr.a).pipe(Object(yi.a)()),t._loader$}loadModuleFactory(e){return"string"==typeof e?Object(nt.a)(this.loader.load(e)):Wi(e()).pipe(Object(Vn.a)(e=>e instanceof r.w?Object(Un.a)(e):Object(nt.a)(this.compiler.compileModuleAsync(e))))}}class Us{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Vs,this.attachRef=null}}class Vs{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Us,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class zs{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function Hs(e){throw e}function Gs(e,t,n){return t.parse("/")}function $s(e,t){return Object(Un.a)(null)}let qs=(()=>{class e{constructor(e,t,n,i,o,s,a,c){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=n,this.location=i,this.config=c,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new Sr.a,this.errorHandler=Hs,this.malformedUriErrorHandler=Gs,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:$s,afterPreactivation:$s},this.urlHandlingStrategy=new zs,this.routeReuseStrategy=new Bs,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=o.get(r.y),this.console=o.get(r.Y);const l=o.get(r.A);this.isNgZoneEnabled=l instanceof r.A&&r.A.isInAngularZone(),this.resetConfig(c),this.currentUrlTree=new Ji(new Xi([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new js(s,a,e=>this.triggerEvent(new Ni(e)),e=>this.triggerEvent(new Mi(e))),this.routerState=So(this.currentUrlTree,this.rootComponentType),this.transitions=new Ir({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(e){const t=this.events;return e.pipe(Gn(e=>0!==e.id),Object(ot.a)(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),Gr(e=>{let n=!1,r=!1;return Object(Un.a)(e).pipe(Object(mi.a)(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Gr(e=>{const n=!this.navigated||e.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Object(Un.a)(e).pipe(Gr(e=>{const n=this.transitions.getValue();return t.next(new Ci(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),n!==this.transitions.getValue()?Ur.a:Promise.resolve(e)}),(r=this.ngModule.injector,i=this.configLoader,o=this.urlSerializer,s=this.config,Gr(e=>function(e,t,n,r,i){return new bs(e,t,n,r,i).apply()}(r,i,o,e.extractedUrl,s).pipe(Object(ot.a)(t=>Object.assign(Object.assign({},e),{urlAfterRedirects:t}))))),Object(mi.a)(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,n,r,i){return Object(Vn.a)(o=>function(e,t,n,r,i="emptyOnly",o="legacy"){try{const s=new As(e,t,n,r,i,o).recognize();return null===s?Ts(new Is):Object(Un.a)(s)}catch(aO){return Ts(aO)}}(e,t,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(Object(ot.a)(e=>Object.assign(Object.assign({},o),{targetSnapshot:e}))))}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),Object(mi.a)(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),this.browserUrlTree=e.urlAfterRedirects);const n=new Pi(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(n)}));var r,i,o,s;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:o,extras:s}=e,a=new Ci(n,this.serializeUrl(r),i,o);t.next(a);const c=So(r,this.rootComponentType).snapshot;return Object(Un.a)(Object.assign(Object.assign({},e),{targetSnapshot:c,urlAfterRedirects:r,extras:Object.assign(Object.assign({},s),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Ur.a}),Ls(e=>{const{targetSnapshot:t,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=e;return this.hooks.beforePreactivation(t,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),Object(mi.a)(e=>{const t=new Ii(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),Object(ot.a)(e=>Object.assign(Object.assign({},e),{guards:Es(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return Object(Vn.a)(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?Object(Un.a)(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Object(nt.a)(e).pipe(Object(Vn.a)(e=>function(e,t,n,r,i){const o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||0===o.length)return Object(Un.a)(!0);const s=o.map(o=>{const s=Os(o,t,i);let a;if(function(e){return e&&Ko(e.canDeactivate)}(s))a=Wi(s.canDeactivate(e,t,n,r));else{if(!Ko(s))throw new Error("Invalid CanDeactivate guard");a=Wi(s(e,t,n,r))}return a.pipe(gi())});return Object(Un.a)(s).pipe(es())}(e.component,e.route,n,t,r)),gi(e=>!0!==e,!0))}(s,r,i,e).pipe(Object(Vn.a)(n=>n&&"boolean"==typeof n?function(e,t,n,r){return Object(nt.a)(t).pipe(zn(t=>jr(function(e,t){return null!==e&&t&&t(new xi(e)),Object(Un.a)(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new Di(e)),Object(Un.a)(!0)}(t.route,r),function(e,t,n){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>Vr(()=>{const i=t.guards.map(i=>{const o=Os(i,t.node,n);let s;if(function(e){return e&&Ko(e.canActivateChild)}(o))s=Wi(o.canActivateChild(r,e));else{if(!Ko(o))throw new Error("Invalid CanActivateChild guard");s=Wi(o(r,e))}return s.pipe(gi())});return Object(Un.a)(i).pipe(es())}));return Object(Un.a)(i).pipe(es())}(e,t.path,n),function(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Object(Un.a)(!0);const i=r.map(r=>Vr(()=>{const i=Os(r,t,n);let o;if(function(e){return e&&Ko(e.canActivate)}(i))o=Wi(i.canActivate(t,e));else{if(!Ko(i))throw new Error("Invalid CanActivate guard");o=Wi(i(t,e))}return o.pipe(gi())}));return Object(Un.a)(i).pipe(es())}(e,t.route,n))),gi(e=>!0!==e,!0))}(r,o,e,t):Object(Un.a)(n)),Object(ot.a)(e=>Object.assign(Object.assign({},n),{guardsResult:e})))})}(this.ngModule.injector,e=>this.triggerEvent(e)),Object(mi.a)(e=>{if(Jo(e.guardsResult)){const t=Ui(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}const t=new Ti(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),Gn(e=>{if(!e.guardsResult){this.resetUrlToCurrentUrlTree();const n=new Oi(e.id,this.serializeUrl(e.extractedUrl),"");return t.next(n),e.resolve(!1),!1}return!0}),Ls(e=>{if(e.guards.canActivateChecks.length)return Object(Un.a)(e).pipe(Object(mi.a)(e=>{const t=new Ai(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),Gr(e=>{let n=!1;return Object(Un.a)(e).pipe((r=this.paramsInheritanceStrategy,i=this.ngModule.injector,Object(Vn.a)(e=>{const{targetSnapshot:t,guards:{canActivateChecks:n}}=e;if(!n.length)return Object(Un.a)(e);let o=0;return Object(nt.a)(n).pipe(zn(e=>function(e,t,n,r){return function(e,t,n,r){const i=Object.keys(e);if(0===i.length)return Object(Un.a)({});const o={};return Object(nt.a)(i).pipe(Object(Vn.a)(i=>function(e,t,n,r){const i=Os(e,t,r);return Wi(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(Object(mi.a)(e=>{o[i]=e}))),ii(1),Object(Vn.a)(()=>Object.keys(o).length===i.length?Object(Un.a)(o):Ur.a))}(e._resolve,e,t,r).pipe(Object(ot.a)(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),Io(e,n).resolve),null)))}(e.route,t,r,i)),Object(mi.a)(()=>o++),ii(1),Object(Vn.a)(t=>o===n.length?Object(Un.a)(e):Ur.a))})),Object(mi.a)({next:()=>n=!0,complete:()=>{if(!n){const n=new Oi(e.id,this.serializeUrl(e.extractedUrl),"At least one route resolver didn't emit any value.");t.next(n),e.resolve(!1)}}}));var r,i}),Object(mi.a)(e=>{const t=new ki(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}))}),Ls(e=>{const{targetSnapshot:t,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=e;return this.hooks.afterPreactivation(t,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),Object(ot.a)(e=>{const t=function(e,t,n){const r=Ro(e,t._root,n?n._root:void 0);return new Oo(r,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),Object(mi.a)(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),this.browserUrlTree=e.urlAfterRedirects)}),(o=this.rootContexts,s=this.routeReuseStrategy,a=e=>this.triggerEvent(e),Object(ot.a)(e=>(new Zo(s,e.targetRouterState,e.currentRouterState,a).activate(o),e))),Object(mi.a)({next(){n=!0},complete(){n=!0}}),(i=()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new Oi(e.id,this.serializeUrl(e.extractedUrl),`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`);t.next(n),e.resolve(!1)}this.currentNavigation=null},e=>e.lift(new bi(i))),ti(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=Jo(n.url);r||(this.navigated=!0,this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));const i=new Oi(e.id,this.serializeUrl(e.extractedUrl),n.message);t.next(i),r?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);this.scheduleNavigation(t,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);const r=new Si(e.id,this.serializeUrl(e.extractedUrl),n);t.next(r);try{e.resolve(this.errorHandler(n))}catch(Ng){e.reject(Ng)}}var i;return Ur.a}));var i,o,s,a}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const t=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,t)&&setTimeout(()=>{const{source:e,state:n,urlTree:r}=t,i={replaceUrl:!0};if(n){const e=Object.assign({},n);delete e.navigationId,0!==Object.keys(e).length&&(i.state=e)}this.scheduleNavigation(r,e,n,i)},0),this.lastLocationChangeInfo=t}))}extractLocationChangeInfoFromEvent(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,t){if(!e)return!0;const n=t.urlTree.toString()===e.urlTree.toString();return!(t.transitionId===e.transitionId&&n&&("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){ns(e),this.config=e.map(os),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,t={}){const{relativeTo:n,queryParams:r,fragment:i,queryParamsHandling:o,preserveFragment:s}=t,a=n||this.routerState.root,c=s?this.currentUrlTree.fragment:i;let l=null;switch(o){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}return null!==l&&(l=this.removeEmptyProps(l)),function(e,t,n,r,i){if(0===n.length)return Fo(t.root,t.root,t,r,i);const o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Uo(!0,0,e);let t=0,n=!1;const r=e.reduce((e,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const t={};return qi(r.outlets,(e,n)=>{t[n]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(r.segmentPath)return[...e,r.segmentPath]}return"string"!=typeof r?[...e,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[...e,r]},[]);return new Uo(n,t,r)}(n);if(o.toRoot())return Fo(t.root,new Xi([],{}),t,r,i);const s=function(e,t,n){if(e.isAbsolute)return new Vo(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const e=n.snapshot._urlSegment;return new Vo(e,e===t.root,0)}const r=Lo(e.commands[0])?0:1;return function(e,t,n){let r=e,i=t,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new Vo(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(o,t,e),a=s.processChildren?Ho(s.segmentGroup,s.index,o.commands):zo(s.segmentGroup,s.index,o.commands);return Fo(s.segmentGroup,a,t,r,i)}(a,this.currentUrlTree,e,l,c)}navigateByUrl(e,t={skipLocationChange:!1}){const n=Jo(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(aO){t=this.malformedUriErrorHandler(aO,this.urlSerializer,e)}return t}isActive(e,t){if(Jo(e))return Zi(this.currentUrlTree,e,t);const n=this.parseUrl(e);return Zi(this.currentUrlTree,n,t)}removeEmptyProps(e){return Object.keys(e).reduce((t,n)=>{const r=e[n];return null!=r&&(t[n]=r),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.events.next(new Ei(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(e,t,n,r,i){if(this.disposed)return Promise.resolve(!1);const o=this.getTransition(),s="imperative"!==t&&"imperative"===(null==o?void 0:o.source),a=(this.lastSuccessfulId===o.id||this.currentNavigation?o.rawUrl:o.urlAfterRedirects).toString()===e.toString();if(s&&a)return Promise.resolve(!0);let c,l,u;i?(c=i.resolve,l=i.reject,u=i.promise):u=new Promise((e,t)=>{c=e,l=t});const h=++this.navigationId;return this.setTransition({id:h,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(e=>Promise.reject(e))}setBrowserUrl(e,t,n,r){const i=this.urlSerializer.serialize(e);r=r||{},this.location.isCurrentPathEqualTo(i)||t?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}resetStateAndUrl(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(r.N),r.Zb(no),r.Zb(Vs),r.Zb(w),r.Zb(r.s),r.Zb(r.x),r.Zb(r.i),r.Zb(void 0))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),Ws=(()=>{class e{constructor(e,t,n,r,i){this.router=e,this.route=t,this.commands=[],this.onChanges=new Sr.a,null==n&&r.setAttribute(i.nativeElement,"tabindex","0")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}onClick(){const e={skipLocationChange:Qs(this.skipLocationChange),replaceUrl:Qs(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Qs(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(Po),r.ac("tabindex"),r.Lb(r.E),r.Lb(r.l))},e.\u0275dir=r.Gb({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&r.cc("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[r.zb]}),e})(),Zs=(()=>{class e{constructor(e,t,n){this.router=e,this.route=t,this.locationStrategy=n,this.commands=[],this.onChanges=new Sr.a,this.subscription=e.events.subscribe(e=>{e instanceof Ei&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,t,n,r,i){if(0!==e||t||n||r||i)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const o={skipLocationChange:Qs(this.skipLocationChange),replaceUrl:Qs(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,o),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Qs(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(Po),r.Lb(m))},e.\u0275dir=r.Gb({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&r.cc("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(r.Tb("href",t.href,r.yc),r.Cb("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[r.zb]}),e})();function Qs(e){return""===e||!!e}let Ys=(()=>{class e{constructor(e,t,n,i,o){this.parentContexts=e,this.location=t,this.resolver=n,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new r.n,this.deactivateEvents=new r.n,this.name=i||"primary",e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new Ks(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Vs),r.Lb(r.Q),r.Lb(r.j),r.ac("name"),r.Lb(r.h))},e.\u0275dir=r.Gb({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class Ks{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Po?this.route:e===Vs?this.childContexts:this.parent.get(e,t)}}class Js{}class Xs{preload(e,t){return Object(Un.a)(null)}}let ea=(()=>{class e{constructor(e,t,n,r,i){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=new js(t,n,t=>e.triggerEvent(new Ni(t)),t=>e.triggerEvent(new Mi(t)))}setUpPreloading(){this.subscription=this.router.events.pipe(Gn(e=>e instanceof Ei),zn(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(r.y);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){const n=[];for(const r of t)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const e=r._loadedConfig;n.push(this.processRoutes(e.module,e.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(e,r)):r.children&&n.push(this.processRoutes(e,r.children));return Object(nt.a)(n).pipe(Object(Fr.a)(),Object(ot.a)(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>(t._loadedConfig?Object(Un.a)(t._loadedConfig):this.loader.load(e.injector,t)).pipe(Object(Vn.a)(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(qs),r.Zb(r.x),r.Zb(r.i),r.Zb(r.s),r.Zb(Js))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),ta=(()=>{class e{constructor(e,t,n={}){this.router=e,this.viewportScroller=t,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Ci?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Ei&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Bi&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new Bi(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(qs),r.Zb(we),r.Zb(void 0))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();const na=new r.r("ROUTER_CONFIGURATION"),ra=new r.r("ROUTER_FORROOT_GUARD"),ia=[w,{provide:no,useClass:ro},{provide:qs,useFactory:function(e,t,n,r,i,s,a,c={},l,u){const h=new qs(null,e,t,n,r,i,s,Gi(a));if(l&&(h.urlHandlingStrategy=l),u&&(h.routeReuseStrategy=u),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(c,h),c.enableTracing){const e=o();h.events.subscribe(t=>{e.logGroup(`Router Event: ${t.constructor.name}`),e.log(t.toString()),e.log(t),e.logGroupEnd()})}return h},deps:[no,Vs,w,r.s,r.x,r.i,Fs,na,[class{},new r.B],[class{},new r.B]]},Vs,{provide:Po,useFactory:function(e){return e.routerState.root},deps:[qs]},{provide:r.x,useClass:r.K},ea,Xs,class{preload(e,t){return t().pipe(ti(()=>Object(Un.a)(null)))}},{provide:na,useValue:{enableTracing:!1}}];function oa(){return new r.z("Router",qs)}let sa=(()=>{class e{constructor(e,t){}static forRoot(t,n){return{ngModule:e,providers:[ia,ua(t),{provide:ra,useFactory:la,deps:[[qs,new r.B,new r.J]]},{provide:na,useValue:n||{}},{provide:m,useFactory:ca,deps:[a,[new r.p(v),new r.B],na]},{provide:ta,useFactory:aa,deps:[qs,we,na]},{provide:Js,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Xs},{provide:r.z,multi:!0,useFactory:oa},[ha,{provide:r.d,multi:!0,useFactory:da,deps:[ha]},{provide:pa,useFactory:fa,deps:[ha]},{provide:r.b,multi:!0,useExisting:pa}]]}}static forChild(t){return{ngModule:e,providers:[ua(t)]}}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(ra,8),r.Zb(qs,8))},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({}),e})();function aa(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new ta(e,t,n)}function ca(e,t,n={}){return n.useHash?new _(e,t):new b(e,t)}function la(e){return"guarded"}function ua(e){return[{provide:r.a,multi:!0,useValue:e},{provide:Fs,multi:!0,useValue:e}]}let ha=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new Sr.a}appInitializer(){return this.injector.get(l,Promise.resolve(null)).then(()=>{let e=null;const t=new Promise(t=>e=t),n=this.injector.get(qs),r=this.injector.get(na);return"disabled"===r.initialNavigation?(n.setUpLocationChangeListener(),e(!0)):"enabled"===r.initialNavigation||"enabledBlocking"===r.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?Object(Un.a)(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),n.initialNavigation()):e(!0),t})}bootstrapListener(e){const t=this.injector.get(na),n=this.injector.get(ea),i=this.injector.get(ta),o=this.injector.get(qs),s=this.injector.get(r.g);e===s.components[0]&&("enabledNonBlocking"!==t.initialNavigation&&void 0!==t.initialNavigation||o.initialNavigation(),n.setUpPreloading(),i.init(),o.resetRootComponentType(s.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(r.s))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();function da(e){return e.appInitializer.bind(e)}function fa(e){return e.bootstrapListener.bind(e)}const pa=new r.r("Router Initializer");class ga{}function ma(e,t=null){return{type:2,steps:e,options:t}}function ya(e){return{type:6,styles:e,offset:null}}function va(e){Promise.resolve(null).then(e)}class ba{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){va(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class _a{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const i=this.players.length;0==i?va(()=>this._onFinish()):this.players.forEach(e=>{e.onDone(()=>{++t==i&&this._onFinish()}),e.onDestroy(()=>{++n==i&&this._onDestroy()}),e.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((e,t)=>Math.max(e,t.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(e=>{const n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}getPosition(){const e=this.players.reduce((e,t)=>null===e||t.totalTime>e.totalTime?t:e,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}function wa(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Ca(e){switch(e.length){case 0:return new ba;case 1:return e[0];default:return new _a(e)}}function Ea(e,t,n,r,i={},o={}){const s=[],a=[];let c=-1,l=null;if(r.forEach(e=>{const n=e.offset,r=n==c,u=r&&l||{};Object.keys(e).forEach(n=>{let r=n,a=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,s),a){case"!":a=i[n];break;case"*":a=o[n];break;default:a=t.normalizeStyleValue(n,r,a,s)}u[r]=a}),r||a.push(u),l=u,c=n}),s.length){const e="\n - ";throw new Error(`Unable to animate due to the following errors:${e}${s.join(e)}`)}return a}function Oa(e,t,n,r){switch(t){case"start":e.onStart(()=>r(n&&Sa(n,"start",e)));break;case"done":e.onDone(()=>r(n&&Sa(n,"done",e)));break;case"destroy":e.onDestroy(()=>r(n&&Sa(n,"destroy",e)))}}function Sa(e,t,n){const r=n.totalTime,i=Pa(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==r?e.totalTime:r,!!n.disabled),o=e._data;return null!=o&&(i._data=o),i}function Pa(e,t,n,r,i="",o=0,s){return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!s}}function Ia(e,t,n){let r;return e instanceof Map?(r=e.get(t),r||e.set(t,r=n)):(r=e[t],r||(r=e[t]=n)),r}function Ta(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let Aa=(e,t)=>!1,ka=(e,t)=>!1,Na=(e,t,n)=>[];const Ma=wa();(Ma||"undefined"!=typeof Element)&&(Aa=(e,t)=>e.contains(t),ka=(()=>{if(Ma||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,n)=>t.apply(e,[n]):ka}})(),Na=(e,t,n)=>{let r=[];if(n){const n=e.querySelectorAll(t);for(let e=0;e<n.length;e++)r.push(n[e])}else{const n=e.querySelector(t);n&&r.push(n)}return r});let xa=null,Ra=!1;function Da(e){xa||(xa=("undefined"!=typeof document?document.body:null)||{},Ra=!!xa.style&&"WebkitAppearance"in xa.style);let t=!0;return xa.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in xa.style,!t&&Ra)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in xa.style),t}const La=ka,Ba=Aa,Fa=Na;function ja(e){const t={};return Object.keys(e).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}let Ua=(()=>{class e{validateStyleProperty(e){return Da(e)}matchesElement(e,t){return La(e,t)}containsElement(e,t){return Ba(e,t)}query(e,t,n){return Fa(e,t,n)}computeStyle(e,t,n){return n||""}animate(e,t,n,r,i,o=[],s){return new ba(n,r)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),Va=(()=>{class e{}return e.NOOP=new Ua,e})();function za(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Ha(parseFloat(t[1]),t[2])}function Ha(e,t){switch(t){case"s":return 1e3*e;default:return e}}function Ga(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){let r,i=0,o="";if("string"==typeof e){const n=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return t.push(`The provided timing value "${e}" is invalid.`),{duration:0,delay:0,easing:""};r=Ha(parseFloat(n[1]),n[2]);const s=n[3];null!=s&&(i=Ha(parseFloat(s),n[4]));const a=n[5];a&&(o=a)}else r=e;if(!n){let n=!1,o=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&t.splice(o,0,`The provided timing value "${e}" is invalid.`)}return{duration:r,delay:i,easing:o}}(e,t,n)}function $a(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function qa(e,t,n={}){if(t)for(let r in e)n[r]=e[r];else $a(e,n);return n}function Wa(e,t,n){return n?t+":"+n+";":""}function Za(e){let t="";for(let n=0;n<e.style.length;n++){const r=e.style.item(n);t+=Wa(0,r,e.style.getPropertyValue(r))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=Wa(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[n]));e.setAttribute("style",t)}function Qa(e,t,n){e.style&&(Object.keys(t).forEach(r=>{const i=rc(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),wa()&&Za(e))}function Ya(e,t){e.style&&(Object.keys(t).forEach(t=>{const n=rc(t);e.style[n]=""}),wa()&&Za(e))}function Ka(e){return Array.isArray(e)?1==e.length?e[0]:ma(e):e}const Ja=new RegExp("{{\\s*(.+?)\\s*}}","g");function Xa(e){let t=[];if("string"==typeof e){let n;for(;n=Ja.exec(e);)t.push(n[1]);Ja.lastIndex=0}return t}function ec(e,t,n){const r=e.toString(),i=r.replace(Ja,(e,r)=>{let i=t[r];return t.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?e:i}function tc(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const nc=/-+([a-z0-9])/g;function rc(e){return e.replace(nc,(...e)=>e[1].toUpperCase())}function ic(e,t){return 0===e||0===t}function oc(e,t,n){const r=Object.keys(n);if(r.length&&t.length){let o=t[0],s=[];if(r.forEach(e=>{o.hasOwnProperty(e)||s.push(e),o[e]=n[e]}),s.length)for(var i=1;i<t.length;i++){let n=t[i];s.forEach(function(t){n[t]=ac(e,t)})}}return t}function sc(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error(`Unable to resolve animation metadata node #${t.type}`)}}function ac(e,t){return window.getComputedStyle(e)[t]}function cc(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(e=>function(e,t,n){if(":"==e[0]){const r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return t.push(`The transition alias value "${e}" is not supported`),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}const r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${e}" is not supported`),t;const i=r[1],o=r[2],s=r[3];t.push(hc(i,s)),"<"!=o[0]||"*"==i&&"*"==s||t.push(hc(s,i))}(e,n,t)):n.push(e),n}const lc=new Set(["true","1"]),uc=new Set(["false","0"]);function hc(e,t){const n=lc.has(e)||uc.has(e),r=lc.has(t)||uc.has(t);return(i,o)=>{let s="*"==e||e==i,a="*"==t||t==o;return!s&&n&&"boolean"==typeof i&&(s=i?lc.has(e):uc.has(e)),!a&&r&&"boolean"==typeof o&&(a=o?lc.has(t):uc.has(t)),s&&a}}const dc=new RegExp("s*:selfs*,?","g");function fc(e,t,n){return new pc(e).build(t,n)}class pc{constructor(e){this._driver=e}build(e,t){const n=new gc(t);return this._resetContextStyleTimingState(n),sc(this,Ka(e),n)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const i=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(e=>{if(this._resetContextStyleTimingState(t),0==e.type){const n=e,r=n.name;r.toString().split(/\s*,\s*/).forEach(e=>{n.name=e,i.push(this.visitState(n,t))}),n.name=r}else if(1==e.type){const i=this.visitTransition(e,t);n+=i.queryCount,r+=i.depCount,o.push(i)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:i,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const i=new Set,o=r||{};if(n.styles.forEach(e=>{if(mc(e)){const t=e;Object.keys(t).forEach(e=>{Xa(t[e]).forEach(e=>{o.hasOwnProperty(e)||i.add(e)})})}}),i.size){const n=tc(i.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=sc(this,Ka(e.animation),t);return{type:1,matchers:cc(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:yc(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(e=>sc(this,e,t)),options:yc(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const i=e.steps.map(e=>{t.currentTime=n;const i=sc(this,e,t);return r=Math.max(r,t.currentTime),i});return t.currentTime=r,{type:3,steps:i,options:yc(e.options)}}visitAnimate(e,t){const n=function(e,t){let n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return vc(Ga(e,t).duration,0,"");const r=e;if(r.split(/\s+/).some(e=>"{"==e.charAt(0)&&"{"==e.charAt(1))){const e=vc(0,0,"");return e.dynamic=!0,e.strValue=r,e}return n=n||Ga(r,t),vc(n.duration,n.delay,n.easing)}(e.timings,t.errors);let r;t.currentAnimateTimings=n;let i=e.styles?e.styles:ya({});if(5==i.type)r=this.visitKeyframes(i,t);else{let i=e.styles,o=!1;if(!i){o=!0;const e={};n.easing&&(e.easing=n.easing),i=ya(e)}t.currentTime+=n.duration+n.delay;const s=this.visitStyle(i,t);s.isEmptyStep=o,r=s}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(e=>{"string"==typeof e?"*"==e?n.push(e):t.errors.push(`The provided style string value ${e} is not allowed.`):n.push(e)}):n.push(e.styles);let r=!1,i=null;return n.forEach(e=>{if(mc(e)){const t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(let e in t)if(t[e].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,i=t.currentTime;n&&i>0&&(i-=n.duration+n.delay),e.styles.forEach(e=>{"string"!=typeof e&&Object.keys(e).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void t.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const o=t.collectedStyles[t.currentQuerySelector],s=o[n];let a=!0;s&&(i!=r&&i>=s.startTime&&r<=s.endTime&&(t.errors.push(`The CSS property "${n}" that exists between the times of "${s.startTime}ms" and "${s.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=s.startTime),a&&(o[n]={startTime:i,endTime:r}),t.options&&function(e,t,n){const r=t.params||{},i=Xa(e);i.length&&i.forEach(e=>{r.hasOwnProperty(e)||n.push(`Unable to resolve the local animation param ${e} in the given list of values`)})}(e[n],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let o=!1,s=!1,a=0;const c=e.steps.map(e=>{const n=this._makeStyleAst(e,t);let c=null!=n.offset?n.offset:function(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(e=>{if(mc(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}});else if(mc(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(n.styles),l=0;return null!=c&&(r++,l=n.offset=c),s=s||l<0||l>1,o=o||l<a,a=l,i.push(l),n});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");const l=e.steps.length;let u=0;r>0&&r<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(u=1/(l-1));const h=l-1,d=t.currentTime,f=t.currentAnimateTimings,p=f.duration;return c.forEach((e,r)=>{const o=u>0?r==h?1:u*r:i[r],s=o*p;t.currentTime=d+f.delay+s,f.duration=s,this._validateStyleAst(e,t),e.offset=o,n.styles.push(e)}),n}visitReference(e,t){return{type:8,animation:sc(this,Ka(e.animation),t),options:yc(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:yc(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:yc(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[i,o]=function(e){const t=!!e.split(/\s*,\s*/).find(e=>":self"==e);return t&&(e=e.replace(dc,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,e=>".ng-trigger-"+e.substr(1)).replace(/:animating/g,".ng-animating"),t]}(e.selector);t.currentQuerySelector=n.length?n+" "+i:i,Ia(t.collectedStyles,t.currentQuerySelector,{});const s=sc(this,Ka(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:e.selector,options:yc(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Ga(e.timings,t.errors,!0);return{type:12,animation:sc(this,Ka(e.animation),t),timings:n,options:null}}}class gc{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function mc(e){return!Array.isArray(e)&&"object"==typeof e}function yc(e){var t;return e?(e=$a(e)).params&&(e.params=(t=e.params)?$a(t):null):e={},e}function vc(e,t,n){return{duration:e,delay:t,easing:n}}function bc(e,t,n,r,i,o,s=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class _c{constructor(){this._map=new Map}consume(e){let t=this._map.get(e);return t?this._map.delete(e):t=[],t}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const wc=new RegExp(":enter","g"),Cc=new RegExp(":leave","g");function Ec(e,t,n,r,i,o={},s={},a,c,l=[]){return(new Oc).buildKeyframes(e,t,n,r,i,o,s,a,c,l)}class Oc{buildKeyframes(e,t,n,r,i,o,s,a,c,l=[]){c=c||new _c;const u=new Pc(e,t,c,r,i,l,[]);u.options=a,u.currentTimeline.setStyles([o],null,u.errors,a),sc(this,n,u);const h=u.timelines.filter(e=>e.containsAnimation());if(h.length&&Object.keys(s).length){const e=h[h.length-1];e.allowOnlyTimelineStyles()||e.setStyles([s],null,u.errors,a)}return h.length?h.map(e=>e.buildKeyframes()):[bc(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.consume(t.element);if(n){const r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let r=t.currentTimeline.currentTime;const i=null!=n.duration?za(n.duration):null,o=null!=n.delay?za(n.delay):null;return 0!==i&&e.forEach(e=>{const n=t.appendInstructionToTimeline(e,i,o);r=Math.max(r,n.duration+n.delay)}),r}visitReference(e,t){t.updateOptions(e.options,!0),sc(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const i=e.options;if(i&&(i.params||i.delay)&&(r=t.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Sc);const e=za(i.delay);r.delayNextStep(e)}e.steps.length&&(e.steps.forEach(e=>sc(this,e,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const i=e.options&&e.options.delay?za(e.options.delay):0;e.steps.forEach(o=>{const s=t.createSubContext(e.options);i&&s.delayNextStep(i),sc(this,o,s),r=Math.max(r,s.currentTimeline.currentTime),n.push(s.currentTimeline)}),n.forEach(e=>t.currentTimeline.mergeTimelineCollectedStyles(e)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Ga(t.params?ec(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,o=t.createSubContext().currentTimeline;o.easing=n.easing,e.styles.forEach(e=>{o.forwardTime((e.offset||0)*i),o.setStyles(e.styles,e.easing,t.errors,t.options),o.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(o),t.transformIntoNewTimeline(r+i),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},i=r.delay?za(r.delay):0;i&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Sc);let o=n;const s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=s.length;let a=null;s.forEach((n,r)=>{t.currentQueryIndex=r;const s=t.createSubContext(e.options,n);i&&s.delayNextStep(i),n===t.element&&(a=s.currentTimeline),sc(this,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),a&&(t.currentTimeline.mergeTimelineCollectedStyles(a),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,i=e.timings,o=Math.abs(i.duration),s=o*(t.currentQueryTotal-1);let a=o*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=s-a;break;case"full":a=n.currentStaggerTime}const c=t.currentTimeline;a&&c.delayNextStep(a);const l=c.currentTime;sc(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-l+(r.startTime-n.currentTimeline.startTime)}}const Sc={};class Pc{constructor(e,t,n,r,i,o,s,a){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Sc,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new Ic(this._driver,t,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=za(n.duration)),null!=n.delay&&(r.delay=za(n.delay));const i=n.params;if(i){let e=r.params;e||(e=this.options.params={}),Object.keys(i).forEach(n=>{t&&e.hasOwnProperty(n)||(e[n]=ec(i[n],e,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(e=>{n[e]=t[e]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,i=new Pc(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(e),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(e){return this.previousNode=Sc,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new Tc(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,i,o){let s=[];if(r&&s.push(this.element),e.length>0){e=(e=e.replace(wc,"."+this._enterClassName)).replace(Cc,"."+this._leaveClassName);let t=this._driver.query(this.element,e,1!=n);0!==n&&(t=n<0?t.slice(t.length+n,t.length):t.slice(0,n)),s.push(...t)}return i||0!=s.length||o.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),s}}class Ic{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Ic(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||"*",this._currentKeyframe[e]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&(this._previousKeyframe.easing=t);const i=r&&r.params||{},o=function(e,t){const n={};let r;return e.forEach(e=>{"*"===e?(r=r||Object.keys(t),r.forEach(e=>{n[e]="*"})):qa(e,!1,n)}),n}(e,this._globalTimelineStyles);Object.keys(o).forEach(e=>{const t=ec(o[e],i,n);this._pendingStyles[e]=t,this._localTimelineStyles.hasOwnProperty(e)||(this._backFill[e]=this._globalTimelineStyles.hasOwnProperty(e)?this._globalTimelineStyles[e]:"*"),this._updateStyle(e,t)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(t=>{this._currentKeyframe[t]=e[t]}),Object.keys(this._localTimelineStyles).forEach(e=>{this._currentKeyframe.hasOwnProperty(e)||(this._currentKeyframe[e]=this._localTimelineStyles[e])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],r=e._styleSummary[t];(!n||r.time>n.time)&&this._updateStyle(t,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,o)=>{const s=qa(i,!0);Object.keys(s).forEach(n=>{const r=s[n];"!"==r?e.add(n):"*"==r&&t.add(n)}),n||(s.offset=o/this.duration),r.push(s)});const i=e.size?tc(e.values()):[],o=t.size?tc(t.values()):[];if(n){const e=r[0],t=$a(e);e.offset=0,t.offset=1,r=[e,t]}return bc(this.element,r,i,o,this.duration,this.startTime,this.easing,!1)}}class Tc extends Ic{constructor(e,t,n,r,i,o,s=!1){super(e,t,o.delay),this.element=t,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=s,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const i=[],o=n+t,s=t/o,a=qa(e[0],!1);a.offset=0,i.push(a);const c=qa(e[0],!1);c.offset=Ac(s),i.push(c);const l=e.length-1;for(let r=1;r<=l;r++){let s=qa(e[r],!1);s.offset=Ac((t+s.offset*n)/o),i.push(s)}n=o,t=0,r="",e=i}return bc(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function Ac(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class kc{}class Nc extends kc{normalizePropertyName(e,t){return rc(e)}normalizeStyleValue(e,t,n,r){let i="";const o=n.toString().trim();if(Mc[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const t=n.match(/^[+-]?[\d\.]+([a-z]*)$/);t&&0==t[1].length&&r.push(`Please provide a CSS unit value for ${e}:${n}`)}return o+i}}const Mc=(()=>function(e){const t={};return e.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function xc(e,t,n,r,i,o,s,a,c,l,u,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:h,errors:d}}const Rc={};class Dc{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function(e,t,n,r,i){return e.some(e=>e(t,n,r,i))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){const r=this._stateStyles["*"],i=this._stateStyles[e],o=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):o}build(e,t,n,r,i,o,s,a,c,l){const u=[],h=this.ast.options&&this.ast.options.params||Rc,d=this.buildStyles(n,s&&s.params||Rc,u),f=a&&a.params||Rc,p=this.buildStyles(r,f,u),g=new Set,m=new Map,y=new Map,v="void"===r,b={params:Object.assign(Object.assign({},h),f)},_=l?[]:Ec(e,t,this.ast.animation,i,o,d,p,b,c,u);let w=0;if(_.forEach(e=>{w=Math.max(e.duration+e.delay,w)}),u.length)return xc(t,this._triggerName,n,r,v,d,p,[],[],m,y,w,u);_.forEach(e=>{const n=e.element,r=Ia(m,n,{});e.preStyleProps.forEach(e=>r[e]=!0);const i=Ia(y,n,{});e.postStyleProps.forEach(e=>i[e]=!0),n!==t&&g.add(n)});const C=tc(g.values());return xc(t,this._triggerName,n,r,v,d,p,_,C,m,y,w)}}class Lc{constructor(e,t){this.styles=e,this.defaultParams=t}buildStyles(e,t){const n={},r=$a(this.defaultParams);return Object.keys(e).forEach(t=>{const n=e[t];null!=n&&(r[t]=n)}),this.styles.styles.forEach(e=>{if("string"!=typeof e){const i=e;Object.keys(i).forEach(e=>{let o=i[e];o.length>1&&(o=ec(o,r,t)),n[e]=o})}}),n}}class Bc{constructor(e,t){this.name=e,this.ast=t,this.transitionFactories=[],this.states={},t.states.forEach(e=>{this.states[e.name]=new Lc(e.style,e.options&&e.options.params||{})}),Fc(this.states,"true","1"),Fc(this.states,"false","0"),t.transitions.forEach(t=>{this.transitionFactories.push(new Dc(e,t,this.states))}),this.fallbackTransition=new Dc(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(e,t)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(i=>i.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function Fc(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const jc=new _c;class Uc{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],r=fc(this._driver,t,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[e]=r}_buildPlayer(e,t,n){const r=e.element,i=Ea(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],i=this._animations[e];let o;const s=new Map;if(i?(o=Ec(this._driver,t,i,"ng-enter","ng-leave",{},{},n,jc,r),o.forEach(e=>{const t=Ia(s,e.element,{});e.postStyleProps.forEach(e=>t[e]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),o=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);s.forEach((e,t)=>{Object.keys(e).forEach(n=>{e[n]=this._driver.computeStyle(t,n,"*")})});const a=Ca(o.map(e=>{const t=s.get(e.element);return this._buildPlayer(e,{},t)}));return this._playersById[e]=a,a.onDestroy(()=>this.destroy(e)),this.players.push(a),a}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,n,r){const i=Pa(t,"","","");return Oa(this._getPlayer(e),n,i,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const Vc=[],zc={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Hc={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class Gc{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=null!=(r=n?e.value:e)?r:null,n){const t=$a(e);delete t.value,this.options=t}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const e=this.options.params;Object.keys(t).forEach(n=>{null==e[n]&&(e[n]=t[n])})}}}const $c=new Gc("void");class qc{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Xc(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${t}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${t}" is not supported!`);var i;const o=Ia(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);const a=Ia(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(Xc(e,"ng-trigger"),Xc(e,"ng-trigger-"+t),a[t]=$c),()=>{this._engine.afterFlush(()=>{const e=o.indexOf(s);e>=0&&o.splice(e,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,n,r=!0){const i=this._getTrigger(t),o=new Zc(this.id,t,e);let s=this._engine.statesByElement.get(e);s||(Xc(e,"ng-trigger"),Xc(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,s={}));let a=s[t];const c=new Gc(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&c.absorbOptions(a.options),s[t]=c,a||(a=$c),"void"!==c.value&&a.value===c.value){if(!function(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!t.hasOwnProperty(r)||e[r]!==t[r])return!1}return!0}(a.params,c.params)){const t=[],n=i.matchStyles(a.value,a.params,t),r=i.matchStyles(c.value,c.params,t);t.length?this._engine.reportError(t):this._engine.afterFlush(()=>{Ya(e,n),Qa(e,r)})}return}const l=Ia(this._engine.playersByElement,e,[]);l.forEach(e=>{e.namespaceId==this.id&&e.triggerName==t&&e.queued&&e.destroy()});let u=i.matchTransition(a.value,c.value,e,c.params),h=!1;if(!u){if(!r)return;u=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:u,fromState:a,toState:c,player:o,isFallbackTransition:h}),h||(Xc(e,"ng-animate-queued"),o.onStart(()=>{el(e,"ng-animate-queued")})),o.onDone(()=>{let t=this.players.indexOf(o);t>=0&&this.players.splice(t,1);const n=this._engine.playersByElement.get(e);if(n){let e=n.indexOf(o);e>=0&&n.splice(e,1)}}),this.players.push(o),l.push(o),o}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(t=>t.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(e=>e.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,".ng-trigger",!0);n.forEach(e=>{if(e.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(e);n.size?n.forEach(n=>n.triggerLeaveAnimation(e,t,!1,!0)):this.clearElementCache(e)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(e=>this.clearElementCache(e)))}triggerLeaveAnimation(e,t,n,r){const i=this._engine.statesByElement.get(e);if(i){const o=[];if(Object.keys(i).forEach(t=>{if(this._triggers[t]){const n=this.trigger(e,t,"void",r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&Ca(o).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(t=>{const i=t.name;if(r.has(i))return;r.add(i);const o=this._triggers[i].fallbackTransition,s=n[i]||$c,a=new Gc("void"),c=new Zc(this.id,i,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:i,transition:o,fromState:s,toState:a,player:c,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const t=n.players.length?n.playersByQueriedElement.get(e):[];if(t&&t.length)r=!0;else{let t=e;for(;t=t.parentNode;)if(n.statesByElement.get(t)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const r=e.__ng_removed;r&&r!==zc||(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Xc(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,o=this._elementListeners.get(i);o&&o.forEach(t=>{if(t.name==n.triggerName){const r=Pa(i,n.triggerName,n.fromState.value,n.toState.value);r._data=e,Oa(n.player,t.phase,r,t.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((e,t)=>{const n=e.transition.ast.depCount,r=t.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(e.element,t.element)?1:-1})}destroy(e){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(t=>t.element===e)||t,t}}class Wc{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(e,t)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(t=>{t.queued&&e.push(t)})}),e}createNamespace(e,t){const n=new qc(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const t=this._namespaceList.indexOf(n);t>=0&&this._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const e=Object.keys(n);for(let r=0;r<e.length;r++){const i=n[e[r]].namespaceId;if(i){const e=this._fetchNamespace(i);e&&t.add(e)}}}return t}trigger(e,t,n,r){if(Qc(t)){const i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!Qc(t))return;const i=t.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const e=this.collectedLeaveElements.indexOf(t);e>=0&&this.collectedLeaveElements.splice(e,1)}if(e){const r=this._fetchNamespace(e);r&&r.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Xc(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),el(e,"ng-animate-disabled"))}removeNode(e,t,n,r){if(Qc(t)){const i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const n=this.namespacesByHostElement.get(t);n&&n.id!==e&&n.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(e,t,n,r,i){return Qc(t)?this._fetchNamespace(e).listen(t,n,r,i):()=>{}}_buildInstruction(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}destroyInnerAnimations(e){let t=this.driver.query(e,".ng-trigger",!0);t.forEach(e=>this.destroyActiveAnimationsForElement(e)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,".ng-animating",!0),t.forEach(e=>this.finishActiveQueriedAnimationOnElement(e)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(e=>{e.queued?e.markedForDestroy=!0:e.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(e=>e.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Ca(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e.__ng_removed;if(t&&t.setForRemoval){if(e.__ng_removed=zc,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(e=>{this.markElementAsDisabled(e,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((e,t)=>this._balanceNamespaceList(e,t)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Xc(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let e=0;e<n.length;e++)n[e]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(e=>e()),this._flushFns=[],this._whenQuietFns.length){const e=this._whenQuietFns;this._whenQuietFns=[],t.length?Ca(t).onDone(()=>{e.forEach(e=>e())}):e.forEach(e=>e())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const n=new _c,r=[],i=new Map,o=[],s=new Map,a=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(e=>{l.add(e);const t=this.driver.query(e,".ng-animate-queued",!0);for(let n=0;n<t.length;n++)l.add(t[n])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Jc(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((e,t)=>{const n="ng-enter"+p++;f.set(t,n),e.forEach(e=>Xc(e,n))});const g=[],m=new Set,y=new Set;for(let k=0;k<this.collectedLeaveElements.length;k++){const e=this.collectedLeaveElements[k],t=e.__ng_removed;t&&t.setForRemoval&&(g.push(e),m.add(e),t.hasAnimation?this.driver.query(e,".ng-star-inserted",!0).forEach(e=>m.add(e)):y.add(e))}const v=new Map,b=Jc(h,Array.from(m));b.forEach((e,t)=>{const n="ng-leave"+p++;v.set(t,n),e.forEach(e=>Xc(e,n))}),e.push(()=>{d.forEach((e,t)=>{const n=f.get(t);e.forEach(e=>el(e,n))}),b.forEach((e,t)=>{const n=v.get(t);e.forEach(e=>el(e,n))}),g.forEach(e=>{this.processLeaveNode(e)})});const _=[],w=[];for(let k=this._namespaceList.length-1;k>=0;k--)this._namespaceList[k].drainQueuedTransitions(t).forEach(e=>{const t=e.player,i=e.element;if(_.push(t),this.collectedEnterElements.length){const e=i.__ng_removed;if(e&&e.setForMove)return void t.destroy()}const l=!u||!this.driver.containsElement(u,i),h=v.get(i),d=f.get(i),p=this._buildInstruction(e,n,d,h,l);if(p.errors&&p.errors.length)w.push(p);else{if(l)return t.onStart(()=>Ya(i,p.fromStyles)),t.onDestroy(()=>Qa(i,p.toStyles)),void r.push(t);if(e.isFallbackTransition)return t.onStart(()=>Ya(i,p.fromStyles)),t.onDestroy(()=>Qa(i,p.toStyles)),void r.push(t);p.timelines.forEach(e=>e.stretchStartingKeyframe=!0),n.append(i,p.timelines),o.push({instruction:p,player:t,element:i}),p.queriedElements.forEach(e=>Ia(s,e,[]).push(t)),p.preStyleProps.forEach((e,t)=>{const n=Object.keys(e);if(n.length){let e=a.get(t);e||a.set(t,e=new Set),n.forEach(t=>e.add(t))}}),p.postStyleProps.forEach((e,t)=>{const n=Object.keys(e);let r=c.get(t);r||c.set(t,r=new Set),n.forEach(e=>r.add(e))})}});if(w.length){const e=[];w.forEach(t=>{e.push(`@${t.triggerName} has failed due to:\n`),t.errors.forEach(t=>e.push(`- ${t}\n`))}),_.forEach(e=>e.destroy()),this.reportError(e)}const C=new Map,E=new Map;o.forEach(e=>{const t=e.element;n.has(t)&&(E.set(t,t),this._beforeAnimationBuild(e.player.namespaceId,e.instruction,C))}),r.forEach(e=>{const t=e.element;this._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(e=>{Ia(C,t,[]).push(e),e.destroy()})});const O=g.filter(e=>rl(e,a,c)),S=new Map;Kc(S,this.driver,y,c,"*").forEach(e=>{rl(e,a,c)&&O.push(e)});const P=new Map;d.forEach((e,t)=>{Kc(P,this.driver,new Set(e),a,"!")}),O.forEach(e=>{const t=S.get(e),n=P.get(e);S.set(e,Object.assign(Object.assign({},t),n))});const I=[],T=[],A={};o.forEach(e=>{const{element:t,player:o,instruction:s}=e;if(n.has(t)){if(l.has(t))return o.onDestroy(()=>Qa(t,s.toStyles)),o.disabled=!0,o.overrideTotalTime(s.totalTime),void r.push(o);let e=A;if(E.size>1){let n=t;const r=[];for(;n=n.parentNode;){const t=E.get(n);if(t){e=t;break}r.push(n)}r.forEach(t=>E.set(t,e))}const n=this._buildAnimation(o.namespaceId,s,C,i,P,S);if(o.setRealPlayer(n),e===A)I.push(o);else{const t=this.playersByElement.get(e);t&&t.length&&(o.parentPlayer=Ca(t)),r.push(o)}}else Ya(t,s.fromStyles),o.onDestroy(()=>Qa(t,s.toStyles)),T.push(o),l.has(t)&&r.push(o)}),T.forEach(e=>{const t=i.get(e.element);if(t&&t.length){const n=Ca(t);e.setRealPlayer(n)}}),r.forEach(e=>{e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(let k=0;k<g.length;k++){const e=g[k],t=e.__ng_removed;if(el(e,"ng-leave"),t&&t.hasAnimation)continue;let n=[];if(s.size){let t=s.get(e);t&&t.length&&n.push(...t);let r=this.driver.query(e,".ng-animating",!0);for(let e=0;e<r.length;e++){let t=s.get(r[e]);t&&t.length&&n.push(...t)}}const r=n.filter(e=>!e.destroyed);r.length?tl(this,e,r):this.processLeaveNode(e)}return g.length=0,I.forEach(e=>{this.players.push(e),e.onDone(()=>{e.destroy();const t=this.players.indexOf(e);this.players.splice(t,1)}),e.play()}),I}elementContainsData(e,t){let n=!1;const r=t.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,i){let o=[];if(t){const t=this.playersByQueriedElement.get(e);t&&(o=t)}else{const t=this.playersByElement.get(e);if(t){const e=!i||"void"==i;t.forEach(t=>{t.queued||(e||t.triggerName==r)&&o.push(t)})}}return(n||r)&&(o=o.filter(e=>!(n&&n!=e.namespaceId||r&&r!=e.triggerName))),o}_beforeAnimationBuild(e,t,n){const r=t.element,i=t.isRemovalTransition?void 0:e,o=t.isRemovalTransition?void 0:t.triggerName;for(const s of t.timelines){const e=s.element,a=e!==r,c=Ia(n,e,[]);this._getPreviousPlayers(e,a,i,o,t.toState).forEach(e=>{const t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})}Ya(r,t.fromStyles)}_buildAnimation(e,t,n,r,i,o){const s=t.triggerName,a=t.element,c=[],l=new Set,u=new Set,h=t.timelines.map(t=>{const h=t.element;l.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new ba(t.duration,t.delay);const f=h!==a,p=function(e){const t=[];return nl(e,t),t}((n.get(h)||Vc).map(e=>e.getRealPlayer())).filter(e=>!!e.element&&e.element===h),g=i.get(h),m=o.get(h),y=Ea(0,this._normalizer,0,t.keyframes,g,m),v=this._buildPlayer(t,y,p);if(t.subTimeline&&r&&u.add(h),f){const t=new Zc(e,s,h);t.setRealPlayer(v),c.push(t)}return v});c.forEach(e=>{Ia(this.playersByQueriedElement,e.element,[]).push(e),e.onDone(()=>function(e,t,n){let r;if(e instanceof Map){if(r=e.get(t),r){if(r.length){const e=r.indexOf(n);r.splice(e,1)}0==r.length&&e.delete(t)}}else if(r=e[t],r){if(r.length){const e=r.indexOf(n);r.splice(e,1)}0==r.length&&delete e[t]}return r}(this.playersByQueriedElement,e.element,e))}),l.forEach(e=>Xc(e,"ng-animating"));const d=Ca(h);return d.onDestroy(()=>{l.forEach(e=>el(e,"ng-animating")),Qa(a,t.toStyles)}),u.forEach(e=>{Ia(r,e,[]).push(d)}),d}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new ba(e.duration,e.delay)}}class Zc{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new ba,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>Oa(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Ia(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Qc(e){return e&&1===e.nodeType}function Yc(e,t){const n=e.style.display;return e.style.display=null!=t?t:"none",n}function Kc(e,t,n,r,i){const o=[];n.forEach(e=>o.push(Yc(e)));const s=[];r.forEach((n,r)=>{const o={};n.forEach(e=>{const n=o[e]=t.computeStyle(r,e,i);n&&0!=n.length||(r.__ng_removed=Hc,s.push(r))}),e.set(r,o)});let a=0;return n.forEach(e=>Yc(e,o[a++])),s}function Jc(e,t){const n=new Map;if(e.forEach(e=>n.set(e,[])),0==t.length)return n;const r=new Set(t),i=new Map;function o(e){if(!e)return 1;let t=i.get(e);if(t)return t;const s=e.parentNode;return t=n.has(s)?s:r.has(s)?1:o(s),i.set(e,t),t}return t.forEach(e=>{const t=o(e);1!==t&&n.get(t).push(e)}),n}function Xc(e,t){if(e.classList)e.classList.add(t);else{let n=e.$$classes;n||(n=e.$$classes={}),n[t]=!0}}function el(e,t){if(e.classList)e.classList.remove(t);else{let n=e.$$classes;n&&delete n[t]}}function tl(e,t,n){Ca(n).onDone(()=>e.processLeaveNode(t))}function nl(e,t){for(let n=0;n<e.length;n++){const r=e[n];r instanceof _a?nl(r.players,t):t.push(r)}}function rl(e,t,n){const r=n.get(e);if(!r)return!1;let i=t.get(e);return i?r.forEach(e=>i.add(e)):t.set(e,r),n.delete(e),!0}class il{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._triggerCache={},this.onRemovalComplete=(e,t)=>{},this._transitionEngine=new Wc(e,t,n),this._timelineEngine=new Uc(e,t,n),this._transitionEngine.onRemovalComplete=(e,t)=>this.onRemovalComplete(e,t)}registerTrigger(e,t,n,r,i){const o=e+"-"+r;let s=this._triggerCache[o];if(!s){const e=[],t=fc(this._driver,i,e);if(e.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${e.join("\n - ")}`);s=function(e,t){return new Bc(e,t)}(r,t),this._triggerCache[o]=s}this._transitionEngine.registerTrigger(t,r,s)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[e,i]=Ta(n);this._timelineEngine.command(e,t,i,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,i){if("@"==n.charAt(0)){const[e,r]=Ta(n);return this._timelineEngine.listen(e,t,r,i)}return this._transitionEngine.listen(e,t,n,r,i)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function ol(e,t){let n=null,r=null;return Array.isArray(t)&&t.length?(n=al(t[0]),t.length>1&&(r=al(t[t.length-1]))):t&&(n=al(t)),n||r?new sl(e,n,r):null}let sl=(()=>{class e{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&Qa(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Qa(this._element,this._initialStyles),this._endStyles&&(Qa(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Ya(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ya(this._element,this._endStyles),this._endStyles=null),Qa(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function al(e){let t=null;const n=Object.keys(e);for(let r=0;r<n.length;r++){const i=n[r];cl(i)&&(t=t||{},t[i]=e[i])}return t}function cl(e){return"display"===e||"position"===e}class ll{constructor(e,t,n,r,i,o,s){this._element=e,this._name=t,this._duration=n,this._delay=r,this._easing=i,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=e=>this._handleCallback(e)}apply(){!function(e,t){const n=gl(e,"").trim();n.length&&(function(e,t){let n=0;for(let r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t=`${n}, ${t}`),pl(e,"",t)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),fl(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){ul(this._element,this._name,"paused")}resume(){ul(this._element,this._name,"running")}setPosition(e){const t=hl(this._element,this._name);this._position=e*this._duration,pl(this._element,"Delay",`-${this._position}ms`,t)}getPosition(){return this._position}_handleCallback(e){const t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),fl(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){const n=gl(e,"").split(","),r=dl(n,t);r>=0&&(n.splice(r,1),pl(e,"",n.join(",")))}(this._element,this._name))}}function ul(e,t,n){pl(e,"PlayState",n,hl(e,t))}function hl(e,t){const n=gl(e,"");return n.indexOf(",")>0?dl(n.split(","),t):dl([n],t)}function dl(e,t){for(let n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function fl(e,t,n){n?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function pl(e,t,n,r){const i="animation"+t;if(null!=r){const t=e.style[i];if(t.length){const e=t.split(",");e[r]=n,n=e.join(",")}}e.style[i]=n}function gl(e,t){return e.style["animation"+t]||""}class ml{constructor(e,t,n,r,i,o,s,a){this.element=e,this.keyframes=t,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=s,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=r+i,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new ll(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const t=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(e[n]=t?this._finalStyles[n]:ac(this.element,n))})}this.currentSnapshot=e}}class yl extends ba{constructor(e,t){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=ja(t)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(e=>{const t=this._startingStyles[e];t?this.element.style.setProperty(e,t):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class vl{constructor(){this._count=0,this._head=document.querySelector("head")}validateStyleProperty(e){return Da(e)}matchesElement(e,t){return La(e,t)}containsElement(e,t){return Ba(e,t)}query(e,t,n){return Fa(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}buildKeyframeElement(e,t,n){n=n.map(e=>ja(e));let r=`@keyframes ${t} {\n`,i="";n.forEach(e=>{i=" ";const t=parseFloat(e.offset);r+=`${i}${100*t}% {\n`,i+=" ",Object.keys(e).forEach(t=>{const n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${t}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const o=document.createElement("style");return o.textContent=r,o}animate(e,t,n,r,i,o=[],s){const a=o.filter(e=>e instanceof ml),c={};ic(n,r)&&a.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>c[e]=t[e])});const l=function(e){let t={};return e&&(Array.isArray(e)?e:[e]).forEach(e=>{Object.keys(e).forEach(n=>{"offset"!=n&&"easing"!=n&&(t[n]=e[n])})}),t}(t=oc(e,t,c));if(0==n)return new yl(e,l);const u="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(e,u,t);document.querySelector("head").appendChild(h);const d=ol(e,t),f=new ml(e,t,u,n,r,i,l,d);return f.onDestroy(()=>{var e;(e=h).parentNode.removeChild(e)}),f}}class bl{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(t=>{"offset"!=t&&(e[t]=this._finished?this._finalKeyframe[t]:ac(this.element,t))}),this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class _l{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(wl().toString()),this._cssKeyframesDriver=new vl}validateStyleProperty(e){return Da(e)}matchesElement(e,t){return La(e,t)}containsElement(e,t){return Ba(e,t)}query(e,t,n){return Fa(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,t,n,r,i,o=[],s){if(!s&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,o);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const c={},l=o.filter(e=>e instanceof bl);ic(n,r)&&l.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>c[e]=t[e])});const u=ol(e,t=oc(e,t=t.map(e=>qa(e,!1)),c));return new bl(e,t,a,u)}}function wl(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let Cl=(()=>{class e extends ga{constructor(e,t){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(t.body,{id:"0",encapsulation:r.R.None,styles:[],data:{animation:[]}})}build(e){const t=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(e)?ma(e):e;return Sl(this._renderer,null,t,"register",[n]),new El(t,this._renderer)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(r.F),r.Zb(s))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();class El extends class{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Ol(this._id,e,t||{},this._renderer)}}class Ol{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Sl(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function Sl(e,t,n,r,i){return e.setProperty(t,`@@${n}:${r}`,i)}let Pl=(()=>{class e{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),t.onRemovalComplete=(e,t)=>{t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}createRenderer(e,t){const n=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){let e=this._rendererCache.get(n);return e||(e=new Il("",n,this.engine),this._rendererCache.set(n,e)),e}const r=t.id,i=t.id+"-"+this._currentId;this._currentId++,this.engine.register(i,e);const o=t=>{Array.isArray(t)?t.forEach(o):this.engine.registerTrigger(r,i,e,t.name,t)};return t.data.animation.forEach(o),new Tl(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){e>=0&&e<this._microtaskId?this._zone.run(()=>t(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(e=>{const[t,n]=e;t(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(r.F),r.Zb(il),r.Zb(r.A))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();class Il{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?e=>t.destroyNode(e):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Tl extends Il{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e);let i=t.substr(1),o="";return"@"!=i.charAt(0)&&([i,o]=function(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(i)),this.engine.listen(this.namespaceId,r,i,o,e=>{this.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}let Al=(()=>{class e extends il{constructor(e,t,n){super(e.body,t,n)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s),r.Zb(Va),r.Zb(kc))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();const kl=[{provide:Va,useFactory:function(){return"function"==typeof wl()?new _l:new vl}},{provide:new r.r("AnimationModuleType"),useValue:"BrowserAnimations"},{provide:ga,useClass:Cl},{provide:kc,useFactory:function(){return new Nc}},{provide:il,useClass:Al},{provide:r.F,useFactory:function(e,t,n){return new Pl(e,t,n)},deps:[Ue,il,r.A]}];let Nl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({providers:kl,imports:[tt]}),e})();var Ml=n("Hfs6"),xl=n.n(Ml),Rl=n("spgP"),Dl=n("D0XW");function Ll(){return e=>e.lift(new Bl)}class Bl{call(e,t){return t.subscribe(new Fl(e))}}class Fl extends Hn.a{constructor(e){super(e),this.hasPrev=!1}_next(e){let t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}class jl{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Ul(e,this.compare,this.keySelector))}}class Ul extends Hn.a{constructor(e,t,n){super(e),this.keySelector=n,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:n}=this;t=n?n(e):e}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:e}=this;n=e(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=t,this.destination.next(e))}}var Vl=n("pxpQ"),zl=n("Jgta"),Hl=n("zIRd"),Gl=n("mrSG"),$l=n("qOnz"),ql=n("q/0M"),Wl=function(e,t){return(Wl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Zl(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var Ql,Yl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Kl=Kl||{},Jl=Yl||self;function Xl(){}function eu(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function tu(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var nu="closure_uid_"+(1e9*Math.random()>>>0),ru=0;function iu(e,t,n){return e.call.apply(e.bind,arguments)}function ou(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function su(e,t,n){return(su=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?iu:ou).apply(null,arguments)}function au(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function cu(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function lu(){this.s=this.s,this.o=this.o}var uu={};lu.prototype.s=!1,lu.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,nu)&&e[nu]||(e[nu]=++ru)}(this);delete uu[e]}},lu.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var hu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},du=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function fu(e){return Array.prototype.concat.apply([],arguments)}function pu(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function gu(e){return/^[\s\xa0]*$/.test(e)}var mu,yu=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function vu(e,t){return-1!=e.indexOf(t)}function bu(e,t){return e<t?-1:e>t?1:0}e:{var _u=Jl.navigator;if(_u){var wu=_u.userAgent;if(wu){mu=wu;break e}}mu=""}function Cu(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Eu(e){var t={};for(var n in e)t[n]=e[n];return t}var Ou="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Su(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<Ou.length;o++)n=Ou[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Pu(e){return Pu[" "](e),e}Pu[" "]=Xl;var Iu,Tu,Au=vu(mu,"Opera"),ku=vu(mu,"Trident")||vu(mu,"MSIE"),Nu=vu(mu,"Edge"),Mu=Nu||ku,xu=vu(mu,"Gecko")&&!(vu(mu.toLowerCase(),"webkit")&&!vu(mu,"Edge"))&&!(vu(mu,"Trident")||vu(mu,"MSIE"))&&!vu(mu,"Edge"),Ru=vu(mu.toLowerCase(),"webkit")&&!vu(mu,"Edge");function Du(){var e=Jl.document;return e?e.documentMode:void 0}e:{var Lu="",Bu=(Tu=mu,xu?/rv:([^\);]+)(\)|;)/.exec(Tu):Nu?/Edge\/([\d\.]+)/.exec(Tu):ku?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Tu):Ru?/WebKit\/(\S+)/.exec(Tu):Au?/(?:Version)[ \/]?(\S+)/.exec(Tu):void 0);if(Bu&&(Lu=Bu?Bu[1]:""),ku){var Fu=Du();if(null!=Fu&&Fu>parseFloat(Lu)){Iu=String(Fu);break e}}Iu=Lu}var ju={};var Uu=Jl.document&&ku&&(Du()||parseInt(Iu,10))||void 0,Vu=function(){if(!Jl.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Jl.addEventListener("test",Xl,t),Jl.removeEventListener("test",Xl,t)}catch(n){}return e}();function zu(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function Hu(e,t){if(zu.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(xu){e:{try{Pu(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Gu[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Hu.Z.h.call(this)}}zu.prototype.h=function(){this.defaultPrevented=!0},cu(Hu,zu);var Gu={2:"touch",3:"pen",4:"mouse"};Hu.prototype.h=function(){Hu.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var $u="closure_listenable_"+(1e6*Math.random()|0),qu=0;function Wu(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++qu,this.ca=this.fa=!1}function Zu(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function Qu(e){this.src=e,this.g={},this.h=0}function Yu(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=hu(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Zu(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Ku(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.ca&&o.listener==t&&o.capture==!!n&&o.ia==r)return i}return-1}Qu.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=Ku(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new Wu(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var Ju="closure_lm_"+(1e6*Math.random()|0),Xu={};function eh(e,t,n,r,i){if(r&&r.once)return nh(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)eh(e,t[o],n,r,i);return null}return n=lh(n),e&&e[$u]?e.N(t,n,tu(r)?!!r.capture:!!r,i):th(e,t,n,!1,r,i)}function th(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=tu(i)?!!i.capture:!!i,a=ah(e);if(a||(e[Ju]=a=new Qu(e)),(n=a.add(t,n,r,s,o)).proxy)return n;if(r=function(){var e=sh;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Vu||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(oh(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function nh(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)nh(e,t[o],n,r,i);return null}return n=lh(n),e&&e[$u]?e.O(t,n,tu(r)?!!r.capture:!!r,i):th(e,t,n,!0,r,i)}function rh(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)rh(e,t[o],n,r,i);else r=tu(r)?!!r.capture:!!r,n=lh(n),e&&e[$u]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=Ku(o=e.g[t],n,r,i))&&(Zu(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--))):e&&(e=ah(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Ku(t,n,r,i)),(n=-1<e?t[e]:null)&&ih(n))}function ih(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[$u])Yu(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(oh(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ah(t))?(Yu(n,e),0==n.h&&(n.src=null,t[Ju]=null)):Zu(e)}}}function oh(e){return e in Xu?Xu[e]:Xu[e]="on"+e}function sh(e,t){if(e.ca)e=!0;else{t=new Hu(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&ih(e),e=n.call(r,t)}return e}function ah(e){return(e=e[Ju])instanceof Qu?e:null}var ch="__closure_events_fn_"+(1e9*Math.random()>>>0);function lh(e){return"function"==typeof e?e:(e[ch]||(e[ch]=function(t){return e.handleEvent(t)}),e[ch])}function uh(){lu.call(this),this.i=new Qu(this),this.P=this,this.I=null}function hh(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new zu(t,e);else if(t instanceof zu)t.target=t.target||e;else{var i=t;Su(t=new zu(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];i=dh(s,r,!0,t)&&i}if(i=dh(s=t.g=e,r,!0,t)&&i,i=dh(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=dh(s=t.g=n[o],r,!1,t)&&i}function dh(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,c=s.ia||s.src;s.fa&&Yu(e.i,s),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}cu(uh,lu),uh.prototype[$u]=!0,uh.prototype.removeEventListener=function(e,t,n,r){rh(this,e,t,n,r)},uh.prototype.M=function(){if(uh.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Zu(n[r]);delete t.g[e],t.h--}}this.I=null},uh.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},uh.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var fh=Jl.JSON.stringify;function ph(){var e=Ch,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var gh,mh=function(){function e(){this.h=this.g=null}return e.prototype.add=function(e,t){var n=yh.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n},e}(),yh=new(function(){function e(e,t){this.i=e,this.j=t,this.h=0,this.g=null}return e.prototype.get=function(){var e;return 0<this.h?(this.h--,this.g=(e=this.g).next,e.next=null):e=this.i(),e},e}())(function(){return new vh},function(e){return e.reset()}),vh=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function bh(e){Jl.setTimeout(function(){throw e},0)}function _h(e,t){gh||function(){var e=Jl.Promise.resolve(void 0);gh=function(){e.then(Eh)}}(),wh||(gh(),wh=!0),Ch.add(e,t)}var wh=!1,Ch=new mh;function Eh(){for(var e;e=ph();){try{e.h.call(e.g)}catch(n){bh(n)}var t=yh;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}wh=!1}function Oh(e,t){uh.call(this),this.h=e||1,this.g=t||Jl,this.j=su(this.kb,this),this.l=Date.now()}function Sh(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Ph(e,t,n){if("function"==typeof e)n&&(e=su(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=su(e.handleEvent,e)}return 2147483647<Number(t)?-1:Jl.setTimeout(e,t||0)}function Ih(e){e.g=Ph(function(){e.g=null,e.i&&(e.i=!1,Ih(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}cu(Oh,uh),(Ql=Oh.prototype).da=!1,Ql.S=null,Ql.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),hh(this,"tick"),this.da&&(Sh(this),this.start()))}},Ql.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ql.M=function(){Oh.Z.M.call(this),Sh(this),delete this.g};var Th=function(e){function t(t,n){var r=e.call(this)||this;return r.m=t,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Wl(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:Ih(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(Jl.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(lu);function Ah(e){lu.call(this),this.h=e,this.g={}}cu(Ah,lu);var kh=[];function Nh(e,t,n,r){Array.isArray(n)||(n&&(kh[0]=n.toString()),n=kh);for(var i=0;i<n.length;i++){var o=eh(t,n[i],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}}function Mh(e){Cu(e.g,function(e,t){this.g.hasOwnProperty(t)&&ih(e)},e),e.g={}}function xh(){this.g=!0}function Rh(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return fh(n)}catch(a){return t}}(e,n)+(r?" "+r:"")})}Ah.prototype.M=function(){Ah.Z.M.call(this),Mh(this)},Ah.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},xh.prototype.Aa=function(){this.g=!1},xh.prototype.info=function(){};var Dh={},Lh=null;function Bh(){return Lh=Lh||new uh}function Fh(e){zu.call(this,Dh.Ma,e)}function jh(e){var t=Bh();hh(t,new Fh(t,e))}function Uh(e,t){zu.call(this,Dh.STAT_EVENT,e),this.stat=t}function Vh(e){var t=Bh();hh(t,new Uh(t,e))}function zh(e,t){zu.call(this,Dh.Na,e),this.size=t}function Hh(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Jl.setTimeout(function(){e()},t)}Dh.Ma="serverreachability",cu(Fh,zu),Dh.STAT_EVENT="statevent",cu(Uh,zu),Dh.Na="timingevent",cu(zh,zu);var Gh={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},$h={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function qh(){}function Wh(){}qh.prototype.h=null;var Zh,Qh={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Yh(){zu.call(this,"d")}function Kh(){zu.call(this,"c")}function Jh(){}function Xh(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Ah(this),this.P=td,this.W=new Oh(e=Mu?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ed}function ed(){this.i=null,this.g="",this.h=!1}cu(Yh,zu),cu(Kh,zu),cu(Jh,qh),Jh.prototype.g=function(){return new XMLHttpRequest},Jh.prototype.i=function(){return{}},Zh=new Jh;var td=45e3,nd={},rd={};function id(e,t,n){e.K=1,e.v=Id(wd(t)),e.s=n,e.U=!0,od(e,null)}function od(e,t){e.F=Date.now(),ld(e),e.A=wd(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),Ud(n.h,"t",r),e.C=0,n=e.l.H,e.h=new ed,e.g=zf(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Th(su(e.Ia,e,e.g),e.O)),Nh(e.V,e.g,"readystatechange",e.gb),t=e.H?Eu(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),jh(1),function(e,t,n,r,i,o){e.info(function(){if(e.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");s=2<=h.length&&"type"==h[1]?s+(u+"=")+l+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s})}(e.j,e.u,e.A,e.m,e.X,e.s)}function sd(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function ad(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=cd(e,n))==rd){4==t&&(e.o=4,Vh(14),i=!1),Rh(e.j,e.m,null,"[Incomplete Response]");break}if(r==nd){e.o=4,Vh(15),Rh(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Rh(e.j,e.m,r,null),pd(e,r)}sd(e)&&r!=rd&&r!=nd&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Vh(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Rf(t),t.L=!0,Vh(11))):(Rh(e.j,e.m,n,"[Invalid Chunked Response]"),fd(e),dd(e))}function cd(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?rd:(n=Number(t.substring(n,r)),isNaN(n)?nd:(r+=1)+n>t.length?rd:(t=t.substr(r,n),e.C=r+n,t))}function ld(e){e.Y=Date.now()+e.P,ud(e,e.P)}function ud(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Hh(su(e.eb,e),t)}function hd(e){e.B&&(Jl.clearTimeout(e.B),e.B=null)}function dd(e){0==e.l.G||e.I||Bf(e.l,e)}function fd(e){hd(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Sh(e.W),Mh(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function pd(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Wd(n.i,e)))if(n.I=e.N,!e.J&&Wd(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Lf(n),Sf(n)}xf(n),Vh(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Hh(su(n.ab,n),6e3));if(1>=qd(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else jf(n,11)}else if((e.J||n.g==e)&&Lf(n),!gu(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var o=i[t];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=o[5];null!=c&&"number"==typeof c&&0<c&&(n.K=r=1.5*c,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var l=e.g;if(l){var u=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(u){var h=r.i;!h.g&&(vu(u,"spdy")||vu(u,"quic")||vu(u,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(Zd(h,h.h),h.h=null))}if(r.D){var d=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.sa=d,Pd(r.F,r.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=e;if((r=n).oa=Vf(r,r.H?r.la:null,r.W),f.J){Qd(r.i,f);var p=f,g=r.K;g&&p.setTimeout(g),p.B&&(hd(p),ld(p)),r.g=f}else Mf(r);0<n.l.length&&Tf(n)}else"stop"!=o[0]&&"close"!=o[0]||jf(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?jf(n,7):Of(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}jh(4)}catch(o){}}function gd(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(eu(e)||"string"==typeof e)du(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(eu(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(eu(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function md(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof md)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function yd(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];vd(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)vd(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function vd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(Ql=Xh.prototype).setTimeout=function(e){this.P=e},Ql.gb=function(e){e=e.target;var t=this.L;t&&3==bf(e)?t.l():this.Ia(e)},Ql.Ia=function(e){try{if(e==this.g)e:{var t=bf(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||Mu||this.g&&(this.h.h||this.g.ga()||_f(this.g)))){this.I||4!=t||7==n||jh(8==n||0>=r?3:2),hd(this);var i=this.g.ba();this.N=i;t:if(sd(this)){var o=_f(this.g);e="";var s=o.length,a=4==bf(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){fd(this),dd(this);var c="";break t}this.h.i=new Jl.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,e+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=e,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,o,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!gu(l)){var h=l;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,Vh(12),fd(this),dd(this);break e}Rh(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,pd(this,i)}this.U?(ad(this,t,c),Mu&&this.i&&3==t&&(Nh(this.V,this.W,"tick",this.fb),this.W.start())):(Rh(this.j,this.m,c,null),pd(this,c)),4==t&&fd(this),this.i&&!this.I&&(4==t?Bf(this.l,this):(this.i=!1,ld(this)))}else 400==i&&0<c.indexOf("Unknown SID")?(this.o=3,Vh(12)):(this.o=0,Vh(13)),fd(this),dd(this)}}}catch(t){}},Ql.fb=function(){if(this.g){var e=bf(this.g),t=this.g.ga();this.C<t.length&&(hd(this),ad(this,e,t),this.i&&4!=e&&ld(this))}},Ql.cancel=function(){this.I=!0,fd(this)},Ql.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(jh(3),Vh(17)),fd(this),this.o=2,dd(this)):ud(this,this.Y-e)},(Ql=md.prototype).R=function(){yd(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},Ql.T=function(){return yd(this),this.g.concat()},Ql.get=function(e,t){return vd(this.h,e)?this.h[e]:t},Ql.set=function(e,t){vd(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},Ql.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var bd=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function _d(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof _d){this.g=void 0!==t?t:e.g,Cd(this,e.j),this.s=e.s,Ed(this,e.i),Od(this,e.m),this.l=e.l,t=e.h;var n=new Ld;n.i=t.i,t.g&&(n.g=new md(t.g),n.h=t.h),Sd(this,n),this.o=e.o}else e&&(n=String(e).match(bd))?(this.g=!!t,Cd(this,n[1]||"",!0),this.s=Td(n[2]||""),Ed(this,n[3]||"",!0),Od(this,n[4]),this.l=Td(n[5]||"",!0),Sd(this,n[6]||"",!0),this.o=Td(n[7]||"")):(this.g=!!t,this.h=new Ld(null,this.g))}function wd(e){return new _d(e)}function Cd(e,t,n){e.j=n?Td(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ed(e,t,n){e.i=n?Td(t,!0):t}function Od(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Sd(e,t,n){t instanceof Ld?(e.h=t,function(e,t){t&&!e.j&&(Bd(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Fd(this,t),Ud(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=Ad(t,Rd)),e.h=new Ld(t,e.g))}function Pd(e,t,n){e.h.set(t,n)}function Id(e){return Pd(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Td(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ad(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,kd),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function kd(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}_d.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ad(t,Nd,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ad(t,Nd,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ad(n,"/"==n.charAt(0)?xd:Md,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ad(n,Dd)),e.join("")};var Nd=/[#\/\?@]/g,Md=/[#\?:]/g,xd=/[#\?]/g,Rd=/[#\?@]/g,Dd=/#/g;function Ld(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Bd(e){e.g||(e.g=new md,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Fd(e,t){Bd(e),t=Vd(e,t),vd(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,vd((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&yd(e)))}function jd(e,t){return Bd(e),t=Vd(e,t),vd(e.g.h,t)}function Ud(e,t,n){Fd(e,t),0<n.length&&(e.i=null,e.g.set(Vd(e,t),pu(n)),e.h+=n.length)}function Vd(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Ql=Ld.prototype).add=function(e,t){Bd(this),this.i=null,e=Vd(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Ql.forEach=function(e,t){Bd(this),this.g.forEach(function(n,r){du(n,function(n){e.call(t,n,r,this)},this)},this)},Ql.T=function(){Bd(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},Ql.R=function(e){Bd(this);var t=[];if("string"==typeof e)jd(this,e)&&(t=fu(t,this.g.get(Vd(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=fu(t,e[n])}return t},Ql.set=function(e,t){return Bd(this),this.i=null,jd(this,e=Vd(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Ql.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},Ql.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),e.push(s)}}return this.i=e.join("&")};var zd=function(){return function(e,t){this.h=e,this.g=t}}();function Hd(e){this.l=e||Gd,e=Jl.PerformanceNavigationTiming?0<(e=Jl.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Jl.g&&Jl.g.Ea&&Jl.g.Ea()&&Jl.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Gd=10;function $d(e){return!!e.h||!!e.g&&e.g.size>=e.j}function qd(e){return e.h?1:e.g?e.g.size:0}function Wd(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Zd(e,t){e.g?e.g.add(t):e.h=t}function Qd(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Yd(e){var t,n;if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var r=e.i;try{for(var i=Zl(e.g.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.D)}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return pu(e.i)}function Kd(){}function Jd(){this.g=new Kd}function Xd(e,t,n){var r=n||"";try{gd(e,function(e,n){var i=e;tu(e)&&(i=fh(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(aO){throw t.push(r+"type="+encodeURIComponent("_badmap")),aO}}function ef(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(o){}}function tf(e){this.l=e.$b||null,this.j=e.ib||!1}function nf(e,t){uh.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=rf,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Hd.prototype.cancel=function(){var e,t;if(this.i=Yd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Zl(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){e={error:i}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}},Kd.prototype.stringify=function(e){return Jl.JSON.stringify(e,void 0)},Kd.prototype.parse=function(e){return Jl.JSON.parse(e,void 0)},cu(tf,qh),tf.prototype.g=function(){return new nf(this.l,this.j)},tf.prototype.i=function(e){return function(){return e}}({}),cu(nf,uh);var rf=0;function of(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function sf(e){e.readyState=4,e.l=null,e.j=null,e.A=null,af(e)}function af(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Ql=nf.prototype).open=function(e,t){if(this.readyState!=rf)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,af(this)},Ql.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Jl).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},Ql.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,sf(this)),this.readyState=rf},Ql.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,af(this)),this.g&&(this.readyState=3,af(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Jl.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;of(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},Ql.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?sf(this):af(this),3==this.readyState&&of(this)}},Ql.Ua=function(e){this.g&&(this.response=this.responseText=e,sf(this))},Ql.Ta=function(e){this.g&&(this.response=e,sf(this))},Ql.ha=function(){this.g&&sf(this)},Ql.setRequestHeader=function(e,t){this.v.append(e,t)},Ql.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Ql.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(nf.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var cf=Jl.JSON.parse;function lf(e){uh.call(this),this.headers=new md,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=uf,this.K=this.L=!1}cu(lf,uh);var uf="",hf=/^https?$/i,df=["POST","PUT"];function ff(e){return"content-type"==e.toLowerCase()}function pf(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,gf(e),yf(e)}function gf(e){e.D||(e.D=!0,hh(e,"complete"),hh(e,"error"))}function mf(e){if(e.h&&void 0!==Kl&&(!e.C[1]||4!=bf(e)||2!=e.ba()))if(e.v&&4==bf(e))Ph(e.Fa,0,e);else if(hh(e,"readystatechange"),4==bf(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.H).match(bd)[1]||null;if(!o&&Jl.self&&Jl.self.location){var s=Jl.self.location.protocol;o=s.substr(0,s.length-1)}i=!hf.test(o?o.toLowerCase():"")}t=i}if(t)hh(e,"complete"),hh(e,"success");else{e.m=6;try{var a=2<bf(e)?e.g.statusText:""}catch(c){a=""}e.j=a+" ["+e.ba()+"]",gf(e)}}finally{yf(e)}}}function yf(e,t){if(e.g){vf(e);var n=e.g,r=e.C[0]?Xl:null;e.g=null,e.C=null,t||hh(e,"ready");try{n.onreadystatechange=r}catch(aO){}}}function vf(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Jl.clearTimeout(e.A),e.A=null)}function bf(e){return e.g?e.g.readyState:0}function _f(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case uf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function wf(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return Cu(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Pd(e,t,n))}function Cf(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ef(e){this.za=0,this.l=[],this.h=new xh,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Cf("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Cf("baseRetryDelayMs",5e3,e),this.$a=Cf("retryDelaySeedMs",1e4,e),this.Ya=Cf("forwardChannelMaxRetries",2,e),this.ra=Cf("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Hd(e&&e.concurrentRequestLimit),this.Ca=new Jd,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Of(e){if(Pf(e),3==e.G){var t=e.V++,n=wd(e.F);Pd(n,"SID",e.J),Pd(n,"RID",t),Pd(n,"TYPE","terminate"),kf(e,n),(t=new Xh(e,e.h,t,void 0)).K=2,t.v=Id(wd(n)),n=!1,Jl.navigator&&Jl.navigator.sendBeacon&&(n=Jl.navigator.sendBeacon(t.v.toString(),"")),!n&&Jl.Image&&((new Image).src=t.v,n=!0),n||(t.g=zf(t.l,null),t.g.ea(t.v)),t.F=Date.now(),ld(t)}Uf(e)}function Sf(e){e.g&&(Rf(e),e.g.cancel(),e.g=null)}function Pf(e){Sf(e),e.u&&(Jl.clearTimeout(e.u),e.u=null),Lf(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Jl.clearTimeout(e.m),e.m=null)}function If(e,t){e.l.push(new zd(e.Za++,t)),3==e.G&&Tf(e)}function Tf(e){$d(e.i)||e.m||(e.m=!0,_h(e.Ha,e),e.C=0)}function Af(e,t){var n;n=t?t.m:e.V++;var r=wd(e.F);Pd(r,"SID",e.J),Pd(r,"RID",n),Pd(r,"AID",e.U),kf(e,r),e.o&&e.s&&wf(r,e.o,e.s),n=new Xh(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Nf(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),Zd(e.i,n),id(n,r,t)}function kf(e,t){e.j&&gd({},function(e,n){Pd(t,n,e)})}function Nf(e,t,n){n=Math.min(e.l.length,n);var r=e.j?su(e.j.Oa,e.j,e):null;e:for(var i=e.l,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].h)):o=0:s.push("ofs="+o);for(var a=!0,c=0;c<n;c++){var l=i[c].h,u=i[c].g;if(0>(l-=o))o=Math.max(0,i[c].h-100),a=!1;else try{Xd(u,s,"req"+l+"_")}catch(wp){r&&r(u)}}if(a){r=s.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function Mf(e){e.g||e.u||(e.Y=1,_h(e.Ga,e),e.A=0)}function xf(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=Hh(su(e.Ga,e),Ff(e,e.A)),e.A++,0))}function Rf(e){null!=e.B&&(Jl.clearTimeout(e.B),e.B=null)}function Df(e){e.g=new Xh(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=wd(e.oa);Pd(t,"RID","rpc"),Pd(t,"SID",e.J),Pd(t,"CI",e.N?"0":"1"),Pd(t,"AID",e.U),kf(e,t),Pd(t,"TYPE","xmlhttp"),e.o&&e.s&&wf(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Id(wd(t)),n.s=null,n.U=!0,od(n,e)}function Lf(e){null!=e.v&&(Jl.clearTimeout(e.v),e.v=null)}function Bf(e,t){var n=null;if(e.g==t){Lf(e),Rf(e),e.g=null;var r=2}else{if(!Wd(e.i,t))return;n=t.D,Qd(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;hh(r=Bh(),new zh(r,n,t,i)),Tf(e)}else Mf(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(qd(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=Hh(su(e.Ha,e,t),Ff(e,e.C)),e.C++,0)))}(e,t)||2==r&&xf(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:jf(e,5);break;case 4:jf(e,10);break;case 3:jf(e,6);break;default:jf(e,2)}}function Ff(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function jf(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=su(e.jb,e);n||(n=new _d("//www.google.com/images/cleardot.gif"),Jl.location&&"http"==Jl.location.protocol||Cd(n,"https"),Id(n)),function(e,t){var n=new xh;if(Jl.Image){var r=new Image;r.onload=au(ef,n,r,"TestLoadImage: loaded",!0,t),r.onerror=au(ef,n,r,"TestLoadImage: error",!1,t),r.onabort=au(ef,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=au(ef,n,r,"TestLoadImage: timeout",!1,t),Jl.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else Vh(2);e.G=0,e.j&&e.j.va(t),Uf(e),Pf(e)}function Uf(e){e.G=0,e.I=-1,e.j&&(0==Yd(e.i).length&&0==e.l.length||(e.i.i.length=0,pu(e.l),e.l.length=0),e.j.ua())}function Vf(e,t,n){var r=function(e){return e instanceof _d?wd(e):new _d(e,void 0)}(n);if(""!=r.i)t&&Ed(r,t+"."+r.i),Od(r,r.m);else{var i=Jl.location;r=function(e,t,n,r){var i=new _d(null,void 0);return e&&Cd(i,e),t&&Ed(i,t),n&&Od(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&Cu(e.aa,function(e,t){Pd(r,t,e)}),n=e.sa,(t=e.D)&&n&&Pd(r,t,n),Pd(r,"VER",e.ma),kf(e,r),r}function zf(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new lf(n&&e.Ba&&!e.qa?new tf({ib:!0}):e.qa)).L=e.H,t}function Hf(){}function Gf(){if(ku&&!(10<=Number(Uu)))throw Error("Environmental error: no available transport.")}function $f(e,t){uh.call(this),this.g=new Ef(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!gu(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!gu(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Zf(this)}function qf(e){Yh.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Wf(){Kh.call(this),this.status=1}function Zf(e){this.g=e}(Ql=lf.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Zh.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:Zh),this.g.onreadystatechange=su(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(o){return void pf(this,o)}e=n||"";var i=new md(this.headers);r&&gd(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=ff,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=Jl.FormData&&e instanceof Jl.FormData,!(0<=hu(df,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{vf(this),0<this.B&&((this.K=function(e){return ku&&function(){return e=ju,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=yu(String(Iu)).split("."),n=yu("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var o=t[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;e=bu(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||bu(0==o[2].length,0==s[2].length)||bu(o[2],s[2]),o=o[3],s=s[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=su(this.pa,this)):this.A=Ph(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(o){pf(this,o)}},Ql.pa=function(){void 0!==Kl&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,hh(this,"timeout"),this.abort(8))},Ql.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,hh(this,"complete"),hh(this,"abort"),yf(this))},Ql.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),yf(this,!0)),lf.Z.M.call(this)},Ql.Fa=function(){this.s||(this.F||this.v||this.l?mf(this):this.cb())},Ql.cb=function(){mf(this)},Ql.ba=function(){try{return 2<bf(this)?this.g.status:-1}catch(Tu){return-1}},Ql.ga=function(){try{return this.g?this.g.responseText:""}catch(Tu){return""}},Ql.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),cf(t)}},Ql.Da=function(){return this.m},Ql.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ql=Ef.prototype).ma=8,Ql.G=1,Ql.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},Ql.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new Xh(this,this.h,e,void 0),n=this.s;if(this.P&&(n?Su(n=Eu(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Nf(this,t,r),Pd(i=wd(this.F),"RID",e),Pd(i,"CVER",22),this.D&&Pd(i,"X-HTTP-Session-Id",this.D),kf(this,i),this.o&&n&&wf(i,this.o,n),Zd(this.i,t),this.Ra&&Pd(i,"TYPE","init"),this.ja?(Pd(i,"$req",r),Pd(i,"SID","null"),t.$=!0,id(t,i,null)):id(t,i,r),this.G=2}}else 3==this.G&&(e?Af(this,e):0==this.l.length||$d(this.i)||Af(this))},Ql.Ga=function(){if(this.u=null,Df(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Hh(su(this.bb,this),e)}},Ql.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Vh(10),Sf(this),Df(this))},Ql.ab=function(){null!=this.v&&(this.v=null,Sf(this),xf(this),Vh(19))},Ql.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Vh(2)):(this.h.info("Failed to ping google.com"),Vh(1))},(Ql=Hf.prototype).xa=function(){},Ql.wa=function(){},Ql.va=function(){},Ql.ua=function(){},Ql.Oa=function(){},Gf.prototype.g=function(e,t){return new $f(e,t)},cu($f,uh),$f.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),_h(su(e.hb,e,t))),Vh(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Vf(e,null,e.W),Tf(e)},$f.prototype.close=function(){Of(this.g)},$f.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,If(this.g,t)}else this.v?((t={}).__data__=fh(e),If(this.g,t)):If(this.g,e)},$f.prototype.M=function(){this.g.j=null,delete this.j,Of(this.g),delete this.g,$f.Z.M.call(this)},cu(qf,Yh),cu(Wf,Kh),cu(Zf,Hf),Zf.prototype.xa=function(){hh(this.g,"a")},Zf.prototype.wa=function(e){hh(this.g,new qf(e))},Zf.prototype.va=function(e){hh(this.g,new Wf(e))},Zf.prototype.ua=function(){hh(this.g,"b")},Gf.prototype.createWebChannel=Gf.prototype.g,$f.prototype.send=$f.prototype.u,$f.prototype.open=$f.prototype.m,$f.prototype.close=$f.prototype.close,Gh.NO_ERROR=0,Gh.TIMEOUT=8,Gh.HTTP_ERROR=6,$h.COMPLETE="complete",Wh.EventType=Qh,Qh.OPEN="a",Qh.CLOSE="b",Qh.ERROR="c",Qh.MESSAGE="d",uh.prototype.listen=uh.prototype.N,lf.prototype.listenOnce=lf.prototype.O,lf.prototype.getLastError=lf.prototype.La,lf.prototype.getLastErrorCode=lf.prototype.Da,lf.prototype.getStatus=lf.prototype.ba,lf.prototype.getResponseJson=lf.prototype.Qa,lf.prototype.getResponseText=lf.prototype.ga,lf.prototype.send=lf.prototype.ea;var Qf=Gh,Yf=$h,Kf=Dh,Jf=tf,Xf=Wh,ep=lf,tp=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.t(e)},this.i=function(e){return t.writeSequenceNumber(e)})}return e.prototype.t=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.i&&this.i(e),e},e}();tp.o=-1;var np={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},rp=function(e){function t(t,n){var r=this;return(r=e.call(this,n)||this).code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Gl.c)(t,e),t}(Error),ip=new ql.b("@firebase/firestore");function op(){return ip.logLevel}function sp(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(ip.logLevel<=ql.a.DEBUG){var r=t.map(lp);ip.debug.apply(ip,Object(Gl.f)(["Firestore (8.10.0): "+e],r))}}function ap(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(ip.logLevel<=ql.a.ERROR){var r=t.map(lp);ip.error.apply(ip,Object(Gl.f)(["Firestore (8.10.0): "+e],r))}}function cp(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(ip.logLevel<=ql.a.WARN){var r=t.map(lp);ip.warn.apply(ip,Object(Gl.f)(["Firestore (8.10.0): "+e],r))}}function lp(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(aO){return e}}function up(e){void 0===e&&(e="Unexpected state");var t="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+e;throw ap(t),new Error(t)}function hp(e,t){e||up()}function dp(e,t){return e}function fp(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var pp=function(){function e(){}return e.u=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=fp(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n},e}();function gp(e,t){return e<t?-1:e>t?1:0}function mp(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}function yp(e){return e+"\0"}var vp=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new rp(np.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new rp(np.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new rp(np.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rp(np.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?gp(this.nanoseconds,e.nanoseconds):gp(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),bp=function(){function e(e){this.timestamp=e}return e.fromTimestamp=function(t){return new e(t)},e.min=function(){return new e(new vp(0,0))},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e}();function _p(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function wp(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Cp(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var Ep=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&up(),void 0===n?n=e.length-t:n>e.length-t&&up(),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)},e.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),Op=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=[],i=0,o=e;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new rp(np.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(e){return e.length>0}))}return new t(r)},t.emptyPath=function(){return new t([])},t}(Ep),Sp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return Sp.test(e)},t.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new rp(np.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<e.length;){var a=e[i];if("\\"===a){if(i+1===e.length)throw new rp(np.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new rp(np.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new rp(np.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.emptyPath=function(){return new t([])},t}(Ep),Ip=function(){function e(e){this.fields=e,e.sort(Pp.comparator)}return e.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},e.prototype.isEqual=function(e){return mp(this.fields,e.fields,function(e,t){return e.isEqual(t)})},e}(),Tp=function(){function e(e){this.binaryString=e}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))},e.prototype.toBase64=function(){return btoa(this.binaryString)},e.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)},e.prototype.approximateByteSize=function(){return 2*this.binaryString.length},e.prototype.compareTo=function(e){return gp(this.binaryString,e.binaryString)},e.prototype.isEqual=function(e){return this.binaryString===e.binaryString},e}();Tp.EMPTY_BYTE_STRING=new Tp("");var Ap=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kp(e){if(hp(!!e),"string"==typeof e){var t=0,n=Ap.exec(e);if(hp(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Np(e.seconds),nanos:Np(e.nanos)}}function Np(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Mp(e){return"string"==typeof e?Tp.fromBase64String(e):Tp.fromUint8Array(e)}function xp(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Rp(e){var t=e.mapValue.fields.__previous_value__;return xp(t)?Rp(t):t}function Dp(e){var t=kp(e.mapValue.fields.__local_write_time__.timestampValue);return new vp(t.seconds,t.nanos)}function Lp(e){return null==e}function Bp(e){return 0===e&&1/e==-1/0}function Fp(e){return"number"==typeof e&&Number.isInteger(e)&&!Bp(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var jp=function(){function e(e){this.path=e}return e.fromPath=function(t){return new e(Op.fromString(t))},e.fromName=function(t){return new e(Op.fromString(t).popFirst(5))},e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===Op.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return Op.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new Op(t.slice()))},e}();function Up(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xp(e)?4:10:up()}function Vp(e,t){var n=Up(e);if(n!==Up(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Dp(e).isEqual(Dp(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=kp(e.timestampValue),r=kp(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Mp(e.bytesValue).isEqual(Mp(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Np(e.geoPointValue.latitude)===Np(t.geoPointValue.latitude)&&Np(e.geoPointValue.longitude)===Np(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Np(e.integerValue)===Np(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Np(e.doubleValue),r=Np(t.doubleValue);return n===r?Bp(n)===Bp(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return mp(e.arrayValue.values||[],t.arrayValue.values||[],Vp);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(_p(n)!==_p(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Vp(n[i],r[i])))return!1;return!0}(e,t);default:return up()}}function zp(e,t){return void 0!==(e.values||[]).find(function(e){return Vp(e,t)})}function Hp(e,t){var n=Up(e),r=Up(t);if(n!==r)return gp(n,r);switch(n){case 0:return 0;case 1:return gp(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Np(e.integerValue||e.doubleValue),r=Np(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Gp(e.timestampValue,t.timestampValue);case 4:return Gp(Dp(e),Dp(t));case 5:return gp(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Mp(e),r=Mp(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=gp(n[i],r[i]);if(0!==o)return o}return gp(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=gp(Np(e.latitude),Np(t.latitude));return 0!==n?n:gp(Np(e.longitude),Np(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=Hp(n[i],r[i]);if(o)return o}return gp(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=gp(r[s],o[s]);if(0!==a)return a;var c=Hp(n[r[s]],i[o[s]]);if(0!==c)return c}return gp(r.length,o.length)}(e.mapValue,t.mapValue);default:throw up()}}function Gp(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return gp(e,t);var n=kp(e),r=kp(t),i=gp(n.seconds,r.seconds);return 0!==i?i:gp(n.nanos,r.nanos)}function $p(e){return qp(e)}function qp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=kp(e);return"time("+t.seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Mp(e.bytesValue).toBase64():"referenceValue"in e?jp.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(e){for(var t="[",n=!0,r=0,i=e.values||[];r<i.length;r++)n?n=!1:t+=",",t+=qp(i[r]);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var t="{",n=!0,r=0,i=Object.keys(e.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:t+=",",t+=o+":"+qp(e.fields[o])}return t+"}"}(e.mapValue):up();var t}function Wp(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function Zp(e){return!!e&&"integerValue"in e}function Qp(e){return!!e&&"arrayValue"in e}function Yp(e){return!!e&&"nullValue"in e}function Kp(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Jp(e){return!!e&&"mapValue"in e}function Xp(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return wp(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=Xp(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Xp(e.arrayValue.values[r]);return n}return Object.assign({},e)}var eg=function(){function e(e){this.value=e}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Jp(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null},e.prototype.set=function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xp(t)},e.prototype.setAll=function(e){var t=this,n=Pp.emptyPath(),r={},i=[];e.forEach(function(e,o){if(!n.isImmediateParentOf(o)){var s=t.getFieldsMap(n);t.applyChanges(s,r,i),r={},i=[],n=o.popLast()}e?r[o.lastSegment()]=Xp(e):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},e.prototype.delete=function(e){var t=this.field(e.popLast());Jp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]},e.prototype.isEqual=function(e){return Vp(this.value,e.value)},e.prototype.getFieldsMap=function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Jp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields},e.prototype.applyChanges=function(e,t,n){wp(t,function(t,n){return e[t]=n});for(var r=0,i=n;r<i.length;r++)delete e[i[r]]},e.prototype.clone=function(){return new e(Xp(this.value))},e}();function tg(e){var t=[];return wp(e.fields,function(e,n){var r=new Pp([e]);if(Jp(n)){var i=tg(n.mapValue).fields;if(0===i.length)t.push(r);else for(var o=0,s=i;o<s.length;o++)t.push(r.child(s[o]))}else t.push(r)}),new Ip(t)}var ng=function(){function e(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}return e.newInvalidDocument=function(t){return new e(t,0,bp.min(),eg.empty(),0)},e.newFoundDocument=function(t,n,r){return new e(t,1,n,r,0)},e.newNoDocument=function(t,n){return new e(t,2,n,eg.empty(),0)},e.newUnknownDocument=function(t,n){return new e(t,3,n,eg.empty(),2)},e.prototype.convertToFoundDocument=function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this},e.prototype.convertToNoDocument=function(e){return this.version=e,this.documentType=2,this.data=eg.empty(),this.documentState=0,this},e.prototype.convertToUnknownDocument=function(e){return this.version=e,this.documentType=3,this.data=eg.empty(),this.documentState=2,this},e.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},e.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(e.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isValidDocument=function(){return 0!==this.documentType},e.prototype.isFoundDocument=function(){return 1===this.documentType},e.prototype.isNoDocument=function(){return 2===this.documentType},e.prototype.isUnknownDocument=function(){return 3===this.documentType},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},e.prototype.clone=function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},e}(),rg=function(e,t,n,r,i,o,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function ig(e,t,n,r,i,o,s){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new rg(e,t,n,r,i,o,s)}function og(e){var t=dp(e);if(null===t.h){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return function(e){return e.field.canonicalString()+e.op.toString()+$p(e.value)}(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return function(e){return e.field.canonicalString()+e.dir}(e)}).join(","),Lp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=vg(t.startAt)),t.endAt&&(n+="|ub:",n+=vg(t.endAt)),t.h=n}return t.h}function sg(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!_g(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(o=t.filters[r]).op||!i.field.isEqual(o.field)||!Vp(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Cg(e.startAt,t.startAt)&&Cg(e.endAt,t.endAt)}function ag(e){return jp.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var cg=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).field=t,i.op=n,i.value=r,i}return Object(Gl.c)(t,e),t.create=function(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.l(e,n,r):new lg(e,n,r):"array-contains"===n?new fg(e,r):"in"===n?new pg(e,r):"not-in"===n?new gg(e,r):"array-contains-any"===n?new mg(e,r):new t(e,n,r)},t.l=function(e,t,n){return"in"===t?new ug(e,n):new hg(e,n)},t.prototype.matches=function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(Hp(t,this.value)):null!==t&&Up(this.value)===Up(t)&&this.m(Hp(t,this.value))},t.prototype.m=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return up()}},t.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}(function(){}),lg=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,r)||this).key=jp.fromName(r.referenceValue),i}return Object(Gl.c)(t,e),t.prototype.matches=function(e){var t=jp.comparator(e.key,this.key);return this.m(t)},t}(cg),ug=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"in",n)||this).keys=dg(0,n),r}return Object(Gl.c)(t,e),t.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},t}(cg),hg=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"not-in",n)||this).keys=dg(0,n),r}return Object(Gl.c)(t,e),t.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},t}(cg);function dg(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return jp.fromName(e.referenceValue)})}var fg=function(e){function t(t,n){return e.call(this,t,"array-contains",n)||this}return Object(Gl.c)(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return Qp(t)&&zp(t.arrayValue,this.value)},t}(cg),pg=function(e){function t(t,n){return e.call(this,t,"in",n)||this}return Object(Gl.c)(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return null!==t&&zp(this.value.arrayValue,t)},t}(cg),gg=function(e){function t(t,n){return e.call(this,t,"not-in",n)||this}return Object(Gl.c)(t,e),t.prototype.matches=function(e){if(zp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!zp(this.value.arrayValue,t)},t}(cg),mg=function(e){function t(t,n){return e.call(this,t,"array-contains-any",n)||this}return Object(Gl.c)(t,e),t.prototype.matches=function(e){var t=this,n=e.data.field(this.field);return!(!Qp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return zp(t.value.arrayValue,e)})},t}(cg),yg=function(e,t){this.position=e,this.before=t};function vg(e){return(e.before?"b":"a")+":"+e.position.map(function(e){return $p(e)}).join(",")}var bg=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t};function _g(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function wg(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],s=e.position[i];if(r=o.field.isKeyField()?jp.comparator(jp.fromName(s.referenceValue),n.key):Hp(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function Cg(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Vp(e.position[n],t.position[n]))return!1;return!0}var Eg=function(e,t,n,r,i,o,s,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function Og(e,t,n,r,i,o,s,a){return new Eg(e,t,n,r,i,o,s,a)}function Sg(e){return new Eg(e)}function Pg(e){return!Lp(e.limit)&&"F"===e.limitType}function Ig(e){return!Lp(e.limit)&&"L"===e.limitType}function Tg(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Ag(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.g())return r.field}return null}function kg(e){return null!==e.collectionGroup}function Ng(e){var t=dp(e);if(null===t.p){t.p=[];var n=Ag(t),r=Tg(t);if(null!==n&&null===r)n.isKeyField()||t.p.push(new bg(n)),t.p.push(new bg(Pp.keyField(),"asc"));else{for(var i=!1,o=0,s=t.explicitOrderBy;o<s.length;o++){var a=s[o];t.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var c=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new bg(Pp.keyField(),c))}}}return t.p}function Mg(e){var t=dp(e);if(!t.T)if("F"===t.limitType)t.T=ig(t.path,t.collectionGroup,Ng(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=Ng(t);r<i.length;r++){var o=i[r];n.push(new bg(o.field,"desc"===o.dir?"asc":"desc"))}var s=t.endAt?new yg(t.endAt.position,!t.endAt.before):null,a=t.startAt?new yg(t.startAt.position,!t.startAt.before):null;t.T=ig(t.path,t.collectionGroup,n,t.filters,t.limit,s,a)}return t.T}function xg(e,t,n){return new Eg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Rg(e,t){return sg(Mg(e),Mg(t))&&e.limitType===t.limitType}function Dg(e){return og(Mg(e))+"|lt:"+e.limitType}function Lg(e){return"Query(target="+function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: ["+e.filters.map(function(e){return(t=e).field.canonicalString()+" "+t.op+" "+$p(t.value);var t}).join(", ")+"]"),Lp(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: ["+e.orderBy.map(function(e){return function(e){return e.field.canonicalString()+" ("+e.dir+")"}(e)}).join(", ")+"]"),e.startAt&&(t+=", startAt: "+vg(e.startAt)),e.endAt&&(t+=", endAt: "+vg(e.endAt)),"Target("+t+")"}(Mg(e))+"; limitType="+e.limitType+")"}function Bg(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):jp.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(var n=0,r=e.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}return!0}(e,t)&&function(e,t){for(var n=0,r=e.filters;n<r.length;n++)if(!r[n].matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!wg(e.startAt,Ng(e),t)||e.endAt&&wg(e.endAt,Ng(e),t))}(e,t)}function Fg(e){return function(t,n){for(var r=!1,i=0,o=Ng(e);i<o.length;i++){var s=o[i],a=jg(s,t,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function jg(e,t,n){var r=e.field.isKeyField()?jp.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Hp(r,i):up()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return up()}}function Ug(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bp(t)?"-0":t}}function Vg(e){return{integerValue:""+e}}function zg(e,t){return Fp(t)?Vg(t):Ug(e,t)}var Hg=function(){this._=void 0};function Gg(e,t,n){return e instanceof Wg?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Zg?Qg(e,t):e instanceof Yg?Kg(e,t):function(e,t){var n=qg(e,t),r=Xg(n)+Xg(e.A);return Zp(n)&&Zp(e.A)?Vg(r):Ug(e.R,r)}(e,t)}function $g(e,t,n){return e instanceof Zg?Qg(e,t):e instanceof Yg?Kg(e,t):n}function qg(e,t){return e instanceof Jg?Zp(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Wg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t}(Hg),Zg=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Object(Gl.c)(t,e),t}(Hg);function Qg(e,t){for(var n=em(t),r=function(e){n.some(function(t){return Vp(t,e)})||n.push(e)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Yg=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Object(Gl.c)(t,e),t}(Hg);function Kg(e,t){for(var n=em(t),r=function(e){n=n.filter(function(t){return!Vp(t,e)})},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Jg=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).R=t,r.A=n,r}return Object(Gl.c)(t,e),t}(Hg);function Xg(e){return Np(e.integerValue||e.doubleValue)}function em(e){return Qp(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var tm=function(e,t){this.field=e,this.transform=t},nm=function(e,t){this.version=e,this.transformResults=t},rm=function(){function e(e,t){this.updateTime=e,this.exists=t}return e.none=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},e}();function im(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var om=function(){};function sm(e,t,n){e instanceof hm?function(e,t,n){var r=e.value.clone(),i=pm(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof dm?function(e,t,n){if(im(e.precondition,t)){var r=pm(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(fm(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function am(e,t,n){e instanceof hm?function(e,t,n){if(im(e.precondition,t)){var r=e.value.clone(),i=gm(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(um(t),r).setHasLocalMutations()}}(e,t,n):e instanceof dm?function(e,t,n){if(im(e.precondition,t)){var r=gm(e.fieldTransforms,n,t),i=t.data;i.setAll(fm(e)),i.setAll(r),t.convertToFoundDocument(um(t),i).setHasLocalMutations()}}(e,t,n):function(e,t){im(e.precondition,t)&&t.convertToNoDocument(bp.min())}(e,t)}function cm(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],s=t.data.field(o.field),a=qg(o.transform,s||null);null!=a&&(null==n&&(n=eg.empty()),n.set(o.field,a))}return n||null}function lm(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&mp(e,t,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Zg&&t instanceof Zg||e instanceof Yg&&t instanceof Yg?mp(e.elements,t.elements,Vp):e instanceof Jg&&t instanceof Jg?Vp(e.A,t.A):e instanceof Wg&&t instanceof Wg}(e.transform,t.transform)}(e,t)})}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function um(e){return e.isFoundDocument()?e.version:bp.min()}var hm=function(e){function t(t,n,r,i){void 0===i&&(i=[]);var o=this;return(o=e.call(this)||this).key=t,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(Gl.c)(t,e),t}(om),dm=function(e){function t(t,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=e.call(this)||this).key=t,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(Gl.c)(t,e),t}(om);function fm(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function pm(e,t,n){var r=new Map;hp(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,$g(s,a,n[i]))}return r}function gm(e,t,n){for(var r=new Map,i=0,o=e;i<o.length;i++){var s=o[i],a=s.transform,c=n.data.field(s.field);r.set(s.field,Gg(a,c,t))}return r}var mm,ym,vm=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(Gl.c)(t,e),t}(om),bm=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(Gl.c)(t,e),t}(om),_m=function(e){this.count=e};function wm(e){switch(e){case np.OK:return up();case np.CANCELLED:case np.UNKNOWN:case np.DEADLINE_EXCEEDED:case np.RESOURCE_EXHAUSTED:case np.INTERNAL:case np.UNAVAILABLE:case np.UNAUTHENTICATED:return!1;case np.INVALID_ARGUMENT:case np.NOT_FOUND:case np.ALREADY_EXISTS:case np.PERMISSION_DENIED:case np.FAILED_PRECONDITION:case np.ABORTED:case np.OUT_OF_RANGE:case np.UNIMPLEMENTED:case np.DATA_LOSS:return!0;default:return up()}}function Cm(e){if(void 0===e)return ap("GRPC error has no .code"),np.UNKNOWN;switch(e){case mm.OK:return np.OK;case mm.CANCELLED:return np.CANCELLED;case mm.UNKNOWN:return np.UNKNOWN;case mm.DEADLINE_EXCEEDED:return np.DEADLINE_EXCEEDED;case mm.RESOURCE_EXHAUSTED:return np.RESOURCE_EXHAUSTED;case mm.INTERNAL:return np.INTERNAL;case mm.UNAVAILABLE:return np.UNAVAILABLE;case mm.UNAUTHENTICATED:return np.UNAUTHENTICATED;case mm.INVALID_ARGUMENT:return np.INVALID_ARGUMENT;case mm.NOT_FOUND:return np.NOT_FOUND;case mm.ALREADY_EXISTS:return np.ALREADY_EXISTS;case mm.PERMISSION_DENIED:return np.PERMISSION_DENIED;case mm.FAILED_PRECONDITION:return np.FAILED_PRECONDITION;case mm.ABORTED:return np.ABORTED;case mm.OUT_OF_RANGE:return np.OUT_OF_RANGE;case mm.UNIMPLEMENTED:return np.UNIMPLEMENTED;case mm.DATA_LOSS:return np.DATA_LOSS;default:return up()}}(ym=mm||(mm={}))[ym.OK=0]="OK",ym[ym.CANCELLED=1]="CANCELLED",ym[ym.UNKNOWN=2]="UNKNOWN",ym[ym.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ym[ym.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ym[ym.NOT_FOUND=5]="NOT_FOUND",ym[ym.ALREADY_EXISTS=6]="ALREADY_EXISTS",ym[ym.PERMISSION_DENIED=7]="PERMISSION_DENIED",ym[ym.UNAUTHENTICATED=16]="UNAUTHENTICATED",ym[ym.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ym[ym.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ym[ym.ABORTED=10]="ABORTED",ym[ym.OUT_OF_RANGE=11]="OUT_OF_RANGE",ym[ym.UNIMPLEMENTED=12]="UNIMPLEMENTED",ym[ym.INTERNAL=13]="INTERNAL",ym[ym.UNAVAILABLE=14]="UNAVAILABLE",ym[ym.DATA_LOSS=15]="DATA_LOSS";var Em=function(){function e(e,t){this.comparator=e,this.root=t||Sm.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Sm.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Sm.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})},e.prototype.toString=function(){var e=[];return this.inorderTraversal(function(t,n){return e.push(t+":"+n),!1}),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new Om(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new Om(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new Om(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new Om(this.root,e,this.comparator,!0)},e}(),Om=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Sm=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw up();if(this.right.isRed())throw up();var e=this.left.check();if(e!==this.right.check())throw up();return e+(this.isRed()?0:1)},e}();Sm.EMPTY=null,Sm.RED=!0,Sm.BLACK=!1,Sm.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw up()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw up()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw up()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw up()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw up()},enumerable:!1,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Sm(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}());var Pm=function(){function e(e){this.comparator=e,this.data=new Em(this.comparator)}return e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new Im(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new Im(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},e.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),Im=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),Tm=new Em(jp.comparator);function Am(){return Tm}var km=new Em(jp.comparator);function Nm(){return km}var Mm=new Em(jp.comparator);function xm(){return Mm}var Rm=new Pm(jp.comparator);function Dm(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Rm,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Lm=new Pm(gp);function Bm(){return Lm}var Fm=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=new Map;return r.set(t,jm.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(bp.min(),r,Bm(),Am(),Dm())},e}(),jm=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(Tp.EMPTY_BYTE_STRING,n,Dm(),Dm(),Dm())},e}(),Um=function(e,t,n,r){this.v=e,this.removedTargetIds=t,this.key=n,this.P=r},Vm=function(e,t){this.targetId=e,this.V=t},zm=function(e,t,n,r){void 0===n&&(n=Tp.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Hm=function(){function e(){this.S=0,this.D=qm(),this.C=Tp.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),e.prototype.O=function(e){e.approximateByteSize()>0&&(this.k=!0,this.C=e)},e.prototype.M=function(){var e=Dm(),t=Dm(),n=Dm();return this.D.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:up()}}),new jm(this.C,this.N,e,t,n)},e.prototype.L=function(){this.k=!1,this.D=qm()},e.prototype.B=function(e,t){this.k=!0,this.D=this.D.insert(e,t)},e.prototype.q=function(e){this.k=!0,this.D=this.D.remove(e)},e.prototype.U=function(){this.S+=1},e.prototype.K=function(){this.S-=1},e.prototype.j=function(){this.k=!0,this.N=!0},e}(),Gm=function(){function e(e){this.W=e,this.G=new Map,this.H=Am(),this.J=$m(),this.Y=new Pm(gp)}return e.prototype.X=function(e){for(var t=0,n=e.v;t<n.length;t++){var r=n[t];e.P&&e.P.isFoundDocument()?this.Z(r,e.P):this.tt(r,e.key,e.P)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)this.tt(r=o[i],e.key,e.P)},e.prototype.et=function(e){var t=this;this.forEachTarget(e,function(n){var r=t.nt(n);switch(e.state){case 0:t.st(n)&&r.O(e.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(e.resumeToken);break;case 2:r.K(),r.F||t.removeTarget(n);break;case 3:t.st(n)&&(r.j(),r.O(e.resumeToken));break;case 4:t.st(n)&&(t.it(n),r.O(e.resumeToken));break;default:up()}})},e.prototype.forEachTarget=function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach(function(e,r){n.st(r)&&t(r)})},e.prototype.rt=function(e){var t=e.targetId,n=e.V.count,r=this.ot(t);if(r){var i=r.target;if(ag(i))if(0===n){var o=new jp(i.path);this.tt(t,o,ng.newNoDocument(o,bp.min()))}else hp(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}},e.prototype.ut=function(e){var t=this,n=new Map;this.G.forEach(function(r,i){var o=t.ot(i);if(o){if(r.current&&ag(o.target)){var s=new jp(o.target.path);null!==t.H.get(s)||t.at(i,s)||t.tt(i,s,ng.newNoDocument(s,e))}r.$&&(n.set(i,r.M()),r.L())}});var r=Dm();this.J.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.ot(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))});var i=new Fm(e,n,this.Y,this.H,r);return this.H=Am(),this.J=$m(),this.Y=new Pm(gp),i},e.prototype.Z=function(e,t){if(this.st(e)){var n=this.at(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}},e.prototype.tt=function(e,t,n){if(this.st(e)){var r=this.nt(e);this.at(e,t)?r.B(t,1):r.q(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}},e.prototype.removeTarget=function(e){this.G.delete(e)},e.prototype.ct=function(e){var t=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.U=function(e){this.nt(e).U()},e.prototype.nt=function(e){var t=this.G.get(e);return t||(t=new Hm,this.G.set(e,t)),t},e.prototype.ht=function(e){var t=this.J.get(e);return t||(t=new Pm(gp),this.J=this.J.insert(e,t)),t},e.prototype.st=function(e){var t=null!==this.ot(e);return t||sp("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.ot=function(e){var t=this.G.get(e);return t&&t.F?null:this.W.lt(e)},e.prototype.it=function(e){var t=this;this.G.set(e,new Hm),this.W.getRemoteKeysForTarget(e).forEach(function(n){t.tt(e,n,null)})},e.prototype.at=function(e,t){return this.W.getRemoteKeysForTarget(e).has(t)},e}();function $m(){return new Em(jp.comparator)}function qm(){return new Em(jp.comparator)}var Wm={asc:"ASCENDING",desc:"DESCENDING"},Zm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Qm=function(e,t){this.databaseId=e,this.I=t};function Ym(e,t){return e.I?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function Km(e,t){return e.I?t.toBase64():t.toUint8Array()}function Jm(e,t){return Ym(e,t.toTimestamp())}function Xm(e){return hp(!!e),bp.fromTimestamp(function(e){var t=kp(e);return new vp(t.seconds,t.nanos)}(e))}function ey(e,t){return function(e){return new Op(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function ty(e){var t=Op.fromString(e);return hp(Sy(t)),t}function ny(e,t){return ey(e.databaseId,t.path)}function ry(e,t){var n=ty(t);if(n.get(1)!==e.databaseId.projectId)throw new rp(np.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new rp(np.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new jp(ay(n))}function iy(e,t){return ey(e.databaseId,t)}function oy(e){var t=ty(e);return 4===t.length?Op.emptyPath():ay(t)}function sy(e){return new Op(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ay(e){return hp(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function cy(e,t,n){return{name:ny(e,t),fields:n.value.mapValue.fields}}function ly(e,t,n){var r=ry(e,t.name),i=Xm(t.updateTime),o=new eg({mapValue:{fields:t.fields}}),s=ng.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function uy(e,t){var n;if(t instanceof hm)n={update:cy(e,t.key,t.value)};else if(t instanceof vm)n={delete:ny(e,t.key)};else if(t instanceof dm)n={update:cy(e,t.key,t.data),updateMask:Oy(t.fieldMask)};else{if(!(t instanceof bm))return up();n={verify:ny(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Wg)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Zg)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Yg)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Jg)return{fieldPath:t.field.canonicalString(),increment:n.A};throw up()}(0,e)})),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Jm(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:up()}(e,t.precondition)),n}function hy(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?rm.updateTime(Xm(e.updateTime)):void 0!==e.exists?rm.exists(e.exists):rm.none()}(t.currentDocument):rm.none(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(e,t){var n=null;"setToServerValue"in t?(hp("REQUEST_TIME"===t.setToServerValue),n=new Wg):"appendMissingElements"in t?n=new Zg(t.appendMissingElements.values||[]):"removeAllFromArray"in t?n=new Yg(t.removeAllFromArray.values||[]):"increment"in t?n=new Jg(e,t.increment):up();var r=Pp.fromServerFormat(t.fieldPath);return new tm(r,n)}(e,t)}):[];if(t.update){var i=ry(e,t.update.name),o=new eg({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=function(e){return new Ip((e.fieldPaths||[]).map(function(e){return Pp.fromServerFormat(e)}))}(t.updateMask);return new dm(i,o,s,n,r)}return new hm(i,o,n,r)}if(t.delete){var a=ry(e,t.delete);return new vm(a,n)}if(t.verify){var c=ry(e,t.verify);return new bm(c,n)}return up()}function dy(e,t){return{documents:[iy(e,t.path)]}}function fy(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=iy(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=iy(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(Kp(e.value))return{unaryFilter:{field:_y(e.field),op:"IS_NAN"}};if(Yp(e.value))return{unaryFilter:{field:_y(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Kp(e.value))return{unaryFilter:{field:_y(e.field),op:"IS_NOT_NAN"}};if(Yp(e.value))return{unaryFilter:{field:_y(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_y(e.field),op:by(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(e){if(0!==e.length)return e.map(function(e){return function(e){return{field:_y(e.field),direction:vy(e.dir)}}(e)})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(e,t){return e.I||Lp(t)?t:{value:t}}(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=my(t.startAt)),t.endAt&&(n.structuredQuery.endAt=my(t.endAt)),n}function py(e){var t=oy(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){hp(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var s=[];n.where&&(s=gy(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(e){return function(e){return new bg(wy(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)}));var c=null;n.limit&&(c=function(e){var t;return Lp(t="object"==typeof e?e.value:e)?null:t}(n.limit));var l=null;n.startAt&&(l=yy(n.startAt));var u=null;return n.endAt&&(u=yy(n.endAt)),Og(t,i,a,s,c,"F",l,u)}function gy(e){return e?void 0!==e.unaryFilter?[Ey(e)]:void 0!==e.fieldFilter?[Cy(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return gy(e)}).reduce(function(e,t){return e.concat(t)}):up():[]}function my(e){return{before:e.before,values:e.position}}function yy(e){return new yg(e.values||[],!!e.before)}function vy(e){return Wm[e]}function by(e){return Zm[e]}function _y(e){return{fieldPath:e.canonicalString()}}function wy(e){return Pp.fromServerFormat(e.fieldPath)}function Cy(e){return cg.create(wy(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return up()}}(e.fieldFilter.op),e.fieldFilter.value)}function Ey(e){switch(e.unaryFilter.op){case"IS_NAN":var t=wy(e.unaryFilter.field);return cg.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=wy(e.unaryFilter.field);return cg.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=wy(e.unaryFilter.field);return cg.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=wy(e.unaryFilter.field);return cg.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return up()}}function Oy(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function Sy(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function Py(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Ty(t)),t=Iy(e.get(n),t);return Ty(t)}function Iy(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Ty(e){return e+"\x01\x01"}function Ay(e){var t=e.length;if(hp(t>=2),2===t)return hp("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),Op.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var s=e.indexOf("\x01",o);switch((s<0||s>n)&&up(),e.charAt(s+1)){case"\x01":var a=e.substring(o,s),c=void 0;0===i.length?c=a:(c=i+=a,i=""),r.push(c);break;case"\x10":i+=e.substring(o,s),i+="\0";break;case"\x11":i+=e.substring(o,s+1);break;default:up()}o=s+2}return new Op(r)}var ky=function(e,t){this.seconds=e,this.nanoseconds=t},Ny=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};Ny.store="owner",Ny.key="owner";var My=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};My.store="mutationQueues",My.keyPath="userId";var xy=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};xy.store="mutations",xy.keyPath="batchId",xy.userMutationsIndex="userMutationsIndex",xy.userMutationsKeyPath=["userId","batchId"];var Ry=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,Py(t)]},e.key=function(e,t,n){return[e,Py(t),n]},e}();Ry.store="documentMutations",Ry.PLACEHOLDER=new Ry;var Dy=function(e,t){this.path=e,this.readTime=t},Ly=function(e,t){this.path=e,this.version=t},By=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};By.store="remoteDocuments",By.readTimeIndex="readTimeIndex",By.readTimeIndexPath="readTime",By.collectionReadTimeIndex="collectionReadTimeIndex",By.collectionReadTimeIndexPath=["parentPath","readTime"];var Fy=function(e){this.byteSize=e};Fy.store="remoteDocumentGlobal",Fy.key="remoteDocumentGlobalKey";var jy=function(e,t,n,r,i,o,s){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};jy.store="targets",jy.keyPath="targetId",jy.queryTargetsIndexName="queryTargetsIndex",jy.queryTargetsKeyPath=["canonicalId","targetId"];var Uy=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};Uy.store="targetDocuments",Uy.keyPath=["targetId","path"],Uy.documentTargetsIndex="documentTargetsIndex",Uy.documentTargetsKeyPath=["path","targetId"];var Vy=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Vy.key="targetGlobalKey",Vy.store="targetGlobal";var zy=function(e,t){this.collectionId=e,this.parent=t};zy.store="collectionParents",zy.keyPath=["collectionId","parent"];var Hy=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};Hy.store="clientMetadata",Hy.keyPath="clientId";var Gy=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};Gy.store="bundles",Gy.keyPath="bundleId";var $y=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};$y.store="namedQueries",$y.keyPath="name";var qy=Object(Gl.f)(Object(Gl.f)([],Object(Gl.f)(Object(Gl.f)([],Object(Gl.f)(Object(Gl.f)([],Object(Gl.f)(Object(Gl.f)([],[My.store,xy.store,Ry.store,By.store,jy.store,Ny.store,Vy.store,Uy.store]),[Hy.store])),[Fy.store])),[zy.store])),[Gy.store,$y.store]),Wy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Zy=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},e}(),Qy=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},Yy=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&up(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})},e.prototype.toPromise=function(){var e=this;return new Promise(function(t,n){e.next(t,n)})},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.waitFor=function(t){return new e(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(e){return n(e)})}),o=!0,i===r&&e()})},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next(function(n){return n?e.resolve(n):t()})},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)},e}(),Ky=function(){function e(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ft=new Qy,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){t.error?n.ft.reject(new ev(e,t.error)):n.ft.resolve()},this.transaction.onerror=function(t){var r=ov(t.target.error);n.ft.reject(new ev(e,r))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new ev(n,t)}},Object.defineProperty(e.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(e){e&&this.ft.reject(e),this.aborted||(sp("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return new nv(t)},e}(),Jy=function(){function e(t,n,r){this.name=t,this.version=n,this.wt=r,12.2===e._t(Object($l.o)())&&ap("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(e){return sp("SimpleDb","Removing database:",e),rv(window.indexedDB.deleteDatabase(e)).toPromise()},e.yt=function(){if("undefined"==typeof indexedDB)return!1;if(e.gt())return!0;var t=Object($l.o)(),n=e._t(t),r=0<n&&n<10,i=e.Et(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.gt=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Tt)},e.It=function(e,t){return e.store(t)},e._t=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Et=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.At=function(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n=this;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(sp("SimpleDb","Opening database:",this.name),t=this,[4,new Promise(function(t,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(e){t(e.target.result)},i.onblocked=function(){r(new ev(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var n=t.target.error;r("VersionError"===n.name?new rp(np.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new ev(e,n))},i.onupgradeneeded=function(e){sp("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion),n.wt.Rt(e.target.result,i.transaction,e.oldVersion,n.version).next(function(){sp("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:t.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(e){return n.bt(e)}),this.db)]}})})},e.prototype.vt=function(e){this.bt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},e.prototype.runTransaction=function(e,t,n,r){return Object(Gl.b)(this,void 0,void 0,function(){var i,o,s,a,c;return Object(Gl.d)(this,function(l){switch(l.label){case 0:i="readonly"===t,o=0,s=function(){var t,s,c,l,u;return Object(Gl.d)(this,function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.At(e)];case 2:return a.db=h.sent(),t=Ky.open(a.db,e,i?"readonly":"readwrite",n),s=r(t).catch(function(e){return t.abort(e),Yy.reject(e)}).toPromise(),c={},s.catch(function(){}),[4,t.dt];case 3:return[2,(c.value=(h.sent(),s),c)];case 4:return sp("SimpleDb","Transaction failed with error:",(l=h.sent()).message,"Retrying:",u="FirebaseError"!==l.name&&o<3),a.close(),u?[3,5]:[2,{value:Promise.reject(l)}];case 5:return[2]}})},a=this,l.label=1;case 1:return[5,s()];case 2:if("object"==typeof(c=l.sent()))return[2,c.value];l.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),Xy=function(){function e(e){this.Pt=e,this.Vt=!1,this.St=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.Pt=e},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Vt=!0},e.prototype.Ct=function(e){this.St=e},e.prototype.delete=function(){return rv(this.Pt.delete())},e}(),ev=function(e){function t(t,n){var r=this;return(r=e.call(this,np.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Gl.c)(t,e),t}(rp);function tv(e){return"IndexedDbTransactionError"===e.name}var nv=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(sp("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(sp("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),rv(n)},e.prototype.add=function(e){return sp("SimpleDb","ADD",this.store.name,e,e),rv(this.store.add(e))},e.prototype.get=function(e){var t=this;return rv(this.store.get(e)).next(function(n){return void 0===n&&(n=null),sp("SimpleDb","GET",t.store.name,e,n),n})},e.prototype.delete=function(e){return sp("SimpleDb","DELETE",this.store.name,e),rv(this.store.delete(e))},e.prototype.count=function(){return sp("SimpleDb","COUNT",this.store.name),rv(this.store.count())},e.prototype.Nt=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.xt(n,function(e,t){r.push(t)}).next(function(){return r})},e.prototype.kt=function(e,t){sp("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Ft=!1;var r=this.cursor(n);return this.xt(r,function(e,t,n){return n.delete()})},e.prototype.$t=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.xt(r,t)},e.prototype.Ot=function(e){var t=this.cursor({});return new Yy(function(n,r){t.onerror=function(e){var t=ov(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})},e.prototype.xt=function(e,t){var n=[];return new Yy(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new Xy(i),s=t(i.primaryKey,i.value,o);if(s instanceof Yy){var a=s.catch(function(e){return o.done(),Yy.reject(e)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Yy.waitFor(n)})},e.prototype.options=function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Ft?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function rv(e){return new Yy(function(t,n){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){var t=ov(e.target.error);n(t)}})}var iv=!1;function ov(e){var t=Jy._t(Object($l.o)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new rp("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return iv||(iv=!0,setTimeout(function(){throw r},0)),r}}return e}var sv=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Mt=t,r.currentSequenceNumber=n,r}return Object(Gl.c)(t,e),t}(Zy);function av(e,t){var n=dp(e);return Jy.It(n.Mt,t)}var cv=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}return e.prototype.applyToRemoteDocument=function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&sm(i,e,n[r])}},e.prototype.applyToLocalView=function(e){for(var t=0,n=this.baseMutations;t<n.length;t++)(o=n[t]).key.isEqual(e.key)&&am(o,e,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(e.key)&&am(o,e,this.localWriteTime)}},e.prototype.applyToLocalDocumentSet=function(e){var t=this;this.mutations.forEach(function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(bp.min())})},e.prototype.keys=function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Dm())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&mp(this.mutations,e.mutations,function(e,t){return lm(e,t)})&&mp(this.baseMutations,e.baseMutations,function(e,t){return lm(e,t)})},e}(),lv=function(){function e(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}return e.from=function(t,n,r){hp(t.mutations.length===r.length);for(var i=xm(),o=t.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new e(t,n,r,i)},e}(),uv=function(){function e(e,t,n,r,i,o,s){void 0===i&&(i=bp.min()),void 0===o&&(o=bp.min()),void 0===s&&(s=Tp.EMPTY_BYTE_STRING),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e}(),hv=function(e){this.Lt=e};function dv(e,t){if(t.document)return ly(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=jp.fromSegments(t.noDocument.path),r=yv(t.noDocument.readTime),i=ng.newNoDocument(n,r);return t.hasCommittedMutations?i.setHasCommittedMutations():i}if(t.unknownDocument){var o=jp.fromSegments(t.unknownDocument.path);return r=yv(t.unknownDocument.version),ng.newUnknownDocument(o,r)}return up()}function fv(e,t,n){var r=pv(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){var o=function(e,t){return{name:ny(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Ym(e,t.version.toTimestamp())}}(e.Lt,t),s=t.hasCommittedMutations;return new By(null,null,o,s,r,i)}if(t.isNoDocument()){var a=t.key.path.toArray(),c=mv(t.version);return s=t.hasCommittedMutations,new By(null,new Dy(a,c),null,s,r,i)}if(t.isUnknownDocument()){var l=t.key.path.toArray(),u=mv(t.version);return new By(new Ly(l,u),null,null,!0,r,i)}return up()}function pv(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function gv(e){var t=new vp(e[0],e[1]);return bp.fromTimestamp(t)}function mv(e){var t=e.toTimestamp();return new ky(t.seconds,t.nanoseconds)}function yv(e){var t=new vp(e.seconds,e.nanoseconds);return bp.fromTimestamp(t)}function vv(e,t){for(var n=(t.baseMutations||[]).map(function(t){return hy(e.Lt,t)}),r=0;r<t.mutations.length-1;++r)r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform&&(t.mutations[r].updateTransforms=t.mutations[r+1].transform.fieldTransforms,t.mutations.splice(r+1,1),++r);var i=t.mutations.map(function(t){return hy(e.Lt,t)}),o=vp.fromMillis(t.localWriteTimeMs);return new cv(t.batchId,o,n,i)}function bv(e){var t,n,r=yv(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?yv(e.lastLimboFreeSnapshotVersion):bp.min();return void 0!==e.query.documents?(hp(1===(n=e.query).documents.length),t=Mg(Sg(oy(n.documents[0])))):t=function(e){return Mg(py(e))}(e.query),new uv(t,e.targetId,0,e.lastListenSequenceNumber,r,i,Tp.fromBase64String(e.resumeToken))}function _v(e,t){var n,r=mv(t.snapshotVersion),i=mv(t.lastLimboFreeSnapshotVersion);n=ag(t.target)?dy(e.Lt,t.target):fy(e.Lt,t.target);var o=t.resumeToken.toBase64();return new jy(t.targetId,og(t.target),r,o,t.sequenceNumber,i,n)}function wv(e){var t=py({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?xg(t,t.limit,"L"):t}var Cv=function(){function e(){}return e.prototype.getBundleMetadata=function(e,t){return Ev(e).get(t).next(function(e){if(e)return{id:(t=e).bundleId,createTime:yv(t.createTime),version:t.version};var t})},e.prototype.saveBundleMetadata=function(e,t){return Ev(e).put({bundleId:(n=t).id,createTime:mv(Xm(n.createTime)),version:n.version});var n},e.prototype.getNamedQuery=function(e,t){return Ov(e).get(t).next(function(e){if(e)return{name:(t=e).name,query:wv(t.bundledQuery),readTime:yv(t.readTime)};var t})},e.prototype.saveNamedQuery=function(e,t){return Ov(e).put(function(e){return{name:e.name,readTime:mv(Xm(e.readTime)),bundledQuery:e.bundledQuery}}(t))},e}();function Ev(e){return av(e,Gy.store)}function Ov(e){return av(e,$y.store)}var Sv=function(){function e(){this.Bt=new Pv}return e.prototype.addToCollectionParentIndex=function(e,t){return this.Bt.add(t),Yy.resolve()},e.prototype.getCollectionParents=function(e,t){return Yy.resolve(this.Bt.getEntries(t))},e}(),Pv=function(){function e(){this.index={}}return e.prototype.add=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Pm(Op.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new Pm(Op.comparator)).toArray()},e}(),Iv=function(){function e(){this.qt=new Pv}return e.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(!this.qt.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){n.qt.add(t)});var o={collectionId:r,parent:Py(i)};return Tv(e).put(o)}return Yy.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[yp(t),""],!1,!0);return Tv(e).Nt(r).next(function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(Ay(o.parent))}return n})},e}();function Tv(e){return av(e,zy.store)}var Av={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kv=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e}();function Nv(e,t,n){var r=e.store(xy.store),i=e.store(Ry.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,c=r.$t({range:s},function(e,t,n){return a++,n.delete()});o.push(c.next(function(){hp(1===a)}));for(var l=[],u=0,h=n.mutations;u<h.length;u++){var d=h[u],f=Ry.key(t,d.key.path,n.batchId);o.push(i.delete(f)),l.push(d.key)}return Yy.waitFor(o).next(function(){return l})}function Mv(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw up();t=e.noDocument}return JSON.stringify(t).length}kv.DEFAULT_COLLECTION_PERCENTILE=10,kv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kv.DEFAULT=new kv(41943040,kv.DEFAULT_COLLECTION_PERCENTILE,kv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kv.DISABLED=new kv(-1,0,0);var xv=function(){function e(e,t,n,r){this.userId=e,this.R=t,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return e.Qt=function(t,n,r,i){return hp(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dv(e).$t({index:xy.userMutationsIndex,range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})},e.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=Lv(e),s=Dv(e);return s.add({}).next(function(a){hp("number"==typeof a);for(var c=new cv(a,t,n,r),l=function(e,t,n){var r=n.baseMutations.map(function(t){return uy(e.Lt,t)}),i=n.mutations.map(function(t){return uy(e.Lt,t)});return new xy(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,c),u=[],h=new Pm(function(e,t){return gp(e.canonicalString(),t.canonicalString())}),d=0,f=r;d<f.length;d++){var p=f[d],g=Ry.key(i.userId,p.key.path,a);h=h.add(p.key.path.popLast()),u.push(s.put(l)),u.push(o.put(g,Ry.PLACEHOLDER))}return h.forEach(function(t){u.push(i.Ut.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.Kt[a]=c.keys()}),Yy.waitFor(u).next(function(){return c})})},e.prototype.lookupMutationBatch=function(e,t){var n=this;return Dv(e).get(t).next(function(e){return e?(hp(e.userId===n.userId),vv(n.R,e)):null})},e.prototype.jt=function(e,t){var n=this;return this.Kt[t]?Yy.resolve(this.Kt[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.Kt[t]=r,r}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Dv(e).$t({index:xy.userMutationsIndex,range:i},function(e,t,i){t.userId===n.userId&&(hp(t.batchId>=r),o=vv(n.R,t)),i.done()}).next(function(){return o})},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Dv(e).$t({index:xy.userMutationsIndex,range:t,reverse:!0},function(e,t,r){n=t.batchId,r.done()}).next(function(){return n})},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dv(e).Nt(xy.userMutationsIndex,n).next(function(e){return e.map(function(e){return vv(t.R,e)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=Ry.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Lv(e).$t({range:i},function(r,i,s){var a=r[0],c=r[2],l=Ay(r[1]);if(a===n.userId&&t.path.isEqual(l))return Dv(e).get(c).next(function(e){if(!e)throw up();hp(e.userId===n.userId),o.push(vv(n.R,e))});s.done()}).next(function(){return o})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Pm(gp),i=[];return t.forEach(function(t){var o=Ry.prefixForPath(n.userId,t.path),s=IDBKeyRange.lowerBound(o),a=Lv(e).$t({range:s},function(e,i,o){var s=e[0],a=e[2],c=Ay(e[1]);s===n.userId&&t.path.isEqual(c)?r=r.add(a):o.done()});i.push(a)}),Yy.waitFor(i).next(function(){return n.Wt(e,r)})},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this,r=t.path,i=r.length+1,o=Ry.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Pm(gp);return Lv(e).$t({range:s},function(e,t,o){var s=e[0],c=e[2],l=Ay(e[1]);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()}).next(function(){return n.Wt(e,a)})},e.prototype.Wt=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Dv(e).get(t).next(function(e){if(null===e)throw up();hp(e.userId===n.userId),r.push(vv(n.R,e))}))}),Yy.waitFor(i).next(function(){return r})},e.prototype.removeMutationBatch=function(e,t){var n=this;return Nv(e.Mt,this.userId,t).next(function(r){return e.addOnCommittedListener(function(){n.Gt(t.batchId)}),Yy.forEach(r,function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)})})},e.prototype.Gt=function(e){delete this.Kt[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return Yy.resolve();var r=IDBKeyRange.lowerBound(Ry.prefixForUser(t.userId)),i=[];return Lv(e).$t({range:r},function(e,n,r){if(e[0]===t.userId){var o=Ay(e[1]);i.push(o)}else r.done()}).next(function(){hp(0===i.length)})})},e.prototype.containsKey=function(e,t){return Rv(e,this.userId,t)},e.prototype.zt=function(e){var t=this;return Bv(e).get(this.userId).next(function(e){return e||new My(t.userId,-1,"")})},e}();function Rv(e,t,n){var r=Ry.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Lv(e).$t({range:o,Ft:!0},function(e,n,r){e[0]===t&&e[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Dv(e){return av(e,xy.store)}function Lv(e){return av(e,Ry.store)}function Bv(e){return av(e,My.store)}var Fv=function(){function e(e){this.Ht=e}return e.prototype.next=function(){return this.Ht+=2,this.Ht},e.Jt=function(){return new e(0)},e.Yt=function(){return new e(-1)},e}(),jv=function(){function e(e,t){this.referenceDelegate=e,this.R=t}return e.prototype.allocateTargetId=function(e){var t=this;return this.Xt(e).next(function(n){var r=new Fv(n.highestTargetId);return n.highestTargetId=r.next(),t.Zt(e,n).next(function(){return n.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.Xt(e).next(function(e){return bp.fromTimestamp(new vp(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(e){return this.Xt(e).next(function(e){return e.highestListenSequenceNumber})},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.Xt(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Zt(e,i)})},e.prototype.addTargetData=function(e,t){var n=this;return this.te(e,t).next(function(){return n.Xt(e).next(function(r){return r.targetCount+=1,n.ee(t,r),n.Zt(e,r)})})},e.prototype.updateTargetData=function(e,t){return this.te(e,t)},e.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return Uv(e).delete(t.targetId)}).next(function(){return n.Xt(e)}).next(function(t){return hp(t.targetCount>0),t.targetCount-=1,n.Zt(e,t)})},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return Uv(e).$t(function(s,a){var c=bv(a);c.sequenceNumber<=t&&null===n.get(c.targetId)&&(i++,o.push(r.removeTargetData(e,c)))}).next(function(){return Yy.waitFor(o)}).next(function(){return i})},e.prototype.forEachTarget=function(e,t){return Uv(e).$t(function(e,n){var r=bv(n);t(r)})},e.prototype.Xt=function(e){return Vv(e).get(Vy.key).next(function(e){return hp(null!==e),e})},e.prototype.Zt=function(e,t){return Vv(e).put(Vy.key,t)},e.prototype.te=function(e,t){return Uv(e).put(_v(this.R,t))},e.prototype.ee=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getTargetCount=function(e){return this.Xt(e).next(function(e){return e.targetCount})},e.prototype.getTargetData=function(e,t){var n=og(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Uv(e).$t({range:r,index:jy.queryTargetsIndexName},function(e,n,r){var o=bv(n);sg(t,o.target)&&(i=o,r.done())}).next(function(){return i})},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=zv(e);return t.forEach(function(t){var s=Py(t.path);i.push(o.put(new Uy(n,s))),i.push(r.referenceDelegate.addReference(e,n,t))}),Yy.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=zv(e);return Yy.forEach(t,function(t){var o=Py(t.path);return Yy.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,n,t)])})},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=zv(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=zv(e),i=Dm();return r.$t({range:n,Ft:!0},function(e,t,n){var r=Ay(e[1]),o=new jp(r);i=i.add(o)}).next(function(){return i})},e.prototype.containsKey=function(e,t){var n=Py(t.path),r=IDBKeyRange.bound([n],[yp(n)],!1,!0),i=0;return zv(e).$t({index:Uy.documentTargetsIndex,Ft:!0,range:r},function(e,t,n){0!==e[0]&&(i++,n.done())}).next(function(){return i>0})},e.prototype.lt=function(e,t){return Uv(e).get(t).next(function(e){return e?bv(e):null})},e}();function Uv(e){return av(e,jy.store)}function Vv(e){return av(e,Vy.store)}function zv(e){return av(e,Uy.store)}function Hv(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){if(e.code!==np.FAILED_PRECONDITION||e.message!==Wy)throw e;return sp("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Gv(e,t){var n=e[1],r=t[1],i=gp(e[0],t[0]);return 0===i?gp(n,r):i}var $v=function(){function e(e){this.ne=e,this.buffer=new Pm(Gv),this.se=0}return e.prototype.ie=function(){return++this.se},e.prototype.re=function(e){var t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Gv(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),qv=function(){function e(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}return e.prototype.start=function(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(e)},e.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),e.prototype.ue=function(e){var t=this,n=this.oe?3e5:6e4;sp("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(Gl.b)(t,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,e.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return tv(t=n.sent())?(sp("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,Hv(t)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(e)];case 8:return n.sent(),[2]}})})})},e}(),Wv=function(){function e(e,t){this.ae=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.ae.he(e).next(function(e){return Math.floor(t/100*e)})},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return Yy.resolve(tp.o);var r=new $v(t);return this.ae.forEachTarget(e,function(e){return r.re(e.sequenceNumber)}).next(function(){return n.ae.le(e,function(e){return r.re(e)})}).next(function(){return r.maxValue})},e.prototype.removeTargets=function(e,t,n){return this.ae.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.ae.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(sp("LruGarbageCollector","Garbage collection skipped; disabled"),Yy.resolve(Av)):this.getCacheSize(e).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(sp("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Av):n.fe(e,t)})},e.prototype.getCacheSize=function(e){return this.ae.getCacheSize(e)},e.prototype.fe=function(e,t){var n,r,i,o,s,a,c,l=this,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>l.params.maximumSequenceNumbersToCollect?(sp("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+t),r=l.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),l.nthSequenceNumber(e,r)}).next(function(r){return n=r,s=Date.now(),l.removeTargets(e,n,t)}).next(function(t){return i=t,a=Date.now(),l.removeOrphanedDocuments(e,n)}).next(function(e){return c=Date.now(),op()<=ql.a.DEBUG&&sp("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-u)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+e+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-u)+"ms"),Yy.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})})},e}(),Zv=function(){function e(e,t){this.db=e,this.garbageCollector=function(e,t){return new Wv(e,t)}(this,t)}return e.prototype.he=function(e){var t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.de=function(e){var t=0;return this.le(e,function(e){t++}).next(function(){return t})},e.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},e.prototype.le=function(e,t){return this.we(e,function(e,n){return t(n)})},e.prototype.addReference=function(e,t,n){return Qv(e,n)},e.prototype.removeReference=function(e,t,n){return Qv(e,n)},e.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},e.prototype.markPotentiallyOrphaned=function(e,t){return Qv(e,t)},e.prototype._e=function(e,t){return function(e,t){var n=!1;return Bv(e).Ot(function(r){return Rv(e,r,t).next(function(e){return e&&(n=!0),Yy.resolve(!e)})}).next(function(){return n})}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(e,function(s,a){if(a<=t){var c=n._e(e,s).next(function(t){if(!t)return o++,r.getEntry(e,s).next(function(){return r.removeEntry(s),zv(e).delete([0,Py(s.path)])})});i.push(c)}}).next(function(){return Yy.waitFor(i)}).next(function(){return r.apply(e)}).next(function(){return o})},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)},e.prototype.updateLimboDocument=function(e,t){return Qv(e,t)},e.prototype.we=function(e,t){var n,r=zv(e),i=tp.o;return r.$t({index:Uy.documentTargetsIndex},function(e,r){var o=r.path,s=r.sequenceNumber;0===e[0]?(i!==tp.o&&t(new jp(Ay(n)),i),i=s,n=o):i=tp.o}).next(function(){i!==tp.o&&t(new jp(Ay(n)),i)})},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function Qv(e,t){return zv(e).put(function(e,t){return new Uy(0,Py(e.path),t)}(t,e.currentSequenceNumber))}var Yv=function(){function e(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){wp(this.inner,function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];e(o[0],o[1])}})},e.prototype.isEmpty=function(){return Cp(this.inner)},e}(),Kv=function(){function e(){this.changes=new Yv(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return e.prototype.getReadTime=function(e){var t=this.changes.get(e);return t?t.readTime:bp.min()},e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})},e.prototype.removeEntry=function(e,t){void 0===t&&(t=null),this.assertNotApplied(),this.changes.set(e,{document:ng.newInvalidDocument(e),readTime:t})},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Yy.resolve(n.document):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){},e}(),Jv=function(){function e(e,t){this.R=e,this.Ut=t}return e.prototype.addEntry=function(e,t,n){return tb(e).put(nb(t),n)},e.prototype.removeEntry=function(e,t){var n=tb(e),r=nb(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.me(e,r)})},e.prototype.getEntry=function(e,t){var n=this;return tb(e).get(nb(t)).next(function(e){return n.ye(t,e)})},e.prototype.ge=function(e,t){var n=this;return tb(e).get(nb(t)).next(function(e){return{document:n.ye(t,e),size:Mv(e)}})},e.prototype.getEntries=function(e,t){var n=this,r=Am();return this.pe(e,t,function(e,t){var i=n.ye(e,t);r=r.insert(e,i)}).next(function(){return r})},e.prototype.Ee=function(e,t){var n=this,r=Am(),i=new Em(jp.comparator);return this.pe(e,t,function(e,t){var o=n.ye(e,t);r=r.insert(e,o),i=i.insert(e,Mv(t))}).next(function(){return{documents:r,Te:i}})},e.prototype.pe=function(e,t,n){if(t.isEmpty())return Yy.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return tb(e).$t({range:r},function(e,t,r){for(var s=jp.fromSegments(e);o&&jp.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},e.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this,i=Am(),o=t.path.length+1,s={};if(n.isEqual(bp.min())){var a=t.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var c=t.path.toArray(),l=pv(n);s.range=IDBKeyRange.lowerBound([c,l],!0),s.index=By.collectionReadTimeIndex}return tb(e).$t(s,function(e,n,s){if(e.length===o){var a=dv(r.R,n);t.path.isPrefixOf(a.key.path)?Bg(t,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},e.prototype.newChangeBuffer=function(e){return new Xv(this,!!e&&e.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},e.prototype.getMetadata=function(e){return eb(e).get(Fy.key).next(function(e){return hp(!!e),e})},e.prototype.me=function(e,t){return eb(e).put(Fy.key,t)},e.prototype.ye=function(e,t){if(t){var n=dv(this.R,t);if(!n.isNoDocument()||!n.version.isEqual(bp.min()))return n}return ng.newInvalidDocument(e)},e}(),Xv=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Ie=t,r.trackRemovals=n,r.Ae=new Yv(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),r}return Object(Gl.c)(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new Pm(function(e,t){return gp(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(o,s){var a=t.Ae.get(o);if(s.document.isValidDocument()){var c=fv(t.Ie.R,s.document,t.getReadTime(o));i=i.add(o.path.popLast());var l=Mv(c);r+=l-a,n.push(t.Ie.addEntry(e,o,c))}else if(r-=a,t.trackRemovals){var u=fv(t.Ie.R,ng.newNoDocument(o,bp.min()),t.getReadTime(o));n.push(t.Ie.addEntry(e,o,u))}else n.push(t.Ie.removeEntry(e,o))}),i.forEach(function(r){n.push(t.Ie.Ut.addToCollectionParentIndex(e,r))}),n.push(this.Ie.updateMetadata(e,r)),Yy.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.Ie.ge(e,t).next(function(e){return n.Ae.set(t,e.size),e.document})},t.prototype.getAllFromCache=function(e,t){var n=this;return this.Ie.Ee(e,t).next(function(e){var t=e.documents;return e.Te.forEach(function(e,t){n.Ae.set(e,t)}),t})},t}(Kv);function eb(e){return av(e,Fy.store)}function tb(e){return av(e,By.store)}function nb(e){return e.path.toArray()}var rb=function(){function e(e){this.R=e}return e.prototype.Rt=function(e,t,n,r){var i=this;hp(n<r&&n>=0&&r<=11);var o=new Ky("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Ny.store)}(e),function(e){e.createObjectStore(My.store,{keyPath:My.keyPath}),e.createObjectStore(xy.store,{keyPath:xy.keyPath,autoIncrement:!0}).createIndex(xy.userMutationsIndex,xy.userMutationsKeyPath,{unique:!0}),e.createObjectStore(Ry.store)}(e),ib(e),function(e){e.createObjectStore(By.store)}(e));var s=Yy.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Uy.store),e.deleteObjectStore(jy.store),e.deleteObjectStore(Vy.store)}(e),ib(e)),s=s.next(function(){return function(e){var t=e.store(Vy.store),n=new Vy(0,0,bp.min().toTimestamp(),0);return t.put(Vy.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(e,t){return t.store(xy.store).Nt().next(function(n){e.deleteObjectStore(xy.store),e.createObjectStore(xy.store,{keyPath:xy.keyPath,autoIncrement:!0}).createIndex(xy.userMutationsIndex,xy.userMutationsKeyPath,{unique:!0});var r=t.store(xy.store),i=n.map(function(e){return r.put(e)});return Yy.waitFor(i)})}(e,o)})),s=s.next(function(){!function(e){e.createObjectStore(Hy.store,{keyPath:Hy.keyPath})}(e)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(e){e.createObjectStore(Fy.store)}(e),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(e,o)})),n<9&&r>=9&&(s=s.next(function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(By.store);t.createIndex(By.readTimeIndex,By.readTimeIndexPath,{unique:!1}),t.createIndex(By.collectionReadTimeIndex,By.collectionReadTimeIndexPath,{unique:!1})}(t)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(e){e.createObjectStore(Gy.store,{keyPath:Gy.keyPath})}(e),function(e){e.createObjectStore($y.store,{keyPath:$y.keyPath})}(e)})),s},e.prototype.be=function(e){var t=0;return e.store(By.store).$t(function(e,n){t+=Mv(n)}).next(function(){var n=new Fy(t);return e.store(Fy.store).put(Fy.key,n)})},e.prototype.Re=function(e){var t=this,n=e.store(My.store),r=e.store(xy.store);return n.Nt().next(function(n){return Yy.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(xy.userMutationsIndex,i).next(function(r){return Yy.forEach(r,function(r){hp(r.userId===n.userId);var i=vv(t.R,r);return Nv(e,n.userId,i).next(function(){})})})})})},e.prototype.ve=function(e){var t=e.store(Uy.store),n=e.store(By.store);return e.store(Vy.store).get(Vy.key).next(function(e){var r=[];return n.$t(function(n,i){var o=new Op(n),s=function(e){return[0,Py(e)]}(o);r.push(t.get(s).next(function(n){return n?Yy.resolve():function(n){return t.put(new Uy(0,Py(n),e.highestListenSequenceNumber))}(o)}))}).next(function(){return Yy.waitFor(r)})})},e.prototype.Pe=function(e,t){e.createObjectStore(zy.store,{keyPath:zy.keyPath});var n=t.store(zy.store),r=new Pv,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Py(i)})}};return t.store(By.store).$t({Ft:!0},function(e,t){var n=new Op(e);return i(n.popLast())}).next(function(){return t.store(Ry.store).$t({Ft:!0},function(e,t){var n=Ay(e[1]);return i(n.popLast())})})},e.prototype.Ve=function(e){var t=this,n=e.store(jy.store);return n.$t(function(e,r){var i=bv(r),o=_v(t.R,i);return n.put(o)})},e}();function ib(e){e.createObjectStore(Uy.store,{keyPath:Uy.keyPath}).createIndex(Uy.documentTargetsIndex,Uy.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(jy.store,{keyPath:jy.keyPath}).createIndex(jy.queryTargetsIndexName,jy.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Vy.store)}var ob="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sb=function(){function e(t,n,r,i,o,s,a,c,l,u){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=l,this.Ce=u,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(e){return Promise.resolve()},!e.yt())throw new rp(np.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Zv(this,i),this.Le=n+"main",this.R=new hv(c),this.Be=new Jy(this.Le,11,new rb(this.R)),this.qe=new jv(this.referenceDelegate,this.R),this.Ut=new Iv,this.Ue=function(e,t){return new Jv(e,t)}(this.R,this.Ut),this.Ke=new Cv,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===u&&ap("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var e=this;return this.je().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new rp(np.FAILED_PRECONDITION,ob);return e.We(),e.Ge(),e.ze(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qe.getHighestSequenceNumber(t)})}).then(function(t){e.Ne=new tp(t,e.De)}).then(function(){e.xe=!0}).catch(function(t){return e.Be&&e.Be.close(),Promise.reject(t)})},e.prototype.He=function(e){var t=this;return this.Me=function(n){return Object(Gl.b)(t,void 0,void 0,function(){return Object(Gl.d)(this,function(t){return this.started?[2,e(n)]:[2]})})},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.Be.vt(function(n){return Object(Gl.b)(t,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return null===n.newVersion?[4,e()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget(function(){return Object(Gl.b)(t,void 0,void 0,function(){return Object(Gl.d)(this,function(e){switch(e.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},e.prototype.je=function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return cb(t).put(new Hy(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next(function(){if(e.isPrimary)return e.Je(t).next(function(t){t||(e.isPrimary=!1,e.Se.enqueueRetryable(function(){return e.Me(!1)}))})}).next(function(){return e.Ye(t)}).next(function(n){return e.isPrimary&&!n?e.Xe(t).next(function(){return!1}):!!n&&e.Ze(t).next(function(){return!0})})}).catch(function(t){if(tv(t))return sp("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return sp("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){e.isPrimary!==t&&e.Se.enqueueRetryable(function(){return e.Me(t)}),e.isPrimary=t})},e.prototype.Je=function(e){var t=this;return ab(e).get(Ny.key).next(function(e){return Yy.resolve(t.tn(e))})},e.prototype.en=function(e){return cb(e).delete(this.clientId)},e.prototype.nn=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t,n,r=this;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var t=av(e,Hy.store);return t.Nt().next(function(e){var n=r.rn(e,18e5),i=e.filter(function(e){return-1===n.indexOf(e)});return Yy.forEach(i,function(e){return t.delete(e.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(e=i.sent(),this.Qe)for(t=0,n=e;t<n.length;t++)this.Qe.removeItem(this.on(n[t].clientId));i.label=2;case 2:return[2]}})})},e.prototype.ze=function(){var e=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.je().then(function(){return e.nn()}).then(function(){return e.ze()})})},e.prototype.tn=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.Ye=function(e){var t=this;return this.Ce?Yy.resolve(!0):ab(e).get(Ny.key).next(function(n){if(null!==n&&t.sn(n.leaseTimestampMs,5e3)&&!t.cn(n.ownerId)){if(t.tn(n)&&t.networkEnabled)return!0;if(!t.tn(n)){if(!n.allowTabSynchronization)throw new rp(np.FAILED_PRECONDITION,ob);return!1}}return!(!t.networkEnabled||!t.inForeground)||cb(e).Nt().next(function(e){return void 0===t.rn(e,5e3).find(function(e){return!(t.clientId===e.clientId||!(!t.networkEnabled&&e.networkEnabled||!t.inForeground&&e.inForeground&&t.networkEnabled===e.networkEnabled))})})}).next(function(e){return t.isPrimary!==e&&sp("IndexedDbPersistence","Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},e.prototype.shutdown=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e=this;return Object(Gl.d)(this,function(t){switch(t.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Ny.store,Hy.store],function(t){var n=new sv(t,tp.o);return e.Xe(n).next(function(){return e.en(n)})})];case 1:return t.sent(),this.Be.close(),this.ln(),[2]}})})},e.prototype.rn=function(e,t){var n=this;return e.filter(function(e){return n.sn(e.updateTimeMs,t)&&!n.cn(e.clientId)})},e.prototype.fn=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return cb(t).Nt().next(function(t){return e.rn(t,18e5).map(function(e){return e.clientId})})})},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.getMutationQueue=function(e){return xv.Qt(e,this.R,this.Ut,this.referenceDelegate)},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(e,t,n){var r,i=this;return sp("IndexedDbPersistence","Starting transaction:",e),this.Be.runTransaction(e,"readonly"===t?"readonly":"readwrite",qy,function(o){return r=new sv(o,i.Ne?i.Ne.next():tp.o),"readwrite-primary"===t?i.Je(r).next(function(e){return!!e||i.Ye(r)}).next(function(t){if(!t)throw ap("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new rp(np.FAILED_PRECONDITION,Wy);return n(r)}).next(function(e){return i.Ze(r).next(function(){return e})}):i.dn(r).next(function(){return n(r)})}).then(function(e){return r.raiseOnCommittedEvent(),e})},e.prototype.dn=function(e){var t=this;return ab(e).get(Ny.key).next(function(e){if(null!==e&&t.sn(e.leaseTimestampMs,5e3)&&!t.cn(e.ownerId)&&!t.tn(e)&&!(t.Ce||t.allowTabSynchronization&&e.allowTabSynchronization))throw new rp(np.FAILED_PRECONDITION,ob)})},e.prototype.Ze=function(e){var t=new Ny(this.clientId,this.allowTabSynchronization,Date.now());return ab(e).put(Ny.key,t)},e.yt=function(){return Jy.yt()},e.prototype.Xe=function(e){var t=this,n=ab(e);return n.get(Ny.key).next(function(e){return t.tn(e)?(sp("IndexedDbPersistence","Releasing primary lease."),n.delete(Ny.key)):Yy.resolve()})},e.prototype.sn=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(ap("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.We=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){e.Se.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.je()})},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},e.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},e.prototype.Ge=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ke=function(){t.un(),Object($l.z)()&&navigator.appVersion.match("Version/14")&&t.Se.enterRestrictedMode(!0),t.Se.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("pagehide",this.ke))},e.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},e.prototype.cn=function(e){var t;try{var n=null!==(null===(t=this.Qe)||void 0===t?void 0:t.getItem(this.on(e)));return sp("IndexedDbPersistence","Client '"+e+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(e){return ap("IndexedDbPersistence","Failed to get zombied client id.",e),!1}},e.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(e){ap("Failed to set zombie client id.",e)}},e.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(e){}},e.prototype.on=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e}();function ab(e){return av(e,Ny.store)}function cb(e){return av(e,Hy.store)}function lb(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var ub=function(e,t){this.progress=e,this.wn=t},hb=function(){function e(e,t,n){this.Ue=e,this._n=t,this.Ut=n}return e.prototype.mn=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.yn(e,t,r)})},e.prototype.yn=function(e,t,n){return this.Ue.getEntry(e,t).next(function(e){for(var t=0,r=n;t<r.length;t++)r[t].applyToLocalView(e);return e})},e.prototype.gn=function(e,t){e.forEach(function(e,n){for(var r=0,i=t;r<i.length;r++)i[r].applyToLocalView(n)})},e.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next(function(t){return n.En(e,t).next(function(){return t})})},e.prototype.En=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){return n.gn(t,e)})},e.prototype.getDocumentsMatchingQuery=function(e,t,n){return function(e){return jp.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):kg(t)?this.In(e,t,n):this.An(e,t,n)},e.prototype.Tn=function(e,t){return this.mn(e,new jp(t)).next(function(e){var t=Nm();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})},e.prototype.In=function(e,t,n){var r=this,i=t.collectionGroup,o=Nm();return this.Ut.getCollectionParents(e,i).next(function(s){return Yy.forEach(s,function(s){var a=function(e,t){return new Eg(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return r.An(e,a,n).next(function(e){e.forEach(function(e,t){o=o.insert(e,t)})})}).next(function(){return o})})},e.prototype.An=function(e,t,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return o.Rn(e,i=t,r).next(function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],s=0,a=o.mutations;s<a.length;s++){var c=a[s],l=c.key,u=r.get(l);null==u&&(u=ng.newInvalidDocument(l),r=r.insert(l,u)),am(c,u,o.localWriteTime),u.isFoundDocument()||(r=r.remove(l))}})}).next(function(){return r.forEach(function(e,n){Bg(t,n)||(r=r.remove(e))}),r})},e.prototype.Rn=function(e,t,n){for(var r=Dm(),i=0,o=t;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var c=a[s];c instanceof dm&&null===n.get(c.key)&&(r=r.add(c.key))}var l=n;return this.Ue.getEntries(e,r).next(function(e){return e.forEach(function(e,t){t.isFoundDocument()&&(l=l.insert(e,t))}),l})},e}(),db=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.bn=n,this.vn=r}return e.Pn=function(t,n){for(var r=Dm(),i=Dm(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),fb=function(){function e(){}return e.prototype.Vn=function(e){this.Sn=e},e.prototype.getDocumentsMatchingQuery=function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(bp.min())?this.Dn(e,t):this.Sn.pn(e,r).next(function(o){var s=i.Cn(t,o);return(Pg(t)||Ig(t))&&i.Nn(t.limitType,s,r,n)?i.Dn(e,t):(op()<=ql.a.DEBUG&&sp("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Lg(t)),i.Sn.getDocumentsMatchingQuery(e,t,n).next(function(e){return s.forEach(function(t){e=e.insert(t.key,t)}),e}))})},e.prototype.Cn=function(e,t){var n=new Pm(Fg(e));return t.forEach(function(t,r){Bg(e,r)&&(n=n.add(r))}),n},e.prototype.Nn=function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},e.prototype.Dn=function(e,t){return op()<=ql.a.DEBUG&&sp("QueryEngine","Using full collection scan to execute query:",Lg(t)),this.Sn.getDocumentsMatchingQuery(e,t,bp.min())},e}(),pb=function(){function e(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.kn=new Em(gp),this.Fn=new Yv(function(e){return og(e)},sg),this.$n=bp.min(),this._n=e.getMutationQueue(n),this.On=e.getRemoteDocumentCache(),this.qe=e.getTargetCache(),this.Mn=new hb(this.On,this._n,this.persistence.getIndexManager()),this.Ke=e.getBundleCache(),this.xn.Vn(this.Mn)}return e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.kn)})},e}();function gb(e,t,n,r){return new pb(e,t,n,r)}function mb(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Gl.d)(this,function(s){switch(s.label){case 0:return n=dp(e),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(e){var o;return n._n.getAllMutationBatches(e).next(function(s){return o=s,r=n.persistence.getMutationQueue(t),i=new hb(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)}).next(function(t){for(var n=[],r=[],s=Dm(),a=0,c=o;a<c.length;a++){var l=c[a];n.push(l.batchId);for(var u=0,h=l.mutations;u<h.length;u++)s=s.add(h[u].key)}for(var d=0,f=t;d<f.length;d++){var p=f[d];r.push(p.batchId);for(var g=0,m=p.mutations;g<m.length;g++)s=s.add(m[g].key)}return i.pn(e,s).next(function(e){return{Ln:e,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function yb(e,t){var n=dp(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r=t.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,o=i.keys(),s=Yy.resolve();return o.forEach(function(e){s=s.next(function(){return r.getEntry(t,e)}).next(function(t){var o=n.docVersions.get(e);hp(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))})}),s.next(function(){return e._n.removeMutationBatch(t,i)})}(n,e,t,i).next(function(){return i.apply(e)}).next(function(){return n._n.performConsistencyCheck(e)}).next(function(){return n.Mn.pn(e,r)})})}function vb(e){var t=dp(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.qe.getLastRemoteSnapshotVersion(e)})}function bb(e,t){var n=dp(e),r=t.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];t.targetChanges.forEach(function(t,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(e,t.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(e,t.addedDocuments,o)}));var c=t.resumeToken;if(c.approximateByteSize()>0){var l=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(o,l),function(e,t,n){return hp(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,l,t)&&s.push(n.qe.updateTargetData(e,l))}}});var a=Am();if(t.documentUpdates.forEach(function(r,i){t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),s.push(_b(e,o,t.documentUpdates,r,void 0).next(function(e){a=e})),!r.isEqual(bp.min())){var c=n.qe.getLastRemoteSnapshotVersion(e).next(function(t){return n.qe.setTargetsMetadata(e,e.currentSequenceNumber,r)});s.push(c)}return Yy.waitFor(s).next(function(){return o.apply(e)}).next(function(){return n.Mn.En(e,a)}).next(function(){return a})}).then(function(e){return n.kn=i,e})}function _b(e,t,n,r,i){var o=Dm();return n.forEach(function(e){return o=o.add(e)}),t.getEntries(e,o).next(function(e){var o=Am();return n.forEach(function(n,s){var a=e.get(n),c=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(bp.min())?(t.removeEntry(n,c),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s,c),o=o.insert(n,s)):sp("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function wb(e,t){var n=dp(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t)})}function Cb(e,t){var n=dp(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.qe.getTargetData(e,t).next(function(i){return i?Yy.resolve(r=i):n.qe.allocateTargetId(e).next(function(i){return r=new uv(t,i,0,e.currentSequenceNumber),n.qe.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.kn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(e.targetId,e),n.Fn.set(t,e.targetId)),e})}function Eb(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:r=dp(e),i=r.kn.get(t),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(e){return r.persistence.referenceDelegate.removeTarget(e,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!tv(s=a.sent()))throw s;return sp("LocalStore","Failed to update sequence numbers for target "+t+": "+s),[3,5];case 5:return r.kn=r.kn.remove(t),r.Fn.delete(i.target),[2]}})})}function Ob(e,t,n){var r=dp(e),i=bp.min(),o=Dm();return r.persistence.runTransaction("Execute query","readonly",function(e){return function(e,t,n){var r=dp(e),i=r.Fn.get(n);return void 0!==i?Yy.resolve(r.kn.get(i)):r.qe.getTargetData(t,n)}(r,e,Mg(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(e,t.targetId).next(function(e){o=e})}).next(function(){return r.xn.getDocumentsMatchingQuery(e,t,n?i:bp.min(),n?o:Dm())}).next(function(e){return{documents:e,Bn:o}})})}function Sb(e,t){var n=dp(e),r=dp(n.qe),i=n.kn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.lt(e,t).next(function(e){return e?e.target:null})})}function Pb(e){var t=dp(e);return t.persistence.runTransaction("Get new document changes","readonly",function(e){return function(e,t,n){var r=dp(e),i=Am(),o=pv(n),s=tb(t),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:By.readTimeIndex,range:a},function(e,t){var n=dv(r.R,t);i=i.insert(n.key,n),o=t.readTime}).next(function(){return{wn:i,readTime:gv(o)}})}(t.On,e,t.$n)}).then(function(e){var n=e.wn;return t.$n=e.readTime,n})}function Ib(e){return Object(Gl.b)(this,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){return[2,(t=dp(e)).persistence.runTransaction("Synchronize last document change read time","readonly",function(e){return function(e){var t=tb(e),n=bp.min();return t.$t({index:By.readTimeIndex,reverse:!0},function(e,t,r){t.readTime&&(n=gv(t.readTime)),r.done()}).next(function(){return n})}(e)}).then(function(e){t.$n=e})]})})}function Tb(e,t,n,r){return Object(Gl.b)(this,void 0,void 0,function(){var i,o,s,a,c,l,u,h,d,f;return Object(Gl.d)(this,function(p){switch(p.label){case 0:for(i=dp(e),o=Dm(),s=Am(),a=xm(),c=0,l=n;c<l.length;c++)h=t.qn((u=l[c]).metadata.name),u.document&&(o=o.add(h)),s=s.insert(h,t.Un(u)),a=a.insert(h,t.Kn(u.metadata.readTime));return d=i.On.newChangeBuffer({trackRemovals:!0}),[4,Cb(i,function(e){return Mg(Sg(Op.fromString("__bundle__/docs/"+e)))}(r))];case 1:return f=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return _b(e,d,s,bp.min(),a).next(function(t){return d.apply(e),t}).next(function(t){return i.qe.removeMatchingKeysForTargetId(e,f.targetId).next(function(){return i.qe.addMatchingKeys(e,o,f.targetId)}).next(function(){return i.Mn.En(e,t)}).next(function(){return t})})})]}})})}function Ab(e,t,n){return void 0===n&&(n=Dm()),Object(Gl.b)(this,void 0,void 0,function(){var r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return[4,Cb(e,Mg(wv(t.bundledQuery)))];case 1:return r=o.sent(),[2,(i=dp(e)).persistence.runTransaction("Save named query","readwrite",function(e){var o=Xm(t.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(e,t);var s=r.withResumeToken(Tp.EMPTY_BYTE_STRING,o);return i.kn=i.kn.insert(s.targetId,s),i.qe.updateTargetData(e,s).next(function(){return i.qe.removeMatchingKeysForTargetId(e,r.targetId)}).next(function(){return i.qe.addMatchingKeys(e,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(e,t)})})]}})})}var kb=function(){function e(e){this.R=e,this.Qn=new Map,this.jn=new Map}return e.prototype.getBundleMetadata=function(e,t){return Yy.resolve(this.Qn.get(t))},e.prototype.saveBundleMetadata=function(e,t){var n;return this.Qn.set(t.id,{id:(n=t).id,version:n.version,createTime:Xm(n.createTime)}),Yy.resolve()},e.prototype.getNamedQuery=function(e,t){return Yy.resolve(this.jn.get(t))},e.prototype.saveNamedQuery=function(e,t){return this.jn.set(t.name,function(e){return{name:e.name,query:wv(e.bundledQuery),readTime:Xm(e.readTime)}}(t)),Yy.resolve()},e}(),Nb=function(){function e(){this.Wn=new Pm(Mb.Gn),this.zn=new Pm(Mb.Hn)}return e.prototype.isEmpty=function(){return this.Wn.isEmpty()},e.prototype.addReference=function(e,t){var n=new Mb(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},e.prototype.Jn=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},e.prototype.removeReference=function(e,t){this.Yn(new Mb(e,t))},e.prototype.Xn=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},e.prototype.Zn=function(e){var t=this,n=new jp(new Op([])),r=new Mb(n,e),i=new Mb(n,e+1),o=[];return this.zn.forEachInRange([r,i],function(e){t.Yn(e),o.push(e.key)}),o},e.prototype.ts=function(){var e=this;this.Wn.forEach(function(t){return e.Yn(t)})},e.prototype.Yn=function(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)},e.prototype.es=function(e){var t=new jp(new Op([])),n=new Mb(t,e),r=new Mb(t,e+1),i=Dm();return this.zn.forEachInRange([n,r],function(e){i=i.add(e.key)}),i},e.prototype.containsKey=function(e){var t=new Mb(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),Mb=function(){function e(e,t){this.key=e,this.ns=t}return e.Gn=function(e,t){return jp.comparator(e.key,t.key)||gp(e.ns,t.ns)},e.Hn=function(e,t){return gp(e.ns,t.ns)||jp.comparator(e.key,t.key)},e}(),xb=function(){function e(e,t){this.Ut=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new Pm(Mb.Gn)}return e.prototype.checkEmpty=function(e){return Yy.resolve(0===this._n.length)},e.prototype.addMutationBatch=function(e,t,n,r){var i=this.ss;this.ss++;var o=new cv(i,t,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var c=a[s];this.rs=this.rs.add(new Mb(c.key,i)),this.Ut.addToCollectionParentIndex(e,c.key.path.popLast())}return Yy.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return Yy.resolve(this.os(t))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this.cs(t+1),r=n<0?0:n;return Yy.resolve(this._n.length>r?this._n[r]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return Yy.resolve(0===this._n.length?-1:this.ss-1)},e.prototype.getAllMutationBatches=function(e){return Yy.resolve(this._n.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new Mb(t,0),i=new Mb(t,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(e){var t=n.os(e.ns);o.push(t)}),Yy.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Pm(gp);return t.forEach(function(e){var t=new Mb(e,0),i=new Mb(e,Number.POSITIVE_INFINITY);n.rs.forEachInRange([t,i],function(e){r=r.add(e.ns)})}),Yy.resolve(this.us(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=t.path,r=n.length+1,i=n;jp.isDocumentKey(i)||(i=i.child(""));var o=new Mb(new jp(i),0),s=new Pm(gp);return this.rs.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.ns)),!0)},o),Yy.resolve(this.us(s))},e.prototype.us=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.os(e);null!==r&&n.push(r)}),n},e.prototype.removeMutationBatch=function(e,t){var n=this;hp(0===this.hs(t.batchId,"removed")),this._n.shift();var r=this.rs;return Yy.forEach(t.mutations,function(i){var o=new Mb(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.rs=r})},e.prototype.Gt=function(e){},e.prototype.containsKey=function(e,t){var n=new Mb(t,0),r=this.rs.firstAfterOrEqual(n);return Yy.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return Yy.resolve()},e.prototype.hs=function(e,t){return this.cs(e)},e.prototype.cs=function(e){return 0===this._n.length?0:e-this._n[0].batchId},e.prototype.os=function(e){var t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]},e}(),Rb=function(){function e(e,t){this.Ut=e,this.ls=t,this.docs=new Em(jp.comparator),this.size=0}return e.prototype.addEntry=function(e,t,n){var r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(e,r.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return Yy.resolve(n?n.document.clone():ng.newInvalidDocument(t))},e.prototype.getEntries=function(e,t){var n=this,r=Am();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.clone():ng.newInvalidDocument(e))}),Yy.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t,n){for(var r=Am(),i=new jp(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,c=a.document,l=a.readTime;if(!t.path.isPrefixOf(s.key.path))break;l.compareTo(n)<=0||Bg(t,c)&&(r=r.insert(c.key,c.clone()))}return Yy.resolve(r)},e.prototype.fs=function(e,t){return Yy.forEach(this.docs,function(e){return t(e)})},e.prototype.newChangeBuffer=function(e){return new Db(this)},e.prototype.getSize=function(e){return Yy.resolve(this.size)},e}(),Db=function(e){function t(t){var n=this;return(n=e.call(this)||this).Ie=t,n}return Object(Gl.c)(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(t.Ie.addEntry(e,i.document,t.getReadTime(r))):t.Ie.removeEntry(r)}),Yy.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.Ie.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.Ie.getEntries(e,t)},t}(Kv),Lb=function(){function e(e){this.persistence=e,this.ds=new Yv(function(e){return og(e)},sg),this.lastRemoteSnapshotVersion=bp.min(),this.highestTargetId=0,this.ws=0,this._s=new Nb,this.targetCount=0,this.ys=Fv.Jt()}return e.prototype.forEachTarget=function(e,t){return this.ds.forEach(function(e,n){return t(n)}),Yy.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return Yy.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return Yy.resolve(this.ws)},e.prototype.allocateTargetId=function(e){return this.highestTargetId=this.ys.next(),Yy.resolve(this.highestTargetId)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),Yy.resolve()},e.prototype.te=function(e){this.ds.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.ys=new Fv(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)},e.prototype.addTargetData=function(e,t){return this.te(t),this.targetCount+=1,Yy.resolve()},e.prototype.updateTargetData=function(e,t){return this.te(t),Yy.resolve()},e.prototype.removeTargetData=function(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,Yy.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Yy.waitFor(o).next(function(){return i})},e.prototype.getTargetCount=function(e){return Yy.resolve(this.targetCount)},e.prototype.getTargetData=function(e,t){var n=this.ds.get(t)||null;return Yy.resolve(n)},e.prototype.addMatchingKeys=function(e,t,n){return this._s.Jn(t,n),Yy.resolve()},e.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Yy.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this._s.Zn(t),Yy.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this._s.es(t);return Yy.resolve(n)},e.prototype.containsKey=function(e,t){return Yy.resolve(this._s.containsKey(t))},e}(),Bb=function(){function e(e,t){var n=this;this.gs={},this.Ne=new tp(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.qe=new Lb(this),this.Ut=new Sv,this.Ue=function(e,t){return new Rb(e,function(e){return n.referenceDelegate.ps(e)})}(this.Ut),this.R=new hv(t),this.Ke=new kb(this.R)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(){},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getMutationQueue=function(e){var t=this.gs[e.toKey()];return t||(t=new xb(this.Ut,this.referenceDelegate),this.gs[e.toKey()]=t),t},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(e,t,n){var r=this;sp("MemoryPersistence","Starting transaction:",e);var i=new Fb(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(e){return r.referenceDelegate.Ts(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})},e.prototype.Is=function(e,t){return Yy.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(e,t)}}))},e}(),Fb=function(e){function t(t){var n=this;return(n=e.call(this)||this).currentSequenceNumber=t,n}return Object(Gl.c)(t,e),t}(Zy),jb=function(){function e(e){this.persistence=e,this.As=new Nb,this.Rs=null}return e.bs=function(t){return new e(t)},Object.defineProperty(e.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw up()},enumerable:!1,configurable:!0}),e.prototype.addReference=function(e,t,n){return this.As.addReference(n,t),this.vs.delete(n.toString()),Yy.resolve()},e.prototype.removeReference=function(e,t,n){return this.As.removeReference(n,t),this.vs.add(n.toString()),Yy.resolve()},e.prototype.markPotentiallyOrphaned=function(e,t){return this.vs.add(t.toString()),Yy.resolve()},e.prototype.removeTarget=function(e,t){var n=this;this.As.Zn(t.targetId).forEach(function(e){return n.vs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.vs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})},e.prototype.Es=function(){this.Rs=new Set},e.prototype.Ts=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Yy.forEach(this.vs,function(r){var i=jp.fromPath(r);return t.Ps(e,i).next(function(e){e||n.removeEntry(i)})}).next(function(){return t.Rs=null,n.apply(e)})},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.Ps(e,t).next(function(e){e?n.vs.delete(t.toString()):n.vs.add(t.toString())})},e.prototype.ps=function(e){return 0},e.prototype.Ps=function(e,t){var n=this;return Yy.or([function(){return Yy.resolve(n.As.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Is(e,t)}])},e}(),Ub=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e}();function Vb(e,t){return"firestore_clients_"+e+"_"+t}function zb(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}function Hb(e,t){return"firestore_targets_"+e+"_"+t}Ub.UNAUTHENTICATED=new Ub(null),Ub.GOOGLE_CREDENTIALS=new Ub("google-credentials-uid"),Ub.FIRST_PARTY=new Ub("first-party-uid"),Ub.MOCK_USER=new Ub("mock-user");var Gb=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}return e.Vs=function(t,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new rp(o.error.code,o.error.message)),s?new e(t,n,o.state,i):(ap("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),$b=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n}return e.Vs=function(t,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new rp(i.error.code,i.error.message)),o?new e(t,i.state,r):(ap("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),qb=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.Vs=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Bm(),s=0;i&&s<r.activeTargetIds.length;++s)i=Fp(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new e(t,o):(ap("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),Wb=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.Vs=function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(ap("SharedClientState","Failed to parse online state: "+t),null)},e}(),Zb=function(){function e(){this.activeTargetIds=Bm()}return e.prototype.Ds=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.Cs=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.Ss=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),Qb=function(){function e(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new Em(gp),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Vb(this.persistenceKey,this.Ns),this.Ms=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new Zb),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.Ks=function(e){return"firestore_bundle_loaded_"+e}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return e.yt=function(e){return!(!e||!e.localStorage)},e.prototype.start=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t,n,r,i,o,s,a,c,l,u=this;return Object(Gl.d)(this,function(h){switch(h.label){case 0:return[4,this.syncEngine.fn()];case 1:for(e=h.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.Ns&&(i=this.getItem(Vb(this.persistenceKey,r)))&&(o=qb.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),c=0,l=this.$s;c<l.length;c++)this.ks(l[c]);return this.$s=[],this.window.addEventListener("pagehide",function(){return u.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(e){this.setItem(this.Ms,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},e.prototype.isActiveQueryTarget=function(e){var t=!1;return this.Fs.forEach(function(n,r){r.activeTargetIds.has(e)&&(t=!0)}),t},e.prototype.addPendingMutation=function(e){this.zs(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.zs(e,t,n),this.Hs(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Hb(this.persistenceKey,e));if(n){var r=$b.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.Qs(),t},e.prototype.removeLocalQueryTarget=function(e){this.Js.Cs(e),this.Qs()},e.prototype.isLocalQueryTarget=function(e){return this.Js.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(Hb(this.persistenceKey,e))},e.prototype.updateQueryState=function(e,t,n){this.Ys(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach(function(e){r.Hs(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})},e.prototype.setOnlineState=function(e){this.Xs(e)},e.prototype.notifyBundleLoaded=function(){this.Zs()},e.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return sp("SharedClientState","READ",e,t),t},e.prototype.setItem=function(e,t){sp("SharedClientState","SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){sp("SharedClientState","REMOVE",e),this.storage.removeItem(e)},e.prototype.ks=function(e){var t=this,n=e;if(n.storageArea===this.storage){if(sp("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void ap("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(Gl.b)(t,void 0,void 0,function(){var e,t,r,i,o,s;return Object(Gl.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return e=this.ti(n.key),[2,this.ei(e,null)];if(t=this.ni(n.key,n.newValue))return[2,this.ei(t.clientId,t)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(e){var t=tp.o;if(null!=e)try{var n=JSON.parse(e);hp("number"==typeof n),t=n}catch(e){ap("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==tp.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(e.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),e.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},e.prototype.zs=function(e,t,n){var r=new Gb(this.currentUser,e,t,n),i=zb(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())},e.prototype.Hs=function(e){var t=zb(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.Xs=function(e){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:e}))},e.prototype.Ys=function(e,t,n){var r=Hb(this.persistenceKey,e),i=new $b(e,t,n);this.setItem(r,i.Ss())},e.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},e.prototype.ti=function(e){var t=this.Ls.exec(e);return t?t[1]:null},e.prototype.ni=function(e,t){var n=this.ti(e);return qb.Vs(n,t)},e.prototype.si=function(e,t){var n=this.Bs.exec(e),r=Number(n[1]);return Gb.Vs(new Ub(void 0!==n[2]?n[2]:null),r,t)},e.prototype.ri=function(e,t){var n=this.qs.exec(e),r=Number(n[1]);return $b.Vs(r,t)},e.prototype.js=function(e){return Wb.Vs(e)},e.prototype.ii=function(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(e.batchId,e.state,e.error)]:(sp("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},e.prototype.oi=function(e){return this.syncEngine.ai(e.targetId,e.state,e.error)},e.prototype.ei=function(e,t){var n=this,r=t?this.Fs.insert(e,t):this.Fs.remove(e),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach(function(e){i.has(e)||s.push(e)}),i.forEach(function(e){o.has(e)||a.push(e)}),this.syncEngine.hi(s,a).then(function(){n.Fs=r})},e.prototype.Ws=function(e){this.Fs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},e.prototype.Gs=function(e){var t=Bm();return e.forEach(function(e,n){t=t.unionWith(n.activeTargetIds)}),t},e}(),Yb=function(){function e(){this.li=new Zb,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.li.Ds(e),this.fi[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.fi[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.li.Cs(e)},e.prototype.isLocalQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.fi[e]},e.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.start=function(){return this.li=new Zb,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e.prototype.notifyBundleLoaded=function(){},e}(),Kb=function(){function e(){}return e.prototype.di=function(e){},e.prototype.shutdown=function(){},e}(),Jb=function(){function e(){var e=this;this.wi=function(){return e._i()},this.mi=function(){return e.yi()},this.gi=[],this.pi()}return e.prototype.di=function(e){this.gi.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},e.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},e.prototype._i=function(){sp("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(0)},e.prototype.yi=function(){sp("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(1)},e.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),Xb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},e_=function(){function e(e){this.Ei=e.Ei,this.Ti=e.Ti}return e.prototype.Ii=function(e){this.Ai=e},e.prototype.Ri=function(e){this.bi=e},e.prototype.onMessage=function(e){this.vi=e},e.prototype.close=function(){this.Ti()},e.prototype.send=function(e){this.Ei(e)},e.prototype.Pi=function(){this.Ai()},e.prototype.Vi=function(e){this.bi(e)},e.prototype.Si=function(e){this.vi(e)},e}(),t_=function(e){function t(t){var n=this;return(n=e.call(this,t)||this).forceLongPolling=t.forceLongPolling,n.autoDetectLongPolling=t.autoDetectLongPolling,n.useFetchStreams=t.useFetchStreams,n}return Object(Gl.c)(t,e),t.prototype.Fi=function(e,t,n,r){return new Promise(function(i,o){var s=new ep;s.listenOnce(Yf.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Qf.NO_ERROR:var t=s.getResponseJson();sp("Connection","XHR received:",JSON.stringify(t)),i(t);break;case Qf.TIMEOUT:sp("Connection",'RPC "'+e+'" timed out'),o(new rp(np.DEADLINE_EXCEEDED,"Request time out"));break;case Qf.HTTP_ERROR:var n=s.getStatus();if(sp("Connection",'RPC "'+e+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(np).indexOf(t)>=0?t:np.UNKNOWN}(r.status);o(new rp(a,r.message))}else o(new rp(np.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new rp(np.UNAVAILABLE,"Connection failed."));break;default:up()}}finally{sp("Connection",'RPC "'+e+'" completed.')}});var a=JSON.stringify(r);s.send(t,"POST",a,n,15)})},t.prototype.Oi=function(e,t){var n=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new Gf,i=Bh(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Jf({})),this.ki(o.initMessageHeaders,t),Object($l.v)()||Object($l.y)()||Object($l.s)()||Object($l.u)()||Object($l.A)()||Object($l.r)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");sp("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),c=!1,l=!1,u=new e_({Ei:function(e){l?sp("Connection","Not sending because WebChannel is closed:",e):(c||(sp("Connection","Opening WebChannel transport."),a.open(),c=!0),sp("Connection","WebChannel sending:",e),a.send(e))},Ti:function(){return a.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})};return h(a,Xf.EventType.OPEN,function(){l||sp("Connection","WebChannel transport opened.")}),h(a,Xf.EventType.CLOSE,function(){l||(l=!0,sp("Connection","WebChannel transport closed"),u.Vi())}),h(a,Xf.EventType.ERROR,function(e){l||(l=!0,cp("Connection","WebChannel transport errored:",e),u.Vi(new rp(np.UNAVAILABLE,"The operation could not be completed")))}),h(a,Xf.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];hp(!!n);var r=n.error||(null===(t=n[0])||void 0===t?void 0:t.error);if(r){sp("Connection","WebChannel received error:",r);var i=r.status,o=function(e){var t=mm[e];if(void 0!==t)return Cm(t)}(i),s=r.message;void 0===o&&(o=np.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,u.Vi(new rp(o,s)),a.close()}else sp("Connection","WebChannel received:",n),u.Si(n)}}),h(i,Kf.STAT_EVENT,function(e){10===e.stat?sp("Connection","Detected buffering proxy"):11===e.stat&&sp("Connection","Detected no buffering proxy")}),setTimeout(function(){u.Pi()},0),u},t}(function(){function e(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.Di=(e.ssl?"https":"http")+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);sp("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(e,i,o,n).then(function(e){return sp("RestConnection","Received: ",e),e},function(t){throw cp("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},e.prototype.$i=function(e,t,n,r){return this.Ni(e,t,n,r)},e.prototype.ki=function(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])},e.prototype.xi=function(e,t){return this.Di+"/v1/"+t+":"+Xb[e]},e}());function n_(){return"undefined"!=typeof window?window:null}function r_(){return"undefined"!=typeof document?document:null}function i_(e){return new Qm(e,!0)}var o_=function(){function e(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=e,this.timerId=t,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return e.prototype.reset=function(){this.qi=0},e.prototype.Qi=function(){this.qi=this.Bi},e.prototype.ji=function(e){var t=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&sp("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return t.Ki=Date.now(),e()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},e.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},e.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},e.prototype.Wi=function(){return(Math.random()-.5)*this.qi},e}(),s_=function(){function e(e,t,n,r,i,o){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new o_(e,t)}return e.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},e.prototype.er=function(){return 2===this.state},e.prototype.start=function(){3!==this.state?this.auth():this.nr()},e.prototype.stop=function(){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(e){switch(e.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.sr=function(){this.state=0,this.Zi.reset()},e.prototype.ir=function(){var e=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return e.rr()}))},e.prototype.cr=function(e){this.ur(),this.stream.send(e)},e.prototype.rr=function(){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(e){return this.er()?[2,this.close(0)]:[2]})})},e.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},e.prototype.close=function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===np.RESOURCE_EXHAUSTED?(ap(t.toString()),ap("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):t&&t.code===np.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(t)];case 1:return n.sent(),[2]}})})},e.prototype.ar=function(){},e.prototype.auth=function(){var e=this;this.state=1;var t=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(t){e.Yi===n&&e.lr(t)},function(n){t(function(){var t=new rp(np.UNKNOWN,"Fetching auth token failed: "+n.message);return e.dr(t)})})},e.prototype.lr=function(e){var t=this,n=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii(function(){n(function(){return t.state=2,t.listener.Ii()})}),this.stream.Ri(function(e){n(function(){return t.dr(e)})}),this.stream.onMessage(function(e){n(function(){return t.onMessage(e)})})},e.prototype.nr=function(){var e=this;this.state=4,this.Zi.ji(function(){return Object(Gl.b)(e,void 0,void 0,function(){return Object(Gl.d)(this,function(e){return this.state=0,this.start(),[2]})})})},e.prototype.dr=function(e){return sp("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)},e.prototype.hr=function(e){var t=this;return function(n){t.Se.enqueueAndForget(function(){return t.Yi===e?n():(sp("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),a_=function(e){function t(t,n,r,i,o){var s=this;return(s=e.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(Gl.c)(t,e),t.prototype.wr=function(e){return this.Hi.Oi("Listen",e)},t.prototype.onMessage=function(e){this.Zi.reset();var t=function(e,t){var n;if("targetChange"in t){var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:up()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.I?(hp(void 0===t||"string"==typeof t),Tp.fromBase64String(t||"")):(hp(void 0===t||t instanceof Uint8Array),Tp.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=(a=t.targetChange.cause)&&function(e){var t=void 0===e.code?np.UNKNOWN:Cm(e.code);return new rp(t,e.message||"")}(a);n=new zm(r,i,o,s||null)}else if("documentChange"in t){i=ry(e,(r=t.documentChange).document.name),o=Xm(r.document.updateTime);var a=new eg({mapValue:{fields:r.document.fields}}),c=(s=ng.newFoundDocument(i,o,a),r.targetIds||[]);n=new Um(c,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in t)i=ry(e,(r=t.documentDelete).document),o=r.readTime?Xm(r.readTime):bp.min(),a=ng.newNoDocument(i,o),n=new Um([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in t)i=ry(e,(r=t.documentRemove).document),n=new Um([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in t))return up();var l=t.filter;i=new _m(r=l.count||0),n=new Vm(o=l.targetId,i)}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return bp.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?bp.min():t.readTime?Xm(t.readTime):bp.min()}(e);return this.listener._r(t,n)},t.prototype.mr=function(e){var t={};t.database=sy(this.R),t.addTarget=function(e,t){var n,r=t.target;return(n=ag(r)?{documents:dy(e,r)}:{query:fy(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Km(e,t.resumeToken):t.snapshotVersion.compareTo(bp.min())>0&&(n.readTime=Ym(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return up()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);n&&(t.labels=n),this.cr(t)},t.prototype.yr=function(e){var t={};t.database=sy(this.R),t.removeTarget=e,this.cr(t)},t}(s_),c_=function(e){function t(t,n,r,i,o){var s=this;return(s=e.call(this,t,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(Gl.c)(t,e),Object.defineProperty(t.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.ar=function(){this.gr&&this.Er([])},t.prototype.wr=function(e){return this.Hi.Oi("Write",e)},t.prototype.onMessage=function(e){if(hp(!!e.streamToken),this.lastStreamToken=e.streamToken,this.gr){this.Zi.reset();var t=function(e,t){return e&&e.length>0?(hp(void 0!==t),e.map(function(e){return function(e,t){var n=Xm(e.updateTime?e.updateTime:t);return n.isEqual(bp.min())&&(n=Xm(t)),new nm(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=Xm(e.commitTime);return this.listener.Tr(n,t)}return hp(!e.writeResults||0===e.writeResults.length),this.gr=!0,this.listener.Ir()},t.prototype.Ar=function(){var e={};e.database=sy(this.R),this.cr(e)},t.prototype.Er=function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return uy(t.R,e)})};this.cr(n)},t}(s_),l_=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).credentials=t,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(Gl.c)(t,e),t.prototype.br=function(){if(this.Rr)throw new rp(np.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ni=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(e,t,n,i)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===np.UNAUTHENTICATED&&r.credentials.invalidateToken(),e):new rp(np.UNKNOWN,e.toString())})},t.prototype.$i=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(e,t,n,i)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===np.UNAUTHENTICATED&&r.credentials.invalidateToken(),e):new rp(np.UNKNOWN,e.toString())})},t.prototype.terminate=function(){this.Rr=!0},t}(function(){}),u_=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return e.prototype.Sr=function(){var e=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Pr=null,e.Cr("Backend didn't respond within 10 seconds."),e.Dr("Offline"),Promise.resolve()}))},e.prototype.Nr=function(e){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+e.toString()),this.Dr("Offline")))},e.prototype.set=function(e){this.kr(),this.vr=0,"Online"===e&&(this.Vr=!1),this.Dr(e)},e.prototype.Dr=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.Cr=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(ap(t),this.Vr=!1):sp("OnlineStateTracker",t)},e.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},e}(),h_=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(e){n.enqueueAndForget(function(){return Object(Gl.b)(o,void 0,void 0,function(){return Object(Gl.d)(this,function(e){switch(e.label){case 0:return __(this)?(sp("RemoteStore","Restarting streams for network reachability change."),[4,function(e){return Object(Gl.b)(this,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return(t=dp(e)).Or.add(4),[4,f_(t)];case 1:return n.sent(),t.Br.set("Unknown"),t.Or.delete(4),[4,d_(t)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})}),this.Br=new u_(n,r)};function d_(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:if(!__(e))return[3,4];t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function f_(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function p_(e,t){var n=dp(e);n.$r.has(t.targetId)||(n.$r.set(t.targetId,t),b_(n)?v_(n):D_(n).er()&&m_(n,t))}function g_(e,t){var n=dp(e),r=D_(n);n.$r.delete(t),r.er()&&y_(n,t),0===n.$r.size&&(r.er()?r.ir():__(n)&&n.Br.set("Unknown"))}function m_(e,t){e.qr.U(t.targetId),D_(e).mr(t)}function y_(e,t){e.qr.U(t),D_(e).yr(t)}function v_(e){e.qr=new Gm({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),D_(e).start(),e.Br.Sr()}function b_(e){return __(e)&&!D_(e).tr()&&e.$r.size>0}function __(e){return 0===dp(e).Or.size}function w_(e){e.qr=void 0}function C_(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){return e.$r.forEach(function(t,n){m_(e,t)}),[2]})})}function E_(e,t){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(n){return w_(e),b_(e)?(e.Br.Nr(t),v_(e)):e.Br.set("Unknown"),[2]})})}function O_(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o;return Object(Gl.d)(this,function(s){switch(s.label){case 0:if(e.Br.set("Online"),!(t instanceof zm&&2===t.state&&t.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Gl.d)(this,function(s){switch(s.label){case 0:n=t.cause,r=0,i=t.targetIds,s.label=1;case 1:return r<i.length?e.$r.has(o=i[r])?[4,e.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),e.$r.delete(o),e.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(e,t)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),sp("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,S_(e,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof Um?e.qr.X(t):t instanceof Vm?e.qr.rt(t):e.qr.et(t),n.isEqual(bp.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,vb(e.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(e,t){var n=e.qr.ut(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.$r.get(r);i&&e.$r.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.$r.get(t);if(n){e.$r.set(t,n.withResumeToken(Tp.EMPTY_BYTE_STRING,n.snapshotVersion)),y_(e,t);var r=new uv(n.target,t,1,n.sequenceNumber);m_(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return sp("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,S_(e,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function S_(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r=this;return Object(Gl.d)(this,function(i){switch(i.label){case 0:if(!tv(t))throw t;return e.Or.add(1),[4,f_(e)];case 1:return i.sent(),e.Br.set("Offline"),n||(n=function(){return vb(e.localStore)}),e.asyncQueue.enqueueRetryable(function(){return Object(Gl.b)(r,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return sp("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return t.sent(),e.Or.delete(1),[4,d_(e)];case 2:return t.sent(),[2]}})})}),[2]}})})}function P_(e,t){return t().catch(function(n){return S_(e,n,t)})}function I_(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(Gl.d)(this,function(s){switch(s.label){case 0:t=dp(e),n=L_(t),r=t.Fr.length>0?t.Fr[t.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(e){return __(e)&&e.Fr.length<10}(t))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,wb(t.localStore,r)];case 3:return null===(i=s.sent())?(0===t.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(e,t){e.Fr.push(t);var n=L_(e);n.er()&&n.pr&&n.Er(t.mutations)}(t,i),[3,6]);case 4:return o=s.sent(),[4,S_(t,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return T_(t)&&A_(t),[2]}})})}function T_(e){return __(e)&&!L_(e).tr()&&e.Fr.length>0}function A_(e){L_(e).start()}function k_(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){return L_(e).Ar(),[2]})})}function N_(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n,r;return Object(Gl.d)(this,function(i){for(t=L_(e),n=0,r=e.Fr;n<r.length;n++)t.Er(r[n].mutations);return[2]})})}function M_(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return r=e.Fr.shift(),i=lv.from(r,t,n),[4,P_(e,function(){return e.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,I_(e)];case 2:return o.sent(),[2]}})})}function x_(e,t){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(n){switch(n.label){case 0:return t&&L_(e).pr?[4,function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return wm(r=t.code)&&r!==np.ABORTED?(n=e.Fr.shift(),L_(e).sr(),[4,P_(e,function(){return e.remoteSyncer.rejectFailedWrite(n.batchId,t)})]):[3,3];case 1:return i.sent(),[4,I_(e)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return T_(e)&&A_(e),[2]}})})}function R_(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return n=dp(e),t?(n.Or.delete(2),[4,d_(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Or.add(2),[4,f_(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function D_(e){var t=this;return e.Ur||(e.Ur=function(e,t,n){var r=dp(e);return r.br(),new a_(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:C_.bind(null,e),Ri:E_.bind(null,e),_r:O_.bind(null,e)}),e.Mr.push(function(n){return Object(Gl.b)(t,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return n?(e.Ur.sr(),b_(e)?v_(e):e.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Ur.stop()];case 2:t.sent(),w_(e),t.label=3;case 3:return[2]}})})})),e.Ur}function L_(e){var t=this;return e.Kr||(e.Kr=function(e,t,n){var r=dp(e);return r.br(),new c_(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:k_.bind(null,e),Ri:x_.bind(null,e),Ir:N_.bind(null,e),Tr:M_.bind(null,e)}),e.Mr.push(function(n){return Object(Gl.b)(t,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return n?(e.Kr.sr(),[4,I_(e)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,e.Kr.stop()];case 3:t.sent(),e.Fr.length>0&&(sp("RemoteStore","Stopping write stream with "+e.Fr.length+" pending writes"),e.Fr=[]),t.label=4;case 4:return[2]}})})})),e.Kr}var B_=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Qy,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return e.createAndSchedule=function(t,n,r,i,o){var s=new e(t,n,Date.now()+r,i,o);return s.start(r),s},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new rp(np.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}();function F_(e,t){if(ap("AsyncQueue",t+": "+e),tv(e))return new rp(np.UNAVAILABLE,t+": "+e);throw e}var j_=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||jp.comparator(t.key,n.key)}:function(e,t){return jp.comparator(e.key,t.key)},this.keyedMap=Nm(),this.sortedSet=new Em(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),U_=function(){function e(){this.Qr=new Em(jp.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.Qr.get(t);n?0!==e.type&&3===n.type?this.Qr=this.Qr.insert(t,e):3===e.type&&1!==n.type?this.Qr=this.Qr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Qr=this.Qr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Qr=this.Qr.remove(t):1===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):up():this.Qr=this.Qr.insert(t,e)},e.prototype.jr=function(){var e=[];return this.Qr.inorderTraversal(function(t,n){e.push(n)}),e},e}(),V_=function(){function e(e,t,n,r,i,o,s,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach(function(e){o.push({type:0,doc:e})}),new e(t,n,j_.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Rg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),z_=function(){this.Wr=void 0,this.listeners=[]},H_=function(){this.queries=new Yv(function(e){return Dg(e)},Rg),this.onlineState="Unknown",this.Gr=new Set};function G_(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,c;return Object(Gl.d)(this,function(l){switch(l.label){case 0:if(n=dp(e),i=!1,(o=n.queries.get(r=t.query))||(i=!0,o=new z_),!i)return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=l.sent(),[3,4];case 3:return a=l.sent(),c=F_(a,"Initialization of query '"+Lg(t.query)+"' failed"),[2,void t.onError(c)];case 4:return n.queries.set(r,o),o.listeners.push(t),t.zr(n.onlineState),o.Wr&&t.Hr(o.Wr)&&Z_(n),[2]}})})}function $_(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Gl.d)(this,function(a){return n=dp(e),i=!1,(o=n.queries.get(r=t.query))&&(s=o.listeners.indexOf(t))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function q_(e,t){for(var n=dp(e),r=!1,i=0,o=t;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var c=0,l=a.listeners;c<l.length;c++)l[c].Hr(s)&&(r=!0);a.Wr=s}}r&&Z_(n)}function W_(e,t,n){var r=dp(e),i=r.queries.get(t);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(t)}function Z_(e){e.Gr.forEach(function(e){e.next()})}var Q_=function(){function e(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return e.prototype.Hr=function(e){if(!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new V_(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),o=!0):this.eo(e,this.onlineState)&&(this.no(e),o=!0),this.Xr=e,o},e.prototype.onError=function(e){this.Jr.error(e)},e.prototype.zr=function(e){this.onlineState=e;var t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t},e.prototype.eo=function(e,t){return!e.fromCache||!(this.options.so&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)},e.prototype.Zr=function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges},e.prototype.no=function(e){e=V_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)},e}(),Y_=function(){function e(e,t){this.payload=e,this.byteLength=t}return e.prototype.io=function(){return"metadata"in this.payload},e}(),K_=function(){function e(e){this.R=e}return e.prototype.qn=function(e){return ry(this.R,e)},e.prototype.Un=function(e){return e.metadata.exists?ly(this.R,e.document,!1):ng.newNoDocument(this.qn(e.metadata.name),this.Kn(e.metadata.readTime))},e.prototype.Kn=function(e){return Xm(e)},e}();!function(){function e(e,t,n){this.ro=e,this.localStore=t,this.R=n,this.queries=[],this.documents=[],this.progress=function(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(e)}e.prototype.oo=function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null},e.prototype.co=function(e){for(var t=new Map,n=new K_(this.R),r=0,i=e;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,c=o.metadata.queries;a<c.length;a++){var l=c[a],u=(t.get(l)||Dm()).add(s);t.set(l,u)}}return t},e.prototype.complete=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t,n,r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return[4,Tb(this.localStore,new K_(this.R),this.documents,this.ro.id)];case 1:e=o.sent(),t=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,Ab(this.localStore,i=r[n],t.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new ub(Object.assign({},this.progress),e))]}})})}}();var J_=function(e){this.key=e},X_=function(e){this.key=e},ew=function(){function e(e,t){this.query=e,this.uo=t,this.ao=null,this.current=!1,this.ho=Dm(),this.mutatedKeys=Dm(),this.lo=Fg(e),this.fo=new j_(this.lo)}return Object.defineProperty(e.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),e.prototype._o=function(e,t){var n=this,r=t?t.mo:new U_,i=t?t.fo:this.fo,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=Pg(this.query)&&i.size===this.query.limit?i.last():null,l=Ig(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var u=i.get(e),h=Bg(n.query,t)?t:null,d=!!u&&n.mutatedKeys.has(u.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;u&&h?u.data.isEqual(h.data)?d!==f&&(r.track({type:3,doc:h}),p=!0):n.yo(u,h)||(r.track({type:2,doc:h}),p=!0,(c&&n.lo(h,c)>0||l&&n.lo(h,l)<0)&&(a=!0)):!u&&h?(r.track({type:0,doc:h}),p=!0):u&&!h&&(r.track({type:1,doc:u}),p=!0,(c||l)&&(a=!0)),p&&(h?(s=s.add(h),o=f?o.add(e):o.delete(e)):(s=s.delete(e),o=o.delete(e)))}),Pg(this.query)||Ig(this.query))for(;s.size>this.query.limit;){var u=Pg(this.query)?s.last():s.first();s=s.delete(u.key),o=o.delete(u.key),r.track({type:1,doc:u})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},e.prototype.yo=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this,i=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;var o=e.mo.jr();o.sort(function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return up()}};return n(e)-n(t)}(e.type,t.type)||r.lo(e.doc,t.doc)}),this.po(n);var s=t?this.Eo():[],a=0===this.ho.size&&this.current?1:0,c=a!==this.ao;return this.ao=a,0!==o.length||c?{snapshot:new V_(this.query,e.fo,i,o,e.mutatedKeys,0===a,c,!1),To:s}:{To:s}},e.prototype.zr=function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new U_,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},e.prototype.Io=function(e){return!this.uo.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations},e.prototype.po=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.uo=t.uo.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.uo=t.uo.delete(e)}),this.current=e.current)},e.prototype.Eo=function(){var e=this;if(!this.current)return[];var t=this.ho;this.ho=Dm(),this.fo.forEach(function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))});var n=[];return t.forEach(function(t){e.ho.has(t)||n.push(new X_(t))}),this.ho.forEach(function(e){t.has(e)||n.push(new J_(e))}),n},e.prototype.Ao=function(e){this.uo=e.Bn,this.ho=Dm();var t=this._o(e.documents);return this.applyChanges(t,!0)},e.prototype.Ro=function(){return V_.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},e}(),tw=function(e,t,n){this.query=e,this.targetId=t,this.view=n},nw=function(e){this.key=e,this.bo=!1},rw=function(){function e(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Yv(function(e){return Dg(e)},Rg),this.Vo=new Map,this.So=new Set,this.Do=new Em(jp.comparator),this.Co=new Map,this.No=new Nb,this.xo={},this.ko=new Map,this.Fo=Fv.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),e}();function iw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:return n=xw(e),(i=n.Po.get(t))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,Cb(n.localStore,Mg(t))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,ow(n,t,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&p_(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function ow(e,t,n,r){return Object(Gl.b)(this,void 0,void 0,function(){var i,o,s,a,c,l;return Object(Gl.d)(this,function(u){switch(u.label){case 0:return e.Oo=function(t,n,r){return function(e,t,n,r){return Object(Gl.b)(this,void 0,void 0,function(){var i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:return(i=t.view._o(n)).Nn?[4,Ob(e.localStore,t.query,!1).then(function(e){return t.view._o(e.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(t.targetId),s=t.view.applyChanges(i,e.isPrimaryClient,o),[2,(vw(e,t.targetId,s.To),s.snapshot)]}})})}(e,t,n,r)},[4,Ob(e.localStore,t,!0)];case 1:return i=u.sent(),o=new ew(t,i.Bn),s=o._o(i.documents),a=jm.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=o.applyChanges(s,e.isPrimaryClient,a),vw(e,n,c.To),l=new tw(t,n,o),[2,(e.Po.set(t,l),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),c.snapshot)]}})})}function sw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return n=dp(e),r=n.Po.get(t),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(e){return!Rg(e,t)})),void n.Po.delete(t))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Eb(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),g_(n.remoteStore,r.targetId),mw(n,r.targetId)}).catch(Hv)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return mw(n,r.targetId),[4,Eb(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function aw(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:r=Rw(e),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(e,t){var n,r=dp(e),i=vp.now(),o=t.reduce(function(e,t){return e.add(t.key)},Dm());return r.persistence.runTransaction("Locally write mutations","readwrite",function(e){return r.Mn.pn(e,o).next(function(o){n=o;for(var s=[],a=0,c=t;a<c.length;a++){var l=c[a],u=cm(l,n.get(l.key));null!=u&&s.push(new dm(l.key,u,tg(u.value.mapValue),rm.exists(!0)))}return r._n.addMutationBatch(e,i,s,t)})}).then(function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}})}(r.localStore,t)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.xo[e.currentUser.toKey()];r||(r=new Em(gp)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,i.batchId,n),[4,ww(r,i.changes)];case 3:return a.sent(),[4,I_(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=F_(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function cw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r;return Object(Gl.d)(this,function(i){switch(i.label){case 0:n=dp(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,bb(n.localStore,t)];case 2:return r=i.sent(),t.targetChanges.forEach(function(e,t){var r=n.Co.get(t);r&&(hp(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.bo=!0:e.modifiedDocuments.size>0?hp(r.bo):e.removedDocuments.size>0&&(hp(r.bo),r.bo=!1))}),[4,ww(n,r,t)];case 3:return i.sent(),[3,6];case 4:return[4,Hv(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function lw(e,t,n){var r=dp(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(e,n){var r=n.view.zr(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=dp(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(t)&&(r=!0)}),r&&Z_(n)}(r.eventManager,t),i.length&&r.vo._r(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function uw(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o,s,a,c;return Object(Gl.d)(this,function(l){switch(l.label){case 0:return(r=dp(e)).sharedClientState.updateQueryState(t,"rejected",n),i=r.Co.get(t),(o=i&&i.key)?(s=(s=new Em(jp.comparator)).insert(o,ng.newNoDocument(o,bp.min())),a=Dm().add(o),c=new Fm(bp.min(),new Map,new Pm(gp),s,a),[4,cw(r,c)]):[3,2];case 1:return l.sent(),r.Do=r.Do.remove(o),r.Co.delete(t),_w(r),[3,4];case 2:return[4,Eb(r.localStore,t,!1).then(function(){return mw(r,t,n)}).catch(Hv)];case 3:l.sent(),l.label=4;case 4:return[2]}})})}function hw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:n=dp(e),r=t.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,yb(n.localStore,t)];case 2:return i=o.sent(),gw(n,r,null),pw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,ww(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Hv(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function dw(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:r=dp(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(e,t){var n=dp(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n._n.lookupMutationBatch(e,t).next(function(t){return hp(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)}).next(function(){return n._n.performConsistencyCheck(e)}).next(function(){return n.Mn.pn(e,r)})})}(r.localStore,t)];case 2:return i=o.sent(),gw(r,t,n),pw(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),[4,ww(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Hv(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function fw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:__((n=dp(e)).remoteStore)||sp("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(e){var t=dp(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t._n.getHighestUnacknowledgedBatchId(e)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void t.resolve()]:((i=n.ko.get(r)||[]).push(t),n.ko.set(r,i),[3,4]);case 3:return o=a.sent(),s=F_(o,"Initialization of waitForPendingWrites() operation failed"),t.reject(s),[3,4];case 4:return[2]}})})}function pw(e,t){(e.ko.get(t)||[]).forEach(function(e){e.resolve()}),e.ko.delete(t)}function gw(e,t,n){var r=dp(e),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function mw(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(t){e.No.containsKey(t)||yw(e,t)})}function yw(e,t){e.So.delete(t.path.canonicalString());var n=e.Do.get(t);null!==n&&(g_(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),_w(e))}function vw(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof J_?(e.No.addReference(o.key,t),bw(e,o)):o instanceof X_?(sp("SyncEngine","Document no longer in limbo: "+o.key),e.No.removeReference(o.key,t),e.No.containsKey(o.key)||yw(e,o.key)):up()}}function bw(e,t){var n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(sp("SyncEngine","New document in limbo: "+n),e.So.add(r),_w(e))}function _w(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){var t=e.So.values().next().value;e.So.delete(t);var n=new jp(Op.fromString(t)),r=e.Fo.next();e.Co.set(r,new nw(n)),e.Do=e.Do.insert(n,r),p_(e.remoteStore,new uv(Mg(Sg(n.path)),r,2,tp.o))}}function ww(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:return r=dp(e),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(e,a){s.push(r.Oo(a,t,n).then(function(e){if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);var t=db.Pn(a.targetId,e);o.push(t)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,c,l;return Object(Gl.d)(this,function(u){switch(u.label){case 0:n=dp(e),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Yy.forEach(t,function(t){return Yy.forEach(t.bn,function(r){return n.persistence.referenceDelegate.addReference(e,t.targetId,r)}).next(function(){return Yy.forEach(t.vn,function(r){return n.persistence.referenceDelegate.removeReference(e,t.targetId,r)})})})})];case 2:return u.sent(),[3,4];case 3:if(!tv(r=u.sent()))throw r;return sp("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=t;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(c=n.kn.get(a),l=c.withLastLimboFreeSnapshotVersion(c.snapshotVersion),n.kn=n.kn.insert(a,l));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function Cw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return(n=dp(e)).currentUser.isEqual(t)?[3,3]:(sp("SyncEngine","User change. New user:",t.toKey()),[4,mb(n.localStore,t)]);case 1:return r=i.sent(),n.currentUser=t,function(e,t){e.ko.forEach(function(e){e.forEach(function(e){e.reject(new rp(np.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ko.clear()}(n),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),[4,ww(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Ew(e,t){var n=dp(e),r=n.Co.get(t);if(r&&r.bo)return Dm().add(r.key);var i=Dm(),o=n.Vo.get(t);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var c=n.Po.get(a[s]);i=i.unionWith(c.view.wo)}return i}function Ow(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return[4,Ob((n=dp(e)).localStore,t.query,!0)];case 1:return r=o.sent(),i=t.view.Ao(r),[2,(n.isPrimaryClient&&vw(n,t.targetId,i.To),i)]}})})}function Sw(e){return Object(Gl.b)(this,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){return[2,Pb((t=dp(e)).localStore).then(function(e){return ww(t,e)})]})})}function Pw(e,t,n,r){return Object(Gl.b)(this,void 0,void 0,function(){var i,o;return Object(Gl.d)(this,function(s){switch(s.label){case 0:return[4,function(e,t){var n=dp(e),r=dp(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return r.jt(e,t).next(function(t){return t?n.Mn.pn(e,t):Yy.resolve(null)})})}((i=dp(e)).localStore,t)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,I_(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(gw(i,t,r||null),pw(i,t),function(e,t){dp(dp(e)._n).Gt(t)}(i.localStore,t)):up(),s.label=4;case 4:return[4,ww(i,o)];case 5:return s.sent(),[3,7];case 6:sp("SyncEngine","Cannot apply mutation batch with id: "+t),s.label=7;case 7:return[2]}})})}function Iw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,c;return Object(Gl.d)(this,function(l){switch(l.label){case 0:return xw(n=dp(e)),Rw(n),!0!==t||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Tw(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,R_(n.remoteStore,!0)];case 2:for(l.sent(),o=0,s=i;o<s.length;o++)p_(n.remoteStore,s[o]);return[3,7];case 3:return!1!==t||!1===n.$o?[3,7]:(a=[],c=Promise.resolve(),n.Vo.forEach(function(e,t){n.sharedClientState.isLocalQueryTarget(t)?a.push(t):c=c.then(function(){return mw(n,t),Eb(n.localStore,t,!0)}),g_(n.remoteStore,t)}),[4,c]);case 4:return l.sent(),[4,Tw(n,a)];case 5:return l.sent(),function(e){var t=dp(e);t.Co.forEach(function(e,n){g_(t.remoteStore,n)}),t.No.ts(),t.Co=new Map,t.Do=new Em(jp.comparator)}(n),n.$o=!1,[4,R_(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}})})}function Tw(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,c,l,u,h,d,f,p;return Object(Gl.d)(this,function(g){switch(g.label){case 0:n=dp(e),r=[],i=[],o=0,s=t,g.label=1;case 1:return o<s.length?(c=void 0,(l=n.Vo.get(a=s[o]))&&0!==l.length?[4,Cb(n.localStore,Mg(l[0]))]:[3,7]):[3,13];case 2:c=g.sent(),u=0,h=l,g.label=3;case 3:return u<h.length?(d=n.Po.get(h[u]),[4,Ow(n,d)]):[3,6];case 4:(f=g.sent()).snapshot&&i.push(f.snapshot),g.label=5;case 5:return u++,[3,3];case 6:return[3,11];case 7:return[4,Sb(n.localStore,a)];case 8:return p=g.sent(),[4,Cb(n.localStore,p)];case 9:return c=g.sent(),[4,ow(n,Aw(p),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(c),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function Aw(e){return Og(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function kw(e){var t=dp(e);return dp(dp(t.localStore).persistence).fn()}function Nw(e,t,n,r){return Object(Gl.b)(this,void 0,void 0,function(){var i,o,s;return Object(Gl.d)(this,function(a){switch(a.label){case 0:return(i=dp(e)).$o?(sp("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Pb(i.localStore)];case 3:return o=a.sent(),s=Fm.createSynthesizedRemoteEventForCurrentChange(t,"current"===n),[4,ww(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Eb(i.localStore,t,!0)];case 6:return a.sent(),mw(i,t,r),[3,8];case 7:up(),a.label=8;case 8:return[2]}})})}function Mw(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o,s,a,c,l,u,h;return Object(Gl.d)(this,function(d){switch(d.label){case 0:if(!(r=xw(e)).$o)return[3,10];i=0,o=t,d.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(sp("SyncEngine","Adding an already active target "+s),[3,5]):[4,Sb(r.localStore,s)]:[3,6];case 2:return a=d.sent(),[4,Cb(r.localStore,a)];case 3:return c=d.sent(),[4,ow(r,Aw(a),c.targetId,!1)];case 4:d.sent(),p_(r.remoteStore,c),d.label=5;case 5:return i++,[3,1];case 6:l=function(e){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return r.Vo.has(e)?[4,Eb(r.localStore,e,!1).then(function(){g_(r.remoteStore,e),mw(r,e)}).catch(Hv)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,h=n,d.label=7;case 7:return u<h.length?[5,l(h[u])]:[3,10];case 8:d.sent(),d.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}function xw(e){var t=dp(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=cw.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ew.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=uw.bind(null,t),t.vo._r=q_.bind(null,t.eventManager),t.vo.Mo=W_.bind(null,t.eventManager),t}function Rw(e){var t=dp(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=hw.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=dw.bind(null,t),t}var Dw=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return this.R=i_(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Ko(e),[2]}})})},e.prototype.Uo=function(e){return null},e.prototype.Ko=function(e){return gb(this.persistence,new fb,e.initialUser,this.R)},e.prototype.qo=function(e){return new Bb(jb.bs,this.R)},e.prototype.Bo=function(e){return new Yb},e.prototype.terminate=function(){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}})})},e}(),Lw=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).Qo=t,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Gl.c)(t,e),t.prototype.initialize=function(t){return Object(Gl.b)(this,void 0,void 0,function(){var n=this;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return r.sent(),[4,Ib(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,t)];case 3:return r.sent(),[4,Rw(this.Qo.syncEngine)];case 4:return r.sent(),[4,I_(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He(function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()})];case 6:return r.sent(),[2]}})})},t.prototype.Ko=function(e){return gb(this.persistence,new fb,e.initialUser,this.R)},t.prototype.Uo=function(e){return new qv(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)},t.prototype.qo=function(e){var t=lb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?kv.withCacheSize(this.cacheSizeBytes):kv.DEFAULT;return new sb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,n_(),r_(),this.R,this.sharedClientState,!!this.forceOwnership)},t.prototype.Bo=function(e){return new Yb},t}(Dw),Bw=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n,!1)||this).Qo=t,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Gl.c)(t,e),t.prototype.initialize=function(t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r=this;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Qb?(this.sharedClientState.syncEngine={ui:Pw.bind(null,n),ai:Nw.bind(null,n),hi:Mw.bind(null,n),fn:kw.bind(null,n),ci:Sw.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(e){return Object(Gl.b)(r,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return[4,Iw(this.Qo.syncEngine,e)];case 1:return t.sent(),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},t.prototype.Bo=function(e){var t=n_();if(!Qb.yt(t))throw new rp(np.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=lb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Qb(t,e.asyncQueue,n,e.clientId,e.initialUser)},t}(Lw),Fw=function(){function e(){}return e.prototype.initialize=function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n=this;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return lw(n.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Cw.bind(null,this.syncEngine),[4,R_(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype.createEventManager=function(e){return new H_},e.prototype.createDatastore=function(e){var t=i_(e.databaseInfo.databaseId),n=new t_(e.databaseInfo);return function(e,t,n){return new l_(e,t,n)}(e.credentials,n,t)},e.prototype.createRemoteStore=function(e){var t,n,r,i,o,s=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return lw(s.syncEngine,e,0)},o=Jb.yt()?new Jb:new Kb,new h_(t,n,r,i,o)},e.prototype.createSyncEngine=function(e,t){return function(e,t,n,r,i,o,s){var a=new rw(e,t,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)},e.prototype.terminate=function(){return function(e){return Object(Gl.b)(this,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return t=dp(e),sp("RemoteStore","RemoteStore shutting down."),t.Or.add(5),[4,f_(t)];case 1:return n.sent(),t.Lr.shutdown(),t.Br.set("Unknown"),[2]}})})}(this.remoteStore)},e}(),jw=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.observer.next&&this.jo(this.observer.next,e)},e.prototype.error=function(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},e.prototype.Wo=function(){this.muted=!0},e.prototype.jo=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},e}(),Uw=(function(){function e(e,t){var n=this;this.Go=e,this.R=t,this.metadata=new Qy,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(e){e&&e.io()?n.metadata.resolve(e.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==e?void 0:e.payload)))},function(e){return n.metadata.reject(e)})}e.prototype.close=function(){return this.Go.cancel()},e.prototype.getMetadata=function(){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(e){return[2,this.metadata.promise]})})},e.prototype.Lo=function(){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(e){switch(e.label){case 0:return[4,this.getMetadata()];case 1:return[2,(e.sent(),this.Ho())]}})})},e.prototype.Ho=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t,n,r;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(e=i.sent())?[2,null]:(t=this.zo.decode(e),n=Number(t),isNaN(n)&&this.Yo("length string ("+t+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Y_(JSON.parse(r),e.length+n)]}})})},e.prototype.Zo=function(){return this.buffer.findIndex(function(e){return e==="{".charCodeAt(0)})},e.prototype.Jo=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),t=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),t)])}})})},e.prototype.Xo=function(e){return Object(Gl.b)(this,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<e?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return t=this.zo.decode(this.buffer.slice(0,e)),[2,(this.buffer=this.buffer.slice(e),t)]}})})},e.prototype.Yo=function(e){throw this.Go.cancel(),new Error("Invalid bundle format: "+e)},e.prototype.tc=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(e=n.sent()).done||((t=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t),[2,e.done]}})})}}(),function(){function e(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n=this;return Object(Gl.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new rp(np.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(Gl.d)(this,function(c){switch(c.label){case 0:return n=dp(e),r=sy(n.R)+"/documents",i={documents:t.map(function(e){return ny(n.R,e)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=c.sent(),s=new Map,o.forEach(function(e){var t=function(e,t){return"found"in t?function(e,t){hp(!!t.found);var n=ry(e,t.found.name),r=Xm(t.found.updateTime),i=new eg({mapValue:{fields:t.found.fields}});return ng.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){hp(!!t.missing),hp(!!t.readTime);var n=ry(e,t.missing),r=Xm(t.readTime);return ng.newNoDocument(n,r)}(e,t):up()}(n.R,e);s.set(t.key.toString(),t)}),a=[],[2,(t.forEach(function(e){var t=s.get(e.toString());hp(!!t),a.push(t)}),a)]}})})}(this.datastore,e)];case 1:return[2,((t=r.sent()).forEach(function(e){return n.recordVersion(e)}),t)]}})})},e.prototype.set=function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.update=function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())},e.prototype.delete=function(e){this.write(new vm(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.commit=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t=this;return Object(Gl.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(e,n){var r=jp.fromPath(n);t.mutations.push(new bm(r,t.precondition(r)))}),[4,function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return n=dp(e),r=sy(n.R)+"/documents",i={writes:t.map(function(e){return uy(n.R,e)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},e.prototype.recordVersion=function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw up();t=bp.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new rp(np.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?rm.updateTime(t):rm.none()},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(bp.min()))throw new rp(np.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rm.updateTime(t)}return rm.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations.push(e)},e.prototype.ensureCommitNotCalled=function(){},e}()),Vw=function(){function e(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new o_(this.asyncQueue,"transaction_retry")}return e.prototype.run=function(){this.ec-=1,this.nc()},e.prototype.nc=function(){var e=this;this.Zi.ji(function(){return Object(Gl.b)(e,void 0,void 0,function(){var e,t,n=this;return Object(Gl.d)(this,function(r){return e=new Uw(this.datastore),(t=this.sc(e))&&t.then(function(t){n.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){n.deferred.resolve(t)}).catch(function(e){n.ic(e)})})}).catch(function(e){n.ic(e)}),[2]})})})},e.prototype.sc=function(e){try{var t=this.updateFunction(e);return!Lp(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},e.prototype.ic=function(e){var t=this;this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return t.nc(),Promise.resolve()})):this.deferred.reject(e)},e.prototype.rc=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!wm(t)}return!1},e}(),zw=function(){function e(e,t,n){var r=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=Ub.UNAUTHENTICATED,this.clientId=pp.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(t,function(e){return Object(Gl.b)(r,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return sp("FirestoreClient","Received user=",e.uid),[4,this.credentialListener(e)];case 1:return t.sent(),this.user=e,[2]}})})})}return e.prototype.getConfiguration=function(){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(e){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},e.prototype.setCredentialChangeListener=function(e){this.credentialListener=e},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new rp(np.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Qy;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Gl.b)(e,void 0,void 0,function(){var e,n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),t.resolve(),[3,6];case 5:return e=r.sent(),n=F_(e,"Failed to shutdown persistence"),t.reject(n),[3,6];case 6:return[2]}})})}),t.promise},e}();function Hw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return e.asyncQueue.verifyOperationInProgress(),sp("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=o.sent(),[4,t.initialize(n)];case 2:return o.sent(),r=n.initialUser,e.setCredentialChangeListener(function(e){return Object(Gl.b)(i,void 0,void 0,function(){return Object(Gl.d)(this,function(n){switch(n.label){case 0:return r.isEqual(e)?[3,2]:[4,mb(t.localStore,e)];case 1:n.sent(),r=e,n.label=2;case 2:return[2]}})})}),t.persistence.setDatabaseDeletedListener(function(){return e.terminate()}),e.offlineComponents=t,[2]}})})}function Gw(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return e.asyncQueue.verifyOperationInProgress(),[4,$w(e)];case 1:return n=i.sent(),sp("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=i.sent(),[4,t.initialize(n,r)];case 3:return i.sent(),e.setCredentialChangeListener(function(e){return function(e,t){return Object(Gl.b)(this,void 0,void 0,function(){var n,r;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return(n=dp(e)).asyncQueue.verifyOperationInProgress(),sp("RemoteStore","RemoteStore received new credentials"),r=__(n),n.Or.add(3),[4,f_(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(t)];case 2:return i.sent(),n.Or.delete(3),[4,d_(n)];case 3:return i.sent(),[2]}})})}(t.remoteStore,e)}),e.onlineComponents=t,[2]}})})}function $w(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(sp("FirestoreClient","Using default OfflineComponentProvider"),[4,Hw(e,new Dw)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function qw(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(sp("FirestoreClient","Using default OnlineComponentProvider"),[4,Gw(e,new Fw)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function Ww(e){return $w(e).then(function(e){return e.persistence})}function Zw(e){return $w(e).then(function(e){return e.localStore})}function Qw(e){return qw(e).then(function(e){return e.remoteStore})}function Yw(e){return qw(e).then(function(e){return e.syncEngine})}function Kw(e){return Object(Gl.b)(this,void 0,void 0,function(){var t,n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return[4,qw(e)];case 1:return t=r.sent(),[2,((n=t.eventManager).onListen=iw.bind(null,t.syncEngine),n.onUnlisten=sw.bind(null,t.syncEngine),n)]}})})}function Jw(e,t,n){var r=this;void 0===n&&(n={});var i=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(r,void 0,void 0,function(){var r;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new jw({next:function(o){t.enqueueAndForget(function(){return $_(e,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new rp(np.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new rp(np.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(e){return i.reject(e)}}),s=new Q_(Sg(n.path),o,{includeMetadataChanges:!0,so:!0});return G_(e,s)},[4,Kw(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}})})}),i.promise}function Xw(e,t,n){var r=this;void 0===n&&(n={});var i=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(r,void 0,void 0,function(){var r;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new jw({next:function(n){t.enqueueAndForget(function(){return $_(e,s)}),n.fromCache&&"server"===r.source?i.reject(new rp(np.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),s=new Q_(n,o,{includeMetadataChanges:!0,so:!0});return G_(e,s)},[4,Kw(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}})})}),i.promise}var eC=function(e,t,n,r,i,o,s,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},tC=function(){function e(e,t){this.projectId=e,this.database=t||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),nC=new Map,rC=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},iC=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e,t){this.changeListener=t,e.enqueueRetryable(function(){return t(Ub.UNAUTHENTICATED)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),oC=function(){function e(e){this.token=e,this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(this.token)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),sC=function(){function e(e){var t=this;this.currentUser=Ub.UNAUTHENTICATED,this.oc=new Qy,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){t.cc++,t.currentUser=t.ac(),t.oc.resolve(),t.changeListener&&t.asyncQueue.enqueueRetryable(function(){return t.changeListener(t.currentUser)})};var n=function(e){sp("FirebaseCredentialsProvider","Auth detected"),t.auth=e,t.auth.addAuthTokenListener(t.uc)};e.onInit(function(e){return n(e)}),setTimeout(function(){if(!t.auth){var r=e.getImmediate({optional:!0});r?n(r):(sp("FirebaseCredentialsProvider","Auth not yet detected"),t.oc.resolve())}},0)}return e.prototype.getToken=function(){var e=this,t=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.cc!==t?(sp("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(hp("string"==typeof n.accessToken),new rC(n.accessToken,e.currentUser)):null}):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e,t){var n=this;this.asyncQueue=e,this.asyncQueue.enqueueRetryable(function(){return Object(Gl.b)(n,void 0,void 0,function(){return Object(Gl.d)(this,function(e){switch(e.label){case 0:return[4,this.oc.promise];case 1:return e.sent(),[4,t(this.currentUser)];case 2:return e.sent(),this.changeListener=t,[2]}})})})},e.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},e.prototype.ac=function(){var e=this.auth&&this.auth.getUid();return hp(null===e||"string"==typeof e),new Ub(e)},e}(),aC=function(){function e(e,t,n){this.hc=e,this.lc=t,this.fc=n,this.type="FirstParty",this.user=Ub.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.lc},t=this.hc.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.fc&&(e["X-Goog-Iam-Authorization-Token"]=this.fc),e},enumerable:!1,configurable:!0}),e}(),cC=function(){function e(e,t,n){this.hc=e,this.lc=t,this.fc=n}return e.prototype.getToken=function(){return Promise.resolve(new aC(this.hc,this.lc,this.fc))},e.prototype.setChangeListener=function(e,t){e.enqueueRetryable(function(){return t(Ub.FIRST_PARTY)})},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function lC(e,t,n){if(!n)throw new rp(np.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function uC(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new rp(np.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function hC(e,t,n,r){if(!0===t&&!0===r)throw new rp(np.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function dC(e){if(!jp.isDocumentKey(e))throw new rp(np.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function fC(e){if(jp.isDocumentKey(e))throw new rp(np.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function pC(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":up()}function gC(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new rp(np.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=pC(e);throw new rp(np.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function mC(e,t){if(t<=0)throw new rp(np.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}var yC=function(){function e(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new rp(np.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new rp(np.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,hC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams},e}(),vC=function(){function e(e,t){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yC({}),this._settingsFrozen=!1,e instanceof tC?(this._databaseId=e,this._credentials=new iC):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new rp(np.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tC(e.options.projectId)}(e),this._credentials=new sC(t))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this._app)throw new rp(np.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),e.prototype._setSettings=function(e){if(this._settingsFrozen)throw new rp(np.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yC(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new iC;switch(e.type){case"gapi":var t=e.client;return hp(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new cC(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new rp(np.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},e.prototype._getSettings=function(){return this._settings},e.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},e.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},e.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},e.prototype._terminate=function(){return(e=nC.get(this))&&(sp("ComponentProvider","Removing Datastore"),nC.delete(this),e.terminate()),Promise.resolve();var e},e}(),bC=function(){function e(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}return Object.defineProperty(e.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new wC(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._key)},e}(),_C=function(){function e(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this._query)},e}(),wC=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,Sg(r))||this)._path=r,i.type="collection",i}return Object(Gl.c)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._path.popLast();return e.isEmpty()?null:new bC(this.firestore,null,new jp(e))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._path)},t}(_C);function CC(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=Object($l.n)(e),lC("collection","path",t),e instanceof vC)return fC(n=Op.fromString.apply(Op,Object(Gl.f)([t],r))),new wC(e,null,n);if(!(e instanceof bC||e instanceof wC))throw new rp(np.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return fC(n=Op.fromString.apply(Op,Object(Gl.f)([e.path],r)).child(Op.fromString(t))),new wC(e.firestore,null,n)}function EC(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=Object($l.n)(e),1===arguments.length&&(t=pp.u()),lC("doc","path",t),e instanceof vC)return dC(n=Op.fromString.apply(Op,Object(Gl.f)([t],r))),new bC(e,null,new jp(n));if(!(e instanceof bC||e instanceof wC))throw new rp(np.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return dC(n=e._path.child(Op.fromString.apply(Op,Object(Gl.f)([t],r)))),new bC(e.firestore,e instanceof wC?e.converter:null,new jp(n))}function OC(e,t){return e=Object($l.n)(e),t=Object($l.n)(t),(e instanceof bC||e instanceof wC)&&(t instanceof bC||t instanceof wC)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function SC(e,t){return e=Object($l.n)(e),t=Object($l.n)(t),e instanceof _C&&t instanceof _C&&e.firestore===t.firestore&&Rg(e._query,t._query)&&e.converter===t.converter}var PC=function(){function e(){var e=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new o_(this,"async_queue_retry"),this.Ic=function(){var t=r_();t&&sp("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=r_();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.Ac(),this.Rc(e)},e.prototype.enterRestrictedMode=function(e){if(!this._c){this._c=!0,this.Ec=e||!1;var t=r_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ic)}},e.prototype.enqueue=function(e){var t=this;if(this.Ac(),this._c)return new Promise(function(){});var n=new Qy;return this.Rc(function(){return t._c&&t.Ec?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})},e.prototype.enqueueRetryable=function(e){var t=this;this.enqueueAndForget(function(){return t.wc.push(e),t.bc()})},e.prototype.bc=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e,t=this;return Object(Gl.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!tv(e=n.sent()))throw e;return sp("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return t.bc()}),n.label=5;case 5:return[2]}})})},e.prototype.Rc=function(e){var t=this,n=this.dc.then(function(){return t.gc=!0,e().catch(function(e){throw t.yc=e,t.gc=!1,ap("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(function(e){return t.gc=!1,e})});return this.dc=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.Ac(),this.Tc.indexOf(e)>-1&&(t=0);var i=B_.createAndSchedule(this,e,t,n,function(e){return r.vc(e)});return this.mc.push(i),i},e.prototype.Ac=function(){this.yc&&up()},e.prototype.verifyOperationInProgress=function(){},e.prototype.Pc=function(){return Object(Gl.b)(this,void 0,void 0,function(){var e;return Object(Gl.d)(this,function(t){switch(t.label){case 0:return[4,e=this.dc];case 1:t.sent(),t.label=2;case 2:if(e!==this.dc)return[3,0];t.label=3;case 3:return[2]}})})},e.prototype.Vc=function(e){for(var t=0,n=this.mc;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.Sc=function(e){var t=this;return this.Pc().then(function(){t.mc.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var n=0,r=t.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==e&&i.timerId===e)break}return t.Pc()})},e.prototype.Dc=function(e){this.Tc.push(e)},e.prototype.vc=function(e){var t=this.mc.indexOf(e);this.mc.splice(t,1)},e}();function IC(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}!function(){function e(){this._progressObserver={},this._taskCompletionResolver=new Qy,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}e.prototype.onProgress=function(e,t,n){this._progressObserver={next:e,error:t,complete:n}},e.prototype.catch=function(e){return this._taskCompletionResolver.promise.catch(e)},e.prototype.then=function(e,t){return this._taskCompletionResolver.promise.then(e,t)},e.prototype._completeWith=function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)},e.prototype._failWith=function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)},e.prototype._updateProgress=function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}();var TC=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).type="firestore",r._queue=new PC,r._persistenceKey="name"in t?t.name:"[DEFAULT]",r}return Object(Gl.c)(t,e),t.prototype._terminate=function(){return this._firestoreClient||kC(this),this._firestoreClient.terminate()},t}(vC);function AC(e){return e._firestoreClient||kC(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function kC(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new eC(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new zw(e._credentials,e._queue,r)}function NC(e,t,n){var r=this,i=new Qy;return e.asyncQueue.enqueue(function(){return Object(Gl.b)(r,void 0,void 0,function(){var r;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Hw(e,n)];case 1:return o.sent(),[4,Gw(e,t)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(e){return"FirebaseError"===e.name?e.code===np.FAILED_PRECONDITION||e.code===np.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function MC(e){if(e._initialized||e._terminated)throw new rp(np.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var xC=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;++n)if(0===e[n].length)throw new rp(np.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pp(e)}return e.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},e}(),RC=function(){function e(e){this._byteString=e}return e.fromBase64String=function(t){try{return new e(Tp.fromBase64String(t))}catch(t){throw new rp(np.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},e.fromUint8Array=function(t){return new e(Tp.fromUint8Array(t))},e.prototype.toBase64=function(){return this._byteString.toBase64()},e.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},e}(),DC=function(e){this._methodName=e},LC=function(){function e(e,t){if(!isFinite(e)||e<-90||e>90)throw new rp(np.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new rp(np.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},e.prototype._compareTo=function(e){return gp(this._lat,e._lat)||gp(this._long,e._long)},e}(),BC=/^__.*__$/,FC=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return null!==this.fieldMask?new dm(e,this.data,this.fieldMask,t,this.fieldTransforms):new hm(e,this.data,t,this.fieldTransforms)},e}(),jC=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return new dm(e,this.data,this.fieldMask,t,this.fieldTransforms)},e}();function UC(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw up()}}var VC=function(){function e(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),e.prototype.xc=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},e.prototype.kc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.xc({path:n,Fc:!1});return r.$c(e),r},e.prototype.Oc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.xc({path:n,Fc:!1});return r.Cc(),r},e.prototype.Mc=function(e){return this.xc({path:void 0,Fc:!0})},e.prototype.Lc=function(e){return aE(e,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},e.prototype.Cc=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.$c(this.path.get(e))},e.prototype.$c=function(e){if(0===e.length)throw this.Lc("Document fields must not be empty");if(UC(this.Nc)&&BC.test(e))throw this.Lc('Document fields cannot begin and end with "__"')},e}(),zC=function(){function e(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||i_(e)}return e.prototype.Uc=function(e,t,n,r){return void 0===r&&(r=!1),new VC({Nc:e,methodName:t,qc:n,path:Pp.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},e}();function HC(e){var t=e._freezeSettings(),n=i_(e._databaseId);return new zC(e._databaseId,!!t.ignoreUndefinedProperties,n)}function GC(e,t,n,r,i,o){void 0===o&&(o={});var s=e.Uc(o.merge||o.mergeFields?2:0,t,n,i);rE("Data must be an object, but it was:",s,r);var a,c,l=tE(r,s);if(o.merge)a=new Ip(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){for(var u=[],h=0,d=o.mergeFields;h<d.length;h++){var f=iE(t,d[h],n);if(!s.contains(f))throw new rp(np.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");cE(u,f)||u.push(f)}a=new Ip(u),c=s.fieldTransforms.filter(function(e){return a.covers(e.field)})}else a=null,c=s.fieldTransforms;return new FC(new eg(l),a,c)}var $C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype._toFieldTransform=function(e){if(2!==e.Nc)throw e.Lc(1===e.Nc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null},t.prototype.isEqual=function(e){return e instanceof t},t}(DC);function qC(e,t,n){return new VC({Nc:3,qc:t.settings.qc,methodName:e._methodName,Fc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}var WC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype._toFieldTransform=function(e){return new tm(e.path,new Wg)},t.prototype.isEqual=function(e){return e instanceof t},t}(DC),ZC=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Kc=n,r}return Object(Gl.c)(t,e),t.prototype._toFieldTransform=function(e){var t=qC(this,e,!0),n=this.Kc.map(function(e){return eE(e,t)}),r=new Zg(n);return new tm(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(DC),QC=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Kc=n,r}return Object(Gl.c)(t,e),t.prototype._toFieldTransform=function(e){var t=qC(this,e,!0),n=this.Kc.map(function(e){return eE(e,t)}),r=new Yg(n);return new tm(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(DC),YC=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Qc=n,r}return Object(Gl.c)(t,e),t.prototype._toFieldTransform=function(e){var t=new Jg(e.R,zg(e.R,this.Qc));return new tm(e.path,t)},t.prototype.isEqual=function(e){return this===e},t}(DC);function KC(e,t,n,r){var i=e.Uc(1,t,n);rE("Data must be an object, but it was:",i,r);var o=[],s=eg.empty();wp(r,function(e,r){var a=sE(t,e,n);r=Object($l.n)(r);var c=i.Oc(a);if(r instanceof $C)o.push(a);else{var l=eE(r,c);null!=l&&(o.push(a),s.set(a,l))}});var a=new Ip(o);return new jC(s,a,i.fieldTransforms)}function JC(e,t,n,r,i,o){var s=e.Uc(1,t,n),a=[iE(t,r,n)],c=[i];if(o.length%2!=0)throw new rp(np.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var l=0;l<o.length;l+=2)a.push(iE(t,o[l])),c.push(o[l+1]);for(var u=[],h=eg.empty(),d=a.length-1;d>=0;--d)if(!cE(u,a[d])){var f=a[d],p=c[d];p=Object($l.n)(p);var g=s.Oc(f);if(p instanceof $C)u.push(f);else{var m=eE(p,g);null!=m&&(u.push(f),h.set(f,m))}}var y=new Ip(u);return new jC(h,y,s.fieldTransforms)}function XC(e,t,n,r){return void 0===r&&(r=!1),eE(n,e.Uc(r?4:3,t))}function eE(e,t){if(nE(e=Object($l.n)(e)))return rE("Unsupported field value:",t,e),tE(e,t);if(e instanceof DC)return function(e,t){if(!UC(t.Nc))throw t.Lc(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.Lc(e._methodName+"() is not currently supported inside arrays");var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.Nc)throw t.Lc("Nested arrays are not supported");return function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var s=eE(o[i],t.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Object($l.n)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return zg(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=vp.fromDate(e);return{timestampValue:Ym(t.R,n)}}if(e instanceof vp)return n=new vp(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)),{timestampValue:Ym(t.R,n)};if(e instanceof LC)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof RC)return{bytesValue:Km(t.R,e._byteString)};if(e instanceof bC){var r=e.firestore._databaseId;if(!r.isEqual(n=t.databaseId))throw t.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ey(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Lc("Unsupported field value: "+pC(e))}(e,t)}function tE(e,t){var n={};return Cp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):wp(e,function(e,r){var i=eE(r,t.kc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function nE(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof vp||e instanceof LC||e instanceof RC||e instanceof bC||e instanceof DC)}function rE(e,t,n){if(!nE(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=pC(n);throw t.Lc("an object"===r?e+" a custom object":e+" "+r)}}function iE(e,t,n){if((t=Object($l.n)(t))instanceof xC)return t._internalPath;if("string"==typeof t)return sE(e,t);throw aE("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var oE=new RegExp("[~\\*/\\[\\]]");function sE(e,t,n){if(t.search(oE)>=0)throw aE("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return(new(xC.bind.apply(xC,Object(Gl.f)([void 0],t.split(".")))))._internalPath}catch(aO){throw aE("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function aE(e,t,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+t+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var c="";return(o||s)&&(c+=" (found",o&&(c+=" in field "+r),s&&(c+=" in document "+i),c+=")"),new rp(np.INVALID_ARGUMENT,(a+=". ")+e+c)}function cE(e,t){return e.some(function(e){return e.isEqual(t)})}var lE=function(){function e(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new bC(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return null!==this._document},e.prototype.data=function(){if(this._document){if(this._converter){var e=new uE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}},e.prototype.get=function(e){if(this._document){var t=this._document.data.field(hE("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}},e}(),uE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(lE);function hE(e,t){return"string"==typeof t?sE(e,t):t instanceof xC?t._internalPath:t._delegate._internalPath}var dE=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),fE=function(e){function t(t,n,r,i,o,s){var a=this;return(a=e.call(this,t,n,r,i,s)||this)._firestore=t,a._firestoreImpl=t,a.metadata=o,a}return Object(Gl.c)(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(e){if(void 0===e&&(e={}),this._document){if(this._converter){var t=new pE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}},t.prototype.get=function(e,t){if(void 0===t&&(t={}),this._document){var n=this._document.data.field(hE("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}},t}(lE),pE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype.data=function(t){return void 0===t&&(t={}),e.prototype.data.call(this,t)},t}(fE),gE=function(){function e(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new dE(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new pE(n._firestore,n._userDataWriter,r.key,r,new dE(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},e.prototype.docChanges=function(e){void 0===e&&(e={});var t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new rp(np.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new pE(e._firestore,e._userDataWriter,t.doc.key,t.doc,new dE(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new pE(e._firestore,e._userDataWriter,t.doc.key,t.doc,new dE(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,o=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(o=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:mE(t.type),doc:n,oldIndex:i,newIndex:o}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e}();function mE(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return up()}}function yE(e,t){return e instanceof fE&&t instanceof fE?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof gE&&t instanceof gE&&e._firestore===t._firestore&&SC(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function vE(e){if(Ig(e)&&0===e.explicitOrderBy.length)throw new rp(np.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bE=function(){};function _E(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=o._apply(e)}return e}var wE=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).jc=t,i.Wc=n,i.Gc=r,i.type="where",i}return Object(Gl.c)(t,e),t.prototype._apply=function(e){var t=HC(e.firestore),n=function(e,t,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new rp(np.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){TE(s,o);for(var c=[],l=0,u=s;l<u.length;l++)c.push(IE(r,e,u[l]));a={arrayValue:{values:c}}}else a=IE(r,e,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||TE(s,o),a=XC(n,"where",s,"in"===o||"not-in"===o);var h=cg.create(i,o,a);return function(e,t){if(t.g()){var n=Ag(e);if(null!==n&&!n.isEqual(t.field))throw new rp(np.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");var r=Tg(e);null!==r&&AE(0,t.field,r)}var i=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(t.indexOf(i.op)>=0)return i.op}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new rp(np.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter.":"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+i.toString()+"' filters.")}(e,h),h}(e._query,0,t,e.firestore._databaseId,this.jc,this.Wc,this.Gc);return new _C(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new Eg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))},t}(bE),CE=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).jc=t,r.zc=n,r.type="orderBy",r}return Object(Gl.c)(t,e),t.prototype._apply=function(e){var t=function(e,t,n){if(null!==e.startAt)throw new rp(np.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new rp(np.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new bg(t,n);return function(e,t){if(null===Tg(e)){var n=Ag(e);null!==n&&AE(0,n,t.field)}}(e,r),r}(e._query,this.jc,this.zc);return new _C(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new Eg(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))},t}(bE),EE=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Hc=n,i.Jc=r,i}return Object(Gl.c)(t,e),t.prototype._apply=function(e){return new _C(e.firestore,e.converter,xg(e._query,this.Hc,this.Jc))},t}(bE),OE=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Yc=n,i.Xc=r,i}return Object(Gl.c)(t,e),t.prototype._apply=function(e){var t=PE(e,this.type,this.Yc,this.Xc);return new _C(e.firestore,e.converter,function(e,t){return new Eg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))},t}(bE),SE=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Yc=n,i.Xc=r,i}return Object(Gl.c)(t,e),t.prototype._apply=function(e){var t=PE(e,this.type,this.Yc,this.Xc);return new _C(e.firestore,e.converter,function(e,t){return new Eg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))},t}(bE);function PE(e,t,n,r){if(n[0]=Object($l.n)(n[0]),n[0]instanceof lE)return function(e,t,n,r,i){if(!r)throw new rp(np.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Ng(e);s<a.length;s++){var c=a[s];if(c.field.isKeyField())o.push(Wp(t,r.key));else{var l=r.data.field(c.field);if(xp(l))throw new rp(np.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===l){var u=c.field.canonicalString();throw new rp(np.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}o.push(l)}}return new yg(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=HC(e.firestore);return function(e,t,n,r,i,o){var s=e.explicitOrderBy;if(i.length>s.length)throw new rp(np.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],c=0;c<i.length;c++){var l=i[c];if(s[c].field.isKeyField()){if("string"!=typeof l)throw new rp(np.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof l);if(!kg(e)&&-1!==l.indexOf("/"))throw new rp(np.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+l+"' contains a slash.");var u=e.path.child(Op.fromString(l));if(!jp.isDocumentKey(u))throw new rp(np.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var h=new jp(u);a.push(Wp(t,h))}else{var d=XC(n,r,l);a.push(d)}}return new yg(a,o)}(e._query,e.firestore._databaseId,i,t,n,r)}function IE(e,t,n){if("string"==typeof(n=Object($l.n)(n))){if(""===n)throw new rp(np.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!kg(t)&&-1!==n.indexOf("/"))throw new rp(np.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(Op.fromString(n));if(!jp.isDocumentKey(r))throw new rp(np.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Wp(e,new jp(r))}if(n instanceof bC)return Wp(e,n._key);throw new rp(np.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pC(n)+".")}function TE(e,t){if(!Array.isArray(e)||0===e.length)throw new rp(np.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new rp(np.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function AE(e,t,n){if(!n.isEqual(t))throw new rp(np.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var kE=function(){function e(){}return e.prototype.convertValue=function(e,t){switch(void 0===t&&(t="none"),Up(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Np(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Mp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw up()}},e.prototype.convertObject=function(e,t){var n=this,r={};return wp(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r},e.prototype.convertGeoPoint=function(e){return new LC(Np(e.latitude),Np(e.longitude))},e.prototype.convertArray=function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})},e.prototype.convertServerTimestamp=function(e,t){switch(t){case"previous":var n=Rp(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Dp(e));default:return null}},e.prototype.convertTimestamp=function(e){var t=kp(e);return new vp(t.seconds,t.nanos)},e.prototype.convertDocumentKey=function(e,t){var n=Op.fromString(e);hp(Sy(n));var r=new tC(n.get(1),n.get(3)),i=new jp(n.popFirst(5));return r.isEqual(t)||ap("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+t.projectId+"/"+t.database+") instead."),i},e}();function NE(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var ME=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(Gl.c)(t,e),t.prototype.convertBytes=function(e){return new RC(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new bC(this.firestore,null,t)},t}(kE),xE=function(){function e(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=HC(e)}return e.prototype.set=function(e,t,n){this._verifyNotCommitted();var r=RE(e,this._firestore),i=NE(r.converter,t,n),o=GC(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,rm.none())),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=RE(e,this._firestore);return o="string"==typeof(t=Object($l.n)(t))||t instanceof xC?JC(this._dataReader,"WriteBatch.update",s._key,t,n,r):KC(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,rm.exists(!0))),this},e.prototype.delete=function(e){this._verifyNotCommitted();var t=RE(e,this._firestore);return this._mutations=this._mutations.concat(new vm(t._key,rm.none())),this},e.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},e.prototype._verifyNotCommitted=function(){if(this._committed)throw new rp(np.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();function RE(e,t){if((e=Object($l.n)(e)).firestore!==t)throw new rp(np.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var DE=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(Gl.c)(t,e),t.prototype.convertBytes=function(e){return new RC(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new bC(this.firestore,null,t)},t}(kE);function LE(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=gC(e,bC);var o=gC(e.firestore,TC),s=HC(o);return FE(o,[("string"==typeof(t=Object($l.n)(t))||t instanceof xC?JC(s,"updateDoc",e._key,t,n,r):KC(s,"updateDoc",e._key,t)).toMutation(e._key,rm.exists(!0))])}function BE(e){for(var t,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];e=Object($l.n)(e);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||IC(i[a])||(s=i[a],a++);var c,l,u,h={includeMetadataChanges:s.includeMetadataChanges};if(IC(i[a])){var d=i[a];i[a]=null===(t=d.next)||void 0===t?void 0:t.bind(d),i[a+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),i[a+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(e instanceof bC)l=gC(e.firestore,TC),u=Sg(e._key.path),c={next:function(t){i[a]&&i[a](jE(l,e,t))},error:i[a+1],complete:i[a+2]};else{var f=gC(e,_C);l=gC(f.firestore,TC),u=f._query;var p=new DE(l);c={next:function(e){i[a]&&i[a](new gE(l,p,f,e))},error:i[a+1],complete:i[a+2]},vE(e._query)}return function(e,t,n,r){var i=this,o=new jw(r),s=new Q_(t,o,n);return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(i,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return t=G_,[4,Kw(e)];case 1:return[2,t.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(i,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return t=$_,[4,Kw(e)];case 1:return[2,t.apply(void 0,[n.sent(),s])]}})})})}}(AC(l),u,h,c)}function FE(e,t){return function(e,t){var n=this,r=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(n,void 0,void 0,function(){var n;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return n=aw,[4,Yw(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}})})}),r.promise}(AC(e),t)}function jE(e,t,n){var r=n.docs.get(t._key),i=new DE(e);return new fE(e,i,t._key,r,new dE(n.hasPendingWrites,n.fromCache),t.converter)}var UE=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this)._firestore=t,r}return Object(Gl.c)(t,e),t.prototype.get=function(t){var n=this,r=RE(t,this._firestore),i=new DE(this._firestore);return e.prototype.get.call(this,t).then(function(e){return new fE(n._firestore,i,r._key,e._document,new dE(!1,!1),r.converter)})},t}(function(){function e(e,t){this._firestore=e,this._transaction=t,this._dataReader=HC(e)}return e.prototype.get=function(e){var t=this,n=RE(e,this._firestore),r=new ME(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return up();var i=e[0];if(i.isFoundDocument())return new lE(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new lE(t._firestore,r,n._key,null,n.converter);throw up()})},e.prototype.set=function(e,t,n){var r=RE(e,this._firestore),i=NE(r.converter,t,n),o=GC(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=RE(e,this._firestore);return o="string"==typeof(t=Object($l.n)(t))||t instanceof xC?JC(this._dataReader,"Transaction.update",s._key,t,n,r):KC(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this},e.prototype.delete=function(e){var t=RE(e,this._firestore);return this._transaction.delete(t._key),this},e}());function VE(){if("undefined"==typeof Uint8Array)throw new rp(np.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function zE(){if("undefined"==typeof atob)throw new rp(np.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var HE=function(){function e(e){this._delegate=e}return e.fromBase64String=function(t){return zE(),new e(RC.fromBase64String(t))},e.fromUint8Array=function(t){return VE(),new e(RC.fromUint8Array(t))},e.prototype.toBase64=function(){return zE(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return VE(),this._delegate.toUint8Array()},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(),GE=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(e,t){return function(e,t){MC(e=gC(e,TC));var n=AC(e),r=e._freezeSettings(),i=new Fw;return NC(n,i,new Lw(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})},e.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(e){MC(e=gC(e,TC));var t=AC(e),n=e._freezeSettings(),r=new Fw;return NC(t,r,new Bw(r,n.cacheSizeBytes))}(e._delegate)},e.prototype.clearIndexedDbPersistence=function(e){return function(e){var t=this;if(e._initialized&&!e._terminated)throw new rp(np.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Qy;return e._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Gl.b)(t,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(e){return Object(Gl.b)(this,void 0,void 0,function(){return Object(Gl.d)(this,function(t){switch(t.label){case 0:return Jy.yt()?[4,Jy.delete(e+"main")]:[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(lb(e._databaseId,e._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise}(e._delegate)},e}(),$E=function(){function e(e,t,n){var r=this;this._delegate=t,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},e instanceof tC||(this.tu=e)}return Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||cp("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)},e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),function(e,t,n,r){var i;void 0===r&&(r={});var o=(e=gC(e,vC))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==t&&cp("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},o),{host:t+":"+n,ssl:!1})),r.mockUserToken){var s,a;if("string"==typeof r.mockUserToken)s=r.mockUserToken,a=Ub.MOCK_USER;else{s=Object($l.i)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);var c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new rp(np.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Ub(c)}e._credentials=new oC(new rC(s,a))}}(this._delegate,e,t,n)},e.prototype.enableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue(function(){return Object(Gl.b)(t,void 0,void 0,function(){var t,n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return[4,Ww(e)];case 1:return t=r.sent(),[4,Qw(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!0),function(e){var t=dp(e);return t.Or.delete(0),d_(t)}(n))]}})})})}(AC(gC(this._delegate,TC)))},e.prototype.disableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue(function(){return Object(Gl.b)(t,void 0,void 0,function(){var t,n;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return[4,Ww(e)];case 1:return t=r.sent(),[4,Qw(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!1),function(e){return Object(Gl.b)(this,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return(t=dp(e)).Or.add(0),[4,f_(t)];case 1:return n.sent(),t.Br.set("Offline"),[2]}})})}(n))]}})})})}(AC(gC(this._delegate,TC)))},e.prototype.enablePersistence=function(e){var t=!1,n=!1;return e&&hC("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(e){var t=this,n=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(t,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(r){switch(r.label){case 0:return t=fw,[4,Yw(e)];case 1:return[2,t.apply(void 0,[r.sent(),n])]}})})}),n.promise}(AC(gC(this._delegate,TC)))},e.prototype.onSnapshotsInSync=function(e){return function(e,t){return function(e,t){var n=this,r=new jw(t);return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(n,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return t=function(e,t){dp(e).Gr.add(t),t.next()},[4,Kw(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(n,void 0,void 0,function(){var t;return Object(Gl.d)(this,function(n){switch(n.label){case 0:return t=function(e,t){dp(e).Gr.delete(t)},[4,Kw(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}})})})}}(AC(e=gC(e,TC)),IC(t)?t:{next:t})}(this._delegate,e)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.tu)throw new rp(np.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new oO(this,CC(this._delegate,e))}catch(e){throw KE(e,"collection()","Firestore.collection()")}},e.prototype.doc=function(e){try{return new YE(this,EC(this._delegate,e))}catch(e){throw KE(e,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(e){try{return new nO(this,function(e,t){if(e=gC(e,vC),lC("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new rp(np.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new _C(e,null,function(e){return new Eg(Op.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw KE(e,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(e){var t=this;return function(e,t){return function(e,t){var n=this,r=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(n,void 0,void 0,function(){var n;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return[4,function(e){return qw(e).then(function(e){return e.datastore})}(e)];case 1:return n=i.sent(),new Vw(e.asyncQueue,n,t,r).run(),[2]}})})}),r.promise}(AC(e),function(n){return t(new UE(e,n))})}(this._delegate,function(n){return e(new WE(t,n))})},e.prototype.batch=function(){var e=this;return AC(this._delegate),new ZE(new xE(this._delegate,function(t){return FE(e._delegate,t)}))},e.prototype.loadBundle=function(e){throw new rp(np.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(e){throw new rp(np.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(),qE=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(Gl.c)(t,e),t.prototype.convertBytes=function(e){return new HE(new RC(e))},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return YE.eu(t,this.firestore,null)},t}(kE),WE=function(){function e(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new qE(e)}return e.prototype.get=function(e){var t=this,n=sO(e);return this._delegate.get(n).then(function(e){return new eO(t._firestore,new fE(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))})},e.prototype.set=function(e,t,n){var r=sO(e);return n?(uC("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=sO(e);return 2===arguments.length?this._delegate.update(s,t):(r=this._delegate).update.apply(r,Object(Gl.f)([s,t,n],i)),this},e.prototype.delete=function(e){var t=sO(e);return this._delegate.delete(t),this},e}(),ZE=function(){function e(e){this._delegate=e}return e.prototype.set=function(e,t,n){var r=sO(e);return n?(uC("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=sO(e);return 2===arguments.length?this._delegate.update(s,t):(r=this._delegate).update.apply(r,Object(Gl.f)([s,t,n],i)),this},e.prototype.delete=function(e){var t=sO(e);return this._delegate.delete(t),this},e.prototype.commit=function(){return this._delegate.commit()},e}(),QE=function(){function e(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}return e.prototype.fromFirestore=function(e,t){var n=new pE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new tO(this._firestore,n),null!=t?t:{})},e.prototype.toFirestore=function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)},e.nu=function(t,n){var r=e.su,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new qE(t),n),i.set(n,o)),o},e}();QE.su=new WeakMap;var YE=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qE(e)}return e.iu=function(t,n,r){if(t.length%2!=0)throw new rp(np.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new bC(n._delegate,r,new jp(t)))},e.eu=function(t,n,r){return new e(n,new bC(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new oO(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new oO(this.firestore,CC(this._delegate,e))}catch(e){throw KE(e,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(e){return(e=Object($l.n)(e))instanceof bC&&OC(this._delegate,e)},e.prototype.set=function(e,t){t=uC("DocumentReference.set",t);try{return function(e,t,n){e=gC(e,bC);var r=gC(e.firestore,TC),i=NE(e.converter,t,n);return FE(r,[GC(HC(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,rm.none())])}(this._delegate,e,t)}catch(e){throw KE(e,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?LE(this._delegate,e):LE.apply(void 0,Object(Gl.f)([this._delegate,e,t],n))}catch(e){throw KE(e,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return FE(gC((e=this._delegate).firestore,TC),[new vm(e._key,rm.none())]);var e},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=JE(t),i=XE(t,function(t){return new eO(e.firestore,new fE(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))});return BE(this._delegate,r,i)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=gC(e,bC);var t=gC(e.firestore,TC),n=AC(t),r=new DE(t);return function(e,t){var n=this,r=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(n,void 0,void 0,function(){var n;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return n=function(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i;return Object(Gl.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(e,t){var n=dp(e);return n.persistence.runTransaction("read document","readonly",function(e){return n.Mn.mn(e,t)})}(e,t)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new rp(np.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=F_(r,"Failed to get document '"+t+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Zw(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}})})}),r.promise}(n,e._key).then(function(n){return new fE(t,r,e._key,n,new dE(null!==n&&n.hasLocalMutations,!0),e.converter)})}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=gC(e,bC);var t=gC(e.firestore,TC);return Jw(AC(t),e._key,{source:"server"}).then(function(n){return jE(t,e,n)})}(this._delegate):function(e){e=gC(e,bC);var t=gC(e.firestore,TC);return Jw(AC(t),e._key).then(function(n){return jE(t,e,n)})}(this._delegate)).then(function(e){return new eO(t.firestore,new fE(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?QE.nu(this.firestore,t):null))},e}();function KE(e,t,n){return e.message=e.message.replace(t,n),e}function JE(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if("object"==typeof r&&!IC(r))return r}return{}}function XE(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=IC(e[0])?e[0]:IC(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var eO=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"ref",{get:function(){return new YE(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(e){return this._delegate.data(e)},e.prototype.get=function(e,t){return this._delegate.get(e,t)},e.prototype.isEqual=function(e){return yE(this._delegate,e._delegate)},e}(),tO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Gl.c)(t,e),t.prototype.data=function(e){return this._delegate.data(e)},t}(eO),nO=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qE(e)}return e.prototype.where=function(t,n,r){try{return new e(this.firestore,_E(this._delegate,function(e,t,n){var r=t,i=hE("where",e);return new wE(i,r,n)}(t,n,r)))}catch(t){throw KE(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,_E(this._delegate,function(e,t){void 0===t&&(t="asc");var n=t,r=hE("orderBy",e);return new CE(r,n)}(t,n)))}catch(t){throw KE(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,_E(this._delegate,function(e){return mC("limit",e),new EE("limit",e,"F")}(t)))}catch(t){throw KE(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,_E(this._delegate,function(e){return mC("limitToLast",e),new EE("limitToLast",e,"L")}(t)))}catch(t){throw KE(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,_E(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new OE("startAt",e,!0)}).apply(void 0,t)))}catch(t){throw KE(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,_E(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new OE("startAfter",e,!1)}).apply(void 0,t)))}catch(t){throw KE(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,_E(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new SE("endBefore",e,!0)}).apply(void 0,t)))}catch(t){throw KE(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,_E(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new SE("endAt",e,!1)}).apply(void 0,t)))}catch(t){throw KE(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(e){return SC(this._delegate,e._delegate)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=gC(e,_C);var t=gC(e.firestore,TC),n=AC(t),r=new DE(t);return function(e,t){var n=this,r=new Qy;return e.asyncQueue.enqueueAndForget(function(){return Object(Gl.b)(n,void 0,void 0,function(){var n;return Object(Gl.d)(this,function(i){switch(i.label){case 0:return n=function(e,t,n){return Object(Gl.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(Gl.d)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,Ob(e,t,!0)];case 1:return a=c.sent(),r=new ew(t,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=c.sent(),a=F_(s,"Failed to execute query '"+t+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Zw(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}})})}),r.promise}(n,e._query).then(function(n){return new gE(t,r,e,n)})}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=gC(e,_C);var t=gC(e.firestore,TC),n=AC(t),r=new DE(t);return Xw(n,e._query,{source:"server"}).then(function(n){return new gE(t,r,e,n)})}(this._delegate):function(e){e=gC(e,_C);var t=gC(e.firestore,TC),n=AC(t),r=new DE(t);return vE(e._query),Xw(n,e._query).then(function(n){return new gE(t,r,e,n)})}(this._delegate)).then(function(e){return new iO(t.firestore,new gE(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))})},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=JE(t),i=XE(t,function(t){return new iO(e.firestore,new gE(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))});return BE(this._delegate,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?QE.nu(this.firestore,t):null))},e}(),rO=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new tO(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(),iO=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"query",{get:function(){return new nO(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map(function(t){return new tO(e._firestore,t)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(e){var t=this;return this._delegate.docChanges(e).map(function(e){return new rO(t._firestore,e)})},e.prototype.forEach=function(e,t){var n=this;this._delegate.forEach(function(r){e.call(t,new tO(n._firestore,r))})},e.prototype.isEqual=function(e){return yE(this._delegate,e._delegate)},e}(),oO=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).firestore=t,r._delegate=n,r}return Object(Gl.c)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return e?new YE(this.firestore,e):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(e){try{return new YE(this.firestore,void 0===e?EC(this._delegate):EC(this._delegate,e))}catch(e){throw KE(e,"doc()","CollectionReference.doc()")}},t.prototype.add=function(e){var t=this;return function(e,t){var n=gC(e.firestore,TC),r=EC(e),i=NE(e.converter,t);return FE(n,[GC(HC(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,rm.exists(!1))]).then(function(){return r})}(this._delegate,e).then(function(e){return new YE(t.firestore,e)})},t.prototype.isEqual=function(e){return OC(this._delegate,e._delegate)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?QE.nu(this.firestore,e):null))},t}(nO);function sO(e){return gC(e,bC)}var aO,cO=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._delegate=new(xC.bind.apply(xC,Object(Gl.f)([void 0],e)))}return e.documentId=function(){return new e(Pp.keyField().canonicalString())},e.prototype.isEqual=function(e){return(e=Object($l.n)(e))instanceof xC&&this._delegate._internalPath.isEqual(e._internalPath)},e}(),lO=function(){function e(e){this._delegate=e}return e.serverTimestamp=function(){var t=new WC("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new $C("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new ZC("arrayUnion",e)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new QC("arrayRemove",e)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(e){return new YC("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e}(),uO=n("/6Yf"),hO={Firestore:$E,GeoPoint:LC,Timestamp:vp,Blob:HE,Transaction:WE,WriteBatch:ZE,DocumentReference:YE,DocumentSnapshot:eO,Query:nO,QueryDocumentSnapshot:tO,QuerySnapshot:iO,CollectionReference:oO,FieldPath:cO,FieldValue:lO,setLogLevel:function(e){ip.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(e,t){e.INTERNAL.registerComponent(new uO.a("firestore",function(e){return function(e,t){return new $E(e,new TC(e,t),new GE)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},hO)))})(aO=Hl.a),aO.registerVersion("@firebase/firestore","2.4.0");var dO=n("VRyK"),fO=n("qgXg"),pO=n("Ylt2");class gO extends Sr.a{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new mO(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,n=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let o;if(this.closed)throw new Pr.a;if(this.isStopped||this.hasError?o=vi.a.EMPTY:(this.observers.push(e),o=new pO.a(this,e)),r&&e.add(e=new Vl.a(e,r)),t)for(let s=0;s<i&&!e.closed;s++)e.next(n[s]);else for(let s=0;s<i&&!e.closed;s++)e.next(n[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||fO.a).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let o=0;for(;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r}}class mO{constructor(e,t){this.time=e,this.value=t}}function yO(e,t,n){let r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},e=>e.lift(function({bufferSize:e=Number.POSITIVE_INFINITY,windowTime:t=Number.POSITIVE_INFINITY,refCount:n,scheduler:r}){let i,o,s=0,a=!1,c=!1;return function(l){let u;s++,!i||a?(a=!1,i=new gO(e,t,r),u=i.subscribe(this),o=l.subscribe({next(e){i.next(e)},error(e){a=!0,i.error(e)},complete(){c=!0,o=void 0,i.complete()}}),c&&(o=void 0)):u=i.subscribe(this),this.add(()=>{s--,u.unsubscribe(),u=void 0,o&&!c&&n&&0===s&&(o.unsubscribe(),o=void 0,i=void 0)})}}(r))}function vO(e,t){return t?Gr(()=>e,t):Gr(()=>e)}var bO=n("tf+s");const _O=new r.r("angularfire2.auth.use-emulator"),wO=new r.r("angularfire2.auth.settings"),CO=new r.r("angularfire2.auth.tenant-id"),EO=new r.r("angularfire2.auth.langugage-code"),OO=new r.r("angularfire2.auth.use-device-language"),SO=new r.r("angularfire.auth.persistence");let PO=(()=>{class e{constructor(e,t,r,i,o,s,a,c,l,u){const h=new Rl.d(i),d=Object(Rl.h)(h),f=new Sr.a,p=Object(Un.a)(void 0).pipe(Object(Vl.b)(h.outsideAngular),Gr(()=>i.runOutsideAngular(()=>Promise.resolve().then(n.bind(null,"6nsN")))),Object(ot.a)(()=>Object(Rl.g)(e,i,t)),Object(ot.a)(e=>i.runOutsideAngular(()=>{const t=o,n=s;return Object(Rl.f)(`${e.name}.auth`,"AngularFireAuth",e,()=>{const r=i.runOutsideAngular(()=>e.auth());if(t&&r.useEmulator(`http://${t.join(":")}`),a&&(r.tenantId=a),r.languageCode=c,l&&r.useDeviceLanguage(),n)for(const[e,t]of Object.entries(n))r.settings[e]=t;return u&&r.setPersistence(u),r},[t,a,c,l,n,u])})),yO({bufferSize:1,refCount:!1}));if(_e(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Object(Un.a)(null);else{p.pipe(gi()).subscribe();const e=p.pipe(Gr(e=>e.getRedirectResult().then(e=>e,()=>null)),d,yO({bufferSize:1,refCount:!1})),t=e=>new rt.a(t=>({unsubscribe:i.runOutsideAngular(()=>e(t))})),n=p.pipe(Gr(e=>t(e.onAuthStateChanged.bind(e)))),r=p.pipe(Gr(e=>t(e.onIdTokenChanged.bind(e))));this.authState=e.pipe(vO(n),Object(bO.a)(h.outsideAngular),Object(Vl.b)(h.insideAngular)),this.user=e.pipe(vO(r),Object(bO.a)(h.outsideAngular),Object(Vl.b)(h.insideAngular)),this.idToken=this.user.pipe(Gr(e=>e?Object(nt.a)(e.getIdToken()):Object(Un.a)(null))),this.idTokenResult=this.user.pipe(Gr(e=>e?Object(nt.a)(e.getIdTokenResult()):Object(Un.a)(null))),this.credential=Object(dO.a)(e,f,this.authState.pipe(Gn(e=>!e))).pipe(Object(ot.a)(e=>(null==e?void 0:e.user)?e:null),Object(bO.a)(h.outsideAngular),Object(Vl.b)(h.insideAngular))}return Object(Rl.i)(this,p,i,{spy:{apply:(e,t,n)=>{(e.startsWith("signIn")||e.startsWith("createUser"))&&n.then(e=>f.next(e))}}})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Rl.c),r.Zb(Rl.b,8),r.Zb(r.C),r.Zb(r.A),r.Zb(_O,8),r.Zb(wO,8),r.Zb(CO,8),r.Zb(EO,8),r.Zb(OO,8),r.Zb(SO,8))},e.\u0275prov=r.Hb({factory:function(){return new e(r.Zb(Rl.c),r.Zb(Rl.b,8),r.Zb(r.C),r.Zb(r.A),r.Zb(_O,8),r.Zb(wO,8),r.Zb(CO,8),r.Zb(EO,8),r.Zb(OO,8),r.Zb(SO,8))},token:e,providedIn:"any"}),e})();function IO(e,t){return function(e,t=Dl.a){return new rt.a(n=>{let r;return null!=t?t.schedule(()=>{r=e.onSnapshot({includeMetadataChanges:!0},n)}):r=e.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(e,t)}function TO(e,t){return IO(e,t).pipe(Object(ot.a)(e=>({payload:e,type:"query"})))}function AO(e,t){return TO(e,t).pipe(Kr(void 0),Ll(),Object(ot.a)(([e,t])=>{const n=t.payload.docChanges(),r=n.map(e=>({type:e.type,payload:e}));return e&&JSON.stringify(e.payload.metadata)!==JSON.stringify(t.payload.metadata)&&t.payload.docs.forEach((t,i)=>{const o=n.find(e=>e.doc.ref.isEqual(t.ref)),s=null==e?void 0:e.payload.docs.find(e=>e.ref.isEqual(t.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(t.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(t.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:t}})}),r}))}function kO(e,t,n){return AO(e,n).pipe(Jr((e,n)=>function(e,t,n){return t.forEach(t=>{n.indexOf(t.type)>-1&&(e=function(e,t){switch(t.type){case"added":if(!e[t.newIndex]||!e[t.newIndex].doc.ref.isEqual(t.doc.ref))return NO(e,t.newIndex,0,t);break;case"modified":if(null==e[t.oldIndex]||e[t.oldIndex].doc.ref.isEqual(t.doc.ref)){if(t.oldIndex!==t.newIndex){const n=e.slice();return n.splice(t.oldIndex,1),n.splice(t.newIndex,0,t),n}return NO(e,t.newIndex,1,t)}break;case"removed":if(e[t.oldIndex]&&e[t.oldIndex].doc.ref.isEqual(t.doc.ref))return NO(e,t.oldIndex,1)}return e}(e,t))}),e}(e,n.map(e=>e.payload),t),[]),e=>e.lift(new jl(void 0,void 0)),Object(ot.a)(e=>e.map(e=>({type:e.type,payload:e}))))}function NO(e,t,n,...r){const i=e.slice();return i.splice(t,n,...r),i}function MO(e){return e&&0!==e.length||(e=["added","removed","modified"]),e}Object(Rl.e)(PO,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);class xO{constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=AO(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Object(ot.a)(t=>t.filter(t=>e.indexOf(t.type)>-1)))),t.pipe(Kr(void 0),Ll(),Gn(([e,t])=>t.length>0||!e),Object(ot.a)(([e,t])=>t),this.afs.keepUnstableUntilFirst)}auditTrail(e){return this.stateChanges(e).pipe(Jr((e,t)=>[...e,...t],[]))}snapshotChanges(e){const t=MO(e);return kO(this.query,t,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(e={}){return TO(this.query,this.afs.schedulers.outsideAngular).pipe(Object(ot.a)(t=>t.payload.docs.map(t=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data())),this.afs.keepUnstableUntilFirst)}get(e){return Object(nt.a)(this.query.get(e)).pipe(Object(Vl.b)(this.afs.schedulers.insideAngular))}add(e){return this.ref.add(e)}doc(e){return new RO(this.ref.doc(e),this.afs)}}class RO{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const n=this.ref.collection(e),{ref:r,query:i}=UO(n,t);return new xO(r,i,this.afs)}snapshotChanges(){return IO(this.ref,this.afs.schedulers.outsideAngular).pipe(Kr(void 0),Ll(),Object(ot.a)(([e,t])=>t.exists?(null==e?void 0:e.exists)?{payload:t,type:"modified"}:{payload:t,type:"added"}:{payload:t,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(e={}){return this.snapshotChanges().pipe(Object(ot.a)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Object(nt.a)(this.ref.get(e)).pipe(Object(Vl.b)(this.afs.schedulers.insideAngular))}}class DO{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?AO(this.query,this.afs.schedulers.outsideAngular).pipe(Object(ot.a)(t=>t.filter(t=>e.indexOf(t.type)>-1)),Gn(e=>e.length>0),this.afs.keepUnstableUntilFirst):AO(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(e){return this.stateChanges(e).pipe(Jr((e,t)=>[...e,...t],[]))}snapshotChanges(e){const t=MO(e);return kO(this.query,t,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(e={}){return TO(this.query,this.afs.schedulers.outsideAngular).pipe(Object(ot.a)(t=>t.payload.docs.map(t=>e.idField?Object.assign({[e.idField]:t.id},t.data()):t.data())),this.afs.keepUnstableUntilFirst)}get(e){return Object(nt.a)(this.query.get(e)).pipe(Object(Vl.b)(this.afs.schedulers.insideAngular))}}const LO=new r.r("angularfire2.enableFirestorePersistence"),BO=new r.r("angularfire2.firestore.persistenceSettings"),FO=new r.r("angularfire2.firestore.settings"),jO=new r.r("angularfire2.firestore.use-emulator");function UO(e,t=(e=>e)){return{query:t(e),ref:e}}let VO=(()=>{class e{constructor(e,t,n,r,i,o,s,a,c){this.schedulers=new Rl.d(o),this.keepUnstableUntilFirst=Object(Rl.h)(this.schedulers);const l=Object(Rl.g)(e,o,t);!zl.a.auth&&c&&Object(Rl.j)();const u=a;[this.firestore,this.persistenceEnabled$]=Object(Rl.f)(`${l.name}.firestore`,"AngularFirestore",l,()=>{const e=o.runOutsideAngular(()=>l.firestore());if(r&&e.settings(r),u&&e.useEmulator(...u),n&&!_e(i)){const t=()=>{try{return Object(nt.a)(e.enablePersistence(s||void 0).then(()=>!0,()=>!1))}catch(aO){return"undefined"!=typeof console&&console.warn(aO),Object(Un.a)(!1)}};return[e,o.runOutsideAngular(t)]}return[e,Object(Un.a)(!1)]},[r,u,n])}collection(e,t){let n;n="string"==typeof e?this.firestore.collection(e):e;const{ref:r,query:i}=UO(n,t),o=this.schedulers.ngZone.run(()=>r);return new xO(o,i,this)}collectionGroup(e,t){const n=t||(e=>e),r=this.firestore.collectionGroup(e);return new DO(n(r),this)}doc(e){let t;t="string"==typeof e?this.firestore.doc(e):e;const n=this.schedulers.ngZone.run(()=>t);return new RO(n,this)}createId(){return this.firestore.collection("_").doc().id}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Rl.c),r.Zb(Rl.b,8),r.Zb(LO,8),r.Zb(FO,8),r.Zb(r.C),r.Zb(r.A),r.Zb(BO,8),r.Zb(jO,8),r.Zb(_O,8))},e.\u0275prov=r.Hb({factory:function(){return new e(r.Zb(Rl.c),r.Zb(Rl.b,8),r.Zb(LO,8),r.Zb(FO,8),r.Zb(r.C),r.Zb(r.A),r.Zb(BO,8),r.Zb(jO,8),r.Zb(_O,8))},token:e,providedIn:"any"}),e})(),zO=(()=>{class e{static enablePersistence(t){return{ngModule:e,providers:[{provide:LO,useValue:!0},{provide:BO,useValue:t}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({providers:[VO]}),e})();function HO(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(l){return void n(l)}a.done?t(c):Promise.resolve(c).then(r,i)}function GO(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(e){HO(o,r,i,s,a,"next",e)}function a(e){HO(o,r,i,s,a,"throw",e)}s(void 0)})}}class $O{static handleError(e){throw new Error("Encountered error: "+e)}static expectToBe(e,t,n){if(e!==t){if(void 0!==n)throw new Error(n);throw new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}}static expectToBeMultiple(e,t){let n=!1;for(const r of t)if(e===r){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}function qO(e,t){e&&console.log(t)}function WO(e,t){!1===e&&$O.handleError("Assertion failure: "+t)}class ZO{}class QO extends ZO{static disjunction3(e,t,n,r,i){return new class extends QO{encodeMove(o){return r(o)?{type:"T1",encoded:e.encode(o)}:i(o)?{type:"T2",encoded:t.encode(o)}:{type:"T3",encoded:n.encode(o)}}decodeMove(r){const i=$O.getNonNullable(r).type,o=$O.getNonNullable(r).encoded;return"T1"===i?e.decode(o):"T2"===i?t.decode(o):n.decode(o)}}}encode(e){return this.encodeMove(e)}decode(e){return WO(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}let YO=(()=>{class e extends QO{static ofN(t,n,r){return new class extends e{maxValue(){return t}encodeNumber(e){return n(e)}decodeNumber(e){return r(e)}}}static tuple(t,n,r){return new class extends e{maxValue(){let e=0;return Object.keys(t).forEach(n=>{e=e*t[n].shift()+t[n].maxValue()}),e}encodeNumber(e){const r=n(e);let i=0;return Object.keys(r).forEach(e=>{i=i*t[e].shift()+t[e].encode(r[e])}),i}decodeNumber(e){const n={};let i=e;return Object.keys(t).reverse().forEach(e=>{const r=i%t[e].shift();i=(i-r)/t[e].shift(),n[e]=t[e].decode(r)}),r(n)}}}static disjunction(t,n,r){return new class extends e{maxValue(){return Math.max(2*t.maxValue(),2*n.maxValue()+1)}encodeNumber(e){return r(e)?2*t.encodeNumber(e):2*n.encodeNumber(e)+1}decodeNumber(e){return e%2==0?t.decodeNumber(e/2):n.decodeNumber((e-1)/2)}}}static numberEncoder(t){return new class extends e{maxValue(){return t}encodeNumber(e){if(e>t)throw new Error("Cannot encode number bigger than the max with numberEncoder");return e}decodeNumber(e){if(e>t)throw new Error("Cannot decode number bigger than the max with numberEncoder");return e}}}shift(){return this.maxValue()+1}encodeMove(e){return this.encodeNumber(e)}decodeMove(e){return WO("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}return e.booleanEncoder=new class extends e{maxValue(){return 1}encodeNumber(e){return e?1:0}decodeNumber(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}},e})();function KO(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals&&null!=e.toString}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(const t in e)if(null!=e[t]&&!1===KO(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function JO(e,t){return KO(e)&&KO(t)?function(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);{const n=e,r=t;for(const e of Object.keys(n)){if(!(e in r))return!1;if(!1===JO(n[e],r[e]))return!1}return!0}}return e===t}(e,t):($O.handleError("Comparing non comparable objects"),!1)}class XO{constructor(e){this.value=e}static encoder(e){return new class extends ZO{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?XO.empty():XO.of(e.decode(t))}}}static of(e){return new XO(e)}static ofNullable(e){return null==e?XO.empty():XO.of(e)}static empty(){return new XO(null)}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&JO(this.value,e.value)}equalsValue(e){return this.equals(XO.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?XO.of(e(this.get())):XO.empty()}}let eS=(()=>{class e{constructor(e,t){this.collectionName=e,this.afs=t}create(e){var t=this;return GO(function*(){return(yield t.afs.collection(t.collectionName).add({...e})).id})()}read(e){var t=this;return GO(function*(){const n=yield t.afs.collection(t.collectionName).doc(e).ref.get();return n.exists?XO.of($O.getNonNullable(n.data())):XO.empty()})()}exists(e){var t=this;return GO(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return GO(function*(){return n.afs.collection(n.collectionName).doc(e).ref.update(t)})()}delete(e){return this.afs.collection(this.collectionName).doc(e).ref.delete()}set(t,n){return qO(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),this.afs.collection(this.collectionName).doc(t).set(n)}getObsById(e){return this.afs.doc(this.collectionName+"/"+e).snapshotChanges().pipe(Object(ot.a)(e=>XO.ofNullable(e.payload.data())))}findWhere(e){var t=this;return GO(function*(){const n=t.constructQuery(e);return(yield n.get()).docs.map(e=>e.data())})()}observingWhere(t,n){return this.constructQuery(t).onSnapshot(t=>{const r=[],i=[],o=[];t.docChanges().forEach(e=>{const t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":i.push(t);break;case"removed":o.push(t)}}),r.length>0&&(qO(e.VERBOSE,"firebase gave us "+r.length+" NEW "+this.collectionName),n.onDocumentCreated(r)),i.length>0&&(qO(e.VERBOSE,"firebase gave us "+i.length+" MODIFIED "+this.collectionName),n.onDocumentModified(i)),o.length>0&&(qO(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+this.collectionName),n.onDocumentDeleted(o))})}constructQuery(e){WO(e.length>=1,"constructQuery called without conditions");let t=null;for(const n of e)t=null==t?this.afs.collection(this.collectionName).ref.where(n[0],n[1],n[2]):t.where(n[0],n[1],n[2]);return $O.getNonNullable(t)}}return e.VERBOSE=!1,e})(),tS=(()=>{class e{constructor(e){this.value=e}}return e.HARD_DRAW=new e(0),e.RESIGN=new e(1),e.ESCAPE=new e(2),e.VICTORY=new e(3),e.TIMEOUT=new e(4),e.UNACHIEVED=new e(5),e.AGREED_DRAW_BY_ZERO=new e(6),e.AGREED_DRAW_BY_ONE=new e(7),e})();class nS{constructor(e,t){this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===tS.HARD_DRAW.value}isAgreedDraw(){return this.data.result===tS.AGREED_DRAW_BY_ZERO.value||this.data.result===tS.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===tS.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(WO(this.data.result===tS.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),$O.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===tS.VICTORY.value}isTimeout(){return this.data.result===tS.TIMEOUT.value}isResign(){return this.data.result===tS.RESIGN.value}getWinner(){return XO.ofNullable(this.data.winner)}getLoser(){return XO.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new nS(this.id,{...this.data,winner:e,loser:t})}}let rS=(()=>{class e extends eS{constructor(t){super("parties",t),this.afs=t,qO(e.VERBOSE,"PartDAO.constructor")}updateAndBumpIndex(e,t,n,r){var i=this;return GO(function*(){return r={...r,lastUpdate:{index:n+1,player:t.value}},i.update(e,r)})()}observeActiveParts(e){return this.observingWhere([["result","==",tS.UNACHIEVED.value]],e)}userHasActivePart(e){var t=this;return GO(function*(){const n=yield t.findWhere([["playerZero","==",e],["result","==",tS.UNACHIEVED.value]]),r=yield t.findWhere([["playerOne","==",e],["result","==",tS.UNACHIEVED.value]]);return n.length>0||r.length>0})()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(VO))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class iS{static success(e){return new oS(e)}static failure(e){return new sS(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&JO(this.get(),e.get())}}class oS extends iS{constructor(e){super(),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return XO.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class sS extends iS{constructor(e){super(),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return XO.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}let aS=(()=>{class e{constructor(e){this.reason=e}static ofFallible(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}static failure(t){return new e(t)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(e){return this.isSuccess()?iS.success(e):iS.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return iS.failure(this.getReason())}}return e.SUCCESS=new e(null),e})();class cS{static mapBiArray(e,t){const n=[];let r=0;for(;r<e.length;){n[r]=[];let i=0;for(;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}static createTable(e,t,n){const r=[];let i=t-1;for(;i>=0;){r[i]=[];let t=e-1;for(;t>=0;)r[i][t]=n,t--;i--}return r}static copyBiArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=cS.copyImmutableArray(e[n]),n++;return t}static copyImmutableArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=e[n],n++;return t}static sortByDescending(e,t){e.sort((e,n)=>{const r=t(e),i=t(n);return r<i?1:r>i?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===JO(e[n],t[n]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===cS.compareArray(e[n],t[n]))return!1;return!0}}let lS=(()=>{class e extends eS{constructor(t){super("chats",t),this.afs=t,qO(e.VERBOSE,"ChatDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(VO))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),uS=(()=>{class e{}return e.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,e.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,e})(),hS=(()=>{class e{constructor(t){this.chatDAO=t,this.followedChatId=XO.empty(),this.followedChatObs=XO.empty(),qO(e.VERBOSE,"ChatService.constructor")}startObserving(t,n){if(qO(e.VERBOSE,"ChatService.startObserving "+t),!this.followedChatId.isAbsent())throw this.followedChatId.equalsValue(t)?new Error(`WTF :: Already observing chat '${t}'`):new Error(`Cannot ask to watch '${t}' while watching '${this.followedChatId.get()}'`);qO(e.VERBOSE,"[start watching chat "+t),this.followedChatId=XO.of(t),this.followedChatObs=XO.of(this.chatDAO.getObsById(t)),this.followedChatSub=this.followedChatObs.get().subscribe(n)}stopObserving(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");qO(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=XO.empty(),this.followedChatSub.unsubscribe(),this.followedChatObs=XO.empty()}isObserving(){return this.followedChatId.isPresent()}deleteChat(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)})()}createNewChat(e){var t=this;return GO(function*(){return t.chatDAO.set(e,{messages:[]})})()}sendMessage(e,t,n){var r=this;return GO(function*(){if(r.followedChatId.isAbsent())return aS.failure("Cannot send message if not observing chat");const i=r.followedChatId.get();if(!1===r.userCanSendMessage(e,i))return aS.failure(uS.CANNOT_SEND_MESSAGE());if(r.isForbiddenMessage(t))return aS.failure(uS.FORBIDDEN_MESSAGE());const o=(yield r.chatDAO.read(i)).get(),s=cS.copyImmutableArray(o.messages),a={content:t,sender:e,postedTime:Date.now(),currentTurn:n};return s.push(a),yield r.chatDAO.update(i,{messages:s}),aS.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}ngOnDestroy(){this.isObserving()&&this.stopObserving()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(lS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class dS{constructor(e,t,n){this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let fS=(()=>{class e extends eS{constructor(t){super(e.COLLECTION_NAME,t),this.afs=t,qO(e.VERBOSE,"JoueursDAO.constructor")}usernameIsAvailable(t){var n=this;return GO(function*(){return(yield n.afs.collection(e.COLLECTION_NAME).ref.where("username","==",t).limit(1).get()).empty})()}setUsername(e,t){var n=this;return GO(function*(){yield n.update(e,{username:t})})()}markVerified(e){var t=this;return GO(function*(){yield t.update(e,{verified:!0})})()}observeUserByUsername(e,t){return this.observingWhere([["username","==",e],["verified","==",!0]],t)}observeActiveUsers(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}}return e.VERBOSE=!1,e.COLLECTION_NAME="joueurs",e.\u0275fac=function(t){return new(t||e)(r.Zb(VO))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),pS=(()=>{class e{constructor(e){this.userDAO=e,this.activeUsersBS=new Ir([]),this.activeUsersObs=this.activeUsersBS.asObservable()}startObserving(){qO(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");const t=new dS(t=>{qO(e.VERBOSE,"our DAO gave us "+t.length+" new user(s)");const n=this.activeUsersBS.value.concat(...t);this.activeUsersBS.next(this.sort(n))},t=>{let n=this.activeUsersBS.value;qO(e.VERBOSE,"our DAO updated "+t.length+" user(s)");for(const e of t)n.forEach(t=>{t.id===e.id&&(t.data=e.data)}),n=this.sort(n);this.activeUsersBS.next(n)},e=>{const t=this.activeUsersBS.value.filter(t=>!e.some(e=>e.id===t.id));this.activeUsersBS.next(this.sort(t))});this.unsubscribe=this.userDAO.observeActiveUsers(t)}stopObserving(){this.unsubscribe(),this.activeUsersBS.next([])}sort(e){return e.sort((e,t)=>$O.getNonNullable($O.getNonNullable(e.data).last_changed).seconds-$O.getNonNullable($O.getNonNullable(t.data).last_changed).seconds)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(fS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),gS=(()=>{class e{constructor(e,t){this.activeUsersService=e,this.joueursDAO=t}getActiveUsersObs(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}unSubFromActiveUsersObs(){this.activeUsersService.stopObserving()}observeUserByUsername(e,t){return this.joueursDAO.observeUserByUsername(e,t)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(pS),r.Zb(fS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();n("6nsN"),n("6Uf2");let mS=(()=>{class e{static setOffline(t){return zl.a.database().ref("/status/"+t).set(e.OFFLINE)}static updatePresence(t){return GO(function*(){const n=zl.a.database().ref("/status/"+t);zl.a.database().ref(".info/connected").on("value",function(){var t=GO(function*(t){!1!==t.val()&&(yield n.onDisconnect().set(e.OFFLINE).then(GO(function*(){yield n.set(e.ONLINE)})))});return function(e){return t.apply(this,arguments)}}())})()}}return e.OFFLINE={state:"offline",last_changed:zl.a.database.ServerValue.TIMESTAMP},e.ONLINE={state:"online",last_changed:zl.a.database.ServerValue.TIMESTAMP},e})(),yS=(()=>{class e{constructor(e,t,n){this.email=e,this.username=t,this.verified=n}isConnected(){return this.email.isPresent()}}return e.NOT_CONNECTED=new e(XO.empty(),XO.empty(),!1),e})(),vS=(()=>{class e{constructor(t,n){var r=this;this.afAuth=t,this.userDAO=n,this.registrationInProgress=XO.empty(),qO(e.VERBOSE,"1 authService subscribe to Obs<User>"),this.userRS=new gO(1),this.userObs=this.userRS.asObservable(),this.authSub=this.afAuth.user.subscribe(function(){var t=GO(function*(t){if(null==t)qO(e.VERBOSE,"User is not connected"),r.userRS.next(yS.NOT_CONNECTED);else{r.registrationInProgress.isPresent()&&(yield r.registrationInProgress.get(),r.registrationInProgress=XO.empty()),yield mS.updatePresence(t.uid);const i=(yield n.read(t.uid)).get();qO(e.VERBOSE,`User ${i.username} is connected, and the verified status is ${r.emailVerified(t)}`);const o=!0===r.emailVerified(t)&&null!==i.username;!0===o&&!1===i.verified&&(yield n.markVerified(t.uid));const s=new yS(XO.ofNullable(t.email),XO.ofNullable(i.username),o);r.user=XO.of(s),r.userRS.next(s)}});return function(e){return t.apply(this,arguments)}}())}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return GO(function*(){try{return yield zl.a.auth().sendPasswordResetEmail(e),aS.SUCCESS}catch(aO){return aS.failure(t.mapFirebaseError(aO))}})()}doRegister(t,n,r){var i=this;return GO(function*(){return qO(e.VERBOSE,"AuthenticationService.doRegister("+n+")"),(yield i.userDAO.usernameIsAvailable(t))?(i.registrationInProgress=XO.of(i.registerAfterUsernameCheck(t,n,r)),i.registrationInProgress.get()):iS.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var r=this;return GO(function*(){try{const i=yield zl.a.auth().createUserWithEmailAndPassword(t,n),o=$O.getNonNullable(i.user);return yield r.createUser(o.uid,e),iS.success(o)}catch(aO){return iS.failure(r.mapFirebaseError(aO))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;default:return $O.handleError("Unsupported firebase error: "+e.code+" ("+e.message+")"),e.message}}sendEmailVerification(){var t=this;return GO(function*(){qO(e.VERBOSE,"AuthenticationService.sendEmailVerification()");const n=XO.ofNullable(zl.a.auth().currentUser);if(!n.isPresent())return $O.handleError("Unlogged users cannot request for email verification");if(!0===t.emailVerified(n.get()))return $O.handleError("Verified users should not ask email verification twice");try{return yield n.get().sendEmailVerification(),aS.SUCCESS}catch(aO){return aS.failure(t.mapFirebaseError(aO))}})()}doEmailLogin(t,n){var r=this;return GO(function*(){qO(e.VERBOSE,"AuthenticationService.doEmailLogin("+t+")");try{return yield zl.a.auth().signInWithEmailAndPassword(t,n),aS.SUCCESS}catch(aO){return aS.failure(r.mapFirebaseError(aO))}})()}createUser(e,t){var n=this;return GO(function*(){WO(!1===(yield n.userDAO.exists(e)),"createUser should only be called for new users"),null==t?yield n.userDAO.set(e,{verified:!1}):yield n.userDAO.set(e,{username:t,verified:!1})})()}doGoogleLogin(){var e=this;return GO(function*(){e.registrationInProgress=XO.of(e.registerOrLoginWithGoogle());const t=yield e.registrationInProgress.get();return aS.ofFallible(t)})()}registerOrLoginWithGoogle(){var e=this;return GO(function*(){try{const t=new zl.a.auth.GoogleAuthProvider;t.addScope("profile"),t.addScope("email");const n=yield e.afAuth.signInWithPopup(t),r=$O.getNonNullable(n.user);return yield e.createUser(r.uid),iS.success(r)}catch(aO){return iS.failure(e.mapFirebaseError(aO))}})()}disconnect(){var e=this;return GO(function*(){const t=XO.ofNullable(zl.a.auth().currentUser);if(t.isPresent()){const n=t.get().uid;return yield mS.setOffline(n),yield e.afAuth.signOut(),aS.SUCCESS}return aS.failure("Cannot disconnect a non-connected user")})()}getUserObs(){return this.userObs}setUsername(e){var t=this;return GO(function*(){if(""===e)return aS.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userDAO.usernameIsAvailable(e)))return aS.failure($localize`This username is already in use, please select a different one.`);const n=$O.getNonNullable(zl.a.auth().currentUser);return yield n.updateProfile({displayName:e}),yield t.userDAO.setUsername(n.uid,e),yield t.userDAO.markVerified(n.uid),yield t.reloadUser(),aS.SUCCESS}catch(aO){return aS.failure(t.mapFirebaseError(aO))}})()}setPicture(e){var t=this;return GO(function*(){try{return yield $O.getNonNullable(zl.a.auth().currentUser).updateProfile({photoURL:e}),aS.SUCCESS}catch(aO){return aS.failure(t.mapFirebaseError(aO))}})()}reloadUser(){return GO(function*(){const e=$O.getNonNullable(zl.a.auth().currentUser);yield e.getIdToken(!0),yield e.reload()})()}ngOnDestroy(){this.authSub.unsubscribe()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(PO),r.Zb(fS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})(),bS=(()=>{class e{constructor(e){this.value=e}static of(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return WO("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}return e.CREATOR=new e("CREATOR"),e.RANDOM=new e("RANDOM"),e.CHOSEN_PLAYER=new e("CHOSEN_PLAYER"),e})(),_S=(()=>{class e{constructor(e){this.value=e}static of(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}return e.STANDARD=new e("STANDARD"),e.BLITZ=new e("BLITZ"),e.CUSTOM=new e("CUSTOM"),e.NORMAL_MOVE_DURATION=120,e.NORMAL_PART_DURATION=1800,e.BLITZ_MOVE_DURATION=30,e.BLITZ_PART_DURATION=900,e})(),wS=(()=>{class e{constructor(e){this.value=e}}return e.PART_CREATED=new e(0),e.CONFIG_PROPOSED=new e(2),e.PART_STARTED=new e(3),e.PART_FINISHED=new e(4),e})(),CS=(()=>{class e{constructor(e){this.value=e}static of(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;default:return $O.expectToBe(t,2),e.NONE}}static fromTurn(t){return t%2==0?e.ZERO:e.ONE}toString(){return"Player "+this.value}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return WO(this!==e.NONE,"Should not call getDefeatValue on Player.NONE!"),this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return WO(this!==e.NONE,"Should not call getVictoryValue on Player.NONE!"),this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){switch(this){case e.ZERO:return e.ONE;case e.ONE:return e.ZERO;default:return $O.expectToBe(this,e.NONE),e.NONE}}}return e.numberEncoder=YO.ofN(2,e=>e.value,t=>e.of(t)),e.ZERO=new e(0),e.ONE=new e(1),e.NONE=new e(2),e})(),ES=(()=>{class e{static rematchAccepted(e,t){return OS("RematchAccepted",{typeGame:e,partId:t})}static getPlayer(e){return CS.of($O.getNonNullable(e.data).player)}static getTypeGame(e){return $O.getNonNullable(e.data).typeGame}static getPartId(e){return $O.getNonNullable(e.data).partId}}return e.drawProposed=SS("DrawProposed"),e.drawAccepted=OS("DrawAccepted",{}),e.drawRefused=SS("DrawRefused"),e.takeBackAsked=SS("TakeBackAsked"),e.takeBackRefused=SS("TakeBackRefused"),e.takeBackAccepted=SS("TakeBackAccepted"),e.rematchProposed=SS("RematchProposed"),e.addTurnTime=SS("AddTurnTime"),e.addGlobalTime=SS("AddGlobalTime"),e})();function OS(e,t){return{code:e,data:t}}function SS(e){return t=>OS(e,{player:t.value})}let PS=(()=>{class e extends eS{constructor(t){super("joiners",t),this.afs=t,qO(e.VERBOSE,"JoinerDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(VO))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),IS=(()=>{class e{constructor(t){this.joinerDAO=t,qO(e.VERBOSE,"JoinerService.constructor")}observe(e){return this.observedJoinerId=e,this.joinerDAO.getObsById(e)}createInitialJoiner(t,n){var r=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.createInitialJoiner("+t+", "+n+")"),r.set(n,{candidates:[],chosenPlayer:null,firstPlayer:bS.RANDOM.value,partType:_S.STANDARD.value,partStatus:wS.PART_CREATED.value,maximalMoveDuration:_S.NORMAL_MOVE_DURATION,totalPartDuration:_S.NORMAL_PART_DURATION,creator:t})})()}joinGame(t,n){var r=this;return GO(function*(){qO(e.VERBOSE,"JoinerService.joinGame("+t+", "+n+")");const i=yield r.joinerDAO.read(t);if(i.isAbsent())return!1;const o=cS.copyImmutableArray(i.get().candidates);if(o.includes(n))throw new Error("JoinerService.joinGame was called by a user already in the game");return n===i.get().creator||(o[o.length]=n,yield r.joinerDAO.update(t,{candidates:o})),!0})()}cancelJoining(t){var n=this;return GO(function*(){if(qO(e.VERBOSE,"JoinerService.cancelJoining("+t+"); this.observedJoinerId = "+n.observedJoinerId),null==n.observedJoinerId)throw new Error("cannot cancel joining when not observing a joiner");const r=yield n.joinerDAO.read(n.observedJoinerId);if(!r.isAbsent()){const e=r.get(),i=cS.copyImmutableArray(e.candidates),o=i.indexOf(t);let s=e.chosenPlayer,a=e.partStatus;if(i.splice(o,1),s===t)s=null,a=wS.PART_CREATED.value;else if(-1===o)throw new Error("someone that was not candidate nor chosenPlayer just left the chat: "+t);return n.joinerDAO.update(n.observedJoinerId,{chosenPlayer:s,partStatus:a,candidates:i})}})()}updateCandidates(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.reviewConfig"),WO(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{candidates:t})})()}deleteJoiner(){var t=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.deleteJoiner(); this.observedJoinerId = "+t.observedJoinerId),WO(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.delete(t.observedJoinerId)})()}proposeConfig(t,n,r,i,o){var s=this;return GO(function*(){return qO(e.VERBOSE,{joinerService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:o}}),qO(e.VERBOSE,"this.followedJoinerId: "+s.observedJoinerId),WO(null!=s.observedJoinerId,"JoinerService is not observing a joiner"),s.joinerDAO.update(s.observedJoinerId,{partStatus:wS.CONFIG_PROPOSED.value,chosenPlayer:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:o,firstPlayer:i.value})})()}setChosenPlayer(t){return qO(e.VERBOSE,`JoinerService.setChosenPlayer(${t})`),WO(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{chosenPlayer:t})}reviewConfig(){var t=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.reviewConfig"),WO(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.update(t.observedJoinerId,{partStatus:wS.PART_CREATED.value})})()}reviewConfigRemoveChosenPlayerAndUpdateCandidates(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.reviewConfig"),WO(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{partStatus:wS.PART_CREATED.value,chosenPlayer:null,candidates:t})})()}acceptConfig(){return qO(e.VERBOSE,"JoinerService.acceptConfig"),WO(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{partStatus:wS.PART_STARTED.value})}createJoiner(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.create("+JSON.stringify(t)+")"),n.joinerDAO.create(t)})()}readJoinerById(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.readJoinerById("+t+")"),(yield n.joinerDAO.read(t)).get()})()}set(t,n){var r=this;return GO(function*(){return qO(e.VERBOSE,"JoinerService.set("+t+", "+JSON.stringify(n)+")"),r.joinerDAO.set(t,n)})()}updateJoinerById(t,n){var r=this;return GO(function*(){return qO(e.VERBOSE,{joinerService_updateJoinerById:{partId:t,update:n}}),r.joinerDAO.update(t,n)})()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(PS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),TS=(()=>{class e{constructor(t,n,r){this.partDAO=t,this.joinerService=n,this.chatService=r,this.followedPartId=XO.empty(),this.followedPartObs=XO.empty(),qO(e.VERBOSE,"GameService.constructor")}getPartValidity(e,t){var n=this;return GO(function*(){const r=yield n.partDAO.read(e);return r.isAbsent()?aS.failure("NONEXISTENT_PART"):r.get().typeGame===t?aS.SUCCESS:aS.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(t,n){return qO(e.VERBOSE,"GameService.createPart("+t+", "+n+")"),this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:n,playerZero:t,turn:-1,result:tS.UNACHIEVED.value,listMoves:[]})}createChat(t){return qO(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}createPartJoinerAndChat(t,n){var r=this;return GO(function*(){qO(e.VERBOSE,"GameService.createGame("+t+", "+n+")");const i=yield r.createUnstartedPart(t,n);return yield r.joinerService.createInitialJoiner(t,i),yield r.createChat(i),i})()}startGameWithConfig(t,n,r,i){qO(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));const o=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,o)}getStartingConfig(e){let t,n,r=bS.of(e.firstPlayer);return r===bS.RANDOM&&(r=Math.random()<.5?bS.CREATOR:bS.CHOSEN_PLAYER),r===bS.CREATOR?(t=e.creator,n=$O.getNonNullable(e.chosenPlayer)):(t=$O.getNonNullable(e.chosenPlayer),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:zl.a.firestore.FieldValue.serverTimestamp(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"GameService.deletePart("+t+")"),n.partDAO.delete(t)})()}acceptConfig(t,n){var r=this;return GO(function*(){return qO(e.VERBOSE,{gameService_acceptConfig:{partId:t,joiner:n}}),yield r.joinerService.acceptConfig(),r.startGameWithConfig(t,CS.ONE,0,n)})()}startObserving(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");qO(e.VERBOSE,"[start watching part "+t),this.followedPartId=XO.of(t),this.followedPartObs=XO.of(this.partDAO.getObsById(t)),this.followedPartSub=this.followedPartObs.get().subscribe(n)}resign(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:tS.RESIGN.value,request:null})}notifyTimeout(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:tS.TIMEOUT.value,request:null})}sendRequest(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}proposeDraw(e,t,n){return this.sendRequest(e,n,t,ES.drawProposed(n))}acceptDraw(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===CS.ZERO?tS.AGREED_DRAW_BY_ZERO:tS.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,t,n){return this.sendRequest(e,n,t,ES.drawRefused(n))}proposeRematch(e,t,n){return this.sendRequest(e,n,t,ES.rematchProposed(n))}acceptRematch(t,n,r){var i=this;return GO(function*(){qO(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t});const o=$O.getNonNullable(t.data),s=yield i.joinerService.readJoinerById(t.id);let a;a=o.playerZero===s.creator?bS.CHOSEN_PLAYER:bS.CREATOR;const c={...s,candidates:[],firstPlayer:a.value,partStatus:wS.PART_STARTED.value},l=yield i.joinerService.createJoiner(c),u=i.getStartingConfig(c),h={lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:tS.UNACHIEVED.value,listMoves:[],...u};return yield i.partDAO.set(l,h),yield i.createChat(l),i.sendRequest(t.id,r,n,ES.rematchAccepted(o.typeGame,l))})()}askTakeBack(e,t,n){return this.sendRequest(e,n,t,ES.takeBackAsked(n))}acceptTakeBack(e,t,n,r){var i=this;return GO(function*(){WO(n!==CS.NONE,"Illegal for observer to make request"),WO(ES.getPlayer($O.getNonNullable(t.data.request))!==n,"Illegal to accept your own request.");const o=ES.takeBackAccepted(n);let s=t.data.listMoves.slice(0,t.data.listMoves.length-1);s.length%2===n.value&&(s=s.slice(0,s.length-1));const a={request:o,listMoves:s,turn:s.length,lastUpdateTime:zl.a.firestore.FieldValue.serverTimestamp(),remainingMsForZero:$O.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:$O.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index;return yield i.partDAO.updateAndBumpIndex(e,n,c,a)})()}refuseTakeBack(e,t,n){WO(n!==CS.NONE,"Illegal for observer to make request");const r=ES.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}addGlobalTime(e,t,n,r){var i=this;return GO(function*(){WO(r!==CS.NONE,"Illegal for observer to make request");let o={request:ES.addGlobalTime(r.getOpponent())};return o=r===CS.ZERO?{...o,remainingMsForOne:$O.getNonNullable(n.remainingMsForOne)+3e5}:{...o,remainingMsForZero:$O.getNonNullable(n.remainingMsForZero)+3e5},yield i.partDAO.updateAndBumpIndex(e,r,t,o)})()}addTurnTime(e,t,n){var r=this;return GO(function*(){const i={request:ES.addTurnTime(e.getOpponent())};return yield r.partDAO.updateAndBumpIndex(n,e,t,i)})()}stopObserving(){qO(e.VERBOSE,"GameService.stopObserving();"),WO(this.followedPartId.isPresent(),"!!! GameService.stopObserving: we already stop watching doc"),qO(e.VERBOSE,"stopped watching joiner "+this.followedPartId+"]"),this.followedPartId=XO.empty(),this.followedPartSub.unsubscribe(),this.followedPartObs=XO.empty()}updateDBBoard(t,n,r,i,o,s,a,c){var l=this;return GO(function*(){qO(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:o,msToSubstract:i,notifyDraw:s,winner:a,loser:c}});const u=(yield l.partDAO.read(t)).get(),h=u.lastUpdate.index,d=u.turn+1,f=cS.copyImmutableArray(u.listMoves);f[f.length]=r;let p={listMoves:f,turn:d,request:null,lastUpdateTime:zl.a.firestore.FieldValue.serverTimestamp()};return p=l.updateScore(p,o),p=l.substractMs(p,u,i),null!=a?p={...p,winner:a,loser:c,result:tS.VICTORY.value}:!0===s&&(p={...p,result:tS.HARD_DRAW.value}),yield l.partDAO.updateAndBumpIndex(t,n,h,p)})()}updateScore(e,t){return void 0!==t?{...e,scorePlayerZero:t[0],scorePlayerOne:t[1]}:e}substractMs(e,t,n){return n[0]>0?{...e,remainingMsForZero:$O.getNonNullable(t.remainingMsForZero)-n[0]}:n[1]>0?{...e,remainingMsForOne:$O.getNonNullable(t.remainingMsForOne)-n[1]}:e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Zb(rS),r.Zb(IS),r.Zb(hS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class AS{static getNavigatorLanguage(){return navigator.language}static getLocale(){const e=(localStorage.getItem("locale")||AS.getNavigatorLanguage()||"fr").slice(0,2).toLowerCase();return["en","fr"].some(t=>t===e)?e:"fr"}}let kS=(()=>{class e{constructor(){}changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return XO.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return AS.getLocale()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),NS=(()=>{class e{constructor(e,t){this.document=e,this.userSettingsService=t,this.availableThemes=["dark","light"];const n=this.getStoredTheme();n.isPresent()?this.loadTheme(n.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const t=e.get();if(this.availableThemes.some(e=>e===t))return XO.of(t)}return XO.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{const n=this.document.createElement("link");n.id="theme",n.rel="stylesheet",n.href=`${e}`,t.appendChild(n)}}getTheme(){return this.theme}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(s),r.Zb(kS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var MS={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},xS={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},RS={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},DS={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},LS={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},BS={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]};function FS(e){return(FS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function US(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){jS(e,t,n[t])})}return e}function VS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var zS={},HS={};try{"undefined"!=typeof window&&(zS=window),"undefined"!=typeof document&&(HS=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(aO){}var GS=(zS.navigator||{}).userAgent,$S=void 0===GS?"":GS,qS=zS,WS=HS,ZS=!!WS.documentElement&&!!WS.head&&"function"==typeof WS.addEventListener&&"function"==typeof WS.createElement,QS=(~$S.indexOf("MSIE")||$S.indexOf("Trident/"),[1,2,3,4,5,6,7,8,9,10]),YS=QS.concat([11,12,13,14,15,16,17,18,19,20]),KS={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},JS=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",KS.GROUP,KS.SWAP_OPACITY,KS.PRIMARY,KS.SECONDARY].concat(QS.map(function(e){return"".concat(e,"x")})).concat(YS.map(function(e){return"w-".concat(e)})),qS.FontAwesomeConfig||{});WS&&"function"==typeof WS.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=VS(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=WS.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(JS[n]=r)});var XS=US({},{familyPrefix:"fa",replacementClass:"svg-inline--fa",autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},JS);XS.autoReplaceSvg||(XS.observeMutations=!1);var eP=US({},XS);qS.FontAwesomeConfig=eP;var tP=qS||{};tP.___FONT_AWESOME___||(tP.___FONT_AWESOME___={}),tP.___FONT_AWESOME___.styles||(tP.___FONT_AWESOME___.styles={}),tP.___FONT_AWESOME___.hooks||(tP.___FONT_AWESOME___.hooks={}),tP.___FONT_AWESOME___.shims||(tP.___FONT_AWESOME___.shims=[]);var nP=tP.___FONT_AWESOME___,rP=[];ZS&&((WS.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(WS.readyState)||WS.addEventListener("DOMContentLoaded",function e(){WS.removeEventListener("DOMContentLoaded",e),rP.map(function(e){return e()})}));var iP,oP=function(){},sP="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,aP="undefined"==typeof setImmediate?setTimeout:setImmediate,cP=[];function lP(){for(var e=0;e<cP.length;e++)cP[e][0](cP[e][1]);cP=[],iP=!1}function uP(e,t){cP.push([e,t]),iP||(iP=!0,aP(lP,0))}function hP(e){var t=e.owner,n=t._state,r=t._data,i=e[n],o=e.then;if("function"==typeof i){n="fulfilled";try{r=i(r)}catch(aO){gP(o,aO)}}dP(o,r)||("fulfilled"===n&&fP(o,r),"rejected"===n&&gP(o,r))}function dP(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===FS(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?pP(e,r):fP(e,r))},function(t){n||(n=!0,gP(e,t))}),!0}}catch(aO){return n||gP(e,aO),!0}return!1}function fP(e,t){e!==t&&dP(e,t)||pP(e,t)}function pP(e,t){"pending"===e._state&&(e._state="settled",e._data=t,uP(yP,e))}function gP(e,t){"pending"===e._state&&(e._state="settled",e._data=t,uP(vP,e))}function mP(e){e._then=e._then.forEach(hP)}function yP(e){e._state="fulfilled",mP(e)}function vP(e){e._state="rejected",mP(e),!e._handled&&sP&&global.process.emit("unhandledRejection",e._data,e)}function bP(e){global.process.emit("rejectionHandled",e)}function _P(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(this instanceof _P==0)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){gP(t,e)}try{e(function(e){fP(t,e)},n)}catch(aO){n(aO)}}(e,this)}_P.prototype={constructor:_P,_state:"pending",_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(oP),fulfilled:e,rejected:t};return!t&&!e||this._handled||(this._handled=!0,"rejected"===this._state&&sP&&uP(bP,this)),"fulfilled"===this._state||"rejected"===this._state?uP(hP,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},_P.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new _P(function(t,n){var r=[],i=0;function o(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var s,a=0;a<e.length;a++)(s=e[a])&&"function"==typeof s.then?s.then(o(a),n):r[a]=s;i||t(r)})},_P.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new _P(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},_P.resolve=function(e){return e&&"object"===FS(e)&&e.constructor===_P?e:new _P(function(t){t(e)})},_P.reject=function(e){return new _P(function(t,n){n(e)})};var wP={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function CP(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function EP(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function OP(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function SP(e){return e.size!==wP.size||e.x!==wP.x||e.y!==wP.y||e.rotate!==wP.rotate||e.flipX||e.flipY}function PP(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),s="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(o," ").concat(s)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var IP={x:0,y:0,width:"100%",height:"100%"};function TP(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function AP(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,o=e.iconName,s=e.transform,a=e.symbol,c=e.title,l=e.maskId,u=e.titleId,h=e.extra,d=e.watchable,f=void 0!==d&&d,p=r.found?r:n,g=p.width,m=p.height,y="fak"===i,v=y?"":"fa-w-".concat(Math.ceil(g/m*16)),b=[eP.replacementClass,o?"".concat(eP.familyPrefix,"-").concat(o):"",v].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:US({},h.attributes,{"data-prefix":i,"data-icon":o,class:b,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(g," ").concat(m)})},w=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(g/m*16*.0625,"em")}:{};f&&(_.attributes["data-fa-i2svg"]=""),c&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(u||CP())},children:[c]});var C=US({},_,{prefix:i,iconName:o,main:n,mask:r,maskId:l,transform:s,symbol:a,styles:US({},w,h.styles)}),E=r.found&&n.found?function(e){var t,n=e.children,r=e.attributes,i=e.main,o=e.mask,s=e.maskId,a=i.icon,c=o.icon,l=PP({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),u={tag:"rect",attributes:US({},IP,{fill:"white"})},h=a.children?{children:a.children.map(TP)}:{},d={tag:"g",attributes:US({},l.inner),children:[TP(US({tag:a.tag,attributes:US({},a.attributes,l.path)},h))]},f={tag:"g",attributes:US({},l.outer),children:[d]},p="mask-".concat(s||CP()),g="clip-".concat(s||CP()),m={tag:"mask",attributes:US({},IP,{id:p,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[u,f]},y={tag:"defs",children:[{tag:"clipPath",attributes:{id:g},children:(t=c,"g"===t.tag?t.children:[t])},m]};return n.push(y,{tag:"rect",attributes:US({fill:"currentColor","clip-path":"url(#".concat(g,")"),mask:"url(#".concat(p,")")},IP)}),{children:n,attributes:r}}(C):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,o=OP(e.styles);if(o.length>0&&(n.style=o),SP(i)){var s=PP({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:US({},s.outer),children:[{tag:"g",attributes:US({},s.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:US({},r.icon.attributes,s.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(C),O=E.attributes;return C.children=E.children,C.attributes=O,a?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:US({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(eP.familyPrefix,"-").concat(t):r}),children:n}]}]}(C):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,o=e.styles,s=e.transform;if(SP(s)&&n.found&&!r.found){var a={x:n.width/n.height/2,y:.5};i.style=OP(US({},o,{"transform-origin":"".concat(a.x+s.x/16,"em ").concat(a.y+s.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(C)}var kP=function(e,t,n,r){var i,o,s,a=Object.keys(e),c=a.length,l=void 0!==r?function(e,t){return function(n,r,i,o){return e.call(t,n,r,i,o)}}(t,r):t;for(void 0===n?(i=1,s=e[a[0]]):(i=0,s=n);i<c;i++)s=l(s,e[o=a[i]],o,e);return s};function NP(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,o=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof nP.hooks.addPack||i?nP.styles[e]=US({},nP.styles[e]||{},o):nP.hooks.addPack(e,o),"fas"===e&&NP("fa",t)}var MP=nP.styles,xP=nP.shims,RP=function(){var e=function(e){return kP(MP,function(t,n,r){return t[r]=kP(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in MP;kP(xP,function(e,n){var r=n[1];return"far"!==r||t||(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function DP(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function LP(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,o=void 0===i?[]:i;return"string"==typeof e?EP(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(EP(e[n]),'" ')},"").trim()}(r),">").concat(o.map(LP).join(""),"</").concat(t,">")}function BP(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}RP(),(BP.prototype=Object.create(Error.prototype)).constructor=BP;var FP={fill:"currentColor"},jP={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},UP=(US({},FP,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),US({},jP,{attributeName:"opacity"}));function VP(e){var t=e[0],n=e[1],r=VS(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(eP.familyPrefix,"-").concat(KS.GROUP)},children:[{tag:"path",attributes:{class:"".concat(eP.familyPrefix,"-").concat(KS.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(eP.familyPrefix,"-").concat(KS.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}function zP(){eP.autoAddCss&&!WP&&(function(e){if(e&&ZS){var t=WS.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=WS.head.childNodes,r=null,i=n.length-1;i>-1;i--){var o=n[i],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(r=o)}WS.head.insertBefore(t,r)}}(function(){var e="svg-inline--fa",t=eP.familyPrefix,n=eP.replacementClass,r='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if("fa"!==t||n!==e){var i=new RegExp("\\.".concat("fa","\\-"),"g"),o=new RegExp("\\--".concat("fa","\\-"),"g"),s=new RegExp("\\.".concat(e),"g");r=r.replace(i,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(s,".".concat(n))}return r}()),WP=!0)}function HP(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return LP(e)})}}),Object.defineProperty(e,"node",{get:function(){if(ZS){var t=WS.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function GP(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return DP(qP.definitions,n,r)||DP(nP.styles,n,r)}US({},FP,{cx:"256",cy:"364",r:"28"}),US({},jP,{attributeName:"r",values:"28;14;28;28;14;28;"}),US({},UP,{values:"1;0;1;1;0;1;"}),US({},FP,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),US({},UP,{values:"1;0;0;0;0;1;"}),US({},FP,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),US({},UP,{values:"0;0;1;1;0;0;"});var $P,qP=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.definitions={}}var t;return(t=[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=US({},e.definitions[t]||{},i[t]),NP(t,i[t]),RP()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,o=r.iconName,s=r.icon;e[i]||(e[i]={}),e[i][o]=s}),e}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}()),WP=!1,ZP=($P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?wP:n,i=t.symbol,o=void 0!==i&&i,s=t.mask,a=void 0===s?null:s,c=t.maskId,l=void 0===c?null:c,u=t.title,h=void 0===u?null:u,d=t.titleId,f=void 0===d?null:d,p=t.classes,g=void 0===p?[]:p,m=t.attributes,y=void 0===m?{}:m,v=t.styles,b=void 0===v?{}:v;if(e){var _=e.prefix,w=e.iconName,C=e.icon;return HP(US({type:"icon"},e),function(){return zP(),eP.autoA11y&&(h?y["aria-labelledby"]="".concat(eP.replacementClass,"-title-").concat(f||CP()):(y["aria-hidden"]="true",y.focusable="false")),AP({icons:{main:VP(C),mask:a?VP(a.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:w,transform:US({},wP,r),symbol:o,title:h,maskId:l,titleId:f,extra:{attributes:y,styles:b,classes:g}})})}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:GP(e||{}),r=t.mask;return r&&(r=(r||{}).icon?r:GP(r||{})),$P(n,US({},t,{mask:r}))});const QP=["*"];let YP=(()=>{class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null,this.globalLibrary=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(r.Hb)({factory:function(){return new e},token:e,providedIn:"root"}),e})(),KP=(()=>{class e{constructor(){this.definitions={}}addIcons(...e){for(const t of e)t.prefix in this.definitions||(this.definitions[t.prefix]={}),this.definitions[t.prefix][t.iconName]=t}addIconPacks(...e){for(const t of e){const e=Object.keys(t).map(e=>t[e]);this.addIcons(...e)}}getIconDefinition(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(r.Hb)({factory:function(){return new e},token:e,providedIn:"root"}),e})();const JP=e=>{const t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip,[`fa-${e.size}`]:null!==e.size,[`fa-rotate-${e.rotate}`]:null!==e.rotate,[`fa-pull-${e.pull}`]:null!==e.pull,[`fa-stack-${e.stackItemSize}`]:null!=e.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let XP=(()=>{class e{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.Gb({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[r.zb]}),e})(),eI=(()=>{class e{constructor(e,t){this.renderer=e,this.elementRef=t}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.E),r.Lb(r.l))},e.\u0275cmp=r.Fb({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[r.zb],ngContentSelectors:QP,decls:1,vars:0,template:function(e,t){1&e&&(r.lc(),r.kc(0))},encapsulation:2}),e})(),tI=(()=>{class e{constructor(e,t,n,r,i){this.sanitizer=e,this.config=t,this.iconLibrary=n,this.stackItem=r,this.classes=[],null!=i&&null==r&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let t=null;if(t=null==this.icon?this.config.fallbackIcon:this.icon,e){const e=this.findIconDefinition(t);if(null!=e){const t=this.buildParams();this.renderIcon(e,t)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const t=((e,t)=>{return void 0!==(n=e).prefix&&void 0!==n.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"==typeof e?{prefix:t,iconName:e}:void 0;var n})(e,this.config.defaultPrefix);if("icon"in t)return t;const n=this.iconLibrary.getIconDefinition(t.prefix,t.iconName);if(null!=n)return n;const r=GP(t);if(null!=r){const e="Global icon library is deprecated. Consult https://github.com/FortAwesome/angular-fontawesome/blob/master/UPGRADING.md for the migration instructions.";if("unset"===this.config.globalLibrary)console.error("FontAwesome: "+e);else if(!this.config.globalLibrary)throw new Error(e);return r}return(e=>{throw new Error(`Could not find icon with iconName=${e.iconName} and prefix=${e.prefix} in the icon library.`)})(t),null}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[...JP(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,t){const n=ZP(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Ye),r.Lb(YP),r.Lb(KP),r.Lb(XP,8),r.Lb(eI,8))},e.\u0275cmp=r.Fb({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(r.Tb("innerHTML",t.renderedIconHTML,r.xc),r.Cb("title",t.title))},inputs:{classes:"classes",icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",transform:"transform",a11yRole:"a11yRole"},features:[r.zb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),nI=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({}),e})();function rI(e,t){if(1&e){const e=r.Rb();r.Ob(0),r.Qb(1,"div",9),r.Qb(2,"a",10),r.Cc(3),r.Pb(),r.Qb(4,"div",12),r.Qb(5,"a",24),r.cc("click",function(){return r.wc(e),r.fc().logout()}),r.Ub(6,25),r.Pb(),r.Pb(),r.Pb(),r.Nb()}if(2&e){const e=r.fc();r.Bb(3),r.Dc(e.username)}}const iI=function(){return["/register"]},oI=function(){return["/login"]};function sI(e,t){1&e&&(r.Qb(0,"div",26),r.Qb(1,"a",27),r.Qb(2,"strong"),r.Ub(3,28),r.Pb(),r.Pb(),r.Qb(4,"a",29),r.Ub(5,30),r.Pb(),r.Pb()),2&e&&(r.Bb(1),r.mc("routerLink",r.qc(2,iI)),r.Bb(3),r.mc("routerLink",r.qc(3,oI)))}const aI=function(){return["/"]},cI=function(){return["/play"]},lI=function(){return["/lobby"]},uI=function(){return["/local"]},hI=function(){return["/tutorial"]},dI=function(){return["/settings"]};let fI=(()=>{class e{constructor(e,t){this.router=e,this.authenticationService=t,this.username="connecting...",this.faCog=xS,this.showMenu=!1}ngOnInit(){this.userSub=this.authenticationService.getUserObs().subscribe(e=>{this.username=e.username.isPresent()?e.username.get():e.email.isPresent()?e.email.get():""})}logout(){var e=this;return GO(function*(){yield e.authenticationService.disconnect(),yield e.router.navigate(["/"])})()}ngOnDestroy(){this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(vS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){let e,t,n,r,i,o,s,a,c,l,u;return e=$localize`Home`,t=$localize`Play online`,n=$localize`Create a game`,r=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,s=$localize`Learn the rules`,a=$localize`Settings`,c=$localize`Log out`,l=$localize`Register`,u=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],e,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],t,[1,"navbar-dropdown"],n,r,i,o,s,[1,"navbar-end"],["data-tooltip",a,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["connect",""],["id","logout",1,"navbar-item",3,"click"],c,[1,"buttons"],[1,"button","is-primary",3,"routerLink"],l,[1,"button","is-light",3,"routerLink"],u]},template:function(e,t){if(1&e&&(r.Qb(0,"nav",0),r.Qb(1,"div",1),r.Qb(2,"a",2),r.Mb(3,"img",3),r.Pb(),r.Qb(4,"a",4),r.cc("click",function(){return t.showMenu=!t.showMenu}),r.Mb(5,"span",5),r.Mb(6,"span",5),r.Mb(7,"span",5),r.Pb(),r.Pb(),r.Qb(8,"div",6),r.cc("click",function(){return t.showMenu=!t.showMenu}),r.Qb(9,"div",7),r.Qb(10,"a",2),r.Ub(11,8),r.Pb(),r.Qb(12,"div",9),r.Qb(13,"a",10),r.Ub(14,11),r.Pb(),r.Qb(15,"div",12),r.Qb(16,"a",2),r.Ub(17,13),r.Pb(),r.Qb(18,"a",2),r.Ub(19,14),r.Pb(),r.Pb(),r.Pb(),r.Qb(20,"div",9),r.Qb(21,"a",10),r.Ub(22,15),r.Pb(),r.Qb(23,"div",12),r.Qb(24,"a",2),r.Ub(25,16),r.Pb(),r.Qb(26,"a",2),r.Ub(27,17),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(28,"div",18),r.Qb(29,"a",19),r.Mb(30,"fa-icon",20),r.Pb(),r.Qb(31,"div",21),r.Ac(32,rI,7,1,"ng-container",22),r.Ac(33,sI,6,4,"ng-template",null,23,r.Bc),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.vc(34);r.Bb(2),r.mc("routerLink",r.qc(12,aI)),r.Bb(2),r.mc("ngClass",t.showMenu?"is-active":""),r.Bb(4),r.mc("ngClass",t.showMenu?"is-active":""),r.Bb(2),r.mc("routerLink",r.qc(13,aI)),r.Bb(6),r.mc("routerLink",r.qc(14,cI)),r.Bb(2),r.mc("routerLink",r.qc(15,lI)),r.Bb(6),r.mc("routerLink",r.qc(16,uI)),r.Bb(2),r.mc("routerLink",r.qc(17,hI)),r.Bb(3),r.mc("routerLink",r.qc(18,dI)),r.Bb(1),r.mc("icon",t.faCog),r.Bb(2),r.mc("ngIf",t.username)("ngIfElse",e)}},directives:[Zs,le,tI,fe],encapsulation:2}),e})(),pI=(()=>{class e{constructor(e){this._themeService=e}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(NS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container","mt-2"]],template:function(e,t){1&e&&(r.Mb(0,"app-header"),r.Qb(1,"main",0),r.Mb(2,"router-outlet"),r.Pb())},directives:[fI,Ys],encapsulation:2}),e})();class gI{constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}}class mI extends gI{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class yI{of(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return iS.success(n);return iS.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?iS.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):iS.failure(`Invalid delta for direction: ${e}, ${t}`)}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return iS.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return iS.failure(`Invalid int direction: ${e}`)}}}class vI extends ZO{encode(e){return e.toString()}decode(e){return WO("string"==typeof e,"Invalid encoded direction"),bI.factory.fromString(e).get()}}let bI=(()=>{class e extends mI{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return e.factory.of(-this.x,-this.y).get()}}return e.UP=new e(0,-1),e.UP_RIGHT=new e(1,-1),e.RIGHT=new e(1,0),e.DOWN_RIGHT=new e(1,1),e.DOWN=new e(0,1),e.DOWN_LEFT=new e(-1,1),e.LEFT=new e(-1,0),e.UP_LEFT=new e(-1,-1),e.factory=new class extends yI{constructor(){super(...arguments),this.all=[e.UP,e.UP_RIGHT,e.RIGHT,e.DOWN_RIGHT,e.DOWN,e.DOWN_LEFT,e.LEFT,e.UP_LEFT]}},e.DIRECTIONS=e.factory.all,e.encoder=new vI,e})();class _I extends ZO{encode(e){return e.toString()}decode(e){return WO("string"==typeof e,"Invalid encoded orthogonal"),wI.factory.fromString(e).get()}}let wI=(()=>{class e extends mI{constructor(e,t){super(e,t)}getOpposite(){return e.factory.of(-this.x,-this.y).get()}}return e.UP=new e(0,-1),e.RIGHT=new e(1,0),e.DOWN=new e(0,1),e.LEFT=new e(-1,0),e.factory=new class extends yI{constructor(){super(...arguments),this.all=[e.UP,e.RIGHT,e.DOWN,e.LEFT]}of(t,n){return 0===t&&-1===n?iS.success(e.UP):1===t&&0===n?iS.success(e.RIGHT):0===t&&1===n?iS.success(e.DOWN):-1===t&&0===n?iS.success(e.LEFT):iS.failure("Invalid orthogonal from x and y")}},e.ORTHOGONALS=e.factory.all,e.encoder=new _I,e})(),CI=(()=>{class e{constructor(e,t){this.x=e,this.y=t}static numberEncoder(t,n){return YO.tuple([YO.numberEncoder(t),YO.numberEncoder(n)],e=>[e.x,e.y],t=>new e(t[0],t[1]))}getNext(t,n){return new e(this.x+(n=null==n?1:n)*t.x,this.y+n*t.y)}getPrevious(e,t){return this.getNext(e,-(t=null==t?1:t))}getLeft(t){return new e(this.x+t.y,this.y+-t.x)}getRight(t){return new e(this.x+-t.y,this.y+t.x)}getOpposite(){return new e(-this.x,-this.y)}getCopy(){return new e(this.x,this.y)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return bI.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(t){return new e(t.x-this.x,t.y-this.y)}getMinimalVectorToward(e){return this.getVectorToward(e).toVector()}getCoordsToward(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const r=[];for(;!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}toVector(){const t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n);let i=this.x,o=this.y,s=2;for(;s<=r;)i%s==0&&o%s==0?(i/=s,o/=s):s++;return new e(i,o)}isBetween(e,t){const n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}}return e.encoder=new class extends ZO{encode(e){return{x:e.x,y:e.y}}decode(t){const n=t;return WO(null!=n.x&&"number"==typeof n.x&&null!=n.y&&"number"==typeof n.y,"Invalid encoded coord"),new e(n.x,n.y)}},e})();var EI=n("S0Ta");let OI=(()=>{class e{constructor(){}infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}message(e,t){Object(EI.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),SI=(()=>{class e{constructor(e){this.messageDisplayer=e,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=XO.empty(),this.imagesLocation="assets/images/"}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?aS.SUCCESS:(this.messageDisplayer.gameMessage(e),aS.failure(e))}cancelMoveAttempt(){}getPlayerClass(e){switch(e){case CS.ZERO:return"player0";case CS.ONE:return"player1";default:return $O.expectToBe(e,CS.NONE),""}}pass(){return $O.handleError("GameComponent.pass() called on a game that does not redefine it"),Object(Un.a)(aS.failure("GameComponent.pass() called on a game that does not redefine it")).toPromise()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),PI=(()=>{class e extends SI{getHexaCoordsBy(e,t){const n=new CI(e,t);return this.getHexaCoordsAt(n)}getHexaCoordsAt(e){let t="";const n=this.hexaLayout.getHexaCoordsAt(e);for(const r of n)t+=r.x+" "+r.y+" ";return t+=n[0].x+" "+n[0].y,t}getCenterBy(e,t){const n=new CI(e,t);return this.getCenterAt(n)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return e.\u0275fac=function(t){return II(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],features:[r.yb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();const II=r.Sb(PI);let TI=(()=>{class e{constructor(e){this.value=e}static from(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.NONE.value:return e.NONE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){switch(t){case CS.ZERO:return e.ZERO;case CS.ONE:return e.ONE;default:throw new Error("FourStatePiece.ofPlayer can only be called with Player.ZERO and Player.ONE.")}}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===e.ZERO||this===e.ONE}}return e.ZERO=new e(CS.ZERO.value),e.ONE=new e(CS.ONE.value),e.EMPTY=new e(CS.NONE.value),e.NONE=new e(3),e})();class AI extends YO{maxValue(){return 5}encodeNumber(e){switch(e){case kI.UP:return 0;case kI.UP_RIGHT:return 1;case kI.RIGHT:return 2;case kI.DOWN:return 3;case kI.DOWN_LEFT:return 4;default:return 5}}decodeNumber(e){return WO(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),kI.factory.all[e]}}let kI=(()=>{class e extends mI{constructor(e,t){super(e,t)}static getAngle(t){switch(t){case e.UP:return 0;case e.UP_RIGHT:return 60;case e.RIGHT:return 120;case e.DOWN:return 180;case e.DOWN_LEFT:return 240;default:return $O.expectToBe(t,e.LEFT),300}}getOpposite(){return e.factory.of(-this.x,-this.y).get()}}return e.UP=new e(0,-1),e.LEFT=new e(-1,0),e.UP_RIGHT=new e(1,-1),e.DOWN_LEFT=new e(-1,1),e.RIGHT=new e(1,0),e.DOWN=new e(0,1),e.factory=new class extends yI{constructor(){super(...arguments),this.all=[e.UP,e.UP_RIGHT,e.RIGHT,e.DOWN,e.DOWN_LEFT,e.LEFT]}},e.encoder=new AI,e})();class NI{constructor(e,t,n){this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new CI(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new CI(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaCoordsAt(e){const t=this.getCenterAt(e),n=[];for(let r=0;r<6;r+=1){const e=this.getCornerOffset(r);n.push(new CI(t.x+e.x,t.y+e.y))}return n}}class MI{}let xI=(()=>{class e extends MI{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}return e.INSTANCE=new e,e})(),RI=(()=>{class e extends MI{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,r)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}return e.INSTANCE=new e,e})(),DI=(()=>{class e{}return e.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,e.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,e.CANNOT_SELF_CAPTURE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,e.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,e.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,e.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,e.MUST_PASS=()=>$localize`You must pass your turn.`,e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,e.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,e})();class LI{constructor(e,t){this.ruler=e,this.name=t}toString(){return this.name}}class BI{constructor(e){this.value=e}static fromWinner(e){return new BI(e===CS.NONE?0:e.getVictoryValue())}toString(){return""+this.value}}class FI{static toComparableObjectSet(e){const t=[];return e.forEach(e=>{t.some(t=>t.equals(e))||t.push(e)}),t}static toComparableSet(e){const t=[];return e.forEach(e=>{t.some(t=>JO(t,e))||t.push(e)}),t}}class jI{constructor(e){this.values=void 0===e?[]:FI.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===e.contains(this.values[t]))return!1;return!0}toString(){let e="";for(const t of this.values)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}union(e){for(const t of e.getCopy())this.add(t)}contains(e){for(const t of this.values)if(JO(t,e))return!0;return!1}size(){return this.values.length}get(e){return this.values[e]}getCopy(){const e=[];for(const t of this.values)e.push(t);return e}removeAndCopy(e){const t=this.getCopy().filter(t=>!1===JO(t,e));return new jI(t)}}class UI{constructor(e){this.turn=e}getCurrentPlayer(){return CS.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?CS.ZERO:CS.ONE}}class VI extends UI{constructor(e,t){super(t),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new CI(e,t))}forEachCoord(e){for(const[t,n]of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const r=new CI(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}getCopiedBoard(){return cS.copyBiArray(this.board)}}class zI extends VI{static getInitialState(){const e=TI.EMPTY,t=TI.NONE,n=TI.ZERO,r=TI.ONE;return new zI([[t,t,t,t,r,r,r,r,r],[t,t,t,r,r,r,r,r,r],[t,t,e,e,r,r,r,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}isInBoard(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==TI.NONE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===TI.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===TI.ONE&&(e[0]=e[0]-1);return e}}class HI{}class GI extends HI{constructor(e,t){super(),this.coord=new CI(e,t)}}let $I=(()=>{class e extends GI{constructor(e,t,n){if(super(e.x,e.y),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}static fromSingleCoord(t,n){try{return iS.success(new e(t,n,XO.empty()))}catch(aO){return iS.failure(aO.message)}}static fromDoubleCoord(t,n,r){const i=[t,n];cS.sortByDescending(i,e.sortCoord);const o=i[1].getDirectionToward(i[0]).get(),s=kI.factory.fromDelta(o.x,o.y);if(s.isFailure())return iS.failure("Invalid direction");const a=s.get();return i[1].getDistance(i[0])>2?iS.failure("Distance between first coord and last coord is too great"):a.equals(r)?e.fromSingleCoord(i[1],r):a.getOpposite().equals(r)?e.fromSingleCoord(i[0],r):iS.success(new e(i[1],r,XO.of(i[0])))}static sortCoord(e){return 9*e.y+e.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}return e.encoder=new class extends YO{maxValue(){return 104831}encodeNumber(e){const t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;{const n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}}decodeNumber(t){const n=t%8;t=(t-n)/8;const r=kI.factory.fromInt(n).get(),i=t%9,o=(t=(t-i)/9)%9;t=(t-o)/9;const s=new CI(o,i);if(0===t)return e.fromSingleCoord(s,r).get();{const n=(t=(t-1)/2)%9,i=(t=(t-n)/9)%9;t=(t-i)/9;const o=new CI(i,n);return e.fromDoubleCoord(s,o,r).get()}}},e})();var qI=function(e){return e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT",e}({});class WI{constructor(){this.map=[],this.isImmutable=!1}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(JO(t.key,e))return XO.of(t.value);return XO.empty()}forEach(e){for(let t=0;t<this.map.length;t++)e(this.getByIndex(t))}getByIndex(e){return this.map[e]}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(JO(n.key,e)){const e=n.value;return n.value=t,XO.of(e)}return this.map.push({key:e,value:t}),XO.empty()}containsKey(e){return this.map.some(t=>JO(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}getKeySet(){return new jI(this.listKeys())}filter(e){const t=new WI;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(JO(this.map[t].key,e)){const e=this.map[t].value,n=this.map.slice(0,t),r=this.map.slice(t+1);return this.map=n.concat(r),e}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(let r=0;r<t.size();r++){const n=t.get(r),i=this.get(n).get(),o=e.get(n);if(WO(o.isPresent(),"value is absent in a map even though its key is present!"),!1===JO(i,o.get()))return!1}return!0}}class ZI extends WI{reverse(){const e=new ZI;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const r=new jI;r.add(t),e.set(n,r)}}return e}}let QI=(()=>{class e{}return e.createdNodes=0,e.minimaxTime=0,e})(),YI=(()=>{class e{constructor(t,n=XO.empty(),r=XO.empty(),i){if(this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=XO.empty(),this.hopedValue=new WI,this.ownValue=new WI,this.possibleMoves=new WI,this.ownValue=new WI,null!=i){const e=i.getBoardValue(this);this.ownValue.set(i.name,e),this.hopedValue.set(i.name,e.value)}QI.createdNodes++,qO(e.VERBOSE||!1,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(qO(e.VERBOSE||!1,"VICTORY"),qI.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(qO(e.VERBOSE||!1,"PRE_VICTORY_MIN"),qI.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(qO(e.VERBOSE||!1,"PRE_VICTORY_MAX"),qI.PRE_VICTORY):(qO(e.VERBOSE||!1,"DEFAULT"),qI.DEFAULT)}findBestMove(e,t,n=!1,r=!0){const i=(new Date).getTime();let o=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),e--;return QI.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,n,r,i,o,s){if(t<1)return qO(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return qO(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const a=this.getPossibleMoves(i);WO(a.length>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=XO.of([]));let c=[];const l=this.gameState.getCurrentPlayer();let u=l===CS.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const h=l===CS.ZERO?(e,t)=>e<t:(e,t)=>e>t;for(const e of a){const a=this.getOrCreateChild(e,i).alphaBeta(t-1,n,r,i,o,s),d=a.getHopedValue(i);if(h(d,u)||0===c.length?(u=d,c=[a]):d===u&&c.push(a),s&&h(u,l===CS.ZERO?n:r))break;l===CS.ZERO?r=Math.min(u,r):n=Math.max(u,n)}let d;d=o?c[Math.floor(Math.random()*c.length)]:c[0];const f=d.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),f),d}getPossibleMoves(e){const t=this.possibleMoves.get(e.name);if(t.isAbsent()){const t=e.getListMoves(this);return this.possibleMoves.set(e.name,new jI(t)),t}return t.get().getCopy()}getOrCreateChild(t,n){let r=this.getSonByMove(t);if(r.isAbsent()){const i=n.ruler.isLegal(t,this.gameState);WO(i.isSuccess(),"The minimax has accepted an illegal move, this should not happen.");const o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=XO.of(new e(o,XO.of(this),XO.of(t),n)),this.childs.get().push(r.get())}return r.get()}getSonByMove(e){WO(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const t of this.childs.get())if(t.move.isPresent()&&t.move.equalsValue(e))return XO.of(t);return XO.empty()}getInitialNode(){let e=this;for(;e.mother.isPresent();)e=e.mother.get();return e}getHopedValue(e){return this.hopedValue.get(e.name).get()}getOwnValue(e){const t=this.ownValue.get(e.name);if(t.isAbsent()){const t=e.getBoardValue(this);return this.ownValue.set(e.name,t),t}return t.get()}myToString(){let e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let e=this.childs.get().length;for(const t of this.childs.get())e+=t.countDescendants();return e}}return e.VERBOSE=!1,e.minimaxes=new WI,e})(),KI=(()=>{class e{constructor(e,t){this.isEndGame=e,this.winner=t}static getVictory(t){return WO(t!==CS.NONE,"getVictory called with Player.NONE"),t===CS.ZERO?e.ZERO_WON:e.ONE_WON}static getDefeat(t){return WO(t!==CS.NONE,"getVictory called with Player.NONE"),t===CS.ZERO?e.ONE_WON:e.ZERO_WON}toBoardValue(){return this.winner!==CS.NONE?this.winner.getVictoryValue():0}}return e.ZERO_WON=new e(!0,CS.ZERO),e.ONE_WON=new e(!0,CS.ONE),e.DRAW=new e(!0,CS.NONE),e.ONGOING=new e(!1,CS.NONE),e})();class JI{constructor(e){this.stateType=e,this.setInitialBoard()}choose(e){qO(!1,"Rules.choose: "+e.toString()+" was proposed");const t=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){qO(!1,"Rules.choose: current node has moves");const n=this.node.getSonByMove(e);if(n.isPresent())return WO(t.isSuccess(),"Rules.choose: Move is illegal: "+t.getReasonOr("")),qO(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=n.get(),!0}if(qO(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),t.isFailure())return qO(!1,"Rules.choose: Move is illegal: "+t.getReason()),!1;qO(!1,"Rules.choose: Move is legal, let's apply it");const n=this.applyLegalMove(e,this.node.gameState,t.get()),r=new YI(n,XO.of(this.node),XO.of(e));return this.node=r,!0}setInitialBoard(){if(null==this.node){const e=this.stateType.getInitialState();YI.ruler=this,this.node=new YI(e)}else this.node=this.node.getInitialNode()}applyMoves(e,t,n){let r=0;for(const i of e){const e=n(i),o=this.isLegal(e,t);WO(o.isSuccess(),"Can't create state from invalid moves ("+r+"): "+o.toString()+"."),t=this.applyLegalMove(e,t,o.get()),r++}return t}}let XI=(()=>{class e{}return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,e.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,e.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,e.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,e.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,e.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,e})();class eT extends JI{static isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toFailedFallible():e.isSingleCoord()?eT.isLegalPush(e,t):eT.isLegalSideStep(e,t)}static getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?aS.failure(DI.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===TI.ofPlayer(t.getCurrentOpponent())?aS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):aS.SUCCESS}static isLegalPush(e,t){let n=1,r=e.coord.getNext(e.dir);const i=TI.ofPlayer(t.getCurrentPlayer()),o=TI.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;n<=3&&t.isOnBoard(r)&&t.getPieceAt(r)===i;)n++,r=r.getNext(e.dir);return n>3?iS.failure(XI.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(r)?iS.success(s):(s[r.y][r.x]=i,t.getPieceAt(r)===o?iS.success(s):eT.isLegalRealPush(r,e,t,n,s))}static isLegalRealPush(e,t,n,r,i){let o=0;const s=TI.ofPlayer(n.getCurrentOpponent()),a=TI.ofPlayer(n.getCurrentPlayer());for(;o<r&&n.isOnBoard(e)&&n.getPieceAt(e)===s;)o++,e=e.getNext(t.dir);return o>=r?iS.failure(XI.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===TI.EMPTY&&(i[e.y][e.x]=s),n.getPieceAt(e)===a)?iS.failure(XI.CANNOT_PUSH_YOUR_OWN_PIECES()):iS.success(i)}static isLegalSideStep(e,t){let n=e.lastPiece.get();const r=e.coord.getDirectionToward(n).get();n=n.getNext(r);let i=e.coord;const o=TI.ofPlayer(t.getCurrentPlayer()),s=t.getCopiedBoard();for(;!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==o)return iS.failure(XI.MUST_ONLY_TRANSLATE_YOUR_PIECES());const n=i.getNext(e.dir);if(s[i.y][i.x]=TI.EMPTY,n.isInRange(9,9)){if(t.isPiece(n))return iS.failure(XI.TRANSLATION_IMPOSSIBLE());t.getPieceAt(n)===TI.EMPTY&&(s[n.y][n.x]=o)}i=i.getNext(r)}return iS.success(s)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?KI.ZERO_WON:t[1]>5?KI.ONE_WON:KI.ONGOING}applyLegalMove(e,t,n){return new zI(n,t.turn+1)}isLegal(e,t){return eT.isLegal(e,t)}getGameStatus(e){return eT.getGameStatus(e)}}class tT extends LI{getListMoves(e){const t=[],n=e.gameState,r=n.getCurrentPlayer();for(let i=0;i<9;i++)for(let e=0;e<9;e++){const o=new CI(e,i);if(!1!==n.getPieceAt(o).is(r))for(const e of kI.factory.all){const r=$I.fromSingleCoord(o,e).get();if(this.isAcceptablePush(r,n)){t.push(r);for(const r of kI.factory.all)for(let i=1;i<=2&&!r.equals(e);i++){const s=o.getNext(r,i);if(!s.isInRange(9,9))break;{const r=$I.fromDoubleCoord(o,s,e).get();eT.isLegal(r,n).isSuccess()&&t.push(r)}}}}}return new jI(t).getCopy()}isAcceptablePush(e,t){const n=t.getScores(),r=eT.isLegal(e,t);if(r.isSuccess()){const e=t.getCurrentOpponent().value;return!(new zI(r.get(),t.turn+1).getScores()[e]>n[e])}return!1}getBoardValue(e){const t=eT.getGameStatus(e);if(t.isEndGame)return new BI(t.toBoardValue());const n=e.gameState.getScores();return new BI(n[1]-n[0])}}class nT{constructor(e,t,n){this.title=e,this.instruction=t,this.state=n,this.previousMove=XO.empty()}static fromMove(e,t,n,r,i,o){return new iT(e,t,n,r,i,o)}static forClick(e,t,n,r,i,o){return new sT(e,t,n,r,i,o)}static anyMove(e,t,n,r,i){return new oT(e,t,n,r,i)}static fromPredicate(e,t,n,r,i,o){return new aT(e,t,n,r,i,o)}static informational(e,t,n){return new cT(e,t,n)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=XO.of(e),this}}class rT extends nT{constructor(e,t,n,r,i){super(e,t,n),this.solution=r,this.successMessage=i}hasSolution(){return!0}getSolution(){return this.solution}getSuccessMessage(){return this.successMessage}}class iT extends rT{constructor(e,t,n,r,i,o){super(e,t,n,r[0],i),this.acceptedMoves=r,this.failureMessage=o,WO(r.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getFailureMessage(){return this.failureMessage}}class oT extends rT{constructor(e,t,n,r,i){super(e,t,n,r,i)}isAnyMove(){return!0}}class sT extends nT{constructor(e,t,n,r,i,o){super(e,t,n),this.acceptedClicks=r,this.successMessage=i,this.failureMessage=o}isClick(){return!0}getSuccessMessage(){return this.successMessage}getFailureMessage(){return this.failureMessage}}class aT extends rT{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this.predicate=i}isPredicate(){return!0}}class cT extends nT{isInformation(){return!0}}const lT=TI.EMPTY,uT=TI.NONE,hT=TI.ZERO,dT=TI.ONE;class fT{constructor(){this.tutorial=[nT.informational($localize`Initial board and goal of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,zI.getInitialState()),nT.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,zI.getInitialState(),$I.fromSingleCoord(new CI(2,6),kI.UP).get(),$localize`Congratulations!`),nT.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new zI([[uT,uT,uT,uT,lT,hT,hT,dT,dT],[uT,uT,uT,lT,lT,lT,lT,lT,lT],[uT,uT,lT,hT,hT,hT,dT,hT,lT],[uT,lT,lT,lT,lT,lT,lT,lT,lT],[lT,lT,lT,lT,hT,hT,hT,dT,dT],[lT,lT,lT,lT,lT,lT,lT,lT,uT],[lT,lT,lT,lT,hT,dT,lT,uT,uT],[lT,lT,lT,hT,lT,lT,uT,uT,uT],[lT,lT,hT,lT,lT,uT,uT,uT,uT]],0),[$I.fromSingleCoord(new CI(4,4),kI.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed!`)]}}function pT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",6),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onPieceClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.oc("id","piece_",e,"_",t,""),r.mc("ngClass",n.getPieceClasses(e,t)),r.Cb("cx",n.getCenterBy(e,t).x)("cy",n.getCenterBy(e,t).y)("r",.5*n.SPACE_SIZE)}}function gT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"polyline",4),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onCaseClick(t,n)}),r.Pb(),r.Ac(2,pT,1,6,"circle",5),r.Pb()}if(2&e){const e=r.fc(),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","case_",t,"_",i,""),r.mc("ngClass",o.getSquareClasses(t,i)),r.Cb("points",o.getHexaCoordsBy(t,i)),r.Bb(1),r.mc("ngIf",o.isPiece(n))}}function mT(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,gT,3,5,"g",3),r.Pb()),2&e){const e=t.$implicit,n=r.fc(2);r.Bb(1),r.mc("ngIf",n.isBoard(e))}}function yT(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,mT,2,1,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function vT(e,t){1&e&&(r.ec(),r.Qb(0,"marker",7),r.Mb(1,"polygon",8),r.Pb()),2&e&&r.nc("id","arrowhead_",t.$implicit.dir.toString(),"")}function bT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Mb(1,"line",9),r.Qb(2,"line",10),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().chooseDirection(n.dir)}),r.Pb(),r.Qb(3,"polygon",11),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().chooseDirection(n.dir)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit;r.Bb(1),r.nc("id","line_start_",e.dir.toString(),""),r.Cb("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),r.Bb(1),r.nc("id","line_end_",e.dir.toString(),""),r.Cb("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),r.Bb(1),r.nc("id","direction_",e.dir.toString(),""),r.Cb("transform",e.transformation)}}class _T{constructor(e,t,n,r,i,o){this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=r,this.dir=i,this.transformation=o}}let wT=(()=>{class e extends PI{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new eT(zI),this.availableMinimaxes=[new tT(this.rules,"Dummy")],this.encoder=$I.encoder,this.tutorial=(new fT).tutorial,this.scores=XO.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new NI(this.SPACE_SIZE,new CI(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),xI.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=XO.of(this.rules.node.gameState.getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const t=this.rules.node.mother.get().gameState;let n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}showSideStepMove(e){let t=e.lastPiece.get();const n=e.coord.getDirectionToward(t).get();t=t.getNext(n);let r=e.coord;for(;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}onPieceClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#piece_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=n.rules.node.gameState.getCurrentOpponent();return n.hexaBoard[t][e].is(i)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t)})()}opponentClick(e,t){var n=this;return GO(function*(){return(yield n.tryChoosingDirection(e,t)).isSuccess()?aS.SUCCESS:n.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,t){var n=this;return GO(function*(){return n.selecteds=[new CI(e,t)],n.showPossibleDirections(),aS.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const t=this.rules.node.gameState,n=TI.ofPlayer(t.getCurrentPlayer()),r=this.selecteds[0],i=this.selecteds[this.selecteds.length-1];for(const o of kI.factory.all){let s,a=r.getNext(o,1);if(t.isOnBoard(a)&&t.getPieceAt(a)===n){if(e)continue;if(a=i.getNext(o,1),t.isOnBoard(a)&&t.getPieceAt(a)===n)continue}if(s=e?$I.fromSingleCoord(r,o).get():$I.fromDoubleCoord(r,i,o).get(),this.rules.isLegal(s,t).isSuccess()){const e=this.getCenterAt(r),t=this.getCenterAt(a),n=this.getMiddleOfArrow(o,a,t),i=t.x+" "+t.y,s=kI.getAngle(o)+150,c=new _T(e,n,t,a,o,"rotate("+s+" "+i+") translate("+i+")");this.directions.push(c)}}}getMiddleOfArrow(e,t,n){const r=t.getPrevious(e),i=this.getCenterAt(r);return new CI(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}isBoard(e){return e!==TI.NONE}isPiece(e){return e!==TI.EMPTY}secondClick(e,t){var n=this;return GO(function*(){const r=n.selecteds[0],i=new CI(e,t);if(i.equals(r))return n.cancelMoveAttempt(),aS.SUCCESS;if(!1===i.isHexagonallyAlignedWith(r))return n.cancelMoveAttempt(),n.firstClick(e,t);const o=i.getDistance(r);if(o>2)return n.cancelMove(XI.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const s=r.getDirectionToward(i).get();n.selecteds=[r];for(let e=0;e<o;e++)n.selecteds.push(r.getNext(s,e+1));if(3===n.selecteds.length){const r=n.selecteds[1],i=n.rules.node.gameState.getCurrentPlayer();if(!1===n.hexaBoard[r.y][r.x].is(i))return n.cancelMoveAttempt(),n.firstClick(e,t)}return n.showPossibleDirections(),aS.SUCCESS})()}thirdClick(e,t){var n=this;return GO(function*(){const r=new CI(e,t),i=n.selecteds[0];if(r.equals(i))return n.deselectExtremity(!0);const o=n.selecteds[n.selecteds.length-1];return r.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&r.equals(n.selecteds[1])?(n.cancelMoveAttempt(),aS.SUCCESS):n.tryExtension(r,i,o)})()}tryExtension(e,t,n){var r=this;return GO(function*(){const i=bI.factory.fromMove(t,e);if(i.isSuccess()){const o=bI.factory.fromMove(n,e);if(i.equals(o)){const i=t.getDistance(e),o=n.getDistance(e);return 2===Math.max(i,o)?(r.selecteds.push(e),cS.sortByDescending(r.selecteds,$I.sortCoord),r.showPossibleDirections(),aS.SUCCESS):r.cancelMove(XI.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const o=r.cancelMove(XI.LINE_AND_COORD_NOT_ALIGNED());return yield r.firstClick(e.x,e.y),o})()}deselectExtremity(e){var t=this;return GO(function*(){return t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),aS.SUCCESS})()}chooseDirection(e){var t=this;return GO(function*(){const n=t.canUserPlay("#direction_"+e.toString());return n.isFailure()?t.cancelMove(n.getReason()):t._chooseDirection(e)})()}_chooseDirection(e){var t=this;return GO(function*(){const n=t.rules.node.gameState;let r;const i=t.selecteds[0];return r=1===t.selecteds.length?$I.fromSingleCoord(i,e).get():$I.fromDoubleCoord(i,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(r,n,t.scores.get())})()}onCaseClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#case_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.tryChoosingDirection(e,t)})()}tryChoosingDirection(e,t){var n=this;return GO(function*(){const r=new CI(e,t);for(const e of n.directions)if(e.landing.equals(r))return n._chooseDirection(e.dir);return aS.failure("not a direction")})()}getSquareClasses(e,t){const n=new CI(e,t),r=[];return this.moveds.some(e=>e.equals(n))&&r.push("moved"),r}getPieceClasses(e,t){const n=new CI(e,t),r=CS.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(e=>e.equals(n))&&i.push("highlighted"),i}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-abalone"]],features:[r.yb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,yT,2,1,"g",1),r.Qb(2,"defs"),r.Ac(3,vT,2,1,"marker",2),r.Pb(),r.Ac(4,bT,4,12,"g",1),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.hexaBoard),r.Bb(2),r.mc("ngForOf",t.directions),r.Bb(1),r.mc("ngForOf",t.directions))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),CT=(()=>{class e{constructor(e){this.x=e}static from(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return WO(3===t,"Invalid Apagos Coord "+t),e.THREE}}equals(e){return this.x===e.x}}return e.ZERO=new e(0),e.ONE=new e(1),e.TWO=new e(2),e.THREE=new e(3),e})(),ET=(()=>{class e{}return e.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,e.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,e.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,e.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,e})(),OT=(()=>{class e extends HI{constructor(e,t,n){super(),this.landing=e,this.piece=t,this.starting=n}static drop(t,n){return $O.getNonNullable(e.ALL_MOVES.find(e=>e.landing.equals(t)&&e.piece.equalsValue(n)&&e.starting.equals(XO.empty())))}static transfer(t,n){if(t.x<=n.x)return iS.failure(ET.PIECE_SHOULD_MOVE_DOWNWARD());const r=$O.getNonNullable(e.ALL_MOVES.find(e=>e.landing.equals(n)&&e.piece.equals(XO.empty())&&e.starting.equals(XO.of(t))));return iS.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}return e.ALL_MOVES=[new e(CT.ZERO,XO.of(CS.ZERO),XO.empty()),new e(CT.ONE,XO.of(CS.ZERO),XO.empty()),new e(CT.TWO,XO.of(CS.ZERO),XO.empty()),new e(CT.THREE,XO.of(CS.ZERO),XO.empty()),new e(CT.ZERO,XO.of(CS.ONE),XO.empty()),new e(CT.ONE,XO.of(CS.ONE),XO.empty()),new e(CT.TWO,XO.of(CS.ONE),XO.empty()),new e(CT.THREE,XO.of(CS.ONE),XO.empty()),new e(CT.TWO,XO.empty(),XO.of(CT.THREE)),new e(CT.ONE,XO.empty(),XO.of(CT.THREE)),new e(CT.ZERO,XO.empty(),XO.of(CT.THREE)),new e(CT.ONE,XO.empty(),XO.of(CT.TWO)),new e(CT.ZERO,XO.empty(),XO.of(CT.TWO)),new e(CT.ZERO,XO.empty(),XO.of(CT.ONE))],e.encoder=new class extends YO{maxValue(){return e.ALL_MOVES.length}encodeNumber(t){const n=e.ALL_MOVES.findIndex(e=>e.equals(t));return WO(n>=0,t.toString()+" is not part of possibles moves of Apagos!"),n}decodeNumber(t){return WO(t<e.ALL_MOVES.length,t+" is not a valid encoded number for ApagosMove decoder"),e.ALL_MOVES[t]}},e})();class ST{constructor(e){this.containing=e}static from(e,t,n){if(e+t>n)return iS.failure("invalid starting space");const r=new WI;r.set(CS.ZERO,e),r.set(CS.ONE,t),r.set(CS.NONE,n),r.makeImmutable();const i=new ST(r);return iS.success(i)}isFull(){return this.count(CS.ZERO)+this.count(CS.ONE)>=this.count(CS.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){WO(e!==CS.NONE,"should not call ApagosSquare.addPiece with Player.NONE");let t=this.count(CS.ZERO),n=this.count(CS.ONE);const r=this.count(CS.NONE);return e===CS.ZERO?t++:n++,ST.from(t,n,r).get()}substractPiece(e){WO(e!==CS.NONE,"should not call ApagosSquare.addPiece with Player.NONE");let t=this.count(CS.ZERO),n=this.count(CS.ONE);const r=this.count(CS.NONE);return e===CS.ZERO?t--:n--,ST.from(t,n,r).get()}getDominatingPlayer(){const e=this.count(CS.ZERO),t=this.count(CS.ONE);return e>t?CS.ZERO:t>e?CS.ONE:CS.NONE}equals(e){return this.containing.equals(e.containing)}}let PT=(()=>{class e extends UI{constructor(e,t,n){super(e),this.board=t,this.remaining=n,this.remaining.makeImmutable()}static getInitialState(){return e.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,r,i){const o=[];for(let e=0;e<4;e++){const t=ST.from(n[0][e],n[1][e],n[2][e]).get();o.push(t)}const s=new WI;return s.set(CS.ZERO,r),s.set(CS.ONE,i),new e(t,o,s)}getPieceAt(e){return this.board[e.x]}updateAt(t,n){const r=[];for(let e=0;e<4;e++)r.push(t.x===e?n:this.board[e]);const i=this.getRemainingCopy();return new e(this.turn,r,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&cS.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return e.PIECES_PER_PLAYER=10,e})();class IT extends JI{static get(){return null==IT.singleton&&(IT.singleton=new IT(PT)),YI.ruler=this.singleton,this.singleton}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);const i=new PT(t.turn+1,t.board,n),o=e.piece.get(),s=i.getPieceAt(e.landing).addPiece(o);if(e.landing===CT.THREE)return i.updateAt(e.landing,s);{const t=CT.from(e.landing.x+1),n=i.getPieceAt(t);return i.updateAt(e.landing,n).updateAt(t,s)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),o=t.getPieceAt(e.landing).addPiece(n);let s=t.updateAt(r,i);return s=s.updateAt(e.landing,o),new PT(s.turn+1,s.board,s.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?iS.failure(ET.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?iS.failure(ET.NO_PIECE_REMAINING_TO_DROP()):iS.success(void 0)}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?iS.failure(ET.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):iS.success(void 0)}getGameStatus(e){const t=e.gameState;for(let r=0;r<4;r++)if(!1===t.getPieceAt(CT.from(r)).isFull())return KI.ONGOING;const n=t.getPieceAt(CT.THREE).getDominatingPlayer();return KI.getVictory(n)}}class TT extends LI{getListMoves(e){const t=e.gameState;return OT.ALL_MOVES.filter(function(e){return IT.get().isLegal(e,t).isSuccess()})}getBoardValue(e){const t=IT.get().getGameStatus(e);if(t.isEndGame)return BI.fromWinner(t.winner);const n=e.gameState.board[3].getDominatingPlayer();return new BI(n.getScoreModifier())}}class AT{constructor(){this.tutorial=[nT.informational($localize`Initial board and goal of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,PT.getInitialState()),nT.anyMove($localize`Drop`,$localize`There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You play Light.<br/><br/>Drop a piece on one of those three squares.`,PT.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),OT.drop(CT.ZERO,CS.ZERO),$localize`Congratulations!`),nT.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,PT.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),OT.transfer(CT.TWO,CT.ZERO).get(),(e,t)=>e.isDrop()?aS.failure($localize`This move is a drop, please do a transfer!`):aS.SUCCESS,$localize`Congratulations!`),nT.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,PT.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),OT.drop(CT.TWO,CS.ONE),(e,t)=>e.isDrop()?e.piece.equalsValue(CS.ONE)?aS.SUCCESS:aS.failure($localize`You actively made your opponent win!`):aS.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}function kT(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",5)),2&e){const e=t.$implicit,n=r.fc();r.Cb("cx",(e+1)*n.PIECE_RADIUS)("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function NT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polygon",7),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc();return n.onArrowClick(t,n.Player.ZERO)}),r.Pb()}if(2&e){const e=r.fc().index,t=r.fc();r.nc("id","dropArrow_zero_",e,""),r.mc("ngClass",t.getArrowClasses(e,t.Player.ZERO)),r.Cb("points",t.ARROW_COORD)("transform",t.getArrowTransform(e,t.Player.ZERO))}}function MT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polygon",7),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc();return n.onArrowClick(t,n.Player.ONE)}),r.Pb()}if(2&e){const e=r.fc().index,t=r.fc();r.nc("id","dropArrow_one_",e,""),r.mc("ngClass",t.getArrowClasses(e,t.Player.ONE)),r.Cb("points",t.ARROW_COORD)("transform",t.getArrowTransform(e,t.Player.ONE))}}function xT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Ob(0),r.Qb(1,"circle",8),r.cc("click",function(){r.wc(e);const t=r.fc().index;return r.fc().onSquareClick(t)}),r.Pb(),r.Nb()}if(2&e){const e=t.$implicit,n=r.fc(),i=n.index,o=n.$implicit,s=r.fc();r.Bb(1),r.pc("id","square_",i,"_piece_",e,"_out_of_",o.count(s.Player.NONE),""),r.mc("ngClass",s.getPieceClasses(i,e,o)),r.Cb("cx",s.getCircleCenter(i,e,o).x)("cy",s.getCircleCenter(i,e,o).y)}}function RT(e,t){if(1&e){const e=r.Rb();r.ec(),r.Ob(0),r.Ac(1,NT,1,4,"polygon",6),r.Ac(2,MT,1,4,"polygon",6),r.Qb(3,"rect",7),r.cc("click",function(){r.wc(e);const n=t.index;return r.fc().onSquareClick(n)}),r.Pb(),r.Ac(4,xT,2,6,"ng-container",3),r.Nb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc();r.Bb(1),r.mc("ngIf",i.canDisplayArrow(n,i.Player.ZERO)),r.Bb(1),r.mc("ngIf",i.canDisplayArrow(n,i.Player.ONE)),r.Bb(1),r.nc("id","square_",n,""),r.mc("ngClass",i.getSquareClasses(n)),r.Cb("x",n*i.SPACE_SIZE)("y",(5-n)*i.SPACE_SIZE*.25)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),r.Bb(1),r.mc("ngForOf",i.range(e.count(i.Player.NONE)))}}function DT(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",9)),2&e){const e=t.$implicit,n=r.fc();r.Cb("cx",4*n.SPACE_SIZE-(e+1)*n.PIECE_RADIUS)("cy",2.25*n.SPACE_SIZE+3*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}let LT=(()=>{class e extends SI{constructor(t){super(t),this.Player=CS,this.ARROW_COORD=e.getArrowCoord(),this.PIECES_PER_PLAYER=PT.PIECES_PER_PLAYER,this.selectedPiece=XO.empty(),this.leftPiece=XO.empty(),this.droppedPiece=XO.empty(),this.displayableArrow=[],this.rules=new IT(PT),this.availableMinimaxes=[new TT(this.rules,"ApagosDummyMinimax")],this.encoder=OT.encoder,this.tutorial=(new AT).tutorial,this.PIECE_RADIUS=200/(this.PIECES_PER_PLAYER+1),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=XO.empty(),this.showPossibleDrops()}updateBoard(){const e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(CS.ZERO).get(),this.remainingOne=e.remaining.get(CS.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=XO.empty(),this.leftPiece=XO.empty(),this.selectedPiece=XO.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const t=e.piece.get();let n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));const r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=XO.of({square:n,piece:r})}getLowestPlayerPiece(e,t){const n=e.count(t);return t===CS.ZERO?n-1:e.count(CS.NONE)-n}showLastTransfer(e){const t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=XO.of({square:r,piece:i});const o=e.landing.x,s=this.getLowestPlayerPiece(this.board[o],n);this.droppedPiece=XO.of({square:o,piece:s})}showPossibleDrops(){this.displayableArrow=[];const e=this.rules.node.gameState;for(let t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(CS.ZERO).get()>0&&this.displayableArrow.push({x:t,player:CS.ZERO}),e.remaining.get(CS.ONE).get()>0&&this.displayableArrow.push({x:t,player:CS.ONE}))}getCircleCenter(e,t,n){const r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(CS.NONE))return new CI(r,i);const o=n.count(CS.NONE),s=2*t*Math.PI/o-Math.PI/2,a=.3*this.SPACE_SIZE,c=a*Math.cos(s),l=a*Math.sin(s);return new CI(r+c,i+l)}canDisplayArrow(e,t){return this.displayableArrow.some(n=>n.x===e&&n.player.equals(t))}getArrowClasses(e,t){return[this.getPlayerClass(t)]}getArrowTransform(e,t){let n=t===CS.ZERO?0:.5*this.SPACE_SIZE;return n+=e*this.SPACE_SIZE,"translate("+n+", "+(3-e)*this.SPACE_SIZE*.25+")"}getSquareClasses(e){const t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}onArrowClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#dropArrow_"+(t===CS.ZERO?"zero":"one")+"_"+e);if(r.isFailure())return n.cancelMove(r.getReason());const i=CT.from(e);let o;if(n.selectedPiece.isPresent()){const e=n.selectedPiece.get().square;o=OT.transfer(CT.from(e),i).get()}else o=OT.drop(i,t);return n.chooseMove(o,n.rules.node.gameState)})()}getPieceClasses(e,t,n){const r={square:e,piece:t},i=[];let o=n.count(CS.ZERO),s=n.count(CS.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===CS.ZERO?o++:s++}const a=n.count(CS.NONE)-(s+o),c=this.getPieceColor(t,o,a);return""!==c&&i.push(c),i}getPieceColor(e,t,n){return e<t?"player0":e>=t+n?"player1":""}onSquareClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#square_"+e);if(n.isFailure())return t.cancelMove(n.getReason());if(t.selectedPiece.isPresent()&&t.selectedPiece.get().square===e)return t.cancelMoveAttempt(),aS.SUCCESS;const r=t.rules.node.gameState.getCurrentPlayer(),i=t.board[e];return i.count(r)<=0?t.cancelMove(ET.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=XO.of({square:e,piece:t.getLowestPlayerPiece(i,r)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(ET.NO_POSSIBLE_TRANSFER_REMAINS()):aS.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const t=this.rules.node.gameState.getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-apagos"]],features:[r.yb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,kT,1,3,"circle",1),r.Qb(2,"g",2),r.Ac(3,RT,5,9,"ng-container",3),r.Pb(),r.Ac(4,DT,1,3,"circle",4),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.range(t.remainingZero)),r.Bb(1),r.Cb("transform","translate(0, "+2*t.PIECE_RADIUS+")"),r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.range(t.remainingOne)))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),BT=(()=>{class e extends SI{}return e.\u0275fac=function(t){return FT(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],features:[r.yb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();const FT=r.Sb(BT);class jT extends VI{constructor(e,t,n){super(e,t),this.captured=n}static getInitialState(){const e=cS.createTable(6,2,4);return new jT(e,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let UT=(()=>{class e{}return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,e.MUST_CHOOSE_NONEMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,e.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,e})(),VT=(()=>{class e extends JI{applyLegalMove(t,n,r){qO(e.VERBOSE,{called:"AwaleRules.applyLegalMove",move:t,state:n});const i=t.x,o=n.getCurrentPlayer().value,s=n.getCurrentPlayer().getOpponent().value;let a=n.getCopiedBoard();const c=e.distribute(i,o,a);if(c.y===o)return new jT(a,n.turn+1,n.captured);{let t=[0,0];const r=cS.copyBiArray(a);return t[o]=e.capture(c.x,s,o,a),t[o]>0&&e.isStarving(s,a)&&(a=r,t=[0,0]),e.isStarving(o,a)&&!1===e.canDistribute(s,a)&&(t[s]+=e.mansoon(s,a)),t[0]+=n.captured[0],t[1]+=n.captured[1],new jT(a,n.turn+1,t)}}static mansoon(e,t){let n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}static isLegal(t,n){const r=n.getCurrentPlayer().value,i=n.getCurrentPlayer().getOpponent().value,o=t.x;if(0===n.getPieceAtXY(o,r))return iS.failure(UT.MUST_CHOOSE_NONEMPTY_HOUSE());const s=e.isStarving(i,n.board),a=!1===e.doesDistribute(o,r,n.board);return s&&a?iS.failure(UT.SHOULD_DISTRIBUTE()):iS.success(void 0)}isLegal(t,n){return e.isLegal(t,n)}static doesDistribute(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}static canDistribute(t,n){for(let r=0;r<6;r++)if(e.doesDistribute(r++,t,n))return!0;return!1}static isStarving(e,t){let n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}static distribute(e,t,n){const r=e,i=t;let o=n[t][e];for(n[t][e]=0;o>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,e===r&&t===i||(n[t][e]+=1,o--);return new CI(e,t)}static capture(e,t,n,r){WO(t!==n,"AwaleRules.capture called with wrong values of x and player");let i=r[t][e];if(i<2||i>3)return 0;let o=0,s=-1,a=-1;0===n&&(s=1,a=6);do{o+=i,r[t][e]=0,i=r[t][e+=s]}while(e!==a&&(2===i||3===i));return o}static getGameStatus(e){const t=e.gameState;return t.captured[0]>24?KI.ZERO_WON:t.captured[1]>24?KI.ONE_WON:24===t.captured[0]&&24===t.captured[1]?KI.DRAW:KI.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})(),zT=(()=>{class e extends HI{constructor(e){super(),this.x=e}static from(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;case 3:return e.THREE;case 4:return e.FOUR;default:return WO(5===t,"Invalid x for AwaleMove: "+t),e.FIVE}}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}return e.ZERO=new e(0),e.ONE=new e(1),e.TWO=new e(2),e.THREE=new e(3),e.FOUR=new e(4),e.FIVE=new e(5),e.encoder=new class extends YO{maxValue(){return 5}encodeNumber(e){return e.x}decodeNumber(t){return e.from(t)}},e})();class HT extends LI{getListMoves(e){const t=[],n=e.gameState,r=n.turn%2;let i,o=0;do{0!==n.getPieceAtXY(o,r)&&(i=zT.from(o),VT.isLegal(i,n).isSuccess()&&(i=zT.from(o),t.push(i))),o++}while(o<6);return this.orderMoves(e,t)}orderMoves(e,t){const n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return cS.sortByDescending(t,t=>{const i=e.gameState.getCopiedBoard(),o=i[n][t.x],s=VT.distribute(t.x,n,i);let a,c=0;return s.y===n?(a=0,o<=6&&(c=10)):a=VT.capture(s.x,r,n,i),100*a+c-o}),t}getBoardValue(e){const t=VT.getGameStatus(e);if(t.isEndGame)return BI.fromWinner(t.winner);const n=e.gameState.getCapturedCopy();return new BI(n[1]-n[0])}}class GT{constructor(){this.tutorial=[nT.anyMove($localize`Sowing`,$localize`Awalé is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown.
         As you're playing first, the 6 houses on the top are yours.<br/><br>
         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house.`,jT.getInitialState(),zT.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),nT.anyMove($localize`Big sowing`,$localize`You are now the second player (on the bottom).
        When there are enough seeds to make a full turn, something else happens.<br/><br/>
        Sow the house that contains 12 seeds.`,new jT([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),zT.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),nT.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.
         Then, the player looks at the preceding house:
         if it is still in the opponent's side and contains two or three seeds, they are also captured.
         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>
         You are the second player, try to capture some pieces!`,new jT([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[zT.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),nT.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.
        As these are consecutive houses, all seeds in them will be captured.<br/><br/>
        Capture them.`,new jT([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[zT.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),nT.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>
        Do it.`,new jT([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[zT.ZERO],$localize`Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),nT.fromMove($localize`Capture on the other side only`,$localize`Try to capture the two leftmost houses of the opponent.`,new jT([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[zT.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),nT.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        Try it.`,new jT([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[zT.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),nT.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>
        Go ahead!`,new jT([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),zT.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),nT.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>
         Sow the house on the top right.`,new jT([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),zT.FIVE,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function $T(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",4),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Pb(),r.Qb(2,"text",5),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Cc(3),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","click_",n,"_",i,""),r.mc("ngClass",o.getSquareClasses(n,i)),r.Cb("cx",50+100*n)("cy",50+120*i),r.Bb(1),r.Cb("x",50+100*n)("y",66+120*i),r.Bb(1),r.Ec(" ",e," ")}}function qT(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,$T,4,8,"g",2),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}let WT=(()=>{class e extends BT{constructor(e){super(e),this.last=XO.empty(),this.captured=[],this.moved=[],this.scores=XO.of([0,0]),this.rules=new VT(jT),this.availableMinimaxes=[new HT(this.rules,"AwaleMinimax")],this.encoder=zT.encoder,this.tutorial=(new GT).tutorial,this.updateBoard()}updateBoard(){const e=this.rules.node.gameState;this.scores=XO.of(e.getCapturedCopy()),this.hidePreviousMove();const t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){const n=e.getCurrentOpponent().value;this.last=XO.of(new CI(t.get().x,n)),this.showPreviousMove()}else this.last=XO.empty()}hidePreviousMove(){this.captured=[],this.moved=[]}showPreviousMove(){const e=this.rules.node.mother.get().gameState;for(let t=0;t<=1;t++)for(let n=0;n<=5;n++){const r=new CI(n,t),i=this.board[t][n],o=e.getPieceAt(r);this.last.equalsValue(r)||(i<o?this.captured.push(r):i>o&&this.moved.push(r))}}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(t!==n.rules.node.gameState.getCurrentPlayer().value)return n.cancelMove(UT.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());n.last=XO.empty();const i=zT.from(e);return n.chooseMove(i,n.rules.node.gameState,n.scores.get())})()}getSquareClasses(e,t){const n=new CI(e,t);return this.captured.some(e=>e.equals(n))?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(e=>e.equals(n))?["moved"]:[]}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-awale-component"]],features:[r.yb],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Mb(1,"rect",1),r.Ac(2,qT,2,1,"g",2),r.Mb(3,"line",3),r.Pb()),2&e&&(r.Bb(2),r.mc("ngForOf",t.board))},directives:[he,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class ZT extends GI{constructor(e,t){if(super(e.x,e.y),e.equals(t))throw new Error(DI.MOVE_CANNOT_BE_STATIC());this.end=t}static getEncoder(e,t,n){return new class extends YO{constructor(){super(...arguments),this.shiftAX=t,this.shiftDY=this.shiftAX*e,this.shiftDX=this.shiftDY*t}maxValue(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}encodeNumber(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}decodeNumber(r){const i=r%t;r/=t;const o=new CI((r-=r%1)%e,i);r/=e;const s=(r-=r%1)%t;r/=t;const a=new CI((r-=r%1)%e,s);return n(a,o)}}}length(){return this.coord.getDistance(this.end)}getDirection(){return bI.factory.fromMove(this.coord,this.end)}}let QT=(()=>{class e{}return e.LANDING_ON_OCCUPIED_CASE=()=>$localize`You cannot land on an occupied square.`,e.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,e.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,e.SOMETHING_IN_THE_WAY=()=>$localize`Something is in the way.`,e.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,e})();class YT extends ZT{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(QT.MOVE_MUST_BE_ORTHOGONAL())}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"TaflMove("+this.coord+"->"+this.end+")"}}let KT=(()=>{class e extends YT{static of(t,n){return new e(t,n)}static from(t,n){try{const r=new e(t,n);return iS.success(r)}catch(aO){return iS.failure(aO.message)}}getMaximalDistance(){return 7}}return e.encoder=ZT.getEncoder(7,7,e.of),e})();const JT={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:CS.ZERO};let XT=(()=>{class e{constructor(e,t){this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}return e.UNOCCUPIED=new e(CS.NONE,!1),e.PLAYER_ONE_KING=new e(CS.ONE,!0),e.INVADERS=new e(CS.ZERO,!1),e.DEFENDERS=new e(CS.ONE,!1),e})(),eA=(()=>{class e{constructor(e){this.value=e}}return e.NONE=new e("NONE"),e.OPPONENT=new e("OPPONENT"),e.PLAYER=new e("PLAYER"),e})();class tA extends VI{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new CI(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let r;return r=n===CS.NONE?eA.NONE:e===n?eA.PLAYER:eA.OPPONENT,r}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class nA extends tA{static getInitialState(){const e=XT.UNOCCUPIED,t=XT.INVADERS,n=XT.DEFENDERS;return new nA([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,XT.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}from(e,t){return new nA(e,t)}}let rA=(()=>{class e extends JI{constructor(e,t,n){super(e),this.config=t,this.generateMove=n}isLegal(t,n){qO(e.VERBOSE,{tablutRules_isLegal:{move:t,state:n}});const r=n.getCurrentPlayer(),i=this.getMoveValidity(r,t,n);return i.isFailure()?iS.failure(i.getReason()):iS.success(void 0)}getMoveValidity(e,t,n){const r=n.getRelativeOwner(e,t.coord);if(r===eA.NONE)return aS.failure(DI.MUST_CHOOSE_PLAYER_PIECE());if(r===eA.OPPONENT)return aS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==eA.NONE)return aS.failure(QT.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return aS.failure(QT.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return aS.failure(QT.THRONE_IS_LEFT_FOR_GOOD())}const i=t.coord.getDirectionToward(t.end).get(),o=t.coord.getOrthogonalDistance(t.end);let s=t.coord.getNext(i);for(let a=1;a<o;a++){if(n.getPieceAt(s)!==XT.UNOCCUPIED)return aS.failure(QT.SOMETHING_IN_THE_WAY());s=s.getNext(i)}return aS.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,r){const i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(e,i)!==eA.OPPONENT?XO.empty():r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):XO.empty()}captureKing(e,t,n,r){const i=t.getNext(n),{backCoord:o,back:s,backInRange:a,left:c,leftCoord:l,right:u,rightCoord:h}=this.getSurroundings(i,n,e,r);return!1===a?this.captureKingAgainstTheWall(c,u,i):s===eA.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,u):s===eA.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,u,h):XO.empty()}getSurroundings(e,t,n,r){const i=e.getNext(t),o=i.isInRange(this.config.WIDTH,this.config.WIDTH),s=o?r.getRelativeOwner(n,i):eA.NONE,a=e.getLeft(t),c=a.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,a):eA.NONE,l=e.getRight(t),u=l.isInRange(this.config.WIDTH,this.config.WIDTH);return{backCoord:i,back:s,backInRange:o,leftCoord:a,left:c,rightCoord:l,right:u?r.getRelativeOwner(n,l):eA.NONE}}captureKingAgainstTheWall(t,n,r){let i=t===eA.PLAYER?1:0;return i+=n===eA.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?(qO(e.VERBOSE||!1,"king captured by 3 invaders against 1 border"),XO.of(r)):XO.empty()}captureKingAgainstThrone(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return XO.of(t)}else{const e=r===eA.PLAYER,i=n===eA.PLAYER||e;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&i)return XO.of(t)}return XO.empty()}capturePawn(t,n,r,i){const o=n.getNext(r),s=o.getNext(r);let a=eA.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(a=i.getRelativeOwner(t,s)),a===eA.NONE?!1===this.isThrone(i,s)?(qO(e.VERBOSE||!1,"cannot capture a pawn without an ally; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),XO.empty()):(qO(e.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),XO.of(o)):a===eA.PLAYER?(qO(e.VERBOSE||!1,"pawn captured by 2 opponents; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),XO.of(o)):(qO(e.VERBOSE||!1,"no captures; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),XO.empty())}captureKingWithAtLeastASandwich(t,n,r,i,o,s){if(!1===this.kingTouchCentralThrone(t,n)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return XO.of(n);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,c=this.isThrone(t,i),l=r===eA.PLAYER||c&&a,u=this.isThrone(t,s);return l&&(o===eA.PLAYER||u&&a)?(qO(e.VERBOSE||!1,"king captured by 4 invaders"),XO.of(n)):XO.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(t,n){qO(e.VERBOSE,{TablutRules_applyLegalMove:{move:t,state:n}});const r=n.turn,i=n.getCopiedBoard(),o=n.getCurrentPlayer(),s=t.coord,a=t.end;i[a.y][a.x]=i[s.y][s.x],i[s.y][s.x]=XT.UNOCCUPIED;for(const e of wI.ORTHOGONALS){const r=this.tryCapture(o,t.end,e,n);r.isPresent()&&(i[r.get().y][r.get().x]=XT.UNOCCUPIED)}return n.from(i,r+1)}getGameStatus(e){const t=this.getWinner(e.gameState);return t.isPresent()?KI.getVictory(t.get()):KI.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return qO(!1,"The king is dead, victory to invader"),XO.of(this.getInvader());const n=t.get();return this.isExternalThrone(n)?(qO(!1,"The king escape, victory to defender"),XO.of(this.getDefender())):this.isPlayerImmobilized(CS.ZERO,e)?(qO(!1,"Zero has no move, victory to one"),XO.of(CS.ONE)):this.isPlayerImmobilized(CS.ONE,e)?(qO(!1,"One has no move, victory to zero"),XO.of(CS.ZERO)):(qO(!1,"no victory"),XO.empty())}getKingCoord(t){qO(e.VERBOSE,{TablutRules_getKingCoord:{state:t,con:this.config}});for(let e=0;e<this.config.WIDTH;e++)for(let n=0;n<this.config.WIDTH;n++)if(t.getPieceAtXY(n,e).isKing())return XO.of(new CI(n,e));return XO.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(t,n){const r=[],i=this.getPlayerListPawns(t,n);qO(e.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:t,state:n}});for(const e of i){const t=this.getPossibleDestinations(e,n);for(const n of t){const t=this.generateMove(e,n);r.push(t)}}return r}getPlayerListPawns(e,t){const n=[];for(let r=0;r<this.config.WIDTH;r++)for(let i=0;i<this.config.WIDTH;i++){const o=new CI(i,r);t.getAbsoluteOwner(o)===e&&n.push(o)}return n}getPossibleDestinations(e,t){const n=[];let r;for(const i of wI.ORTHOGONALS){r=e.getNext(i,1);let o=!1;for(;r.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===o;)t.getAbsoluteOwner(r)===CS.NONE?this.isExternalThrone(r)?t.getPieceAt(e).isKing()&&n.push(r):t.isCentralThrone(r)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(r):n.push(r):o=!0,r=r.getNext(i,1)}return n}}return e.VERBOSE=!1,e})();class iA extends rA{constructor(){super(nA,JT,KT.of)}static get(){return null==iA.singleton&&(iA.singleton=new iA),YI.ruler=this.singleton,iA.singleton}}class oA extends BT{constructor(e,t,n){super(e),this.VERBOSE=t,this.generateMove=n,this.NONE=XT.UNOCCUPIED,this.captureds=[],this.chosen=new CI(-1,-1),this.lastMove=XO.empty()}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(){qO(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove()}showPreviousMove(){const e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState.getCurrentOpponent();for(const n of wI.ORTHOGONALS){const r=this.lastMove.get().end.getNext(n,1);if(r.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const n=e.getRelativeOwner(t,r)===eA.OPPONENT,i=this.rules.node.gameState.getPieceAt(r)===XT.UNOCCUPIED;n&&i&&this.captureds.push(r)}}}onClick(e,t){var n=this;return GO(function*(){qO(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")");const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return GO(function*(){qO(n.VERBOSE,"TaflComponent.chooseDestination");const r=n.chosen,i=new CI(e,t),o=n.generateMove(r,i);return o.isSuccess()?(n.cancelMove(),yield n.chooseMove(o.get(),n.rules.node.gameState)):n.cancelMove(o.getReason())})()}choosePiece(e,t){return qO(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===XT.UNOCCUPIED?this.cancelMove(DI.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new CI(e,t),qO(this.VERBOSE,"selected piece = ("+e+", "+t+")"),aS.SUCCESS):this.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(e,t){const n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new CI(e,t);return n.getRelativeOwner(r,i)===eA.PLAYER}cancelMoveAttempt(){this.chosen=new CI(-1,-1)}isThrone(e,t){return this.rules.isThrone(this.rules.node.gameState,new CI(e,t))}isCentralThrone(e,t){return!1===this.rules.node.gameState.isCentralThrone(new CI(e,t))}getPieceClasses(e,t){const n=[],r=new CI(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}getRectClasses(e,t){const n=[],r=new CI(e,t);if(this.captureds.some(e=>e.equals(r)))n.push("captured");else if(this.lastMove.isPresent()){const e=this.lastMove.get().coord,t=this.lastMove.get().end;(r.equals(e)||r.equals(t))&&n.push("moved")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new CI(n,t));return e}isClickable(e,t){return this.pieceBelongToCurrentPlayer(e,t)}isInvader(e,t){return this.board[t][e]===XT.INVADERS}isKing(e,t){return this.board[t][e].isKing()}getKingPolyline(e,t){return 85+100*e+" "+(85+100*t)+" "+(30+100*e)+" "+(30+100*t)+" "+(50+100*e)+" "+(10+100*t)+" "+(70+100*e)+" "+(30+100*t)+" "+(15+100*e)+" "+(85+100*t)}}class sA extends LI{getListMoves(e){qO(!1,{TaflMinimax_getListMoves:{node:e}});const t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}orderMoves(e,t){const n=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?cS.sortByDescending(t,e=>-e.end.getOrthogonalDistance(n)):cS.sortByDescending(t,e=>e.coord.equals(n)?this.ruler.isExternalThrone(e.end)?2:1:0),t}getBoardValue(e){const t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new BI(n.get().getVictoryValue());const r=this.ruler.getPlayerListPawns(CS.ZERO,t).length,i=this.ruler.getPlayerListPawns(CS.ONE,t).length;let o=[1,2][this.ruler.config.INVADER.value];o*=CS.ZERO.getScoreModifier();let s=[2,1][this.ruler.config.INVADER.value];return s*=CS.ONE.getScoreModifier(),new BI(r*o+i*s)}}class aA{constructor(e,t){this.direct=e,this.mover=t}equals(e){return e.direct.equals(this.direct)&&e.mover.equals(this.mover)}}class cA extends aA{constructor(e,t){super(new jI([e]),t),this.mover=t}}class lA extends sA{constructor(e,t){super(e,t),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new BI(t.toBoardValue());const n=e.gameState,r=XT.UNOCCUPIED;let i=0;const o=this.getPiecesMap(n),s=this.getThreatMap(n,o),a=this.filterThreatMap(s,n);for(const c of[CS.ZERO,CS.ONE])for(const e of o.get(c).get().getCopy())if(a.get(e).isPresent())i+=c.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=c.getScoreModifier()*this.scoreBySafePiece;let t=0;for(const i of wI.ORTHOGONALS){let o=e.getNext(i,1);for(;o.isInRange(this.width,this.width)&&n.getPieceAt(o)===r;)t++,o=o.getNext(i,1)}i+=t*c.getScoreModifier()}return new BI(i)}getPiecesMap(e){const t=XT.UNOCCUPIED,n=new WI,r=[],i=[];for(let o=0;o<this.width;o++)for(let n=0;n<this.width;n++){const s=new CI(n,o);e.getPieceAt(s)!==t&&(e.getAbsoluteOwner(s)===CS.ZERO?r.push(s):i.push(s))}return n.set(CS.ZERO,new jI(r)),n.set(CS.ONE,new jI(i)),n}getThreatMap(e,t){const n=new WI;for(const r of[CS.ZERO,CS.ONE])for(const i of t.get(r).get().getCopy()){const t=this.getThreats(i,e);this.isThreatReal(i,e,t)&&n.set(i,new jI(t))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e).getOpponent(),r=[];for(const i of wI.ORTHOGONALS){const o=e.getPrevious(i,1);if(this.isAThreat(o,t,n)){const s=[];for(const r of wI.ORTHOGONALS){if(r===i.getOpposite())continue;let o=e.getNext(i,1);for(;o.isInRange(this.width,this.width)&&t.getPieceAt(o)===XT.UNOCCUPIED;)o=o.getNext(r);o.isInRange(this.width,this.width)&&t.getAbsoluteOwner(o)===n&&!1===e.getNext(i,1).equals(o)&&s.push(o)}r.push(new cA(o,new jI(s)))}}return r}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==CS.ONE&&t.getPieceAt(e)!==XT.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const r of n)if(r.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new WI,r=e.listKeys(),i=r.filter(e=>t.getAbsoluteOwner(e)===t.getCurrentPlayer()),o=new jI(r.filter(e=>t.getAbsoluteOwner(e)===t.getCurrentOpponent()));for(const s of i){const t=e.get(s).get().getCopy(),r=[];for(const e of t)if(!1===o.contains(e.direct.get(0))){const t=[];for(const n of e.mover.getCopy())!1===o.contains(n)&&t.push(n);t.length>0&&r.push(new cA(e.direct.get(0),new jI(t)))}r.length>0&&n.set(s,new jI(r))}for(const s of o.getCopy()){const t=e.get(s).get();n.set(s,t)}return n}}let uA=(()=>{class e extends lA{getBoardValue(t){const n=this.ruler.getGameStatus(t);if(n.isEndGame)return new BI(n.toBoardValue());const r=t.gameState,i=this.ruler.config.WIDTH,o=XT.UNOCCUPIED;let s=0;const a=this.getPiecesMap(r),c=this.getThreatMap(r,a),l=this.filterThreatMap(c,r);for(const u of[CS.ZERO,CS.ONE]){const t=new jI;for(const n of a.get(u).get().getCopy())if(l.get(n).isPresent())s+=u.getScoreModifier()*e.SCORE_BY_THREATENED_PIECE;else{s+=u.getScoreModifier()*e.SCORE_BY_SAFE_PIECE;for(const e of wI.ORTHOGONALS){let s=n.getNext(e,1);for(;s.isInRange(i,i)&&r.getPieceAt(s)===o;)t.add(s),s=s.getNext(e,1)}}for(const n of t.getCopy()){const t=e.CONTROL_VALUE[n.y][n.x];s+=u.getScoreModifier()*t}}return new BI(s)}}return e.SCORE_BY_THREATENED_PIECE=530,e.SCORE_BY_SAFE_PIECE=16*e.SCORE_BY_THREATENED_PIECE+1,e.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]],e})(),hA=(()=>{class e extends uA{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new BI(t.toBoardValue());const n=e.gameState,r=this.ruler.config.WIDTH,i=XT.UNOCCUPIED;let o=0,s=0,a=0;const c=this.getPiecesMap(n),l=this.getThreatMap(n,c),u=this.filterThreatMap(l,n);for(const d of[CS.ZERO,CS.ONE]){const e=new jI;for(const t of c.get(d).get().getCopy())if(u.get(t).isPresent())s+=d.getScoreModifier();else{o+=d.getScoreModifier();for(const o of wI.ORTHOGONALS){let s=t.getNext(o,1);for(;s.isInRange(r,r)&&n.getPieceAt(s)===i;)e.add(s),s=s.getNext(o,1)}}for(const t of e.getCopy()){const e=uA.CONTROL_VALUE[t.y][t.x];a+=d.getScoreModifier()*e}}const h=this.getStepForEscape(n);return new BI(531*h*17*17+531*o*17+531*s+a)}getStepForEscape(e){const t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}_getStepForEscape(e,t,n,r){const i=this.getNextGen(e,n,r);return 0===i.length?XO.empty():i.some(e=>this.ruler.isExternalThrone(e))?XO.of(t):(t++,r.push(...i),this._getStepForEscape(e,t,i,r))}getNextGen(e,t,n){const r=[];for(const i of t)for(const t of wI.ORTHOGONALS){let o=i.getNext(t,1);for(;o.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&e.getPieceAt(o)===XT.UNOCCUPIED;)n.every(e=>!1===e.equals(o))&&r.push(o),o=o.getNext(t,1)}return r}}return e.SCORE_BY_THREATENED_PIECE=530,e.SCORE_BY_SAFE_PIECE=16*uA.SCORE_BY_THREATENED_PIECE+1,e.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]],e})();const dA=XT.UNOCCUPIED,fA=XT.INVADERS,pA=XT.DEFENDERS,gA=XT.PLAYER_ONE_KING;class mA{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,nA.getInitialState()),nT.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,nA.getInitialState(),KT.of(new CI(3,1),new CI(1,1)),$localize`Congratulations!`),nT.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new nA([[dA,dA,dA,fA,dA,dA,dA],[dA,dA,dA,fA,dA,dA,dA],[fA,dA,dA,pA,dA,dA,dA],[dA,dA,pA,gA,pA,fA,fA],[dA,dA,fA,dA,dA,dA,dA],[dA,dA,dA,pA,dA,fA,dA],[dA,dA,dA,fA,dA,dA,dA]],1),[KT.of(new CI(3,5),new CI(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),nT.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new nA([[dA,dA,dA,fA,dA,dA,dA],[dA,dA,fA,dA,dA,dA,dA],[dA,dA,dA,pA,dA,dA,dA],[fA,pA,dA,dA,pA,fA,fA],[dA,pA,dA,dA,dA,dA,dA],[dA,fA,dA,gA,dA,fA,dA],[dA,dA,dA,fA,dA,dA,dA]],12),[KT.of(new CI(2,1),new CI(3,1)),KT.of(new CI(3,0),new CI(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),nT.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king.`,new nA([[dA,dA,dA,dA,dA,dA,dA],[dA,dA,dA,pA,dA,dA,dA],[dA,dA,dA,fA,dA,dA,dA],[dA,fA,dA,gA,fA,dA,dA],[dA,dA,dA,fA,dA,dA,dA],[dA,pA,dA,dA,dA,dA,dA],[dA,dA,dA,dA,dA,dA,dA]],72),[KT.of(new CI(1,3),new CI(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),nT.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king.`,new nA([[dA,dA,fA,dA,dA,dA,dA],[dA,dA,dA,fA,dA,dA,dA],[dA,dA,dA,gA,fA,dA,dA],[dA,fA,pA,dA,pA,dA,dA],[dA,dA,dA,fA,dA,dA,dA],[dA,dA,dA,dA,dA,dA,dA],[dA,dA,dA,dA,dA,dA,dA]],72),[KT.of(new CI(2,0),new CI(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`),nT.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king.`,new nA([[dA,dA,dA,dA,dA,dA,dA],[dA,dA,dA,dA,dA,dA,dA],[dA,fA,dA,fA,dA,dA,dA],[fA,dA,dA,dA,pA,dA,dA],[dA,dA,dA,pA,dA,dA,dA],[dA,dA,dA,dA,dA,dA,dA],[dA,gA,dA,fA,dA,dA,dA]],72),[KT.of(new CI(3,6),new CI(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function yA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",6),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("transform","translate("+e*n.SPACE_SIZE+" "+t*n.SPACE_SIZE+")")}}function vA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",7),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("transform","translate("+e*n.SPACE_SIZE+" "+t*n.SPACE_SIZE+")")}}function bA(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,yA,1,1,"polyline",4),r.Ac(2,vA,1,1,"ng-template",null,5,r.Bc),r.Pb()),2&e){const e=r.vc(3),t=r.fc().index,n=r.fc().index,i=r.fc();r.Bb(1),r.mc("ngIf",i.isCentralThrone(t,n))("ngIfElse",e)}}function _A(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(2,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(3,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(4,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(5,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.04*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.96*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.2*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.05*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.65*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.2*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.95*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.65*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.4*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.15*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.75*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.4*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.85*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.75*n.SPACE_SIZE)}}function wA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"polyline",13),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Pb()}if(2&e){const e=r.fc(3).index,t=r.fc().index,n=r.fc();r.Bb(1),r.Cb("points",n.getKingPolyline(e,t))}}function CA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(1,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(2,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(3,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(3).index,t=r.fc().index,n=r.fc();r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.04*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.96*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.04*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.5*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.96*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.5*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.15*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.15*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.85*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.85*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.85*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.15*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.15*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.85*n.SPACE_SIZE)}}function EA(e,t){if(1&e&&(r.ec(),r.Ac(0,wA,2,1,"g",9),r.Ac(1,CA,4,16,"ng-template",null,12,r.Bc)),2&e){const e=r.vc(2),t=r.fc(2).index,n=r.fc().index,i=r.fc();r.mc("ngIf",i.isKing(t,n))("ngIfElse",e)}}function OA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",8),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Ac(2,_A,6,20,"g",9),r.Ac(3,EA,3,2,"ng-template",null,10,r.Bc),r.Pb()}if(2&e){const e=r.vc(4),t=r.fc().index,n=r.fc().index,i=r.fc();r.Bb(1),r.mc("ngClass",i.getPieceClasses(t,n)),r.Cb("r",(i.SPACE_SIZE-i.STROKE_WIDTH)/2)("cx",i.SPACE_SIZE*t+.5*i.SPACE_SIZE)("cy",i.SPACE_SIZE*n+.5*i.SPACE_SIZE),r.Bb(1),r.mc("ngIf",i.isInvader(t,n))("ngIfElse",e)}}function SA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",2),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Pb(),r.Ac(2,bA,4,2,"g",3),r.Ac(3,OA,5,6,"g",3),r.Pb()}if(2&e){const e=t.index,n=r.fc().index,i=r.fc();r.Bb(1),r.oc("id","click_",e,"_",n,""),r.mc("ngClass",i.getRectClasses(e,n)),r.Cb("x",i.SPACE_SIZE*e)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),r.Bb(1),r.mc("ngIf",i.board[n][e]===i.NONE&&i.isThrone(e,n)),r.Bb(1),r.mc("ngIf",i.board[n][e]!==i.NONE)}}function PA(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,SA,4,9,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function IA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",14),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n.x,n.y)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.oc("id","click_",e.x,"_",e.y,""),r.Cb("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let TA=(()=>{class e extends oA{constructor(e){super(e,!1,KT.from),this.rules=iA.get(),this.availableMinimaxes=[new sA(this.rules,"DummyBot"),new lA(this.rules,"Piece > Influence"),new uA(this.rules,"Piece > Control"),new hA(this.rules,"Escape > Piece > Control")],this.encoder=KT.encoder,this.tutorial=(new mA).tutorial}ngOnInit(){this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-brandhub"]],features:[r.yb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,PA,2,1,"g",1),r.Ac(2,IA,2,6,"g",1),r.Pb()),2&e&&(r.Cb("viewBox",t.getViewBox()),r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.getClickables()))},directives:[he,le,fe],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),AA=(()=>{class e extends SI{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}getTriangleCoordinate(e,t){return this.getTriangleCornerCoords(e,t).map(e=>e.x+","+e.y).reduce((e,t)=>e+","+t)}getDownwardCoordinate(e,t){const n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,o=this.SPACE_SIZE*(t+1),s=new CI(.5*this.SPACE_SIZE*e,i);return[s,new CI(n,o),new CI(r,i),s]}getUpwardCoordinate(e,t){const n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,o=this.SPACE_SIZE*(t+1),s=new CI(.5*this.SPACE_SIZE*e,o);return[s,new CI(n,i),new CI(r,o),s]}getPyramidCoordinate(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}getDownwardPyramidCoordinate(e,t){const n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,o=n+this.SPACE_SIZE+", "+r,s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),a=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+s+","+a+","+i+","+a+","+o+","+i+","+o+","+s+","+a+","+o}getUpwardPyramidCoordinate(e,t){const n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,o=n+this.SPACE_SIZE+", "+r,s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),a=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+s+","+a+","+i+","+a+","+o+","+i+","+o+","+s+","+a+","+o}}return e.\u0275fac=function(t){return kA(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],features:[r.yb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();const kA=r.Sb(AA);let NA=(()=>{class e{}return e.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,e.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,e.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,e.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,e.CANNOT_CAPTURE_OWN_PIECES=()=>$localize`You cannot capture your own pieces.`,e})(),MA=(()=>{class e{constructor(e,t){this.direction=e,this.str=t}static fromCoords(t,n){const r=t.getVectorToward(n),i=e.STEPS.findIndex(e=>e.direction.equals(r));if(-1===i)throw new Error(NA.INVALID_DISTANCE());return e.STEPS[i]}toInt(){return e.STEPS.findIndex(e=>e.direction.equals(this.direction))}equals(e){return this===e}toString(){return this.str}}return e.LEFT=new e(new gI(-2,0),"LEFT"),e.UP_LEFT=new e(bI.UP_LEFT,"UP_LEFT"),e.UP_RIGHT=new e(bI.UP_RIGHT,"UP_RIGHT"),e.RIGHT=new e(new gI(2,0),"RIGHT"),e.DOWN_LEFT=new e(bI.DOWN_LEFT,"DOWN_LEFT"),e.DOWN_RIGHT=new e(bI.DOWN_RIGHT,"DOWN_RIGHT"),e.STEPS=[e.LEFT,e.UP_LEFT,e.UP_RIGHT,e.RIGHT,e.DOWN_LEFT,e.DOWN_RIGHT],e})(),xA=(()=>{class e extends HI{constructor(e,t,n,r){super(),this.start=e,this.step=t,this.landingCoord=n,this.capture=r}static fromMovement(t,n){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new CI(t.x+n.direction.x,t.y+n.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new e(XO.of(t),XO.of(n),XO.of(r),XO.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new e(XO.empty(),XO.empty(),XO.empty(),XO.of(t))}static fromCoordToCoord(t,n){const r=MA.fromCoords(t,n);return e.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(e){return!!this.capture.equals(e.capture)&&!!this.start.equals(e.start)&&!!this.step.equals(e.step)}}return e.encoder=new class extends YO{maxValue(){return 1035}encodeNumber(e){if(e.isTileExchange()){const t=e.capture.get().y;return 10*e.capture.get().x+t}{const t=e.start.get().y,n=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*n+t}}decodeNumber(t){if(t%1!=0)throw new Error("EncodedMove must be an integer.");const n=t%10,r=(t=(t-n)/10)%15;return 0==(t=(t-r)/15)?e.fromTilesExchange(new CI(r,n)):e.fromMovement(new CI(r,n),MA.STEPS[t-1])}},e})();class RA{static getNeighbors(e){let t;const n=new CI(e.x-1,e.y),r=new CI(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,r,new CI(e.x,e.y-1)]:[n,r,new CI(e.x,e.y+1)],t}static getFakeNeighbors(e){return new CI(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=RA.getNeighbors(e),r=RA.getNeighbors(t);let i=0;for(;i<n.length;){const e=n[i];let t=0;for(;t<r.length;){if(e.equals(r[t]))return XO.of(e);t++}i++}return XO.empty()}}class DA extends VI{static getEmptyNeighbors(e,t,n){const r=[];for(const i of RA.getNeighbors(t))i.isInRange(e[0].length,e.length)&&e[i.y][i.x]===n&&r.push(i);return r}getEmptyNeighboors(e,t){return DA.getEmptyNeighbors(this.board,e,t)}}let LA=(()=>{class e extends DA{constructor(e,t,n,r){super(e,t),this.tiles=n,this.captures=r}static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new CI(t,n)}static getPresentNeighboorEntrances(t){return[new CI(t.x+1,t.y-1),new CI(t.x+3,t.y+0),new CI(t.x+3,t.y+1),new CI(t.x+1,t.y+2),new CI(t.x-1,t.y+1),new CI(t.x-1,t.y+0)].filter(e.isInRange)}static getInitialState(){const t=TI.EMPTY,n=TI.NONE,r=TI.ZERO,i=TI.ONE;return new e([[n,n,n,n,n,n,r,t,r,n,n,n,n,n,n],[n,n,n,t,t,r,t,t,t,r,t,t,n,n,n],[t,i,t,i,t,t,r,t,r,t,t,i,t,i,t],[i,t,t,t,i,t,t,t,t,t,i,t,t,t,i],[t,i,t,i,t,t,t,t,t,t,t,i,t,i,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,i,t,i,t,t,r,t,r,t],[n,n,n,t,t,i,t,t,t,i,t,t,n,n,n],[n,n,n,n,n,n,i,t,i,n,n,n,n,n,n]],0,[0,0],[0,0])}applyLegalMovement(t){qO(e.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const n=t.start.get(),r=t.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=TI.ofPlayer(this.getCurrentPlayer()),i[n.y][n.x]=TI.EMPTY,new e(i,this.turn,this.tiles,this.captures)}doMovementCaptures(t){qO(e.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const n=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const e of n)r=r.capture(e);return r}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return RA.getNeighbors(e).filter(e=>!e.isNotInRange(15,10)&&!!this.getPieceAt(e).is(t)&&this.isSurrounded(e))}isSurrounded(e){return 0===this.getEmptyNeighboors(e,TI.EMPTY).length}capture(t){qO(e.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const n=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return qO(e.VERBOSE,t.toString()+" has been captured"),n[t.y][t.x]=TI.EMPTY,r[this.getCurrentPlayer().value]+=1,new e(n,this.turn,this.tiles,r)}removeTilesIfNeeded(t,n){qO(e.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,tile:t,countTiles:n}});let r=this;const i=e.getTilesUpperLeftCoord(t);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,n);const t=e.getPresentNeighboorEntrances(i);for(const e of t){const t=r.getPieceAt(e);t===TI.EMPTY?r=r.removeTilesIfNeeded(e,n):t.is(this.getCurrentOpponent())&&r.isSurrounded(e)&&(r=r.capture(e))}}return r}isTileEmpty(e){WO(this.getPieceAt(e)!==TI.NONE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const r=e.getNext(new gI(n,t),1);if(this.getPieceAt(r)!==TI.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighboorTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let r=1;r<t.length;r++)!1===this.areNeighboor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighboor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighboor(e,t){return e+1===t||0===e&&5===t}getPresentNeighboorTilesRelativeIndexes(t){const n=[];let r=XO.empty();for(let i=0;i<6;i++){const o=t.getNext(e.NEIGHBOORS_TILES_DIRECTIONS[i],1);o.isInRange(15,10)&&this.getPieceAt(o)!==TI.NONE&&(r.isAbsent()&&(r=XO.of(i)),n.push(i-r.get()))}return n}deconnectTile(t,n){qO(e.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:n}});const r=this.getCopiedBoard(),i=t.x,o=t.y;for(let e=0;e<2;e++)for(let t=0;t<3;t++)r[o+e][i+t]=TI.NONE;const s=[this.tiles[0],this.tiles[1]];return n&&(s[this.getCurrentPlayer().value]+=1),new e(r,this.turn,s,this.captures)}getLegalLandings(e){const t=[];for(const n of MA.STEPS){const r=e.getNext(n.direction,1);this.isOnBoard(r)&&this.getPieceAt(r)===TI.EMPTY&&t.push(r)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const r=this.board[t][n];if(r.isPlayer()){const i=this.getEmptyNeighboors(new CI(n,t),TI.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}return e.VERBOSE=!1,e.NEIGHBOORS_TILES_DIRECTIONS=[new gI(0,-2),new gI(3,-1),new gI(3,1),new gI(0,2),new gI(-3,1),new gI(-3,-1)],e.isInRange=e=>e.isInRange(15,10),e})(),BA=(()=>{class e extends JI{applyLegalMove(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(t,n){const r=n.getCopiedBoard(),i=t.capture.get();r[i.y][i.x]=TI.EMPTY;const o=[n.captures[0],n.captures[1]];o[n.getCurrentPlayer().value]+=1;const s=[n.tiles[0],n.tiles[1]];s[n.getCurrentPlayer().value]-=2;const a=new LA(r,n.turn,s,o),c=a.removeTilesIfNeeded(i,!1),l=new LA(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures);return qO(e.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:n,afterCapture:a,afterTileRemoval:c,resultingState:l}}),l}applyLegalMovement(t,n){const r=n.applyLegalMovement(t),i=r.removeTilesIfNeeded(t.start.get(),!0),o=i.doMovementCaptures(t),s=new LA(o.board,n.turn+1,o.tiles,o.captures);return qO(e.VERBOSE,{ab_state:n,afterMovement:r,afterTilesRemoved:i,afterCaptures:o,resultingState:s}),s}isLegal(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return iS.failure(NA.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.capture.get());return n===TI.NONE||n===TI.EMPTY?iS.failure(NA.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?iS.failure(NA.CANNOT_CAPTURE_OWN_PIECES()):iS.success(void 0)}isLegalMovement(e,t){if(t.getPieceAt(e.start.get())===TI.NONE){const t="Cannot start with a coord outside the board "+e.start.get().toString()+".";return iS.failure(t)}if(t.getPieceAt(e.landingCoord.get())===TI.NONE){const t="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return iS.failure(t)}const n=t.getPieceAt(e.start.get());return n===TI.EMPTY?iS.failure(DI.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?iS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE()):iS.success(void 0)}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?KI.ZERO_WON:t.captures[1]>=18?KI.ONE_WON:KI.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class FA extends LI{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}getListExchanges(e){const t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=TI.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(let o=0;o<10;o++)for(let e=0;e<15;e++){const r=new CI(e,o);if(n.getPieceAt(r)===i){const e=xA.fromTilesExchange(r);t.push(e)}}return t}getListMovement(e){const t=[],n=e.gameState,r=n.getCurrentPlayer();for(let i=0;i<10;i++)for(let e=0;e<15;e++){const o=new CI(e,i);if(n.getPieceAt(o).is(r)){const e=n.getLegalLandings(o);for(const n of e){const e=xA.fromCoordToCoord(o,n);t.push(e)}}}return t}getBoardValue(e){const t=BA.getGameStatus(e);if(t.isEndGame)return BI.fromWinner(t.winner);const n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new BI(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}putCaptureFirst(e,t){return cS.sortByDescending(t,t=>this.moveCapturesList(e,t).length),t}moveCapturesList(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}let jA=(()=>{class e extends FA{getBoardValue(t){const n=BA.getGameStatus(t);if(n.isEndGame)return BI.fromWinner(n.winner);const r=t.gameState,i=this.getPiecesMap(r),o=this.getThreatMap(r,i),s=this.filterThreatMap(o,r);let a=0;for(const c of[CS.ZERO,CS.ONE])for(const t of i.get(c).get().getCopy())s.get(t).isPresent()?a+=c.getScoreModifier()*e.SCORE_BY_THREATENED_PIECE:a+=c.getScoreModifier()*e.SCORE_BY_SAFE_PIECE;return a+=r.tiles[1]-r.tiles[0],new BI(a)}getPiecesMap(e){const t=new WI,n=[],r=[];for(let i=0;i<10;i++)for(let t=0;t<15;t++){const o=new CI(t,i),s=e.getPieceAt(o);s===TI.ZERO?n.push(o):s===TI.ONE&&r.push(o)}return t.set(CS.ZERO,new jI(n)),t.set(CS.ONE,new jI(r)),t}getThreatMap(e,t){const n=new WI;for(const r of[CS.ZERO,CS.ONE])for(const i of t.get(r).get().getCopy()){const t=this.getThreat(i,e);t.isPresent()&&n.set(i,t.get())}return n}getThreat(e,t){const n=CS.of(t.getPieceAt(e).value).getOpponent();let r=XO.empty();const i=[],o=RA.getNeighbors(e).filter(e=>e.isInRange(15,10));for(const s of o){const e=t.getPieceAt(s);if(e.is(n))i.push(s);else if(e===TI.EMPTY){if(r.isPresent())return XO.empty();r=XO.of(s)}}if(r.isPresent()){const e=[];for(const o of MA.STEPS){const s=r.get().getNext(o.direction,1);s.isInRange(15,10)&&t.getPieceAt(s).is(n)&&i.every(e=>!1===e.equals(s))&&e.push(s)}if(e.length>0)return XO.of(new aA(new jI(i),new jI(e)))}return XO.empty()}filterThreatMap(e,t){const n=new WI,r=e.listKeys(),i=r.filter(e=>t.getPieceAt(e).is(t.getCurrentPlayer())),o=new jI(r.filter(e=>t.getPieceAt(e).is(t.getCurrentOpponent())));for(const s of i){const t=e.get(s).get();let r=XO.empty();if(!1===o.contains(t.direct.get(0))){const e=[];for(const n of t.mover.getCopy())!1===o.contains(n)&&e.push(n);e.length>0&&(r=XO.of(new aA(t.direct,new jI(e))))}r.isPresent()&&n.set(s,r.get())}for(const s of o.getCopy()){const t=e.get(s).get();n.set(s,t)}return n}}return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e})();const UA=TI.EMPTY,VA=TI.NONE,zA=TI.ZERO,HA=TI.ONE;class GA{constructor(){this.tutorial=[nT.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,LA.getInitialState()),nT.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.
        You're playing first, hence you're playing Dark.<br/><br/>
        Perform any move.`,LA.getInitialState(),xA.fromCoordToCoord(new CI(3,5),new CI(5,5)),$localize`Congratulations! Let's see captures now.`),nT.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new LA([[VA,VA,VA,VA,VA,VA,zA,UA,zA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,zA,UA,UA,UA,UA,UA,zA,UA,UA,VA,VA,VA],[UA,HA,UA,HA,zA,HA,UA,UA,zA,UA,UA,HA,UA,HA,UA],[HA,UA,UA,UA,UA,UA,UA,UA,UA,UA,HA,UA,UA,UA,HA],[UA,HA,UA,HA,UA,UA,UA,UA,UA,UA,UA,HA,UA,HA,UA],[UA,zA,UA,zA,UA,UA,UA,UA,UA,UA,UA,zA,UA,zA,UA],[zA,UA,UA,UA,zA,UA,UA,UA,UA,UA,zA,UA,UA,UA,zA],[UA,zA,UA,zA,UA,UA,HA,UA,HA,UA,UA,zA,UA,zA,UA],[VA,VA,VA,UA,UA,HA,UA,UA,UA,HA,UA,UA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,HA,UA,HA,VA,VA,VA,VA,VA,VA]],3,[0,0],[0,0]),[xA.fromCoordToCoord(new CI(5,2),new CI(4,1)),xA.fromCoordToCoord(new CI(3,4),new CI(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),nT.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        Perform a move that lets you gain two tiles.`,new LA([[VA,VA,VA,VA,VA,VA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,HA,UA,UA,VA,VA,VA,VA,VA,VA],[UA,UA,UA,VA,VA,VA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[UA,UA,HA,UA,UA,UA,UA,zA,UA,VA,VA,VA,VA,VA,VA],[UA,UA,UA,HA,UA,UA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[UA,UA,UA,UA,UA,UA,UA,UA,UA,UA,UA,zA,VA,VA,VA],[UA,UA,zA,UA,UA,HA,UA,UA,UA,UA,zA,UA,UA,UA,zA],[UA,UA,UA,UA,UA,UA,HA,UA,HA,UA,UA,zA,UA,zA,UA],[VA,VA,VA,UA,UA,HA,UA,UA,UA,HA,UA,UA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,HA,UA,HA,VA,VA,VA,VA,VA,VA]],2,[0,0],[0,0]),[xA.fromCoordToCoord(new CI(2,6),new CI(4,6)),xA.fromCoordToCoord(new CI(2,6),new CI(3,5)),xA.fromCoordToCoord(new CI(2,6),new CI(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),nT.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        Gain some time and capture the last piece!`,new LA([[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,UA,zA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,UA,UA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,UA,UA,HA,UA,HA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,UA,HA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,HA,UA,HA,VA,VA,VA,VA,VA,VA]],1,[0,2],[0,0]),[xA.fromTilesExchange(new CI(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),nT.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrate both of these things can be done on this board by Light. Try it!`,new LA([[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,UA,UA,zA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,UA,zA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,zA,HA,UA,HA,UA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,HA,zA,UA,UA,UA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,UA,UA,HA,VA,VA,VA,VA,VA,VA,VA,VA,VA],[VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA,VA]],1,[0,0],[0,0]),[xA.fromCoordToCoord(new CI(7,6),new CI(6,5)),xA.fromCoordToCoord(new CI(7,6),new CI(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed!`)]}}function $A(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",13)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getPyramidClass(e,t)),r.Cb("points",n.getPyramidCoordinate(e,t))}}function qA(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",15)),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getEmptyClass(e,t)),r.Cb("points",n.getTriangleCoordinate(e,t))}}function WA(e,t){if(1&e&&(r.ec(),r.Ac(0,qA,1,2,"polygon",14)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.mc("ngIf",n.isEmptyCase(e,t))}}function ZA(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",16)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.oc("id","dark_line_",e,"_",t,""),r.Cb("points",n.getLineCoordinate(e,t))}}function QA(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",17)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.oc("id","dark_line_",e,"_",t,""),r.Cb("points",n.getLineCoordinate(e,t))}}function YA(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",8),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Ac(1,$A,1,2,"polygon",9),r.Ac(2,WA,1,1,"ng-template",null,10,r.Bc),r.Ac(4,ZA,1,3,"polygon",11),r.Ac(5,QA,1,3,"polygon",12),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.vc(3),o=r.fc().index,s=r.fc();r.oc("id","click_",n,"_",o,""),r.Bb(1),r.mc("ngIf",s.isPyramid(n,o))("ngIfElse",i),r.Bb(3),r.mc("ngIf",e!==s.NONE),r.Bb(1),r.mc("ngIf",e!==s.NONE)}}function KA(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,YA,6,6,"g",7),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function JA(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",18)),2&e){const e=t.$implicit,n=r.fc();r.Cb("points",n.getTriangleCoordinate(e.x,e.y))}}function XA(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",19)),2&e){const e=r.fc();r.Cb("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function ek(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",19)),2&e){const e=r.fc();r.Cb("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function tk(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",20)),2&e){const e=r.fc();r.Cb("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function nk(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",21),r.Mb(1,"polygon",22),r.Qb(2,"text",23),r.Cc(3),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(1),r.Cb("points",e.getTilesCountCoordinate(0,0))("stroke",e.lastTurnWasTilesExchange(0)?"yellow":"black"),r.Bb(1),r.Cb("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+0*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),r.Bb(1),r.Dc(e.tiles[0])}}function rk(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",24),r.Mb(1,"polygon",25),r.Qb(2,"text",26),r.Cc(3),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(1),r.Cb("points",e.getTilesCountCoordinate(0,9))("stroke",e.lastTurnWasTilesExchange(1)?"yellow":"black"),r.Bb(1),r.Cb("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+9*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),r.Bb(1),r.Dc(e.tiles[1])}}let ik=(()=>{class e extends AA{constructor(e){super(e),this.tiles=[0,0],this.NONE=TI.NONE,this.chosenCoord=XO.empty(),this.lastStart=XO.empty(),this.lastEnd=XO.empty(),this.highlights=[],this.scores=XO.of([0,0]),this.rules=new BA(LA),this.availableMinimaxes=[new FA(this.rules,"Normal"),new jA(this.rules,"Piece > Threat > Tiles")],this.encoder=xA.encoder,this.tutorial=(new GA).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=XO.empty(),this.state=this.rules.node.gameState,this.scores=XO.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=XO.empty(),this.lastEnd=XO.empty()),this.board=this.rules.node.gameState.board}showHighlight(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=XO.empty(),this.highlights=[]}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new CI(e,t);return n.chosenCoord.isAbsent()?n.firstClick(i):n.secondClick(i)})()}firstClick(e){var t=this;return GO(function*(){const n=t.state.getPieceAt(e);if(n.is(t.state.getCurrentOpponent())){const n=xA.fromTilesExchange(e);return t.chooseMove(n,t.state,t.state.captures)}return n.is(t.state.getCurrentPlayer())?(t.chosenCoord=XO.of(e),t.showHighlight(),aS.SUCCESS):t.cancelMove(NA.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var t=this;return GO(function*(){if(e.equals(t.chosenCoord.get()))return t.cancelMoveAttempt(),aS.SUCCESS;if(t.highlights.some(t=>t.equals(e))){const n=xA.fromCoordToCoord(t.chosenCoord.get(),e);return t.chooseMove(n,t.state,t.state.captures)}return t.cancelMove(NA.INVALID_DISTANCE())})()}isPyramid(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}wasOpponent(e,t){const n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}getPyramidClass(e,t){const n=this.board[t][e];return n===TI.ZERO?this.getPlayerClass(CS.ZERO):n===TI.ONE?this.getPlayerClass(CS.ONE):"captured"}isEmptyCase(e,t){return this.board[t][e]===TI.EMPTY||this.wasRemoved(e,t)}wasRemoved(e,t){const n=this.rules.node.mother;if(this.board[t][e]===TI.NONE&&n.isPresent()){const r=n.get().gameState.getPieceAtXY(e,t);return r===TI.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,t){return this.board[t][e]===TI.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}getTilesCountCoordinate(e,t){const n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}getLineCoordinate(e,t){const n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-coerceo"]],features:[r.yb],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,KA,2,1,"g",1),r.Ac(2,JA,1,1,"polygon",2),r.Ac(3,XA,1,1,"polygon",3),r.Ac(4,ek,1,1,"polygon",3),r.Ac(5,tk,1,1,"polygon",4),r.Ac(6,nk,4,6,"g",5),r.Ac(7,rk,4,6,"g",6),r.Pb()),2&e&&(r.Cb("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.highlights),r.Bb(1),r.mc("ngIf",t.lastStart.isPresent()),r.Bb(1),r.mc("ngIf",t.lastEnd.isPresent()),r.Bb(1),r.mc("ngIf",t.chosenCoord.isPresent()),r.Bb(1),r.mc("ngIf",t.mustShowTilesOf(0)),r.Bb(1),r.mc("ngIf",t.mustShowTilesOf(1)))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),ok=(()=>{class e{}return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,e.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,e.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,e.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,e.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,e.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,e.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,e})(),sk=(()=>{class e extends VI{static getInitialState(){const t=cS.createTable(e.WIDTH,e.HEIGHT,CS.NONE);return new e(t,0)}isShelter(t){return 0===t.x||t.x===e.WIDTH-1?e.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===e.HEIGHT-1)&&e.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=e.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=e.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=e.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=e.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}return e.WIDTH=17,e.HEIGHT=17,e.CENTRAL_ZONE_TOP_LEFT=new CI(4,6),e.CENTRAL_ZONE_BOTTOM_RIGHT=new CI(12,10),e.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],e.ALL_SHELTERS=new jI(e.SHELTERS_INDICES.flatMap(t=>[new CI(t,0),new CI(t,e.HEIGHT-1),new CI(0,t),new CI(e.WIDTH-1,t)])).getCopy(),e})(),ak=(()=>{class e extends GI{constructor(e){super(e.x,e.y)}static of(t){return t.isInRange(sk.WIDTH,sk.HEIGHT)?iS.success(new e(t)):iS.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!e.isDrop()&&this.coord.equals(e.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}return e.encoder=class{static getEncoder(e,t,n){return new class extends YO{constructor(){super(...arguments),this.shiftX=t}maxValue(){return(e-1)*this.shiftX+(t-1)}encodeNumber(e){return e.coord.x*this.shiftX+e.coord.y}decodeNumber(r){const i=r%t;r/=t;const o=new CI((r-=r%1)%e,i);return n(o)}}}}.getEncoder(sk.WIDTH,sk.HEIGHT,t=>e.of(t).get()),e})(),ck=(()=>{class e extends ZT{constructor(e,t){super(e,t)}static of(t,n){return t.isInRange(sk.WIDTH,sk.HEIGHT)&&n.isInRange(sk.WIDTH,sk.HEIGHT)?t.isAlignedWith(n)&&1===t.getDistance(n)?iS.success(new e(t,n)):iS.failure(ok.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):iS.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.coord.toString()} -> ${this.end.toString()})`}equals(e){return!!e.isSimple()&&(e===this||!1!==e.coord.equals(this.coord)&&!1!==e.end.equals(this.end))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}return e.encoder=ZT.getEncoder(sk.WIDTH,sk.HEIGHT,(t,n)=>e.of(t,n).get()),e})(),lk=(()=>{class e extends HI{constructor(e){super(),this.coords=e}static of(t){if(t.length<2)return iS.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const e of t)if(e.isNotInRange(sk.WIDTH,sk.HEIGHT))return iS.failure("Move out of board");for(let e=1;e<t.length;e++){if(t[e-1].getDirectionToward(t[e]).isFailure())return iS.failure(ok.INVALID_JUMP());if(2!==t[e-1].getDistance(t[e]))return iS.failure(ok.INVALID_JUMP())}return new jI(t).size()===t.length?iS.success(new e(t)):iS.failure(ok.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const n=cS.copyImmutableArray(this.coords);return n.push(t),e.of(n)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,t)=>e+" -> "+t)})`}equals(e){return!e.isSimple()&&!e.isDrop()&&(e===this||!1!==this.getStartingCoord().equals(e.getStartingCoord())&&!1!==this.getEndingCoord().equals(e.getEndingCoord()))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}return e.encoder=new class extends QO{constructor(){super(...arguments),this.coordEncoder=CI.numberEncoder(sk.WIDTH,sk.HEIGHT)}encodeMove(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(t){WO(null!=$O.getNonNullable(t).coords,"Encoded ConspirateursMoveJump should contain coords");const n=$O.getNonNullable(t).coords.map(this.coordEncoder.decodeNumber);return e.of(n).get()}},e})();const uk=QO.disjunction3(ak.encoder,ck.encoder,lk.encoder,e=>e.isDrop(),e=>e.isSimple());let hk=(()=>{class e extends JI{constructor(){super(sk)}static get(){return e.singleton.isAbsent()&&(e.singleton=XO.of(new e)),e.singleton.get()}applyLegalMove(e,t,n){const r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=CS.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{const n=e.getStartingCoord(),i=e.getEndingCoord();r[n.y][n.x]=CS.NONE,r[i.y][i.x]=t.getCurrentPlayer()}return new sk(r,t.turn+1)}isLegal(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?iS.failure(ok.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord)!==CS.NONE?iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?iS.failure(ok.MUST_DROP_IN_CENTRAL_ZONE()):iS.success(void 0)}simpleMoveLegality(e,t){return t.turn<40?iS.failure(ok.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end)!==CS.NONE?iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE()):iS.success(void 0)}jumpLegality(e,t){if(t.turn<40)return iS.failure(ok.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===CS.NONE)return iS.failure(ok.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n)!==CS.NONE)return iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE());return iS.success(void 0)}jumpTargetsFrom(e){const t=[new CI(e.x+2,e.y),new CI(e.x-2,e.y),new CI(e.x,e.y+2),new CI(e.x,e.y-2),new CI(e.x+2,e.y+2),new CI(e.x+2,e.y-2),new CI(e.x-2,e.y+2),new CI(e.x-2,e.y-2)],n=[];for(const r of t)lk.of([e,r]).isSuccess()&&n.push(r);return n}nextJumps(e,t){const n=e.getEndingCoord(),r=[];for(const i of this.jumpTargetsFrom(n)){const n=e.addJump(i);n.isSuccess()&&this.jumpLegality(n.get(),t).isSuccess()&&r.push(n.get())}return r}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const r of sk.ALL_SHELTERS){const e=t.getPieceAt(r);if(e!==CS.NONE&&(n[e.value]+=1,20===n[e.value]))return KI.getVictory(e)}return KI.ONGOING}}return e.singleton=XO.empty(),e})();class dk extends LI{getListMoves(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=sk.CENTRAL_ZONE_TOP_LEFT,r=sk.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=n.y;i<=r.y;i++)for(let o=n.x;o<=r.x;o++)e.getPieceAtXY(o,i)===CS.NONE&&t.push(ak.of(new CI(o,i)).get());return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let r=0;r<sk.HEIGHT;r++)for(let i=0;i<sk.WIDTH;i++){const o=new CI(i,r);e.getPieceAt(o)===n&&(t=t.concat(this.getListSimpleMoves(e,o)),t=t.concat(this.getListJumps(e,o)))}return t}getListSimpleMoves(e,t){const n=[],r=[new CI(t.x+1,t.y),new CI(t.x-1,t.y),new CI(t.x,t.y+1),new CI(t.x,t.y-1),new CI(t.x+1,t.y+1),new CI(t.x+1,t.y-1),new CI(t.x-1,t.y+1),new CI(t.x-1,t.y-1)];for(const i of r){const r=ck.of(t,i);r.isSuccess()&&hk.get().simpleMoveLegality(r.get(),e).isSuccess()&&n.push(r.get())}return n}getListJumps(e,t){const n=new jI;for(const r of hk.get().jumpTargetsFrom(t)){const i=lk.of([t,r]).get();hk.get().jumpLegality(i,e).isSuccess()&&(n.add(i),n.union(this.getListJumpStartingFrom(e,i)))}return n.getCopy()}getListJumpStartingFrom(e,t){const n=hk.get().nextJumps(t,e),r=new jI(n);for(const i of n)r.union(this.getListJumpStartingFrom(e,i));return r}getBoardValue(e){const t=e.gameState;let n=0;const r=new WI;r.set(CS.ZERO,0),r.set(CS.ONE,0);for(let i=0;i<sk.HEIGHT;i++)for(let e=0;e<sk.WIDTH;e++){const o=new CI(e,i),s=t.getPieceAt(o);if(s!==CS.NONE)if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new BI(s.getVictoryValue())}else{let e=100;for(const n of sk.ALL_SHELTERS)if(t.getPieceAt(n)===CS.NONE){const t=o.getOrthogonalDistance(n);e=Math.min(e,t)}n-=s.getScoreModifier()*e}}return new BI(n)}}const fk=CS.NONE,pk=CS.ZERO,gk=CS.ONE;class mk{constructor(){this.tutorial=[nT.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,sk.getInitialState()),nT.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone.`,sk.getInitialState(),ak.of(new CI(7,7)).get(),$localize`Congratulations!`),nT.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new sk([[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,pk,gk,gk,pk,pk,gk,pk,gk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,gk,pk,gk,pk,pk,pk,pk,gk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,gk,fk,fk,fk,fk,fk,gk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,gk,pk,pk,gk,gk,gk,pk,pk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,gk,pk,gk,gk,gk,gk,gk,gk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk]],40),ck.of(new CI(4,6),new CI(3,5)).get(),(e,t)=>e.isSimple()?aS.SUCCESS:aS.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),nT.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new sk([[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,pk,gk,gk,pk,pk,gk,pk,gk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,gk,pk,gk,pk,pk,pk,pk,gk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,gk,fk,fk,fk,fk,fk,gk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,gk,pk,pk,gk,gk,gk,pk,pk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,gk,pk,gk,gk,gk,gk,gk,gk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk]],40),lk.of([new CI(6,7),new CI(6,5)]).get(),(e,t)=>e.isJump()?aS.SUCCESS:aS.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),nT.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new sk([[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,gk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,gk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,gk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,pk,fk,gk,pk,pk,gk,pk,gk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,fk,pk,gk,pk,pk,pk,pk,gk,fk,fk,fk,fk],[fk,fk,fk,fk,pk,gk,fk,fk,fk,fk,fk,gk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,gk,pk,pk,gk,gk,gk,pk,pk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,gk,pk,gk,gk,gk,gk,gk,gk,pk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk],[fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk,fk]],40),[lk.of([new CI(8,6),new CI(6,4),new CI(6,2),new CI(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}function yk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"rect",9),r.cc("click",function(){r.wc(e);const t=r.fc().$implicit;return r.fc(2).onClick(t.coord)}),r.Pb()}if(2&e){const e=r.fc().$implicit,t=r.fc(2);r.Cb("x",1.5*t.STROKE_WIDTH+t.SPACE_SIZE*e.coord.x+t.STROKE_WIDTH)("y",1.5*t.STROKE_WIDTH+t.SPACE_SIZE*e.coord.y+t.STROKE_WIDTH)("width",t.SPACE_SIZE-3*t.STROKE_WIDTH)("height",t.SPACE_SIZE-3*t.STROKE_WIDTH)}}function vk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",6),r.cc("click",function(){r.wc(e);const t=r.fc().$implicit;return r.fc(2).onClick(t.coord)}),r.Pb()}if(2&e){const e=r.fc(),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.oc("id","piece_",t,"_",i,""),r.mc("ngClass",n.pieceClasses),r.Cb("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*t+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function bk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",6),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).onClick(n.coord)}),r.Pb(),r.Ac(2,yk,1,4,"rect",7),r.Ac(3,vk,1,6,"circle",8),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","click_",n,"_",i,""),r.mc("ngClass",e.squareClasses),r.Cb("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),r.Bb(1),r.mc("ngIf",e.isShelter),r.Bb(1),r.mc("ngIf",e.hasPiece)}}function _k(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,bk,4,9,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function wk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",10),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngClass",n.viewInfo.boardInfo[e.y][e.x].shelterClasses),r.Cb("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Ck(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=t.$implicit,n=r.fc();r.nc("id","sidePiece_0_",e,""),r.Cb("cx",-n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Ek(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",12)),2&e){const e=t.$implicit,n=r.fc();r.nc("id","sidePiece_1_",e,""),r.Cb("cx",1715+n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Ok(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",13)),2&e){const e=r.fc();r.Cb("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let Sk=(()=>{class e extends SI{constructor(e){super(e),this.ALL_SHELTERS=sk.ALL_SHELTERS,this.CENTRAL_ZONE_START=sk.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new gI(sk.CENTRAL_ZONE_BOTTOM_RIGHT.x-sk.CENTRAL_ZONE_TOP_LEFT.x+1,sk.CENTRAL_ZONE_BOTTOM_RIGHT.y-sk.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=XO.empty(),this.jumpInConstruction=XO.empty(),this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH),this.rules=hk.get(),this.availableMinimaxes=[new dk(this.rules,"ConspirateursMinimax")],this.encoder=uk,this.tutorial=(new mk).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let t=0;t<sk.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(let n=0;n<sk.WIDTH;n++){const r=new CI(n,t),i=e.getPieceAt(r),o={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i!==CS.NONE,isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(o)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of sk.ALL_SHELTERS){const t=this.viewInfo.boardInfo[e.y][e.x];t.isShelter=!0,t.hasPiece&&t.shelterClasses.push("highlighted")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected")}}updateVictory(){const e=this.getState(),t=hk.get().getGameStatus(this.rules.node);if(!0===t.isEndGame)for(const n of sk.ALL_SHELTERS)e.getPieceAt(n)===t.winner&&this.viewInfo.boardInfo[n.y][n.x].squareClasses.push("victory")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";for(const t of e.coords)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=t.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=t.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=XO.empty(),this.selected=XO.empty(),this.updateBoard()}onClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());const r=t.getState();if(r.getPieceAt(e)===t.getCurrentPlayer())return t.selected=XO.of(e),t.jumpInConstruction=XO.empty(),t.updateViewInfo(),aS.SUCCESS;if(t.jumpInConstruction.isPresent())return t.constructJump(e);if(t.selected.isPresent())return t.selectNextCoord(e);if(r.isDropPhase()){const n=ak.of(e);return WO(n.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(n.get(),r)}return t.cancelMove(DI.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var t=this;return GO(function*(){const n=t.jumpInConstruction.get(),r=t.getState();if(e.equals(n.getEndingCoord()))return t.chooseMove(n,r);{const i=n.addJump(e);if(i.isFailure())return t.cancelMove(i.getReason());const o=t.rules.jumpLegality(i.get(),r);return o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(i.get())}})()}updateJump(e){var t=this;return GO(function*(){const n=t.getState();return t.rules.jumpHasPossibleNextTargets(e,n)?(t.jumpInConstruction=XO.of(e),t.updateViewInfo(),aS.SUCCESS):t.chooseMove(e,n)})()}selectNextCoord(e){var t=this;return GO(function*(){const n=t.selected.get(),r=ck.of(n,e);if(r.isSuccess())return t.chooseMove(r.get(),t.getState());{const r=lk.of([n,e]);return r.isFailure()?t.cancelMove(r.getReason()):t.updateJump(r.get())}})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-conspirateurs"]],features:[r.yb],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,_k,2,1,"g",1),r.Ac(2,wk,2,5,"g",1),r.Ac(3,Ck,1,4,"circle",2),r.Ac(4,Ek,1,4,"circle",3),r.Ac(5,Ok,1,4,"rect",4),r.Mb(6,"polyline",5),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.viewInfo.boardInfo),r.Bb(1),r.mc("ngForOf",t.ALL_SHELTERS),r.Bb(1),r.mc("ngForOf",t.range(t.viewInfo.sidePieces[0])),r.Bb(1),r.mc("ngForOf",t.range(t.viewInfo.sidePieces[1])),r.Bb(1),r.mc("ngIf",t.viewInfo.dropPhase),r.Bb(1),r.Cb("points",t.viewInfo.lastMoveArrow))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),Pk=(()=>{class e{constructor(e,t){this.owner=e,this.otherPieceType=t}static of(t,n){return t===CS.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===CS.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}return e.encoder=YO.tuple([CS.numberEncoder,YO.booleanEncoder],e=>[e.owner,e.otherPieceType],t=>e.of(t[0],t[1])),e.EMPTY=new e(CS.NONE,!1),e.ZERO_FIRST=new e(CS.ZERO,!1),e.ZERO_SECOND=new e(CS.ZERO,!0),e.ONE_FIRST=new e(CS.ONE,!1),e.ONE_SECOND=new e(CS.ONE,!0),e.PLAYER_PIECES=[e.ZERO_FIRST,e.ZERO_SECOND,e.ONE_FIRST,e.ONE_SECOND],e})(),Ik=(()=>{class e extends HI{constructor(e,t){if(super(),this.target=e,this.piece=t,t===Pk.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(e){return this.target===e.target&&this.piece===e.piece}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}return e.encoder=YO.tuple([YO.numberEncoder(7),Pk.encoder],e=>[e.target,e.piece],t=>new e(t[0],t[1])),e})(),Tk=(()=>{class e extends HI{constructor(e,t){super(),this.start=e,this.moveDirection=t}static fromRepresentation(t,n){return new e(new CI(t.x,3-t.y),n)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return!1!==this.start.equals(e.start)&&this.moveDirection===e.moveDirection}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}return e.encoder=YO.tuple([CI.numberEncoder(8,4),YO.booleanEncoder],e=>[e.start,"clockwise"===e.moveDirection],t=>new e(t[0],t[1]?"clockwise":"counterclockwise")),e})();const Ak=YO.disjunction(Ik.encoder,Tk.encoder,e=>e.isDrop());let kk=(()=>{class e{}return e.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,e.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,e.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,e.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,e.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,e})(),Nk=(()=>{class e extends VI{constructor(e,t,n){super(e,n),this.remainingPieces=t}static getInitialState(){const t=Pk.EMPTY;return new e([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static fromRepresentation(t,n){const r=t.reverse(),i=[4,4,4,4];for(let o=0;o<e.HEIGHT;o++)for(let t=0;t<e.WIDTH;t++){const n=r[o][t];r[o][t]!==Pk.EMPTY&&i[e.pieceIndex(n)]--}return WO(i.every(e=>e>=0),"Invalid DiamState representation uses too many pieces"),new e(r,i,n)}static pieceIndex(e){switch(e){case Pk.ZERO_FIRST:return 0;case Pk.ZERO_SECOND:return 1;case Pk.ONE_FIRST:return 2;default:return $O.expectToBe(e,Pk.ONE_SECOND),3}}getRemainingPiecesOf(t){return this.remainingPieces[e.pieceIndex(t)]}getStackHeight(t){let n=0;for(let r=0;r<e.HEIGHT&&this.getPieceAtXY(t,r)!==Pk.EMPTY;r++)n++;return n}}return e.WIDTH=8,e.HEIGHT=4,e})(),Mk=(()=>{class e extends JI{constructor(){super(Nk)}static get(){return e.singleton.isAbsent()&&(e.singleton=XO.of(new e)),e.singleton.get()}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=cS.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const r=cS.copyImmutableArray(t.remainingPieces);return r[Nk.pieceIndex(e.piece)]-=1,new Nk(n,r,t.turn+1)}applyLegalShift(e,t){const n=cS.copyBiArray(t.board),r=e.getTarget();let i=t.getStackHeight(r),o=e.start.y;for(;o<Nk.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==Pk.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,o),n[o][e.start.x]=Pk.EMPTY,i++,o++;return new Nk(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?iS.failure(kk.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===Nk.HEIGHT?iS.failure(kk.SPACE_IS_FULL()):iS.success(void 0)}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Nk.HEIGHT?iS.failure(kk.TARGET_STACK_TOO_HIGH()):iS.success(void 0)}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return KI.getVictory(n.owner)}return KI.ONGOING}findHighestAlignment(e){for(let t=0;t<Nk.WIDTH/2;t++)for(let n=Nk.HEIGHT-1;n>0;n--){const r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+Nk.WIDTH/2,n);if(r!==Pk.EMPTY&&r===i)return XO.of(new CI(t,n))}return XO.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new Tk(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new Tk(t,"counterclockwise"),e).isSuccess()}}return e.singleton=XO.empty(),e})();class xk extends LI{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const r of n)for(const n of[new Tk(r,"clockwise"),new Tk(r,"counterclockwise")])Mk.get().shiftHeightValidity(n,e).isSuccess()&&t.push(n);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let r=0;r<Nk.WIDTH;r++)for(const i of t){const t=new Ik(r,i);Mk.get().dropHeightValidity(t,e).isSuccess()&&n.push(t)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of Pk.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let r=0;r<Nk.HEIGHT;r++)for(let i=0;i<Nk.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new CI(i,r));return t}getBoardValue(e){const t=Mk.get().getGameStatus(e);return new BI(t.isEndGame?t.toBoardValue():0)}}const Rk=Pk.EMPTY,Dk=Pk.ZERO_FIRST,Lk=Pk.ZERO_SECOND,Bk=Pk.ONE_FIRST,Fk=Pk.ONE_SECOND;class jk{constructor(){this.tutorial=[nT.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Nk.getInitialState()),nT.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!`,Nk.fromRepresentation([[Rk,Rk,Rk,Rk,Rk,Rk,Rk,Rk],[Rk,Rk,Rk,Rk,Rk,Rk,Rk,Rk],[Rk,Rk,Rk,Rk,Bk,Rk,Rk,Rk],[Dk,Rk,Rk,Rk,Dk,Rk,Rk,Rk]],3),[new Ik(0,Pk.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),nT.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,Nk.fromRepresentation([[Rk,Rk,Rk,Rk,Rk,Rk,Rk,Rk],[Rk,Rk,Rk,Rk,Fk,Rk,Rk,Rk],[Rk,Rk,Rk,Rk,Dk,Rk,Rk,Rk],[Bk,Rk,Rk,Rk,Lk,Rk,Rk,Rk]],4),[Tk.fromRepresentation(new CI(4,3),"counterclockwise"),Tk.fromRepresentation(new CI(4,3),"clockwise"),Tk.fromRepresentation(new CI(4,2),"counterclockwise"),Tk.fromRepresentation(new CI(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),nT.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,Nk.fromRepresentation([[Rk,Rk,Rk,Rk,Dk,Rk,Rk,Rk],[Rk,Rk,Rk,Rk,Fk,Rk,Rk,Dk],[Rk,Rk,Rk,Rk,Dk,Rk,Rk,Fk],[Rk,Bk,Rk,Rk,Lk,Rk,Rk,Bk]],8),[Tk.fromRepresentation(new CI(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}function Uk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"path",6),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onSpaceClick(n)}),r.Pb(),r.Qb(2,"path",7),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onSpaceClick(n)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.nc("id","click_",e,""),r.mc("ngClass",n.viewInfo.boardInfo[e].spaceClasses),r.Cb("d",n.BOARD_PATHS[e]),r.Bb(1),r.mc("ngClass",n.viewInfo.boardInfo[e].spaceClasses),r.Cb("d",n.DECORATION_PATHS[e])}}function Vk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",9),r.cc("click",function(){r.wc(e);const n=t.$implicit,i=r.fc().$implicit;return r.fc().onPieceInGameClick(i,n.y)}),r.Mb(1,"use",10),r.Mb(2,"use",11),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc().$implicit;r.oc("id","click_",n,"_",e.y,""),r.mc("ngClass",e.foregroundClasses),r.Bb(1),r.mc("ngClass",e.backgroundClasses),r.Cb("x",e.drawPosition.x)("y",e.drawPosition.y),r.Bb(1),r.Cb("x",e.drawPosition.x)("y",e.drawPosition.y)}}function zk(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,Vk,3,8,"g",8),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngForOf",n.viewInfo.boardInfo[e].pieces)}}function Hk(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",12),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onRemainingPieceClick(n.actualPiece)}),r.Mb(1,"use",10),r.Mb(2,"use",11),r.Pb()}if(2&e){const e=t.$implicit;r.oc("id","piece_",e.actualPiece.owner.value,"_",e.actualPiece.otherPieceType?1:0,""),r.mc("ngClass",e.foregroundClasses),r.Bb(1),r.mc("ngClass",e.backgroundClasses),r.Cb("x",e.drawPosition.x)("y",e.drawPosition.y),r.Bb(1),r.Cb("x",e.drawPosition.x)("y",e.drawPosition.y)}}const Gk=function(){return[0,1,2,3,4,5,6,7]},$k=function(){return[2,1,3,0,4,7,5,6]};let qk=(()=>{class e extends SI{constructor(e){super(e),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=XO.empty(),this.viewInfo={boardInfo:[],remainingPieces:[]},this.rules=Mk.get(),this.availableMinimaxes=[new xk(this.rules,"DiamDummyMinimax")],this.encoder=Ak,this.tutorial=(new jk).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return GO(function*(){if(t.selected.isPresent()){const n=t.selected.get();let r;if("pieceFromReserve"===n.type)r=new Ik(e,n.piece);else if((n.position.x+1)%Nk.WIDTH===e)r=new Tk(n.position,"clockwise");else{if((n.position.x+(Nk.WIDTH-1))%Nk.WIDTH!==e)return t.cancelMove(kk.MUST_SHIFT_TO_NEIGHBOR());r=new Tk(n.position,"counterclockwise")}return t.chooseMove(r,t.getState())}return t.cancelMove(kk.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=XO.of({type:"pieceFromBoard",position:new CI(e,t)}),n.updateViewInfo(),aS.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(DI.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e){var t=this;return GO(function*(){const n=t.canUserPlay(t.getPieceId(e));return n.isFailure()?t.cancelMove(n.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=XO.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),aS.SUCCESS):t.cancelMove(DI.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(r,i),s=new CI(r,i);return[{start:XO.empty(),end:s,startDrawPosition:n,endDrawPosition:o}]}getLastMovedFromShift(e,t){const n=e.start.x,r=e.getTarget();let i=t.getStackHeight(r);const o=[];for(let s=e.start.y;s<Nk.HEIGHT&&t.getPieceAtXY(n,s)!==Pk.EMPTY;s++,i++)o.push({start:XO.of(new CI(n,s)),end:new CI(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,s),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<Nk.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const e=this.rules.node.move;WO(e.isPresent(),"showLastMoveOnSpaces called without a last move");const t=e.get();for(let n=0;n<Nk.WIDTH;n++){const e=[];t.isDrop()?t.getTarget()===n&&e.push("moved"):t.getTarget()!==n&&t.start.x!==n||e.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=e}}showLastMoveOnPieces(){const e=this.rules.node.move;WO(e.isPresent(),"showLastMoveOnPieces called without a last move");const t=e.get(),n=this.getPreviousState();let r=[];r=t.isDrop()?this.getLastMovedFromDrop(t,n):this.getLastMovedFromShift(t,n);for(const i of r)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];const t=this.isPlayerTurn();for(const n of Pk.PLAYER_PIECES){const r=this.getState().getRemainingPiecesOf(n);for(let i=0;i<r;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,r,n)&&o.push("selected"),t&&i===r-1&&n.owner===e&&o.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+n.owner.value+(n.otherPieceType?"-alternate":"")],foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(n,i),actualPiece:n})}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(t,n){let r,i;return r=t.owner===CS.ZERO?-100:600,i=t.otherPieceType?100:450,new CI(r,i).getNext(new gI(0,-n*e.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[];for(let i=0;i<Nk.HEIGHT;i++){const o=this.getState().getPieceAtXY(e,i),s=new CI(e,i);if(o!==Pk.EMPTY){const a=[];this.pieceFromBoardIsSelected(e,i)&&a.push("selected"),this.isVictory(e,i,t)&&a.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),s)&&a.push("clickable-hover"),r.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate":"")],foregroundClasses:a,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:o})}}return r}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const r=n.get();return r.x%4==e%4&&r.y===t}return!1}getDrawPositionOnBoard(t,n){return e.CENTER[t].getNext(new gI(0,-n*e.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=XO.empty(),this.updateBoard()}}return e.CENTER=[new CI(40,160),new CI(100,50),new CI(255,2),new CI(400,50),new CI(460,160),new CI(400,270),new CI(255,320),new CI(100,270)],e.PIECE_HEIGHT=36,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-diam"]],features:[r.yb],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"defs"),r.Qb(2,"g",1),r.Mb(3,"path",2),r.Mb(4,"ellipse",3),r.Pb(),r.Pb(),r.Ac(5,Uk,3,5,"g",4),r.Ac(6,zk,2,1,"g",4),r.Ac(7,Hk,3,8,"g",5),r.Pb()),2&e&&(r.Bb(5),r.mc("ngForOf",r.qc(3,Gk)),r.Bb(1),r.mc("ngForOf",r.qc(4,$k)),r.Bb(1),r.mc("ngForOf",t.viewInfo.remainingPieces))},directives:[he,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class Wk{constructor(e,t){this.offset=e,this.constant=t}static fromTwoCoords(e,t){const n=e.x,r=t.x,i=e.y,o=t.y,s=n+i,a=r+o;return n===r&&i!==o&&s!==a?XO.of(Wk.constantQ(n)):n!==r&&i===o&&s!==a?XO.of(Wk.constantR(i)):n!==r&&i!==o&&s===a?XO.of(Wk.constantS(s)):XO.empty()}static constantQ(e){return new Wk(e,"q")}static constantR(e){return new Wk(e,"r")}static constantS(e){return new Wk(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=Wk.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const r of e.slice(2))if(!1===n.contains(r))return!1;return!0}equals(e){return this===e||this.offset===e.offset&&this.constant===e.constant}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return kI.DOWN;case"r":return kI.RIGHT;case"s":return kI.DOWN_LEFT}}}class Zk extends VI{constructor(e,t,n,r,i,o){if(super(t,e),this.board=t,this.width=n,this.height=r,this.excludedCases=i,this.empty=o,this.excludedCases.length>=this.height/2+1)throw new Error("Invalid excluded cases specification for HexagonalGameState.")}static neighbors(e,t){return[new CI(e.x+t,e.y-t),new CI(e.x+t,e.y),new CI(e.x-t,e.y+t),new CI(e.x-t,e.y),new CI(e.x,e.y+t),new CI(e.x,e.y-t)]}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width)return!1;if(this.height!==e.height)return!1;if(!1===t(this.empty,e.empty))return!1;if(this.excludedCases.length!==e.excludedCases.length)return!1;for(let n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(Wk.constantQ(t));for(let t=0;t<this.height;t++)e.push(Wk.constantR(t));for(let t=this.excludedCases.length;t<this.height+this.excludedCases.length;t++)e.push(Wk.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new CI(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new CI(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new CI(e.offset,0):new CI(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let r=t;for(let i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}return $O.handleError("could not find a board entrance, board must be invalid"),new CI(-1,-1)}}let Qk=(()=>{class e{constructor(e,t,n){this.owner=e,this.size=t,this.source=n}static append(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}getValue(){return e.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}return e.sizeEncoder=YO.numberEncoder(49),e.encoder=YO.tuple([YO.booleanEncoder,CS.numberEncoder,e.sizeEncoder],e=>[e.source,e.owner,e.size],t=>new e(t[1],t[2],t[0])),e.MAX_SIZE=49,e.EMPTY=new e(CS.NONE,0,!1),e.NONE=new e(CS.NONE,-1,!1),e.PLAYER_ZERO=new e(CS.ZERO,1,!1),e.PLAYER_ONE=new e(CS.ONE,1,!1),e.SOURCE=new e(CS.NONE,1,!0),e})(),Yk=(()=>{class e extends Zk{constructor(t,n,r){super(n,t,e.WIDTH,e.HEIGHT,e.EXCLUDED_CASES,Qk.EMPTY),this.alreadyPassed=r}static balancedBoard(){const e=Qk.NONE,t=Qk.PLAYER_ZERO,n=Qk.PLAYER_ONE,r=Qk.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}static isOnBoard(t){return!t.isNotInRange(e.WIDTH,e.HEIGHT)&&e.balancedBoard()[t.y][t.x]!==Qk.NONE}static getInitialState(){return new e(e.balancedBoard(),0,!1)}getAllPieces(){const t=[];for(let n=0;n<e.HEIGHT;n++)for(let r=0;r<e.WIDTH;r++){const e=new CI(r,n);this.isOnBoard(e)&&!1===this.getPieceAt(e).isEmpty()&&t.push(e)}return t}numberOfNeighbors(e){return Zk.neighbors(e,1).filter(e=>this.isOnBoard(e)&&!1===this.getPieceAt(e).isEmpty()).length}setAtUnsafe(t,n){const r=cS.copyBiArray(this.board);return r[t.y][t.x]=n,new e(r,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Qk.NONE}}return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_CASES=[2,1],e})(),Kk=(()=>{class e extends ZT{constructor(e,t){super(e,t)}static of(t,n){if(-1===t.x&&-1===t.y&&-2===n.x&&-2===n.y)return e.PASS;if(!Yk.isOnBoard(t))throw new Error("Starting coord of DvonnMove must be on the board, not at "+t.toString());if(!Yk.isOnBoard(n))throw new Error("End coord of DvonnMove must be on the board, not at "+t.toString());if(t.y===n.y)return new e(t,n);if(t.x===n.x)return new e(t,n);if(t.x+t.y===n.x+n.y)return new e(t,n);throw new Error("Invalid move")}toString(){return this===e.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}length(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}return e.PASS=new e(new CI(-1,-1),new CI(-2,-2)),e.encoder=new class extends YO{maxValue(){return 42148}encodeNumber(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}decodeNumber(t){if(t<0)return e.PASS;const n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return new e(new CI((t=t/16|0)%16,i),new CI(r,n))}},e})(),Jk=(()=>{class e{}return e.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,e.EMPTY_STACK=()=>$localize`You must select a stack.`,e.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,e.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,e.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,e.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,e})();class Xk extends JI{static getGameStatus(e){const t=e.gameState,n=Xk.getScores(t);return 0===Xk.getMovablePieces(t).length?n[0]>n[1]?KI.ZERO_WON:n[0]<n[1]?KI.ONE_WON:KI.DRAW:KI.ONGOING}static getMovablePieces(e){return Xk.getFreePieces(e).filter(t=>Xk.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==Zk.neighbors(t,n).find(t=>e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return Zk.neighbors(t,n).filter(t=>e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(r=>{const i=e.getPieceAt(r);i.belongsTo(CS.ZERO)?t+=i.getSize():i.belongsTo(CS.ONE)&&(n+=i.getSize())}),[t,n]}isMovablePiece(e,t){WO(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?aS.failure(Jk.EMPTY_STACK()):n.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?aS.failure(Jk.TOO_MANY_NEIGHBORS()):Xk.pieceHasTarget(e,t)?aS.SUCCESS:aS.failure(Jk.CANT_REACH_TARGET()):aS.failure(Jk.NOT_PLAYER_PIECE())}canOnlyPass(e){return 0===Xk.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){Zk.neighbors(t,1).forEach(t=>{!e.isOnBoard(t)||n[t.y][t.x]||e.getPieceAt(t).isEmpty()||(n[t.y][t.x]=!0,this.markPiecesConnectedTo(e,t,n))})}removeDisconnectedPieces(e){const t=cS.createTable(Yk.WIDTH,Yk.HEIGHT,!1);this.sourceCoords(e).forEach(n=>{t[n.y][n.x]=!0,this.markPiecesConnectedTo(e,n,t)});let n=e;return n.getAllPieces().forEach(e=>{t[e.y][e.x]||(n=n.setAt(e,Qk.EMPTY))}),n}applyLegalMove(e,t,n){if(e===Kk.PASS)return new Yk(t.board,t.turn+1,!0);{const n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end),i=t.setAt(e.coord,Qk.EMPTY).setAt(e.end,Qk.append(n,r));return this.removeDisconnectedPieces(new Yk(i.board,t.turn+1,!1))}}isLegal(e,t){if(0===Xk.getMovablePieces(t).length)return e!==Kk.PASS||t.alreadyPassed?iS.failure(DI.MUST_PASS()):iS.success(void 0);if(e===Kk.PASS)return iS.failure(DI.CANNOT_PASS());const n=this.isMovablePiece(t,e.coord);if(n.isFailure())return n.toFailedFallible();const r=t.getPieceAt(e.coord);return e.length()!==r.getSize()?iS.failure(Jk.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?iS.failure(Jk.EMPTY_TARGET_STACK()):iS.success(void 0)}getGameStatus(e){return Xk.getGameStatus(e)}}class eN extends LI{getListMoves(e){const t=e.move,n=e.gameState,r=[];return Xk.getMovablePieces(n).forEach(e=>Xk.pieceTargets(n,e).forEach(t=>{const n=Kk.of(e,t);r.push(n)})),0===r.length&&!1===t.equalsValue(Kk.PASS)&&r.push(Kk.PASS),r}getBoardValue(e){const t=e.gameState,n=Xk.getScores(t);return 0===Xk.getMovablePieces(t).length?new BI(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new BI(n[0]-n[1])}}class tN extends eN{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),r=t.getCurrentPlayer().getOpponent();return cS.sortByDescending(n,e=>{WO(e!==Kk.PASS,"Cannot sort with DvonnMove.PASS");const n=t.getPieceAt(e.end);return n.belongsTo(r)?n.getSize():0}),n}getBoardValue(e){const t=Xk.getGameStatus(e);if(t.isEndGame)return new BI(t.toBoardValue());const n=e.gameState,r=Xk.getScores(n),i=n.getAllPieces(),o=i.length,s=i.filter(e=>n.getPieceAt(e).belongsTo(CS.ZERO)).length,a=i.filter(e=>n.getPieceAt(e).belongsTo(CS.ONE)).length;return new BI((a*r[1]-s*r[0])/o)}}const nN=Qk.EMPTY,rN=Qk.NONE,iN=Qk.SOURCE,oN=Qk.PLAYER_ZERO,sN=Qk.PLAYER_ONE,aN=new Qk(CS.ZERO,2,!1),cN=new Qk(CS.ONE,2,!1),lN=new Qk(CS.ZERO,4,!1),uN=new Qk(CS.ONE,4,!1);class hN{constructor(){this.tutorial=[nT.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Yk.getInitialState(),Kk.of(new CI(2,0),new CI(3,0)),$localize`Congratulations!`),nT.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Yk([[rN,rN,sN,iN,nN,nN,nN,nN,nN,nN,nN],[rN,nN,oN,nN,nN,nN,nN,nN,nN,nN,nN],[nN,nN,uN,nN,nN,nN,nN,sN,iN,nN,nN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,nN,rN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,rN,rN]],0,!1),Kk.of(new CI(2,1),new CI(2,0)),(e,t)=>e.end.equals(new CI(3,0))?aS.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(WO(e.end.equals(new CI(2,0)),"player made an impossible move"),aS.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),nT.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Yk([[rN,rN,iN,sN,nN,nN,nN,nN,nN,nN,nN],[rN,oN,oN,nN,nN,nN,nN,nN,nN,nN,nN],[nN,sN,oN,sN,nN,nN,oN,cN,iN,nN,nN],[nN,nN,sN,nN,nN,nN,nN,nN,nN,nN,rN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,rN,rN]],0,!1),Kk.of(new CI(2,1),new CI(2,0)),(e,t)=>e.end.equals(new CI(2,0))?aS.SUCCESS:aS.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),nT.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Yk([[rN,rN,iN,nN,nN,nN,nN,nN,nN,nN,nN],[rN,nN,aN,nN,nN,nN,nN,nN,nN,nN,nN],[nN,nN,cN,nN,nN,nN,nN,cN,iN,lN,nN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,nN,rN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,rN,rN]],0,!1)),nT.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>
        Make your last move.`,new Yk([[rN,rN,iN,nN,nN,nN,nN,nN,nN,nN,nN],[rN,nN,oN,nN,nN,nN,nN,nN,nN,nN,nN],[nN,nN,nN,nN,nN,nN,nN,nN,iN,lN,nN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,nN,rN],[nN,nN,nN,nN,nN,nN,nN,nN,nN,rN,rN]],0,!1),[Kk.of(new CI(2,1),new CI(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}function dN(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",10)),2&e){const e=r.fc().$implicit,t=r.fc().$implicit,n=r.fc();r.mc("ngClass",n.getPieceClasses(e)),r.Cb("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function fN(e,t){if(1&e&&(r.ec(),r.Mb(0,"polygon",11)),2&e){const e=r.fc().$implicit,t=r.fc().$implicit,n=r.fc();r.Cb("transform",1===e.getSize()?"translate("+(n.getCenterAt(t).x-18)+" "+(n.getCenterAt(t).y-16)+") scale(0.10)":"translate("+(n.getCenterAt(t).x-3)+" "+(n.getCenterAt(t).y-12)+") scale(0.07)")}}function pN(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"text",12),r.cc("click",function(){r.wc(e);const t=r.fc(2).$implicit;return r.fc().onClick(t.x,t.y)}),r.Cc(1),r.Pb()}if(2&e){const e=r.fc().$implicit,t=r.fc().$implicit,n=r.fc();r.Cb("x",e.containsSource()?n.getCenterAt(t).x-7:n.getCenterAt(t).x)("y",n.getCenterAt(t).y),r.Bb(1),r.Dc(e.getSize())}}function gN(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",5),r.cc("click",function(){r.wc(e);const t=r.fc().$implicit;return r.fc().onClick(t.x,t.y)}),r.Mb(1,"polyline",6),r.Ac(2,dN,1,4,"circle",7),r.Ac(3,fN,1,1,"polygon",8),r.Ac(4,pN,2,3,"text",9),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc().$implicit,i=r.fc();r.oc("id","click_",n.x,"_",n.y,""),r.Bb(1),r.Cb("points",i.getHexaCoordsAt(n)),r.Bb(1),r.mc("ngIf",e.getSize()>0),r.Bb(1),r.mc("ngIf",e.containsSource()),r.Bb(1),r.mc("ngIf",e.getSize()>1)}}const mN=function(e){return[e]};function yN(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,gN,5,6,"g",4),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngForOf",r.rc(1,mN,n.state.getPieceAt(e)))}}function vN(e,t){if(1&e&&(r.ec(),r.Qb(0,"text",16),r.Cc(1),r.Pb()),2&e){const e=r.fc().$implicit,t=r.fc();r.Cb("x",t.getCenterAt(e.coord).x)("y",t.getCenterAt(e.coord).y),r.Bb(1),r.Dc(e.caseContent.getSize())}}function bN(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Mb(1,"polyline",13),r.Mb(2,"circle",14),r.Ac(3,vN,2,3,"text",15),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.Cb("points",n.getHexaCoordsAt(e.coord)),r.Bb(1),r.oc("id","captured_",e.coord.x,"_",e.coord.y,""),r.mc("ngClass",n.getPieceClasses(e.caseContent)),r.Cb("cx",n.getCenterAt(e.coord).x)("cy",n.getCenterAt(e.coord).y)("r",n.SPACE_SIZE),r.Bb(1),r.mc("ngIf",e.caseContent.getSize()>1)}}function _N(e,t){if(1&e&&(r.ec(),r.Ob(0),r.Mb(1,"polyline",17),r.Mb(2,"polyline",17),r.Nb()),2&e){const e=r.fc();r.Bb(1),r.Cb("points",e.getHexaCoordsAt(e.lastMove.get().coord)),r.Bb(1),r.Cb("points",e.getHexaCoordsAt(e.lastMove.get().end))}}function wN(e,t){if(1&e&&(r.ec(),r.Mb(0,"polyline",18)),2&e){const e=r.fc();r.Cb("points",e.getHexaCoordsAt(e.chosen.get()))}}let CN=(()=>{class e extends PI{constructor(e){super(e),this.lastMove=XO.empty(),this.chosen=XO.empty(),this.disconnecteds=[],this.rules=new Xk(Yk),this.availableMinimaxes=[new eN(this.rules,"DvonnMinimax"),new tN(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Kk.encoder,this.tutorial=(new hN).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=XO.of(Xk.getScores(this.rules.node.gameState)),this.hexaLayout=new NI(1.5*this.SPACE_SIZE,new CI(-this.SPACE_SIZE,2*this.SPACE_SIZE),xI.INSTANCE),this.state=this.rules.node.gameState,this.hexaBoard=this.rules.node.gameState.board}hideLastMove(){this.lastMove=XO.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=XO.of(Xk.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState;for(let n=0;n<t.board.length;n++)for(let r=0;r<t.board[n].length;r++){const i=new CI(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){const o=t.getPieceAt(i),s=e.getPieceAt(i);if(o.isEmpty()&&!s.isEmpty()){const e=new CI(r,n);this.disconnecteds.push({coord:e,caseContent:s})}}}}cancelMoveAttempt(){this.chosen=XO.empty()}pass(){var e=this;return GO(function*(){return WO(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Kk.PASS,e.rules.node.gameState)})()}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.chosen.isAbsent()?n.choosePiece(e,t):n.chosen.equalsValue(new CI(e,t))?(n.cancelMoveAttempt(),aS.SUCCESS):yield n.chooseDestination(e,t)})()}choosePiece(e,t){const n=new CI(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=XO.of(n),aS.SUCCESS):this.cancelMove(r.getReason())}chooseDestination(e,t){var n=this;return GO(function*(){const r=n.chosen.get(),i=new CI(e,t),o=Kk.of(r,i);return n.chooseMove(o,n.rules.node.gameState)})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];const t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-dvonn"]],features:[r.yb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,yN,2,3,"g",1),r.Ac(2,bN,4,8,"g",1),r.Ac(3,_N,3,2,"ng-container",2),r.Ac(4,wN,1,1,"polyline",3),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.state.allCoords()),r.Bb(1),r.mc("ngForOf",t.disconnecteds),r.Bb(1),r.mc("ngIf",t.lastMove.isPresent()),r.Bb(1),r.mc("ngIf",t.chosen.isPresent()))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();var EN=function(e){return e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG",e}({});let ON=(()=>{class e{constructor(e){this.value=e}static of(e){switch(e){case 0:return this.SMALL_BLACK;case 1:return this.SMALL_WHITE;case 2:return this.MEDIUM_BLACK;case 3:return this.MEDIUM_WHITE;case 4:return this.BIG_BLACK;case 5:return this.BIG_WHITE;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(t,n){return n===CS.ZERO&&t===EN.BIG?e.BIG_BLACK:n===CS.ZERO&&t===EN.MEDIUM?e.MEDIUM_BLACK:n===CS.ZERO&&t===EN.SMALL?e.SMALL_BLACK:n===CS.ONE&&t===EN.BIG?e.BIG_WHITE:n===CS.ONE&&t===EN.MEDIUM?e.MEDIUM_WHITE:n===CS.ONE&&t===EN.SMALL?e.SMALL_WHITE:e.NONE}getPlayer(){switch(this){case e.SMALL_BLACK:case e.MEDIUM_BLACK:case e.BIG_BLACK:return CS.ZERO;case e.SMALL_WHITE:case e.MEDIUM_WHITE:case e.BIG_WHITE:return CS.ONE;default:return CS.NONE}}getSize(){switch(this){case e.BIG_BLACK:case e.BIG_WHITE:return EN.BIG;case e.MEDIUM_BLACK:case e.MEDIUM_WHITE:return EN.MEDIUM;case e.SMALL_BLACK:case e.SMALL_WHITE:return EN.SMALL;default:return $O.expectToBe(this,e.NONE),EN.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case e.BIG_BLACK:return"BIG_BLACK";case e.BIG_WHITE:return"BIG_WHITE";case e.MEDIUM_BLACK:return"MEDIUM_BLACK";case e.MEDIUM_WHITE:return"MEDIUM_WHITE";case e.SMALL_BLACK:return"SMALL_BLACK";case e.SMALL_WHITE:return"SMALL_WHITE";default:return $O.expectToBe(this,e.NONE),"NONE"}}}return e.SMALL_BLACK=new e(0),e.SMALL_WHITE=new e(1),e.MEDIUM_BLACK=new e(2),e.MEDIUM_WHITE=new e(3),e.BIG_BLACK=new e(4),e.BIG_WHITE=new e(5),e.NONE=new e(6),e})();class SN extends VI{constructor(e,t,n){super(e,t),this.remainingPieces=n}static getInitialState(){const e=new PN(CS.NONE,CS.NONE,CS.NONE).encode(),t=cS.createTable(3,3,e),n=cS.mapBiArray(t,e=>PN.decode(e));return new SN(n,0,[ON.BIG_BLACK,ON.BIG_BLACK,ON.BIG_WHITE,ON.BIG_WHITE,ON.MEDIUM_BLACK,ON.MEDIUM_BLACK,ON.MEDIUM_WHITE,ON.MEDIUM_WHITE,ON.SMALL_BLACK,ON.SMALL_BLACK,ON.SMALL_WHITE,ON.SMALL_WHITE])}getRemainingPieces(){return cS.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}let PN=(()=>{class e{constructor(e,t,n){this.small=e,this.medium=t,this.big=n}static decode(t){WO(t%1==0,"EncapsuleCase must be encoded as integer: "+t),WO(t>=0,"To small representation for EncapsuleCase: "+t),WO(t<=26,"To big representation for EncapsuleCase: "+t);const n=CS.of(t%3);t-=n.value;const r=CS.of((t/=3)%3);t-=r.value;const i=CS.of(t/=3);return new e(n,r,i)}isEmpty(){return this.small===CS.NONE&&this.medium===CS.NONE&&this.big===CS.NONE}toList(){const e=[];return this.small!==CS.NONE&&e.push(ON.ofSizeAndPlayer(EN.SMALL,this.small)),this.medium!==CS.NONE&&e.push(ON.ofSizeAndPlayer(EN.MEDIUM,this.medium)),this.big!==CS.NONE&&e.push(ON.ofSizeAndPlayer(EN.BIG,this.big)),e}toOrderedPieceNames(){const e=ON.ofSizeAndPlayer(EN.SMALL,this.small),t=ON.ofSizeAndPlayer(EN.MEDIUM,this.medium),n=ON.ofSizeAndPlayer(EN.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===CS.ZERO?ON.BIG_BLACK:this.big===CS.ONE?ON.BIG_WHITE:this.medium===CS.ZERO?ON.MEDIUM_BLACK:this.medium===CS.ONE?ON.MEDIUM_WHITE:this.small===CS.ZERO?ON.SMALL_BLACK:this.small===CS.ONE?ON.SMALL_WHITE:ON.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===ON.NONE)throw new Error("Cannot move NONE on a space");return e.getSize()>t?XO.of(this.put(e)):XO.empty()}removeBiggest(){const t=this.getBiggest();if(t===ON.NONE)throw new Error("Cannot removed piece from empty space");let n;const r=t.getSize();switch(r){case EN.BIG:n=new e(this.small,this.medium,CS.NONE);break;case EN.MEDIUM:n=new e(this.small,CS.NONE,CS.NONE);break;default:$O.expectToBe(r,EN.SMALL),n=new e(CS.NONE,CS.NONE,CS.NONE)}return{removedCase:n,removedPiece:t}}put(t){if(t===ON.NONE)throw new Error("Cannot put NONE on space");const n=t.getPlayer(),r=t.getSize();switch(r){case EN.BIG:return new e(this.small,this.medium,n);case EN.MEDIUM:return WO(this.big===CS.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return $O.expectToBe(r,EN.SMALL),WO(this.big===CS.NONE,"Cannot put a piece on top of a bigger one"),WO(this.medium===CS.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}return e.EMPTY=new e(CS.NONE,CS.NONE,CS.NONE),e})(),IN=(()=>{class e{}return e.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,e.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,e.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,e.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,e.SAME_DEST_AS_ORIGIN=()=>$localize`You must select a different landing square than the square where the move originates from.`,e.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,e})(),TN=(()=>{class e extends JI{static isVictory(t){const n=t.getCopiedBoard();let r,i=XO.empty(),o=0;for(;i.isAbsent()&&o<8;)r=e.LINES[o++],i=e.isVictoriousLine([n[r[0].y][r[0].x],n[r[1].y][r[1].x],n[r[2].y][r[2].x]]);return i}static isVictoriousLine(e){const t=e.map(e=>e.getBiggest()).map(e=>e.getPlayer());return t[0]===CS.NONE?XO.empty():t[0]===t[1]&&t[1]===t[2]?XO.of(t[0]):XO.empty()}static isLegal(e,t){let n;if(qO(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return iS.failure(IN.PIECE_OUT_OF_STOCK())}else{const r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE())}const r=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return r.isPresent()?iS.success(r.get()):iS.failure(IN.INVALID_PLACEMENT())}isLegal(t,n){return e.isLegal(t,n)}applyLegalMove(e,t,n){const r=t.getCopiedBoard();let i=t.getRemainingPieces();const o=t.turn+1;let s;if(r[e.landingCoord.y][e.landingCoord.x]=PN.decode(n.encode()),e.isDropping()){s=e.piece.get();const t=i.indexOf(s);i=i.slice(0,t).concat(i.slice(t+1))}else{const t=e.startingCoord.get(),n=r[t.y][t.x].encode(),i=PN.decode(n).removeBiggest();r[t.y][t.x]=PN.decode(i.removedCase.encode()),s=i.removedPiece}return new SN(r,o,i)}static getGameStatus(t){const n=e.isVictory(t.gameState);return n.isPresent()?KI.getVictory(n.get()):KI.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.LINES=[[new CI(0,0),new CI(0,1),new CI(0,2)],[new CI(1,0),new CI(1,1),new CI(1,2)],[new CI(2,0),new CI(2,1),new CI(2,2)],[new CI(0,0),new CI(1,0),new CI(2,0)],[new CI(0,1),new CI(1,1),new CI(2,1)],[new CI(0,2),new CI(1,2),new CI(2,2)],[new CI(0,0),new CI(1,1),new CI(2,2)],[new CI(0,2),new CI(1,1),new CI(2,0)]],e})(),AN=(()=>{class e extends HI{constructor(e,t,n){super(),this.startingCoord=e,this.landingCoord=t,this.piece=n}static fromMove(t,n){if(t.equals(n))throw new Error("Starting coord and landing coord must be separate coords");return new e(XO.of(t),n,XO.empty())}static fromDrop(t,n){return new e(XO.empty(),n,XO.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}return e.encoder=new class extends YO{maxValue(){return 161}encodeNumber(e){const t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){const r=0;return 18*e.piece.get().value+6*t+2*n+r}{const r=1,i=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*i+6*t+2*n+r}}decodeNumber(t){const n=t%2;t-=n;const r=(t/=2)%3;t-=r;const i=(t/=3)%3;t-=i,t/=3;const o=new CI(i,r);if(0===n){const n=ON.of(t);return e.fromDrop(n,o)}{const n=t%3;t-=n;const r=new CI((t/=3)%3,n);return e.fromMove(r,o)}}},e})();class kN extends LI{getBoardValue(e){const t=TN.getGameStatus(e);return new BI(t.toBoardValue())}getListMoves(e){const t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),o=FI.toComparableObjectSet(n.getPlayerRemainingPieces());for(let s=0;s<3;s++)for(let e=0;e<3;e++){const a=new CI(e,s);for(const e of o){const r=AN.fromDrop(e,a);TN.isLegal(r,n).isSuccess()&&t.push(r)}if(r[s][e].belongsTo(i))for(let e=0;e<3;e++)for(let r=0;r<3;r++){const i=new CI(r,e);if(!i.equals(a)){const e=AN.fromMove(a,i);TN.isLegal(e,n).isSuccess()&&t.push(e)}}}return t}}const NN=new PN(CS.NONE,CS.NONE,CS.NONE),MN=new PN(CS.ZERO,CS.NONE,CS.NONE),xN=new PN(CS.NONE,CS.ZERO,CS.NONE),RN=new PN(CS.NONE,CS.NONE,CS.ZERO),DN=new PN(CS.ONE,CS.NONE,CS.NONE),LN=new PN(CS.NONE,CS.NONE,CS.ONE),BN=new PN(CS.ONE,CS.ZERO,CS.NONE),FN=new PN(CS.ZERO,CS.ZERO,CS.NONE);class jN{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new SN([[MN,DN,LN],[NN,xN,NN],[NN,NN,RN]],0,[ON.SMALL_BLACK,ON.MEDIUM_BLACK,ON.BIG_BLACK,ON.SMALL_WHITE,ON.MEDIUM_WHITE,ON.MEDIUM_WHITE,ON.BIG_WHITE])),nT.anyMove($localize`Putting a piece`,$localize`This is the initial board. You're playing Dark.<br/><br/>
        Pick one of your piece on the side of the board and put it on the board.`,SN.getInitialState(),AN.fromDrop(ON.SMALL_BLACK,new CI(1,1)),$localize`Congratulations!`),nT.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        Click on your dark piece and then on any empty square of the board.`,new SN([[MN,LN,NN],[NN,NN,NN],[NN,NN,NN]],0,[]),[AN.fromMove(new CI(0,0),new CI(2,0)),AN.fromMove(new CI(0,0),new CI(0,1)),AN.fromMove(new CI(0,0),new CI(1,1)),AN.fromMove(new CI(0,0),new CI(2,1)),AN.fromMove(new CI(0,0),new CI(0,2)),AN.fromMove(new CI(0,0),new CI(1,2)),AN.fromMove(new CI(0,0),new CI(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),nT.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        You're playing Dark and you can win now in various ways.<br/><br/>
        Try to win by making a move, and not by putting a new piece on the board.`,new SN([[BN,NN,DN],[FN,LN,LN],[NN,NN,NN]],0,[ON.MEDIUM_BLACK,ON.BIG_BLACK,ON.MEDIUM_WHITE,ON.MEDIUM_WHITE]),AN.fromMove(new CI(0,1),new CI(0,2)),(e,t)=>{if(e.landingCoord.equals(new CI(0,2))){if(e.isDropping())return aS.failure($localize`You won, but the exercise is to win while moving a piece!`);if(e.startingCoord.equalsValue(new CI(0,1)))return aS.SUCCESS}return aS.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function UN(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",5),r.cc("click",function(){r.wc(e);const n=t.$implicit,i=t.index;return r.fc().onPieceClick(0,n,i)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc();r.Bb(1),r.nc("id","piece_0_",e.toString(),""),r.mc("ngClass",i.getSidePieceClasses(e,n)),r.Cb("r",i.getPieceRadius(e))("cx",i.getPieceLeftX(0,n)+i.getPieceRadius(e))("cy",i.SPACE_SIZE/2)}}function VN(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",8),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onBoardClick(t,n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc().index,i=r.fc().index,o=r.fc();r.mc("ngClass",o.getPieceClasses(e)),r.Cb("r",o.getPieceRadius(e))("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function zN(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",6),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onBoardClick(n,i)}),r.Pb(),r.Ac(2,VN,1,4,"circle",7),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","click_",n,"_",i,""),r.mc("ngClass",o.getRectClasses(n,i)),r.Cb("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),r.Bb(1),r.mc("ngForOf",o.getListPieces(e))}}function HN(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,zN,3,8,"g",2),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function GN(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",9),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onBoardClick(n.x,n.y)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.Cb("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function $N(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",5),r.cc("click",function(){r.wc(e);const n=t.$implicit,i=t.index;return r.fc().onPieceClick(1,n,i)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc();r.Bb(1),r.nc("id","piece_1_",e.toString(),""),r.mc("ngClass",i.getSidePieceClasses(e,n)),r.Cb("r",i.getPieceRadius(e))("cx",i.getPieceLeftX(1,n)+i.getPieceRadius(e))("cy",i.SPACE_SIZE/2)}}let qN=(()=>{class e extends BT{constructor(e){super(e),this.INTER_PIECE_SPACE=20,this.lastLandingCoord=XO.empty(),this.lastStartingCoord=XO.empty(),this.chosenCoord=XO.empty(),this.chosenPiece=XO.empty(),this.remainingPieceLeftX=[],this.rules=new TN(SN),this.availableMinimaxes=[new kN(this.rules,"EncapsuleMinimax")],this.encoder=AN.encoder,this.tutorial=(new jN).tutorial,this.updateBoard()}updateBoard(){this.board=this.rules.node.gameState.getCopiedBoard();const e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=XO.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=XO.empty(),this.lastStartingCoord=XO.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(CS.of(e))}onBoardClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new CI(e,t),o=n.rules.node.gameState;if(n.chosenCoord.isAbsent()){if(n.chosenCoord=XO.of(i),n.chosenPiece.isPresent()){const e=AN.fromDrop(n.chosenPiece.get(),i);return n.chooseMove(e,n.rules.node.gameState)}return!1===o.getPieceAt(i).belongsTo(o.getCurrentPlayer())?n.cancelMove(IN.INVALID_PIECE_SELECTED()):aS.SUCCESS}if(n.chosenCoord.equalsValue(i))return n.cancelMove(IN.SAME_DEST_AS_ORIGIN());{const e=AN.fromMove(n.chosenCoord.get(),i);return n.chooseMove(e,n.rules.node.gameState)}})()}cancelMoveAttempt(){this.chosenCoord=XO.empty(),this.chosenPiece=XO.empty(),this.chosenPieceIndex=-1}onPieceClick(e,t,n){var r=this;return GO(function*(){const i=r.canUserPlay("#piece_"+e+"_"+t.toString());return i.isFailure()?r.cancelMove(i.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(IN.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=XO.of(t),r.chosenPieceIndex=n,aS.SUCCESS):r.cancelMove(IN.END_YOUR_MOVE())})()}getRectClasses(e,t){return this.isSelected(e,t)?"moved":""}isSelected(e,t){const n=new CI(e,t);return!!this.lastStartingCoord.equalsValue(n)||!!this.lastLandingCoord.equalsValue(n)}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceStrokeClass(e){return"player"+e.getPlayer().value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case EN.BIG:return 40;case EN.MEDIUM:return 30;default:return $O.expectToBe(e.getSize(),EN.SMALL),20}}getHighlightedCases(){const e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}getSidePieceClasses(e,t){const n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftX(){this.remainingPieceLeftX=[];for(let e=0;e<=1;e++){this.remainingPieceLeftX.push([]);const t=this.getRemainingPieces(e);for(let n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{const r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}getPieceLeftX(e,t){return this.remainingPieceLeftX[e][t]}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-encapsule"]],features:[r.yb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"g",null,1),r.Ac(3,UN,2,5,"g",2),r.Pb(),r.Qb(4,"g",null,3),r.Ac(6,HN,2,1,"g",2),r.Ac(7,GN,2,4,"g",2),r.Pb(),r.Qb(8,"g",null,4),r.Ac(10,$N,2,5,"g",2),r.Pb(),r.Pb()),2&e&&(r.Bb(1),r.Cb("transform","translate("+t.STROKE_WIDTH+", 0)"),r.Bb(2),r.mc("ngForOf",t.getRemainingPieces(0)),r.Bb(1),r.Cb("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),r.Bb(2),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.getHighlightedCases()),r.Bb(1),r.Cb("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),r.Bb(2),r.mc("ngForOf",t.getRemainingPieces(1)))},directives:[he,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),WN=(()=>{class e extends GI{constructor(e,t,n,r,i){if(super(e,t),this.movedPieces=n,this.stepSize=r,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(n<1)throw new Error("Must select minimum one piece (got "+n+").");if(r<1)throw new Error("Step size must be minimum one (got "+r+").");if(r>n)throw new Error("Cannot move a phalanx further than its size (got step size "+r+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!!this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}return e.encoder=new class extends YO{maxValue(){return 122303}encodeNumber(e){const t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}decodeNumber(t){if(t%1!=0)throw new Error("EncodedMove must be an integer.");const n=t%8;t-=n;const r=(t/=8)%7;t-=r;const i=(t/=7)%13;t-=i;const o=(t/=13)%12;t-=o;const s=t/=12,a=bI.factory.fromInt(n);return new e(s,o,i+1,r+1,a.get())}},e})();class ZN extends VI{static getInitialState(){const e=CS.NONE,t=CS.ONE,n=CS.ZERO;return new ZN([[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n]],0)}count(e,t){let n=0;for(let r=0;r<14;r++)this.board[t][r]===e&&n++;return n}doesOwnPiece(e){for(let t=0;t<12;t++)for(let n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}let QN=(()=>{class e{}return e.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,e.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,e.CASE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,e.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,e.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,e.CASE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=()=>$localize`A phalanx cannot contain an empty square.`,e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,e})();class YN extends JI{static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return iS.failure(n.getReason());const r=this.getLandingStatus(t,e);if(r.isFailure())return r;const i=cS.copyBiArray(r.get()),o=t.getCurrentOpponent(),s=YN.getCaptureValidity(t,i,e,o);return s.isFailure()?s:iS.success(s.get())}static getPhalanxValidity(e,t){let n,r=t.coord,i=0;const o=e.getCurrentOpponent();for(;i<t.movedPieces;){if(r.isNotInRange(14,12))return aS.failure(QN.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());if(n=e.getPieceAt(r),n===CS.NONE)return aS.failure(QN.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(n===o)return aS.failure(QN.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(t.direction,1),i++}return aS.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),r=e.getCurrentPlayer();let i=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),s=0;for(;s+1<t.stepSize;){if(n[i.y][i.x]=CS.NONE,n[o.y][o.x]=r,o.isNotInRange(14,12))return iS.failure(QN.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o)!==CS.NONE)return iS.failure(QN.SOMETHING_IN_PHALANX_WAY());s++,o=o.getNext(t.direction,1),i=i.getNext(t.direction,1)}return o.isNotInRange(14,12)?iS.failure(QN.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===r?iS.failure(DI.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=CS.NONE,n[o.y][o.x]=r,iS.success(n))}static getCaptureValidity(e,t,n,r){let i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1);const o=CS.NONE;let s=0;for(;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(s>0&&(t[i.y][i.x]=o),s++,s>=n.movedPieces)return iS.failure(QN.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return iS.success(t)}isLegal(e,t){return YN.isLegal(e,t)}applyLegalMove(e,t,n){return new ZN(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(CS.ZERO,0),r=t.count(CS.ONE,11);if(t.turn%2==0){if(n>r)return KI.ZERO_WON}else if(r>n)return KI.ONE_WON;return!1===t.doesOwnPiece(CS.ZERO)?KI.ONE_WON:!1===t.doesOwnPiece(CS.ONE)?KI.ZERO_WON:KI.ONGOING}}class KN extends LI{static getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),r=CS.NONE;let i=[];const o=e.gameState;let s;for(let a=0;a<12;a++)for(let e=0;e<14;e++){const c=new CI(e,a);if(o.getPieceAt(c)===t)for(const l of bI.DIRECTIONS){let u=1,h=c.getNext(l,1);for(;h.isInRange(14,12)&&o.getPieceAt(h)===t;)u+=1,h=h.getNext(l,1);let d=1;for(;h.isInRange(14,12)&&d<=u&&o.getPieceAt(h)===r;)s=new WN(e,a,u,d,l),i=this.addMove(i,s,o),d++,h=h.getNext(l,1);h.isInRange(14,12)&&d<=u&&o.getPieceAt(h)===n&&(s=new WN(e,a,u,d,l),i=this.addMove(i,s,o))}}return i}static addMove(e,t,n){return YN.isLegal(t,n).isSuccess()&&e.push(t),e}getListMoves(e){const t=KN.getListMoves(e);return cS.sortByDescending(t,e=>e.stepSize),t}getBoardValue(e){const t=this.ruler.getGameStatus(e);return new BI(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){let t=0;for(let n=0;n<12;n++){let r=0;const i=[0,0];for(let o=0;o<14;o++){const s=new CI(o,n),a=e.getPieceAt(s);if(a!==CS.NONE){const n=a.getScoreModifier();t+=2002*n,i[a.value]=n,r+=n;for(const r of[bI.UP_LEFT,bI.UP,bI.UP_RIGHT]){let i=s.getNext(r,1);for(;i.isInRange(14,12)&&e.getPieceAt(i)===a;)t+=1*n,i=i.getNext(r,1)}}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce((e,t)=>e+t)}return t}}class JN extends LI{getListMoves(e){const t=KN.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return cS.sortByDescending(e,e=>e.movedPieces),e.length>40?e.filter(e=>!!this.moveIsCapture(e,t)||e.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}getBoardValue(e){const t=this.ruler.getGameStatus(e);return new BI(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=new CI(r,n),o=e.getPieceAt(i);if(o!==CS.NONE){let r,s;o===CS.ZERO?(r=12-n,s=[bI.UP_LEFT,bI.UP,bI.UP_RIGHT]):(r=n+1,s=[bI.DOWN_LEFT,bI.DOWN,bI.DOWN_RIGHT]);const a=o.getScoreModifier();t+=r*a,t+=149629*a;for(const n of s){let r=i.getNext(n,1);for(;r.isInRange(14,12)&&e.getPieceAt(r)===o;)t+=337*a,r=r.getNext(n,1)}}}return t}}class XN extends KN{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new CI(r,n));i!==CS.NONE&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<14;n++)e.getPieceAt(new CI(n,11))===CS.ZERO&&(t+=CS.ZERO.getScoreModifier()),e.getPieceAt(new CI(n,0))===CS.ONE&&(t+=CS.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new CI(r,n));if(i!==CS.NONE){for(let o=-1;o<=1;o++)for(let s=-1;s<=1;s++){const a=new CI(r+o,n+s);if(a.isInRange(14,12)){const n=e.getPieceAt(a);(n===i||n===CS.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<14;n++)e.getPieceAt(new CI(n,0))===CS.ZERO&&(t+=CS.ZERO.getScoreModifier()),e.getPieceAt(new CI(n,11))===CS.ONE&&(t+=CS.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new CI(r,n));i!==CS.NONE&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,r=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const s=new CI(o,i),a=e.getPieceAt(s);if(a!==CS.NONE)for(const i of bI.DIRECTIONS){let o=1,c=s.getNext(i,1);for(;c.isInRange(14,12)&&e.getPieceAt(c)===a;)o+=1,c=c.getNext(i,1);let l=1;for(;c.isInRange(14,12)&&l<=o&&e.getPieceAt(c)===CS.NONE;)l++,c=c.getNext(i,1);t+=l*l*a.getScoreModifier(),a===CS.ZERO?n=Math.max(n,l):a===CS.ONE&&(r=Math.max(r,l))}}return(t+n*CS.ZERO.getScoreModifier()+r*CS.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(e){const t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new BI(n.toBoardValue());const r=this.getDominance(t),i=this.getDefense(t),o=this.getTerritory(t),s=this.getCenter(t),a=this.getOffense(t),c=this.getMobility(t);return new BI(r+i+o+s+a+c)}}const eM=CS.NONE,tM=CS.ZERO,nM=CS.ONE;class rM{constructor(){this.tutorial=[nT.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,ZN.getInitialState()),nT.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new ZN([[eM,eM,eM,eM,eM,tM,eM,eM,nM,nM,nM,nM,nM,nM],[eM,eM,eM,eM,eM,tM,eM,eM,eM,eM,eM,eM,nM,nM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,nM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,tM,tM,tM,tM,eM,eM,eM]],0)),nT.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new ZN([[eM,eM,eM,eM,eM,tM,eM,eM,eM,eM,nM,nM,nM,nM],[eM,eM,eM,eM,eM,tM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,nM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,nM,nM,eM,eM,eM,tM,tM,eM,tM,tM,tM,tM]],1)),nT.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol>`,ZN.getInitialState(),new WN(0,10,1,1,bI.UP),(e,t)=>1===e.movedPieces?aS.SUCCESS:aS.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),nT.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        Move a phalanx!`,ZN.getInitialState(),new WN(0,11,2,1,bI.UP),(e,t)=>e.movedPieces>1?aS.SUCCESS:aS.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),nT.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        Capture a phalanx.`,new ZN([[eM,eM,eM,eM,eM,eM,eM,eM,nM,nM,nM,nM,nM,nM],[eM,eM,eM,eM,eM,eM,nM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,nM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,nM,eM,nM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,nM,nM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,nM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,tM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,tM,eM,eM,eM,eM,nM,eM,eM,eM,eM,eM,eM],[eM,eM,tM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,tM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM,eM],[eM,eM,eM,eM,eM,eM,eM,tM,tM,tM,tM,tM,tM,tM]],0),[new WN(2,10,4,2,bI.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function iM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",4),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getPieceClasses(e,t)),r.Cb("r",.5*(n.SPACE_SIZE-2*n.STROKE_WIDTH))("cx",n.SPACE_SIZE*e+n.STROKE_WIDTH+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.STROKE_WIDTH+n.SPACE_SIZE/2)}}function oM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",2),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Pb(),r.Ac(2,iM,1,4,"circle",3),r.Pb()}if(2&e){const e=t.index,n=r.fc().index,i=r.fc();r.Bb(1),r.oc("id","click_",e,"_",n,""),r.mc("ngClass",i.getRectClasses(e,n)),r.Cb("x",i.SPACE_SIZE*e+i.STROKE_WIDTH)("y",i.SPACE_SIZE*n+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),r.Bb(1),r.mc("ngIf",i.board[n][e]!==i.NONE)}}function sM(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,oM,3,8,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function aM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",5),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n.x,n.y)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.Cb("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let cM=(()=>{class e extends BT{constructor(e){super(e),this.NONE=CS.NONE,this.firstPiece=XO.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=XO.empty(),this.phalanxDirection=XO.empty(),this.phalanxMiddles=[],this.moveds=[],this.captureds=[],this.rules=new YN(ZN),this.availableMinimaxes=[new KN(this.rules,"Normal"),new JN(this.rules,"Positional"),new XN(this.rules,"Attack")],this.encoder=WN.encoder,this.tutorial=(new rM).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=XO.empty(),this.lastPiece=XO.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let t=e.coord;this.moveds=[t];for(let i=1;i<e.stepSize+e.movedPieces;i++)t=t.getNext(e.direction,1),this.moveds.push(t);const n=this.rules.node.mother.get(),r=n.gameState.getCurrentOpponent();for(;t.isInRange(14,12)&&n.gameState.getPieceAt(t)===r;)this.captureds.push(t),t=t.getNext(e.direction,1)}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t)})()}firstClick(e,t){var n=this;return GO(function*(){const r=n.rules.node.gameState.getCurrentOpponent(),i=n.rules.node.gameState.getCurrentPlayer();switch(n.board[t][e]){case i:return n.firstPiece=XO.of(new CI(e,t)),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),aS.SUCCESS;case r:return n.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE());default:return $O.expectToBe(n.board[t][e],CS.NONE),n.cancelMove(DI.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.captureds=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const t=[];for(const n of bI.DIRECTIONS){let r=this.firstPiece.get().getNext(n,1);for(;r.isInRange(14,12)&&this.board[r.y][r.x]===e;)t.push(r),r=r.getNext(n,1)}return t}getPhalanxValidExtensions(e){let t=bI.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();const i=this.firstPiece.get().getNext(t,1),o=this.getExtensionsToward(i,t,e);return r.concat(o)}getExtensionsToward(e,t,n){const r=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1;let o=bI.factory.fromMove(e,t).get();const s=t.getNext(o,1),a=this.getLandingsToward(s,o,i);o=o.getOpposite();const c=e.getNext(o,1);return this.getLandingsToward(c,o,i).concat(a)}return this.getNeighbooringEmptyCases()}getNeighbooringEmptyCases(){const e=[];for(const t of bI.DIRECTIONS){const n=this.firstPiece.get().getNext(t,1);n.isInRange(14,12)&&this.board[n.y][n.x]===CS.NONE&&e.push(n)}return e}getLandingsToward(e,t,n){const r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),o=[];for(;e.isInRange(14,12)&&o.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&o.push(e),o;o.push(e),e=e.getNext(t,1)}return o}getPhalanxLength(e,t,n){let r=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}cancelMoveAttempt(){this.firstPiece=XO.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=XO.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,t){var n=this;return GO(function*(){const r=new CI(e,t),i=n.firstPiece.get();if(r.equals(i))return n.cancelMoveAttempt(),aS.SUCCESS;const o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer();if(!r.isAlignedWith(i))return n.cancelMove(QN.CASE_NOT_ALIGNED_WITH_SELECTED());const a=r.getDistance(i),c=i.getDirectionToward(r).get();switch(n.board[t][e]){case CS.NONE:return 1===a?n.tryMove(new WN(i.x,i.y,1,1,c)):n.cancelMove(QN.SINGLE_PIECE_MUST_MOVE_BY_ONE());case o:return n.cancelMove(QN.SINGLE_PIECE_CANNOT_CAPTURE());default:$O.expectToBe(n.board[t][e],s);const l=new WN(i.x,i.y,a,1,c),u=YN.getPhalanxValidity(n.rules.node.gameState,l);return u.isFailure()?n.cancelMove(u.getReason()):(n.lastPiece=XO.of(r),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=i.getCoordsToward(r),n.phalanxDirection=XO.of(c),aS.SUCCESS)}})()}thirdClick(e,t){var n=this;return GO(function*(){const r=n.rules.node.gameState.getCurrentPlayer(),i=new CI(e,t);if(n.firstPiece.equalsValue(i))return n.moveFirstPiece(r);if(n.lastPiece.equalsValue(i))return n.moveLastPiece(r);const o=n.firstPiece.get(),s=n.lastPiece.get();if(!i.isAlignedWith(o))return n.cancelMove(QN.CASE_NOT_ALIGNED_WITH_PHALANX());let a=bI.factory.fromMove(o,s).get();const c=bI.factory.fromMove(o,i).get();if(a===c.getOpposite()&&(n.firstPiece=XO.of(s),n.lastPiece=XO.of(o),a=c),a!==c)return n.cancelMove(QN.CASE_NOT_ALIGNED_WITH_PHALANX());if(n.board[t][e]===r){n.lastPiece=XO.of(i);const e=n.firstPiece.get().getDistance(i)+1,t=new WN(n.firstPiece.get().x,n.firstPiece.get().y,e,1,a),o=YN.getPhalanxValidity(n.rules.node.gameState,t);return o.isFailure()?n.cancelMove(o.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(r),n.phalanxValidLandings=n.getPhalanxValidLandings(),aS.SUCCESS)}{const e=n.firstPiece.get().getDistance(n.lastPiece.get())+1,t=n.lastPiece.get().getDistance(i),r=new WN(n.firstPiece.get().x,n.firstPiece.get().y,e,t,a);return n.tryMove(r)}})()}moveFirstPiece(e){var t=this;return GO(function*(){return t.firstPiece=XO.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?yield t.moveOnlyPiece(e):(t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e)),t.phalanxValidLandings=t.getPhalanxValidLandings(),aS.SUCCESS})()}moveLastPiece(e){var t=this;return GO(function*(){return t.lastPiece=XO.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),aS.SUCCESS)})()}moveOnlyPiece(e){var t=this;return GO(function*(){return t.lastPiece=XO.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=XO.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),aS.SUCCESS})()}tryMove(e){const t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}getPieceClasses(e,t){const n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}getPieceStrokeClasses(e,t){const n=new CI(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(e=>e.equals(n))?["highlighted"]:[]}getRectClasses(e,t){const n=new CI(e,t);return this.captureds.some(e=>e.equals(n))?["captured"]:this.moveds.some(e=>e.equals(n))?["moved"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],t=this.rules.node.gameState.getCurrentPlayer();for(let n=0;n<this.board.length;n++)for(let r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new CI(r,n));return e}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-epaminondas"]],features:[r.yb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,sM,2,1,"g",1),r.Ac(2,aM,2,4,"g",1),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.getHighlightedCoords()))},directives:[he,le,fe],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),lM=(()=>{class e{constructor(e){if(e.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Wk.areOnSameLine(e))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=cS.copyImmutableArray(e).sort((e,t)=>{if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});let t=XO.empty();for(const n of this.capturedSpaces){if(t.isPresent()&&1!==t.get().getDistance(n))throw new Error("Cannot create a GipfCapture with non-consecutive cases");t=XO.of(n)}}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return Wk.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}return e.encoder=new class extends ZO{encode(e){return e.capturedSpaces.map(e=>CI.encoder.encode(e))}decode(t){return new e(t.map(e=>CI.encoder.decode(e)))}},e})(),uM=(()=>{class e{constructor(e,t){this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}return e.encoder=new class extends ZO{constructor(){super(...arguments),this.optionalDirectionEncoder=XO.encoder(kI.encoder)}encode(e){return{coord:CI.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}decode(t){const n=t;return WO(null!=n.coord,"Invalid encoded GipfPlacement"),new e(CI.encoder.decode(n.coord),this.optionalDirectionEncoder.decode(n.direction))}},e})(),hM=(()=>{class e extends HI{constructor(e,t,n){super(),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!1!==this.placement.equals(e.placement)&&!1!==cS.compareArray(this.initialCaptures,e.initialCaptures)&&!1!==cS.compareArray(this.finalCaptures,e.finalCaptures)}encode(){return e.encoder.encode(this)}decode(t){return e.encoder.decode(t)}}return e.encoder=new class extends QO{encodeMove(e){const t={placement:uM.encoder.encode(e.placement)};return e.initialCaptures.map((e,n)=>{t["initialCapture"+n]=lM.encoder.encode(e)}),e.finalCaptures.map((e,n)=>{t["finalCapture"+n]=lM.encoder.encode(e)}),t}decodeMove(t){const n=t;return WO(null!=n.placement,"Invalid encoded GipfMove"),new e(uM.encoder.decode(n.placement),this.decodeArray(n,"initialCapture",lM.encoder.decode),this.decodeArray(n,"finalCapture",lM.encoder.decode))}decodeArray(e,t,n){const r=[];for(let i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}},e})();class dM extends Zk{constructor(e,t,n,r){super(t,e,7,7,[3,2,1],TI.EMPTY),this.sidePieces=n,this.capturedPieces=r}static getInitialState(){const e=TI.EMPTY,t=TI.NONE,n=TI.ZERO,r=TI.ONE;return new dM([[t,t,t,r,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,r],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[r,e,e,n,t,t,t]],0,[12,12],[0,0])}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&cS.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=cS.copyBiArray(this.board);return n[e.y][e.x]=t,new dM(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==TI.NONE}}let fM=(()=>{class e{}return e.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,e.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,e.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,e.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,e.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,e.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,e.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,e.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,e.CLICK_FURTHER_THAN_ONE_COORD=()=>$localize`You must click on an arrow to select your destination.`,e.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,e})();class pM extends JI{applyLegalMove(e,t,n){return new dM(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=e;return t.forEach(e=>{n=pM.applyCapture(n,e)}),n}static applyCapture(e,t){const n=e.getCurrentPlayer();let r=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(t=>{const s=e.getPieceAt(t);r=r.setAt(t,TI.EMPTY),s.is(n)?i[n.value]+=1:o[n.value]+=1}),new dM(r.board,e.turn,i,o)}static getPlacements(e){const t=[];return RI.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===TI.EMPTY?t.push(new uM(n,XO.empty())):pM.getAllDirectionsForEntrance(e,n).forEach(r=>{!1===pM.isLineComplete(e,n,r)&&t.push(new uM(n,XO.of(r)))})}),t}static isLineComplete(e,t,n){return pM.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===TI.EMPTY)return XO.of(r);return XO.empty()}static applyPlacement(e,t){const n=e.getCurrentPlayer();let r=e,i=TI.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const n=t.coord;if(e.getPieceAt(n)!==TI.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(n,i)}else for(let s=t.coord;r.isOnBoard(s)&&i!==TI.EMPTY;s=s.getNext(t.direction.get())){const t=e.getPieceAt(s);r=r.setAt(s,i),i=t}const o=[e.sidePieces[0],e.sidePieces[1]];return o[n.value]-=1,new dM(r.board,e.turn,o,e.capturedPieces)}getPiecesMoved(e,t,n){const r=pM.applyCaptures(e,t);if(n.direction.isAbsent())return[n.coord];{const e=n.direction.get(),t=[];t.push(n.coord);let i=n.coord.getNext(e);for(;r.isOnBoard(i)&&r.getPieceAt(i)!==TI.EMPTY;)t.push(i),i=i.getNext(e);return WO(r.isOnBoard(i)&&r.getPieceAt(i)===TI.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),t.push(i),t}}static getAllDirectionsForEntrance(e,t){if(RI.INSTANCE.isTopLeftCorner(e,t))return[kI.RIGHT,kI.DOWN,kI.UP_RIGHT];if(RI.INSTANCE.isTopCorner(e,t))return[kI.DOWN,kI.DOWN_LEFT,kI.RIGHT];if(RI.INSTANCE.isTopRightCorner(e,t))return[kI.DOWN_LEFT,kI.DOWN,kI.LEFT];if(RI.INSTANCE.isBottomLeftCorner(e,t))return[kI.UP_RIGHT,kI.UP,kI.RIGHT];if(RI.INSTANCE.isBottomCorner(e,t))return[kI.UP,kI.LEFT,kI.UP_RIGHT];if(RI.INSTANCE.isBottomRightCorner(e,t))return[kI.LEFT,kI.UP,kI.DOWN_LEFT];if(RI.INSTANCE.isOnTopLeftBorder(e,t))return[kI.RIGHT,kI.DOWN];if(RI.INSTANCE.isOnLeftBorder(e,t))return[kI.UP_RIGHT,kI.RIGHT];if(RI.INSTANCE.isOnBottomLeftBorder(e,t))return[kI.UP,kI.UP_RIGHT];if(RI.INSTANCE.isOnBottomRightBorder(e,t))return[kI.LEFT,kI.UP];if(RI.INSTANCE.isOnRightBorder(e,t))return[kI.LEFT,kI.DOWN_LEFT];if(RI.INSTANCE.isOnTopRightBorder(e,t))return[kI.DOWN_LEFT,kI.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();const r=pM.applyCaptures(t,e.initialCaptures),i=this.noMoreCapturesValidity(r);if(i.isFailure())return i.toFailedFallible();const o=this.placementValidity(r,e.placement);if(o.isFailure())return o.toFailedFallible();const s=pM.applyPlacement(r,e.placement),a=this.capturesValidity(s,e.finalCaptures);if(a.isFailure())return a.toFailedFallible();const c=pM.applyCaptures(s,e.finalCaptures),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():iS.success(c)}capturesValidity(e,t){let n=e;for(const r of t){const e=this.captureValidity(n,r);if(e.isFailure())return e;n=pM.applyCapture(n,r)}return aS.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),r=pM.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(r.isAbsent())return aS.failure(fM.CAPTURE_MUST_BE_ALIGNED());const i=r.get();return pM.getCapturable(e,i).equals(t)?aS.SUCCESS:aS.failure(fM.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(r=>{const i=pM.getLinePortionWithFourPiecesOfPlayer(e,t,r);i.isPresent()&&n.push(i.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let r=0;const i=e.getEntranceOnLine(n),o=n.getDirection();let s=i;for(let a=i;e.isOnBoard(a);a=a.getNext(o))if(e.getPieceAt(a).is(t)?(0===r&&(s=a),r+=1):r=0,4===r)return XO.of({0:s,1:a,2:o});return XO.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===pM.getLinePortionsWithFourPiecesOfPlayer(e,t).length?aS.SUCCESS:aS.failure(fM.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==TI.EMPTY){if(t.direction.isAbsent())return aS.failure(fM.PLACEMENT_WITHOUT_DIRECTION());if(pM.isLineComplete(e,t.coord,t.direction.get()))return aS.failure(fM.PLACEMENT_ON_COMPLETE_LINE());for(const n of pM.getAllDirectionsForEntrance(e,t.coord))if(n===t.direction.get())return aS.SUCCESS;return aS.failure(fM.INVALID_PLACEMENT_DIRECTION())}return aS.SUCCESS}placementCoordValidity(e,t){return RI.INSTANCE.isOnBorder(e,t)?aS.SUCCESS:aS.failure(fM.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],r=t[0],i=t[1],o=t[2],s=o.getOpposite();let a=r.getNext(s);for(;e.isOnBoard(a)&&e.getPieceAt(a)!==TI.EMPTY;)n.push(a),a=a.getNext(s);for(let c=r;!c.equals(i);c=c.getNext(o))n.push(c);for(let c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==TI.EMPTY;c=c.getNext(o))n.push(c);return new lM(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return pM.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(t=>{n.push(pM.getCapturable(e,t))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===pM.getPossibleCaptures(e).length)return XO.empty();const r=e.getNumberOfPiecesCaptured(t);return XO.of(n+3*r)}static isGameOver(e){const t=pM.getPlayerScore(e,CS.ZERO),n=pM.getPlayerScore(e,CS.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=pM.getPlayerScore(t,CS.ZERO),r=pM.getPlayerScore(t,CS.ONE);return n.isAbsent()?KI.ONE_WON:r.isAbsent()?KI.ZERO_WON:KI.ONGOING}}class gM extends LI{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=gM.computeIntersections(e);let n=[[]];return e.forEach((e,r)=>{if(0===t[r].length)n.forEach(e=>{e.push(r)});else{const e=[],i=t[r].some(e=>e>r);for(const o of n)!0===o.some(e=>t[r].some(t=>e===t))?e.push(cS.copyImmutableArray(o)):i?(e.push(cS.copyImmutableArray(o)),o.push(r),e.push(cS.copyImmutableArray(o))):(o.push(r),e.push(cS.copyImmutableArray(o)));n=e}}),n.map(t=>t.map(t=>e[t]))}static computeIntersections(e){const t=[];return e.forEach((n,r)=>{t.push([]),e.forEach((e,i)=>{r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}getBoardValue(e){const t=e.gameState,n=pM.getPlayerScore(t,CS.ZERO),r=pM.getPlayerScore(t,CS.ONE);return n.isAbsent()?new BI(CS.ONE.getVictoryValue()):r.isAbsent()?new BI(CS.ZERO.getVictoryValue()):new BI(n.get()-r.get())}getListMoves(e){return this.getListMoveFromState(e.gameState)}getListMoveFromState(e){const t=[];return pM.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(n=>{const r=pM.applyCaptures(e,n);pM.getPlacements(r).forEach(e=>{const i=pM.applyPlacement(r,e);this.getPossibleCaptureCombinations(i).forEach(r=>{const i=new hM(e,n,r);t.push(i)})})}),t}getPossibleCaptureCombinations(e){const t=pM.getPossibleCaptures(e);return gM.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class mM{constructor(e,t,n,r,i,o){this.source=e,this.destination=t,this.x1=n,this.y1=r,this.x2=i,this.y2=o}}const yM=TI.NONE,vM=TI.EMPTY,bM=TI.ZERO,_M=TI.ONE;class wM{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,dM.getInitialState()),nT.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,dM.getInitialState(),new hM(new uM(new CI(3,0),XO.of(kI.DOWN)),[],[]),$localize`Congratulations!`),nT.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new dM([[yM,yM,yM,bM,_M,vM,vM],[yM,yM,vM,vM,vM,vM,vM],[yM,vM,vM,vM,vM,vM,vM],[bM,bM,bM,vM,vM,vM,vM],[_M,vM,vM,vM,vM,vM,yM],[vM,vM,vM,_M,vM,yM,yM],[vM,vM,vM,_M,yM,yM,yM]],42,[8,8],[0,0]),[new hM(new uM(new CI(0,3),XO.of(kI.RIGHT)),[],[new lM([new CI(0,3),new CI(1,3),new CI(2,3),new CI(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed!`),nT.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways of capturing.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/><br/>
        Pick the last one.`,new dM([[yM,yM,yM,vM,vM,vM,vM],[yM,yM,vM,_M,vM,vM,vM],[yM,vM,vM,bM,vM,vM,vM],[bM,bM,bM,_M,vM,vM,vM],[vM,vM,vM,bM,vM,vM,yM],[vM,vM,vM,bM,vM,yM,yM],[vM,vM,vM,_M,yM,yM,yM]],42,[8,4],[2,3]),[new hM(new uM(new CI(0,3),XO.of(kI.RIGHT)),[],[new lM([new CI(3,1),new CI(3,2),new CI(3,3),new CI(3,4),new CI(3,5),new CI(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),nT.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.`,new dM([[yM,yM,yM,bM,vM,vM,bM],[yM,yM,vM,bM,vM,vM,bM],[yM,bM,bM,vM,bM,_M,bM],[vM,vM,vM,bM,vM,vM,bM],[vM,vM,vM,bM,vM,vM,yM],[bM,bM,bM,_M,_M,yM,yM],[vM,vM,vM,bM,yM,yM,yM]],42,[8,4],[2,3]),[new hM(new uM(new CI(3,6),XO.of(kI.UP)),[new lM([new CI(6,0),new CI(6,1),new CI(6,2),new CI(6,3)])],[new lM([new CI(0,5),new CI(1,5),new CI(2,5),new CI(3,5),new CI(4,5)]),new lM([new CI(1,2),new CI(2,2),new CI(3,2),new CI(4,2),new CI(5,2)])]),new hM(new uM(new CI(4,6),XO.of(kI.UP)),[new lM([new CI(6,0),new CI(6,1),new CI(6,2),new CI(6,3)])],[new lM([new CI(0,5),new CI(1,5),new CI(2,5),new CI(3,5),new CI(4,5)]),new lM([new CI(3,0),new CI(3,1),new CI(3,2),new CI(3,3),new CI(3,4)])]),new hM(new uM(new CI(3,6),XO.of(kI.UP)),[new lM([new CI(6,0),new CI(6,1),new CI(6,2),new CI(6,3)])],[new lM([new CI(1,2),new CI(2,2),new CI(3,2),new CI(4,2),new CI(5,2)]),new lM([new CI(0,5),new CI(1,5),new CI(2,5),new CI(3,5),new CI(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function CM(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=r.fc().$implicit,t=r.fc();r.mc("ngClass",t.getPieceClass(e)),r.Cb("cx",t.getCenterAt(e).x)("cy",t.getCenterAt(e).y)("r",t.SPACE_SIZE)}}function EM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"g",8),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n)}),r.Mb(2,"polyline",9),r.Ac(3,CM,1,4,"circle",10),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.oc("id","click_",e.x,"_",e.y,""),r.Bb(1),r.oc("id","case_",e.x,"_",e.y,""),r.mc("ngClass",n.getSpaceClass(e)),r.Cb("points",n.getHexaCoordsAt(e)),r.Bb(1),r.mc("ngIf",n.isPiece(e))}}function OM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",14),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).onClick(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(2);r.Cb("points",n.getHexaCoordsAt(e))}}function SM(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",12),r.Ac(1,OM,1,1,"polyline",13),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e.capturedSpaces)}}function PM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"line",15),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n.destination)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit;r.Bb(1),r.Cb("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function IM(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Mb(1,"circle",16),r.Pb()),2&e){const e=t.$implicit,n=r.fc().$implicit,i=r.fc();r.Bb(1),r.oc("id","piece_",n,"_",e,""),r.mc("ngClass",i.getSidePieceClass(n)),r.Cb("cx",10+e*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*n)("r",.5*i.SPACE_SIZE)}}function TM(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,IM,2,6,"g",5),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngForOf",n.getPlayerSidePieces(e))}}function AM(e,t){if(1&e&&(r.ec(),r.Mb(0,"line",17)),2&e){const e=r.fc();r.Cb("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}const kM=function(){return[0,1]};let NM=(()=>{class e extends PI{constructor(t){super(t),this.inserted=XO.empty(),this.arrows=[],this.captured=[],this.moved=[],this.movePhase=e.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=XO.empty(),this.placementEntrance=XO.empty(),this.finalCaptures=[],this.scores=XO.of([0,0]),this.rules=new pM(dM),this.availableMinimaxes=[new gM(this.rules,"GipfMinimax")],this.encoder=hM.encoder,this.tutorial=(new wM).tutorial,this.SPACE_SIZE=40,this.constructedState=this.rules.node.gameState,this.hexaLayout=new NI(1.5*this.SPACE_SIZE,new CI(2*this.SPACE_SIZE,0),RI.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}showLastMove(){this.inserted=XO.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const t=e.get().placement;this.inserted=XO.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,t){const n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new mM(n,e,i.x,i.y,r.x,r.y)}markCapture(e){e.forEach(e=>{this.captured.push(e)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const t=this.constructedState.getNumberOfPiecesToPlace(CS.of(e)),n=[];for(let r=0;r<t;r+=1)n.push(r);return n}isPiece(e){return this.getPiece(e)!==TI.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return n.cancelMove(r.getReason());switch(n.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return n.selectCapture(t);case e.PHASE_PLACEMENT_COORD:return n.selectPlacementCoord(t);default:$O.expectToBe(n.movePhase,e.PHASE_PLACEMENT_DIRECTION);const r=n.placementEntrance.get();if(!1===r.isAlignedWith(t))return n.cancelMove(fM.INVALID_PLACEMENT_DIRECTION());if(1!==r.getDistance(t))return n.cancelMove(fM.CLICK_FURTHER_THAN_ONE_COORD());const i=kI.factory.fromMove(r,t);return n.selectPlacementDirection(i.toOptional())}})()}selectCapture(t){var n=this;return GO(function*(){const r=[];if(n.possibleCaptures.forEach(e=>{e.contains(t)&&r.push(e)}),r.length>1)return n.cancelMove(fM.AMBIGUOUS_CAPTURE_COORD());if(0===r.length)return n.cancelMove(fM.MISSING_CAPTURES());const i=r[0];switch(n.constructedState=pM.applyCapture(n.constructedState,i),n.markCapture(i),n.possibleCaptures=pM.getPossibleCaptures(n.constructedState),n.movePhase){case e.PHASE_INITIAL_CAPTURE:return n.initialCaptures.push(i),0===n.possibleCaptures.length?n.moveToPlacementPhase():aS.SUCCESS;default:return $O.expectToBe(n.movePhase,e.PHASE_FINAL_CAPTURE),n.finalCaptures.push(i),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):aS.SUCCESS}})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,aS.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=pM.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,aS.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var t=this;return GO(function*(){return t.possibleCaptures=pM.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):(t.movePhase=e.PHASE_FINAL_CAPTURE,aS.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const t of pM.getAllDirectionsForEntrance(this.constructedState,e))if(!1===pM.isLineComplete(this.constructedState,e,t)){const n=e.getNext(t),r=this.getCenterAt(e),i=this.getCenterAt(n);this.arrows.push(new mM(e,n,r.x,r.y,i.x,i.y))}}selectPlacementCoord(t){var n=this;return GO(function*(){const r=n.rules.placementCoordValidity(n.constructedState,t);return r.isFailure()?n.cancelMove(r.getReason()):(n.placementEntrance=XO.of(t),n.constructedState.getPieceAt(t)===TI.EMPTY?n.selectPlacementDirection(XO.empty()):(n.movePhase=e.PHASE_PLACEMENT_DIRECTION,n.computeArrows(t),0===n.arrows.length&&n.cancelMove(fM.NO_DIRECTIONS_AVAILABLE()),aS.SUCCESS))})()}selectPlacementDirection(e){var t=this;return GO(function*(){t.placement=XO.of(new uM(t.placementEntrance.get(),e));const n=t.rules.placementValidity(t.constructedState,t.placement.get());return n.isFailure()?t.cancelMove(n.getReason()):(t.arrows=[],t.constructedState=pM.applyPlacement(t.constructedState,t.placement.get()),t.moveToFinalCapturePhaseOrTryMove())})()}tryMove(e,t,n){var r=this;return GO(function*(){const i=new hM(t,e,n);return yield r.chooseMove(i,r.rules.node.gameState,r.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const t=e.get(),n=this.rules.node.mother.get().gameState;t.initialCaptures.forEach(e=>this.markCapture(e)),t.finalCaptures.forEach(e=>this.markCapture(e)),this.moved=this.rules.getPiecesMoved(n,t.initialCaptures,t.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=XO.empty(),this.placement=XO.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(t=>t.equals(e))?"captured":this.moved.some(t=>t.equals(e))?"moved":""}getPieceClass(e){const t=this.getPiece(e);return this.getPlayerClass(CS.of(t.value))}getSidePieceClass(e){return this.getPlayerClass(CS.of(e))}}return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-gipf"]],features:[r.yb],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"defs"),r.Qb(2,"marker",1),r.Mb(3,"polygon",2),r.Pb(),r.Qb(4,"marker",3),r.Mb(5,"polygon",4),r.Pb(),r.Pb(),r.Ac(6,EM,4,7,"g",5),r.Ac(7,SM,2,1,"g",6),r.Ac(8,PM,2,4,"g",5),r.Ac(9,TM,2,1,"g",5),r.Ac(10,AM,1,4,"line",7),r.Pb()),2&e&&(r.Bb(6),r.mc("ngForOf",t.getAllCoords()),r.Bb(1),r.mc("ngForOf",t.possibleCaptures),r.Bb(1),r.mc("ngForOf",t.arrows),r.Bb(1),r.mc("ngForOf",r.qc(5,kM)),r.Bb(1),r.mc("ngIf",t.inserted.isPresent()))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),MM=(()=>{class e extends GI{equals(e){return this===e||this.coord.equals(e.coord)}toString(){return this===e.PASS?"GoMove.PASS":this===e.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}return e.PASS=new e(-1,0),e.ACCEPT=new e(-2,0),e.PASS_NUMBER=-1,e.ACCEPT_NUMBER=-2,e.encoder=new class extends YO{maxValue(){return 360}encodeNumber(e){return 19*e.coord.y+e.coord.x}decodeNumber(t){if(t===e.PASS_NUMBER)return e.PASS;const n=t%19;return new e(n,(t-n)/19)}},e})(),xM=(()=>{class e{constructor(e,t){this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case e.BLACK:return"GoPiece.BLACK";case e.WHITE:return"GoPiece.WHITE";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_BLACK:return"GoPiece.DEAD_BLACK";case e.DEAD_WHITE:return"GoPiece.DEAD_WHITE";case e.BLACK_TERRITORY:return"GoPiece.BLACK_TERRITORY";default:return WO(this===e.WHITE_TERRITORY,"Unexisting GoPiece"),"GoPiece.WHITE_TERRITORY"}}static pieceBelongTo(e,t){return WO(t!==CS.NONE,"Owner must be Player.ZERO or Player.ONE, got Player.NONE."),t===e.player&&"territory"!==e.type}static ofPlayer(t){if(t===CS.ZERO)return e.BLACK;if(t===CS.ONE)return e.WHITE;throw new Error("GoPiece.ofPlayer should only be called with Player.ZERO and Player.ONE.")}isOccupied(){return[e.BLACK,e.WHITE,e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}isEmpty(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY,e.EMPTY].includes(this)}isDead(){return[e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}isTerritory(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return WO(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}return e.BLACK=new e(CS.ZERO,"alive"),e.WHITE=new e(CS.ONE,"alive"),e.EMPTY=new e(CS.NONE,"empty"),e.DEAD_BLACK=new e(CS.ZERO,"dead"),e.DEAD_WHITE=new e(CS.ONE,"dead"),e.BLACK_TERRITORY=new e(CS.NONE,"territory"),e.WHITE_TERRITORY=new e(CS.NONE,"territory"),e})();var RM=function(e){return e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED",e}({});let DM=(()=>{class e extends VI{constructor(e,t,n,r,i){super(e,n),this.captured=t,this.koCoord=r,this.phase=i}static getInitialState(){const t=e.getStartingBoard();return new e(t,[0,0],0,XO.empty(),RM.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return cS.createTable(e.WIDTH,e.HEIGHT,xM.EMPTY)}copy(){return new e(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return e.WIDTH=13,e.HEIGHT=13,e})(),LM=(()=>{class e{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(t=>t.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}return e.VERBOSE=!1,e})();class BM extends LM{constructor(e,t,n,r,i,o){super(e),this.emptyCoords=t,this.blackCoords=n,this.whiteCoords=r,this.deadBlackCoords=i,this.deadWhiteCoords=o}getCoords(){return this.color===xM.BLACK?this.blackCoords:this.color===xM.WHITE?this.whiteCoords:this.color===xM.DEAD_BLACK?this.deadBlackCoords:this.color===xM.DEAD_WHITE?this.deadWhiteCoords:this.emptyCoords}contains(e){return this.blackCoords.concat(this.whiteCoords.concat(this.emptyCoords.concat(this.deadBlackCoords.concat(this.deadWhiteCoords)))).some(t=>t.equals(e))}addPawn(e,t){if(this.contains(e))throw new Error("This group already contains "+e);switch(t){case xM.BLACK:this.blackCoords=LM.insertAsEntryPoint(this.blackCoords,e);break;case xM.WHITE:this.whiteCoords=LM.insertAsEntryPoint(this.whiteCoords,e);break;case xM.DEAD_BLACK:this.deadBlackCoords=LM.insertAsEntryPoint(this.deadBlackCoords,e);break;case xM.DEAD_WHITE:this.deadWhiteCoords=LM.insertAsEntryPoint(this.deadWhiteCoords,e);break;default:$O.expectToBeMultiple(t,[xM.EMPTY,xM.BLACK_TERRITORY,xM.WHITE_TERRITORY]),this.emptyCoords=LM.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(0===this.emptyCoords.length?1:2)*(this.blackCoords.length+this.deadWhiteCoords.length===0?1:2)*(this.whiteCoords.length+this.deadBlackCoords.length===0?1:2)==4}getWrapper(){const e=new WI;e.set(xM.EMPTY,this.emptyCoords.length),e.set(xM.BLACK,this.blackCoords.length+this.deadWhiteCoords.length),e.set(xM.WHITE,this.whiteCoords.length+this.deadBlackCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((e,t)=>t>0);if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighboorsEntryPoint(){const e=[];return this.color!==xM.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==xM.BLACK&&this.blackCoords.length>0&&e.push(this.blackCoords[0]),this.color!==xM.WHITE&&this.whiteCoords.length>0&&e.push(this.whiteCoords[0]),this.color!==xM.DEAD_BLACK&&this.deadBlackCoords.length>0&&e.push(this.deadBlackCoords[0]),this.color!==xM.DEAD_WHITE&&this.deadWhiteCoords.length>0&&e.push(this.deadWhiteCoords[0]),e}}class FM extends class{getGroupDatas(e,t){qO(LM.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");const n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}_getGroupDatas(e,t,n){qO(LM.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});const r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color)for(const i of this.getDirections()){const r=e.getNext(i);r.isInRange(t[0].length,t.length)&&(n.contains(r)||(n=this._getGroupDatas(r,t,n)))}return n}}{getNewInstance(e){return new BM(e,[],[],[],[],[])}getDirections(){return wI.ORTHOGONALS}}let jM=(()=>{class e{}return e.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,e.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,e.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,e.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,e})(),UM=(()=>{class e extends JI{static isLegal(t,n){if(qO(e.VERBOSE||!1,{isLegal:{move:t,state:n}}),e.isPass(t)){const t=n.phase===RM.PLAYING,r=n.phase===RM.PASSED;return qO(e.VERBOSE||!1,"GoRules.isLegal at "+n.phase+(t||r?" forbid":" allowed")+" passing on "+n.getCopiedBoard()),t||r?iS.success([]):iS.failure(jM.CANNOT_PASS_AFTER_PASSED_PHASE())}if(e.isAccept(t)){const e=n.phase===RM.ACCEPT;return n.phase===RM.COUNTING||e?iS.success([]):iS.failure(jM.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return e.isOccupied(t.coord,n.getCopiedBoard())?(qO(e.VERBOSE||!1,"GoRules.isLegal: move is marking"),e.isLegalDeadMarking(t,n)?iS.success([]):iS.failure(jM.OCCUPIED_INTERSECTION())):(qO(e.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+t.toString()),e.isLegalNormalMove(t,n))}static getNewKo(e,t,n){if(1===n.length){const r=n[0],i=e.coord,o=t[i.y][i.x],s=(new FM).getGroupDatas(i,t),a=s.emptyCoords,c=xM.pieceBelongTo(o,CS.ZERO)?s.blackCoords:s.whiteCoords;if(1===a.length&&a[0].equals(r)&&1===c.length)return XO.of(r)}return XO.empty()}static markTerritoryAndCount(t){qO(e.VERBOSE,{markTerritoryAndCount:{state:t}});const n=t.getCopiedBoard(),r=e.getTerritoryLikeGroup(t),i=t.getCapturedCopy();for(const e of r){const t=e.getWrapper();if(t===xM.WHITE){i[1]+=e.emptyCoords.length;for(const t of e.getCoords())n[t.y][t.x]=xM.WHITE_TERRITORY}else{WO(t===xM.BLACK,"territory should be wrapped by black or white, not by "+t.toString()),i[0]+=e.emptyCoords.length;for(const t of e.getCoords())n[t.y][t.x]=xM.BLACK_TERRITORY}}return new DM(n,i,t.turn,t.koCoord,t.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let r;for(let i=0;i<e.board.length;i++)for(let o=0;o<e.board[0].length;o++)r=t[i][o],r===xM.BLACK_TERRITORY?(t[i][o]=xM.EMPTY,n[0]=n[0]-1):r===xM.WHITE_TERRITORY&&(t[i][o]=xM.EMPTY,n[1]=n[1]-1);return new DM(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(t){return e.getGroupsDatasWhere(t.getCopiedBoard(),e=>e.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let r,i,o;const s=new FM;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)r=new CI(c,a),o=e[a][c],t(o)&&(n.some(e=>e.selfContains(r))||(i=s.getGroupDatas(r,e),n.push(i)));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let n,r=t[1],i=t[0];for(let o=0;o<e.board.length;o++)for(let t=0;t<e.board[0].length;t++)n=e.getPieceAtXY(t,o),n===xM.DEAD_BLACK?r++:n===xM.DEAD_WHITE&&i++;return[i,r]}static switchAliveness(e,t){const n=t.getCopiedBoard();WO(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");const r=(new FM).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case xM.DEAD_BLACK:i[1]-=2*r.deadBlackCoords.length;for(const e of r.deadBlackCoords)n[e.y][e.x]=xM.BLACK;break;case xM.DEAD_WHITE:i[0]-=2*r.deadWhiteCoords.length;for(const e of r.deadWhiteCoords)n[e.y][e.x]=xM.WHITE;break;case xM.WHITE:i[0]+=2*r.whiteCoords.length;for(const e of r.whiteCoords)n[e.y][e.x]=xM.DEAD_WHITE;break;default:$O.expectToBe(r.color,xM.BLACK),i[1]+=2*r.blackCoords.length;for(const e of r.blackCoords)n[e.y][e.x]=xM.DEAD_BLACK}return new DM(n,i,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===RM.FINISHED?t.captured[0]>t.captured[1]?KI.ZERO_WON:t.captured[1]>t.captured[0]?KI.ONE_WON:KI.DRAW:KI.ONGOING}static isPass(e){return e.equals(MM.PASS)}static isAccept(e){return e.equals(MM.ACCEPT)}static isLegalDeadMarking(t,n){return e.isOccupied(t.coord,n.getCopiedBoard())&&(n.phase===RM.COUNTING||n.phase===RM.ACCEPT)}static isLegalNormalMove(t,n){const r=n.getCopiedBoard();if(e.isKo(t,n))return iS.failure(jM.ILLEGAL_KO());[RM.COUNTING,RM.ACCEPT].includes(n.phase)&&(n=e.resurrectStones(n));const i=e.getCaptureState(t,n);if(VM.isCapturing(i))return iS.success(i.capturedCoords);{r[t.coord.y][t.coord.x]=n.turn%2==0?xM.BLACK:xM.WHITE;const e=0===(new FM).getGroupDatas(t.coord,r).emptyCoords.length;return r[t.coord.y][t.coord.x]=xM.EMPTY,e?iS.failure(jM.CANNOT_COMMIT_SUICIDE()):iS.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(t,n){qO(e.VERBOSE||!1,{getCaptureState:{move:t,state:n}});const r=new VM;let i;for(const o of wI.ORTHOGONALS)i=e.getCapturedInDirection(t.coord,o,n),i.length>0&&r.capturedCoords.every(e=>!i[0].equals(e))&&(r.capturedCoords=r.capturedCoords.concat(i));return r}static getCapturedInDirection(t,n,r){const i=r.getCopiedBoard(),o=t.getNext(n);if(o.isInRange(r.board[0].length,r.board.length)&&i[o.y][o.x]===(r.turn%2==0?xM.WHITE:xM.BLACK)){qO(e.VERBOSE||!1,"a group could be captured");const t=(new FM).getGroupDatas(o,i);if(e.isCapturableGroup(t,r.koCoord))return qO(e.VERBOSE||!1,{neightbooringGroupCoord:t.getCoords(),message:"is capturable"}),t.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(t){return e.getEmptyZones(t).filter(e=>e.isMonoWrapped())}static applyPass(t){const n=t.getCopiedBoard(),r=t.getCapturedCopy(),i=t.turn;let o,s;return t.phase===RM.PASSED?(o=RM.COUNTING,s=new DM(n,r,i+1,XO.empty(),o),s=e.markTerritoryAndCount(s)):(WO(t.phase===RM.PLAYING,"Cannot pass in counting phase!"),o=RM.PASSED,s=new DM(n,r,i+1,XO.empty(),o)),s}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===RM.COUNTING?RM.ACCEPT:RM.FINISHED,new DM(t,e.getCapturedCopy(),e.turn+1,XO.empty(),n)}static applyNormalLegalMove(t,n,r){let i;qO(e.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:n,status}}),i=[RM.COUNTING,RM.ACCEPT].includes(t.phase)?e.resurrectStones(t):t.copy();const o=n.coord.x,s=n.coord.y,a=i.getCopiedBoard(),c=i.turn,l=xM.ofPlayer(i.getCurrentPlayer()),u=c+1;a[s][o]=l;for(const e of r)a[e.y][e.x]=xM.EMPTY;const h=e.getNewKo(n,a,r),d=i.getCapturedCopy();return d[l.player.value]+=r.length,new DM(a,d,u,h,RM.PLAYING)}static resurrectStones(t){for(let n=0;n<t.board.length;n++)for(let r=0;r<t.board[0].length;r++)t.getPieceAtXY(r,n).isDead()&&(t=e.switchAliveness(new CI(r,n),t));return e.removeAndSubstractTerritory(t)}static applyDeadMarkingMove(t,n){qO(e.VERBOSE,{applyDeadMarkingMove:{legalMove:t,state:n}});const r=e.removeAndSubstractTerritory(n),i=e.switchAliveness(t.coord,r),o=new DM(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,XO.empty(),RM.COUNTING);return e.markTerritoryAndCount(o)}isLegal(t,n){return e.isLegal(t,n)}applyLegalMove(t,n,r){return qO(e.VERBOSE,{applyLegalMove:{legalMove:t,state:n,status:r}}),e.isPass(t)?(qO(e.VERBOSE,"GoRules.applyLegalMove: isPass"),e.applyPass(n)):e.isAccept(t)?(qO(e.VERBOSE,"GoRules.applyLegalMove: isAccept"),e.applyLegalAccept(n)):e.isLegalDeadMarking(t,n)?(qO(e.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),e.applyDeadMarkingMove(t,n)):(qO(e.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),e.applyNormalLegalMove(n,t,r))}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class VM{constructor(){this.capturedCoords=[]}static isCapturing(e){return e.capturedCoords.length>0}}class zM extends LI{getListMoves(e){qO(UM.VERBOSE||!1,"GoRules.getListMoves");const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===RM.PLAYING||t.phase===RM.PASSED)return n.push(MM.PASS),n;{qO(UM.VERBOSE||!1,"GoRules.getListMoves in counting phase");const e=this.getCountingMovesList(t);return 0===e.length?[MM.ACCEPT]:e}}getPlayingMovesList(e){const t=[];let n;for(let r=0;r<e.board.length;r++)for(let i=0;i<e.board[0].length;i++)n=new MM(i,r),e.getPieceAt(n.coord)===xM.EMPTY&&UM.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),r=UM.getGroupsDatasWhere(n,e=>e!==xM.EMPTY);for(const i of r){const r=i.getCoords()[0],o=n[r.y][r.x];if(e.getPieceAt(r)!==o){const e=new MM(r.x,r.y);return t.push(e),t}}return t}getCorrectBoard(e){const t=this.mapBoard(e.getCopiedBoard(),e=>e===xM.BLACK?xM.DEAD_BLACK:e===xM.WHITE?xM.DEAD_WHITE:e.isTerritory()?xM.EMPTY:e),n=new DM(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=UM.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}mapBoard(e,t){for(let n=0;n<e.length;n++)for(let r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}setAliveUniqueWrapper(e,t){let n,r=e.copy();for(const i of t){n=i.deadBlackCoords.concat(i.deadWhiteCoords);for(const e of n)r.isDead(e)&&(r=UM.switchAliveness(e,r))}return r}getBoardValue(e){const t=e.gameState,n=UM.getGameStatus(e);if(n.isEndGame)return new BI(n.toBoardValue());qO(UM.VERBOSE||!1,"GoRules.getBoardValue");const r=UM.markTerritoryAndCount(t),i=r.getCapturedCopy(),o=this.getDeadStones(r);return new BI(i[1]+2*o[0]-(i[0]+2*o[1]))}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let r=0;r<e.board[0].length;r++){const i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}const HM=xM.WHITE,GM=xM.BLACK,$M=xM.DEAD_WHITE,qM=xM.WHITE_TERRITORY,WM=xM.BLACK_TERRITORY,ZM=xM.EMPTY;class QM{constructor(){this.tutorial=[nT.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,DM.getInitialState()),nT.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new DM([[ZM,GM,ZM,ZM,HM,HM],[ZM,GM,ZM,ZM,HM,ZM],[ZM,GM,GM,HM,HM,ZM],[ZM,ZM,GM,HM,ZM,ZM],[ZM,ZM,GM,HM,ZM,ZM],[ZM,ZM,GM,HM,ZM,ZM]],[0,0],0,XO.empty(),RM.PLAYING)),nT.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        The light piece only has one liberty left, play there.`,new DM([[ZM,ZM,ZM,ZM,ZM],[ZM,ZM,GM,ZM,ZM],[ZM,GM,HM,ZM,ZM],[ZM,ZM,GM,ZM,ZM],[ZM,ZM,ZM,ZM,ZM]],[0,0],0,XO.empty(),RM.PLAYING),[new MM(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),nT.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        The light group here only has one liberty left, capture it.`,new DM([[ZM,GM,ZM,ZM,ZM],[GM,HM,ZM,ZM,ZM],[GM,HM,HM,GM,ZM],[ZM,GM,GM,ZM,ZM],[ZM,ZM,ZM,ZM,ZM]],[0,0],0,XO.empty(),RM.PLAYING),[new MM(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),nT.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new DM([[ZM,GM,ZM,ZM,ZM],[GM,ZM,ZM,ZM,ZM],[GM,ZM,ZM,ZM,HM],[HM,GM,ZM,HM,ZM],[ZM,HM,ZM,HM,GM]],[0,0],0,XO.empty(),RM.PLAYING)),nT.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new DM([[ZM,ZM,ZM,ZM,ZM],[GM,GM,GM,ZM,ZM],[HM,HM,GM,ZM,ZM],[ZM,HM,GM,ZM,ZM],[HM,HM,GM,ZM,ZM]],[0,0],0,XO.empty(),RM.PLAYING)),nT.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new DM([[ZM,GM,HM,ZM,ZM],[HM,GM,HM,ZM,ZM],[GM,GM,HM,ZM,ZM],[HM,GM,HM,ZM,ZM],[ZM,GM,HM,ZM,ZM]],[0,0],0,XO.empty(),RM.PLAYING)),nT.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new DM([[ZM,HM,GM,ZM,HM,GM,ZM],[ZM,HM,GM,GM,HM,GM,ZM],[ZM,HM,GM,GM,HM,GM,ZM],[ZM,HM,GM,GM,HM,GM,ZM],[ZM,HM,GM,HM,HM,GM,ZM],[ZM,HM,GM,HM,HM,GM,ZM],[ZM,HM,GM,ZM,HM,GM,ZM]],[0,0],0,XO.empty(),RM.PLAYING)),nT.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        Capture the light stone.`,new DM([[ZM,ZM,ZM,ZM,ZM,ZM,ZM],[ZM,ZM,ZM,ZM,ZM,ZM,ZM],[ZM,ZM,ZM,GM,HM,ZM,ZM],[ZM,ZM,GM,HM,ZM,HM,ZM],[ZM,ZM,ZM,GM,HM,ZM,ZM],[ZM,ZM,ZM,ZM,ZM,ZM,ZM],[ZM,ZM,ZM,ZM,ZM,ZM,ZM]],[0,0],0,XO.empty(),RM.PLAYING),[new MM(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed!`),nT.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        A last stone is dead, mark it.`,new DM([[HM,GM,GM,GM,GM,GM,WM,WM,WM],[HM,HM,HM,HM,GM,GM,GM,WM,WM],[HM,qM,HM,HM,GM,$M,$M,GM,WM],[GM,HM,HM,HM,HM,GM,WM,WM,WM],[ZM,HM,qM,HM,GM,GM,$M,GM,WM],[HM,qM,HM,HM,GM,GM,GM,GM,GM],[HM,HM,GM,GM,GM,HM,HM,GM,HM],[GM,GM,GM,HM,HM,HM,qM,HM,HM],[WM,WM,GM,GM,GM,HM,HM,qM,qM]],[0,0],0,XO.empty(),RM.COUNTING),[new MM(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}function YM(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",10)),2&e){const e=r.fc(2).index,t=r.fc().index;r.Cb("cx",25+50*e)("cy",25+50*t)("r",22)}}function KM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index;r.Cb("x1",50*e)("y1",50*t)("x2",50+50*e)("y2",50+50*t)}}function JM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",7),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Ac(2,YM,1,3,"circle",8),r.Ac(3,KM,1,4,"line",9),r.Pb()}if(2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.Bb(1),r.mc("ngClass",n.getSpaceClass(e,t)),r.Cb("cx",25+50*e)("cy",25+50*t)("r",22),r.Bb(1),r.mc("ngIf",n.isLastCase(e,t)),r.Bb(1),r.mc("ngIf",n.isDead(e,t))}}function XM(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",15),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.Cb("cx",25+50*t)("cy",25+50*i)("r",10)("class",n===o.GoPiece.WHITE_TERRITORY?"player1":"player0")}}function ex(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"rect",12),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(1,"line",13),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(2,"line",13),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Ac(3,XM,1,4,"circle",14)}if(2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.oc("id","click_",e,"_",t,""),r.Cb("x",50*e)("y",50*t),r.Bb(1),r.Cb("x1",50*e)("y1",25+50*t)("x2",50+50*e)("y2",25+50*t),r.Bb(1),r.Cb("x1",25+50*e)("y1",50*t)("x2",25+50*e)("y2",50+50*t),r.Bb(1),r.mc("ngIf",n.isTerritory(e,t))}}function tx(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,JM,4,6,"g",5),r.Ac(2,ex,4,13,"ng-template",null,6,r.Bc),r.Pb()),2&e){const e=t.index,n=r.vc(3),i=r.fc().index,o=r.fc();r.Bb(1),r.mc("ngIf",o.caseIsFull(e,i))("ngIfElse",n)}}function nx(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,tx,4,2,"g",2),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function rx(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",16)),2&e){const e=r.fc();r.Cb("x",12.5+50*e.ko.get().x)("y",12.5+50*e.ko.get().y)}}function ix(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",17),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n.x,n.y)}),r.Pb()}if(2&e){const e=t.$implicit;r.Cb("cx",25+50*e.x)("cy",25+50*e.y)("r",7)}}let ox=(()=>{class e extends BT{constructor(e){super(e),this.ko=XO.empty(),this.last=XO.empty(),this.captures=[],this.GoPiece=xM,this.scores=XO.of([0,0]),this.rules=new UM(DM),this.availableMinimaxes=[new zM(this.rules,"GoMinimax")],this.encoder=MM.encoder,this.tutorial=(new QM).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());n.last=XO.empty();const i=new MM(e,t);return n.chooseMove(i,n.rules.node.gameState,n.scores.get())})()}updateBoard(){qO(e.VERBOSE,"updateBoard");const t=this.rules.node.gameState,n=this.rules.node.move,r=t.phase;this.board=t.getCopiedBoard(),this.scores=XO.of(t.getCapturedCopy()),this.ko=t.koCoord,n.isPresent()?this.showCaptures():this.captures=[],this.last=n.map(e=>e.coord),this.canPass=r!==RM.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const r=new CI(n,t),i=!1===e.getPieceAt(r).isEmpty(),o=this.board[t][n]===xM.EMPTY,s=!1===this.ko.equalsValue(r);i&&o&&s&&this.captures.push(r)}}pass(){var e=this;return GO(function*(){const t=e.rules.node.gameState.phase;return t===RM.PLAYING||t===RM.PASSED?e.onClick(MM.PASS.coord.x,MM.PASS.coord.y):(WO(t===RM.COUNTING||t===RM.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(MM.ACCEPT.coord.x,MM.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}caseIsFull(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==xM.EMPTY&&!this.isTerritory(e,t)}isLastCase(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.rules.node.gameState.isDead(new CI(e,t))}isTerritory(e,t){return this.rules.node.gameState.isTerritory(new CI(e,t))}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-go"]],features:[r.yb],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Mb(1,"rect",1),r.Ac(2,nx,2,1,"g",2),r.Ac(3,rx,1,2,"rect",3),r.Ac(4,ix,1,3,"circle",4),r.Pb()),2&e&&(r.Cb("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),r.Bb(1),r.Cb("width",50*t.board.length)("height",50*t.board.length),r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngIf",t.ko.isPresent()),r.Bb(1),r.mc("ngForOf",t.captures))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),sx=(()=>{class e{constructor(e,t,n){this.value=e,this.name=t,this.rgb=n}static of(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return $O.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}return e.ANY=new e(0,"any","#000"),e.ORANGE=new e(1,"orange","#d67421"),e.BLUE=new e(2,"blue","#006bac"),e.PURPLE=new e(3,"purple","#6f3787"),e.PINK=new e(4,"pink","#d2719e"),e.YELLOW=new e(5,"yellow","#e2c200"),e.RED=new e(6,"red","#d23339"),e.GREEN=new e(7,"green","#009157"),e.BROWN=new e(8,"brown","#562500"),e})(),ax=(()=>{class e{constructor(e,t){this.player=e,this.color=t}static of(t,n){return new e(t,sx.of(n))}static createPlayerColors(t){return{ORANGE:new e(t,sx.ORANGE),BLUE:new e(t,sx.BLUE),PURPLE:new e(t,sx.PURPLE),PINK:new e(t,sx.PINK),YELLOW:new e(t,sx.YELLOW),RED:new e(t,sx.RED),GREEN:new e(t,sx.GREEN),BROWN:new e(t,sx.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(CS.NONE)}belongsTo(e){return this.player===e}}return e.NONE=new e(CS.NONE,sx.ANY),e.ZERO=e.createPlayerColors(CS.ZERO),e.ONE=e.createPlayerColors(CS.ONE),e})(),cx=(()=>{class e{static getColorAt(t,n){return e.COLORS[n][t]}static getInitialBoard(){const e=ax.NONE;return[[1,2,3,4,5,6,7,8].map(e=>ax.of(CS.ONE,e)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(e=>ax.of(CS.ZERO,e))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(ax.NONE)}static allPieceCoords(t){const n=[];for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const o=new CI(i,r);e.isEmptyAt(t,o)||n.push(o)}return n}}return e.INITIAL=e.getInitialBoard(),e.SIZE=8,e.COLORS=cS.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],sx.of),e})(),lx=(()=>{class e extends ZT{constructor(e,t){super(e,t)}static of(t,n){if(t.isNotInRange(cx.SIZE,cx.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(n.isNotInRange(cx.SIZE,cx.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+n.toString());return new e(t,n)}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return this===e.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}return e.PASS=new e(new CI(-2,-2),new CI(-3,-3)),e.encoder=new class extends YO{maxValue(){return 34952}encodeNumber(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}decodeNumber(t){if(t<0)return e.PASS;const n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return new e(new CI((t=t/16|0)%16,i),new CI(r,n))}},e})();class ux extends VI{constructor(e,t,n,r,i){super(cS.copyBiArray(i),e),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=r}static getInitialState(){return new ux(0,sx.ANY,XO.empty(),!1,cx.INITIAL)}}let hx=(()=>{class e{}return e.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,e.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,e.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,e.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,e})();class dx extends JI{static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new CI(0,7),new CI(1,7),new CI(2,7),new CI(3,7),new CI(4,7),new CI(5,7),new CI(6,7),new CI(7,7)]}static getMovablePieces(e){return dx.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const r=t.getNext(n);if(e.isOnBoard(r)&&cx.isEmptyAt(e.board,r))return!0}return!1})}static playerDirections(e){if(e===CS.ONE)return[bI.DOWN,bI.DOWN_LEFT,bI.DOWN_RIGHT];if(e===CS.ZERO)return[bI.UP,bI.UP_LEFT,bI.UP_RIGHT];throw new Error("Invalid player")}static directionAllowedForPlayer(e,t){if(t===CS.ZERO)return e.y<0;if(t===CS.ONE)return e.y>0;throw new Error("Invalid player")}static getListMovesFromState(e){const t=dx.getMovablePieces(e);return 0===t.length?(WO(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[lx.PASS]):dx.getListMovesFromNonBlockedState(e,t)}static getListMovesFromNonBlockedState(e,t){const n=[],r=e.getCurrentPlayer();for(const i of t)for(const t of dx.playerDirections(r))for(let r=1;r<cx.SIZE;r++){const o=i.getNext(t,r);if(!e.isOnBoard(o)||!cx.isEmptyAt(e.board,o))break;{const e=lx.of(i,o);n.push(e)}}return n}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return cx.allPieceCoords(e.board).forEach(r=>{const i=e.getPieceAt(r);WO(i!==ax.NONE,"allPieceCoords failed to filter KamisadoPiece.NONE"),i.player===CS.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}static isLegal(e,t){const n=e.coord,r=e.end,i=t.colorToPlay;if(e===lx.PASS)return this.isLegalPass(t);if(dx.isVictory(t))return iS.failure("You should never see this message");const o=t.getPieceAt(n);if(!o.belongsTo(t.getCurrentPlayer()))return iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE());if(i!==sx.ANY&&o.color!==i)return iS.failure(hx.NOT_RIGHT_COLOR());if(!t.getPieceAt(r).isEmpty())return iS.failure(DI.MUST_CLICK_ON_EMPTY_SPACE());const s=bI.factory.fromMove(n,r);if(s.isFailure())return iS.failure(hx.DIRECTION_NOT_ALLOWED());const a=s.get();if(!dx.directionAllowedForPlayer(a,t.getCurrentPlayer()))return iS.failure(hx.DIRECTION_NOT_ALLOWED());let c=n;for(;!c.equals(r);)if(c=c.getNext(a),!t.getPieceAt(c).isEmpty())return iS.failure(hx.MOVE_BLOCKED());return iS.success(void 0)}static isLegalPass(e){return this.mustPass(e)&&!e.alreadyPassed?iS.success(void 0):iS.failure(DI.CANNOT_PASS())}static isVictory(e){const[t,n]=this.getFurthestPiecePositions(e);return 0===t||7===n}nextCoordToPlay(e,t){return XO.ofNullable(cx.allPieceCoords(e.board).find(n=>{const r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}applyLegalMove(e,t,n){if(e===lx.PASS){const e=this.nextCoordToPlay(t,t.colorToPlay);return new ux(t.turn+1,t.colorToPlay,e,!0,t.board)}const r=e.coord,i=e.end,o=t.getCopiedBoard();o[i.y][i.x]=o[r.y][r.x],o[r.y][r.x]=ax.NONE;const s=cx.getColorAt(i.x,i.y),a=this.nextCoordToPlay(t,s);return new ux(t.turn+1,s,a,!1,o)}isLegal(e,t){return dx.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(dx.mustPass(t)&&t.alreadyPassed)return KI.getDefeat(n);const[r,i]=dx.getFurthestPiecePositions(t);return 7===i?KI.ONE_WON:0===r?KI.ZERO_WON:KI.ONGOING}}class fx extends LI{getListMoves(e){const t=dx.getListMovesFromState(e.gameState);return cS.sortByDescending(t,e=>e.length()),t}getBoardValue(e){const t=e.gameState,n=t.getCurrentPlayer();if(dx.mustPass(t)&&t.alreadyPassed)return new BI(n.getDefeatValue());const[r,i]=dx.getFurthestPiecePositions(t);return new BI(7===i?CS.ONE.getVictoryValue():0===r?CS.ZERO.getVictoryValue():i-(7-r))}}const px=ax.NONE,gx=ax.ZERO.ORANGE,mx=ax.ONE.ORANGE,yx=ax.ZERO.BLUE,vx=ax.ONE.BLUE,bx=ax.ZERO.PURPLE,_x=ax.ONE.PURPLE,wx=ax.ZERO.PINK,Cx=ax.ONE.PINK,Ex=ax.ZERO.YELLOW,Ox=ax.ONE.YELLOW,Sx=ax.ZERO.RED,Px=ax.ONE.RED,Ix=ax.ZERO.GREEN,Tx=ax.ONE.GREEN,Ax=ax.ZERO.BROWN,kx=ax.ONE.BROWN;class Nx{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new ux(5,sx.ORANGE,XO.empty(),!1,[[Ax,vx,_x,Cx,Ox,Px,Tx,kx],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,mx,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,Ix,Sx,Ex,wx,bx,yx,gx]])).withPreviousMove(lx.of(new CI(0,7),new CI(0,0))),nT.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        Click on the piece of your choice and click on the landing square.`,ux.getInitialState(),lx.of(new CI(7,7),new CI(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),nT.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        Move it on a blue square.`,new ux(1,sx.PINK,XO.of(new CI(3,0)),!1,[[mx,vx,_x,Cx,Ox,Px,Tx,kx],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,yx,px],[px,px,px,px,px,px,px,px],[Ax,Ix,Sx,Ex,wx,bx,px,gx]]),[lx.of(new CI(3,0),new CI(3,6)),lx.of(new CI(3,0),new CI(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(lx.of(new CI(6,7),new CI(6,5))),nT.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new ux(1,sx.PINK,XO.of(new CI(3,6)),!1,[[mx,vx,_x,px,Ox,Px,Tx,kx],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,px],[px,px,px,px,px,px,px,yx],[px,px,px,px,px,px,px,px],[px,px,px,Cx,px,px,px,px],[Ax,Ix,Sx,Ex,wx,bx,px,gx]])).withPreviousMove(lx.of(new CI(6,5),new CI(7,4))),nT.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        Try to make this move.`,new ux(2,sx.RED,XO.of(new CI(2,4)),!1,[[px,vx,_x,px,px,Px,px,px],[px,px,px,Ox,px,px,px,px],[px,px,px,Cx,px,_x,px,px],[px,px,px,Ex,px,px,px,px],[px,px,Sx,px,px,px,px,px],[px,px,px,px,px,px,Tx,px],[mx,px,px,px,px,wx,px,kx],[Ax,Ix,px,px,px,px,yx,gx]]),[lx.of(new CI(2,4),new CI(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed!`).withPreviousMove(lx.of(new CI(4,0),new CI(3,1)))]}}function Mx(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",8)),2&e){const e=r.fc(),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.Cb("cx",o.SPACE_SIZE/2+t*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("fill",o.pieceColor(n))("r",o.SPACE_SIZE/3)}}function xx(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",9)),2&e){const e=r.fc(),t=e.$implicit,n=e.index,i=r.fc().index,o=r.fc();r.mc("ngClass",o.piecePlayerClass(t)),r.Cb("x",o.SPACE_SIZE/2+n*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(t)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(t)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)}}function Rx(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"g",4),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Mb(2,"rect",5),r.Ac(3,Mx,1,4,"circle",6),r.Ac(4,xx,1,7,"rect",7),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","click_",n,"_",i,""),r.Bb(1),r.Cb("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(n,i)),r.Bb(1),r.mc("ngIf",e!==o.UNOCCUPIED),r.Bb(1),r.mc("ngIf",e!==o.UNOCCUPIED)}}function Dx(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,Rx,5,9,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function Lx(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Mb(1,"rect",10),r.Mb(2,"rect",10),r.Pb()),2&e){const e=r.fc();r.Bb(1),r.Cb("x",e.lastMove.get().coord.x*e.SPACE_SIZE)("y",e.lastMove.get().coord.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),r.Bb(1),r.Cb("x",e.lastMove.get().end.x*e.SPACE_SIZE)("y",e.lastMove.get().end.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function Bx(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=r.fc();r.Cb("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)}}let Fx=(()=>{class e extends BT{constructor(e){super(e),this.UNOCCUPIED=ax.NONE,this.lastMove=XO.empty(),this.chosen=XO.empty(),this.chosenAutomatically=!1,this.rules=new dx(ux),this.availableMinimaxes=[new fx(this.rules,"KamisadoMinimax")],this.encoder=lx.encoder,this.tutorial=(new Nx).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,t){return cx.getColorAt(e,t).rgb}isPlayerZero(e){return e.player===CS.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=dx.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=XO.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return GO(function*(){return WO(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(lx.PASS,e.rules.node.gameState)})()}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new CI(e,t);if(n.canPass)return n.cancelMove(DI.MUST_PASS());if(n.chosen.isAbsent())return n.choosePiece(e,t);if(!1===n.chosenAutomatically&&n.chosen.equalsValue(i))return n.cancelMoveAttempt(),aS.SUCCESS;{const r=n.rules.node.gameState.getPieceAtXY(e,t),o=n.rules.node.gameState.getCurrentPlayer();return r.belongsTo(o)?n.chosenAutomatically?n.cancelMove(hx.PLAY_WITH_SELECTED_PIECE()):(n.chosen=XO.of(i),aS.SUCCESS):yield n.chooseDestination(e,t)}})()}choosePiece(e,t){const n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=XO.of(new CI(e,t)),aS.SUCCESS)}chooseDestination(e,t){var n=this;return GO(function*(){const r=n.chosen.get(),i=new CI(e,t),o=lx.of(r,i);return n.chooseMove(o,n.rules.node.gameState)})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=XO.empty())}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-kamisado"]],features:[r.yb],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,Dx,2,1,"g",1),r.Ac(2,Lx,3,8,"g",2),r.Ac(3,Bx,1,2,"circle",3),r.Pb()),2&e&&(r.Cb("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngIf",t.lastMove.isPresent()),r.Bb(1),r.mc("ngIf",t.chosen.isPresent()))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),jx=(()=>{class e extends VI{static getInitialState(){const t=CS.NONE,n=CS.ZERO,r=CS.ONE;return new e([[t,n,n,n,n,n,n,t],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(e.SIZE,e.SIZE)}}return e.SIZE=8,e})(),Ux=(()=>{class e extends ZT{constructor(e,t,n){super(e,t),this.direction=n,this.direction=bI.factory.fromMove(e,t).get()}static of(t,n){const r=bI.factory.fromMove(t,n);return r.isFailure()?iS.failure(r.getReason()):t.isNotInRange(jx.SIZE,jx.SIZE)?iS.failure("start coord is not in range"):n.isNotInRange(jx.SIZE,jx.SIZE)?iS.failure("end coord is not in range"):iS.success(new e(t,n,r.get()))}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}encode(){return e.encoder.encode(this)}decode(t){return e.encoder.decode(t)}}return e.encoder=ZT.getEncoder(jx.SIZE,jx.SIZE,(t,n)=>e.of(t,n).get()),e})(),Vx=(()=>{class e{}return e.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,e.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,e.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,e.INVALID_DIRECTION=()=>$localize`A move must be orthogonal or diagonal`,e})();class zx extends JI{static getListMovesFromState(e){const t=[];if(zx.getVictory(e).isPresent())return t;for(let n=0;n<jx.SIZE;n++)for(let r=0;r<jx.SIZE;r++){const i=new CI(r,n);if(e.getPieceAt(i)!==CS.NONE)for(const n of zx.possibleTargets(e,i)){const e=Ux.of(i,n).get();t.push(e)}}return t}static getNumberOfGroups(e){const t=cS.createTable(jx.SIZE,jx.SIZE,-1),n=[0,0];let r=0;for(let i=0;i<jx.SIZE;i++)for(let o=0;o<jx.SIZE;o++)if(-1===t[i][o]){const s=e.getPieceAt(new CI(o,i));s!==CS.NONE&&(r+=1,zx.markGroupStartingAt(e,t,new CI(o,i),r),n[s.value]+=1)}return n}static markGroupStartingAt(e,t,n,r){const i=[n],o=e.getPieceAt(n);for(;i.length>0;){const n=$O.getNonNullable(i.pop());if(-1===t[n.y][n.x]){const s=e.getPieceAt(n);if(s===o){t[n.y][n.x]=r;for(const t of bI.DIRECTIONS){const r=n.getNext(t);e.isOnBoard(r)&&i.push(r)}}else s===CS.NONE&&(t[n.y][n.x]=0)}}}applyLegalMove(e,t,n){const r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=CS.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new jx(r,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?iS.failure(Vx.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(e=>t.getPieceAt(e)===t.getCurrentOpponent())?iS.failure(Vx.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?iS.failure(DI.CANNOT_SELF_CAPTURE()):iS.success(void 0)}isLegal(e,t){return zx.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let r=0;for(const i of zx.getLineCoords(t,n))e.getPieceAt(i)!==CS.NONE&&(r+=1);return r}static getLineCoords(e,t){const n=zx.getEntranceAndForwardDirection(e,t);let r=n[0];const i=n[1],o=[];for(;jx.isOnBoard(r);)o.push(r),r=r.getNext(i);return o}static getEntranceAndForwardDirection(e,t){switch(t){case bI.UP:case bI.DOWN:return[new CI(e.x,0),bI.DOWN];case bI.LEFT:case bI.RIGHT:return[new CI(0,e.y),bI.RIGHT];case bI.UP_RIGHT:case bI.DOWN_LEFT:return[new CI(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),bI.UP_RIGHT];default:return $O.expectToBeMultiple(t,[bI.UP_LEFT,bI.DOWN_RIGHT]),[new CI(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),bI.DOWN_RIGHT]}}static getVictory(e){const[t,n]=zx.getNumberOfGroups(e);return 1===t&&1===n?XO.of(CS.NONE):1===t?XO.of(CS.ZERO):1===n?XO.of(CS.ONE):XO.empty()}static possibleTargets(e,t){const n=[];for(const r of bI.DIRECTIONS){const i=zx.numberOfPiecesOnLine(e,t,r),o=t.getNext(r,i);if(e.isOnBoard(o)){const r=Ux.of(t,o).get();zx.isLegal(r,e).isSuccess()&&n.push(o)}}return n}getGameStatus(e){const t=e.gameState,[n,r]=zx.getNumberOfGroups(t);return 1===n&&r>1?KI.ZERO_WON:n>1&&1===r?KI.ONE_WON:KI.ONGOING}}class Hx extends LI{getListMoves(e){return zx.getListMovesFromState(e.gameState)}getBoardValue(e){const t=e.gameState,[n,r]=zx.getNumberOfGroups(t);return new BI(1===n&&r>1?CS.ZERO.getVictoryValue():n>1&&1===r?CS.ONE.getVictoryValue():100/n*CS.ZERO.getScoreModifier()+100/r*CS.ONE.getScoreModifier())}}const Gx=CS.ZERO,$x=CS.ONE,qx=CS.NONE;class Wx{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new jx([[qx,qx,qx,qx,qx,qx,qx,qx],[$x,qx,qx,qx,Gx,qx,qx,$x],[qx,qx,Gx,Gx,$x,qx,qx,qx],[qx,qx,qx,Gx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx]],0)),nT.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,jx.getInitialState(),Ux.of(new CI(1,7),new CI(1,5)).get(),$localize`Congratulations!`),nT.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new jx([[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,$x,Gx,Gx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,$x],[qx,qx,qx,qx,qx,qx,qx,Gx]],0),[Ux.of(new CI(3,1),new CI(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),nT.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        Horizontally, this piece can move only of one square because it is the only piece on this line.
        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
        But it can only go up, as below it the landing square is occupied by one of your pieces.
        Diagonally, only one move is possible: on the diagonal that contains three pieces,
        only in the direction where it does not jump over one of the opponent's pieces.
        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>
        Make one of these moves.`,new jx([[qx,qx,qx,qx,qx,qx,$x,qx],[qx,qx,qx,qx,qx,Gx,qx,qx],[qx,qx,qx,qx,$x,qx,qx,qx],[qx,qx,qx,Gx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,$x],[qx,qx,qx,qx,qx,$x,qx,$x],[qx,qx,qx,Gx,qx,qx,$x,$x],[qx,qx,qx,Gx,qx,qx,qx,qx]],0),[Ux.of(new CI(3,3),new CI(3,0)).get(),Ux.of(new CI(3,3),new CI(0,0)).get(),Ux.of(new CI(3,3),new CI(2,3)).get(),Ux.of(new CI(3,3),new CI(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),nT.fromMove($localize`Capturing`,$localize`If a move ends on an opponent's pieces, this one is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new jx([[qx,Gx,qx,Gx,Gx,Gx,Gx,qx],[$x,qx,qx,qx,qx,qx,qx,$x],[qx,qx,Gx,qx,$x,qx,qx,qx],[$x,qx,qx,qx,qx,qx,qx,$x],[$x,qx,qx,qx,qx,qx,qx,$x],[$x,qx,qx,qx,qx,qx,qx,$x],[$x,qx,qx,qx,qx,qx,qx,$x],[qx,Gx,Gx,Gx,Gx,Gx,Gx,qx]],0),[Ux.of(new CI(2,2),new CI(4,2)).get()],$localize`Congratulations!`,$localize`Failed!`),nT.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new jx([[qx,qx,qx,qx,qx,qx,qx,qx],[qx,qx,qx,qx,qx,qx,qx,qx],[Gx,qx,qx,Gx,$x,Gx,qx,qx],[qx,qx,qx,Gx,qx,qx,qx,$x],[qx,qx,qx,qx,qx,qx,qx,$x],[qx,qx,qx,qx,qx,qx,qx,$x],[qx,qx,qx,qx,qx,qx,qx,$x],[qx,qx,qx,qx,qx,qx,qx,qx]],0),[Ux.of(new CI(0,2),new CI(4,2)).get()],$localize`Congratulations!`,$localize`Failed!`)]}}function Zx(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",5)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getPieceClasses(e,t)),r.Cb("cx",n.SPACE_SIZE/2+e*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+t*n.SPACE_SIZE)}}function Qx(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"g",2),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Mb(2,"rect",3),r.Ac(3,Zx,1,3,"circle",4),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","click_",n,"_",i,""),r.Bb(1),r.mc("ngClass",o.getSquareClasses(n,i)),r.Cb("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),r.Bb(1),r.mc("ngIf",e!==o.EMPTY)}}function Yx(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,Qx,4,8,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function Kx(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",6),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n.x,n.y)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.Cb("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let Jx=(()=>{class e extends BT{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=CS.NONE,this.targets=[],this.selected=XO.empty(),this.lastMove=XO.empty(),this.captured=XO.empty(),this.rules=new zx(jx),this.availableMinimaxes=[new Hx(this.rules,"LinesOfActionMinimax")],this.encoder=Ux.encoder,this.tutorial=(new Wx).tutorial,this.updateBoard()}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new CI(e,t);if(n.selected.isPresent()){if(n.getState().getPieceAt(i)===n.getState().getCurrentPlayer())return n.select(i);{const r=Ux.of(n.selected.get(),new CI(e,t));return r.isSuccess()?n.chooseMove(r.get(),n.rules.node.gameState):n.cancelMove(Vx.INVALID_DIRECTION())}}return n.select(i)})()}select(e){var t=this;return GO(function*(){return t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(DI.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=XO.of(e),t.targets=zx.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(Vx.PIECE_CANNOT_MOVE()):aS.SUCCESS)})()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end)!==CS.NONE?XO.of(e.end):XO.empty()}}cancelMoveAttempt(){this.selected=XO.empty(),this.targets=[]}getSquareClasses(e,t){const n=new CI(e,t);if(this.lastMove.isPresent()){const e=this.lastMove.get().coord,t=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(e)||n.equals(t))return["moved"]}return[]}getPieceClasses(e,t){const n=this.board[t][e],r=new CI(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-linesofaction"]],features:[r.yb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["r","40","class","base",3,"ngClass",4,"ngIf"],["r","40",1,"base",3,"ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,Yx,2,1,"g",1),r.Ac(2,Kx,2,4,"g",1),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.targets))},directives:[he,le,fe],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();const Xx=Number.MAX_SAFE_INTEGER,eR=Number.MIN_SAFE_INTEGER;let tR=(()=>{class e extends VI{constructor(t,n){super(cS.copyBiArray(e.initialBoard),t),this.turn=t,this.location=n}static getInitialState(){return new e(0,new CI(0,0))}}return e.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],e.BOARD_1=[[0,+Xx,-1,-1],[1,2,+Xx,-1],[+eR,3,4,-1],[-1,+eR,+eR,-1]],e.BOARD_2=[[0,+Xx,-1,-1],[+Xx,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],e.BOARD_3=[[0,1,+eR,-1],[1,+eR,-1,-1],[+eR,-1,-1,-1],[-1,-1,-1,-1]],e.BOARD_4=[[0,1,+eR,-1],[1,+eR,-1,-1],[+eR,-1,-1,-1],[-1,-1,-1,1]],e.initialBoard=e.BOARD_0,e})();class nR extends JI{static getGameStatus(e){const t=e.gameState,n=t.getPieceAt(t.location);return n===CS.ZERO.getVictoryValue()?KI.ZERO_WON:n===CS.ONE.getVictoryValue()?KI.ONE_WON:t.location.equals(new CI(3,3))?0===n?KI.DRAW:n>0?KI.ONE_WON:KI.ZERO_WON:KI.ONGOING}applyLegalMove(e,t,n){const r=new CI(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new tR(t.turn+1,r)}isLegal(e,t){const n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?iS.failure("incorrect move"):iS.success(void 0)}getGameStatus(e){return nR.getGameStatus(e)}}let rR=(()=>{class e extends HI{constructor(e){super(),this.right=e}equals(e){return this===e||this.right===e.right}toString(){return this.right?"Move RIGHT":"Move DOWN"}}return e.RIGHT=new e(!0),e.DOWN=new e(!1),e.encoder=new class extends YO{maxValue(){return 1}decodeNumber(t){return 0===t?e.RIGHT:e.DOWN}encodeNumber(e){return e.right?0:1}},e})();class iR extends LI{getBoardValue(e){const t=nR.getGameStatus(e);if(t.isEndGame)return new BI(t.toBoardValue());const n=e.gameState;return new BI(n.getPieceAt(n.location))}getListMoves(e){const t=[],n=e.gameState;return n.location.x<3&&t.push(rR.RIGHT),n.location.y<3&&t.push(rR.DOWN),t}}function oR(e,t){1&e&&(r.Ob(0),r.Cc(1,"("),r.Nb())}function sR(e,t){1&e&&(r.Ob(0),r.Cc(1,")"),r.Nb())}function aR(e,t){if(1&e&&(r.Qb(0,"td"),r.Ac(1,oR,2,0,"ng-container",3),r.Cc(2),r.Ac(3,sR,2,0,"ng-container",3),r.Pb()),2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.mc("ngIf",o.coord.x===n&&o.coord.y===i),r.Bb(1),r.Ec(" ",e," "),r.Bb(1),r.mc("ngIf",o.coord.x===n&&o.coord.y===i)}}function cR(e,t){if(1&e&&(r.Qb(0,"tr"),r.Ac(1,aR,4,3,"td",0),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}let lR=(()=>{class e extends BT{constructor(e){super(e),this.coord=new CI(-1,-1),this.rules=new nR(tR),this.availableMinimaxes=[new iR(this.rules,"MinimaxTestingMinimax")],this.encoder=rR.encoder}chooseRight(){var e=this;return GO(function*(){const t=e.canUserPlay("#click_right");return t.isFailure()?e.cancelMove(t.getReason()):e.chooseMove(rR.RIGHT,e.rules.node.gameState)})()}chooseDown(){var e=this;return GO(function*(){const t=e.canUserPlay("#click_down");return t.isFailure()?e.cancelMove(t.getReason()):e.chooseMove(rR.DOWN,e.rules.node.gameState)})()}updateBoard(){const e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-minimax-testing"]],features:[r.yb],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(r.Qb(0,"table"),r.Ac(1,cR,2,1,"tr",0),r.Qb(2,"div",1),r.cc("click",function(){return t.chooseRight()}),r.Cc(3," goRight "),r.Pb(),r.Qb(4,"div",2),r.cc("click",function(){return t.chooseDown()}),r.Cc(5," goDown "),r.Pb(),r.Qb(6,"div"),r.Cc(7),r.Pb(),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.board),r.Bb(6),r.Ec(" ",t.coord," "))},directives:[he,fe],encapsulation:2}),e})();class uR extends VI{static getInitialState(){const e=cS.createTable(7,6,CS.NONE);return new uR(e,0)}}let hR=(()=>{class e extends HI{constructor(e){super(),this.x=e}static of(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;case 3:return e.THREE;case 4:return e.FOUR;case 5:return e.FIVE;case 6:return e.SIX;default:throw new Error("Invalid P4Move")}}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}return e.ZERO=new e(0),e.ONE=new e(1),e.TWO=new e(2),e.THREE=new e(3),e.FOUR=new e(4),e.FIVE=new e(5),e.SIX=new e(6),e.encoder=new class extends YO{maxValue(){return 6}encodeNumber(e){return e.x}decodeNumber(t){return e.of(t)}},e})(),dR=(()=>{class e{}return e.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,e})(),fR=(()=>{class e extends JI{static getVictoriousCoords(t){const n=[];for(let r=0;r<7;r++)for(let i=5;-1!==i&&t.board[i][r]!==CS.NONE;i--){const o=e.getSquareScore(t.board,new CI(r,i));o!==CS.ZERO.getVictoryValue()&&o!==CS.ONE.getVictoryValue()||n.push(new CI(r,i))}return n}static getBoardValueFromScratch(t){qO(e.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let n=0;for(let r=0;r<7;r++)for(let i=5;-1!==i&&t.board[i][r]!==CS.NONE;i--){const o=e.getSquareScore(t.board,new CI(r,i));if(YI.getScoreStatus(o)!==qI.DEFAULT)return qO(e.VERBOSE,{preVictoryOrVictory:{state:t,tmpScore:o,coord:{x:r,y:i}}}),new BI(o);n+=o}return new BI(n)}static getLowestUnoccupiedCase(e,t){let n=0;for(;n<6&&e[n][t]===CS.NONE;)n++;return n-1}static getNumberOfFreeSpacesAndAllies(e,t,n,r,i){let o=0,s=0,a=!0,c=new CI(t.x+n.x,t.y+n.y);for(;c.isInRange(7,6)&&3!==o;){const t=e[c.y][c.x];if(t===r)return[o,s];t===i&&a?s++:a=!1,t!==r&&t!==i&&o++,c=c.getNext(n)}return[o,s]}static getOpponent(e,t){const n=e[t.y][t.x];return WO(n!==CS.NONE,"getOpponent should not be called with Player.NONE"),n===CS.ONE?CS.ZERO:CS.ONE}static getSquareScore(t,n){qO(e.VERBOSE,"getSquareScore(board, "+n.x+", "+n.y+") called"),qO(e.VERBOSE,t),WO(t[n.y][n.x]!==CS.NONE,"getSquareScore should not be called on an empty space");let r=0;const i=e.getOpponent(t,n),o=t[n.y][n.x],s=new WI,a=new WI;for(const c of bI.DIRECTIONS){const r=e.getNumberOfFreeSpacesAndAllies(t,n,c,i,o);s.set(c,r[0]),a.set(c,r[1])}for(const c of[bI.UP,bI.UP_RIGHT,bI.RIGHT,bI.DOWN_RIGHT]){const i=a.get(c).get()+a.get(c.getOpposite()).get();if(i>2)return qO(e.VERBOSE,{text:"there is some kind of victory here ("+n.x+", "+n.y+")\nline allies : "+i+"\n",board:t}),o.getVictoryValue();const l=s.get(c).get()+s.get(c.getOpposite()).get();3===l?r+=2:l>3&&(r+=l-2)}return r*o.getScoreModifier()}static getListMoves(t){qO(e.VERBOSE,{context:"P4Rules.getListMoves",node:t});const n=t.gameState,r=[];for(let e=0;e<7;e++)if(n.getPieceAtXY(e,0)===CS.NONE){const t=hR.of(e);r.push(t)}return r}static getBoardValue(t){return qO(e.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),e.getBoardValueFromScratch(t)}applyLegalMove(t,n,r){const i=t.x,o=n.getCopiedBoard(),s=e.getLowestUnoccupiedCase(o,i),a=n.turn;return o[s][i]=n.getCurrentPlayer(),new uR(o,a+1)}isLegal(t,n){return qO(e.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:n}),n.getPieceAtXY(t.x,0)!==CS.NONE?iS.failure(dR.COLUMN_IS_FULL()):iS.success(void 0)}getGameStatus(t){const n=t.gameState;for(let r=0;r<7;r++)for(let t=5;-1!==t&&n.board[t][r]!==CS.NONE;t--){const i=e.getSquareScore(n.board,new CI(r,t));if(YI.getScoreStatus(i)===qI.VICTORY)return KI.getVictory(n.getCurrentOpponent())}return 42===n.turn?KI.DRAW:KI.ONGOING}}return e.VERBOSE=!1,e})();class pR extends LI{getListMoves(e){return fR.getListMoves(e)}getBoardValue(e){const t=e.gameState;return qO(fR.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),fR.getBoardValue(t)}}const gR=CS.ZERO,mR=CS.ONE,yR=CS.NONE;class vR{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,uR.getInitialState()),nT.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,uR.getInitialState(),hR.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),nT.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new uR([[yR,yR,yR,yR,yR,yR,yR],[yR,yR,yR,yR,yR,yR,yR],[yR,yR,yR,yR,yR,yR,yR],[yR,yR,yR,mR,yR,yR,yR],[yR,yR,yR,mR,yR,yR,yR],[yR,yR,gR,gR,gR,mR,yR]],0),[hR.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),nT.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new uR([[yR,yR,yR,yR,yR,yR,yR],[yR,yR,yR,yR,yR,yR,yR],[yR,yR,yR,yR,yR,yR,yR],[yR,yR,yR,gR,mR,yR,yR],[yR,yR,gR,gR,mR,yR,yR],[yR,gR,mR,gR,gR,yR,yR]],0),[hR.of(3),hR.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function bR(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",6)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getSquareFillClass(e,t)),r.Cb("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function _R(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",4),r.cc("click",function(){r.wc(e);const n=t.index;return r.fc(2).onClick(n)}),r.Pb(),r.Ac(2,bR,1,4,"circle",5),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.nc("id","click_",n,""),r.Cb("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),r.Bb(1),r.mc("ngIf",e!=o.EMPTY_CASE)}}function wR(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,_R,3,6,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function CR(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",7)),2&e){const e=r.fc();r.Cb("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function ER(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",8)),2&e){const e=t.$implicit,n=r.fc();r.oc("id","victory_coord_",e.x,"_",e.y,""),r.Cb("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let OR=(()=>{class e extends BT{constructor(e){super(e),this.EMPTY_CASE=CS.NONE,this.victoryCoords=[],this.rules=new fR(uR),this.availableMinimaxes=[new pR(this.rules,"P4Minimax")],this.encoder=hR.encoder,this.tutorial=(new vR).tutorial,this.updateBoard()}onClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#click_"+e);if(n.isFailure())return t.cancelMove(n.getReason());const r=hR.of(e);return yield t.chooseMove(r,t.rules.node.gameState)})()}updateBoard(){const e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=fR.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.rules.node.move,t=fR.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=XO.of(new CI(e.get().x,t))}hideLastMove(){this.last=XO.empty()}getSquareFillClass(e,t){return[this.getPlayerClass(this.board[t][e])]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-p4"]],features:[r.yb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[1,"base",3,"id","click"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,wR,2,1,"g",1),r.Ac(2,CR,1,4,"rect",2),r.Ac(3,ER,1,6,"rect",3),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngIf",t.last.isPresent()),r.Bb(1),r.mc("ngForOf",t.victoryCoords))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),SR=(()=>{class e extends GI{constructor(e,t,n,r=!1){if(super(e,t),this.blockTurned=n,this.turnedClockwise=r,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,n,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new e(t,n,XO.of(r),i)}static rotationless(t,n){return new e(t,n,XO.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}return e.encoder=new class extends QO{encodeMove(e){const t={coord:CI.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}decodeMove(t){const n=t,r=CI.encoder.decode(n.coord),i=XO.ofNullable(n.blockTurned);if(i.isPresent()){const t=n.turnedClockwise;return e.withRotation(r.x,r.y,i.get(),t)}return e.rotationless(r.x,r.y)}},e})(),PR=(()=>{class e{}return e.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,e.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,e})(),IR=(()=>{class e extends VI{constructor(e,t){super(e,t),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=cS.createTable(6,6,CS.NONE);return new e(t,0)}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(t){const n=e.getBlockCenter(t),r=this.getPieceAt(n.getNext(bI.UP,1)),i=this.getPieceAt(n.getNext(bI.UP_LEFT,1));return this.getPieceAt(n.getNext(bI.RIGHT,1))===r&&this.getPieceAt(n.getNext(bI.DOWN,1))===r&&this.getPieceAt(n.getNext(bI.LEFT,1))===r&&this.getPieceAt(n.getNext(bI.UP_RIGHT,1))===i&&this.getPieceAt(n.getNext(bI.DOWN_RIGHT,1))===i&&this.getPieceAt(n.getNext(bI.DOWN_LEFT,1))===i}static getBlockCenter(e){return new CI(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(t){const n=this.getCopiedBoard();return n[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new e(n,this.turn)}applyLegalMove(t){const n=this.applyLegalDrop(t),r=n.getCopiedBoard();if(t.blockTurned.isPresent()){const i=e.getBlockCenter(t.blockTurned.get());if(t.turnedClockwise)for(const t of e.ROTATION_MAP){const e=t[0].getNext(i),o=t[1].getNext(i),s=n.getPieceAt(e);r[o.y][o.x]=s}else for(const t of e.ROTATION_MAP){const e=t[1].getNext(i),o=t[0].getNext(i),s=n.getPieceAt(e);r[o.y][o.x]=s}}return new e(r,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}return e.ROTATION_MAP=[[new CI(-1,-1),new CI(1,-1)],[new CI(0,-1),new CI(1,0)],[new CI(1,-1),new CI(1,1)],[new CI(1,0),new CI(0,1)],[new CI(1,1),new CI(-1,1)],[new CI(0,1),new CI(-1,0)],[new CI(-1,1),new CI(-1,-1)],[new CI(-1,0),new CI(0,-1)]],e})(),TR=(()=>{class e extends JI{static get(){return null==e.singleton&&(e.singleton=new e(IR)),YI.ruler=this.singleton,this.singleton}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord)!==CS.NONE)return iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return iS.failure(PR.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const t=e.blockTurned.get();if(n.neutralBlocks.includes(t))return iS.failure(PR.CANNOT_ROTATE_NEUTRAL_BLOCK())}return iS.success(void 0)}getVictoryCoords(t){let n=[];for(const r of e.VICTORY_SOURCE){const e=t.getPieceAt(r[0]),i=[r[0]];if(e!==CS.NONE){let o=r[0].getNext(r[1]),s=!0;for(let n=0;n<3&&s;n++)t.getPieceAt(o)!==e?s=!1:(i.push(o),o=o.getNext(r[1]));if(s&&(t.getPieceAt(o)===e&&(i.push(o),n=n.concat(i)),r[2])){const o=r[0].getPrevious(r[1],1);t.getPieceAt(o)===e&&(i.push(o),n=n.concat(i))}}}return n}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1];for(let i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?KI.DRAW:KI.ZERO_WON:!0===r[1]?KI.ONE_WON:36===t.turn?KI.DRAW:KI.ONGOING}}return e.VICTORY_SOURCE=[[new CI(1,0),new gI(1,1),!1],[new CI(0,1),new gI(1,1),!1],[new CI(4,0),new gI(-1,1),!1],[new CI(5,1),new gI(-1,1),!1],[new CI(1,1),new gI(1,1),!0],[new CI(4,1),new gI(-1,1),!0],[new CI(0,1),new gI(0,1),!0],[new CI(1,1),new gI(0,1),!0],[new CI(2,1),new gI(0,1),!0],[new CI(3,1),new gI(0,1),!0],[new CI(4,1),new gI(0,1),!0],[new CI(5,1),new gI(0,1),!0],[new CI(1,0),new gI(1,0),!0],[new CI(1,1),new gI(1,0),!0],[new CI(1,2),new gI(1,0),!0],[new CI(1,3),new gI(1,0),!0],[new CI(1,4),new gI(1,0),!0],[new CI(1,5),new gI(1,0),!0]],e})(),AR=(()=>{class e extends LI{getListMoves(t){const n=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return e.FIRST_TURN_MOVES;const i=this.getLegalDrops(t.gameState);for(const e of i){const i=SR.rotationless(e.x,e.y),o=t.gameState.applyLegalDrop(i),s=this.getLegalRotations(o,r);for(const t of s)n.push(SR.withRotation(e.x,e.y,t[0],t[1]));0==(0===o.neutralBlocks.length)&&n.push(i)}return n}getLegalDrops(e){const t=[];for(let n=0;n<6;n++)for(let r=0;r<6;r++){const i=new CI(r,n);e.getPieceAt(i)===CS.NONE&&t.push(i)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,r=[];for(let i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}getBoardValue(e){return new BI(TR.get().getGameStatus(e).toBoardValue())}}return e.FIRST_TURN_MOVES=[SR.rotationless(0,0),SR.rotationless(1,0),SR.rotationless(2,0),SR.rotationless(0,1),SR.rotationless(1,1),SR.rotationless(0,2)],e})();const kR=CS.NONE,NR=CS.ONE,MR=CS.ZERO;class xR{constructor(){this.tutorial=[nT.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,IR.getInitialState()),nT.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new IR([[MR,kR,kR,MR,NR,kR],[MR,NR,kR,kR,kR,kR],[MR,kR,NR,kR,kR,kR],[MR,kR,kR,kR,kR,NR],[MR,kR,kR,kR,NR,kR],[kR,kR,kR,kR,kR,kR]],10)).withPreviousMove(SR.withRotation(0,0,0,!1)),nT.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        Do it.`,new IR([[kR,kR,kR,kR,kR,kR],[kR,MR,kR,kR,NR,kR],[kR,kR,kR,kR,kR,kR],[kR,kR,kR,kR,kR,kR],[kR,NR,kR,kR,MR,kR],[kR,kR,kR,kR,kR,kR]],10),SR.rotationless(2,2),(e,t)=>e.blockTurned.isPresent()?aS.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):aS.SUCCESS,$localize`Congratulations!`),nT.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        Click on one of them and see the rotation!`,new IR([[kR,kR,kR,kR,kR,kR],[kR,MR,kR,kR,NR,kR],[kR,kR,kR,kR,kR,kR],[kR,kR,kR,kR,kR,kR],[kR,NR,kR,kR,MR,kR],[kR,kR,kR,kR,kR,kR]],10),SR.withRotation(0,0,0,!0),(e,t)=>e.blockTurned.isPresent()?aS.SUCCESS:aS.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function RR(e,t){if(1&e){const e=r.Rb();r.ec(),r.Ob(0),r.Qb(1,"circle",9),r.cc("click",function(){r.wc(e);const n=t.$implicit,i=r.fc().$implicit,o=r.fc().index,s=r.fc().index;return r.fc().onClick(3*o+n,3*s+i)}),r.Pb(),r.Nb()}if(2&e){const e=t.$implicit,n=r.fc().$implicit,i=r.fc(),o=i.index,s=i.$implicit,a=r.fc(),c=a.index,l=a.$implicit,u=r.fc();r.Bb(1),r.oc("id","click_",3*o+e,"_",3*c+n,""),r.mc("ngClass",u.getSquareClasses(3*o+e,3*c+n)),r.Cb("cx",s+2*u.STROKE_WIDTH+(e+.5)*u.SPACE_SIZE)("cy",l+2*u.STROKE_WIDTH+(n+.5)*u.SPACE_SIZE)("r",(u.SPACE_SIZE-u.STROKE_WIDTH)/2)}}const DR=function(){return[0,1,2]};function LR(e,t){1&e&&(r.ec(),r.Ob(0),r.Ac(1,RR,2,6,"ng-container",3),r.Nb()),2&e&&(r.Bb(1),r.mc("ngForOf",r.qc(1,DR)))}function BR(e,t){if(1&e&&(r.ec(),r.Ob(0),r.Mb(1,"rect",8),r.Ac(2,LR,2,2,"ng-container",3),r.Nb()),2&e){const e=t.$implicit,n=t.index,i=r.fc(),o=i.index,s=i.$implicit,a=r.fc();r.Bb(1),r.mc("ngClass",a.getBlockClasses(n,o)),r.Cb("x",a.STROKE_WIDTH+e)("y",a.STROKE_WIDTH+s)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),r.Bb(1),r.mc("ngForOf",r.qc(8,DR))}}const FR=function(e){return[0,e]};function jR(e,t){if(1&e&&(r.ec(),r.Ob(0),r.Ac(1,BR,3,9,"ng-container",3),r.Nb()),2&e){const e=r.fc();r.Bb(1),r.mc("ngForOf",r.rc(1,FR,e.BLOCK_SEPARATION))}}function UR(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",10)),2&e){const e=r.fc();r.oc("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),r.mc("ngClass",e.getPlayerClass(e.rules.node.gameState.getCurrentPlayer())),r.Cb("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function VR(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"path",11),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().rotate(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.oc("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),r.Cb("d",e[0])("stroke-width",2*n.STROKE_WIDTH)}}function zR(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",12)),2&e){const e=t.$implicit,n=r.fc();r.oc("id","victoryCoord_",e.x,"_",e.y,""),r.mc("ngClass",n.getSquareClasses(e.x,e.y)),r.Cb("cx",n.getCenter(e.x))("cy",n.getCenter(e.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function HR(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",13),r.cc("click",function(){return r.wc(e),r.fc().skipRotation()}),r.Mb(1,"circle",14),r.Mb(2,"line",15),r.Pb()}if(2&e){const e=r.fc();r.Bb(1),r.Cb("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),r.Bb(1),r.Cb("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let GR=(()=>{class e extends BT{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=new TR(IR),this.availableMinimaxes=[new AR(this.rules,"PentagoMinimax")],this.encoder=SR.encoder,this.tutorial=(new xR).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const t=e.get();this.movedBlock=t.blockTurned;const n=new CI(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new CI(0,0))&&this.coordBelongToBlock(t)){let e;e=t.turnedClockwise?$O.getNonNullable(IR.ROTATION_MAP.find(e=>e[0].equals(n)))[1]:$O.getNonNullable(IR.ROTATION_MAP.find(e=>e[1].equals(n)))[0];const r=t.blockTurned.get();e=e.getNext(new gI(r%2==0?1:4,r<2?1:4),1),this.lastDrop=XO.of(e)}else this.lastDrop=XO.of(t.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=XO.empty(),this.movedBlock=XO.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=XO.empty(),this.canSkipRotation=!1}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(n.board[t][e]!==CS.NONE)return n.cancelMove(DI.MUST_LAND_ON_EMPTY_SPACE());const i=SR.rotationless(e,t),o=n.rules.node.gameState,s=o.applyLegalDrop(i);if(4===s.neutralBlocks.length)return n.chooseMove(i,o);const a=n.rules.getGameStatus(n.rules.node);return n.canSkipRotation=s.neutralBlocks.length>0&&!1===a.isEndGame,n.currentDrop=XO.of(new CI(e,t)),n.displayArrows(s.neutralBlocks),aS.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let t=0;t<4;t++)if(!1===e.includes(t)){const e=this.ARROWS.filter(e=>e[1]===t);this.arrows=this.arrows.concat(e)}}getBlockClasses(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}getSquareClasses(e,t){const n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new CI(e,t))&&n.push("last-move"),n}rotate(e){var t=this;return GO(function*(){const n=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(n.isFailure())return t.cancelMove(n.getReason());const r=t.currentDrop.get(),i=SR.withRotation(r.x,r.y,e[1],e[2]);return t.chooseMove(i,t.rules.node.gameState)})()}skipRotation(){var e=this;return GO(function*(){const t=e.canUserPlay("#skipRotation");if(t.isFailure())return e.cancelMove(t.getReason());const n=e.currentDrop.get(),r=SR.rotationless(n.x,n.y);return e.chooseMove(r,e.rules.node.gameState)})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-pentago"]],features:[r.yb],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"defs"),r.Qb(2,"marker",1),r.Mb(3,"polygon",2),r.Pb(),r.Pb(),r.Ac(4,jR,2,3,"ng-container",3),r.Ac(5,UR,1,6,"circle",4),r.Ac(6,VR,1,4,"path",5),r.Ac(7,zR,1,7,"circle",6),r.Ac(8,HR,3,9,"g",7),r.Pb()),2&e&&(r.Bb(4),r.mc("ngForOf",r.rc(5,FR,t.BLOCK_SEPARATION)),r.Bb(1),r.mc("ngIf",t.currentDrop.isPresent()),r.Bb(1),r.mc("ngForOf",t.arrows),r.Bb(1),r.mc("ngForOf",t.victoryCoords),r.Bb(1),r.mc("ngIf",t.canSkipRotation))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class $R extends CI{constructor(e,t,n){if(super(e,t),this.z=n,e<0||e>3)throw new Error(`PylosCoord: Invalid X: ${e}.`);if(t<0||t>3)throw new Error(`PylosCoord: Invalid Y: ${t}.`);if(n<0||n>3)throw new Error(`PylosCoord: Invalid Z: ${n}.`);const r=4-n;if(this.isNotInRange(r,r))throw new Error(this.toString()+" is not in range.")}static encodeOptional(e){let t;return t=e.isPresent()?$R.encode(e.get())+1:0,t}static encode(e){return 16*e.x+4*e.y+e.z}static decodeToOptional(e){return 0===e?XO.empty():XO.of($R.decode(e-1))}static decode(e){const t=e%4;e-=t;const n=(e/=4)%4;return e-=n,new $R(e/=4,n,t)}toString(){return"PylosCoord"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isUpperThan(e){return this.z>e.z}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new $R(this.x,this.y,e),new $R(this.x+1,this.y,e),new $R(this.x,this.y+1,e),new $R(this.x+1,this.y+1,e)]}getHigherPieces(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new CI(this.x-1,this.y-1),n=new CI(this.x,this.y-1),r=new CI(this.x-1,this.y),i=new CI(this.x,this.y),o=4-e;return[t,n,r,i].filter(e=>e.isInRange(o,o)).map(t=>new $R(t.x,t.y,e))}getNextValid(e){const t=new CI(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?XO.empty():XO.of(new $R(t.x,t.y,this.z))}}let qR=(()=>{class e extends HI{constructor(e,t,n,r){super(),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=r}static fromClimb(t,n,r){const i=XO.of(t),o=e.checkCaptures(r),s=new e(i,n,o.firstCapture,o.secondCapture);if(!n.isUpperThan(t))throw new Error("PylosMove: When piece move it must move upward.");return s}static checkCaptures(e){let t=XO.empty(),n=XO.empty();if(e.length>0&&(t=XO.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=XO.of(e[1]),e[1].isUpperThan(e[0])&&(t=XO.of(e[1]),n=XO.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}static fromDrop(t,n){const r=XO.empty(),i=e.checkCaptures(n);return new e(r,t,i.firstCapture,i.secondCapture)}static changeCapture(t,n){const r=e.checkCaptures(n);return new e(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!!this.startingCoord.equals(e.startingCoord)&&!!this.landingCoord.equals(e.landingCoord)&&!!this.firstCapture.equals(e.firstCapture)&&!!this.secondCapture.equals(e.secondCapture)}}return e.encoder=new class extends YO{maxValue(){return 17575999}encodeNumber(e){const t=$R.encode(e.landingCoord),n=$R.encodeOptional(e.startingCoord),r=$R.encodeOptional(e.firstCapture);return 270400*$R.encodeOptional(e.secondCapture)+4160*r+64*n+t}decodeNumber(t){const n=$R.decode(t%64);t-=t%64;const r=$R.decodeToOptional((t/=64)%65);t-=t%65;const i=$R.decodeToOptional((t/=65)%65);t-=t%65;const o=$R.decodeToOptional(t/=65);return new e(r,n,i,o)}},e})();class WR extends UI{constructor(e,t){super(t),this.boards=e}static getInitialState(){const e=cS.createTable(4,4,CS.NONE),t=cS.createTable(3,3,CS.NONE),n=cS.createTable(2,2,CS.NONE);return new WR([e,t,n,[[CS.NONE]]],0)}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e){const t=[];return t.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&t.push({coord:e.startingCoord.get(),value:CS.NONE}),e.firstCapture.isPresent()&&t.push({coord:e.firstCapture.get(),value:CS.NONE}),e.secondCapture.isPresent()&&t.push({coord:e.secondCapture.get(),value:CS.NONE}),this.setBoardAts(t,this.turn+1)}setBoardAts(e,t){const n=[cS.copyBiArray(this.boards[0]),cS.copyBiArray(this.boards[1]),cS.copyBiArray(this.boards[2]),cS.copyBiArray(this.boards[3])];for(const r of e){const e=r.coord;n[e.z][e.y][e.x]=r.value}return new WR(n,t)}isLandable(e){if(this.getPieceAt(e)!==CS.NONE)return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===CS.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherPieces();for(const n of t)if(this.getPieceAt(n)!==CS.NONE)return!0;return!1}getPiecesRepartition(){const e={};e[CS.NONE.value]=0,e[CS.ZERO.value]=0,e[CS.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let r=0;r<4-t;r++){const i=new $R(r,n,t),o=this.getPieceAt(i);e[o.value]=1+e[o.value]}return e}}let ZR=(()=>{class e{}return e.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,e.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,e.CANNOT_LAND=()=>$localize`You cannot land on this space.`,e.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,e.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,e.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,e})();class QR extends JI{static getStateInfo(e){const t=[],n=[];for(let r=0;r<3;r++)for(let i=0;i<4-r;i++)for(let o=0;o<4-r;o++){const s=new $R(o,i,r);e.getPieceAt(s)===e.getCurrentPlayer()&&!1===e.isSupporting(s)&&t.push(s),e.isLandable(s)&&n.push(s)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const r of e.landable)if(r.isUpperThan(n)&&!1===r.getLowerPieces().some(e=>n.equals(e))){const e=qR.fromClimb(n,r,[]);t.push(e)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const e=qR.fromDrop(n,[]);t.push(e)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const r of[wI.UP,wI.DOWN]){const i=t.getNextValid(r);if(i.isPresent()&&e.getPieceAt(i.get())===n)for(const t of[wI.LEFT,wI.RIGHT]){const o=i.get().getNextValid(t);if(o.isPresent()&&e.getPieceAt(o.get())===n){const t=r.getOpposite(),i=o.get().getNextValid(t).get();if(e.getPieceAt(i)===n)return!0}}}return!1}static getPossibleCaptures(e,t,n){const r=[],i=(e=e.filter(e=>!1===t.equalsValue(e))).concat(n);for(let o=0;o<i.length;o++){const e=i[o];r.push([e]);for(let t=o+1;t<i.length;t++)r.push([i[t],e])}return r}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r||n.getHigherPieces().filter(n=>e.getPieceAt(n)!==CS.NONE&&!1===n.equals(t.firstCapture.get())).length>0)}static getGameStatus(e){const t=e.gameState.getPiecesRepartition();return 15===t[CS.ZERO.value]?KI.ONE_WON:15===t[CS.ONE.value]?KI.ZERO_WON:KI.ONGOING}applyLegalMove(e,t,n){return QR.applyLegalMove(e,t,n)}isLegal(e,t){if(t.getPieceAt(e.landingCoord)!==CS.NONE)return iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE());const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return iS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===CS.NONE)return iS.failure(DI.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(r.getHigherPieces().filter(n=>t.getPieceAt(n)!==CS.NONE||n.equals(e.landingCoord)).length>0)return iS.failure(ZR.SHOULD_HAVE_SUPPORTING_PIECES())}if(!t.isLandable(e.landingCoord))return iS.failure(ZR.CANNOT_LAND());if(e.firstCapture.isPresent()){if(!1===QR.canCapture(t,e.landingCoord))return iS.failure(ZR.CANNOT_CAPTURE());if(!QR.isValidCapture(t,e,e.firstCapture.get()))return iS.failure(ZR.INVALID_FIRST_CAPTURE());if(e.secondCapture.isPresent()&&!QR.isValidCapture(t,e,e.secondCapture.get()))return iS.failure(ZR.INVALID_SECOND_CAPTURE())}return iS.success(void 0)}getGameStatus(e){return QR.getGameStatus(e)}}class YR extends LI{static getListMoves(e){const t=e.gameState,n=[],r=QR.getStateInfo(t),i=QR.getClimbingMoves(r),o=QR.getDropMoves(r),s=i.concat(o);for(const a of s){let e=[[]];QR.canCapture(t,a.landingCoord)&&(e=QR.getPossibleCaptures(r.freeToMove,a.startingCoord,a.landingCoord));for(const t of e){const e=qR.changeCapture(a,t);n.push(e)}}return n}getListMoves(e){return YR.getListMoves(e)}getBoardValue(e){const t=QR.getGameStatus(e);if(t.isEndGame)return new BI(t.toBoardValue());{const t=e.gameState.getPiecesRepartition();return new BI(t[CS.ZERO.value]-t[CS.ONE.value])}}}class KR extends YR{static countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}static sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}getListMoves(e){const t=YR.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((e,t)=>{const n=12*KR.countStoneUsed(e),r=12*KR.countStoneUsed(t);return n+KR.sumMoveEmplacementByValue(e)-(r+KR.sumMoveEmplacementByValue(t))})}}const JR=CS.NONE,XR=CS.ZERO,eD=CS.ONE;class tD{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,WR.getInitialState()),nT.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,WR.getInitialState(),qR.fromDrop(new $R(1,1,0),[]),$localize`There you go, as simple as that.`),nT.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        Go ahead, climb!`,new WR([[[XR,eD,JR,JR],[eD,XR,JR,JR],[JR,JR,JR,JR],[JR,JR,JR,XR]],[[JR,JR,JR],[JR,JR,JR],[JR,JR,JR]],[[JR,JR],[JR,JR]],[[JR]]],0),[qR.fromClimb(new $R(3,3,0),new $R(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed!`),nT.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.
        You're playing Dark.<br/><br/>
        Form a square, then click twice on one of the four pieces to remove only that one.`,new WR([[[XR,XR,JR,JR],[JR,XR,JR,JR],[JR,JR,JR,JR],[JR,JR,JR,JR]],[[JR,JR,JR],[JR,JR,JR],[JR,JR,JR]],[[JR,JR],[JR,JR]],[[JR]]],0),[qR.fromDrop(new $R(0,1,0),[new $R(0,0,0)]),qR.fromDrop(new $R(0,1,0),[new $R(0,1,0)]),qR.fromDrop(new $R(0,1,0),[new $R(1,0,0)]),qR.fromDrop(new $R(0,1,0),[new $R(1,1,0)])],$localize`Congratulations, you have saved up one piece.`,$localize`Failed!`),nT.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces.`,new WR([[[XR,XR,JR,JR],[JR,XR,JR,JR],[JR,JR,JR,JR],[JR,JR,JR,JR]],[[JR,JR,JR],[JR,JR,JR],[JR,JR,JR]],[[JR,JR],[JR,JR]],[[JR]]],0),qR.fromDrop(new $R(0,1,0),[new $R(0,0,0),new $R(1,0,0)]),(e,t)=>e.secondCapture.isPresent()?aS.SUCCESS:e.firstCapture.isPresent()?aS.failure($localize`Failed, you only captured one piece.`):aS.failure($localize`Failed, you did not capture any piece.`),$localize`Congratulations, you have saved up two pieces.`)]}}function nD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Mb(1,"circle",4),r.Pb()),2&e){const e=t.$implicit,n=r.fc().$implicit,i=r.fc();r.Bb(1),r.oc("id","piece_",n,"_",e,""),r.mc("ngClass",i.getPlayerPieceClass(n)),r.Cb("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*e)("cy",860+(i.SPACE_SIZE+10)*n)("r",.5*i.SPACE_SIZE)}}function rD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,nD,2,6,"g",1),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngForOf",n.getPlayerSidePieces(e))}}function iD(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"circle",8),r.cc("click",function(){r.wc(e);const t=r.fc(2).$implicit,n=r.fc().$implicit,i=r.fc().$implicit;return r.fc().onPieceClick(t,n,i)}),r.Pb()}if(2&e){const e=r.fc(2).$implicit,t=r.fc().$implicit,n=r.fc().$implicit,i=r.fc();r.pc("id","piece_",e,"_",t,"_",n,""),r.mc("ngClass",i.getPieceClasses(e,t,n)),r.Cb("r",i.getPieceRadius(n)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,t,n))("cy",i.getPieceCy(e,t,n))}}function oD(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"rect",8),r.cc("click",function(){r.wc(e);const t=r.fc(2).$implicit,n=r.fc().$implicit,i=r.fc().$implicit;return r.fc().onDrop(t,n,i)}),r.Pb()}if(2&e){const e=r.fc(2).$implicit,t=r.fc().$implicit,n=r.fc().$implicit,i=r.fc();r.pc("id","drop_",e,"_",t,"_",n,""),r.mc("ngClass",i.getSquareClasses(e,t,n)),r.Cb("width",2*i.getPieceRadius(n))("height",2*i.getPieceRadius(n))("x",i.getPieceCx(e,t,n)-i.getPieceRadius(n))("y",i.getPieceCy(e,t,n)-i.getPieceRadius(n))}}function sD(e,t){if(1&e&&(r.ec(),r.Ob(0),r.Ac(1,iD,1,7,"circle",6),r.Ac(2,oD,1,8,"ng-template",null,7,r.Bc),r.Nb()),2&e){const e=r.vc(3),t=r.fc().$implicit,n=r.fc().$implicit,i=r.fc().$implicit,o=r.fc();r.Bb(1),r.mc("ngIf",o.isOccupied(t,n,i))("ngIfElse",e)}}function aD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,sD,4,2,"ng-container",5),r.Pb()),2&e){const e=t.$implicit,n=r.fc().$implicit,i=r.fc().$implicit,o=r.fc();r.Bb(1),r.mc("ngIf",o.isDrawable(e,n,i))}}function cD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,aD,2,1,"g",1),r.Pb()),2&e){const e=r.fc().$implicit,t=r.fc();r.Bb(1),r.mc("ngForOf",t.getLevelRange(e))}}function lD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,cD,2,1,"g",1),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngForOf",n.getLevelRange(e))}}function uD(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",9)),2&e){const e=r.fc();r.pc("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),r.Cb("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCx(e.highCapture.get().x,e.highCapture.get().y,e.highCapture.get().z)-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCy(e.highCapture.get().x,e.highCapture.get().y,e.highCapture.get().z)-e.getPieceRadius(e.highCapture.get().z))}}const hD=function(){return[0,1]},dD=function(){return[0,1,2]};let fD=(()=>{class e extends SI{constructor(e){super(e),this.lastLandingCoord=XO.empty(),this.lastStartingCoord=XO.empty(),this.lastFirstCapture=XO.empty(),this.lastSecondCapture=XO.empty(),this.highCapture=XO.empty(),this.chosenStartingCoord=XO.empty(),this.chosenLandingCoord=XO.empty(),this.chosenFirstCapture=XO.empty(),this.lastMove=XO.empty(),this.remainingPieces={0:15,1:15},this.rules=new QR(WR),this.availableMinimaxes=[new YR(this.rules,"PylosMinimax"),new KR(this.rules,"PylosOrderedMinimax")],this.encoder=qR.encoder,this.tutorial=(new tD).tutorial,this.SPACE_SIZE=this.getPieceRadius(0),this.updateBoard()}getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return $O.expectToBe(e,2),[0,1]}}isDrawable(e,t,n){const r=new $R(e,t,n);return this.state.getPieceAt(r)!==CS.NONE||this.state.isLandable(r)}onPieceClick(e,t,n){var r=this;return GO(function*(){const i=r.canUserPlay("#piece_"+e+"_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());const o=new $R(e,t,n);return r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):r.chosenLandingCoord.isAbsent()?(r.chosenStartingCoord=XO.of(o),aS.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=XO.of(o),aS.SUCCESS):r.chosenFirstCapture.equalsValue(o)?r.concludeMoveWithCapture([r.chosenFirstCapture.get()]):r.concludeMoveWithCapture([r.chosenFirstCapture.get(),o])})()}concludeMoveWithCapture(e){var t=this;return GO(function*(){let n;return n=t.chosenStartingCoord.isAbsent()?qR.fromDrop(t.chosenLandingCoord.get(),e):qR.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(n,t.state)})()}tryMove(e,t){var n=this;return GO(function*(){return n.cancelMove(),n.chooseMove(e,t)})()}cancelMoveAttempt(){this.chosenStartingCoord=XO.empty(),this.chosenLandingCoord=XO.empty(),this.chosenFirstCapture=XO.empty()}onDrop(e,t,n){var r=this;return GO(function*(){const i=r.canUserPlay("#drop_"+e+"_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());const o=new $R(e,t,n);return QR.canCapture(r.state,o)?(r.chosenLandingCoord=XO.of(o),aS.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=XO.of(o),r.concludeMoveWithCapture([])):r.cancelMove(ZR.MUST_MOVE_UPWARD())})()}isCapturelessMoveFinished(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}getSquareClasses(e,t,n){const r=new $R(e,t,n);if(this.lastMove.isPresent()){const e=this.lastMove.get();if(e.firstCapture.equalsValue(r)||e.secondCapture.equalsValue(r))return["captured"];if(r.equals(e.landingCoord)||e.startingCoord.equalsValue(r))return["moved"]}return[]}getPieceRadius(e){return 90+5*e}getPieceCx(e,t,n){return 100+100*n+200*e}getPieceCy(e,t,n){return 100+100*n+200*t}isOccupied(e,t,n){const r=new $R(e,t,n),i=this.rules.node.gameState.getPieceAt(r)!==CS.NONE,o=this.chosenLandingCoord.equalsValue(r);return i||o}getPieceClasses(e,t,n){const r=new $R(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}getPlayerPieceClass(e){return this.getPlayerClass(CS.of(e))}getPlayerSidePieces(e){const t=this.remainingPieces[e],n=[];for(let r=0;r<t;r++)n.push(r);return n}updateBoard(){this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=XO.empty(),this.lastMove.isPresent()?this.showLastMove():(this.lastLandingCoord=XO.empty(),this.lastStartingCoord=XO.empty(),this.lastFirstCapture=XO.empty(),this.lastSecondCapture=XO.empty(),this.chosenFirstCapture=XO.empty(),this.chosenStartingCoord=XO.empty(),this.chosenLandingCoord=XO.empty())}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=XO.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.isDrawableCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}isDrawableCoord(e){return this.isDrawable(e.x,e.y,e.z)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-pylos"]],features:[r.yb],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,rD,2,1,"g",1),r.Mb(2,"rect",2),r.Ac(3,lD,2,1,"g",1),r.Ac(4,uD,1,7,"rect",3),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",r.qc(3,hD)),r.Bb(2),r.mc("ngForOf",r.qc(4,dD)),r.Bb(1),r.mc("ngIf",t.highCapture.isPresent()))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),pD=(()=>{class e{constructor(e){this.value=e}static fromInt(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.NONE;throw new Error("Invalid piece ("+t+")")}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}return e.AAAA=new e(0),e.AAAB=new e(1),e.AABA=new e(2),e.AABB=new e(3),e.ABAA=new e(4),e.ABAB=new e(5),e.ABBA=new e(6),e.ABBB=new e(7),e.BAAA=new e(8),e.BAAB=new e(9),e.BABA=new e(10),e.BABB=new e(11),e.BBAA=new e(12),e.BBAB=new e(13),e.BBBA=new e(14),e.BBBB=new e(15),e.NONE=new e(16),e.pieces=[e.AAAA,e.AAAB,e.AABA,e.AABB,e.ABAA,e.ABAB,e.ABBA,e.ABBB,e.BAAA,e.BAAB,e.BABA,e.BABB,e.BBAA,e.BBAB,e.BBBA,e.BBBB],e})(),gD=(()=>{class e extends GI{constructor(e,t,n){super(e,t),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}return e.encoder=new class extends YO{maxValue(){return 496}encodeNumber(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}decodeNumber(t){const n=t%32;t-=n;const r=(t/=32)%4;return t-=r,new e(t/=4,r,pD.fromInt(n))}},e})();class mD extends VI{constructor(e,t,n){super(e,t),this.pieceInHand=n}static getInitialState(){const e=cS.createTable(4,4,pD.NONE);return new mD(e,0,pD.AAAA)}static isGivable(e,t,n){return e!==n&&!1===mD.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}getRemainingPieces(){const e=pD.pieces,t=[];for(const n of e)mD.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}let yD=(()=>{class e{}return e.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,e.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,e.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,e})();class vD{constructor(e){this.subCriterion=[XO.empty(),XO.empty(),XO.empty(),XO.empty()],this.subCriterion[0]=XO.of(8==(8&e.value)),this.subCriterion[1]=XO.of(4==(4&e.value)),this.subCriterion[2]=XO.of(2==(2&e.value)),this.subCriterion[3]=XO.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=XO.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new vD(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new vD(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class bD{constructor(e,t){this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}let _D=(()=>{class e extends JI{static isOccupied(e){return e!==pD.NONE}static isLegal(t,n){const r=t.coord.x,i=t.coord.y,o=t.piece,s=n.getCopiedBoard(),a=n.pieceInHand;return e.isOccupied(s[i][r])?aS.failure(DI.MUST_LAND_ON_EMPTY_SPACE()):o===pD.NONE?15===n.turn?aS.SUCCESS:aS.failure(yD.MUST_GIVE_A_PIECE()):mD.isAlreadyOnBoard(o,s)?aS.failure(yD.PIECE_ALREADY_ON_BOARD()):a===o?aS.failure(yD.CANNOT_GIVE_PIECE_IN_HAND()):aS.SUCCESS}isLegal(t,n){return e.isLegal(t,n).toFallible(void 0)}applyLegalMove(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new mD(n,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===qI.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:qI.VICTORY,sensitiveSquares:new jI}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(t,n){let r=t.initialCoord,i=n.getPieceAt(r);const o=new vD(i);for(let s=0;s<3&&!1!==e.isOccupied(i)&&!o.areAllAbsent();s++)r=r.getNext(t.direction,1),i=n.getPieceAt(r),o.mergeWithQuartoPiece(i);return!(!e.isOccupied(i)||o.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,n,r){const i=e.getLineInfos(t,n,r);if(i.boardStatus.isPresent())return i.boardStatus.get();const o=i.commonCriterion,s=i.sensitiveCoord;if(o.isPresent()&&!1===o.get().areAllAbsent()){if(s.isAbsent())return{score:qI.VICTORY,sensitiveSquares:new jI};{o.get().matchPiece(n.pieceInHand)&&(r.score=qI.PRE_VICTORY);const e=s.get();r.sensitiveSquares.add(e)}}return r}static getLineInfos(t,n,r){let i=XO.empty(),o=XO.empty(),s=t.initialCoord;for(let a=0;a<4;a++){const a=n.getPieceAt(s);if(a===pD.NONE){if(!i.isAbsent())return{sensitiveCoord:XO.of(s),commonCriterion:o,boardStatus:XO.of(r)};i=XO.of(s)}else o.isAbsent()?(o=XO.of(new vD(a)),qO(e.VERBOSE,"set commonCrit to "+o.toString())):(o.get().mergeWithQuartoPiece(a),qO(e.VERBOSE,"update commonCrit: "+o.toString()));s=s.getNext(t.direction,1)}return{commonCriterion:o,sensitiveCoord:i,boardStatus:XO.empty()}}static scoreToGameStatus(e,t){const n=CS.of(t%2);return e===qI.VICTORY?KI.getDefeat(n):16===t?KI.DRAW:KI.ONGOING}getGameStatus(t){const n=t.gameState;let r={score:qI.DEFAULT,sensitiveSquares:new jI};for(const i of e.lines)if(r=e.updateBoardStatus(i,n,r),r.score===qI.VICTORY)return e.scoreToGameStatus(r.score,n.turn);return e.scoreToGameStatus(r.score,n.turn)}getVictoriousCoords(t){for(const n of e.lines)if(e.isThereAVictoriousLine(n,t))return n.allCoords();return[]}}return e.VERBOSE=!1,e.lines=[new bD(new CI(0,0),bI.DOWN),new bD(new CI(1,0),bI.DOWN),new bD(new CI(2,0),bI.DOWN),new bD(new CI(3,0),bI.DOWN),new bD(new CI(0,0),bI.RIGHT),new bD(new CI(0,1),bI.RIGHT),new bD(new CI(0,2),bI.RIGHT),new bD(new CI(0,3),bI.RIGHT),new bD(new CI(0,0),bI.DOWN_RIGHT),new bD(new CI(0,3),bI.UP_RIGHT)],e})();class wD extends LI{static scoreToBoardValue(e,t){if(e===qI.DEFAULT)return new BI(0);{const n=CS.of(t%2);return new BI(e===qI.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}getListMoves(e){const t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),o=n.pieceInHand;let s;for(let a=0;a<4;a++)for(let e=0;e<4;e++)if(r[a][e]===pD.NONE){if(s=n.getCopiedBoard(),s[a][e]=o,15===n.turn){const n=new gD(e,a,pD.NONE);return t.push(n),t}for(const n of i){const r=new gD(e,a,n);t.push(r)}}return t}getBoardValue(e){const t=e.gameState;let n={score:qI.DEFAULT,sensitiveSquares:new jI};for(const r of _D.lines)if(n=_D.updateBoardStatus(r,t,n),n.score===qI.VICTORY)break;return wD.scoreToBoardValue(n.score,t.turn)}}const CD=pD.AABA,ED=pD.AABB,OD=pD.ABAA,SD=pD.ABAB,PD=pD.ABBA,ID=pD.BAAA,TD=pD.BAAB,AD=pD.BABB,kD=pD.BBAA,ND=pD.BBAB,MD=pD.BBBA,xD=pD.BBBB,RD=pD.NONE;class DD{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.`,new mD([[MD,kD,OD,CD],[RD,RD,RD,RD],[RD,RD,RD,RD],[RD,RD,RD,RD]],7,pD.ABAB)),nT.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new mD([[MD,ED,PD,RD],[RD,RD,RD,RD],[RD,ID,RD,RD],[RD,RD,RD,RD]],7,pD.ABAA),new gD(2,2,pD.BAAB),$localize`Perfect!`),nT.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new mD([[xD,MD,ND,RD],[OD,AD,kD,RD],[SD,ID,TD,RD],[RD,RD,RD,RD]],7,pD.AABA),[new gD(3,3,pD.AABB)],$localize`Well done!`,$localize`Failed!`)]}}function LD(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",11)),2&e){const e=r.fc(2),t=e.$implicit,n=e.index,i=r.fc().index,o=r.fc();r.mc("ngClass",o.getPieceClasses(t.value)),r.Cb("x",o.SPACE_SIZE*n+(o.SPACE_SIZE/2-o.getPieceSize(t.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(t.value)))("width",2*o.getPieceSize(t.value))("height",2*o.getPieceSize(t.value))}}function BD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=r.fc(2),t=e.$implicit,n=e.index,i=r.fc().index,o=r.fc();r.mc("ngClass",o.getPieceClasses(t.value)),r.Cb("cx",o.SPACE_SIZE*n+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(t.value))}}function FD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle")),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",10)}}function jD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,LD,1,5,"rect",9),r.Ac(2,BD,1,4,"ng-template",null,10,r.Bc),r.Ac(4,FD,1,3,"circle",3),r.Pb()),2&e){const e=r.vc(3),t=r.fc().$implicit,n=r.fc(2);r.Bb(1),r.mc("ngIf",t.isRectangle())("ngIfElse",e),r.Bb(3),r.mc("ngIf",n.pieceHasDot(t.value))}}function UD(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",8),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().chooseCoord(n,i)}),r.Pb(),r.Ac(2,jD,5,3,"g",3),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","chooseCoord_",n,"_",i,""),r.mc("ngClass",o.getSquareClasses(n,i)),r.Cb("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),r.Bb(1),r.mc("ngIf",e!==o.EMPTY)}}function VD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",null,7),r.Ac(2,UD,3,8,"g",2),r.Pb()),2&e){const e=t.$implicit;r.Bb(2),r.mc("ngForOf",e)}}function zD(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",15)),2&e){const e=r.fc(2);r.mc("ngClass",e.getPieceClasses(e.pieceInHand.value)),r.Cb("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function HD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=r.fc(2);r.mc("ngClass",e.getPieceClasses(e.pieceInHand.value)),r.Cb("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function GD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle")),2&e){const e=r.fc(2);r.Cb("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function $D(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",null,12),r.Mb(2,"rect",13),r.Ac(3,zD,1,5,"rect",14),r.Ac(4,HD,1,4,"ng-template",null,10,r.Bc),r.Ac(6,GD,1,3,"circle",3),r.Pb()),2&e){const e=r.vc(5),t=r.fc();r.Cb("transform","translate("+t.chosen.get().x*t.SPACE_SIZE+" "+t.chosen.get().y*t.SPACE_SIZE+")"),r.Bb(2),r.Cb("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),r.Bb(1),r.mc("ngIf",t.pieceInHand.isRectangle())("ngIfElse",e),r.Bb(3),r.mc("ngIf",t.pieceHasDot(t.pieceInHand.value))}}function qD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",null,16),r.Mb(2,"rect",17),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(2),r.Cb("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+e.x*n.SPACE_SIZE+" "+e.y*n.SPACE_SIZE+")")}}function WD(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",11)),2&e){const e=r.fc(2);r.mc("ngClass",e.getPieceClasses(e.pieceInHand.value)),r.Cb("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function ZD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",19)),2&e){const e=r.fc(2);r.mc("ngClass",e.getPieceClasses(e.pieceInHand.value)),r.Cb("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function QD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",20)),2&e){const e=r.fc(2);r.Cb("cy",.75*e.SPACE_SIZE)("r",10)}}function YD(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,WD,1,6,"rect",9),r.Ac(2,ZD,1,3,"ng-template",null,10,r.Bc),r.Ac(4,QD,1,2,"circle",18),r.Pb()),2&e){const e=r.vc(3),t=r.fc();r.Bb(1),r.mc("ngIf",t.pieceInHand.isRectangle())("ngIfElse",e),r.Bb(3),r.mc("ngIf",t.pieceHasDot(t.pieceInHand.value))}}function KD(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",27)),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("x",n.SPACE_SIZE*e)("y",n.SPACE_SIZE*t)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function JD(e,t){if(1&e&&(r.ec(),r.Mb(0,"rect",11)),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getPieceClasses(4*t+e)),r.Cb("x",n.SPACE_SIZE*e+n.SPACE_SIZE/2-n.getPieceSize(4*t+e))("y",n.SPACE_SIZE*t+n.SPACE_SIZE/2-n.getPieceSize(4*t+e))("width",2*n.getPieceSize(4*t+e))("height",2*n.getPieceSize(4*t+e))}}function XD(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getPieceClasses(4*t+e)),r.Cb("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",n.getPieceSize(4*t+e))}}function eL(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle")),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",10)}}function tL(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",25),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().choosePiece(4*n+t)}),r.Ac(1,KD,1,4,"rect",26),r.Ac(2,JD,1,5,"rect",9),r.Ac(3,XD,1,4,"ng-template",null,10,r.Bc),r.Ac(5,eL,1,3,"circle",3),r.Pb()}if(2&e){const e=r.vc(4),t=r.fc().index,n=r.fc().index,i=r.fc();r.nc("id","choosePiece_",4*n+t,""),r.Bb(1),r.mc("ngIf",i.pieceToGive.value===4*n+t),r.Bb(1),r.mc("ngIf",(4*n+t)%4<2)("ngIfElse",e),r.Bb(3),r.mc("ngIf",i.pieceHasDot(4*n+t))}}function nL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,tL,6,5,"g",24),r.Pb()),2&e){const e=t.index,n=r.fc().index,i=r.fc();r.Bb(1),r.mc("ngIf",i.isRemaining(4*n+e))}}function rL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",null,21),r.Mb(2,"rect",22,23),r.Ac(4,nL,2,1,"g",2),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Cb("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),r.Bb(2),r.Cb("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),r.Bb(2),r.mc("ngForOf",e)}}let iL=(()=>{class e extends BT{constructor(e){super(e),this.EMPTY=pD.NONE,this.chosen=XO.empty(),this.lastMove=XO.empty(),this.pieceInHand=pD.NONE,this.pieceToGive=pD.NONE,this.victoriousCoords=[],this.rules=new _D(mD),this.availableMinimaxes=[new wD(this.rules,"QuartoMinimax")],this.encoder=gD.encoder,this.tutorial=(new DD).tutorial,this.pieceInHand=this.rules.node.gameState.pieceInHand,this.updateBoard()}updateBoard(){const e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=XO.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(e=>e.coord)}chooseCoord(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#chooseCoord_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(n.hideLastMove(),n.board[t][e]===pD.NONE){if(n.showPieceInHandOnBoard(e,t),15===n.rules.node.gameState.turn){const r=new gD(e,t,pD.NONE);return n.chooseMove(r,n.rules.node.gameState)}if(n.pieceToGive===pD.NONE)return aS.SUCCESS;{const r=new gD(e,t,n.pieceToGive);return n.chooseMove(r,n.rules.node.gameState)}}return n.cancelMove(DI.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var t=this;return GO(function*(){const n=t.canUserPlay("#choosePiece_"+e);if(n.isFailure())return t.cancelMove(n.getReason());if(t.hideLastMove(),t.pieceToGive=pD.fromInt(e),t.chosen.isAbsent())return aS.SUCCESS;{const e=t.chosen.get(),n=new gD(e.x,e.y,t.pieceToGive);return t.chooseMove(n,t.rules.node.gameState)}})()}hideLastMove(){this.lastMove=XO.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=pD.NONE}showPieceInHandOnBoard(e,t){this.chosen=XO.of(new CI(e,t))}isRemaining(e){return mD.isGivable(pD.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,t){const n=new CI(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}getPieceClasses(e){const t=[];return t.push(e%2==0?"player0":"player1"),t}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==pD.NONE.value&&e%8<4}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-quarto"]],features:[r.yb],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"g",1),r.Ac(2,VD,3,1,"g",2),r.Ac(3,$D,7,6,"g",3),r.Ac(4,qD,3,3,"g",2),r.Qb(5,"g",null,4),r.Mb(7,"rect",5,6),r.Ac(9,YD,5,3,"g",3),r.Pb(),r.Ac(10,rL,5,6,"g",2),r.Pb(),r.Pb()),2&e&&(r.Cb("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),r.Bb(2),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngIf",t.chosen.isPresent()),r.Bb(1),r.mc("ngForOf",t.victoriousCoords),r.Bb(1),r.Cb("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),r.Bb(2),r.Cb("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),r.Bb(2),r.mc("ngIf",t.chosen.isAbsent()),r.Bb(1),r.mc("ngForOf",t.board))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),oL=(()=>{class e{}return e.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,e})(),sL=(()=>{class e extends GI{constructor(t,n,r){super(t,n),this.direction=r;const i=e.isValidCoord(this.coord);if(i.isFailure())throw new Error(i.getReason());if(0===t&&r===wI.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===wI.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===n&&r===wI.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===n&&r===wI.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isValidCoord(e){return e.isNotInRange(5,5)?aS.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?aS.failure(oL.NO_INSIDE_CLICK()):aS.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}return e.encoder=new class extends YO{maxValue(){return 128}encodeNumber(e){const t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}decodeNumber(t){const n=wI.factory.fromInt(t%4).get();t-=t%4;const r=(t/=4)%5;return t-=t%5,new e(t/=5,r,n)}},e})();class aL extends VI{static getInitialState(){const e=cS.createTable(5,5,CS.NONE);return new aL(e,0)}applyLegalMove(e){const t=this.getCopiedBoard(),n=this.turn+1;let r=e.coord,i=e.coord.getNext(e.direction);for(;i.isInRange(5,5);)t[r.y][r.x]=t[i.y][i.x],r=r.getNext(e.direction),i=i.getNext(e.direction);return t[r.y][r.x]=this.getCurrentPlayer(),new aL(t,n)}}class cL extends JI{static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new CI(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new CI(4,r));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new CI(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new CI(r,4));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(wI.LEFT),0!==e.y&&t.push(wI.UP),4!==e.x&&t.push(wI.RIGHT),4!==e.y&&t.push(wI.DOWN),t}static getLinesSums(e){const t={};t[CS.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[CS.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let n=0;n<5;n++)for(let r=0;r<5;r++){const i=e.getPieceAtXY(r,n).value;i!==CS.NONE.value&&(t[i].columns[r]=t[i].columns[r]+1,t[i].rows[n]=t[i].rows[n]+1,r===n&&(t[i].diagonals[0]=t[i].diagonals[0]+1),r+n===4&&(t[i].diagonals[1]=t[i].diagonals[1]+1))}return t}static getVictoriousCoords(e){const t=cL.getLinesSums(e),n=[];for(let r=0;r<2;r++){for(let e=0;e<5;e++){if(5===t[r].columns[e])for(let t=0;t<5;t++)n.push(new CI(e,t));if(5===t[r].rows[e])for(let t=0;t<5;t++)n.push(new CI(t,e))}if(5===t[r].diagonals[0])for(let e=0;e<5;e++)n.push(new CI(e,e));if(5===t[r].diagonals[1])for(let e=0;e<5;e++)n.push(new CI(e,4-e))}return n}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return cL.applyLegalMove(e,t,n)}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?iS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):iS.success(void 0)}getGameStatus(e){const t=e.gameState,n=cL.getLinesSums(t),r=cL.getFullestLine(n[CS.ZERO.value]),i=cL.getFullestLine(n[CS.ONE.value]),o=t.getCurrentPlayer();return 5===r&&(o===CS.ZERO||i<5)?KI.ZERO_WON:5===i?KI.ONE_WON:KI.ONGOING}}class lL extends LI{getListMoves(e){const t=[],n=cL.getVerticalCoords(e),r=cL.getHorizontalCenterCoords(e).concat(n);for(const i of r){const e=cL.getPossibleDirections(i);for(const n of e){const e=new sL(i.x,i.y,n);t.push(e)}}return t}getBoardValue(e){const t=e.gameState,n=cL.getLinesSums(t),r=cL.getFullestLine(n[CS.ZERO.value]),i=cL.getFullestLine(n[CS.ONE.value]),o=t.getCurrentPlayer();return new BI(5===r&&(o===CS.ZERO||i<5)?CS.ZERO.getVictoryValue():5===i?CS.ONE.getVictoryValue():i-r)}}class uL{static getArrowTransform(e,t,n){let r,i,o;switch(n){case wI.UP:r=0,i=-1,o=-90;break;case wI.DOWN:r=0,i=1,o=90;break;case wI.LEFT:r=-1,i=0,o=180;break;default:$O.expectToBe(n,wI.RIGHT),r=1,i=0,o=0}return[`translate(${t.x*e+e/2+r*e/4} ${t.y*e+e/2+i*e/4})`,"scale(2.5)",`rotate(${o})`].join(" ")}}const hL=CS.NONE,dL=CS.ZERO,fL=CS.ONE;class pL{constructor(){this.tutorial=[nT.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,aL.getInitialState()),nT.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new aL([[hL,hL,hL,hL,hL],[hL,hL,hL,hL,hL],[hL,hL,hL,hL,hL],[hL,hL,hL,hL,hL],[dL,dL,dL,dL,hL]],1),[new sL(4,4,wI.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed!`),nT.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new aL([[hL,fL,hL,fL,fL],[hL,dL,dL,hL,dL],[fL,fL,fL,dL,fL],[dL,hL,dL,fL,fL],[fL,dL,hL,fL,dL]],31),[new sL(3,0,wI.DOWN)],$localize`Congratulations, you won!`,$localize`Failed!`)]}}function gL(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",4),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onBoardClick(n,i)}),r.Pb(),r.Pb()}if(2&e){const e=t.index,n=r.fc().index,i=r.fc();r.Bb(1),r.oc("id","click_",e,"_",n,""),r.mc("ngClass",i.getPieceClasses(e,n)),r.Cb("cx",50+100*e)("cy",50+100*n)}}function mL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,gL,2,5,"g",2),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function yL(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"use",6),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).chooseDirection(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(2);r.nc("id","chooseDirection_",e,""),r.Cb("transform",n.getArrowTransform(n.chosenCoord.get(),e))}}function vL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,yL,1,2,"use",5),r.Pb()),2&e){const e=r.fc();r.Bb(1),r.mc("ngForOf",e.getPossiblesDirections())}}let bL=(()=>{class e extends BT{constructor(e){super(e),this.lastMoveCoord=XO.empty(),this.chosenCoord=XO.empty(),this.victoriousCoords=[],this.rules=new cL(aL),this.availableMinimaxes=[new lL(this.rules,"QuixoMinimax")],this.encoder=sL.encoder,this.tutorial=(new pL).tutorial,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=cL.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=XO.empty()}getPieceClasses(e,t){const n=new CI(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(e=>e.equals(n))&&r.push("victory-stroke"),r}onBoardClick(e,t){const n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());const r=new CI(e,t),i=sL.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=XO.of(r),aS.SUCCESS)}getPossiblesDirections(){const e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}chooseDirection(e){var t=this;return GO(function*(){const n=t.canUserPlay("#chooseDirection_"+e);return n.isFailure()?t.cancelMove(n.getReason()):(t.chosenDirection=wI.factory.fromString(e).get(),yield t.tryMove())})()}tryMove(){var e=this;return GO(function*(){const t=e.chosenCoord.get(),n=new sL(t.x,t.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(n,e.rules.node.gameState)})()}getArrowTransform(e,t){return uL.getArrowTransform(this.SPACE_SIZE,e,wI.factory.fromString(t).get())}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-quixo"]],features:[r.yb],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"defs"),r.Mb(2,"polygon",1),r.Pb(),r.Ac(3,mL,2,1,"g",2),r.Ac(4,vL,2,1,"g",3),r.Pb()),2&e&&(r.Bb(3),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngIf",t.chosenCoord.isPresent()))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),_L=(()=>{class e extends VI{static getInitialState(){const t=cS.createTable(e.BOARD_WIDTH,e.BOARD_HEIGHT,CS.NONE);return t[3][3]=CS.ZERO,t[4][4]=CS.ZERO,t[3][4]=CS.ONE,t[4][3]=CS.ONE,new e(t,0)}static getNeighbooringPawnLike(e,t,n,r){let i;const o=[];for(let s=-1;s<2;s++)for(let a=-1;a<2;a++)i=new CI(n+a,r+s),i.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&o.push(i);return o}countScore(){const t=[0,0];for(let n=0;n<e.BOARD_HEIGHT;n++)for(let r=0;r<e.BOARD_WIDTH;r++){const e=this.board[n][r];e!==CS.NONE&&(t[e.value]+=1)}return t}}return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e})(),wL=(()=>{class e extends GI{equals(e){return e===this||e.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}return e.encoder=new class extends YO{maxValue(){return(_L.BOARD_HEIGHT-1)*_L.BOARD_WIDTH+(_L.BOARD_WIDTH-1)}encodeNumber(e){return e.coord.y*_L.BOARD_WIDTH+e.coord.x}decodeNumber(t){const n=t%_L.BOARD_WIDTH;return new e(n,(t-n)/_L.BOARD_WIDTH)}},e.PASS=new e(-1,-1),e.PASS_NUMBER=e.encoder.encodeNumber(e.PASS),e})(),CL=(()=>{class e{}return e.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,e})();class EL{constructor(e,t){this.move=e,this.switched=t}}let OL=(()=>{class e extends JI{static getGameStatus(t){const n=t.gameState;if(!1===e.isGameEnded(n))return KI.ONGOING;const r=n.countScore(),i=r[1]-r[0];return i<0?KI.ZERO_WON:i>0?KI.ONE_WON:KI.DRAW}applyLegalMove(e,t,n){const r=t.turn,i=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(wL.PASS))return new _L(o,r+1);for(const s of n)o[s.y][s.x]=i;return o[e.coord.y][e.coord.x]=i,new _L(o,r+1)}static getAllSwitcheds(t,n,r){const i=[],o=n.getOpponent();for(const s of bI.DIRECTIONS){const a=t.coord.getNext(s);if(a.isInRange(_L.BOARD_WIDTH,_L.BOARD_HEIGHT)&&r[a.y][a.x]===o){const t=e.getSandwicheds(n,s,a,r);for(const e of t)i.push(e)}}return i}static getSandwicheds(e,t,n,r){const i=[n];let o=n.getNext(t);for(;o.isInRange(_L.BOARD_WIDTH,_L.BOARD_HEIGHT);){const n=r[o.y][o.x];if(n===e)return i;if(n===CS.NONE)return[];i.push(o),o=o.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(t){return e.getGameStatus(t)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(wL.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),n=new _L(t,e.turn+1);return this.playerCanOnlyPass(n)}static getListMoves(t){const n=[];let r;const i=t.getCurrentPlayer(),o=t.getCurrentOpponent();for(let s=0;s<8;s++)for(let a=0;a<8;a++)if(t.getPieceAtXY(a,s)===CS.NONE&&(r=t.getCopiedBoard(),_L.getNeighbooringPawnLike(r,o,a,s).length>0)){const o=new wL(a,s),c=e.getAllSwitcheds(o,i,r);if(c.length>0){for(const e of c)WO(i!==t.getPieceAt(e),e+"was already switched!"),r[e.y][e.x]=i;r[s][a]=i,n.push(new EL(o,c.length))}}return 0===n.length&&n.push(new EL(wL.PASS,0)),n}isLegal(t,n){const r=n.getCopiedBoard();if(t.equals(wL.PASS))return e.playerCanOnlyPass(n)?iS.success([]):iS.failure(DI.MUST_PASS());if(r[t.coord.y][t.coord.x]!==CS.NONE)return qO(e.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),iS.failure(DI.MUST_CLICK_ON_EMPTY_SPACE());const i=e.getAllSwitcheds(t,n.getCurrentPlayer(),r);return qO(e.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?iS.failure(CL.NO_ELEMENT_SWITCHED()):iS.success(i)}}return e.VERBOSE=!1,e})(),SL=(()=>{class e extends LI{getBoardValue(e){const t=OL.getGameStatus(e);if(t.isEndGame)return BI.fromWinner(t.winner);const n=e.gameState.getCopiedBoard();let r=0,i=0;for(let o=0;o<_L.BOARD_HEIGHT;o++)for(let e=0;e<_L.BOARD_WIDTH;e++){const t=(0===e||e===_L.BOARD_WIDTH-1?4:1)*(0===o||o===_L.BOARD_HEIGHT-1?4:1);n[o][e]===CS.ZERO&&(r+=t),n[o][e]===CS.ONE&&(i+=t)}return r*=CS.ZERO.getScoreModifier(),i*=CS.ONE.getScoreModifier(),new BI(i+r)}getListMoves(t){const n=OL.getListMoves(t.gameState);return cS.sortByDescending(n,t=>e.bestCoords.some(e=>t.move.coord.equals(e))?100:t.switched),n.map(e=>e.move)}}return e.bestCoords=[new CI(0,0),new CI(0,_L.BOARD_HEIGHT-1),new CI(_L.BOARD_WIDTH-1,0),new CI(_L.BOARD_WIDTH-1,_L.BOARD_HEIGHT-1)],e})();const PL=CS.NONE,IL=CS.ZERO,TL=CS.ONE;class AL{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new _L([[IL,IL,IL,IL,IL,IL,IL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,IL,IL,IL,IL,IL,IL,IL]],60)),nT.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,_L.getInitialState(),new wL(2,4),$localize`Congratulations!`),nT.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one lines at a time
        You're playing light here.<br/><br/>
        Play on the bottom left to see an example.`,new _L([[PL,PL,PL,PL,PL,PL,PL,PL],[PL,PL,PL,PL,PL,PL,PL,PL],[PL,PL,PL,PL,PL,PL,PL,PL],[PL,PL,PL,PL,TL,PL,PL,PL],[PL,PL,PL,IL,PL,PL,PL,PL],[PL,PL,IL,PL,PL,PL,PL,PL],[IL,IL,PL,PL,PL,PL,PL,PL],[PL,IL,TL,IL,TL,IL,PL,PL]],1),[new wL(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),nT.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new _L([[TL,IL,IL,IL,IL,IL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[IL,TL,TL,TL,TL,TL,TL,IL],[TL,TL,TL,TL,TL,TL,PL,PL],[IL,IL,IL,IL,IL,IL,PL,PL]],60))]}}function kL(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",4)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.mc("ngClass",n.getPieceClass(e,t)),r.Cb("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)}}function NL(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",2),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Pb(),r.Ac(2,kL,1,4,"circle",3),r.Pb()}if(2&e){const e=t.index,n=r.fc().index,i=r.fc();r.Bb(1),r.oc("id","click_",e,"_",n,""),r.mc("ngClass",i.getRectClasses(e,n)),r.Cb("x",i.SPACE_SIZE*e)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),r.Bb(1),r.mc("ngIf",i.board[n][e]!==i.NONE)}}function ML(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,NL,3,8,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}let xL=(()=>{class e extends BT{constructor(e){super(e),this.NONE=CS.NONE,this.lastMove=new CI(-2,-2),this.captureds=[],this.scores=XO.of([2,2]),this.rules=new OL(_L),this.availableMinimaxes=[new SL(this.rules,"ReversiMinimax")],this.encoder=wL.encoder,this.tutorial=(new AL).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new wL(e,t);return yield n.chooseMove(i,n.rules.node.gameState,n.scores.get())})()}updateBoard(){const e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new CI(-2,-2),this.scores=XO.of(e.countScore()),this.canPass=OL.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.rules.node.gameState.getCurrentPlayer(),t=this.rules.node.gameState.getCurrentOpponent();for(const n of bI.DIRECTIONS){let r=this.lastMove.getNext(n,1);for(;r.isInRange(_L.BOARD_WIDTH,_L.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(r)===t&&this.rules.node.mother.get().gameState.getPieceAt(r)===e;)this.captureds.push(r),r=r.getNext(n,1)}}getRectClasses(e,t){const n=new CI(e,t);return this.captureds.some(e=>e.equals(n))?["captured"]:n.equals(this.lastMove)?["moved"]:[]}getPieceClass(e,t){return this.getPlayerClass(this.board[t][e])}pass(){var e=this;return GO(function*(){return WO(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(wL.PASS.coord.x,wL.PASS.coord.y)})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-reversi"]],features:[r.yb],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,ML,2,1,"g",1),r.Pb()),2&e&&(r.Cb("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),r.Bb(1),r.mc("ngForOf",t.board))},directives:[he,le,fe],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),RL=(()=>{class e extends DA{static getInitialState(){const t=TI.NONE,n=TI.ZERO,r=TI.ONE,i=TI.EMPTY;return new e([[t,t,n,r,i,i,i,n,r,t,t],[t,i,i,i,i,i,i,i,i,i,t],[r,i,i,i,i,i,i,i,i,i,n],[n,i,i,i,i,i,i,i,i,i,r],[t,i,i,i,i,i,i,i,i,i,t],[t,t,r,n,i,i,i,r,n,t,t]],0)}}return e.HEIGHT=6,e.WIDTH=11,e})(),DL=(()=>{class e{}return e.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,e.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,e.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,e})(),LL=(()=>{class e extends ZT{constructor(e,t){super(e,t)}static checkDistanceAndLocation(e,t){const n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return aS.failure(DI.MOVE_CANNOT_BE_STATIC());if(1===n){const n=RA.getFakeNeighbors(e);if(t.equals(n))return aS.failure(DL.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return aS.failure($localize`You can move one or two spaces, not ${n}.`);if((e.x+e.y)%2==0)return aS.failure(DL.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return aS.failure(DL.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return aS.SUCCESS}static from(t,n){if(!t.isInRange(RL.WIDTH,RL.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!n.isInRange(RL.WIDTH,RL.HEIGHT))throw new Error("Move must end inside the board not at "+n.toString()+".");const r=e.checkDistanceAndLocation(t,n);return r.isFailure()?r.toFailedFallible():iS.success(new e(t,n))}isSimpleStep(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"SaharaMove("+this.coord+"->"+this.end+")"}}return e.encoder=new class extends YO{maxValue(){return 396*RL.WIDTH+66*RL.HEIGHT+6*RL.WIDTH+RL.HEIGHT}encodeNumber(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}decodeNumber(t){const n=t%6;t-=n;const r=(t/=6)%11;t-=r;const i=(t/=11)%6;return t-=i,e.from(new CI(t/=6,i),new CI(r,n)).get()}},e})(),BL=(()=>{class e extends JI{static getStartingCoords(e,t){const n=[];for(let r=0;r<RL.HEIGHT;r++)for(let i=0;i<RL.WIDTH;i++)e[r][i].is(t)&&n.push(new CI(i,r));return n}static getBoardValuesFor(t,n){const r=e.getStartingCoords(t,n),i=[];for(const e of r){const n=DA.getEmptyNeighbors(t,e,TI.EMPTY).length;if(0===n)return[0];i.push(n)}return i.sort((e,t)=>e-t)}applyLegalMove(t,n,r){qO(e.VERBOSE,"Legal move "+t.toString()+" applied");const i=n.getCopiedBoard();return i[t.end.y][t.end.x]=i[t.coord.y][t.coord.x],i[t.coord.y][t.coord.x]=TI.EMPTY,new RL(i,n.turn+1)}isLegal(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return iS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==TI.EMPTY)return iS.failure(DI.MUST_LAND_ON_EMPTY_SPACE());const n=RA.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===TI.EMPTY?iS.success(void 0):iS.failure(DL.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):iS.success(void 0)}getGameStatus(t){const n=t.gameState.getCopiedBoard(),r=e.getBoardValuesFor(n,CS.ZERO),i=e.getBoardValuesFor(n,CS.ONE);return e.getGameStatusFromFreedoms(r,i)}static getGameStatusFromFreedoms(e,t){return 0===e[0]?KI.ONE_WON:0===t[0]?KI.ZERO_WON:KI.ONGOING}}return e.VERBOSE=!1,e})();class FL extends LI{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),r=e.gameState.getCurrentPlayer(),i=BL.getStartingCoords(n,r);for(const o of i){const e=DA.getEmptyNeighbors(n,o,TI.EMPTY);for(const r of e){const e=LL.from(o,r).get();if(n[r.y][r.x]=n[o.y][o.x],n[o.y][o.x]=TI.EMPTY,t.push(e),(r.y+r.x)%2==0){const e=DA.getEmptyNeighbors(n,r,TI.EMPTY);for(const i of e)if(!i.equals(o)){const e=LL.from(o,i).get();n[i.y][i.x]=n[r.y][r.x],n[r.y][r.x]=TI.EMPTY,t.push(e),n[r.y][r.x]=n[i.y][i.x],n[i.y][i.x]=TI.EMPTY}}n[o.y][o.x]=n[r.y][r.x],n[r.y][r.x]=TI.EMPTY}}return t}getBoardValue(e){const t=e.gameState.getCopiedBoard(),n=BL.getBoardValuesFor(t,CS.ZERO),r=BL.getBoardValuesFor(t,CS.ONE),i=BL.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return BI.fromWinner(i.winner);let o=0;for(;o<6&&n[o]===r[o];)o++;return new BI(r[o%6]-n[o%6])}}const jL=TI.NONE,UL=TI.ZERO,VL=TI.ONE,zL=TI.EMPTY;class HL{constructor(){this.tutorial=[nT.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,RL.getInitialState()),nT.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new RL([[jL,jL,zL,zL,VL,zL,zL,UL,VL,jL,jL],[jL,zL,zL,zL,zL,zL,zL,zL,zL,zL,jL],[VL,UL,zL,zL,zL,zL,zL,zL,zL,zL,UL],[UL,zL,zL,zL,zL,zL,zL,zL,zL,zL,VL],[jL,zL,zL,zL,zL,zL,zL,zL,zL,zL,jL],[jL,jL,VL,UL,zL,zL,zL,VL,UL,jL,jL]],3)),nT.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        You're the first player, playing with the dark pyramids.
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        Do any simple step.`,RL.getInitialState(),LL.from(new CI(2,0),new CI(2,1)).get(),(e,t)=>e.isSimpleStep()?aS.SUCCESS:aS.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),nT.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol>`,RL.getInitialState(),LL.from(new CI(7,0),new CI(5,0)).get(),(e,t)=>e.isSimpleStep()?aS.failure($localize`Failed! You have made a single step.`):aS.SUCCESS,$localize`Congratulations!`)]}}function GL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Mb(1,"polyline",6),r.Pb()),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.Bb(1),r.mc("ngClass",n.getPlayerClassFor(e,t)),r.Cb("points",n.getPyramidCoordinate(e,t))}}function $L(e,t){if(1&e&&(r.ec(),r.Mb(0,"polyline",9)),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("points",n.getTriangleCoordinate(e,t))}}function qL(e,t){if(1&e&&(r.ec(),r.Mb(0,"polyline",10)),2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("points",n.getTriangleCoordinate(e,t))}}function WL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,$L,1,1,"polyline",7),r.Ac(2,qL,1,1,"polyline",8),r.Pb()),2&e){const e=r.fc().index,t=r.fc().index;r.Bb(1),r.mc("ngIf",(e+t)%2==1),r.Bb(1),r.mc("ngIf",(e+t)%2==0)}}function ZL(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",5),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Ac(1,GL,2,2,"g",2),r.Ac(2,WL,3,2,"g",2),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index;r.oc("id","click_",n,"_",i,""),r.Bb(1),r.mc("ngIf",e.isPlayer()),r.Bb(1),r.mc("ngIf",2===e.value)}}function QL(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,ZL,3,4,"g",4),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function YL(e,t){if(1&e&&(r.ec(),r.Ob(0),r.Mb(1,"polyline",11),r.Mb(2,"polyline",11),r.Nb()),2&e){const e=r.fc();r.Bb(1),r.Cb("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),r.Bb(1),r.Cb("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function KL(e,t){if(1&e&&(r.ec(),r.Mb(0,"polyline",12)),2&e){const e=r.fc();r.Cb("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}let JL=(()=>{class e extends AA{constructor(e){super(e),this.lastCoord=XO.empty(),this.lastMoved=XO.empty(),this.chosenCoord=XO.empty(),this.rules=new BL(RL),this.availableMinimaxes=[new FL(this.rules,"SaharaMinimax")],this.encoder=LL.encoder,this.tutorial=(new HL).tutorial,this.updateBoard()}cancelMoveAttempt(){this.chosenCoord=XO.empty()}onClick(e,t){var n=this;return GO(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t)})()}choosePiece(e,t){return this.board[t][e]===TI.EMPTY?this.cancelMove(DL.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=XO.of(new CI(e,t)),aS.SUCCESS):this.cancelMove(DL.MUST_CHOOSE_OWN_PYRAMID())}chooseLandingCoord(e,t){var n=this;return GO(function*(){const r=new CI(e,t),i=n.rules.node.gameState.getCurrentPlayer(),o=TI.ofPlayer(i);if(n.board[t][e]===o)return n.chosenCoord=XO.of(new CI(e,t)),aS.SUCCESS;const s=LL.from(n.chosenCoord.get(),r);return s.isFailure()?n.cancelMove(s.getReason()):yield n.chooseMove(s.get(),n.rules.node.gameState)})()}updateBoard(){this.chosenCoord=XO.empty();const e=this.rules.node.move;this.lastCoord=e.map(e=>e.coord),this.lastMoved=e.map(e=>e.end),this.board=this.rules.node.gameState.board}getPlayerClassFor(e,t){return this.getPlayerClass(CS.of(this.board[t][e].value))}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-sahara"]],features:[r.yb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,QL,2,1,"g",1),r.Ac(2,YL,3,2,"ng-container",2),r.Ac(3,KL,1,1,"polyline",3),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngIf",t.lastMoved.isPresent()),r.Bb(1),r.mc("ngIf",t.chosenCoord.isPresent()))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),XL=(()=>{class e extends GI{constructor(e,t,n,r){super(e,t),this.x=e,this.y=t,this.moveDirection=n,this.landingOrientation=r,this.checkValidity()}checkValidity(){const e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}isRotation(){return this.moveDirection.isAbsent()}equals(e){return this===e||!!this.coord.equals(e.coord)&&!1!==this.moveDirection.equals(e.moveDirection)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}return e.encoder=new class extends YO{maxValue(){return 2408}encodeNumber(e){const t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}decodeNumber(t){const n=t%7;t-=n;const r=(t/=7)%7;t-=r;const i=(t/=7)%5,o=4===i?XO.empty():wI.factory.fromInt(i).toOptional();t-=i;const s=wI.factory.fromInt(t/=5).get();return new e(r-1,n-1,o,s)}},e})(),eB=(()=>{class e{constructor(e){this.value=e}static decode(t){switch(t){case 0:return e.EMPTY;case 1:return e.WHITE_UP;case 2:return e.WHITE_RIGHT;case 3:return e.WHITE_DOWN;case 4:return e.WHITE_LEFT;case 5:return e.BLACK_UP;case 6:return e.BLACK_RIGHT;case 7:return e.BLACK_DOWN;case 8:return e.BLACK_LEFT;case 9:return e.MOUNTAIN}}belongTo(e){return e===CS.ZERO?1<=this.value&&this.value<=4:e===CS.ONE&&5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?CS.ZERO:5<=this.value&&this.value<=8?CS.ONE:CS.NONE}getOptionalDirection(){switch(this.value){case 0:return XO.empty();case 1:case 5:return XO.of(wI.UP);case 2:case 6:return XO.of(wI.RIGHT);case 3:case 7:return XO.of(wI.DOWN);case 4:case 8:return XO.of(wI.LEFT);default:return $O.expectToBe(this.value,9),XO.empty()}}static of(t,n){if(n===CS.NONE)throw new Error("Player None does not have any pieces.");return n===CS.ZERO?t===wI.UP?e.WHITE_UP:t===wI.RIGHT?e.WHITE_RIGHT:t===wI.DOWN?e.WHITE_DOWN:e.WHITE_LEFT:t===wI.UP?e.BLACK_UP:t===wI.RIGHT?e.BLACK_RIGHT:t===wI.DOWN?e.BLACK_DOWN:e.BLACK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"WHITE_UP";case 2:return"WHITE_RIGHT";case 3:return"WHITE_DOWN";case 4:return"WHITE_LEFT";case 5:return"BLACK_UP";case 6:return"BLACK_RIGHT";case 7:return"BLACK_DOWN";case 8:return"BLACK_LEFT";default:return $O.expectToBe(this.value,9),"MOUNTAIN"}}}return e.EMPTY=new e(0),e.WHITE_UP=new e(1),e.WHITE_RIGHT=new e(2),e.WHITE_DOWN=new e(3),e.WHITE_LEFT=new e(4),e.BLACK_UP=new e(5),e.BLACK_RIGHT=new e(6),e.BLACK_DOWN=new e(7),e.BLACK_LEFT=new e(8),e.MOUNTAIN=new e(9),e})();class tB extends VI{static getInitialState(){const e=cS.createTable(5,5,eB.EMPTY);return e[2][1]=eB.MOUNTAIN,e[2][2]=eB.MOUNTAIN,e[2][3]=eB.MOUNTAIN,new tB(e,0)}countPlayerPawn(){let e=0;for(let t=0;t<5;t++)for(let n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}let nB=(()=>{class e{}return e.CANNOT_INSERT_WHEN_SELECTED=()=>$localize`You cannot insert a piece when you have already selected a piece.`,e.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,e.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,e.ILLEGAL_ROTATION=()=>$localize`You cannot push and turn at the same time.`,e.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,e})();class rB{constructor(e,t){this.resultingBoard=e,this.moved=t}}let iB=(()=>{class e extends JI{isLegal(t,n){if(qO(e.VERBOSE,{SiamRules_isLegal:{move:t,state:n}}),!t.isInsertion()&&!n.getPieceAt(t.coord).belongTo(n.getCurrentPlayer()))return iS.failure(DI.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return qO(e.VERBOSE,"Move is rotation"),this.isLegalRotation(t,n);{let r;if(t.isInsertion()){qO(e.VERBOSE,"Move is insertion");const i=this.isLegalInsertion(t.coord,n);if(i.legal.isFailure())return iS.failure(i.legal.getReason());r=i.insertedPiece}else qO(e.VERBOSE,"Move is forward"),r=n.getPieceAt(t.coord);return e.isLegalForwarding(t,n,r)}}isLegalInsertion(t,n){const r=n.countPlayerPawn(),i=n.getCurrentPlayer(),o=r<5?aS.SUCCESS:aS.failure(nB.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:e.getInsertedPiece(t,i),legal:o}}static getInsertedPiece(e,t){return eB.of(-1===e.x?wI.RIGHT:-1===e.y?wI.DOWN:5===e.x?wI.LEFT:wI.UP,t)}static isLegalForwarding(t,n,r){qO(e.VERBOSE,{isLegalForwarding:{move:t.toString(),state:n,firstPiece:r}});const i=[];let o=eB.of(t.landingOrientation,n.getCurrentPlayer());const s=t.moveDirection.get();let a=t.coord.getNext(s);if(a.isInRange(5,5)&&n.getPieceAt(a)!==eB.EMPTY&&!1===e.isStraight(r,t))return qO(e.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),iS.failure(nB.ILLEGAL_PUSH());let c=XO.of(s);const l=s.getOpposite();let u=0;const h=n.getCopiedBoard();t.coord.isInRange(5,5)&&(h[t.coord.y][t.coord.x]=eB.EMPTY,i.push(t.coord));let d=a.isInRange(5,5)&&o!==eB.EMPTY;for(;d;){c.equalsValue(s)?u++:c.equalsValue(l)&&u--,qO(e.VERBOSE,{totalForce:u,movingPiece:o,landingCoord:a});const t=h[a.y][a.x];t===eB.MOUNTAIN&&(u-=.9),h[a.y][a.x]=o,i.push(a),o=t,a=a.getNext(s),c=o.getOptionalDirection(),d=a.isInRange(5,5)&&o!==eB.EMPTY&&u>0}return a.isNotInRange(5,5)&&(qO(e.VERBOSE,"This movement would push "+o+" outside the board"),c.equalsValue(s)?u++:c.equalsValue(l)&&u--),u<=0?(qO(e.VERBOSE,"This move is an illegal push: "+h),iS.failure(nB.NOT_ENOUGH_FORCE_TO_PUSH())):(qO(e.VERBOSE,"This move is a legal push: "+h),iS.success(new rB(h,i)))}static isStraight(e,t){const n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(t,n){qO(e.VERBOSE,{isLegalRotation:{rotation:t,state:n}});const r=t.coord,i=n.getPieceAt(r),o=n.getCurrentPlayer();if(i.getDirection()===t.landingOrientation)return iS.failure(nB.ILLEGAL_ROTATION());const s=n.getCopiedBoard();return s[r.y][r.x]=eB.of(t.landingOrientation,o),iS.success(new rB(s,[r]))}applyLegalMove(e,t,n){const r=cS.copyBiArray(n.resultingBoard);return new tB(r,t.turn+1)}static getBoardValueInfo(t,n){const r=e.getMountainsRowsAndColumns(n),i=r.rows,o=r.columns,s=e.getWinner(n,t,r.nbMountain);if(s===CS.NONE){const t=e.getPushers(n,o,i);let r=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;const a=n.getCurrentPlayer();for(const e of t)e.coord.isInRange(5,5)?n.getPieceAt(e.coord).belongTo(CS.ZERO)?r=Math.min(r,e.distance):s=Math.min(s,e.distance):a===CS.ZERO?r=Math.min(r,e.distance):s=Math.min(s,e.distance);return{shortestZero:r,shortestOne:s,boardValue:e.getScoreFromShortestDistances(r,s,a)}}return s===CS.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER}}static getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}static getMountainsRowsAndColumns(e){const t=[],n=[];let r=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)e.getPieceAtXY(o,i)===eB.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(o)||n.push(o),r++);return{rows:t,columns:n,nbMountain:r}}static getWinner(t,n,r){return 2===r?e.getPusher(t,n.get()):CS.NONE}static getPusher(t,n){const r=n.coord;let i;i=r.isInRange(5,5)?t.getPieceAt(r.getNext(n.landingOrientation)):e.getInsertedPiece(r,t.getCurrentOpponent());const o=i.getDirection(),s=e.getPusherCoord(t,o,r),a=t.getPieceAt(s).getOwner();return qO(e.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+s.toString()+" belong to "+a.value+", "+a.value+" win"),a}static getPusherCoord(e,t,n){let r=n.getNext(t),i=n;for(;r.isInRange(5,5);){n=r,r=r.getNext(t);const o=e.getPieceAt(n);o!==eB.MOUNTAIN&&o.getDirection()===t&&(i=n)}return i}static getPushers(t,n,r){qO(e.VERBOSE,{getPushers:{state:t,mountainsColumn:n,mountainsRow:r}});let i=[];const o=[];for(const e of n){let t=wI.DOWN,n=new CI(e,4);o.push({direction:t,fallingCoord:n}),t=wI.UP,n=new CI(e,0),o.push({direction:t,fallingCoord:n})}for(const e of r){let t=wI.LEFT,n=new CI(0,e);o.push({direction:t,fallingCoord:n}),t=wI.RIGHT,n=new CI(4,e),o.push({direction:t,fallingCoord:n})}for(const s of o)i=e.addPotentialDirectionPusher(t,s.fallingCoord,s.direction,i);return i}static addPotentialDirectionPusher(t,n,r,i){const o=e.getLineClosestPusher(t,n,r);if(o.isAbsent())return i;const s=o.get(),a=s.distance;return qO(e.VERBOSE,"new closest challenger"),i.push({coord:s.coord,distance:a}),i}static getLineClosestPusher(t,n,r){qO(e.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:n,direction:r.toString()}});const i=r.getOpposite();let o=1,s=t.getPieceAt(n),a=n.getCopy(),c=XO.empty(),l=!1,u=!1,h=0;for(;a.isInRange(5,5)&&!1===l;){const e=t.getPieceAt(a);if(e.isEmptyOrMountain())e===eB.MOUNTAIN?(h+=.9,u=!0):o++;else{const t=e.getDirection();t===r?u&&(h-=1,h<=0&&(l=!0,a=a.getNext(r))):t===i?(h+=1,u||o++):u?(c=XO.of(a.getCopy()),s!==eB.EMPTY&&o++):o++}s=e,a=a.getPrevious(r)}if(!1===l&&c.isPresent())for(o++,h-=1;!1===a.equals(c.get());)a=a.getNext(r),o--;return a.isNotInRange(5,5)&&(h-=1,5===t.countPlayerPawn())||h>0?XO.empty():XO.of({distance:o,coord:a})}static getPushingInsertions(e){const t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[];for(let o=0;o<5;o++)r.push(new XL(-1,o,XO.of(wI.RIGHT),wI.RIGHT)),i.push(eB.of(wI.RIGHT,n)),r.push(new XL(5,o,XO.of(wI.LEFT),wI.LEFT)),i.push(eB.of(wI.LEFT,n)),r.push(new XL(o,-1,XO.of(wI.DOWN),wI.DOWN)),i.push(eB.of(wI.DOWN,n)),r.push(new XL(o,5,XO.of(wI.UP),wI.UP)),i.push(eB.of(wI.UP,n));for(let o=0;o<r.length;o++)this.isLegalForwarding(r[o],e.gameState,i[o]).isSuccess()&&t.push(r[o]);return t}static getDerapingInsertions(e){const t=[],n=e.gameState.getCurrentPlayer();let r,i,o;for(let s=1;s<=3;s++)r=new XL(-1,s,XO.of(wI.RIGHT),wI.UP),i=eB.of(wI.UP,n),o=this.isLegalForwarding(r,e.gameState,i),o.isSuccess()&&(t.push(r),r=new XL(-1,s,XO.of(wI.RIGHT),wI.DOWN),i=eB.of(wI.DOWN,n),o=this.isLegalForwarding(r,e.gameState,i),t.push(r)),r=new XL(5,s,XO.of(wI.LEFT),wI.UP),i=eB.of(wI.UP,n),o=this.isLegalForwarding(r,e.gameState,i),o.isSuccess()&&(t.push(r),r=new XL(5,s,XO.of(wI.LEFT),wI.DOWN),i=eB.of(wI.DOWN,n),o=this.isLegalForwarding(r,e.gameState,i),t.push(r));for(let s=1;s<=3;s++)r=new XL(s,-1,XO.of(wI.DOWN),wI.LEFT),i=eB.of(wI.LEFT,n),o=this.isLegalForwarding(r,e.gameState,i),o.isSuccess()&&(t.push(r),r=new XL(s,-1,XO.of(wI.DOWN),wI.RIGHT),i=eB.of(wI.RIGHT,n),o=this.isLegalForwarding(r,e.gameState,i),t.push(r)),r=new XL(s,5,XO.of(wI.UP),wI.LEFT),i=eB.of(wI.LEFT,n),o=this.isLegalForwarding(r,e.gameState,i),o.isSuccess()&&(t.push(r),r=new XL(s,5,XO.of(wI.UP),wI.RIGHT),i=eB.of(wI.RIGHT,n),o=this.isLegalForwarding(r,e.gameState,i),t.push(r));return t}static getCoordDirection(e,t,n){const r=new CI(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}getGameStatus(t){const n=e.getMountainsRowsAndColumns(t.gameState),r=e.getWinner(t.gameState,t.move,n.nbMountain);return r===CS.NONE?KI.ONGOING:KI.getVictory(r)}}return e.VERBOSE=!1,e})();class oB extends LI{getBoardValue(e){return new BI(iB.getBoardValueInfo(e.move,e.gameState).boardValue)}getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();let r;for(let i=0;i<5;i++)for(let o=0;o<5;o++)if(r=e.gameState.getPieceAtXY(o,i),r.belongTo(n)){const s=r.getDirection();for(const a of wI.ORTHOGONALS){if(a!==s){const r=e.gameState.getCopiedBoard(),s=new XL(o,i,XO.empty(),a);r[i][o]=eB.of(a,n),t.push(s)}let c;c=new CI(o+a.x,i+a.y).isInRange(5,5)?wI.ORTHOGONALS:[a];for(const n of c){const s=new XL(o,i,XO.of(a),n);iB.isLegalForwarding(s,e.gameState,r).isSuccess()&&t.push(s)}}}return e.gameState.countPlayerPawn()<5&&(t=t.concat(iB.getPushingInsertions(e)),t=t.concat(iB.getDerapingInsertions(e))),qO(iB.VERBOSE,{getListMovesResult:t}),t}}const sB=eB.EMPTY,aB=eB.MOUNTAIN,cB=eB.WHITE_UP,lB=eB.WHITE_LEFT,uB=eB.WHITE_RIGHT,hB=eB.WHITE_DOWN,dB=eB.BLACK_UP,fB=eB.BLACK_LEFT,pB=eB.BLACK_RIGHT,gB=eB.BLACK_DOWN;class mB{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following three actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece, and optionally move it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,tB.getInitialState()),nT.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of the big arrows alongside the board.</li>
            <li>Click on one of the small arrows that appeared on the landing square of your piece.
                This is the direction in which your piece will be oriented.</li>
        </ol><br/>
        Insert a piece on the board.`,tB.getInitialState(),new XL(2,-1,XO.of(wI.DOWN),wI.DOWN),$localize`Congratulations!`),nT.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        During that move, you can also move the piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on one of the 4 arrows to pick the direction in which it will move.
                You can also click on the middle dot to change the piece's orientation without moving it.</li>
            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>
        </ol><br/>
        Try to move the piece that is on the board one square upwards and to orient it downwards.`,new tB([[sB,sB,sB,sB,sB],[sB,sB,sB,sB,sB],[sB,aB,aB,aB,sB],[sB,sB,sB,sB,sB],[sB,sB,cB,sB,sB]],0),[new XL(2,4,XO.of(wI.UP),wI.DOWN)],$localize`Congratulations, you made a side-slip!`,$localize`Failed!`),nT.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        Get that piece out of the board!`,new tB([[sB,sB,sB,sB,sB],[sB,sB,sB,sB,sB],[sB,aB,aB,aB,sB],[sB,sB,sB,sB,sB],[sB,sB,cB,sB,sB]],0),[new XL(2,4,XO.of(wI.DOWN),wI.DOWN)],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),nT.fromMove($localize`Pushing`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push, multiple conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>The number of the pieces (opponent's or not) that are facing yours (called the resistants)
                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>
            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>
        </ol>
        Your piece on the top right cannot push because there is one mountain too much.
        Your piece on the bottom right can push.<br/><br/>
        Do it.`,new tB([[uB,aB,aB,fB,lB],[sB,sB,sB,sB,sB],[sB,sB,sB,aB,sB],[sB,sB,sB,sB,sB],[sB,sB,pB,fB,lB]],0),[new XL(4,4,XO.of(wI.LEFT),wI.LEFT)],$localize`Congratulations!`,$localize`Failed!`),nT.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        You have two ways of ending the game here: you can either win, or lose. Choose correctly!`,new tB([[sB,sB,sB,sB,sB],[sB,sB,sB,sB,sB],[aB,dB,lB,sB,hB],[sB,sB,sB,sB,gB],[sB,sB,sB,sB,aB]],0),[new XL(2,2,XO.of(wI.LEFT),wI.LEFT)],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function yB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"use",7),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(3).insertAt(n.x,n.y)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(3);r.oc("id","insertAt_",e.x,"_",e.y,""),r.Cb("transform",n.getInsertionArrowTransform(e.x+1,e.y+1,e.dir))}}const vB=function(e,t){return{dir:"DOWN",x:e,y:t}},bB=function(e){return{dir:"UP",x:e,y:5}},_B=function(e,t){return{dir:"RIGHT",x:e,y:t}},wB=function(e){return{dir:"LEFT",x:5,y:e}},CB=function(e,t,n,r){return[e,t,n,r]};function EB(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,yB,1,3,"use",6),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",r.tc(11,CB,r.sc(1,vB,e,-1),r.rc(4,bB,e),r.sc(6,_B,-1,e),r.rc(9,wB,e)))}}const OB=function(){return[0,1,2,3,4]};function SB(e,t){1&e&&(r.ec(),r.Ob(0),r.Ac(1,EB,2,16,"g",5),r.Nb()),2&e&&(r.Bb(1),r.mc("ngForOf",r.qc(1,OB)))}function PB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"use",13),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(5).chooseDirection(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(3).index,i=r.fc().index,o=r.fc();r.nc("id","chooseDirection_",e,""),r.Cb("transform",o.getArrowTransform(n+1,i+1,e))}}const IB=function(){return["RIGHT","DOWN","LEFT","UP"]};function TB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",11),r.cc("click",function(){return r.wc(e),r.fc(4).chooseDirection("")}),r.Pb(),r.Ac(2,PB,1,2,"use",12),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Bb(1),r.Cb("cx",(e+1)*n.SPACE_SIZE+n.SPACE_SIZE/2)("cy",(t+1)*n.SPACE_SIZE+n.SPACE_SIZE/2),r.Bb(1),r.mc("ngForOf",r.qc(3,IB))}}function AB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"use",10),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().clickPiece(t,n)}),r.Pb(),r.Ac(2,TB,3,4,"g",4),r.Pb()}if(2&e){const e=r.fc(),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","clickPiece_",t,"_",i,""),r.mc("ngClass",o.getPieceClasses(n)),r.Cb("transform",o.getPieceTransform(t,i)),r.Bb(1),r.mc("ngIf",o.choosingDirection(t,i))}}function kB(e,t){if(1&e&&(r.ec(),r.Mb(0,"use",14)),2&e){const e=r.fc().index,t=r.fc().index,n=r.fc();r.Cb("transform","translate("+(e+1)*n.SPACE_SIZE+" "+(t+1)*n.SPACE_SIZE+")")}}function NB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"use",13),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(4).chooseOrientation(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(2).index,i=r.fc().index,o=r.fc();r.nc("id","chooseOrientation_",e,""),r.Cb("transform",o.getArrowTransform(n+1,i+1,e))}}function MB(e,t){1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,NB,1,2,"use",12),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",r.qc(1,IB)))}function xB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",8),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().insertAt(n,i)}),r.Pb(),r.Ac(2,AB,3,5,"g",4),r.Ac(3,kB,1,1,"use",9),r.Ac(4,MB,2,2,"g",4),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.fc().index,o=r.fc();r.Bb(1),r.oc("id","insertAt_",n,"_",i,""),r.mc("ngClass",o.getSquareClasses(n,i)),r.Cb("x",o.SPACE_SIZE*(n+1))("y",o.SPACE_SIZE*(i+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),r.Bb(1),r.mc("ngIf",e.isPiece()),r.Bb(1),r.mc("ngIf",o.isMountain(e)),r.Bb(1),r.mc("ngIf",o.choosingOrientation(n,i))}}function RB(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,xB,5,10,"g",5),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}let DB=(()=>{class e extends BT{constructor(e){super(e),this.lastMove=XO.empty(),this.chosenCoord=XO.empty(),this.landingCoord=XO.empty(),this.chosenDirection=XO.empty(),this.chosenOrientation=XO.empty(),this.movedPieces=[],this.rules=new iB(tB),this.availableMinimaxes=[new oB(this.rules,"SiamMinimax")],this.encoder=XL.encoder,this.tutorial=(new mB).tutorial,this.updateBoard()}updateBoard(){if(qO(e.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.chosenCoord=XO.empty(),this.chosenDirection=XO.empty(),this.landingCoord=XO.empty(),this.chosenOrientation=XO.empty()}clickPiece(e,t){const n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());const r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(DI.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=XO.of(new CI(e,t)),aS.SUCCESS)}chooseDirection(t){var n=this;return GO(function*(){qO(e.VERBOSE,"SiamComponent.chooseDirection("+t+")");const r=n.canUserPlay("#chooseDirection_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(""===t)n.chosenDirection=XO.empty(),n.landingCoord=n.chosenCoord;else{const r=wI.factory.fromString(t).get();if(n.chosenDirection=XO.of(r),n.landingCoord=XO.of(n.chosenCoord.get().getNext(r)),n.landingCoord.get().isNotInRange(5,5))return qO(e.VERBOSE,"orientation and direction should be the same: "+r),n.chosenOrientation=XO.of(r),yield n.tryMove()}return aS.SUCCESS})()}chooseOrientation(t){var n=this;return GO(function*(){qO(e.VERBOSE,"SiamComponent.chooseOrientation("+t+")");const r=n.canUserPlay("#chooseOrientation_"+t);return r.isFailure()?n.cancelMove(r.getReason()):(n.chosenOrientation=XO.of(wI.factory.fromString(t).get()),yield n.tryMove())})()}insertAt(t,n){var r=this;return GO(function*(){qO(e.VERBOSE,"SiamComponent.insertAt("+t+", "+n+")");const i=r.canUserPlay("#insertAt_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());if(r.chosenCoord.isPresent())return r.cancelMove(nB.CANNOT_INSERT_WHEN_SELECTED());{r.chosenCoord=XO.of(new CI(t,n));const e=iB.getCoordDirection(t,n,r.rules.node.gameState);return r.chosenDirection=XO.of(e),r.landingCoord=XO.of(r.chosenCoord.get().getNext(e)),aS.SUCCESS}})()}tryMove(){var e=this;return GO(function*(){const t=e.chosenCoord.get(),n=new XL(t.x,t.y,e.chosenDirection,e.chosenOrientation.get());return e.cancelMove(),yield e.chooseMove(n,e.rules.node.gameState)})()}isMountain(e){return e===eB.MOUNTAIN}choosingOrientation(t,n){const r=new CI(t,n);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(qO(e.VERBOSE,"choosing orientation now"),!0)}choosingDirection(t,n){const r=new CI(t,n);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(qO(e.VERBOSE,"choosing direction now"),!0)}getInsertionArrowTransform(e,t,n){const r=wI.factory.fromString(n).get().toInt()-2;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",`rotate(${90*r} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`].join(" ")}getPieceTransform(e,t){const n=this.board[t][e].getDirection().toInt()-2;return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",`rotate(${90*n} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`].join(" ")}getArrowTransform(e,t,n){return uL.getArrowTransform(this.SPACE_SIZE,new CI(e,t),wI.factory.fromString(n).get())}getPieceClasses(e){return[this.getPlayerClass(e.getOwner())]}getSquareClasses(e,t){const n=new CI(e,t);return this.movedPieces.some(e=>e.equals(n))?["moved"]:[]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-siam"]],features:[r.yb],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],[0,"xlink","href","#triangle","class","arrow selected-fill no-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Qb(1,"defs"),r.Mb(2,"polygon",1),r.Mb(3,"polygon",2),r.Mb(4,"polygon",3),r.Pb(),r.Ac(5,SB,2,2,"ng-container",4),r.Ac(6,RB,2,1,"g",5),r.Pb()),2&e&&(r.Bb(5),r.mc("ngIf",t.isPlayerTurn()),r.Bb(1),r.mc("ngForOf",t.board))},directives:[fe,he,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),LB=(()=>{class e{}return e.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,e.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,e.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,e.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,e.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,e.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,e.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,e})();class BB extends UI{constructor(e,t,n){super(t),this.pieces=e;const r=this.getCalculatedScale();this.pieces=r.pieces,this.width=r.width,this.height=r.height,this.offset=n||r.offset,this.pieces.makeImmutable()}static getInitialState(){return BB.fromRepresentation([[CS.ZERO.value],[CS.ONE.value]],0)}static fromRepresentation(e,t,n){const r=new ZI;for(let i=0;i<e.length;i++)for(let t=0;t<e[0].length;t++)e[i][t]!==CS.NONE.value&&r.set(new CI(t,i),CS.of(e[i][t]));return new BB(r,t,n)}static deplacePiece(e,t){const n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}static getGroups(e,t){let n=new ZI,r=0;for(const s of kI.factory.all){const i=t.getNext(s,1);n=BB.putCoordInGroup(e,i,n,""+r),r++}const i=n.reverse(),o=new jI;for(let s=0;s<i.size();s++)o.add(i.getByIndex(s).value);return o}static putCoordInGroup(e,t,n,r){if(e.get(t).isPresent()&&n.get(t).isAbsent()){n.set(t,r);for(const i of kI.factory.all){const o=t.getNext(i,1);n=BB.putCoordInGroup(e,o,n,r)}}return n}getCalculatedScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(const s of this.pieces.listKeys())e=Math.min(s.x,e),t=Math.max(s.x,t),n=Math.min(s.y,n),r=Math.max(s.y,r);let i=new ZI;const o=new gI(-e,-n);if(0!==e||0!==n)for(const s of this.pieces.listKeys()){const e=this.pieces.delete(s),t=s.getNext(o);i.set(t,e)}else i=this.pieces;return{width:t+1-e,height:r+1-n,pieces:i,offset:o}}toRepresentation(){const e=cS.createTable(this.width,this.height,CS.NONE.value);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t).value;e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?aS.failure(DI.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?aS.SUCCESS:aS.failure(LB.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of kI.factory.all){const r=e.getNext(n,1);if(this.pieces.containsKey(r)&&!1===t.equalsValue(r))return!0}return!1}isOnBoard(e){return this.pieces.containsKey(e)}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():CS.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new BB(t,this.turn+1)}applyLegalDeplacement(e,t){const n=BB.deplacePiece(this,e);let r=new ZI;if(t.size()>0){r=new ZI;for(let e=0;e<t.size();e++){const i=t.get(e);r.set(i,n.get(i).get())}}else r=n.getCopy();return new BB(r,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(CS.ZERO).getOrElse(new jI),n=e.get(CS.ONE).getOrElse(new jI);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);return t.replace(e,n.getOpponent()),new BB(t,this.turn,this.offset)}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}let FB=(()=>{class e extends HI{constructor(e,t,n){if(super(),this.start=e,this.landing=t,this.keep=n,e.equalsValue(t))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(n))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new e(XO.empty(),t,XO.empty())}static fromMovement(t,n){return new e(XO.of(t),n,XO.empty())}static fromCut(t,n,r){return new e(XO.of(t),n,XO.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}return e.encoder=new class extends QO{encodeMove(e){return{start:e.start.isPresent()?CI.encoder.encode(e.start.get()):null,landing:CI.encoder.encode(e.landing),keep:e.keep.isPresent()?CI.encoder.encode(e.keep.get()):null}}decodeMove(t){const n=t;if("object"!=typeof t)throw new Error("Invalid encodedMove of type "+typeof t+"!");const r=CI.encoder.decode(n.landing);if(null==n.start)return e.fromDrop(r);const i=CI.encoder.decode(n.start);if(null==n.keep)return e.fromMovement(i,r);{const t=CI.encoder.decode(n.keep);return e.fromCut(i,r,t)}}},e})();class jB extends JI{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){qO(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):jB.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new jI;for(const n of e.pieces.listKeys())for(const r of kI.factory.all){const i=n.getNext(r,1);e.getPieceAt(i)===CS.NONE&&t.add(i)}return t.getCopy()}isLegalDrop(e,t){return!1===e.isDrop()?iS.failure(LB.NO_MOVEMENT_BEFORE_TURN_40()):iS.success(t.pieces.getKeySet())}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return iS.failure(LB.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case CS.NONE:return iS.failure(DI.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return iS.failure(DI.CANNOT_CHOOSE_OPPONENT_PIECE())}const n=BB.deplacePiece(t,e),r=BB.getGroups(n,e.start.get());if(jB.isSplit(r)){const t=this.getBiggerGroups(r);return 1===t.size()?e.keep.isPresent()?iS.failure(LB.CANNOT_CHOOSE_TO_KEEP()):iS.success(t.get(0)):this.moveKeepBiggerGroup(e.keep,t,n)}return iS.success(new jI)}static isSplit(e){return e.size()>1}static getBiggerGroups(e){let t=0,n=new jI;for(let r=0;r<e.size();r++){const i=e.get(r),o=i.size();o>t?(t=o,n=new jI([i])):o===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return iS.failure(LB.MUST_CUT());if(n.get(e.get()).isAbsent())return iS.failure(LB.CANNOT_KEEP_EMPTY_COORD());const r=e.get();for(let i=0;i<t.size();i++){const e=t.get(i);if(e.contains(r))return iS.success(e)}return iS.failure(LB.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return KI.getVictory(n);if(t.turn>39){const e=t.countPieces(),n=e[0],r=e[1];return n<6&&r<6?n<r?KI.ONE_WON:r<n?KI.ZERO_WON:KI.DRAW:n<6?KI.getDefeat(CS.ZERO):r<6?KI.getDefeat(CS.ONE):KI.ONGOING}return KI.ONGOING}startSearchingVictorySources(){qO(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const r=t.landing.getNext(n.offset,1);switch(qO(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}searchVictoryOnlyForCircle(e,t,n){qO(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent(),i=[t];let o=t.getNext(kI.factory.all[e],1);for(;i.length<6;){if(n.getPieceAt(o)!==r)return[];const t=(e+i.length)%6;i.push(o),o=o.getNext(kI.factory.all[t],1)}return i}searchVictoryOnlyForLine(e,t,n){const r=n.getCurrentOpponent();let i=kI.factory.all[e],o=t.getNext(i,1);const s=[t];let a=!1;for(;s.length<6;){if(n.getPieceAt(o)===r)s.push(o);else{if(a)return[];a=!0,i=i.getOpposite(),o=o.getNext(i,s.length)}o=o.getNext(i,1)}return s}searchVictoryOnlyForTriangleCorner(e,t,n){qO(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=kI.factory.all[e];const o=[t];let s=t.getNext(i,1);for(;o.length<6;){if(n.getPieceAt(s)!==r)return[];o.length%2==0&&(i=kI.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(e,t,n){qO(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=kI.factory.all[e];const o=[t];let s=t.getNext(i,1);for(;o.length<6;){if(n.getPieceAt(s)!==r)return[];o.push(s),o.length%2==0&&(i=kI.factory.all[(e+o.length)%6]),s=s.getNext(i,1)}return o}}class UB extends LI{calculateBoardValue(e,t){this.startSearchingVictorySources();let n={status:qI.DEFAULT,victory:XO.empty(),preVictory:XO.empty(),sum:0};for(;this.hasNextVictorySource();){const r=this.getNextVictorySource();let i;if(i=n.status===qI.PRE_VICTORY?this.searchVictoryOnly(r,e,t):this.getBoardInfo(r,e,t,n),i.status===qI.VICTORY)return i;n={status:i.status,victory:XO.empty(),preVictory:i.preVictory,sum:n.sum+i.sum}}return n}}class VB extends BI{constructor(e,t){super(e),this.value=e,this.preVictory=t}}class zB extends UB{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(null==zB.INSTANCE){const e=new jB(BB);zB.INSTANCE=new zB(e,"SixMinimax")}return zB.INSTANCE}getListMoves(e){const t=zB.get(),n=e.getOwnValue(t);if(n.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(n):this.createForcedDeplacement(e,n);const r=jB.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(r):this.getListDeplacement(e.gameState,r)}createForcedDrop(e){qO(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});const t=[],n=FB.fromDrop(e.preVictory.get());return t.push(n),t}createForcedDeplacement(e,t){qO(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});const n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}getDeplacementFrom(e,t,n){const r=[];for(let i=0;i<t.size();i++){const o=t.get(i);for(const t of n){const n=FB.fromMovement(o,t);if(e.isCoordConnected(t,XO.of(o))){const i=BB.deplacePiece(e,n),s=BB.getGroups(i,n.start.get());if(jB.isSplit(s))for(let e=0;e<s.size();e++){const e=s.get(0).get(0),n=FB.fromCut(o,t,e);r.push(n)}else r.push(n)}}}return r}getSafelyMovablePieceOrFirstOne(e){const t=e.gameState,n=t.pieces.reverse(),r=t.getCurrentPlayer(),i=n.get(r).get(),o=i.get(0),s=[];for(let a=0;a<i.size();a++){const e=i.get(a);!1===this.isPieceBlockingAVictory(t,e)&&s.push(e)}return new jI(0===s.length?[o]:s)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),r=FB.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===qI.VICTORY)return!0;return!1}getListDrop(e){const t=[];for(const n of e){const e=FB.fromDrop(n);t.push(e)}return t}getListDeplacement(e,t){const n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}getBoardValue(e){const t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue();let o={status:qI.DEFAULT,victory:XO.empty(),preVictory:XO.empty(),sum:0};t.isPresent()&&(o=this.calculateBoardValue(t.get(),n));let s=XO.empty();if(o.status===qI.DEFAULT&&o.preVictory.isPresent()&&(s=XO.of(o.preVictory.get())),o.status===qI.VICTORY)return new VB(i,XO.empty());if(n.turn>39){const e=n.countPieces(),t=e[0],r=e[1];return t<6&&r<6?new VB(t<r?CS.ONE.getVictoryValue():r<t?CS.ZERO.getVictoryValue():0,XO.empty()):t<6?new VB(CS.ZERO.getDefeatValue(),XO.empty()):r<6?new VB(CS.ONE.getDefeatValue(),XO.empty()):new VB(t-r,s)}return new VB(o.status===qI.PRE_VICTORY?r.getPreVictory():o.sum*r.getScoreModifier(),s)}startSearchingVictorySources(){qO(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const r=t.landing.getNext(n.offset,1);switch(qO(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}searchVictoryOnlyForCircle(e,t,n){qO(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent(),i=[t];let o=t.getNext(kI.factory.all[e],1);for(;i.length<6;){if(n.getPieceAt(o)!==r)return{status:qI.PRE_VICTORY,victory:XO.empty(),preVictory:XO.empty(),sum:0};const t=(e+i.length)%6;i.push(o),o=o.getNext(kI.factory.all[t],1)}return{status:qI.VICTORY,victory:XO.of(i),preVictory:XO.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const r=n.getCurrentOpponent();let i=kI.factory.all[e],o=t.getNext(i,1);const s=[t];let a=!1;for(;s.length<6;){if(n.getPieceAt(o)===r)s.push(o);else{if(a)return{status:qI.PRE_VICTORY,victory:XO.empty(),preVictory:XO.empty(),sum:0};a=!0,i=i.getOpposite(),o=o.getNext(i,s.length-1)}o=o.getNext(i,1)}return{status:qI.VICTORY,victory:XO.of(s),preVictory:XO.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){qO(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=kI.factory.all[e];const o=[t];let s=t.getNext(i,1);for(;o.length<6;){if(n.getPieceAt(s)!==r)return{status:qI.PRE_VICTORY,victory:XO.empty(),preVictory:XO.empty(),sum:0};o.length%2==0&&(i=kI.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(i,1)}return{status:qI.VICTORY,victory:XO.of(o),preVictory:XO.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){qO(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=kI.factory.all[e];const o=[t];let s=t.getNext(i,1);for(;o.length<6;){if(n.getPieceAt(s)!==r)return{status:qI.PRE_VICTORY,victory:XO.empty(),preVictory:XO.empty(),sum:0};o.push(s),o.length%2==0&&(i=kI.factory.all[(e+o.length)%6]),s=s.getNext(i,1)}return{status:qI.VICTORY,victory:XO.of(o),preVictory:XO.empty(),sum:0}}getBoardInfo(e,t,n,r){qO(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});const i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}getBoardInfoForCircle(e,t,n,r){qO(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer(),o=[t];let s=t.getNext(kI.factory.all[e],1),a=0,c=XO.empty();for(;o.length<6;){const t=n.getPieceAt(s);if(t===i)return r;const l=(e+o.length)%6;o.push(s);const u=kI.factory.all[l];t===CS.NONE?(a+=.16,c=XO.of(s)):a++,s=s.getNext(u,1)}return this.getBoardInfoResult(a,c,o,r)}getBoardInfoResult(e,t,n,r){let i=r.preVictory;if(4.16===e){if(qO(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:qI.PRE_VICTORY,victory:XO.empty(),preVictory:XO.empty(),sum:0};i=t}else if(5===e)return{status:qI.VICTORY,victory:XO.of(n),preVictory:XO.empty(),sum:0};return{status:r.status,victory:XO.empty(),preVictory:i,sum:r.sum+e}}getBoardInfoForLine(e,t,n,r){qO(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});const i=kI.factory.all[e];let o=t.getPrevious(i,5),s=[],a=[],c=XO.empty();for(let p=0;p<6;p++){const e=this.updateEncounterAndReturnLastEmpty(n,o,a);e.isPresent()&&(c=e),s.push(o),o=o.getNext(i,1)}let l=r.status,u=r.preVictory,h=0,d=0;for(;h<6;){const e=a.reduce((e,t)=>e+t);if(6===e)return{status:qI.VICTORY,victory:XO.of(s),preVictory:XO.empty(),sum:0};5.16===e&&l===qI.DEFAULT&&(u.isPresent()?(WO(!1===u.equals(c),"Impossible to have point aligned with differents line to a same point"),l=qI.PRE_VICTORY):u=c),d=Math.max(d,e),s=s.slice(1,6),s.push(o),a=a.slice(1,6);const t=this.updateEncounterAndReturnLastEmpty(n,o,a);t.isPresent()&&(c=t),h++,o=o.getNext(i,1)}const f={status:l,victory:XO.of(s),preVictory:u,sum:d};return this.getBoardInfoResult(d,c,s,f)}updateEncounterAndReturnLastEmpty(e,t,n){const r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),XO.empty();case CS.NONE:return n.push(.16),XO.of(t);default:return n.push(1),XO.empty()}}getBoardInfoForTriangleCorner(e,t,n,r){qO(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer();let o=kI.factory.all[e];const s=[t];let a=t.getNext(o,1),c=0,l=XO.empty();for(;s.length<6;){const t=n.getPieceAt(a);if(t===i)return r;t===CS.NONE?(c+=.16,l=XO.of(a)):c++,s.length%2==0&&(o=kI.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return this.getBoardInfoResult(c,l,s,r)}getBoardInfoForTriangleEdge(e,t,n,r){qO(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer();let o=kI.factory.all[e];const s=[t];let a=t.getNext(o,1),c=0,l=XO.empty();for(;s.length<6;){const t=n.getPieceAt(a);if(t===i)return r;t===CS.NONE?(c+=.16,l=XO.of(a)):c++,s.push(a),s.length%2==0&&(o=kI.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return this.getBoardInfoResult(c,l,s,r)}}const HB=CS.NONE.value,GB=CS.ZERO.value,$B=CS.ONE.value;let qB=(()=>{class e{}return e.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,e.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,e})();class WB{constructor(){this.tutorial=[nT.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,BB.getInitialState()),nT.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,BB.fromRepresentation([[GB,$B,$B,$B,$B,GB],[HB,GB,$B,HB,GB,HB],[$B,$B,GB,HB,HB,HB],[HB,HB,GB,HB,HB,HB],[HB,GB,HB,HB,HB,HB],[GB,HB,HB,HB,HB,HB]],0),[FB.fromDrop(new CI(3,2))],$localize`Congratulations!`,$localize`Failed!`),nT.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,BB.fromRepresentation([[HB,HB,HB,$B,HB,HB],[HB,HB,$B,$B,GB,GB],[HB,$B,HB,GB,$B,HB],[$B,GB,GB,GB,GB,$B]],0),[FB.fromDrop(new CI(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed!`),nT.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,BB.fromRepresentation([[HB,HB,HB,$B,HB,HB],[HB,GB,$B,GB,GB,GB],[HB,GB,HB,GB,GB,HB],[$B,$B,$B,HB,$B,HB]],0),[FB.fromDrop(new CI(3,3))],$localize`Congratulations!`,$localize`Failed!`),nT.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,BB.fromRepresentation([[HB,HB,HB,HB,HB,HB,HB,$B,HB],[HB,HB,HB,HB,HB,HB,GB,HB,HB],[HB,HB,HB,HB,GB,GB,GB,HB,HB],[HB,HB,HB,HB,$B,$B,HB,$B,GB],[HB,GB,$B,$B,GB,GB,$B,HB,HB],[GB,GB,GB,GB,$B,$B,$B,GB,HB],[$B,$B,GB,HB,$B,$B,GB,HB,HB],[HB,GB,HB,GB,GB,HB,HB,HB,HB],[$B,$B,$B,$B,HB,HB,HB,HB,HB],[HB,GB,HB,$B,HB,HB,HB,HB,HB]],40),FB.fromMovement(new CI(6,1),new CI(5,1)),(e,t)=>{const n=t.countPieces();return 19===n[0]?18===n[1]?aS.SUCCESS:aS.failure(qB.MOVEMENT_NOT_DISCONNECTING()):aS.failure(qB.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),nT.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,BB.fromRepresentation([[HB,HB,HB,HB,HB,$B],[HB,HB,HB,HB,GB,$B],[HB,HB,HB,$B,GB,GB],[HB,HB,GB,HB,$B,GB],[$B,$B,HB,HB,HB,GB],[GB,$B,HB,HB,HB,HB],[GB,HB,HB,HB,HB,HB]],40),FB.fromMovement(new CI(2,3),new CI(3,3)),(e,t)=>e.start.equalsValue(new CI(2,3))?aS.SUCCESS:aS.failure(qB.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),nT.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,BB.fromRepresentation([[HB,HB,HB,HB,HB,$B],[HB,HB,HB,HB,GB,$B],[HB,HB,HB,$B,GB,GB],[GB,HB,GB,HB,HB,$B],[$B,$B,HB,HB,HB,HB],[GB,GB,HB,HB,HB,HB],[GB,HB,HB,HB,HB,HB]],40),FB.fromCut(new CI(2,3),new CI(2,5),new CI(2,5)),(e,t)=>e.keep.isAbsent()?aS.failure($localize`This move has not cut the board in two equal halves.`):t.getPieceAt(e.landing.getNext(t.offset))===CS.NONE?aS.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):aS.SUCCESS,$localize`Congratulations, you won!`)]}}function ZB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",10),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onPieceClick(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.oc("id","piece_",e.x,"_",e.y,""),r.mc("ngClass",n.getPieceClass(e)),r.Cb("points",n.getHexaCoordsAt(e))}}function QB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",11),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onNeighborClick(n)}),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.oc("id","neighbor_",e.x,"_",e.y,""),r.Cb("points",n.getHexaCoordsAt(e))}}function YB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",10),r.cc("click",function(){r.wc(e);const t=r.fc();return t.onPieceClick(t.chosenLanding.get())}),r.Pb()}if(2&e){const e=r.fc();r.oc("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),r.mc("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),r.Cb("points",e.getHexaCoordsAt(e.chosenLanding.get()))}}function KB(e,t){if(1&e&&(r.ec(),r.Mb(0,"polyline",12)),2&e){const e=t.$implicit,n=r.fc();r.oc("id","disconnected_",e.x,"_",e.y,""),r.Cb("points",n.getHexaCoordsAt(e))}}function JB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",13),r.cc("click",function(){r.wc(e);const t=r.fc();return t.onNeighborClick(t.leftCoord.get())}),r.Pb()}if(2&e){const e=r.fc();r.oc("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),r.Cb("points",e.getHexaCoordsAt(e.leftCoord.get()))}}function XB(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",14),r.cc("click",function(){r.wc(e);const t=r.fc();return t.onPieceClick(t.lastDrop.get())}),r.Pb()}if(2&e){const e=r.fc();r.oc("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),r.Cb("points",e.getHexaCoordsAt(e.lastDrop.get()))}}function eF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",15),r.cc("click",function(){r.wc(e);const t=r.fc();return t.onPieceClick(t.selectedPiece.get())}),r.Pb()}if(2&e){const e=r.fc();r.oc("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),r.mc("ngClass",e.getSelectedPieceClass()),r.Cb("points",e.getHexaCoordsAt(e.selectedPiece.get()))}}function tF(e,t){if(1&e&&(r.ec(),r.Mb(0,"polyline",16)),2&e){const e=t.$implicit,n=r.fc();r.oc("id","victoryCoord_",e.x,"_",e.y,""),r.Cb("points",n.getHexaCoordsAt(e))}}function nF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",19),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).onPieceClick(n)}),r.Mb(1,"polyline",20),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(2);r.Bb(1),r.oc("id","cuttable_",e.x,"_",e.y,""),r.Cb("points",n.getHexaCoordsAt(e))}}function rF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g",17),r.Ac(1,nF,2,3,"g",18),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}let iF=(()=>{class e extends PI{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=XO.empty(),this.lastDrop=XO.empty(),this.selectedPiece=XO.empty(),this.chosenLanding=XO.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new jB(BB),this.availableMinimaxes=[new zB(this.rules,"SixMinimax")],this.encoder=FB.encoder,this.tutorial=(new WB).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new NI(1.5*this.SPACE_SIZE,new CI(2*this.SPACE_SIZE,0),RI.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=XO.empty(),this.chosenLanding=XO.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=XO.empty(),this.lastDrop=XO.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}mapAbstractCoordToCornerCoords(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(e=>this.hexaLayout.getHexaCoordsAt(e));let t=[];for(const n of e)t=t.concat(n);return t}getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of e)o.x<r&&(r=o.x),o.y<i&&(i=o.y),t=Math.max(t,o.x),n=Math.max(n,o.y);return{minX:r,minY:i,maxX:t,maxY:n}}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=XO.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?XO.of(e.start.get().getNext(this.state.offset,1)):XO.empty();const t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.pieces.listKeys(),t=this.rules.node.gameState.pieces.listKeys(),n=[];for(const i of e)!1===this.rules.node.move.get().start.equalsValue(i)&&!1===t.some(e=>e.equals(i.getNext(this.state.offset,1)))&&n.push(i.getNext(this.state.offset,1));const r=this.lastDrop.get();return!1===this.pieces.some(e=>e.equals(r))&&!1===t.some(e=>e.equals(r))&&n.push(r),n}getEmptyNeighbors(){let e=jB.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const t=this.chosenLanding.get();e=e.filter(e=>!1===e.equals(t))}return e}getPieceClass(e){const t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}onPieceClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#piece_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.state.turn<40)return t.cancelMove(LB.NO_MOVEMENT_BEFORE_TURN_40());if(t.chosenLanding.isAbsent())return t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(DI.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=XO.of(e),aS.SUCCESS);{const n=FB.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e);return t.chooseMove(n,t.state)}})()}onNeighborClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.nextClickShouldSelectGroup)return t.cancelMove(LB.MUST_CUT());if(t.state.turn<40)return t.chooseMove(FB.fromDrop(e),t.state);if(t.selectedPiece.isAbsent())return t.cancelMove(LB.CAN_NO_LONGER_DROP());{const n=FB.fromMovement(t.selectedPiece.get(),e),r=jB.isLegalPhaseTwoMove(n,t.state);return t.neededCutting(r)?(t.chosenLanding=XO.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,aS.SUCCESS):t.chooseMove(n,t.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===LB.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(t=>!1===t.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=FB.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=BB.deplacePiece(this.state,e),n=BB.getGroups(t,e.start.get()),r=jB.getBiggerGroups(n);this.cuttableGroups=[];for(let i=0;i<r.size();i++){const e=r.get(i).getCopy();this.cuttableGroups.push(e)}}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved":"selected"}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-six"]],features:[r.yb],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,ZB,1,4,"polyline",1),r.Ac(2,QB,1,3,"polyline",2),r.Ac(3,YB,1,4,"polyline",3),r.Ac(4,KB,1,3,"polyline",4),r.Ac(5,JB,1,3,"polyline",5),r.Ac(6,XB,1,3,"polyline",6),r.Ac(7,eF,1,4,"polyline",7),r.Ac(8,tF,1,3,"polyline",8),r.Ac(9,rF,2,1,"g",9),r.Pb()),2&e&&(r.Cb("viewBox",t.viewBox),r.Bb(1),r.mc("ngForOf",t.pieces),r.Bb(1),r.mc("ngForOf",t.neighbors),r.Bb(1),r.mc("ngIf",t.chosenLanding.isPresent()),r.Bb(1),r.mc("ngForOf",t.disconnecteds),r.Bb(1),r.mc("ngIf",t.leftCoord.isPresent()),r.Bb(1),r.mc("ngIf",t.lastDrop.isPresent()),r.Bb(1),r.mc("ngIf",t.selectedPiece.isPresent()),r.Bb(1),r.mc("ngForOf",t.victoryCoords),r.Bb(1),r.mc("ngForOf",t.cuttableGroups))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),oF=(()=>{class e extends YT{static of(t,n){return new e(t,n)}static from(t,n){try{const r=new e(t,n);return iS.success(r)}catch(aO){return iS.failure(aO.message)}}getMaximalDistance(){return 9}}return e.encoder=ZT.getEncoder(9,9,e.of),e})();const sF={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:CS.ZERO};class aF extends tA{static getInitialState(){const e=XT.UNOCCUPIED,t=XT.INVADERS,n=XT.DEFENDERS;return new aF([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,XT.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}from(e,t){return new aF(e,t)}}class cF extends rA{constructor(){super(aF,sF,oF.of)}static get(){return null==cF.singleton&&(cF.singleton=new cF),YI.ruler=this.singleton,cF.singleton}}const lF=XT.UNOCCUPIED,uF=XT.INVADERS,hF=XT.DEFENDERS,dF=XT.PLAYER_ONE_KING;class fF{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`Tablut is a strategy game that was played by the Vikings.
        The goal of the game is different for each player.
        The attacker plays first. Its pieces (dark) are close to the edges.
        Its goal is to capture the king, which is in the center of the board.
        The defender plays second. Its pieces (light) are in the middle.
        Its goal is to move the king on one of the 4 thrones in the corners.
        Note that the square in which the king starts, in the center of the board, is also a throne.`,aF.getInitialState()),nT.anyMove($localize`Moving`,$localize`All pieces move the same way.
        Similarly to a rook in chess, a piece can move:
        <ol>
            <li>By as many squares as you want.</li>
            <li>Without going over another piece or stopping on another piece.</li>
            <li>Horizontally or vertically.</li>
            <li>Only the king can land on a throne.</li>
        </ol>
        To move a piece, click on it and then on its landing square.<br/><br/>
        You're playing Dark, do the first move.`,aF.getInitialState(),oF.of(new CI(4,1),new CI(1,1)),$localize`Congratulations!`),nT.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new aF([[lF,lF,lF,uF,uF,uF,lF,lF,lF],[lF,lF,lF,lF,uF,lF,lF,lF,lF],[lF,lF,lF,lF,hF,lF,lF,lF,lF],[lF,lF,lF,uF,hF,lF,lF,lF,uF],[uF,uF,hF,hF,dF,hF,hF,uF,uF],[lF,lF,lF,lF,hF,lF,lF,lF,uF],[lF,lF,lF,lF,hF,lF,lF,lF,lF],[lF,lF,lF,lF,uF,lF,lF,lF,lF],[lF,lF,lF,uF,uF,uF,lF,lF,lF]],1),[oF.of(new CI(2,4),new CI(2,3)),oF.of(new CI(4,2),new CI(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),nT.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new aF([[lF,lF,lF,uF,uF,uF,lF,lF,lF],[lF,lF,lF,lF,uF,lF,lF,lF,lF],[lF,lF,lF,lF,hF,lF,lF,lF,lF],[lF,lF,hF,lF,dF,lF,hF,lF,uF],[uF,uF,lF,hF,lF,hF,hF,uF,uF],[lF,lF,lF,lF,hF,lF,lF,lF,uF],[lF,lF,lF,lF,hF,lF,lF,lF,lF],[lF,lF,lF,lF,uF,lF,lF,lF,lF],[lF,lF,lF,uF,uF,uF,lF,lF,lF]],12),[oF.of(new CI(1,4),new CI(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),nT.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough.
        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.
        This also works if the king is on the throne.<br/><br/>
        Capture the king.`,new aF([[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,uF,lF,lF,lF,lF,lF,lF,lF],[uF,dF,lF,uF,lF,lF,lF,lF,lF],[lF,uF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF]],72),[oF.of(new CI(3,4),new CI(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),nT.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board.
        Note that the king cannot be captured next to a throne.<br/><br/>
        Capture the king.`,new aF([[lF,lF,uF,dF,uF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,uF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF],[lF,lF,lF,lF,lF,lF,lF,lF,lF]],72),[oF.of(new CI(3,3),new CI(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function pF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",6),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("transform","translate("+e*n.SPACE_SIZE+" "+t*n.SPACE_SIZE+")")}}function gF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",7),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Cb("transform","translate("+e*n.SPACE_SIZE+" "+t*n.SPACE_SIZE+")")}}function mF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,pF,1,1,"polyline",4),r.Ac(2,gF,1,1,"ng-template",null,5,r.Bc),r.Pb()),2&e){const e=r.vc(3),t=r.fc().index,n=r.fc().index,i=r.fc();r.Bb(1),r.mc("ngIf",i.isCentralThrone(t,n))("ngIfElse",e)}}function yF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(2,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(3,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(4,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(5,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(2).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Pb()}if(2&e){const e=r.fc(2).index,t=r.fc().index,n=r.fc();r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.04*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.96*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.2*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.05*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.65*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.2*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.95*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.65*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.4*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.15*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.75*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.4*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.85*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.75*n.SPACE_SIZE)}}function vF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"polyline",13),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Pb()}if(2&e){const e=r.fc(3).index,t=r.fc().index,n=r.fc();r.Bb(1),r.Cb("points",n.getKingPolyline(e,t))}}function bF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(1,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(2,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Qb(3,"line",11),r.cc("click",function(){r.wc(e);const t=r.fc(3).index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb()}if(2&e){const e=r.fc(3).index,t=r.fc().index,n=r.fc();r.Cb("x1",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.04*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.5*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.96*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.04*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.5*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.96*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.5*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.15*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.15*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.85*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.85*n.SPACE_SIZE),r.Bb(1),r.Cb("x1",n.SPACE_SIZE*e+.85*n.SPACE_SIZE)("y1",n.SPACE_SIZE*t+.15*n.SPACE_SIZE)("x2",n.SPACE_SIZE*e+.15*n.SPACE_SIZE)("y2",n.SPACE_SIZE*t+.85*n.SPACE_SIZE)}}function _F(e,t){if(1&e&&(r.ec(),r.Ac(0,vF,2,1,"g",9),r.Ac(1,bF,4,16,"ng-template",null,12,r.Bc)),2&e){const e=r.vc(2),t=r.fc(2).index,n=r.fc().index,i=r.fc();r.mc("ngIf",i.isKing(t,n))("ngIfElse",e)}}function wF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"circle",8),r.cc("click",function(){r.wc(e);const t=r.fc().index,n=r.fc().index;return r.fc().onClick(t,n)}),r.Pb(),r.Ac(2,yF,6,20,"g",9),r.Ac(3,_F,3,2,"ng-template",null,10,r.Bc),r.Pb()}if(2&e){const e=r.vc(4),t=r.fc().index,n=r.fc().index,i=r.fc();r.Bb(1),r.mc("ngClass",i.getPieceClasses(t,n)),r.Cb("r",(i.SPACE_SIZE-i.STROKE_WIDTH)/2)("cx",i.SPACE_SIZE*t+.5*i.SPACE_SIZE)("cy",i.SPACE_SIZE*n+.5*i.SPACE_SIZE),r.Bb(1),r.mc("ngIf",i.isInvader(t,n))("ngIfElse",e)}}function CF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",2),r.cc("click",function(){r.wc(e);const n=t.index,i=r.fc().index;return r.fc().onClick(n,i)}),r.Pb(),r.Ac(2,mF,4,2,"g",3),r.Ac(3,wF,5,6,"g",3),r.Pb()}if(2&e){const e=t.index,n=r.fc().index,i=r.fc();r.Bb(1),r.oc("id","click_",e,"_",n,""),r.mc("ngClass",i.getRectClasses(e,n)),r.Cb("x",i.SPACE_SIZE*e)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),r.Bb(1),r.mc("ngIf",i.board[n][e]===i.NONE&&i.isThrone(e,n)),r.Bb(1),r.mc("ngIf",i.board[n][e]!==i.NONE)}}function EF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,CF,4,9,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function OF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",14),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n.x,n.y)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.oc("id","click_",e.x,"_",e.y,""),r.Cb("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let SF=(()=>{class e extends oA{constructor(e){super(e,!1,oF.from),this.rules=cF.get(),this.availableMinimaxes=[new sA(this.rules,"DummyBot"),new lA(this.rules,"Piece > Influence"),new uA(this.rules,"Piece > Control"),new hA(this.rules,"Escape > Piece > Control")],this.encoder=oF.encoder,this.tutorial=(new fF).tutorial,this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-tablut"]],features:[r.yb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,EF,2,1,"g",1),r.Ac(2,OF,2,6,"g",1),r.Pb()),2&e&&(r.Cb("viewBox",t.getViewBox()),r.Bb(1),r.mc("ngForOf",t.board),r.Bb(1),r.mc("ngForOf",t.getClickables()))},directives:[he,le,fe],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),PF=(()=>{class e{}return e.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,e.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,e.MISSING_CAPTURES=fM.MISSING_CAPTURES,e.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,e.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,e.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,e.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,e.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,e.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,e.AMBIGUOUS_CAPTURE_COORD=fM.AMBIGUOUS_CAPTURE_COORD,e.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`,e})(),IF=(()=>{class e{constructor(e,t){this.player=e,this.isRing=t}static of(t,n){return t===CS.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}equals(e){return this===e}flip(){return WO(!1===this.isRing,"cannot flip a ring (it should never happen)"),WO(this.player!==CS.NONE,"cannot flip a non-piece (it should never happen)"),e.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case e.NONE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return $O.expectToBe(this,e.RING_ONE),"RING_ONE"}}}return e.encoder=YO.tuple([CS.numberEncoder,YO.booleanEncoder],e=>[e.player,e.isRing],t=>e.of(t[0],t[1])),e.NONE=new e(CS.NONE,!1),e.EMPTY=new e(CS.NONE,!1),e.MARKER_ZERO=new e(CS.ZERO,!1),e.MARKER_ONE=new e(CS.ONE,!1),e.MARKERS=[e.MARKER_ZERO,e.MARKER_ONE],e.RING_ZERO=new e(CS.ZERO,!0),e.RING_ONE=new e(CS.ONE,!0),e.RINGS=[e.RING_ZERO,e.RING_ONE],e})(),TF=(()=>{class e extends Zk{constructor(t,n,r){super(r,t,e.SIZE,e.SIZE,[6,4,3,2,1],IF.EMPTY),this.sideRings=n}static getInitialState(){const t=IF.EMPTY,n=IF.NONE;return new e([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&cS.compareTable(this.board,e.board)}getRingCoords(e){const t=[];return this.forEachCoord((n,r)=>{r.isRing&&r.player===e&&t.push(n)}),t}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==IF.NONE}setAtUnsafe(t,n){const r=cS.copyBiArray(this.board);return r[t.y][t.x]=n,new e(r,this.sideRings,this.turn)}}return e.SIZE=11,e})(),AF=(()=>{class e extends lM{constructor(e,t){if(super(e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=XO.ofNullable(t)}static of(t,n,r){const i=[],o=kI.factory.fromMove(t,n).get();for(let e=t;!1===e.equals(n);e=e.getNext(o))i.push(e);return i.push(n),new e(i,r)}setRingTaken(t){return new e(this.capturedSpaces,t)}equals(e){return!1!==super.equals(e)&&!1!==this.ringTaken.equals(e.ringTaken)}}return e.encoder=new class extends ZO{encode(e){return{captured:e.capturedSpaces.map(e=>CI.encoder.encode(e)),ringTaken:CI.encoder.encode(e.ringTaken.get())}}decode(t){const n=t;return WO(null!=n.captured&&null!=n.ringTaken,"Invalid encoded YinshCapture"),new e(n.captured.map(e=>CI.encoder.decode(e)),CI.encoder.decode(n.ringTaken))}},e})(),kF=(()=>{class e extends HI{constructor(e,t,n,r){super(),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=r}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!1!==this.start.equals(e.start)&&!1!==this.end.equals(e.end)&&!1!==cS.compareArray(this.initialCaptures,e.initialCaptures)&&!1!==cS.compareArray(this.finalCaptures,e.finalCaptures)}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}return e.coordOptionalEncoder=XO.encoder(CI.encoder),e.encoder=new class extends QO{encodeMove(t){const n={moveStart:CI.encoder.encode(t.start),moveEnd:e.coordOptionalEncoder.encode(t.end)};return t.initialCaptures.map((e,t)=>{n["initialCapture"+t]=AF.encoder.encode(e)}),t.finalCaptures.map((e,t)=>{n["finalCapture"+t]=AF.encoder.encode(e)}),n}decodeMove(t){const n=t;return WO(null!=n.moveStart,"Invalid encoded YinshMove"),new e(this.decodeArray(n,"initialCapture",AF.encoder.decode),CI.encoder.decode(n.moveStart),e.coordOptionalEncoder.decode(n.moveEnd),this.decodeArray(n,"finalCapture",AF.encoder.decode))}decodeArray(e,t,n){const r=[];for(let i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}},e})();class NF extends LI{getBoardValue(e){const t=this.ruler.getGameStatus(e);return t.isEndGame?BI.fromWinner(t.winner):new BI(e.gameState.sideRings[0]*CS.ZERO.getScoreModifier()+e.gameState.sideRings[1]*CS.ONE.getScoreModifier())}getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const[r,i]of n.getCoordsAndContents())i===IF.EMPTY&&t.push(new kF([],r,XO.empty(),[]));else{const e=this.ruler;this.getPossibleCaptureCombinations(n).forEach(r=>{const i=e.applyCaptures(n,r);this.getRingMoves(i).forEach(n=>{const o=e.applyRingMoveAndFlip(i,n.start,n.end);this.getPossibleCaptureCombinations(o).forEach(e=>{const i=new kF(r,n.start,XO.of(n.end),e);t.push(i)})})})}return t}getPossibleCaptureCombinations(e){const t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return gM.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(e=>class{static getCombinations(e,t){return WO(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(e=>this.getPermutations(e)).reduce((e,t)=>e.concat(t))}static getPermutations(e){const t=e.length,n=[e.slice()],r=new Array(t).fill(0);let i=1;for(;i<t;)if(r[i]<i){const t=i%2&&r[i],o=e[i];e[i]=e[t],e[t]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}static getSubsetsOfSize(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];{const i=[];for(;r<=e.length-n;){const o=e[r];for(const e of t(n-1,r+1))e.push(o),i.push(e);++r}return i}}(t,0)}}.getCombinations(n,e.length).map(t=>e.map((e,n)=>new AF(e.capturedSpaces,t[n])))).reduce((e,t)=>e.concat(t),[])}getRingMoves(e){const t=this.ruler,n=[];for(const r of this.getRingCoords(e))for(const i of t.getRingTargets(e,r))n.push({start:r,end:i});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((e,r)=>{r===IF.RINGS[t]&&n.push(e)}),n}}class MF extends JI{applyLegalMove(e,t,n){return new TF(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=e;return t.forEach(e=>{n=this.applyCapture(n,e)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new TF(n,e.sideRings,e.turn),t.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,r=e.setAt(t,IF.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new TF(r,i,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(t=>{e=e.setAt(t,IF.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===IF.RINGS[n]?aS.SUCCESS:aS.failure(PF.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const r=e.getCurrentPlayer().value;let i=e.setAt(t,IF.MARKERS[r]);i=i.setAt(n,IF.RINGS[r]);const o=kI.factory.fromMove(t,n).get();for(let s=t.getNext(o);!1===s.equals(n);s=s.getNext(o)){const e=i.getPieceAt(s);e!==IF.EMPTY&&(i=i.setAt(s,e.flip()))}return i}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return iS.failure(PF.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();const r=this.applyCaptures(t,e.initialCaptures),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();const o=this.applyRingMoveAndFlip(r,e.start,e.end.get()),s=this.capturesValidity(o,e.finalCaptures);if(s.isFailure())return s.toFailedFallible();const a=this.applyCaptures(o,e.finalCaptures),c=this.noMoreCapturesValidity(a);return c.isFailure()?c.toFailedFallible():iS.success(a)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return iS.failure(PF.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==IF.EMPTY)return iS.failure(DI.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;const i=e.setAt(t,IF.of(n,!0)).board,o=new TF(i,r,e.turn);return iS.success(o)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==IF.RINGS[n]?aS.failure(PF.SHOULD_SELECT_PLAYER_RING()):aS.SUCCESS}moveValidity(e,t,n){const r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==IF.EMPTY)return aS.failure(PF.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=kI.factory.fromMove(t,n);if(i.isFailure())return aS.failure(PF.MOVE_DIRECTION_INVALID());const o=i.get();let s=!1;for(let a=t.getNext(o);!1===a.equals(n);a=a.getNext(o)){const t=e.getPieceAt(a);if(t===IF.EMPTY){if(s)return aS.failure(PF.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(t.isRing)return aS.failure(PF.MOVE_SHOULD_NOT_PASS_ABOVE_RING());s=!0}}return aS.SUCCESS}capturesValidity(e,t){let n=e;for(const r of t){const e=this.captureValidity(n,r);if(e.isFailure())return e;n=this.applyCapture(n,r)}return aS.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const r of t.capturedSpaces)if(e.getPieceAt(r)!==IF.MARKERS[n])return aS.failure(PF.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==IF.RINGS[n]?aS.failure(PF.CAPTURE_SHOULD_TAKE_RING()):aS.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?aS.SUCCESS:aS.failure(PF.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(r=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,r);i.isPresent()&&n.push(i.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let r=0;const i=e.getEntranceOnLine(n),o=n.getDirection();let s,a=i;for(s=i;e.isOnBoard(s);s=s.getNext(o)){const n=e.getPieceAt(s);if(n.player===t&&!1===n.isRing)0===r&&(a=s),r+=1;else{if(r>=5)break;r=0}}return r>=5?XO.of({start:a,end:s,dir:o}):XO.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(e=>{for(let t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(AF.of(t,t.getNext(e.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const r of kI.factory.all){let i=!1;for(let o=t.getNext(r);e.isOnBoard(o);o=o.getNext(r)){const t=e.getPieceAt(o);if(t===IF.EMPTY){if(n.push(o),i)break}else{if(t.isRing)break;i=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?KI.ONGOING:e.gameState.sideRings[0]>=3?KI.ZERO_WON:e.gameState.sideRings[1]>=3?KI.ONE_WON:KI.ONGOING}}const xF=IF.EMPTY,RF=IF.NONE,DF=IF.MARKER_ZERO,LF=IF.RING_ZERO,BF=IF.MARKER_ONE,FF=IF.RING_ONE;let jF=(()=>{class e{}return e.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,e.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,e})();class UF{constructor(){this.tutorial=[nT.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new TF([[RF,RF,RF,RF,RF,RF,xF,xF,xF,xF,RF],[RF,RF,RF,RF,xF,xF,xF,xF,xF,xF,xF],[RF,RF,RF,DF,FF,xF,xF,xF,xF,xF,xF],[RF,RF,xF,DF,xF,FF,xF,BF,xF,xF,xF],[RF,xF,LF,BF,xF,xF,FF,DF,xF,xF,xF],[RF,xF,xF,DF,BF,xF,xF,xF,xF,xF,RF],[xF,xF,xF,DF,xF,xF,xF,FF,xF,xF,RF],[xF,xF,xF,BF,DF,LF,xF,xF,xF,RF,RF],[xF,xF,xF,xF,xF,xF,xF,xF,RF,RF,RF],[xF,xF,xF,xF,xF,xF,xF,RF,RF,RF,RF],[RF,xF,xF,xF,xF,RF,RF,RF,RF,RF,RF]],[3,1],20)),nT.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.
        Put one of your ring on the board by clicking the space where you want to place it.`,new TF(TF.getInitialState().board,[5,5],0),new kF([],new CI(5,5),XO.empty(),[]),$localize`Congratulations!`),nT.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new TF([[RF,RF,RF,RF,RF,RF,xF,xF,xF,xF,RF],[RF,RF,RF,RF,xF,xF,xF,xF,xF,xF,xF],[RF,RF,RF,FF,xF,xF,xF,xF,xF,xF,xF],[RF,RF,FF,xF,xF,FF,xF,xF,xF,xF,xF],[RF,xF,LF,BF,xF,xF,FF,xF,xF,xF,xF],[RF,xF,xF,BF,xF,xF,xF,xF,xF,xF,RF],[xF,xF,xF,xF,LF,xF,xF,FF,xF,xF,RF],[xF,xF,xF,xF,xF,LF,xF,xF,xF,RF,RF],[xF,xF,xF,LF,xF,xF,xF,RF,RF,RF,RF],[xF,xF,xF,xF,xF,xF,xF,RF,RF,RF,RF],[RF,xF,xF,xF,xF,RF,RF,RF,RF,RF,RF]],[0,0],20),new kF([],new CI(2,4),XO.of(new CI(4,4)),[]),$localize`Congratulations!`),nT.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new TF([[RF,RF,RF,RF,RF,RF,xF,xF,xF,xF,RF],[RF,RF,RF,RF,xF,xF,xF,xF,xF,xF,xF],[RF,RF,RF,FF,xF,xF,xF,xF,xF,xF,xF],[RF,RF,FF,xF,xF,FF,xF,xF,xF,xF,xF],[RF,xF,DF,DF,LF,BF,BF,xF,xF,xF,xF],[RF,xF,xF,FF,xF,xF,xF,xF,xF,xF,RF],[xF,xF,xF,xF,LF,xF,xF,FF,xF,xF,RF],[xF,xF,xF,xF,xF,LF,xF,xF,xF,RF,RF],[xF,xF,xF,LF,xF,xF,xF,LF,RF,RF,RF],[xF,xF,xF,xF,xF,xF,xF,RF,RF,RF,RF],[RF,xF,xF,xF,xF,RF,RF,RF,RF,RF,RF]],[0,0],20),new kF([],new CI(4,4),XO.of(new CI(7,4)),[AF.of(new CI(2,4),new CI(6,4),new CI(7,4))]),(e,t)=>1===t.sideRings[CS.ZERO.value]?aS.SUCCESS:aS.failure(jF.MUST_ALIGN_FIVE()),$localize`Congratulations!`),nT.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, you can capture two rings, do it!`,new TF([[RF,RF,RF,RF,RF,RF,xF,xF,xF,xF,RF],[RF,RF,RF,RF,LF,xF,xF,FF,FF,LF,xF],[RF,RF,RF,LF,xF,xF,BF,FF,xF,LF,xF],[RF,RF,xF,LF,xF,xF,xF,xF,xF,FF,xF],[RF,xF,xF,xF,xF,DF,xF,xF,FF,xF,xF],[RF,xF,xF,xF,DF,DF,xF,BF,xF,xF,RF],[xF,xF,xF,DF,xF,DF,xF,xF,xF,xF,RF],[xF,xF,DF,xF,xF,DF,xF,xF,xF,RF,RF],[xF,DF,xF,xF,xF,DF,xF,xF,RF,RF,RF],[xF,xF,xF,xF,xF,DF,xF,RF,RF,RF,RF],[RF,xF,xF,xF,xF,RF,RF,RF,RF,RF,RF]],[0,0],10),new kF([AF.of(new CI(5,4),new CI(1,8),new CI(3,2)),AF.of(new CI(5,9),new CI(5,5),new CI(3,3))],new CI(4,1),XO.of(new CI(4,2)),[]),(e,t)=>2===t.sideRings[CS.ZERO.value]?aS.SUCCESS:aS.failure(jF.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function VF(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",9)),2&e){const e=r.fc(2).$implicit,t=r.fc(2);r.Cb("cx",e.center.x)("cy",e.center.y)("r",t.viewInfo.ringOuterSize)}}function zF(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",10)),2&e){const e=r.fc(2),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.oc("id","ring_",t,"_",i,""),r.mc("ngClass",n.ringClasses),r.Cb("cx",n.center.x)("cy",n.center.y)("r",o.viewInfo.ringMidSize)}}function HF(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",9)),2&e){const e=r.fc(2).$implicit,t=r.fc(2);r.Cb("cx",e.center.x)("cy",e.center.y)("r",t.viewInfo.ringInnerSize)}}function GF(e,t){if(1&e&&(r.ec(),r.Mb(0,"circle",11)),2&e){const e=r.fc(2),t=e.index,n=e.$implicit,i=r.fc().index,o=r.fc();r.oc("id","marker_",t,"_",i,""),r.mc("ngClass",n.markerClasses),r.Cb("cx",n.center.x)("cy",n.center.y)("r",o.viewInfo.markerSize)}}function $F(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g",3),r.cc("click",function(){r.wc(e);const t=r.fc().$implicit;return r.fc(2).onClick(t.coord)}),r.Mb(1,"polyline",4),r.Qb(2,"g",5),r.Ac(3,VF,1,3,"circle",6),r.Ac(4,zF,1,6,"circle",7),r.Ac(5,HF,1,3,"circle",6),r.Ac(6,GF,1,6,"circle",8),r.Pb(),r.Pb()}if(2&e){const e=r.fc(),t=e.index,n=e.$implicit,i=r.fc().index;r.oc("id","click_",t,"_",i,""),r.Bb(1),r.oc("id","space_",t,"_",i,""),r.mc("ngClass",n.spaceClasses),r.Cb("points",n.coordinates),r.Bb(1),r.oc("id","pieceGroup_",t,"_",i,""),r.mc("ngClass",n.removedClass),r.Bb(1),r.mc("ngIf",n.isRing),r.Bb(1),r.mc("ngIf",n.isRing),r.Bb(1),r.mc("ngIf",n.isRing),r.Bb(1),r.mc("ngIf",n.isMarker)}}function qF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,$F,7,13,"g",2),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngIf",null!=e)}}function WF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,qF,2,1,"g",1),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}function ZF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"polyline",12),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.oc("id","selected_",e.x,"_",e.y,""),r.Cb("points",n.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function QF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"polyline",14),r.cc("click",function(){r.wc(e);const t=r.fc().$implicit;return r.fc().onClick(t)}),r.Pb()}if(2&e){const e=r.fc().$implicit,t=r.fc();r.oc("id","selectable_",e.x,"_",e.y,""),r.Cb("points",t.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function YF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,QF,1,3,"polyline",13),r.Pb()),2&e){const e=r.fc();r.Bb(1),r.mc("ngIf",e.isPlayerTurn())}}function KF(e,t){if(1&e){const e=r.Rb();r.ec(),r.Qb(0,"g"),r.Qb(1,"rect",15),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc().onClick(n)}),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.Cb("x",n.viewInfo.spaceInfo[e.y][e.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[e.y][e.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function JF(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Mb(1,"circle",16),r.Mb(2,"circle",9),r.Mb(3,"circle",17),r.Pb()),2&e){const e=t.index,n=r.fc().$implicit,i=r.fc();r.Bb(1),r.oc("id","player_",n,"_sideRing_",e+1,""),r.Cb("cx",(0===n?0:1050)+1.2*(0===n?1:-1)*i.viewInfo.ringOuterSize*(e+1))("cy",0===n?300:1260)("r",i.viewInfo.ringOuterSize),r.Bb(1),r.Cb("cx",(0===n?0:1050)+1.2*(0===n?1:-1)*i.viewInfo.ringOuterSize*(e+1))("cy",0===n?300:1260)("r",i.viewInfo.ringInnerSize),r.Bb(1),r.mc("ngClass",i.viewInfo.sideRingClass[n]),r.Cb("cx",(0===n?0:1050)+1.2*(0===n?1:-1)*i.viewInfo.ringOuterSize*(e+1))("cy",0===n?300:1260)("r",i.viewInfo.ringMidSize)}}const XF=function(){return[]};function ej(e,t){if(1&e&&(r.ec(),r.Qb(0,"g"),r.Ac(1,JF,4,12,"g",1),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.Bb(1),r.mc("ngForOf",r.qc(1,XF).constructor(n.viewInfo.sideRings[e]))}}const tj=function(){return[0,1]};let nj=(()=>{class e extends PI{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=XO.empty(),this.moveEnd=XO.empty(),this.currentlyMoved=[],this.currentCapture=XO.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:e.MARKER_SIZE,ringOuterSize:e.RING_OUTER_SIZE,ringMidSize:e.RING_MID_SIZE,ringInnerSize:e.RING_INNER_SIZE,indicatorSize:e.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=XO.of([0,0]),this.rules=new MF(TF),this.availableMinimaxes=[new NF(this.rules,"YinshMinimax")],this.encoder=kF.encoder,this.tutorial=(new UF).tutorial,this.hexaLayout=new NI(1.5*e.RING_OUTER_SIZE,new CI(2*e.RING_OUTER_SIZE,0),RI.INSTANCE),this.constructedState=this.rules.node.gameState,this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaCoordsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt(),this.scores=XO.of(this.rules.node.gameState.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of[CS.ZERO,CS.ONE])this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved"]:[]}setRingInfo(e,t){if(t.isRing){const n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==IF.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){const n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}cancelMoveAttempt(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=XO.empty(),this.moveStart=XO.empty(),this.moveEnd=XO.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const e=this.rules.node.move;if(e.isPresent()){const t=e.get();if(t.isInitialPlacement())this.viewInfo.spaceInfo[t.start.y][t.start.x].spaceClasses=["moved"];else{for(const n of this.coordsBetween(t.start,t.end.get()))this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["moved"];const e=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();t.initialCaptures.forEach(t=>this.showLastMoveCapture(t,e)),t.finalCaptures.forEach(t=>this.showLastMoveCapture(t,e))}}}coordsBetween(e,t){const n=[],r=kI.factory.fromMove(e,t).get();for(let i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==IF.EMPTY&&n.push(i),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured"],t&&this.markRemovedMarker(n,this.rules.node.gameState.getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),aS.SUCCESS}onClick(e){var t=this;return GO(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return GO(function*(){const n=[];if(t.possibleCaptures.forEach(t=>{t.contains(e)&&n.push(t)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(PF.MISSING_CAPTURES());t.selectCapture(n[0])}return aS.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);switch(this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":this.movePhase="INITIAL_CAPTURE_SELECT_LAST";break;case"FINAL_CAPTURE_SELECT_FIRST":this.movePhase="FINAL_CAPTURE_SELECT_LAST"}}selectCaptureLastCoord(e){var t=this;return GO(function*(){const n=[];return t.possibleCaptures.forEach(t=>{t.contains(e)&&n.push(t)}),n.length>1?t.cancelMove(PF.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(PF.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){switch(this.currentCapture=XO.of(e),this.constructedState=new TF(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":this.movePhase="INITIAL_CAPTURE_SELECT_RING";break;case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.movePhase="FINAL_CAPTURE_SELECT_RING"}return this.updateViewInfo(),aS.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.rules.node.gameState.getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setMarkerInfo(e,IF.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setRingInfo(e,IF.RINGS[t.value])}selectRing(e){var t=this;return GO(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const r=t.currentCapture.get().setRingTaken(e);switch(t.currentCapture=XO.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase){case"INITIAL_CAPTURE_SELECT_RING":return t.initialCaptures.push(r),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),aS.SUCCESS);default:return $O.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(r),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),aS.SUCCESS)}})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),aS.SUCCESS}tryMove(){var e=this;return GO(function*(){const t=new kF(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t,e.rules.node.gameState,e.scores.get())})()}selectMoveStart(e){var t=this;return GO(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=XO.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=XO.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return aS.SUCCESS})()}selectMoveEnd(e){var t=this;return GO(function*(){const n=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveEnd=XO.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.constructedState,t.moveStart.get(),e),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return GO(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),aS.SUCCESS)})()}}return e.RING_OUTER_SIZE=40,e.RING_MID_SIZE=34,e.RING_INNER_SIZE=28,e.MARKER_SIZE=e.RING_INNER_SIZE,e.INDICATOR_SIZE=10,e.\u0275fac=function(t){return new(t||e)(r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-yinsh"]],features:[r.yb],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(r.ec(),r.Qb(0,"svg",0),r.Ac(1,WF,2,1,"g",1),r.Ac(2,ZF,2,3,"g",1),r.Ac(3,YF,2,1,"g",1),r.Ac(4,KF,2,4,"g",1),r.Ac(5,ej,2,2,"g",1),r.Pb()),2&e&&(r.Bb(1),r.mc("ngForOf",t.viewInfo.spaceInfo),r.Bb(1),r.mc("ngForOf",t.viewInfo.selectedCoords),r.Bb(1),r.mc("ngForOf",t.viewInfo.selectableCoords),r.Bb(1),r.mc("ngForOf",t.viewInfo.targets),r.Bb(1),r.mc("ngForOf",r.qc(5,tj)))},directives:[he,fe,le],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();function rj(e,t){if(1&e&&(r.Qb(0,"option",5),r.Cc(1),r.Pb()),2&e){const e=t.$implicit;r.mc("value",e),r.Bb(1),r.Dc(e)}}let ij=(()=>{class e{}return e.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,e.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,e.AWALE=()=>$localize`The international version of the famous African strategy game!`,e.BRANDHUB=()=>$localize`The Irish version of the Tafl game family!`,e.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,e.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,e.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,e.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,e.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,e.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,e.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,e.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,e.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,e.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,e.P4=()=>$localize`The classical 4 in a row game!`,e.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,e.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,e.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,e.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,e.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,e.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,e.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,e.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,e.TABLUT=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,e.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,e})(),oj=(()=>{class e{constructor(e,t,n,r,i,o=!0){this.name=e,this.urlName=t,this.component=n,this.creationDate=r,this.description=i,this.display=o}}return e.ALL_GAMES=()=>[new e("MinimaxTesting","MinimaxTesting",lR,new Date("1970-01-01"),"",!1),new e($localize`Four in a Row`,"P4",OR,new Date("2018-08-28"),ij.P4()),new e($localize`Awalé`,"Awale",WT,new Date("2018-11-29"),ij.AWALE()),new e($localize`Quarto`,"Quarto",iL,new Date("2018-12-09"),ij.QUARTO()),new e($localize`Tablut`,"Tablut",SF,new Date("2018-12-27"),ij.TABLUT()),new e($localize`Reversi`,"Reversi",xL,new Date("2019-01-16"),ij.REVERSI()),new e($localize`Go`,"Go",ox,new Date("2019-12-21"),ij.GO()),new e($localize`Encapsule`,"Encapsule",qN,new Date("2019-12-30"),ij.ENCAPSULE()),new e($localize`Siam`,"Siam",DB,new Date("2020-01-11"),ij.SIAM()),new e($localize`Sahara`,"Sahara",JL,new Date("2020-02-29"),ij.SAHARA()),new e($localize`Pylos`,"Pylos",fD,new Date("2020-10-02"),ij.PYLOS()),new e($localize`Kamisado`,"Kamisado",Fx,new Date("2020-10-03"),ij.KAMISADO()),new e($localize`Quixo`,"Quixo",bL,new Date("2020-10-15"),ij.QUIXO()),new e($localize`Dvonn`,"Dvonn",CN,new Date("2020-10-21"),ij.DVONN()),new e($localize`Epaminondas`,"Epaminondas",cM,new Date("2021-01-16"),ij.EPAMINONDAS()),new e($localize`Gipf`,"Gipf",NM,new Date("2021-02-22"),ij.GIPF()),new e($localize`Coerceo`,"Coerceo",ik,new Date("2021-03-21"),ij.COERCEO()),new e($localize`Six`,"Six",iF,new Date("2021-04-08"),ij.SIX()),new e($localize`Lines of Action`,"LinesOfAction",Jx,new Date("2021-04-28"),ij.LINES_OF_ACTION()),new e($localize`Pentago`,"Pentago",GR,new Date("2021-05-23"),ij.PENTAGO()),new e($localize`Abalone`,"Abalone",wT,new Date("2021-07-13"),ij.ABALONE()),new e($localize`Yinsh`,"Yinsh",nj,new Date("2021-07-31"),ij.YINSH()),new e($localize`Apagos`,"Apagos",LT,new Date("2021-11-04"),ij.APAGOS()),new e($localize`Diam`,"Diam",qk,new Date("2021-11-30"),ij.DIAM()),new e($localize`Brandhub`,"Brandhub",TA,new Date("2021-12-07"),ij.BRANDHUB()),new e($localize`Conspirateurs`,"Conspirateurs",Sk,new Date("2021-12-30"),ij.CONSPIRATEURS())].sort((e,t)=>e.name.localeCompare(t.name)),e})(),sj=(()=>{class e{constructor(){this.gameNameList=oj.ALL_GAMES().filter(e=>!0===e.display).map(e=>e.urlName),this.pickGame=new r.n}onChange(e){this.pickGame.emit(e.target.value)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let e;return e=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],e,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"select",1),r.cc("change",function(e){return t.onChange(e)}),r.Qb(2,"option",2),r.Ub(3,3),r.Pb(),r.Ac(4,rj,2,2,"option",4),r.Pb(),r.Pb()),2&e&&(r.Bb(4),r.mc("ngForOf",t.gameNameList))},directives:[In,Nn,he],encapsulation:2}),e})();function aj(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",25),r.Qb(1,"div",26),r.cc("click",function(){return r.wc(e),r.fc().closeInfo()}),r.Pb(),r.Qb(2,"div",27),r.Qb(3,"header",28),r.Qb(4,"p",29),r.Cc(5),r.Pb(),r.Qb(6,"button",30),r.cc("click",function(){return r.wc(e),r.fc().closeInfo()}),r.Pb(),r.Pb(),r.Qb(7,"section",31),r.Qb(8,"div",6),r.Qb(9,"div",32),r.Qb(10,"p",33),r.Mb(11,"img",34),r.Pb(),r.Pb(),r.Qb(12,"div",7),r.Qb(13,"div",13),r.Cc(14),r.Pb(),r.Pb(),r.Pb(),r.Qb(15,"div",6),r.Qb(16,"div",32),r.Qb(17,"a",35),r.cc("click",function(){r.wc(e);const t=r.fc();return t.createGame(t.gameInfoDetails.get().urlName)}),r.Mb(18,"fa-icon",36),r.Cc(19,"\xa0"),r.Qb(20,"span"),r.Ub(21,37),r.Pb(),r.Pb(),r.Pb(),r.Qb(22,"div",32),r.Qb(23,"a",35),r.cc("click",function(){r.wc(e);const t=r.fc();return t.createLocalGame(t.gameInfoDetails.get().urlName)}),r.Mb(24,"fa-icon",36),r.Cc(25,"\xa0"),r.Qb(26,"span"),r.Ub(27,38),r.Pb(),r.Pb(),r.Pb(),r.Qb(28,"div",32),r.Qb(29,"a",35),r.cc("click",function(){r.wc(e);const t=r.fc();return t.createTutorial(t.gameInfoDetails.get().urlName)}),r.Mb(30,"fa-icon",36),r.Cc(31,"\xa0"),r.Qb(32,"span"),r.Ub(33,39),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=r.fc();r.Bb(5),r.Dc(e.gameInfoDetails.get().name),r.Bb(6),r.oc("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",r.yc),r.Bb(3),r.Ec(" ",e.gameInfoDetails.get().description," "),r.Bb(4),r.mc("icon",e.iconOnlineGame),r.Bb(6),r.mc("icon",e.iconLocalGame),r.Bb(6),r.mc("icon",e.iconTutorial)}}function cj(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",8),r.Qb(1,"div",9),r.Qb(2,"p",10),r.Cc(3),r.Pb(),r.Pb(),r.Qb(4,"div",41),r.Qb(5,"figure",33),r.Qb(6,"img",42),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).openInfo(n)}),r.Pb(),r.Qb(7,"figcaption",43),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).openInfo(n)}),r.Qb(8,"div",44),r.Cc(9,"?"),r.Pb(),r.Pb(),r.Qb(10,"figcaption",45),r.Qb(11,"a",46),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).createGame(n.urlName)}),r.Mb(12,"fa-icon",36),r.Pb(),r.Qb(13,"a",47),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).createLocalGame(n.urlName)}),r.Mb(14,"fa-icon",36),r.Pb(),r.Qb(15,"a",48),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).createTutorial(n.urlName)}),r.Mb(16,"fa-icon",36),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(17,"div",49),r.Cc(18),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(2);r.Bb(3),r.Dc(e.name),r.Bb(3),r.nc("id","image_",e.urlName,""),r.oc("src","assets/images/",n.theme,"/",e.urlName,".png",r.yc),r.Bb(5),r.nc("id","playOnline_",e.urlName,""),r.Bb(1),r.mc("icon",n.iconOnlineGame),r.Bb(1),r.nc("id","playLocally_",e.urlName,""),r.Bb(1),r.mc("icon",n.iconLocalGame),r.Bb(1),r.nc("id","startTutorial_",e.urlName,""),r.Bb(1),r.mc("icon",n.iconTutorial),r.Bb(2),r.Ec(" ",e.description," ")}}function lj(e,t){if(1&e&&(r.Qb(0,"div",7),r.Ac(1,cj,19,11,"div",40),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngForOf",e)}}let uj=(()=>{class e{constructor(e,t){this.router=e,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=LS,this.iconLocalGame=RS,this.iconTutorial=MS,this.gameInfoDetails=XO.empty(),this.theme=t.getTheme();const n=oj.ALL_GAMES().filter(e=>!0===e.display);let r=0;for(let i=0;i<n.length;i++)i<this.numberOfColumns&&this.games.push([]),this.games[r].push(n[i]),r=(r+1)%this.numberOfColumns}createGame(e){var t=this;return GO(function*(){return t.router.navigate(["/play",e])})()}createLocalGame(e){return this.router.navigate(["/local",e])}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=XO.of(e)}closeInfo(){this.gameInfoDetails=XO.empty()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(NS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let e,t,n,r,i,o,s,a,c,l,u,h,d,f;return e=$localize`EveryBoard`,t=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,n=$localize`Play online`,r=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,s=$localize`Play`,a=$localize`Learn`,c=$localize`Play online`,l=$localize`Play offline`,u=$localize`Learn the rules`,h=$localize`Play online`,d=$localize`Play offline`,f=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],e,[1,"subtitle"],t,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],n,[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],r,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],s,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],a,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],c,l,u,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",h,1,"button",3,"id","click"],["data-tooltip",d,1,"button",3,"id","click"],["data-tooltip",f,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(r.Qb(0,"section",0),r.Qb(1,"div",1),r.Qb(2,"p",2),r.Ub(3,3),r.Pb(),r.Qb(4,"p",4),r.Yb(5,5),r.Mb(6,"br"),r.Wb(),r.Pb(),r.Pb(),r.Qb(7,"div",6),r.Qb(8,"div",7),r.Qb(9,"div",8),r.Qb(10,"header",9),r.Qb(11,"p",10),r.Ub(12,11),r.Pb(),r.Pb(),r.Qb(13,"div",12),r.Qb(14,"div",13),r.Qb(15,"button",14),r.Ub(16,15),r.Pb(),r.Qb(17,"button",16),r.Ub(18,17),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(19,"div",7),r.Qb(20,"div",8),r.Qb(21,"header",9),r.Qb(22,"p",10),r.Ub(23,18),r.Pb(),r.Pb(),r.Qb(24,"div",12),r.Qb(25,"div",13),r.Qb(26,"button",19),r.Ub(27,20),r.Pb(),r.Qb(28,"button",21),r.Ub(29,22),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Ac(30,aj,34,7,"div",23),r.Qb(31,"div",6),r.Ac(32,lj,2,1,"div",24),r.Pb(),r.Pb()),2&e&&(r.Bb(30),r.mc("ngIf",t.gameInfoDetails.isPresent()),r.Bb(2),r.mc("ngForOf",t.games))},directives:[Ws,fe,he,tI],encapsulation:2}),e})(),hj=(()=>{class e{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.l))},e.\u0275dir=r.Gb({type:e,selectors:[["","autofocus",""]]}),e})(),dj=(()=>{class e{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",e=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(r.l))},e.\u0275dir=r.Gb({type:e,selectors:[["","toggleVisibility",""]]}),e})();function fj(e,t){if(1&e&&(r.Qb(0,"div",29),r.Qb(1,"div",30),r.Ub(2,31),r.Pb(),r.Qb(3,"div",32),r.Cc(4),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(4),r.Dc(e.errorMessage)}}const pj=function(){return["/register"]},gj=function(){return["/reset-password"]};let mj=(()=>{class e{constructor(e,t){this.router=e,this.authenticationService=t,this.faEye=DS,this.loginForm=new an({email:new sn,password:new sn})}ngOnInit(){var e=this;this.authenticationService.getUserObs().subscribe(function(){var t=GO(function*(t){t!==yS.NOT_CONNECTED&&(yield e.redirect())});return function(e){return t.apply(this,arguments)}}())}loginWithEmail(e){var t=this;return GO(function*(){const n=yield t.authenticationService.doEmailLogin(e.email,e.password);n.isFailure()&&(t.errorMessage=n.getReason())})()}loginWithGoogle(){var e=this;return GO(function*(){const t=yield e.authenticationService.doGoogleLogin();t.isFailure()&&(e.errorMessage=t.getReason())})()}redirect(){var e=this;return GO(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return""!==(this.loginForm.value.email||"")&&""!==(this.loginForm.value.password||"")}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(vS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let e,t,n,r,i,o,s,a,c,l,u,h;return e=$localize`Log in`,t=$localize`Email`,n=$localize`Email`,r=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,s=$localize`Log in with Google`,a=$localize`No account?`,c=$localize`Register`,l=$localize`Forgot your password?`,u=$localize`Reset your password`,h=$localize`Connection error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",n,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],r,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],s,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],a,[3,"routerLink"],c,l,u,["role","alert",1,"message","is-danger"],[1,"message-header"],h,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"p",1),r.Ub(2,2),r.Pb(),r.Qb(3,"form",3),r.Qb(4,"div",4),r.Qb(5,"div",5),r.Qb(6,"label",6),r.Ub(7,7),r.Pb(),r.Pb(),r.Qb(8,"div",8),r.Qb(9,"div",9),r.Qb(10,"div",10),r.Mb(11,"input",11),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(12,"div",4),r.Qb(13,"div",5),r.Qb(14,"label",12),r.Ub(15,13),r.Pb(),r.Pb(),r.Qb(16,"div",8),r.Qb(17,"div",9),r.Qb(18,"div",14),r.Mb(19,"input",15),r.Qb(20,"span",16),r.Mb(21,"fa-icon",17),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(22,"div",4),r.Mb(23,"div",5),r.Qb(24,"div",8),r.Qb(25,"div",9),r.Qb(26,"div",10),r.Qb(27,"button",18),r.cc("click",function(){return t.loginWithEmail(t.loginForm.value)}),r.Ub(28,19),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(29,"div",4),r.Mb(30,"div",5),r.Qb(31,"div",8),r.Qb(32,"div",9),r.Qb(33,"div",10),r.Qb(34,"button",20),r.cc("click",function(){return t.loginWithGoogle()}),r.Ub(35,21),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Ac(36,fj,5,1,"div",22),r.Qb(37,"p",23),r.Ob(38),r.Ub(39,24),r.Nb(),r.Cc(40,"\xa0 "),r.Qb(41,"a",25),r.Ub(42,26),r.Pb(),r.Pb(),r.Qb(43,"p",23),r.Ob(44),r.Ub(45,27),r.Nb(),r.Cc(46,"\xa0 "),r.Qb(47,"a",25),r.Ub(48,28),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.Bb(3),r.mc("formGroup",t.loginForm),r.Bb(18),r.mc("icon",t.faEye),r.Bb(6),r.mc("disabled",!t.canLogin()),r.Bb(9),r.mc("ngIf",t.errorMessage),r.Bb(5),r.mc("routerLink",r.qc(6,pj)),r.Bb(6),r.mc("routerLink",r.qc(7,gj)))},directives:[gn,Ut,wn,dt,jt,En,hj,xn,tI,dj,fe,Zs],encapsulation:2}),e})(),yj=(()=>{class e{constructor(e){this.partDAO=e,this.unsubscribe=XO.empty(),this.activePartsBS=new Ir([]),this.activePartsObs=this.activePartsBS.asObservable()}getActivePartsObs(){return this.activePartsObs}startObserving(){WO(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");const e=new dS(e=>{const t=this.activePartsBS.value.concat(...e);this.activePartsBS.next(t)},e=>{const t=this.activePartsBS.value;for(const n of e)t.forEach(e=>{e.id===n.id&&(e.data=n.data)});this.activePartsBS.next(t)},e=>{const t=[];for(const n of this.activePartsBS.value)e.some(e=>e.id===n.id)||t.push(n);this.activePartsBS.next(t)});this.unsubscribe=XO.of(this.partDAO.observeActiveParts(e))}stopObserving(){WO(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=XO.empty()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(rS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"any"}),e})(),vj=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return GO(function*(){yield e.router.navigate(["/play",e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Create an online game`,[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(r.Qb(0,"app-pick-game",0),r.cc("pickGame",function(e){return t.pickGame(e)}),r.Pb(),r.Qb(1,"button",1),r.cc("click",function(){return t.navigateToOnlineGameCreation()}),r.Ub(2,2),r.Pb()),2&e&&(r.Bb(1),r.mc("disabled",!t.selectedGame))},directives:[sj],encapsulation:2}),e})();const bj=["chatDiv"];function _j(e,t){1&e&&(r.Ob(0),r.Ub(1,8),r.Nb())}function wj(e,t){if(1&e&&r.Ub(0,9),2&e){const e=r.fc(2);r.Xb(e.unreadMessagesText),r.Vb(0)}}function Cj(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",14),r.cc("click",function(){return r.wc(e),r.fc(3).scrollToBottom()}),r.Cc(1),r.Pb()}if(2&e){const e=r.fc(3);r.Bb(1),r.Ec("",e.unreadMessagesText," \u2193")}}function Ej(e,t){if(1&e&&(r.Qb(0,"p"),r.Cc(1),r.gc(2,"date"),r.Qb(3,"b"),r.Cc(4),r.Pb(),r.Cc(5),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.Ec(" [",r.jc(2,3,e.postedTime,"HH:mm:ss","+0100"),"] "),r.Bb(3),r.Ec("",e.sender," :"),r.Bb(1),r.Ec(" ",e.content," ")}}function Oj(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div"),r.Ac(1,Cj,2,1,"button",10),r.Qb(2,"div",11,12),r.cc("scroll",function(){return r.wc(e),r.fc(2).updateCurrentScrollPosition()}),r.Ac(4,Ej,6,7,"p",13),r.Pb(),r.Pb()}if(2&e){const e=r.fc(2);r.Bb(1),r.mc("ngIf",e.showUnreadMessagesButton),r.Bb(3),r.mc("ngForOf",e.chat)}}const Sj=function(){return{standalone:!0}};function Pj(e,t){if(1&e){const e=r.Rb();r.Qb(0,"form",15),r.cc("onSubmit",function(){return r.wc(e),r.fc(2).sendMessage()}),r.Qb(1,"div",16),r.Qb(2,"div",17),r.Qb(3,"input",18,19),r.cc("ngModelChange",function(t){return r.wc(e),r.fc(2).userMessage=t}),r.Pb(),r.Qb(5,"p",20),r.Cc(6),r.Pb(),r.Pb(),r.Qb(7,"div",21),r.Qb(8,"button",22),r.cc("click",function(){return r.wc(e),r.fc(2).sendMessage()}),r.Mb(9,"fa-icon",23),r.Pb(),r.Pb(),r.Pb(),r.Qb(10,"div",24),r.Qb(11,"p"),r.Qb(12,"strong"),r.Ub(13,25),r.Pb(),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=r.vc(4),t=r.fc(2);r.Bb(3),r.mc("ngModel",t.userMessage)("ngModelOptions",r.qc(4,Sj)),r.Bb(3),r.Ec("",e.value.length,"/128"),r.Bb(3),r.mc("icon",t.faReply)}}function Ij(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",2),r.Qb(1,"button",3),r.cc("click",function(){return r.wc(e),r.fc().switchChatVisibility()}),r.Ac(2,_j,2,0,"ng-container",4),r.Ac(3,wj,1,1,"ng-template",null,5,r.Bc),r.Pb(),r.Ac(5,Oj,5,2,"div",6),r.Ac(6,Pj,14,5,"form",7),r.Pb()}if(2&e){const e=r.vc(4),t=r.fc();r.Bb(2),r.mc("ngIf",t.visible)("ngIfElse",e),r.Bb(3),r.mc("ngIf",t.visible),r.Bb(1),r.mc("ngIf",t.visible)}}function Tj(e,t){1&e&&(r.Qb(0,"div",26),r.Qb(1,"div",27),r.Qb(2,"p"),r.Ub(3,28),r.Pb(),r.Pb(),r.Pb())}let Aj=(()=>{class e{constructor(t,n){this.chatService=t,this.authenticationService=n,this.userMessage="",this.username=XO.empty(),this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=BS,this.isNearBottom=!0,this.notYetScrolled=!0,qO(e.VERBOSE,"ChatComponent constructor")}ngOnInit(){qO(e.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),WO(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.authSubscription=this.authenticationService.getUserObs().subscribe(t=>{this.isConnectedUser(t)?(qO(e.VERBOSE,JSON.stringify(t)+" just connected"),this.username=t.username,this.connected=!0,this.loadChatContent()):(qO(e.VERBOSE,"No User Logged"),this.username=XO.empty(),this.connected=!1)})}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}isConnectedUser(e){return e.username.isPresent()&&""!==e.username.get()}loadChatContent(){qO(e.VERBOSE,`User '${this.username}' logged, loading chat content`),this.chatService.startObserving(this.chatId,e=>{WO(e.isPresent(),"ChatComponent observed a chat being deleted, this should not happen"),this.updateMessages(e.get())})}updateMessages(e){this.chat=e.messages;const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.connected&&this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return GO(function*(){WO(e.username.isPresent(),"disconnected user is not able to send a message");const t=e.userMessage;e.userMessage="",yield e.chatService.sendMessage(e.username.get(),t,e.turn)})()}ngOnDestroy(){this.authSubscription.unsubscribe(),this.chatService.isObserving()&&this.chatService.stopObserving()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(hS),r.Lb(vS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&r.Hc(bj,1),2&e){let e;r.uc(e=r.dc())&&(t.chatDiv=e.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:3,vars:2,consts:function(){let e,t,n,r,i;return e=$localize`Hide chat`,t=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,n=$localize`Type your message here`,r=$localize`Be polite`,i=$localize`Only connected users can see the chat.`,[["class","block",4,"ngIf"],["id","disconnected-chat","class","message is-primary is-light",4,"ngIf"],[1,"block"],["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],e,t,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",n,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],["toggleVisibility","",1,"clickable-icon",3,"icon"],[1,"content","is-small"],r,["id","disconnected-chat",1,"message","is-primary","is-light"],[1,"message-body"],i]},template:function(e,t){1&e&&(r.Qb(0,"div"),r.Ac(1,Ij,7,4,"div",0),r.Ac(2,Tj,4,0,"div",1),r.Pb()),2&e&&(r.Bb(1),r.mc("ngIf",t.connected),r.Bb(1),r.mc("ngIf",!1===t.connected))},directives:[fe,he,gn,Ut,hn,dt,Dn,jt,pn,tI,dj],pipes:[ye],encapsulation:2}),e})();function kj(e,t){if(1&e&&(r.Ob(0),r.Cc(1),r.Nb()),2&e){const e=r.fc().$implicit;r.Bb(1),r.Dc(e.data.playerOne)}}function Nj(e,t){1&e&&r.Ub(0,26)}function Mj(e,t){if(1&e){const e=r.Rb();r.Qb(0,"tr",22),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(2).joinGame(n.id,n.data.typeGame)}),r.Qb(1,"td",23),r.Cc(2),r.Pb(),r.Qb(3,"td",23),r.Cc(4),r.Pb(),r.Qb(5,"td",23),r.Ac(6,kj,2,1,"ng-container",24),r.Ac(7,Nj,1,0,"ng-template",null,25,r.Bc),r.Pb(),r.Qb(9,"td",23),r.Cc(10),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=t.index,i=r.vc(8);r.nc("id","part_",n,""),r.Bb(2),r.Dc(e.data.typeGame),r.Bb(2),r.Dc(e.data.playerZero),r.Bb(2),r.mc("ngIf",e.data.playerOne)("ngIfElse",i),r.Bb(4),r.Dc(e.data.turn)}}function xj(e,t){if(1&e&&(r.Qb(0,"div",13),r.Qb(1,"div",14),r.Qb(2,"table",15),r.Qb(3,"thead"),r.Qb(4,"tr"),r.Qb(5,"th",16),r.Ub(6,17),r.Pb(),r.Qb(7,"th",16),r.Ub(8,18),r.Pb(),r.Qb(9,"th",16),r.Ub(10,19),r.Pb(),r.Qb(11,"th",16),r.Ub(12,20),r.Pb(),r.Pb(),r.Pb(),r.Qb(13,"tbody"),r.Ac(14,Mj,11,6,"tr",21),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(14),r.mc("ngForOf",e.activeParts)}}function Rj(e,t){1&e&&(r.Qb(0,"div",27),r.Mb(1,"app-online-game-selection",28),r.Pb())}function Dj(e,t){if(1&e&&(r.Ob(0),r.Cc(1),r.gc(2,"date"),r.Nb()),2&e){const e=r.fc().$implicit;r.Bb(1),r.Fc(" ",e.data.username,": ",r.jc(2,2,1e3*e.data.last_changed.seconds,"HH:mm:ss","+0100")," ")}}function Lj(e,t){if(1&e&&(r.Qb(0,"li"),r.Ac(1,Dj,3,6,"ng-container",37),r.Pb()),2&e){const e=t.$implicit;r.Bb(1),r.mc("ngIf",e.data.last_changed)}}function Bj(e,t){if(1&e&&(r.Qb(0,"div",29),r.Qb(1,"div",30),r.Qb(2,"div",31),r.Mb(3,"app-chat",32),r.Pb(),r.Pb(),r.Qb(4,"div",33),r.Qb(5,"div",34),r.Qb(6,"p"),r.Ub(7,35),r.Pb(),r.Qb(8,"ul"),r.Ac(9,Lj,2,1,"li",36),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(3),r.mc("turn",-1),r.Bb(6),r.mc("ngForOf",e.activeUsers)}}let Fj=(()=>{class e{constructor(e,t,n){this.router=e,this.userService=t,this.activePartsService=n,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}ngOnInit(){qO(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(e=>{this.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(e=>{this.activeParts=e})}ngOnDestroy(){qO(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}joinGame(e,t){var n=this;return GO(function*(){yield n.router.navigate(["/play",t,e])})()}selectTab(e){this.currentTab=e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(gS),r.Lb(yj))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){let e,t,n,r,i,o,s,a,c;return e=$localize`Games`,t=$localize`Create`,n=$localize`Chat`,r=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,s=$localize`Turn`,a=$localize`Waiting for opponent`,c=$localize`Connected users:`,[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],e,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],t,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],n,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],r,i,o,s,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-9"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3"],["id","onlineUser",1,"box"],c,[4,"ngFor","ngForOf"],[4,"ngIf"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"ul"),r.Qb(2,"li",1),r.Qb(3,"a",2),r.cc("click",function(){return t.selectTab("games")}),r.Ub(4,3),r.Pb(),r.Pb(),r.Qb(5,"li",4),r.Qb(6,"a",5),r.cc("click",function(){return t.selectTab("create")}),r.Ub(7,6),r.Pb(),r.Pb(),r.Qb(8,"li",7),r.Qb(9,"a",8),r.cc("click",function(){return t.selectTab("chat")}),r.Ub(10,9),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Ac(11,xj,15,1,"div",10),r.Ac(12,Rj,2,0,"div",11),r.Ac(13,Bj,10,2,"div",12)),2&e&&(r.Bb(11),r.mc("ngIf","games"===t.currentTab),r.Bb(1),r.mc("ngIf","create"===t.currentTab),r.Bb(1),r.mc("ngIf","chat"===t.currentTab))},directives:[le,fe,he,vj,Aj],pipes:[ye],encapsulation:2}),e})(),jj=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-not-found"]],decls:5,vars:0,consts:function(){let e,t;return e=$localize`Game does not exist`,t=$localize`The game you tried to join does not exist anymore.`,[[1,"message","is-danger"],[1,"message-header"],e,[1,"message-body"],t]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Ub(2,2),r.Pb(),r.Qb(3,"div",3),r.Ub(4,4),r.Pb(),r.Pb())},encapsulation:2}),e})();function Uj(e,t){}let Vj=(()=>{class e{constructor(t){this.viewContainerRef=t,qO(e.VERBOSE,"GameIncluderComponent constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(r.Q))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&r.Ac(0,Uj,0,0,"ng-template")},encapsulation:2}),e})(),zj=(()=>{class e{}return e.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,e.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,e})(),Hj=(()=>{class e{constructor(t,n,r){this.componentFactoryResolver=t,this.actRoute=n,this.authenticationService=r,this.players=[XO.empty(),XO.empty()],this.endGame=!1,qO(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}getMatchingComponent(t){qO(e.VERBOSE,"GameWrapper.getMatchingComponent");const n=XO.ofNullable(oj.ALL_GAMES().find(e=>e.urlName===t));return WO(n.isPresent(),"Unknown Games are unwrappable"),n.get().component}afterGameIncluderViewInit(){qO(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),this.createGameComponent(),this.gameComponent.rules.setInitialBoard()}createGameComponent(){qO(e.VERBOSE,"GameWrapper.createGameComponent"),WO(null!=this.gameIncluder,"GameIncluder should be present");const t=$O.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),n=this.getMatchingComponent(t),r=this.componentFactoryResolver.resolveComponentFactory(n),i=this.gameIncluder.viewContainerRef.createComponent(r);this.gameComponent=i.instance,this.gameComponent.chooseMove=(e,t,n)=>this.receiveValidMove(e,t,n),this.gameComponent.canUserPlay=e=>this.onUserClick(e),this.gameComponent.isPlayerTurn=()=>this.isPlayerTurn(),this.gameComponent.cancelMoveOnWrapper=e=>{this.onCancelMove(e)},this.gameComponent.observerRole=this.observerRole,this.canPass=this.gameComponent.canPass}receiveValidMove(t,n,r){var i=this;return GO(function*(){if(qO(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),!i.isPlayerTurn())return aS.failure(zj.NOT_YOUR_TURN());if(i.endGame)return aS.failure($localize`The game has ended.`);const o=i.gameComponent.rules.isLegal(t,n);return o.isFailure()?(i.gameComponent.cancelMove(o.getReason()),aS.ofFallible(o)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(t,r),qO(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),aS.SUCCESS)})()}onUserClick(e){if(this.observerRole===CS.NONE.value){const e=zj.NO_CLONING_FEATURE();return aS.failure(e)}return this.isPlayerTurn()?aS.SUCCESS:aS.failure(zj.NOT_YOUR_TURN())}onCancelMove(e){}isPlayerTurn(){if(this.observerRole===CS.NONE.value)return!1;if(null==this.gameComponent)return!1;const t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayerName();return qO(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,username:r,observer:this.observerRole,areYouPlayer:this.players[n].equalsValue(r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(r.j),r.Lb(Po),r.Lb(vS))},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&r.Hc(Vj,1),2&e){let e;r.uc(e=r.dc())&&(t.gameIncluder=e.first)}},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class Gj{constructor(e,t,n){this.added=e,this.modified=t,this.removed=n}static from(e,t){const n=new Gj({},{},{});if(null==e)return n.added={...t},n;if(null==t)return n.removed={...e},n;const r=Object.keys(e),i=Object.keys(t),o=r.filter(e=>!1===i.includes(e)),s=r.filter(e=>i.includes(e)),a=i.filter(e=>!1===r.includes(e));return n.addNewKeys(a,t),n.addCommonKey(s,t,e),n.addRemovedKeys(o,e),n}addNewKeys(e,t){for(const n of e)null!=t[n]&&(this.added[n]=t[n])}addCommonKey(e,t,n){for(const r of e)if(null==t[r])null!=n[r]&&(this.removed[r]=n[r]);else if(null==n[r])null!=t[r]&&(this.added[r]=t[r]);else{if(["function","symbol","bigint"].includes(typeof n[r]))throw new Error("Not implemented yet");if(void 0===n[r])throw new Error("YOU RE NOT A REAL VALUE "+r);if(["string","boolean","number"].includes(typeof n[r]))n[r]!==t[r]&&(this.modified[r]=t[r]);else if("number"==typeof n[r].length){if("number"!=typeof t[r].length)throw new Error("Thing should not change type");if(n[r].length===t[r].length){let e=!0;for(let i=0;e&&i<n[r].length;i++)Gj.from(n[r][i],t[r][i]).countChanges()>0&&(e=!1,this.modified[r]=t[r])}else this.modified[r]=t[r]}else{const e=Gj.from(n[r],t[r]);e.countChanges()>0&&(this.modified[r]=e)}}}countChanges(){const e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}addRemovedKeys(e,t){for(const n of e)this.removed[n]=t[n]}isPresent(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}let $j=(()=>{class e{transform(e){const t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize`${r} hours`):1===r&&i.push($localize`1 hour`),n>1?i.push($localize`${n} minutes`):1===n&&i.push($localize`1 minute`),t>1?i.push($localize`${t} seconds`):1===t&&i.push($localize`1 second`),0===i.length)return $localize`0 seconds`;if(1===i.length)return i[0];{const e=i.slice(0,-1).join(", "),t=i.slice(-1)[0];return $localize`${e} and ${t}`}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Kb({name:"humanDuration",type:e,pure:!0}),e})();function qj(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Wj(e){return t=>t.lift(new Zj(e))}class Zj{constructor(e){this.notifier=e}call(e,t){const n=new Qj(e),r=Object(Hr.c)(this.notifier,new Hr.a(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n}}class Qj extends Hr.b{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function Yj(e,t){if(1&e&&(r.Ob(0),r.Cc(1),r.Nb()),2&e){const e=r.fc(3);r.Bb(1),r.Dc(e.viewInfo.chosenOpponent)}}function Kj(e,t){1&e&&r.Ub(0,44)}function Jj(e,t){if(1&e&&(r.Qb(0,"div",45),r.Qb(1,"div",8),r.Qb(2,"label",46),r.Ob(3),r.Ub(4,47),r.Nb(),r.Qb(5,"output"),r.Cc(6),r.gc(7,"humanDuration"),r.Pb(),r.Pb(),r.Qb(8,"div",37),r.Mb(9,"input",48),r.Pb(),r.Pb(),r.Qb(10,"div",8),r.Qb(11,"label",49),r.Yb(12,50),r.Mb(13,"output"),r.gc(14,"humanDuration"),r.Wb(),r.Pb(),r.Qb(15,"div",37),r.Mb(16,"input",51),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.fc(3);r.Bb(6),r.Dc(r.hc(7,2,e.viewInfo.maximalMoveDuration||0)),r.Bb(8),r.Xb(r.hc(14,4,e.viewInfo.totalPartDuration||0)),r.Vb(12)}}function Xj(e,t){1&e&&(r.Qb(0,"div"),r.Yb(1,52),r.Mb(2,"br"),r.Wb(),r.Pb())}function eU(e,t){1&e&&(r.Qb(0,"button",64),r.Ub(1,65),r.Pb())}function tU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"tr",60),r.cc("click",function(){r.wc(e);const n=t.$implicit;return r.fc(4).selectOpponent(n)}),r.Qb(1,"td",61),r.Cc(2),r.Pb(),r.Qb(3,"td",62),r.Ac(4,eU,2,0,"button",63),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit,n=r.fc(4);r.nc("id","presenceOf_",e,""),r.mc("ngClass",n.viewInfo.candidateClasses[e]),r.Bb(1),r.mc("id",n.viewInfo.chosenOpponent===e&&"selected_"+e||"candidate_"+e),r.Bb(1),r.Dc(e),r.Bb(2),r.mc("ngIf",n.viewInfo.chosenOpponent!==e)}}function nU(e,t){if(1&e&&(r.Ob(0),r.Ub(1,53),r.Nb(),r.Qb(2,"div",54),r.Qb(3,"table",55),r.Qb(4,"thead"),r.Qb(5,"tr"),r.Qb(6,"th",56),r.Ub(7,57),r.Pb(),r.Qb(8,"th",56),r.Ub(9,58),r.Pb(),r.Pb(),r.Pb(),r.Qb(10,"tbody"),r.Ac(11,tU,5,5,"tr",59),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.fc(3);r.Bb(11),r.mc("ngForOf",e.viewInfo.candidates)}}function rU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",66),r.cc("click",function(){return r.wc(e),r.fc(3).changeConfig()}),r.Ub(1,67),r.Pb()}}function iU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div"),r.Qb(1,"h1",4),r.Ub(2,5),r.Pb(),r.Qb(3,"form",6),r.Qb(4,"fieldset",7),r.Qb(5,"div",8),r.Qb(6,"label",9),r.Ub(7,10),r.Pb(),r.Qb(8,"div",11),r.Qb(9,"button",12),r.cc("click",function(){return r.wc(e),r.fc(2).selectFirstPlayer("RANDOM")}),r.Ub(10,13),r.Pb(),r.Qb(11,"button",14),r.cc("click",function(){return r.wc(e),r.fc(2).selectFirstPlayer("CREATOR")}),r.Ub(12,15),r.Pb(),r.Qb(13,"button",16),r.cc("click",function(){return r.wc(e),r.fc(2).selectFirstPlayer("CHOSEN_PLAYER")}),r.Ac(14,Yj,2,1,"ng-container",17),r.Ac(15,Kj,1,0,"ng-template",null,18,r.Bc),r.Pb(),r.Pb(),r.Pb(),r.Qb(17,"div",8),r.Qb(18,"label",9),r.Ub(19,19),r.Pb(),r.Qb(20,"div",11),r.Qb(21,"div",20),r.cc("click",function(){return r.wc(e),r.fc(2).selectPartType("STANDARD")}),r.Qb(22,"div",21),r.Qb(23,"span"),r.Ub(24,22),r.Pb(),r.Pb(),r.Qb(25,"div",23),r.Qb(26,"div",24),r.Qb(27,"div",25),r.Qb(28,"p"),r.Ob(29),r.Ub(30,26),r.Nb(),r.Qb(31,"strong"),r.Cc(32),r.gc(33,"humanDuration"),r.Pb(),r.Mb(34,"br"),r.Ob(35),r.Yb(36,27),r.Mb(37,"strong"),r.gc(38,"humanDuration"),r.Wb(),r.Nb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(39,"div",28),r.cc("click",function(){return r.wc(e),r.fc(2).selectPartType("BLITZ")}),r.Qb(40,"div",21),r.Qb(41,"span"),r.Ub(42,29),r.Pb(),r.Pb(),r.Qb(43,"div",23),r.Qb(44,"div",24),r.Qb(45,"div",25),r.Qb(46,"p"),r.Ob(47),r.Ub(48,30),r.Nb(),r.Qb(49,"strong"),r.Cc(50),r.gc(51,"humanDuration"),r.Pb(),r.Mb(52,"br"),r.Ob(53),r.Yb(54,31),r.Mb(55,"strong"),r.gc(56,"humanDuration"),r.Wb(),r.Nb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(57,"button",32),r.cc("click",function(){return r.wc(e),r.fc(2).selectPartType("CUSTOM")}),r.Ub(58,33),r.Pb(),r.Pb(),r.Pb(),r.Ac(59,Jj,17,6,"div",34),r.Qb(60,"div",8),r.Qb(61,"label",35),r.Ub(62,36),r.Pb(),r.Qb(63,"div",37),r.Ac(64,Xj,3,0,"div",17),r.Ac(65,nU,12,1,"ng-template",null,38,r.Bc),r.Pb(),r.Pb(),r.Pb(),r.Qb(67,"div",8),r.Qb(68,"div",11),r.Qb(69,"button",39),r.cc("click",function(){return r.wc(e),r.fc(2).proposeConfig()}),r.Ub(70,40),r.Pb(),r.Ac(71,rU,2,0,"button",41),r.Qb(72,"button",42),r.cc("click",function(){return r.wc(e),r.fc(2).cancelGameCreation()}),r.Ub(73,43),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=r.vc(16),t=r.vc(66),n=r.fc(2);r.Bb(3),r.mc("formGroup",n.configFormGroup),r.Bb(1),r.mc("disabled",!n.viewInfo.canEditConfig),r.Bb(5),r.mc("ngClass",n.viewInfo.firstPlayerClasses.RANDOM),r.Bb(2),r.mc("ngClass",n.viewInfo.firstPlayerClasses.CREATOR),r.Bb(2),r.mc("ngClass",n.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),r.Bb(1),r.mc("ngIf",n.viewInfo.chosenOpponent)("ngIfElse",e),r.Bb(7),r.mc("ngClass",n.viewInfo.partTypeClasses.STANDARD),r.Bb(11),r.Dc(r.hc(33,19,n.partType.NORMAL_MOVE_DURATION)),r.Bb(6),r.Xb(r.hc(38,21,n.partType.NORMAL_PART_DURATION)),r.Vb(36),r.Bb(1),r.mc("ngClass",n.viewInfo.partTypeClasses.BLITZ),r.Bb(11),r.Dc(r.hc(51,23,n.partType.BLITZ_MOVE_DURATION)),r.Bb(6),r.Xb(r.hc(56,25,n.partType.BLITZ_PART_DURATION)),r.Vb(54),r.Bb(1),r.mc("ngClass",n.viewInfo.partTypeClasses.CUSTOM),r.Bb(2),r.mc("ngIf",n.viewInfo.showCustomTime),r.Bb(5),r.mc("ngIf",0===n.viewInfo.candidates.length)("ngIfElse",t),r.Bb(5),r.mc("disabled",!n.viewInfo.canProposeConfig),r.Bb(2),r.mc("ngIf",n.viewInfo.canReviewConfig)}}function oU(e,t){if(1&e&&(r.Qb(0,"div",74),r.Qb(1,"p"),r.Yb(2,75),r.Mb(3,"br"),r.Wb(),r.Pb(),r.Pb()),2&e){const e=r.fc(3);r.Bb(3),r.Xb(e.viewInfo.creator),r.Vb(2)}}function sU(e,t){if(1&e&&(r.Qb(0,"span"),r.Ub(1,81),r.Pb()),2&e){const e=r.fc(4);r.Bb(1),r.Xb(e.viewInfo.creator),r.Vb(1)}}function aU(e,t){1&e&&(r.Qb(0,"span"),r.Ub(1,82),r.Pb())}function cU(e,t){1&e&&(r.Qb(0,"span"),r.Ub(1,83),r.Pb())}function lU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",74),r.Qb(1,"p"),r.Ub(2,76),r.Pb(),r.Qb(3,"ul"),r.Qb(4,"li"),r.Ac(5,sU,2,1,"span",2),r.Ac(6,aU,2,0,"span",2),r.Ac(7,cU,2,0,"span",2),r.Pb(),r.Qb(8,"li"),r.Yb(9,77),r.Mb(10,"strong"),r.gc(11,"humanDuration"),r.Wb(),r.Pb(),r.Qb(12,"li"),r.Yb(13,78),r.Mb(14,"strong"),r.gc(15,"humanDuration"),r.Wb(),r.Pb(),r.Pb(),r.Qb(16,"button",79),r.cc("click",function(){return r.wc(e),r.fc(3).acceptConfig()}),r.Ub(17,80),r.Pb(),r.Pb()}if(2&e){const e=r.fc(3);r.Bb(2),r.Xb(e.viewInfo.creator)(e.viewInfo.partTypeName),r.Vb(2),r.Bb(3),r.mc("ngIf","CREATOR"===e.viewInfo.firstPlayer),r.Bb(1),r.mc("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),r.Bb(1),r.mc("ngIf","RANDOM"===e.viewInfo.firstPlayer),r.Bb(4),r.Xb(r.hc(11,7,e.viewInfo.maximalMoveDuration||0)),r.Vb(9),r.Bb(4),r.Xb(r.hc(15,9,e.viewInfo.totalPartDuration||0)),r.Vb(13)}}function uU(e,t){if(1&e&&(r.Qb(0,"div"),r.Qb(1,"div",68),r.Qb(2,"div",69),r.Qb(3,"p"),r.Ub(4,70),r.Pb(),r.Pb(),r.Qb(5,"div",71),r.Ac(6,oU,4,1,"div",72),r.Ac(7,lU,18,11,"ng-template",null,73,r.Bc),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.vc(8),t=r.fc(2);r.Bb(6),r.mc("ngIf",t.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function hU(e,t){if(1&e&&(r.Ob(0),r.Ub(1,86),r.Nb()),2&e){const e=r.fc(3);r.Bb(1),r.Xb(e.viewInfo.creator),r.Vb(1)}}function dU(e,t){if(1&e&&r.Ub(0,87),2&e){const e=r.fc(3);r.Xb(e.viewInfo.creator)(e.viewInfo.chosenOpponent),r.Vb(0)}}function fU(e,t){if(1&e&&(r.Qb(0,"div",68),r.Qb(1,"div",69),r.Qb(2,"p"),r.Ub(3,84),r.Pb(),r.Pb(),r.Qb(4,"div",71),r.Qb(5,"p"),r.Ac(6,hU,2,1,"ng-container",17),r.Ac(7,dU,1,2,"ng-template",null,85,r.Bc),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.vc(8),t=r.fc(2);r.Bb(6),r.mc("ngIf",t.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function pU(e,t){if(1&e&&(r.Qb(0,"div",1),r.Ac(1,iU,74,27,"div",2),r.Ac(2,uU,9,2,"div",2),r.Ac(3,fU,9,2,"div",3),r.Pb()),2&e){const e=r.fc();r.Bb(1),r.mc("ngIf",e.viewInfo.userIsCreator),r.Bb(1),r.mc("ngIf",e.viewInfo.userIsChosenOpponent),r.Bb(1),r.mc("ngIf",e.viewInfo.userIsObserver)}}let gU=(()=>{class e{constructor(t,n,i,o,s,a,c){this.router=t,this.gameService=n,this.joinerService=i,this.chatService=o,this.userService=s,this.formBuilder=a,this.messageDisplayer=c,this.partType=_S,this.gameStartNotification=new r.n,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentJoiner=null,this.candidateSubscription=new WI,this.creatorSubscription=null,this.ngUnsubscribe=new Sr.a,this.allDocDeleted=!1,qO(e.VERBOSE,"PartCreationComponent constructed for "+this.userName)}ngOnInit(){var t=this;return GO(function*(){qO(e.VERBOSE,"PartCreationComponent.ngOnInit for "+t.userName),t.checkInputs(),t.createForms(),!1!==(yield t.joinerService.joinGame(t.partId,t.userName))&&(t.subscribeToJoinerDoc(),t.subscribeToFormElements(),qO(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds"))})()}checkInputs(){WO(null!=this.userName&&""!==this.userName,"PartCreationComponent should not be created with an empty userName"),WO(null!=this.partId&&""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[bS.RANDOM.value,vt.required],maximalMoveDuration:[_S.NORMAL_MOVE_DURATION,vt.required],partType:["STANDARD",vt.required],totalPartDuration:[_S.NORMAL_PART_DURATION,vt.required],chosenOpponent:["",vt.required]})}subscribeToJoinerDoc(){var e=this;this.joinerService.observe(this.partId).pipe(Wj(this.ngUnsubscribe)).subscribe(function(){var t=GO(function*(t){yield e.onCurrentJoinerUpdate(t)});return function(e){return t.apply(this,arguments)}}())}getForm(e){return $O.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Wj(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e,this.viewInfo.canProposeConfig=$O.getNonNullable(this.currentJoiner).partStatus!==wS.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(Wj(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(Wj(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(Wj(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(Wj(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=$O.getNonNullable(this.currentJoiner);switch(this.viewInfo.canReviewConfig=e.partStatus===wS.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==wS.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userName===e.creator,this.viewInfo.userIsChosenOpponent=this.userName===e.chosenPlayer,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==wS.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator,this.viewInfo.candidates=e.candidates,this.userName===e.creator?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenPlayer||void 0,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration||e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration||e.totalPartDuration;let t=this.viewInfo.chosenOpponent;t?-1===e.candidates.indexOf(t)&&(t=""):t=e.chosenPlayer||"",this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(_S.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(_S.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(_S.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(_S.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(t){var n=this;return GO(function*(){return qO(e.VERBOSE,"PartCreationComponent.setChosenPlayer("+t+")"),n.joinerService.setChosenPlayer(t)})()}changeConfig(){var e=this;return GO(function*(){return e.joinerService.reviewConfig()})()}proposeConfig(){var e=this;return GO(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,r=e.getForm("maximalMoveDuration").value,i=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value;return e.joinerService.proposeConfig(t,_S.of(n),r,bS.of(i),o)})()}cancelGameCreation(){var t=this;return GO(function*(){t.allDocDeleted=!0,qO(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.gameService.deletePart(t.partId),qO(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game deleted"),yield t.joinerService.deleteJoiner(),qO(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game and joiner deleted"),yield t.chatService.deleteChat(t.partId),qO(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game and joiner and chat deleted")})()}onCurrentJoinerUpdate(t){if(qO(e.VERBOSE,{PartCreationComponent_onCurrentJoinerUpdate:{before:JSON.stringify(this.currentJoiner),then:JSON.stringify(t)}}),t.isAbsent())return qO(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: LAST UPDATE : the game is cancelled"),this.onGameCancelled();this.currentJoiner=t.get(),this.observeNeededPlayers(),this.updateViewInfo(),this.isGameStarted()&&(qO(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: the game has started"),this.onGameStarted())}onGameCancelled(){var t=this;return GO(function*(){qO(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(){const e=$O.getNonNullable(this.currentJoiner);return null!=e&&e.partStatus===wS.PART_STARTED.value}onGameStarted(){const t=$O.getNonNullable(this.currentJoiner);qO(e.VERBOSE,{partCreationComponent_onGameStarted:{joiner:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,qO(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){const t=$O.getNonNullable(this.currentJoiner);qO(e.VERBOSE,{PartCreationComponent_updateJoiner:{joiner:t}}),this.userName===t.creator?this.observeCandidates():this.observeCreator()}observeCreator(){var e=this;const t=$O.getNonNullable(this.currentJoiner);if(null!=this.creatorSubscription)return;const n=function(){var t=GO(function*(t){yield e.destroyDocIfCreatorOffline(t)});return function(e){return t.apply(this,arguments)}}(),r=new dS(n,n,n);this.creatorSubscription=this.userService.observeUserByUsername(t.creator,r)}destroyDocIfCreatorOffline(e){var t=this;return GO(function*(){const n=$O.getNonNullable(t.currentJoiner);for(const r of e)WO(r.data.username===n.creator,"found non creator while observing creator!"),"offline"===r.data.state&&!1===t.allDocDeleted&&n.partStatus!==wS.PART_STARTED.value&&(yield t.cancelGameCreation())})()}observeCandidates(){var t=this;const n=$O.getNonNullable(this.currentJoiner);qO(e.VERBOSE,{PartCreation_observeCandidates:n});const r=new dS(function(){var e=GO(function*(e){for(const n of e)"offline"===n.data.state&&(yield t.removeUserFromLobby($O.getNonNullable(n.data.username)),$O.handleError("OnlineGameWrapper: "+n.data.username+" is already offline!"))});return function(t){return e.apply(this,arguments)}}(),function(){var e=GO(function*(e){for(const n of e)"offline"===n.data.state&&(yield t.removeUserFromLobby($O.getNonNullable(n.data.username)))});return function(t){return e.apply(this,arguments)}}(),function(){var e=GO(function*(e){for(const n of e)yield t.removeUserFromLobby($O.getNonNullable(n.data.username)),$O.handleError("OnlineGameWrapper: "+n.data.username+" was deleted ("+n.id+")")});return function(t){return e.apply(this,arguments)}}());for(const e of n.candidates)if(this.candidateSubscription.get(e).isAbsent()){const t=this.userService.observeUserByUsername(e,r);this.candidateSubscription.set(e,t)}for(const e of this.candidateSubscription.listKeys())e!==n.chosenPlayer&&!1===n.candidates.includes(e)&&this.unsubscribeFrom(e)}removeUserFromLobby(e){const t=$O.getNonNullable(this.currentJoiner),n=t.candidates.indexOf(e);WO(-1!==n,"PartCreationComponent: attempting to remove a user not in the lobby");const r=t.candidates.slice(0,n),i=t.candidates.slice(n+1),o=r.concat(i);return e===t.chosenPlayer?(this.messageDisplayer.infoMessage($localize`${e} left the game, please pick another opponent.`),this.joinerService.reviewConfigRemoveChosenPlayerAndUpdateCandidates(o)):this.joinerService.updateCandidates(o)}unsubscribeFrom(e){this.candidateSubscription.delete(e)()}acceptConfig(){return qO(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,$O.getNonNullable(this.currentJoiner))}ngOnDestroy(){var t=this;return GO(function*(){qO(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete();for(const e of t.candidateSubscription.listKeys())t.unsubscribeFrom(e);if(!1===t.gameStarted){if(null===t.currentJoiner)return void qO(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here");t.userName===t.currentJoiner.creator?(qO(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):!1===t.allDocDeleted&&(qO(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(joiner) about to cancel game joining"),yield t.joinerService.cancelJoining(t.userName))}})()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(qs),r.Lb(TS),r.Lb(IS),r.Lb(hS),r.Lb(gS),r.Lb(jn),r.Lb(OI))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-part-creation"]],inputs:{partId:"partId",userName:"userName"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let e,t,n,r,i,o,s,a,c,l,u,h,d,f,p,g,m,y,v,b,_,w,C,E,O,S,P,I,T,A,k,N,M,x,R,D;return e=$localize`Game creation`,t=$localize`First player`,n=$localize`Random`,r=$localize`You`,i=$localize`Game type`,o=$localize`Standard`,s=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,u=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,h=$localize`Custom`,d=$localize`Opponents`,f=$localize`Propose configuration`,p=$localize`Cancel game`,g=$localize`The opponent`,m=$localize`Maximal turn duration: `,y=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,v=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,b=$localize`Click on the opponent against which you would like to play.`,_=$localize`Name`,w=$localize`Actions`,C=$localize`Pick`,E=$localize`Change configuration`,O=$localize`Configuration proposal`,S=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,P=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,I=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,T=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,A=$localize`Accept and start`,k=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,N=$localize`you play first`,M=$localize`the first player is selected randomly`,x=$localize`One moment...`,R=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,D=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],e,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],n,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],o,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],s,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,u,["id","partTypeCustom",1,"button",3,"ngClass","click"],h,["id","customTime",4,"ngIf"],[1,"label"],d,[1,"control"],["chooseCandidate",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],f,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],p,g,["id","customTime"],["for","maximalMoveDuration",1,"label"],m,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],y,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],v,b,["id","chooseCandidate",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],_,w,[3,"ngClass","id","click",4,"ngFor","ngForOf"],[3,"ngClass","id","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],C,["id","reviewConfig",1,"button",3,"click"],E,[1,"message","is-primary"],[1,"message-header"],O,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],S,P,I,T,["id","acceptConfig",1,"button","is-primary",3,"click"],A,k,N,M,x,["proposalSent",""],R,D]},template:function(e,t){1&e&&r.Ac(0,pU,4,3,"div",0),2&e&&r.mc("ngIf",t.viewInfo)},directives:[fe,gn,Ut,wn,le,dt,vn,jt,En,he],pipes:[$j],encapsulation:2}),e})();function mU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",3),r.cc("click",function(){return r.wc(e),r.fc().addTime()}),r.Ub(1,4),r.Pb()}if(2&e){const e=r.fc();r.Bb(1),r.Xb(e.timeToAdd),r.Vb(1)}}let yU=(()=>{class e{constructor(){this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new r.n,this.addTimeToOpponent=new r.n,this.cssClasses=e.SAFE_TIME}ngOnInit(){qO(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(t){if(qO(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}changeDuration(e){let t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){if(qO(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}resume(){if(qO(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();const t=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},t),this.countSeconds()}onEndReached(){qO(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){if(qO(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){if(qO(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){qO(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let e;return e=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],e]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"p",1),r.Cc(2),r.gc(3,"number"),r.Pb(),r.Ac(4,mU,2,1,"button",2),r.Pb()),2&e&&(r.mc("ngClass",t.getTimeClass()),r.Bb(2),r.Fc("",t.displayedMinute,":",r.ic(3,4,t.displayedSec,"2.0-0"),""),r.Bb(2),r.mc("ngIf",t.canAddTime))},directives:[le,fe],pipes:[ve],encapsulation:2}),e})();const vU=["partCreation"],bU=["chatComponent"],_U=["chronoZeroGlobal"],wU=["chronoOneGlobal"],CU=["chronoZeroTurn"],EU=["chronoOneTurn"];function OU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"app-part-creation",5,6),r.cc("gameStartNotification",function(t){return r.wc(e),r.fc().startGame(t)}),r.Pb()}if(2&e){const e=r.fc();r.mc("partId",e.currentPartId)("userName",e.getPlayerName())}}function SU(e,t){1&e&&(r.Ob(0),r.Ub(1,40),r.Nb())}function PU(e,t){if(1&e&&r.Ub(0,41),2&e){const e=r.fc(4);r.Xb(e.currentPlayer),r.Vb(0)}}function IU(e,t){if(1&e&&(r.Qb(0,"p",37),r.Ac(1,SU,2,0,"ng-container",38),r.Ac(2,PU,1,1,"ng-template",null,39,r.Bc),r.Pb()),2&e){const e=r.vc(3),t=r.fc(3);r.Bb(1),r.mc("ngIf",t.currentPlayer===t.getPlayerName())("ngIfElse",e)}}function TU(e,t){if(1&e&&(r.Qb(0,"div",33),r.Qb(1,"p",34),r.Ub(2,35),r.Pb(),r.Ac(3,IU,4,2,"p",36),r.Pb()),2&e){const e=r.fc(2);r.Bb(2),r.Xb(e.currentPart.getTurn()+1),r.Vb(2),r.Bb(1),r.mc("ngIf",!1===e.endGame)}}function AU(e,t){if(1&e&&(r.Qb(0,"p",42),r.Cc(1),r.Pb()),2&e){const e=r.fc(2);r.mc("ngClass",e.getPlayerNameClass(0)),r.Bb(1),r.Dc(e.players[0].get())}}function kU(e,t){if(1&e&&(r.Qb(0,"p",43),r.Ub(1,44),r.Pb()),2&e){const e=r.fc(2);r.Bb(1),r.Xb(e.gameComponent.scores.get()[0]),r.Vb(1)}}function NU(e,t){if(1&e&&(r.Qb(0,"p",45),r.Cc(1),r.Pb()),2&e){const e=r.fc(2);r.mc("ngClass",e.getPlayerNameClass(1)),r.Bb(1),r.Dc(e.players[1].get())}}function MU(e,t){if(1&e&&(r.Qb(0,"p",46),r.Ub(1,47),r.Pb()),2&e){const e=r.fc(2);r.Bb(1),r.Xb(e.gameComponent.scores.get()[1]),r.Vb(1)}}function xU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",56),r.cc("click",function(){return r.wc(e),r.fc(3).resign()}),r.Ub(1,57),r.Pb()}}function RU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",58),r.cc("click",function(){return r.wc(e),r.fc(3).proposeDraw()}),r.Ub(1,59),r.Pb()}}function DU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",60),r.cc("click",function(){return r.wc(e),r.fc(3).acceptDraw()}),r.Ub(1,61),r.Pb()}}function LU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",62),r.cc("click",function(){return r.wc(e),r.fc(3).refuseDraw()}),r.Ub(1,63),r.Pb()}}function BU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",64),r.cc("click",function(){return r.wc(e),r.fc(3).gameComponent.pass()}),r.Ub(1,65),r.Pb()}}function FU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",66),r.cc("click",function(){return r.wc(e),r.fc(3).acceptTakeBack()}),r.Ub(1,67),r.Pb()}}function jU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",68),r.cc("click",function(){return r.wc(e),r.fc(3).refuseTakeBack()}),r.Ub(1,69),r.Pb()}}function UU(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",70),r.cc("click",function(){return r.wc(e),r.fc(3).askTakeBack()}),r.Ub(1,71),r.Pb()}}function VU(e,t){if(1&e&&(r.Ob(0),r.Ac(1,xU,2,0,"button",48),r.Ac(2,RU,2,0,"button",49),r.Ac(3,DU,2,0,"button",50),r.Ac(4,LU,2,0,"button",51),r.Ac(5,BU,2,0,"button",52),r.Ac(6,FU,2,0,"button",53),r.Ac(7,jU,2,0,"button",54),r.Ac(8,UU,2,0,"button",55),r.Nb()),2&e){const e=r.fc(2);r.Bb(1),r.mc("ngIf",e.canResign()),r.Bb(1),r.mc("ngIf",e.canProposeDraw()),r.Bb(1),r.mc("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),r.Bb(1),r.mc("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),r.Bb(1),r.mc("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&e.currentPlayer===e.getPlayerName()),r.Bb(1),r.mc("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),r.Bb(1),r.mc("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),r.Bb(1),r.mc("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function zU(e,t){1&e&&(r.Qb(0,"div"),r.Qb(1,"p",73),r.Ub(2,74),r.Pb(),r.Pb())}function HU(e,t){1&e&&(r.Qb(0,"p",78),r.Ub(1,79),r.Pb())}function GU(e,t){1&e&&(r.Qb(0,"p",80),r.Ub(1,81),r.Pb())}function $U(e,t){1&e&&(r.Qb(0,"p",82),r.Ub(1,83),r.Pb())}function qU(e,t){if(1&e&&(r.Qb(0,"div"),r.Ac(1,HU,2,0,"p",75),r.Ac(2,GU,2,0,"p",76),r.Ac(3,$U,2,0,"p",77),r.Pb()),2&e){const e=r.fc(3);r.Bb(1),r.mc("ngIf",e.currentPart.getDrawAccepter()===e.getPlayerName()),r.Bb(1),r.mc("ngIf",e.currentPart.getDrawAccepter()!==e.getPlayerName()&&e.isPlaying()),r.Bb(1),r.mc("ngIf",!1===e.isPlaying())}}function WU(e,t){1&e&&(r.Qb(0,"p",86),r.Ub(1,87),r.Pb())}function ZU(e,t){1&e&&(r.Qb(0,"p",88),r.Ub(1,89),r.Pb())}function QU(e,t){if(1&e&&(r.Qb(0,"p",88),r.Ub(1,90),r.Pb()),2&e){const e=r.fc(4);r.Bb(1),r.Xb(e.currentPart.getWinner().get()),r.Vb(1)}}function YU(e,t){if(1&e&&(r.Qb(0,"div"),r.Ac(1,WU,2,0,"p",84),r.Ac(2,ZU,2,0,"p",85),r.Ac(3,QU,2,1,"p",85),r.Pb()),2&e){const e=r.fc(3);r.Bb(1),r.mc("ngIf",e.currentPart.getWinner().get()===e.getPlayerName()),r.Bb(1),r.mc("ngIf",e.currentPart.getWinner().get()!==e.getPlayerName()&&e.isPlaying()),r.Bb(1),r.mc("ngIf",!1===e.isPlaying())}}function KU(e,t){if(1&e&&(r.Qb(0,"p",86),r.Ub(1,91),r.Pb()),2&e){const e=r.fc(4);r.Bb(1),r.Xb(e.currentPart.getLoser().get()),r.Vb(1)}}function JU(e,t){1&e&&(r.Qb(0,"p",88),r.Ub(1,92),r.Pb())}function XU(e,t){if(1&e&&(r.Qb(0,"p",88),r.Ub(1,93),r.Pb()),2&e){const e=r.fc(4);r.Bb(1),r.Xb(e.currentPart.getLoser().get()),r.Vb(1)}}function eV(e,t){if(1&e&&(r.Qb(0,"div"),r.Ac(1,KU,2,1,"p",84),r.Ac(2,JU,2,0,"p",85),r.Ac(3,XU,2,1,"p",85),r.Pb()),2&e){const e=r.fc(3);r.Bb(1),r.mc("ngIf",e.currentPart.getWinner().get()===e.getPlayerName()),r.Bb(1),r.mc("ngIf",e.currentPart.getWinner().get()!==e.getPlayerName()&&e.isPlaying()),r.Bb(1),r.mc("ngIf",!1===e.isPlaying())}}function tV(e,t){1&e&&(r.Qb(0,"p",95),r.Ub(1,96),r.Pb())}function nV(e,t){if(1&e&&(r.Qb(0,"p",95),r.Ub(1,97),r.Pb()),2&e){const e=r.fc(4);r.Bb(1),r.Xb(e.currentPart.getLoser().get()),r.Vb(1)}}function rV(e,t){if(1&e&&(r.Qb(0,"div"),r.Ac(1,tV,2,0,"p",94),r.Ac(2,nV,2,1,"p",94),r.Pb()),2&e){const e=r.fc(3);r.Bb(1),r.mc("ngIf",e.currentPart.getWinner().get()!==e.getPlayerName()&&e.isPlaying()),r.Bb(1),r.mc("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get()===e.getPlayerName())}}function iV(e,t){if(1&e&&(r.Qb(0,"div",72),r.Mb(1,"hr"),r.Ac(2,zU,3,0,"div",26),r.Ac(3,qU,4,3,"div",26),r.Ac(4,YU,4,3,"div",26),r.Ac(5,eV,4,3,"div",26),r.Ac(6,rV,3,2,"div",26),r.Pb()),2&e){const e=r.fc(2);r.Bb(2),r.mc("ngIf",e.currentPart.isHardDraw()),r.Bb(1),r.mc("ngIf",e.currentPart.isAgreedDraw()),r.Bb(1),r.mc("ngIf",e.currentPart.isWin()),r.Bb(1),r.mc("ngIf",e.currentPart.isTimeout()),r.Bb(1),r.mc("ngIf",e.currentPart.isResign())}}function oV(e,t){1&e&&(r.Qb(0,"button",98),r.Ub(1,99),r.Pb())}function sV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",100),r.cc("click",function(){return r.wc(e),r.fc(2).proposeRematch()}),r.Ub(1,101),r.Pb()}}function aV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",102),r.cc("click",function(){return r.wc(e),r.fc(2).acceptRematch()}),r.Ub(1,103),r.Pb()}}function cV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",7),r.Qb(1,"div",8),r.Qb(2,"div",9),r.Ac(3,TU,4,2,"div",10),r.Qb(4,"div",11),r.Ac(5,AU,2,2,"p",12),r.Ac(6,kU,2,1,"p",13),r.Qb(7,"app-count-down",14,15),r.cc("outOfTimeAction",function(){return r.wc(e),r.fc().reachedOutOfTime(0)})("addTimeToOpponent",function(){return r.wc(e),r.fc().addGlobalTime()}),r.Pb(),r.Qb(9,"app-count-down",16,17),r.cc("outOfTimeAction",function(){return r.wc(e),r.fc().reachedOutOfTime(0)})("addTimeToOpponent",function(){return r.wc(e),r.fc().addTurnTime()}),r.Pb(),r.Pb(),r.Qb(11,"p",18),r.Ub(12,19),r.Pb(),r.Qb(13,"div",11),r.Ac(14,NU,2,2,"p",20),r.Ac(15,MU,2,1,"p",21),r.Qb(16,"app-count-down",22,23),r.cc("outOfTimeAction",function(){return r.wc(e),r.fc().reachedOutOfTime(1)})("addTimeToOpponent",function(){return r.wc(e),r.fc().addGlobalTime()}),r.Pb(),r.Qb(18,"app-count-down",24,25),r.cc("outOfTimeAction",function(){return r.wc(e),r.fc().reachedOutOfTime(1)})("addTimeToOpponent",function(){return r.wc(e),r.fc().addTurnTime()}),r.Pb(),r.Pb(),r.Mb(20,"hr"),r.Ac(21,VU,9,8,"ng-container",26),r.Ac(22,iV,7,5,"div",27),r.Ac(23,oV,2,0,"button",28),r.Ac(24,sV,2,0,"button",29),r.Ac(25,aV,2,0,"button",30),r.Pb(),r.Pb(),r.Qb(26,"div",31),r.Qb(27,"div",32),r.Mb(28,"app-game-includer"),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=r.fc();r.Bb(3),r.mc("ngIf",e.currentPart),r.Bb(2),r.mc("ngIf",e.players[0].isPresent()),r.Bb(1),r.mc("ngIf",e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),r.Bb(1),r.mc("dangerTimeLimit",6e4)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",1===e.observerRole&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),r.Bb(2),r.mc("dangerTimeLimit",15e3)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",1===e.observerRole&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),r.Bb(5),r.mc("ngIf",e.players[1].isPresent()),r.Bb(1),r.mc("ngIf",e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),r.Bb(1),r.mc("dangerTimeLimit",6e4)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",0===e.observerRole&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),r.Bb(2),r.mc("dangerTimeLimit",15e3)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",0===e.observerRole&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),r.Bb(3),r.mc("ngIf",e.isPlaying()),r.Bb(1),r.mc("ngIf",e.endGame),r.Bb(1),r.mc("ngIf",e.endGame),r.Bb(1),r.mc("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),r.Bb(1),r.mc("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),r.Bb(1),r.mc("ngClass",e.getBoardHighlight())}}let lV=(()=>{class e{constructor(e){this.value=e}}return e.PRE_START_DOC=new e("PRE_START_DOC"),e.STARTING_DOC=new e("STARTING_DOC"),e.DUPLICATE=new e("DUPLICATE"),e.MOVE_WITHOUT_TIME=new e("MOVE_WITHOUT_TIME"),e.MOVE=new e("MOVE"),e.REQUEST=new e("REQUEST"),e.END_GAME=new e("END_GAME"),e.END_GAME_WITHOUT_TIME=new e("END_GAME_WITHOUT_TIME"),e.ACCEPT_TAKE_BACK_WITHOUT_TIME=new e("ACCEPT_TAKE_BACK_WITHOUT_TIME"),e})(),uV=(()=>{class e extends Hj{constructor(t,n,r,i,o,s){super(t,n,o),this.router=r,this.userService=i,this.gameService=s,this.gameStarted=!1,this.opponent=null,this.playerName=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=XO.empty(),this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,qO(e.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return $O.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameTypeFromURL(){return $O.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.observerRole===CS.ZERO.value||this.observerRole===CS.ONE.value}getPlayer(){return CS.of(this.observerRole)}getPlayerName(){return $O.getNonNullable(this.playerName)}isPlayer(e){return this.observerRole===e.value}isOpponent(e){return this.observerRole!==e.value}redirectIfPartIsInvalid(){var e=this;return GO(function*(){const t=e.extractGameTypeFromURL();if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){const t="/notFound";e.routerEventsSub.unsubscribe(),yield e.router.navigate([t])}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartIsInvalid()}ngOnInit(){var t=this;return GO(function*(){qO(e.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),t.routerEventsSub=t.router.events.subscribe(function(){var e=GO(function*(e){e instanceof Ei&&(yield t.setCurrentPartIdOrRedirect())});return function(t){return e.apply(this,arguments)}}()),t.userSub=t.authenticationService.getUserObs().subscribe(e=>{t.playerName=e.username.get()}),yield t.setCurrentPartIdOrRedirect()})()}startGame(t){var n=this;return GO(function*(){qO(e.VERBOSE,"OnlineGameWrapperComponent.startGame"),WO(!1===n.gameStarted,"Should not start already started game"),n.joiner=t,n.gameStarted=!0,setTimeout(GO(function*(){n.afterGameIncluderViewInit(),yield n.startPart()}),1)})()}startPart(){var t=this;qO(e.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,function(){var e=GO(function*(e){WO(e.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield t.onCurrentPartUpdate(e.get())});return function(t){return e.apply(this,arguments)}}())}onCurrentPartUpdate(t){var n=this;return GO(function*(){const r=new nS(n.currentPartId,t);qO(e.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:n.currentPart,then:t.data,before_part_turn:r.data.turn,before_state_turn:n.gameComponent.rules.node.gameState.turn,nbPlayedMoves:r.data.listMoves.length}});const i=n.getUpdateType(r),o=t.turn;qO(e.VERBOSE,i===lV.REQUEST?"UpdateType: Request("+$O.getNonNullable(r.data.request).code+") ("+o+")":"UpdateType: "+i.value+"("+o+")");const s=n.currentPart;switch(n.currentPart=r,i){case lV.REQUEST:return yield n.onRequest($O.getNonNullable(r.data.request),s);case lV.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(n.currentPart=s);case lV.DUPLICATE:return;case lV.END_GAME_WITHOUT_TIME:return void(n.currentPart=s);case lV.END_GAME:return n.applyEndGame();case lV.MOVE_WITHOUT_TIME:return void(n.currentPart=s);case lV.MOVE:return n.msToSubstract=n.getLastUpdateTime(s,r,i),n.doNewMoves(r);case lV.PRE_START_DOC:const e=null==n.currentPart||null!=n.currentPart.data.beginning;return void WO(null==s||null==s.data.beginning||e,"old part had no beginning time or new part has, we did not expect this!");default:return WO(i===lV.STARTING_DOC,"Unexpected update type "+i),n.setChronos(),n.setPlayersDatas(r),n.startCountDownFor(CS.ZERO)}})()}getUpdateType(t){const n=Gj.from(null!=this.currentPart?this.currentPart.data:null,t.data);qO(e.VERBOSE,{diff:n});const r=n.countChanges();if(0===r)return lV.DUPLICATE;if(t.data.request){const e=null!=n.removed.lastUpdateTime;return"TakeBackAccepted"===t.data.request.code&&e?lV.ACCEPT_TAKE_BACK_WITHOUT_TIME:lV.REQUEST}if(this.isMove(n,r))return 1===t.data.turn?null==t.data.lastUpdateTime?lV.MOVE_WITHOUT_TIME:lV.MOVE:null==n.modified.lastUpdateTime?lV.MOVE_WITHOUT_TIME:lV.MOVE;if(null==t.data.beginning)return lV.PRE_START_DOC;if(t.data.result!==tS.UNACHIEVED.value){const e=null==n.modified.lastUpdateTime;return null!=n.modified.turn&&e?lV.END_GAME_WITHOUT_TIME:lV.END_GAME}return WO(null!=t.data.beginning&&0===t.data.listMoves.length,"Unexpected update: "+JSON.stringify(n)),lV.STARTING_DOC}isMove(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){const n=3;return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+n}return!1}getLastUpdateTime(e,t,n){const r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);WO(null!=r,"TODO: OLD_TIME WAS NULL, UNDO COMMENT AND TEST!"),WO(null!=i,"TODO UPDATE_TIME WAS NULL, UNDO COMMENT AND TEST!");const o=CS.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn($O.getNonNullable(r),$O.getNonNullable(i),n,o)}getMoreRecentTime(e){return null==e.data.lastUpdateTime?e.data.beginning:e.data.lastUpdateTime}getTimeUsedForLastTurn(e,t,n,r){const i=(o=e,qj(t)-qj(o));var o;const s=[0,0];return s[r.value]=i,s}setChronos(){qO(e.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.joiner.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.joiner.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(e){this.switchPlayer();const t=cS.copyImmutableArray(e.data.listMoves),n=this.gameComponent.rules;for(;n.node.gameState.turn<t.length;){const e=n.node.gameState.turn,r=this.gameComponent.encoder.decode(t[e]),i=n.isLegal(r,n.node.gameState),o="We received an incorrect db move: "+r.toString()+" in "+t+" at turn "+e+'because "'+i.getReasonOr("")+'"';WO(i.isSuccess(),o),n.choose(r)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}switchPlayer(){qO(e.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const t=CS.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();const n=t.getOpponent();this.didUserPlay(n)&&this.pauseCountDownsFor(n),this.didUserPlay(t)?(qO(e.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(t)):this.startCountDownFor(t)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){const t=this.currentPart,n=CS.fromTurn(t.data.turn);this.endGame=!0,[tS.VICTORY,tS.HARD_DRAW].some(e=>e.value===t.data.result)?this.doNewMoves(this.currentPart):(WO(!0===[tS.RESIGN,tS.TIMEOUT,tS.HARD_DRAW,tS.AGREED_DRAW_BY_ZERO,tS.AGREED_DRAW_BY_ONE].some(e=>e.value===t.data.result),"Unknown type of end game ("+t.data.result+")"),qO(e.VERBOSE,"endGame est true et winner est "+t.getWinner())),this.stopCountdownsFor(n)}notifyDraw(e,t){this.endGame=!0;const n=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,n,e,[0,0],t,!0)}notifyTimeoutVictory(e,t,n,r){var i=this;return GO(function*(){i.endGame=!0;const o=i.currentPart.setWinnerAndLoser(e,r);i.currentPart=o,yield i.gameService.notifyTimeout(i.currentPartId,t,n,e,r)})()}notifyVictory(t,n){qO(e.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);r===KI.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(WO(r===KI.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0;const i=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,i,t,[0,0],n,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){return WO(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.currentPart.data.request.data.player===this.getPlayer().getOpponent().value||this.getTakeBackRequester()!==CS.NONE)}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return e!==CS.NONE&&this.isOpponent(e)}getTakeBackRequester(){if(null==this.currentPart)return CS.NONE;const e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?ES.getPlayer(e):CS.NONE}canProposeDraw(){return WO(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&ES.getPlayer(this.currentPart.data.request)===this.getPlayer().getOpponent()||this.isOpponentWaitingForDrawResponse()||this.getDrawRequester()!==CS.NONE)}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==CS.NONE&&this.isOpponent(e)}getDrawRequester(){if(null==this.currentPart)return CS.NONE;const e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?ES.getPlayer(e):CS.NONE}onRequest(t,n){var r=this;return GO(function*(){switch(qO(e.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:t,oldPart:n}),t.code){case"TakeBackAsked":case"TakeBackRefused":break;case"TakeBackAccepted":r.takeBackTo(r.currentPart.data.turn);break;case"RematchProposed":r.rematchProposed=!0;const n=ES.getPlayer(t).getOpponent();r.isPlayer(n)&&(qO(e.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0);break;case"RematchAccepted":yield r.router.navigate(["/nextGameLoading"]),yield r.router.navigate(["/play",ES.getTypeGame(t),ES.getPartId(t)]);break;case"DrawProposed":case"DrawRefused":break;case"AddTurnTime":const i=3e4,o=CS.of(t.data.player);r.addTurnTimeTo(o,i);break;case"AddGlobalTime":const s=3e5,a=CS.of(t.data.player);r.addGlobalTimeTo(a,s);break;default:$O.expectToBe(t.code,"DrawAccepted","Unknown RequestType : "+t.code+" for "+JSON.stringify(t)),yield r.acceptDraw()}})()}takeBackTo(e){if(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const t=CS.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}setPlayersDatas(t){qO(e.VERBOSE,{OnlineGameWrapper_setPlayersDatas:t}),this.players=[XO.of(t.data.playerZero),XO.ofNullable(t.data.playerOne)],WO(null!=t.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[t.data.turn%2].get();let n=XO.empty();if(this.players[0].equalsValue(this.getPlayerName())?(this.observerRole=CS.ZERO.value,n=this.players[1]):this.players[1].equalsValue(this.getPlayerName())?(this.observerRole=CS.ONE.value,n=this.players[0]):this.observerRole=CS.NONE.value,n.isPresent()){const e=new dS(e=>{this.opponent=e[0].data},e=>{this.opponent=e[0].data},e=>{throw new Error("OnlineGameWrapper: Opponent was deleted, what sorcery is this: "+JSON.stringify(e))});this.opponentSubscription=XO.of(this.userService.observeUserByUsername(n.get(),e))}}onLegalUserMove(t,n){var r=this;return GO(function*(){if(qO(e.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!r.isOpponentWaitingForTakeBackResponse())return r.updateDBBoard(t,r.msToSubstract,n);r.gameComponent.message("You must answer to take back request")})()}updateDBBoard(t,n,r){var i=this;return GO(function*(){const o=i.gameComponent.encoder.encodeMove(t);qO(e.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+t.toString()+", "+r+")"),i.gameComponent.rules.choose(t);const s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);if(s.isEndGame)return s===KI.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r);{const e=i.getPlayer();return i.gameService.updateDBBoard(i.currentPartId,e,o,n,r)}})()}resign(){var e=this;return GO(function*(){const t=e.getLastIndex(),n=e.getPlayer(),r=e.players[e.observerRole%2].get(),i=e.players[(e.observerRole+1)%2].get();yield e.gameService.resign(e.currentPartId,t,n,i,r)})()}getLastIndex(){return this.currentPart.data.lastUpdate.index}reachedOutOfTime(t){var n=this;return GO(function*(){qO(e.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+t+")");const r=n.getLastIndex(),i=n.getPlayer();n.stopCountdownsFor(CS.of(t));const o=$O.getNonNullable(n.opponent);if(t===n.observerRole){const e=$O.getNonNullable(o.username);yield n.notifyTimeoutVictory(e,i,r,n.getPlayerName())}else if(n.endGame)qO(!0,"time might be better handled in the future");else if(n.opponentIsOffline()){const e=$O.getNonNullable(o.username);yield n.notifyTimeoutVictory(n.getPlayerName(),i,t,e),n.endGame=!0}})()}acceptRematch(){var e=this;return GO(function*(){WO(e.isPlaying(),"Non playing should not call acceptRematch");const t=new nS(e.currentPartId,e.currentPart.data);return yield e.gameService.acceptRematch(t,e.getLastIndex(),e.getPlayer()),!0})()}proposeRematch(){var e=this;return GO(function*(){return WO(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.getPlayer()),!0})()}proposeDraw(){return this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}acceptDraw(){return this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}refuseDraw(){return this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}askTakeBack(){return this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}acceptTakeBack(){var e=this;return GO(function*(){const t=e.getPlayer();yield e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,t,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}startCountDownFor(t){qO(e.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[t.value]=!0,t===CS.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(t,n=!0){let r;qO(e.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),t===CS.ZERO?(this.chronoZeroGlobal.changeDuration($O.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),r=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration($O.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),r=this.chronoOneTurn),n?(r.setDuration(1e3*this.joiner.maximalMoveDuration),r.start()):r.resume()}pauseCountDownsFor(t,n=!0){let r;qO(e.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+t.value+") (turn "+this.currentPart.data.turn+")"),t===CS.ZERO?(this.chronoZeroGlobal.pause(),r=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),r=this.chronoOneTurn),n?r.stop():r.pause()}stopCountdownsFor(t){qO(e.VERBOSE,"cdc::stopCountDownsFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),t===CS.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":0===e?"has-text-white":"has-text-black"}opponentIsOffline(){return null!=this.opponent&&"offline"===this.opponent.state}canResign(){return WO(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}addGlobalTime(){const e=this.getPlayer(),t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}addTurnTime(){const e=this.getPlayer();return this.gameService.addTurnTime(e,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,t){const n=CS.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===CS.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}addGlobalTimeTo(e,t){e===CS.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}ngOnDestroy(){null!=this.routerEventsSub&&null!=this.routerEventsSub.unsubscribe&&this.routerEventsSub.unsubscribe(),null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving())}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(r.j),r.Lb(Po),r.Lb(qs),r.Lb(gS),r.Lb(vS),r.Lb(TS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(r.Hc(vU,1),r.Hc(bU,1),r.Hc(_U,1),r.Hc(wU,1),r.Hc(CU,1),r.Hc(EU,1)),2&e){let e;r.uc(e=r.dc())&&(t.partCreation=e.first),r.uc(e=r.dc())&&(t.chatComponent=e.first),r.uc(e=r.dc())&&(t.chronoZeroGlobal=e.first),r.uc(e=r.dc())&&(t.chronoOneGlobal=e.first),r.uc(e=r.dc())&&(t.chronoZeroTurn=e.first),r.uc(e=r.dc())&&(t.chronoOneTurn=e.first)}},features:[r.yb],decls:5,vars:4,consts:function(){let e,t,n,r,i,o,s,a,c,l,u,h,d,f,p,g,m,y,v,b,_,w,C,E,O,S,P,I,T;return e=$localize`vs.`,t=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,n=$localize`It is your turn.`,r=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`Resign`,a=$localize`Propose a draw`,c=$localize`Accept draw`,l=$localize`Reject draw`,u=$localize`Pass a turn`,h=$localize`Accept take back`,d=$localize`Reject take back`,f=$localize`Ask to take back one move`,p=$localize`Draw`,g=$localize`You agreed to draw.`,m=$localize`Your draw proposal has been accepted.`,y=$localize`Players agreed to draw.`,v=$localize`You won.`,b=$localize`You lost.`,_=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,w=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,C=$localize`You reached your time limit.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,O=$localize`You resigned.`,S=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,P=$localize`Go back to the game list`,I=$localize`Propose to play again`,T=$localize`Accept to play again`,[["id","partCreation",3,"partId","userName","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","userName","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],e,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],n,r,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],s,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],a,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],c,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],l,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],d,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],f,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],p,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],g,["id","yourOpponentAgreedToDrawIndicator",1,"title"],m,["id","playersAgreedToDraw",1,"title"],y,["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],v,[1,"title"],b,_,w,C,E,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],O,S,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],P,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],I,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],T]},template:function(e,t){1&e&&(r.Ac(0,OU,2,2,"app-part-creation",0),r.Ac(1,cV,29,27,"div",1),r.Qb(2,"div",2),r.Qb(3,"div",3),r.Mb(4,"app-chat",4),r.Pb(),r.Pb()),2&e&&(r.mc("ngIf",!1===t.gameStarted),r.Bb(1),r.mc("ngIf",t.gameStarted),r.Bb(3),r.mc("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[fe,Aj,gU,yU,le,Vj,Ws],encapsulation:2}),e})();function hV(e,t){if(1&e&&(r.Qb(0,"option",25),r.Cc(1),r.Pb()),2&e){const e=t.$implicit;r.mc("value",e.name),r.Bb(1),r.Dc(e.name)}}function dV(e,t){if(1&e&&(r.Qb(0,"option",25),r.Ub(1,29),r.Pb()),2&e){const e=t.$implicit;r.mc("value",e),r.Bb(1),r.Xb(e),r.Vb(1)}}const fV=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function pV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"select",26),r.cc("ngModelChange",function(t){return r.wc(e),r.fc(2).aiDepths[0]=t})("change",function(){return r.wc(e),r.fc(2).updatePlayer(0)}),r.Qb(1,"option",27),r.Ub(2,28),r.Pb(),r.Ac(3,dV,2,2,"option",16),r.Pb()}if(2&e){const e=r.fc(2);r.mc("ngModel",e.aiDepths[0]),r.Bb(3),r.mc("ngForOf",r.qc(2,fV))}}function gV(e,t){if(1&e&&(r.Qb(0,"p",30),r.Ub(1,31),r.Pb()),2&e){const e=r.fc(2);r.Bb(1),r.Xb(e.gameComponent.scores.get()[0]),r.Vb(1)}}function mV(e,t){if(1&e&&(r.Qb(0,"option",25),r.Cc(1),r.Pb()),2&e){const e=t.$implicit;r.mc("value",e.name),r.Bb(1),r.Dc(e.name)}}function yV(e,t){if(1&e&&(r.Qb(0,"option",25),r.Ub(1,34),r.Pb()),2&e){const e=t.$implicit;r.mc("value",e),r.Bb(1),r.Xb(e),r.Vb(1)}}function vV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"select",32),r.cc("ngModelChange",function(t){return r.wc(e),r.fc(2).aiDepths[1]=t})("change",function(){return r.wc(e),r.fc(2).updatePlayer(1)}),r.Qb(1,"option",27),r.Ub(2,33),r.Pb(),r.Ac(3,yV,2,2,"option",16),r.Pb()}if(2&e){const e=r.fc(2);r.mc("ngModel",e.aiDepths[1]),r.Bb(3),r.mc("ngForOf",r.qc(2,fV))}}function bV(e,t){if(1&e&&(r.Qb(0,"p",35),r.Ub(1,36),r.Pb()),2&e){const e=r.fc(2);r.Bb(1),r.Xb(e.gameComponent.scores.get()[1]),r.Vb(1)}}function _V(e,t){if(1&e&&(r.Qb(0,"h4"),r.Ub(1,40),r.Pb()),2&e){const e=r.fc(3);r.Bb(1),r.Xb(e.winner.get()),r.Vb(1)}}function wV(e,t){1&e&&(r.Qb(0,"h4",41),r.Ub(1,42),r.Pb())}function CV(e,t){if(1&e&&(r.Qb(0,"div",37),r.Ac(1,_V,2,1,"h4",38),r.Ac(2,wV,2,0,"h4",39),r.Pb()),2&e){const e=r.fc(2);r.Bb(1),r.mc("ngIf",e.winner.isPresent()),r.Bb(1),r.mc("ngIf",e.winner.isAbsent())}}function EV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",6),r.Qb(1,"div",7),r.Qb(2,"p",8),r.Ub(3,9),r.Pb(),r.Pb(),r.Qb(4,"div",10),r.Qb(5,"div",11),r.Qb(6,"div",12),r.Qb(7,"select",13),r.cc("change",function(){return r.wc(e),r.fc().updatePlayer(0)})("ngModelChange",function(t){return r.wc(e),r.fc().playerSelection[0]=t}),r.Qb(8,"option",14),r.Ub(9,15),r.Pb(),r.Ac(10,hV,2,2,"option",16),r.Pb(),r.Pb(),r.Qb(11,"div",12),r.Ac(12,pV,4,3,"select",17),r.Pb(),r.Ac(13,gV,2,1,"p",18),r.Pb(),r.Qb(14,"div",19),r.Qb(15,"div",12),r.Qb(16,"select",20),r.cc("change",function(){return r.wc(e),r.fc().updatePlayer(1)})("ngModelChange",function(t){return r.wc(e),r.fc().playerSelection[1]=t}),r.Qb(17,"option",14),r.Ub(18,21),r.Pb(),r.Ac(19,mV,2,2,"option",16),r.Pb(),r.Pb(),r.Qb(20,"div",12),r.Ac(21,vV,4,3,"select",22),r.Pb(),r.Ac(22,bV,2,1,"p",23),r.Pb(),r.Pb(),r.Ac(23,CV,3,2,"div",24),r.Pb()}if(2&e){const e=r.fc();r.Bb(3),r.Xb(e.gameComponent.rules.node.gameState.turn+1),r.Vb(3),r.Bb(4),r.mc("ngModel",e.playerSelection[0]),r.Bb(3),r.mc("ngForOf",e.gameComponent.availableMinimaxes),r.Bb(2),r.mc("ngIf",!1===e.players[0].equalsValue("human")),r.Bb(1),r.mc("ngIf",e.gameComponent.scores.isPresent()),r.Bb(3),r.mc("ngModel",e.playerSelection[1]),r.Bb(3),r.mc("ngForOf",e.gameComponent.availableMinimaxes),r.Bb(2),r.mc("ngIf",!1===e.players[1].equalsValue("human")),r.Bb(1),r.mc("ngIf",e.gameComponent.scores.isPresent()),r.Bb(1),r.mc("ngIf",e.endGame)}}function OV(e,t){if(1&e&&(r.Ob(0),r.Cc(1),r.Mb(2,"br"),r.Nb()),2&e){const e=t.$implicit,n=r.fc(3);r.Bb(1),r.Ec(" ",e.name+": "+e.getBoardValue(n.gameComponent.rules.node)," ")}}function SV(e,t){if(1&e&&(r.Ob(0),r.Ac(1,OV,3,1,"ng-container",48),r.Cc(2),r.Mb(3,"br"),r.Cc(4),r.Mb(5,"br"),r.Nb()),2&e){const e=r.fc(2);r.Bb(1),r.mc("ngForOf",e.gameComponent.availableMinimaxes),r.Bb(1),r.Ec(" Created ",e.getCreatedNodes()," nodes."),r.Bb(2),r.Ec(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function PV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",49),r.cc("click",function(){return r.wc(e),r.fc(2).gameComponent.pass()}),r.Ub(1,50),r.Pb()}}function IV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",51),r.cc("click",function(){return r.wc(e),r.fc(2).takeBack()}),r.Ub(1,52),r.Pb()}}function TV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",43),r.Ac(1,SV,6,3,"ng-container",38),r.Ac(2,PV,2,0,"button",44),r.Ac(3,IV,2,0,"button",45),r.Qb(4,"button",46),r.cc("click",function(){return r.wc(e),r.fc().restartGame()}),r.Ub(5,47),r.Pb(),r.Pb()}if(2&e){const e=r.fc();r.Bb(1),r.mc("ngIf",e.gameComponent.rules.node.move),r.Bb(1),r.mc("ngIf",!1===e.endGame&&e.gameComponent.canPass),r.Bb(1),r.mc("ngIf",e.canTakeBack())}}let AV=(()=>{class e extends Hj{constructor(t,n,r,i){super(t,n,r),this.cdr=i,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winner=XO.empty(),this.botTimeOut=1e3,this.players=[XO.of(this.playerSelection[0]),XO.of(this.playerSelection[1])],qO(e.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return QI.createdNodes}getMinimaxTime(){return QI.minimaxTime}ngAfterViewInit(){this.afterGameIncluderViewInit(),this.restartGame(),this.cdr.detectChanges()}updatePlayer(e){this.players[e]=XO.of(this.playerSelection[e]),this.proposeAIToPlay()}onLegalUserMove(t){var n=this;return GO(function*(){qO(e.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),n.gameComponent.rules.choose(t),n.updateBoard(),n.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner!==CS.NONE&&(this.winner=XO.of($localize`Player ${e.winner.value+1}`)))}proposeAIToPlay(){const e=this.getPlayingAI();e.isPresent()&&setTimeout(()=>{this.doAIMove(e.get())},this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return XO.empty();const e=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[e]?XO.empty():XO.ofNullable(this.gameComponent.availableMinimaxes.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e){const t=this.gameComponent.rules;WO(t.getGameStatus(t.node)===KI.ONGOING,"IA should not try to play when game is over!");const n=Number.parseInt(this.aiDepths[t.node.gameState.turn%2%2]),r=t.node.findBestMove(n,e,!0);if(!t.choose(r))throw new Error("AI choosed illegal move ("+r.toString()+")");this.updateBoard(),this.cdr.detectChanges(),this.proposeAIToPlay()}canTakeBack(){return this.gameComponent.rules.node.gameState.turn>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){const e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new YI(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=XO.empty(),this.proposeAIToPlay()}getPlayerName(){return"human"}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(r.j),r.Lb(Po),r.Lb(vS),r.Lb(r.h))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-local-game-wrapper"]],features:[r.yb],decls:7,vars:3,consts:function(){let e,t,n,r,i,o,s,a,c,l,u,h,d,f;return e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`Human`,n=$localize`Human`,r=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`Pick the level`,a=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won`,u=$localize`Draw`,h=$localize`Start a new game`,d=$localize`Pass a turn`,f=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],t,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],n,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],r,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],s,a,["id","scoreZero",1,"block"],c,["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],l,["id","draw"],u,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],h,[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],f]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Ac(2,EV,24,10,"div",2),r.Ac(3,TV,6,3,"div",3),r.Pb(),r.Qb(4,"div",4),r.Qb(5,"div",5),r.Mb(6,"app-game-includer"),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.Bb(2),r.mc("ngIf",t.gameComponent),r.Bb(1),r.mc("ngIf",t.gameComponent),r.Bb(1),r.mc("ngClass",t.getBoardHighlight()))},directives:[fe,le,Vj,Pn,jt,pn,In,Nn,he],encapsulation:2,changeDetection:0}),e})(),kV=(()=>{class e{}return e.STEP_FINISHED=()=>$localize`Step finished!`,e.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,e})();function NV(e,t){if(1&e&&(r.Qb(0,"div",20),r.Qb(1,"div",21),r.Ub(2,22),r.Pb(),r.Qb(3,"div",23),r.Cc(4),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(4),r.Dc(e.currentReason.get())}}function MV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",24),r.cc("click",function(){return r.wc(e),r.fc().retry()}),r.Ub(1,25),r.Pb()}}function xV(e,t){1&e&&(r.Ob(0),r.Ub(1,30),r.Nb())}function RV(e,t){1&e&&(r.Ob(0),r.Ub(1,31),r.Nb())}function DV(e,t){if(1&e&&r.Ac(0,RV,2,0,"ng-container",27),2&e){r.fc();const e=r.vc(5),t=r.fc();r.mc("ngIf",t.stepFinished&&t.stepFinished[t.stepIndex])("ngIfElse",e)}}function LV(e,t){1&e&&(r.Ob(0),r.Ub(1,32),r.Nb())}function BV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",26),r.cc("click",function(){return r.wc(e),r.fc().next()}),r.Ac(1,xV,2,0,"ng-container",27),r.Ac(2,DV,1,2,"ng-template",null,28,r.Bc),r.Ac(4,LV,2,0,"ng-template",null,29,r.Bc),r.Pb()}if(2&e){const e=r.vc(3),t=r.fc();r.Bb(1),r.mc("ngIf",t.steps[t.stepIndex]&&t.steps[t.stepIndex].isInformation())("ngIfElse",e)}}function FV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",33),r.cc("click",function(){return r.wc(e),r.fc().start()}),r.Ub(1,34),r.Pb()}}function jV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",35),r.cc("click",function(){return r.wc(e),r.fc().playLocally()}),r.Ub(1,36),r.Pb()}}function UV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",37),r.cc("click",function(){return r.wc(e),r.fc().createGame()}),r.Ub(1,38),r.Pb()}}function VV(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",39),r.cc("click",function(){return r.wc(e),r.fc().showSolution()}),r.Ub(1,40),r.Pb()}}function zV(e,t){if(1&e&&(r.Ob(0),r.Qb(1,"option",42),r.Cc(2),r.Pb(),r.Nb()),2&e){const e=r.fc(),t=e.index,n=e.$implicit;r.Bb(1),r.nc("id","step_",t,""),r.mc("value",t),r.Bb(1),r.Dc(n.title)}}function HV(e,t){1&e&&(r.Ob(0),r.Cc(1,"v "),r.Nb())}function GV(e,t){1&e&&r.Cc(0,"x ")}function $V(e,t){if(1&e&&(r.Qb(0,"option",43),r.Ac(1,HV,2,0,"ng-container",27),r.Ac(2,GV,1,0,"ng-template",null,44,r.Bc),r.Qb(4,"span",45),r.Cc(5),r.Pb(),r.Pb()),2&e){const e=r.vc(3),t=r.fc(),n=t.index,i=t.$implicit,o=r.fc();r.mc("value",n),r.Bb(1),r.mc("ngIf",o.stepFinished[n])("ngIfElse",e),r.Bb(3),r.nc("id","step_",n,""),r.Bb(1),r.Dc(i.title)}}function qV(e,t){if(1&e&&(r.Ob(0),r.Ac(1,zV,3,3,"ng-container",27),r.Ac(2,$V,6,5,"ng-template",null,41,r.Bc),r.Nb()),2&e){const e=t.index,n=r.vc(3),i=r.fc();r.Bb(1),r.mc("ngIf",e===i.stepIndex)("ngIfElse",n)}}let WV=(()=>{class e extends Hj{constructor(t,n,r,i,o){super(t,n,i),this.router=r,this.cdr=o,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=XO.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,qO(e.VERBOSE,"TutorialGameWrapperComponent.constructor")}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){qO(e.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),this.afterGameIncluderViewInit(),this.start()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(t){qO(e.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:t}}),this.steps=t,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(t){qO(e.VERBOSE,"tutorialGameWrapperComponent.showStep("+t+")"),this.moveAttemptMade=!1,this.stepFinished[t]=!1,this.updateSuccessCount(),this.stepIndex=t;const n=this.steps[this.stepIndex];this.currentMessage=n.instruction,this.currentReason=XO.empty(),this.gameComponent.rules.node=new YI(n.state,XO.empty(),n.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}onLegalUserMove(t){var n=this;return GO(function*(){qO(e.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:t}});const r=n.steps[n.stepIndex];if(WO(n.gameComponent.rules.choose(t),"It should be impossible to call onLegalUserMove with an illegal move"),qO(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),n.gameComponent.updateBoard(),n.moveAttemptMade=!0,r.isPredicate()){const e=n.gameComponent.rules.node.gameState,i=$O.getNonNullable(r.predicate)(t,e);i.isSuccess()?n.showStepSuccess(r.getSuccessMessage()):n.currentReason=XO.of(i.getReason())}else if(r.isAnyMove())qO(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),n.showStepSuccess(r.getSuccessMessage());else{WO(r.isMove(),"cannot reach here with a click step");const i=r;i.acceptedMoves.some(e=>e.equals(t))?(qO(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),n.showStepSuccess(i.getSuccessMessage())):(qO(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),n.currentReason=XO.of(i.getFailureMessage()))}n.cdr.detectChanges()})()}retry(){qO(e.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(t){if(qO(e.VERBOSE,"tutorialGameWrapper.onUserClick("+t+")"),this.currentReason=XO.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return aS.failure(kV.STEP_FINISHED());const n=this.steps[this.stepIndex];return n.isClick()?(this.gameComponent.updateBoard(),$O.getNonNullable(n.acceptedClicks).some(e=>e===t)?this.showStepSuccess(n.getSuccessMessage()):this.currentMessage=n.getFailureMessage(),aS.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?(setTimeout(()=>{this.cdr.detectChanges()},10),aS.SUCCESS):aS.failure(kV.INFORMATIONAL_STEP())}onCancelMove(t){qO(e.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+t+")"),void 0!==t&&(this.currentReason=XO.of(t)),this.cdr.detectChanges()}showStepSuccess(t){qO(e.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=t,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var t=this;return GO(function*(){qO(e.VERBOSE,"tutorialGameWrapper.showSolution()");const n=t.steps[t.stepIndex];WO(n.hasSolution(),"showSolution called on a step with no solution, this should not be reachable");const r=n,i=r.getSolution();t.showStep(t.stepIndex),t.gameComponent.rules.choose(i),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,t.currentMessage=r.getSuccessMessage(),t.cdr.detectChanges()})()}playLocally(){var e=this;return GO(function*(){const t=$O.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return GO(function*(){const t=$O.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayerName(){return""}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(r.Lb(r.j),r.Lb(Po),r.Lb(qs),r.Lb(vS),r.Lb(r.h))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[r.yb],decls:22,vars:15,consts:function(){let e,t,n,r,i,o,s,a,c;return e=$localize`Failure`,t=$localize`Try again`,n=$localize`Ok`,r=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,s=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],e,["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],t,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],n,r,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],s,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Qb(2,"div",2),r.Mb(3,"progress",3),r.Qb(4,"div",4),r.Qb(5,"p",5),r.Cc(6),r.Pb(),r.Mb(7,"p",6),r.Pb(),r.Ac(8,NV,5,1,"div",7),r.Qb(9,"div",8),r.Ac(10,MV,2,0,"button",9),r.Ac(11,BV,6,2,"button",10),r.Ac(12,FV,2,0,"button",11),r.Ac(13,jV,2,0,"button",12),r.Ac(14,UV,2,0,"button",13),r.Ac(15,VV,2,0,"button",14),r.Qb(16,"div",15),r.Qb(17,"select",16),r.cc("change",function(e){return t.changeStep(e)}),r.Ac(18,qV,4,2,"ng-container",17),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(19,"div",18),r.Qb(20,"div",19),r.Mb(21,"app-game-includer"),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.Bb(3),r.Cb("value",t.successfulSteps)("max",t.getNumberOfSteps()),r.Bb(3),r.Gc("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),r.Bb(1),r.mc("innerHTML",t.currentMessage,r.xc),r.Bb(1),r.mc("ngIf",t.currentReason.isPresent()),r.Bb(2),r.mc("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),r.Bb(1),r.mc("ngIf",!1===t.tutorialOver),r.Bb(1),r.mc("ngIf",t.tutorialOver),r.Bb(1),r.mc("ngIf",t.tutorialOver),r.Bb(1),r.mc("ngIf",t.tutorialOver),r.Bb(1),r.mc("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),r.Bb(3),r.mc("ngForOf",t.steps),r.Bb(1),r.mc("ngClass",t.getBoardHighlight()))},directives:[fe,he,le,Vj,In,Nn],encapsulation:2,changeDetection:0}),e})();function ZV(e,t){if(1&e&&(r.Qb(0,"div",35),r.Qb(1,"div",36),r.Ub(2,37),r.Pb(),r.Qb(3,"div",38),r.Cc(4),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(4),r.Dc(e.errorMessage)}}const QV=function(){return["/login"]};let YV=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.faEye=DS,this.registrationForm=new an({email:new sn,username:new sn,password:new sn})}registerWithEmail(){var e=this;return GO(function*(){const t=e.registrationForm.value.username,n=e.registrationForm.value.email,r=e.registrationForm.value.password;if(null==t||null==n||null==r)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const i=yield e.authService.doRegister(t,n,r);if(i.isSuccess()){const t=yield e.authService.sendEmailVerification();t.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=t.getReason()}else e.errorMessage=i.getReason()}})()}registerWithGoogle(){var e=this;return GO(function*(){const t=yield e.authService.doGoogleLogin();t.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=t.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password||"";return!(""===(this.registrationForm.value.email||"")||""===(this.registrationForm.value.username||"")||""===e||e.length<6)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(vS),r.Lb(qs))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let e,t,n,r,i,o,s,a,c,l,u,h,d,f;return e=$localize`Registering`,t=$localize`Email`,n=$localize`Email`,r=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,s=$localize`Password`,a=$localize`Password`,c=$localize`The password should be at least 6 characters long`,l=$localize`Register`,u=$localize`Register with Google`,h=$localize`Have an account?`,d=$localize`Log in`,f=$localize`Registration error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",n,"type","email","autofocus","","required","",1,"input"],[1,"help"],r,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",a,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],c,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],l,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],u,[1,"help","level-right"],h,[3,"routerLink"],d,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],f,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"p",1),r.Ub(2,2),r.Pb(),r.Qb(3,"form",3),r.Qb(4,"div",4),r.Qb(5,"div",5),r.Qb(6,"label",6),r.Ub(7,7),r.Pb(),r.Pb(),r.Qb(8,"div",8),r.Qb(9,"div",9),r.Qb(10,"div",10),r.Mb(11,"input",11),r.Qb(12,"p",12),r.Ub(13,13),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(14,"div",4),r.Qb(15,"div",5),r.Qb(16,"label",14),r.Ub(17,15),r.Pb(),r.Pb(),r.Qb(18,"div",8),r.Qb(19,"div",9),r.Qb(20,"div",10),r.Mb(21,"input",16),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(22,"div",4),r.Qb(23,"div",5),r.Qb(24,"label",17),r.Ub(25,18),r.Pb(),r.Pb(),r.Qb(26,"div",8),r.Qb(27,"div",9),r.Qb(28,"div",19),r.Mb(29,"input",20),r.Qb(30,"span",21),r.Mb(31,"fa-icon",22),r.Pb(),r.Qb(32,"p",23),r.Ub(33,24),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(34,"div",4),r.Mb(35,"div",5),r.Qb(36,"div",8),r.Qb(37,"div",9),r.Qb(38,"div",10),r.Qb(39,"button",25),r.cc("click",function(){return t.registerWithEmail()}),r.Ub(40,26),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(41,"div",4),r.Mb(42,"div",5),r.Qb(43,"div",27),r.Ac(44,ZV,5,1,"div",28),r.Pb(),r.Pb(),r.Qb(45,"div",4),r.Mb(46,"div",5),r.Qb(47,"div",8),r.Qb(48,"button",29),r.cc("click",function(){return t.registerWithGoogle()}),r.Ub(49,30),r.Pb(),r.Pb(),r.Pb(),r.Qb(50,"p",31),r.Ob(51),r.Ub(52,32),r.Nb(),r.Cc(53,"\xa0 "),r.Qb(54,"a",33),r.Ub(55,34),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.Bb(3),r.mc("formGroup",t.registrationForm),r.Bb(28),r.mc("icon",t.faEye),r.Bb(1),r.mc("ngClass",t.getPasswordHelpClass()),r.Bb(7),r.mc("disabled",!t.canRegister()),r.Bb(5),r.mc("ngIf",t.errorMessage),r.Bb(10),r.mc("routerLink",r.qc(6,QV)))},directives:[gn,Ut,wn,dt,jt,En,hj,xn,tI,dj,le,fe,Zs],encapsulation:2}),e})(),KV=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return GO(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Play offline`,[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(r.Qb(0,"app-pick-game",0),r.cc("pickGame",function(e){return t.pickGame(e)}),r.Pb(),r.Qb(1,"button",1),r.cc("click",function(){return t.playLocally()}),r.Ub(2,2),r.Pb()),2&e&&(r.Bb(1),r.mc("disabled",!t.selectedGame))},directives:[sj],encapsulation:2}),e})(),JV=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return GO(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(qs))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(r.Qb(0,"app-pick-game",0),r.cc("pickGame",function(e){return t.pickGame(e)}),r.Pb(),r.Qb(1,"button",1),r.cc("click",function(){return t.launchTutorial()}),r.Ub(2,2),r.Pb()),2&e&&(r.Bb(1),r.mc("disabled",!t.selectedGame))},directives:[sj],encapsulation:2}),e})(),XV=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let e;return e=$localize`The replay game is loading, please wait, it should not take long.`,[e]},template:function(e,t){1&e&&(r.Qb(0,"p"),r.Ub(1,0),r.Pb())},encapsulation:2}),e})();const ez={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631"},tz=void 0,nz=void 0,rz=void 0,iz=void 0;n("w1tV"),new r.r("angularfire2.realtimeDatabaseURL");const oz=new r.r("angularfire2.database.use-emulator"),sz=new r.r("angularfire2.functions.origin"),az=new r.r("angularfire2.functions.region"),cz=new r.r("angularfire2.functions.new-origin-behavior"),lz=new r.r("angularfire2.functions.use-emulator");let uz=(()=>{class e{constructor(e,t,r,i,o,s,a){const c=new Rl.d(r),l=a,u=Object(Un.a)(void 0).pipe(Object(Vl.b)(c.outsideAngular),Gr(()=>n.e(6).then(n.bind(null,"iTTW"))),Object(ot.a)(()=>Object(Rl.g)(e,r,t)),Object(ot.a)(e=>Object(Rl.f)(`${e.name}.functions.${i||o}`,"AngularFireFunctions",e,()=>{let t;if(s){if(i&&o)throw new Error("REGION and ORIGIN can't be used at the same time.");t=e.functions(i||o||void 0)}else t=e.functions(i||void 0);return s||l||!o||t.useFunctionsEmulator(o),l&&t.useEmulator(...l),t},[i,o,l])),yO({bufferSize:1,refCount:!1}));return this.httpsCallable=(e,t)=>n=>Object(nt.a)(u).pipe(Object(Vl.b)(c.insideAngular),Gr(r=>r.httpsCallable(e,t)(n)),Object(ot.a)(e=>e.data)),Object(Rl.i)(this,u,r)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Rl.c),r.Zb(Rl.b,8),r.Zb(r.A),r.Zb(az,8),r.Zb(sz,8),r.Zb(cz,8),r.Zb(lz,8))},e.\u0275prov=r.Hb({factory:function(){return new e(r.Zb(Rl.c),r.Zb(Rl.b,8),r.Zb(r.A),r.Zb(az,8),r.Zb(sz,8),r.Zb(cz,8),r.Zb(lz,8))},token:e,providedIn:"any"}),e})();Object(Rl.e)(uz,[{useEmulator:null,useFunctionsEmulator:null,httpsCallable:null}]);let hz=(()=>{class e{constructor(e){this.authService=e}canActivate(){var e=this;return GO(function*(){return new Promise(t=>{e.userSub=e.authService.getUserObs().subscribe(function(){var n=GO(function*(n){yield e.evaluateUserPermission(n).then(t)});return function(e){return n.apply(this,arguments)}}())})})()}ngOnDestroy(){this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(vS))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),dz=(()=>{class e extends hz{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return GO(function*(){return!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account")})()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(vS),r.Zb(qs))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function fz(e,t){1&e&&(r.Qb(0,"p",20),r.Ub(1,21),r.Pb())}function pz(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",7),r.Qb(1,"p",8),r.Ub(2,9),r.Pb(),r.Qb(3,"div",10),r.Qb(4,"p",11),r.Ub(5,12),r.Pb(),r.Qb(6,"button",13),r.cc("click",function(){return r.wc(e),r.fc().finalizeEmailVerification()}),r.Ub(7,14),r.Pb(),r.Pb(),r.Qb(8,"div",15),r.Qb(9,"p",11),r.Ub(10,16),r.Pb(),r.Qb(11,"button",17),r.cc("click",function(){return r.wc(e),r.fc().sendEmailVerification()}),r.Ub(12,18),r.Pb(),r.Pb(),r.Ac(13,fz,2,0,"p",19),r.Pb()}if(2&e){const e=r.fc();r.Bb(2),r.Xb(e.emailAddress),r.Vb(2),r.Bb(11),r.mc("ngIf",e.success)}}function gz(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",24),r.Qb(1,"div",8),r.Ub(2,25),r.Pb(),r.Qb(3,"form",26),r.Qb(4,"div",27),r.Qb(5,"div",28),r.Mb(6,"input",29),r.Pb(),r.Qb(7,"div",28),r.Qb(8,"button",30),r.cc("click",function(){r.wc(e);const t=r.fc(2);return t.pickUsername(t.usernameForm.value)}),r.Ub(9,31),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=r.fc(2);r.Bb(3),r.mc("formGroup",e.usernameForm)}}const mz=function(){return["/lobby"]};function yz(e,t){1&e&&(r.Qb(0,"div",32),r.Yb(1,33),r.Mb(2,"a",34),r.Wb(),r.Pb()),2&e&&(r.Bb(2),r.mc("routerLink",r.qc(1,mz)))}function vz(e,t){if(1&e&&(r.Ob(0),r.Ac(1,gz,10,1,"div",22),r.Ac(2,yz,3,2,"div",23),r.Nb()),2&e){const e=r.fc();r.Bb(1),r.mc("ngIf",!e.success),r.Bb(1),r.mc("ngIf",e.success)}}function bz(e,t){if(1&e&&(r.Qb(0,"div",35),r.Qb(1,"div",36),r.Cc(2),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(2),r.Dc(e.errorMessage)}}let _z=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new an({username:new sn})}ngOnInit(){var e=this;return GO(function*(){e.userSub=e.authService.getUserObs().subscribe(function(){var t=GO(function*(t){e.emailAddress=t.email.get(),t.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===t.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===t.verified&&(yield e.router.navigate(["/lobby"])))});return function(e){return t.apply(this,arguments)}}())})()}pickUsername(e){var t=this;return GO(function*(){const n=yield t.authService.setUsername(e.username);n.isSuccess()?t.success=!0:t.errorMessage=n.getReason()})()}sendEmailVerification(){var e=this;return GO(function*(){const t=yield e.authService.sendEmailVerification();t.isSuccess()?e.success=!0:e.errorMessage=t.getReason()})()}finalizeEmailVerification(){var e=this;return GO(function*(){e.triedToFinalize=!0,yield e.authService.reloadUser()})()}ngOnDestroy(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(vS),r.Lb(qs))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let e,t,n,r,i,o,s,a,c,l,u;return e=$localize`Account verification`,t=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,n=$localize`Once you have verified your email, click on the following button:`,r=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,s=$localize`The email has been sent`,a=$localize`In order to finalize your account, you must choose a username.`,c=$localize`Username`,l=$localize`Pick username`,u=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],e,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],t,[1,"block","level-left"],[1,"level-item"],n,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],r,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],s,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],a,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",c,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],l,["id","success",1,"message-body"],u,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Qb(2,"div",2),r.Ub(3,3),r.Pb(),r.Ac(4,pz,14,2,"div",4),r.Ac(5,vz,3,2,"ng-container",5),r.Pb(),r.Ac(6,bz,3,1,"div",6),r.Pb()),2&e&&(r.Bb(4),r.mc("ngIf","send-email"===t.verificationType),r.Bb(1),r.mc("ngIf","enter-username"===t.verificationType),r.Bb(1),r.mc("ngIf",t.errorMessage))},directives:[fe,gn,Ut,wn,dt,xn,jt,En,Zs],encapsulation:2}),e})(),wz=(()=>{class e extends hz{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return GO(function*(){return!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/")})()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(vS),r.Zb(qs))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Cz=(()=>{class e extends hz{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return GO(function*(){return!1===e.isConnected()||t.router.parseUrl("/")})()}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(vS),r.Zb(qs))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Ez(e,t){1&e&&(r.Qb(0,"p",12),r.Ub(1,13),r.Pb())}function Oz(e,t){if(1&e&&(r.Qb(0,"div",14),r.Qb(1,"div",15),r.Ub(2,16),r.Pb(),r.Qb(3,"div",17),r.Cc(4),r.Pb(),r.Pb()),2&e){const e=r.fc();r.Bb(4),r.Dc(e.errorMessage.get())}}const Sz=function(){return{standalone:!0}};let Pz=(()=>{class e{constructor(e){this.authService=e,this.success=!1,this.errorMessage=XO.empty(),this.email=""}resetPassword(){var e=this;return GO(function*(){WO(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=XO.empty(),e.success=!1;const t=yield e.authService.sendPasswordResetEmail(e.email);t.isSuccess()?e.success=!0:e.errorMessage=XO.of(t.getReason())})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(vS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let e,t,n,r,i,o;return e=$localize`Password reset`,t=$localize`Email`,n=$localize`An email will be sent with instruction to reset your password.`,r=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,o=$localize`Error`,[[1,"box"],[1,"title"],e,[1,"field"],[1,"control"],["id","email","name","email","placeholder",t,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],n,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],r,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],o,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"p",1),r.Ub(2,2),r.Pb(),r.Qb(3,"div",3),r.Qb(4,"div",4),r.Qb(5,"input",5),r.cc("ngModelChange",function(e){return t.email=e}),r.Pb(),r.Qb(6,"p",6),r.Ub(7,7),r.Pb(),r.Ac(8,Ez,2,0,"p",8),r.Pb(),r.Pb(),r.Qb(9,"button",9),r.cc("click",function(){return t.resetPassword()}),r.Ub(10,10),r.Pb(),r.Ac(11,Oz,5,1,"div",11),r.Pb()),2&e&&(r.Bb(5),r.mc("ngModel",t.email)("ngModelOptions",r.qc(5,Sz)),r.Bb(3),r.mc("ngIf",t.success),r.Bb(1),r.mc("disabled",""===t.email),r.Bb(2),r.mc("ngIf",t.errorMessage.isPresent()))},directives:[dt,hj,xn,jt,pn,fe],encapsulation:2}),e})();function Iz(e,t){if(1&e&&(r.Qb(0,"option",13),r.Cc(1),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.mc("value",e.value)("selected",e.value===n.currentTheme),r.Bb(1),r.Ec(" ",e.name," ")}}function Tz(e,t){if(1&e&&(r.Qb(0,"option",13),r.Cc(1),r.Pb()),2&e){const e=t.$implicit,n=r.fc();r.mc("value",e.value)("selected",e.value===n.currentLanguage),r.Bb(1),r.Ec(" ",e.name," ")}}let Az=(()=>{class e{constructor(e,t){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=t.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(kS),r.Lb(NS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let e,t,n;return e=$localize`User settings`,t=$localize`Theme`,n=$localize`Language`,[[1,"box"],[1,"title"],e,[1,"field"],["for","theme",1,"label"],t,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],n,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"p",1),r.Ub(2,2),r.Pb(),r.Qb(3,"div",3),r.Qb(4,"label",4),r.Ub(5,5),r.Pb(),r.Qb(6,"div",6),r.Qb(7,"div",7),r.Qb(8,"select",8),r.cc("change",function(e){return t.changeTheme(e)}),r.Ac(9,Iz,2,3,"option",9),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(10,"div",3),r.Qb(11,"label",10),r.Ub(12,11),r.Pb(),r.Qb(13,"div",6),r.Qb(14,"div",7),r.Qb(15,"select",12),r.cc("change",function(e){return t.changeLanguage(e)}),r.Ac(16,Tz,2,3,"option",9),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.Bb(9),r.mc("ngForOf",t.availableThemes),r.Bb(7),r.mc("ngForOf",t.availableLanguages))},directives:[he,In,Nn],encapsulation:2}),e})(),kz=(()=>{class e{}return e.ALREADY_INGAME=()=>$localize`You are already in a game. Finish it or cancel it first.`,e})(),Nz=(()=>{class e{constructor(e,t,n,r,i,o){this.route=e,this.router=t,this.authenticationService=n,this.messageDisplayer=r,this.partDAO=i,this.gameService=o}ngOnInit(){var e=this;return GO(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return $O.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var t=this;return GO(function*(){const n=t.authenticationService.user.get();WO(n.isConnected(),"User must be connected and have a username to reach this page");const r=n.username.get();if(yield t.canCreateOnlineGame(r)){const n=yield t.gameService.createPartJoinerAndChat(r,e);return yield t.router.navigate(["/play",e,n]),!0}return t.messageDisplayer.infoMessage(kz.ALREADY_INGAME()),yield t.router.navigate(["/lobby"]),!1})()}canCreateOnlineGame(e){var t=this;return GO(function*(){return!1===(yield t.partDAO.userHasActivePart(e))})()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(Po),r.Lb(qs),r.Lb(vS),r.Lb(OI),r.Lb(rS),r.Lb(TS))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let e;return e=$localize`Creating online game, please wait, it should not take long.`,[e]},template:function(e,t){1&e&&(r.Qb(0,"p"),r.Ub(1,0),r.Pb())},encapsulation:2}),e})();var Mz;Mz=xl.a,Object(r.ub)(Mz,void 0,void 0);const xz=[{path:"login",component:mj},{path:"lobby",component:Fj,canActivate:[dz]},{path:"settings",component:Az},{path:"register",component:YV,canActivate:[Cz]},{path:"reset-password",component:Pz,canActivate:[Cz]},{path:"notFound",component:jj},{path:"nextGameLoading",component:XV,canActivate:[dz]},{path:"verify-account",component:_z,canActivate:[wz]},{path:"play",component:vj,canActivate:[dz]},{path:"play/:compo",component:Nz,canActivate:[dz]},{path:"play/:compo/:id",component:uV,canActivate:[dz]},{path:"local",component:KV},{path:"local/:compo",component:AV},{path:"tutorial",component:JV},{path:"tutorial/:compo",component:WV},{path:"",component:uj},{path:"**",component:uj}];let Rz=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Jb({type:e,bootstrap:[pI]}),e.\u0275inj=r.Ib({providers:[{provide:_O,useValue:nz},{provide:oz,useValue:rz},{provide:jO,useValue:tz},{provide:lz,useValue:iz},vS,TS,IS,gS,hS,rS,PO,NS,{provide:r.v,useValue:AS.getLocale()}],imports:[[tt,Or,sa.forRoot(xz,{useHash:!1}),Fn,Bn,Rl.a.initializeApp(ez),zO,Nl,nI]]}),e})();"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;class Dz{constructor(e){this.digits=e}static zero(){return new Dz([0])}static one(){return new Dz([1])}clone(){return new Dz(this.digits.slice())}add(e){const t=this.clone();return t.addToSelf(e),t}addToSelf(e){const t=Math.max(this.digits.length,e.digits.length);let n=0;for(let r=0;r<t;r++){let t=n;r<this.digits.length&&(t+=this.digits[r]),r<e.digits.length&&(t+=e.digits[r]),t>=10?(this.digits[r]=t-10,n=1):(this.digits[r]=t,n=0)}n>0&&(this.digits[t]=1)}toString(){let e="";for(let t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}class Lz{constructor(e){this.powerOfTwos=[e]}getValue(){return this.powerOfTwos[0]}multiplyBy(e){const t=Dz.zero();return this.multiplyByAndAddTo(e,t),t}multiplyByAndAddTo(e,t){for(let n=0;0!==e;e>>>=1,n++)if(1&e){const e=this.getMultipliedByPowerOfTwo(n);t.addToSelf(e)}}getMultipliedByPowerOfTwo(e){for(let t=this.powerOfTwos.length;t<=e;t++){const e=this.powerOfTwos[t-1];this.powerOfTwos[t]=e.add(e)}return this.powerOfTwos[e]}}class Bz{constructor(e){this.base=e,this.exponents=[new Lz(Dz.one())]}toThePowerOf(e){for(let t=this.exponents.length;t<=e;t++){const e=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new Lz(e)}return this.exponents[e]}}function Fz(e){const t=function(e){let t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){const t=e.charCodeAt(n+1);t>=56320&&t<=57343&&(n++,r=(r-55296<<10)+t-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e);let n=jz(t,0),r=jz(t,102072);return 0!=n||0!=r&&1!=r||(n^=319790063,r^=-1801410264),[n,r]}function jz(e,t){let n,r=2654435769,i=2654435769;const o=e.length;for(n=0;n+12<=o;n+=12){r=zz(r,qz(e,n,Vz.Little)),i=zz(i,qz(e,n+4,Vz.Little));const o=Uz(r,i,t=zz(t,qz(e,n+8,Vz.Little)));r=o[0],i=o[1],t=o[2]}return r=zz(r,qz(e,n,Vz.Little)),i=zz(i,qz(e,n+4,Vz.Little)),t=zz(t,o),Uz(r,i,t=zz(t,qz(e,n+8,Vz.Little)<<8))[2]}function Uz(e,t,n){return e=Gz(e,t),e=Gz(e,n),e^=n>>>13,t=Gz(t,n),t=Gz(t,e),t^=e<<8,n=Gz(n,e),n=Gz(n,t),n^=t>>>13,e=Gz(e,t),e=Gz(e,n),e^=n>>>12,t=Gz(t,n),t=Gz(t,e),t^=e<<16,n=Gz(n,e),n=Gz(n,t),n^=t>>>5,e=Gz(e,t),e=Gz(e,n),e^=n>>>3,t=Gz(t,n),t=Gz(t,e),t^=e<<10,n=Gz(n,e),n=Gz(n,t),[e,t,n^=t>>>15]}var Vz=function(e){return e[e.Little=0]="Little",e[e.Big=1]="Big",e}({});function zz(e,t){return Hz(e,t)[1]}function Hz(e,t){const n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function Gz(e,t){const n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function $z(e,t){return t>=e.length?0:e[t]}function qz(e,t,n){let r=0;if(n===Vz.Big)for(let i=0;i<4;i++)r+=$z(e,t+i)<<24-8*i;else for(let i=0;i<4;i++)r+=$z(e,t+i)<<8*i;return r}const Wz=new Bz(256);function Zz(e,t){if(":"!==t.charAt(0))return{text:e};{const n=function(e,t){for(let n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error(`Unterminated $localize metadata block in "${t}".`)}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}}function Qz(e){return 1===e?"PH":"PH_"+(e-1)}class Yz extends Error{constructor(e){super(`No translation found for ${Kz(e)}.`),this.parsedMessage=e,this.type="MissingTranslationError"}}function Kz(e){const t=e.meaning&&` - "${e.meaning}"`,n=e.legacyIds&&e.legacyIds.length>0?` [${e.legacyIds.map(e=>`"${e}"`).join(", ")}]`:"";return`"${e.id}"${n} ("${e.text}"${t})`}function Jz(e,t){try{return function(e,t,n){const r=function(e,t,n,r,i=[]){const o={},s={},a=function(e,t){const{text:n,block:r}=Zz(e,t);if(void 0===r)return{text:n};{const[e,...t]=r.split("\u241f"),[i,o]=e.split("@@",2);let[s,a]=i.split("|",2);return void 0===a&&(a=s,s=void 0),""===a&&(a=void 0),{text:n,meaning:s,description:a,customId:o,legacyIds:t}}}(e[0],e.raw[0]),c=[a.text],l=[];let u=a.text;for(let f=1;f<e.length;f++){const{text:n,block:r=Qz(f)}=Zz(e[f],e.raw[f]);u+=`{$${r}}${n}`,void 0!==t&&(o[r]=t[f-1],s[r]=i[f-1]),l.push(r),c.push(n)}const h=a.customId||function(e,t=""){let n=Fz(e);if(t){const e=Fz(t);n=function(e,t){const n=e[0],r=t[0],i=Hz(e[1],t[1]),o=i[0],s=i[1];return[zz(zz(n,r),o),s]}(function(e,t){const n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),e)}return function(e,t){const n=Wz.toThePowerOf(0).multiplyBy(t);return Wz.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(u,a.meaning||""),d=a.legacyIds?a.legacyIds.filter(e=>e!==h):[];return{id:h,legacyIds:d,substitutions:o,substitutionLocations:s,text:u,customId:a.customId,meaning:a.meaning||"",description:a.description||"",messageParts:c,messagePartLocations:r,placeholderNames:l,location:n}}(t,n);let i=e[r.id];if(void 0!==r.legacyIds)for(let o=0;o<r.legacyIds.length&&void 0===i;o++)i=e[r.legacyIds[o]];if(void 0===i)throw new Yz(r);return[i.messageParts,i.placeholderNames.map(e=>{if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${Kz(r)}.\nThe translation contains a placeholder with name ${e}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,e,t)}catch(aO){return console.warn(aO.message),[e,t]}}function Xz(){Object(r.T)(),Xe().bootstrapModule(Rz).catch(e=>console.error(e))}const eH=AS.getLocale();"en"!==eH?fetch("/assets/"+eH+".json").then(e=>e.ok?e.json():{locale:"en",translations:{}}).then(e=>{var t;t=e.translations,$localize.translate||($localize.translate=Jz),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(t).forEach(e=>{$localize.TRANSLATIONS[e]=function(e){const t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[];for(let a=1;a<t.length-1;a+=2)r.push(t[a]),n.push(`${t[a+1]}`);const i=n.map(e=>":"===e.charAt(0)?"\\"+e:e);return{text:e,messageParts:(o=n,s=i,Object.defineProperty(o,"raw",{value:s}),o),placeholderNames:r};var o,s}(t[e])}),$localize.locale=e.locale,Xz()}).catch(function(e){console.log(e)}):Xz()},zn8P:function(e,t){function n(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"},zx2A:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c});var r=n("7o/Q"),i=n("HDdC"),o=n("SeVD");class s extends r.a{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends r.a{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function c(e,t){if(t.closed)return;if(e instanceof i.a)return e.subscribe(t);let n;try{n=Object(o.a)(e)(t)}catch(r){t.error(r)}return n}}},[[0,0]]]);