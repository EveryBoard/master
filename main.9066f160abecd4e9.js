(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{3606:(Ku,X0,Vo)=>{"use strict";function Mn(r){return"function"==typeof r}function Fo(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const _3=Fo(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function v3(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class En{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Mn(n))try{n()}catch(s){e=s instanceof _3?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{y3(s)}catch(o){e=e??[],o instanceof _3?e=[...e,...o.errors]:e.push(o)}}if(e)throw new _3(e)}}add(e){var t;if(e&&e!==this)if(this.closed)y3(e);else{if(e instanceof En){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&v3(t,e)}remove(e){const{_finalizers:t}=this;t&&v3(t,e),e instanceof En&&e._removeParent(this)}}En.EMPTY=(()=>{const r=new En;return r.closed=!0,r})();const Jl=En.EMPTY;function C3(r){return r instanceof En||r&&"closed"in r&&Mn(r.remove)&&Mn(r.add)&&Mn(r.unsubscribe)}function y3(r){Mn(r)?r():r.unsubscribe()}const lc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},L4={setTimeout(r,e,...t){const{delegate:n}=L4;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=L4;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function e6(r){L4.setTimeout(()=>{const{onUnhandledError:e}=lc;if(!e)throw r;e(r)})}function Rs(){}const $o=t6("C",void 0,void 0);function t6(r,e,t){return{kind:r,value:e,error:t}}let Ma=null;function ht(r){if(lc.useDeprecatedSynchronousErrorHandling){const e=!Ma;if(e&&(Ma={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=Ma;if(Ma=null,t)throw n}}else r()}class zt extends En{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,C3(e)&&e.add(this)):this.destination=Ju}static create(e,t,n){return new Ni(e,t,n)}next(e){this.isStopped?Qu(function Xu(r){return t6("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Qu(function Q0(r){return t6("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Qu($o,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ln=Function.prototype.bind;function zr(r,e){return Ln.call(r,e)}class M3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){ni(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){ni(n)}else ni(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ni(t)}}}class Ni extends zt{constructor(e,t,n){let i;if(super(),Mn(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&lc.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&zr(e.next,s),error:e.error&&zr(e.error,s),complete:e.complete&&zr(e.complete,s)}):i=e}this.destination=new M3(i)}}function ni(r){lc.useDeprecatedSynchronousErrorHandling?function ot(r){lc.useDeprecatedSynchronousErrorHandling&&Ma&&(Ma.errorThrown=!0,Ma.error=r)}(r):e6(r)}function Qu(r,e){const{onStoppedNotification:t}=lc;t&&L4.setTimeout(()=>t(r,e))}const Ju={closed:!0,next:Rs,error:function n6(r){throw r},complete:Rs},e7="function"==typeof Symbol&&Symbol.observable||"@@observable";function uc(r){return r}function vh(r){return 0===r.length?uc:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let T1=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const s=function gy(r){return r&&r instanceof zt||function py(r){return r&&Mn(r.next)&&Mn(r.error)&&Mn(r.complete)}(r)&&C3(r)}(t)?t:new Ni(t,n,i);return ht(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=Ch(n))((i,s)=>{const o=new Ni({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[e7](){return this}pipe(...t){return vh(t)(this)}toPromise(t){return new(t=Ch(t))((n,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>n(s))})}}return r.create=e=>new r(e),r})();function Ch(r){var e;return null!==(e=r??lc.Promise)&&void 0!==e?e:Promise}const my=Fo(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let zs=(()=>{class r extends T1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new yh(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new my}next(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:s}=this;return n||i?Jl:(this.currentObservers=null,s.push(t),new En(()=>{this.currentObservers=null,v3(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:s}=this;n?t.error(i):s&&t.complete()}asObservable(){const t=new T1;return t.source=this,t}}return r.create=(e,t)=>new yh(e,t),r})();class yh extends zs{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Jl}}class ss extends zs{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function Mh(r){return Mn(r?.lift)}function Jr(r){return e=>{if(Mh(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mr(r,e,t,n,i){return new _y(r,e,t,n,i)}class _y extends zt{constructor(e,t,n,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Zn(r,e){return Jr((t,n)=>{let i=0;t.subscribe(Mr(n,s=>{n.next(r.call(e,s,i++))}))})}function n7(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function ao(r){return this instanceof ao?(this.v=r,this):new ao(r)}function i6(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function t1(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(o){return new Promise(function(a,c){!function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=r[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const BR=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function GR(r){return Mn(r?.then)}function UR(r){return Mn(r[e7])}function WR(r){return Symbol.asyncIterator&&Mn(r?.[Symbol.asyncIterator])}function qR(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const jR=function X4e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ZR(r){return Mn(r?.[jR])}function YR(r){return function e8(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(m){n[m]&&(i[m]=function(E){return new Promise(function(w,R){s.push([m,E,w,R])>1||a(m,E)})})}function a(m,E){try{!function c(m){m.value instanceof ao?Promise.resolve(m.value.v).then(l,f):d(s[0][2],m)}(n[m](E))}catch(w){d(s[0][3],w)}}function l(m){a("next",m)}function f(m){a("throw",m)}function d(m,E){m(E),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield ao(t.read());if(i)return yield ao(void 0);yield yield ao(n)}}finally{t.releaseLock()}})}function KR(r){return Mn(r?.getReader)}function lo(r){if(r instanceof T1)return r;if(null!=r){if(UR(r))return function Q4e(r){return new T1(e=>{const t=r[e7]();if(Mn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(BR(r))return function J4e(r){return new T1(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(GR(r))return function ele(r){return new T1(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,e6)})}(r);if(WR(r))return XR(r);if(ZR(r))return function tle(r){return new T1(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(KR(r))return function nle(r){return XR(YR(r))}(r)}throw qR(r)}function XR(r){return new T1(e=>{(function rle(r,e){var t,n,i,s;return function Pe(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=i6(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function E3(r,e,t,n=0,i=!1){const s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function ri(r,e,t=1/0){return Mn(e)?ri((n,i)=>Zn((s,o)=>e(n,s,i,o))(lo(r(n,i))),t):("number"==typeof e&&(t=e),Jr((n,i)=>function ile(r,e,t,n,i,s,o,a){const c=[];let l=0,f=0,d=!1;const m=()=>{d&&!c.length&&!l&&e.complete()},E=R=>l<n?w(R):c.push(R),w=R=>{s&&e.next(R),l++;let z=!1;lo(t(R,f++)).subscribe(Mr(e,$=>{i?.($),s?E($):e.next($)},()=>{z=!0},void 0,()=>{if(z)try{for(l--;c.length&&l<n;){const $=c.shift();o?E3(e,o,()=>w($)):w($)}m()}catch($){e.error($)}}))};return r.subscribe(Mr(e,E,()=>{d=!0,m()})),()=>{a?.()}}(n,i,r,t)))}function t8(r=1/0){return ri(uc,r)}const fc=new T1(r=>r.complete());function Sy(r){return r[r.length-1]}function QR(r){return Mn(Sy(r))?r.pop():void 0}function i7(r){return function ole(r){return r&&Mn(r.schedule)}(Sy(r))?r.pop():void 0}function Sh(r,e=0){return Jr((t,n)=>{t.subscribe(Mr(n,i=>E3(n,r,()=>n.next(i),e),()=>E3(n,r,()=>n.complete(),e),i=>E3(n,r,()=>n.error(i),e)))})}function Ph(r,e=0){return Jr((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function JR(r,e){if(!r)throw new Error("Iterable cannot be null");return new T1(t=>{E3(t,e,()=>{const n=r[Symbol.asyncIterator]();E3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function u2(r,e){return e?function hle(r,e){if(null!=r){if(UR(r))return function cle(r,e){return lo(r).pipe(Ph(e),Sh(e))}(r,e);if(BR(r))return function ule(r,e){return new T1(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(GR(r))return function lle(r,e){return lo(r).pipe(Ph(e),Sh(e))}(r,e);if(WR(r))return JR(r,e);if(ZR(r))return function fle(r,e){return new T1(t=>{let n;return E3(t,e,()=>{n=r[jR](),E3(t,e,()=>{let i,s;try{({value:i,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>Mn(n?.return)&&n.return()})}(r,e);if(KR(r))return function dle(r,e){return JR(YR(r),e)}(r,e)}throw qR(r)}(r,e):lo(r)}function Ht(...r){return u2(r,i7(r))}function ez(r={}){const{connector:e=(()=>new zs),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return s=>{let o,a,c,l=0,f=!1,d=!1;const m=()=>{a?.unsubscribe(),a=void 0},E=()=>{m(),o=c=void 0,f=d=!1},w=()=>{const R=o;E(),R?.unsubscribe()};return Jr((R,z)=>{l++,!d&&!f&&m();const $=c=c??e();z.add(()=>{l--,0===l&&!d&&!f&&(a=Py(w,i))}),$.subscribe(z),!o&&l>0&&(o=new Ni({next:G=>$.next(G),error:G=>{d=!0,m(),a=Py(E,t,G),$.error(G)},complete:()=>{f=!0,m(),a=Py(E,n),$.complete()}}),lo(R).subscribe(o))})(s)}}function Py(r,e,...t){if(!0===e)return void r();if(!1===e)return;const n=new Ni({next:()=>{n.unsubscribe(),r()}});return lo(e(...t)).subscribe(n)}function Ea(r,e){return Jr((t,n)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&n.complete();t.subscribe(Mr(n,c=>{i?.unsubscribe();let l=0;const f=s++;lo(r(c,f)).subscribe(i=Mr(n,d=>n.next(e?e(c,d,f,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function mle(r,e){return r===e}function l1(r){for(let e in r)if(r[e]===l1)return e;throw Error("Could not find renamed property on target object.")}function Oh(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function f2(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(f2).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Oy(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const _le=l1({__forward_ref__:l1});function b1(r){return r.__forward_ref__=b1,r.toString=function(){return f2(this())},r}function Bt(r){return Ty(r)?r():r}function Ty(r){return"function"==typeof r&&r.hasOwnProperty(_le)&&r.__forward_ref__===b1}function by(r){return r&&!!r.\u0275providers}const tz="https://g.co/ng/security#xss";class ge extends Error{constructor(e,t){super(function Th(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function Kt(r){return"string"==typeof r?r:null==r?"":String(r)}function wy(r,e){throw new ge(-201,!1)}function Vt(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function De(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function ii(r){return{providers:r.providers||[],imports:r.imports||[]}}function bh(r){return nz(r,Nh)||nz(r,rz)}function nz(r,e){return r.hasOwnProperty(e)?r[e]:null}function wh(r){return r&&(r.hasOwnProperty(Ny)||r.hasOwnProperty(Ole))?r[Ny]:null}const Nh=l1({\u0275prov:l1}),Ny=l1({\u0275inj:l1}),rz=l1({ngInjectableDef:l1}),Ole=l1({ngInjectorDef:l1});var ln=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(ln||{});let Ay;function Ds(r){const e=Ay;return Ay=r,e}function sz(r,e,t){const n=bh(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&ln.Optional?null:void 0!==e?e:void wy(f2(r))}const C1=globalThis,s7={},Ry="__NG_DI_FLAG__",Ah="ngTempTokenPath",wle=/\n/gm,az="__source";let n8;function z4(r){const e=n8;return n8=r,e}function Ile(r,e=ln.Default){if(void 0===n8)throw new ge(-203,!1);return null===n8?sz(r,void 0,e):n8.get(r,e&ln.Optional?null:void 0,e)}function Oe(r,e=ln.Default){return(function iz(){return Ay}()||Ile)(Bt(r),e)}function nt(r,e=ln.Default){return Oe(r,Ih(e))}function Ih(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function zy(r){const e=[];for(let t=0;t<r.length;t++){const n=Bt(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ge(900,!1);let i,s=ln.Default;for(let o=0;o<n.length;o++){const a=n[o],c=kle(a);"number"==typeof c?-1===c?i=a.token:s|=c:i=a}e.push(Oe(i,s))}else e.push(Oe(n))}return e}function o7(r,e){return r[Ry]=e,r.prototype[Ry]=e,r}function kle(r){return r[Ry]}function S3(r){return{toString:r}.toString()}var kh=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(kh||{}),Go=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(Go||{});const dc={},Yn=[],xh=l1({\u0275cmp:l1}),Dy=l1({\u0275dir:l1}),Hy=l1({\u0275pipe:l1}),lz=l1({\u0275mod:l1}),P3=l1({\u0275fac:l1}),a7=l1({__NG_ELEMENT_ID__:l1}),uz=l1({__NG_ENV_ID__:l1});function fz(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const s=e.length;if(i+s===n||r.charCodeAt(i+s)<=32)return i}t=i+1}}function Vy(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const s=t[n++],o=t[n++],a=t[n++];r.setAttribute(e,o,a,s)}else{const s=i,o=t[++n];hz(s)?r.setProperty(e,s,o):r.setAttribute(e,s,o),n++}}return n}function dz(r){return 3===r||4===r||6===r}function hz(r){return 64===r.charCodeAt(0)}function c7(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||pz(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function pz(r,e,t,n,i){let s=0,o=r.length;if(-1===e)o=-1;else for(;s<r.length;){const a=r[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<r.length;){const a=r[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[s+1]=i));if(n===r[s+1])return void(r[s+2]=i)}s++,null!==n&&s++,null!==i&&s++}-1!==o&&(r.splice(o,0,e),s=o+1),r.splice(s++,0,t),null!==n&&r.splice(s++,0,n),null!==i&&r.splice(s++,0,i)}const gz="ng-template";function Rle(r,e,t){let n=0,i=!0;for(;n<r.length;){let s=r[n++];if("string"==typeof s&&i){const o=r[n++];if(t&&"class"===s&&-1!==fz(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;n<r.length&&"string"==typeof(s=r[n++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function mz(r){return 4===r.type&&r.value!==gz}function zle(r,e,t){return e===(4!==r.type||t?r.value:gz)}function Dle(r,e,t){let n=4;const i=r.attrs||[],s=function Fle(r){for(let e=0;e<r.length;e++)if(dz(r[e]))return e;return r.length}(i);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&n){if(n=2|1&n,""!==c&&!zle(r,c,t)||""===c&&1===e.length){if(Sa(n))return!1;o=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!Rle(r.attrs,l,t)){if(Sa(n))return!1;o=!0}continue}const d=Hle(8&n?"class":c,i,mz(r),t);if(-1===d){if(Sa(n))return!1;o=!0;continue}if(""!==l){let m;m=d>s?"":i[d+1].toLowerCase();const E=8&n?m:null;if(E&&-1!==fz(E,l,0)||2&n&&l!==m){if(Sa(n))return!1;o=!0}}}}else{if(!o&&!Sa(n)&&!Sa(c))return!1;if(o&&Sa(c))continue;o=!1,n=c|1&n}}return Sa(n)||o}function Sa(r){return 0==(1&r)}function Hle(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===r)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function $le(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function _z(r,e,t=!1){for(let n=0;n<e.length;n++)if(Dle(r,e[n],t))return!0;return!1}function Ble(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function vz(r,e){return r?":not("+e.trim()+")":e}function Gle(r){let e=r[0],t=1,n=2,i="",s=!1;for(;t<r.length;){let o=r[t];if("string"==typeof o)if(2&n){const a=r[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+o:4&n&&(i+=" "+o);else""!==i&&!Sa(o)&&(e+=vz(s,i),i=""),n=o,s=s||!Sa(n);t++}return""!==i&&(e+=vz(s,i)),e}function Be(r){return S3(()=>{const e=yz(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===kh.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||Go.Emulated,styles:r.styles||Yn,_:null,schemas:r.schemas||null,tView:null,id:""};Mz(t);const n=r.dependencies;return t.directiveDefs=Lh(n,!1),t.pipeDefs=Lh(n,!0),t.id=function Kle(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function Fy(r,e,t){const n=r.\u0275cmp;n.directiveDefs=Lh(e,!1),n.pipeDefs=Lh(t,!0)}function qle(r){return Rn(r)||si(r)}function jle(r){return null!==r}function Ai(r){return S3(()=>({type:r.type,bootstrap:r.bootstrap||Yn,declarations:r.declarations||Yn,imports:r.imports||Yn,exports:r.exports||Yn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function Cz(r,e){if(null==r)return dc;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=n,e&&(e[i]=s)}return t}function Rt(r){return S3(()=>{const e=yz(r);return Mz(e),e})}function Ii(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Rn(r){return r[xh]||null}function si(r){return r[Dy]||null}function os(r){return r[Hy]||null}function fo(r,e){const t=r[lz]||null;if(!t&&!0===e)throw new Error(`Type ${f2(r)} does not have '\u0275mod' property.`);return t}function yz(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||dc,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||Yn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Cz(r.inputs,e),outputs:Cz(r.outputs)}}function Mz(r){r.features?.forEach(e=>e(r))}function Lh(r,e){if(!r)return null;const t=e?os:qle;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(jle)}const Dr=0,Je=1,Jt=2,Q1=3,Pa=4,l7=5,ki=6,i8=7,Hr=8,D4=9,s8=10,Xt=11,u7=12,Ez=13,o8=14,Vr=15,f7=16,a8=17,hc=18,d7=19,Sz=20,H4=21,O3=22,Rh=23,zh=24,gn=25,$y=1,Pz=2,pc=7,c8=9,oi=11;function Hs(r){return Array.isArray(r)&&"object"==typeof r[$y]}function Vs(r){return Array.isArray(r)&&!0===r[$y]}function By(r){return 0!=(4&r.flags)}function a6(r){return r.componentOffset>-1}function Hh(r){return 1==(1&r.flags)}function Oa(r){return!!r.template}function Gy(r){return 0!=(512&r[Jt])}function c6(r,e){return r.hasOwnProperty(P3)?r[P3]:null}let n6e=C1.WeakRef??class t6e{constructor(e){this.ref=e}deref(){return this.ref}},i6e=0,gc=null,Vh=!1;function k2(r){const e=gc;return gc=r,e}class Nz{constructor(){this.id=i6e++,this.ref=function r6e(r){return new n6e(r)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const n=t.producerNode.deref();if(null!=n&&t.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Vh;Vh=!0;try{for(const[t,n]of this.consumers){const i=n.consumerNode.deref();null!=i&&i.trackingVersion===n.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),i?.producers.delete(this.id))}}finally{Vh=e}}producerAccessed(){if(Vh)throw new Error("");if(null===gc)return;let e=gc.producers.get(this.id);void 0===e?(e={consumerNode:gc.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:gc.trackingVersion},gc.producers.set(this.id,e),this.consumers.set(gc.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=gc.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==gc?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let Az=null;const kz=()=>{};class c6e extends Nz{constructor(e,t,n){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=kz,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=k2(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=kz,this.watch(this.registerOnCleanup)}finally{k2(e)}}cleanup(){this.cleanupFn()}}class l6e{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function as(){return xz}function xz(r){return r.type.prototype.ngOnChanges&&(r.setInput=f6e),u6e}function u6e(){const r=Rz(this),e=r?.current;if(e){const t=r.previous;if(t===dc)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function f6e(r,e,t,n){const i=this.declaredInputs[t],s=Rz(r)||function d6e(r,e){return r[Lz]=e}(r,{previous:dc,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[i];o[i]=new l6e(c&&c.currentValue,e,a===dc),r[n]=e}as.ngInherit=!0;const Lz="__ngSimpleChanges__";function Rz(r){return r[Lz]||null}const mc=function(r,e,t){},zz="svg";function w1(r){for(;Array.isArray(r);)r=r[Dr];return r}function Bh(r,e){return w1(e[r])}function Fs(r,e){return w1(e[r.index])}function Hz(r,e){return r.data[e]}function l8(r,e){return r[e]}function ho(r,e){const t=e[r];return Hs(t)?t:t[Dr]}function V4(r,e){return null==e?null:r[e]}function Vz(r){r[a8]=0}function C6e(r){1024&r[Jt]||(r[Jt]|=1024,$z(r,1))}function Fz(r){1024&r[Jt]&&(r[Jt]&=-1025,$z(r,-1))}function $z(r,e){let t=r[Q1];if(null===t)return;t[l7]+=e;let n=t;for(t=t[Q1];null!==t&&(1===e&&1===n[l7]||-1===e&&0===n[l7]);)t[l7]+=e,n=t,t=t[Q1]}const Ft={lFrame:Qz(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Uz(){return Ft.bindingsEnabled}function u8(){return null!==Ft.skipHydrationRootTNode}function Se(){return Ft.lFrame.lView}function zn(){return Ft.lFrame.tView}function ne(r){return Ft.lFrame.contextLView=r,r[Hr]}function re(r){return Ft.lFrame.contextLView=null,r}function ai(){let r=Wz();for(;null!==r&&64===r.type;)r=r.parent;return r}function Wz(){return Ft.lFrame.currentTNode}function p7(){const r=Ft.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function _c(r,e){const t=Ft.lFrame;t.currentTNode=r,t.isParent=e}function Yy(){return Ft.lFrame.isParent}function Ky(){Ft.lFrame.isParent=!1}function cs(){const r=Ft.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function T3(){return Ft.lFrame.bindingIndex}function f8(){return Ft.lFrame.bindingIndex++}function b3(r){const e=Ft.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function Zz(r){Ft.lFrame.inI18n=r}function I6e(r,e){const t=Ft.lFrame;t.bindingIndex=t.bindingRootIndex=r,Xy(e)}function Xy(r){Ft.lFrame.currentDirectiveIndex=r}function Yz(){return Ft.lFrame.currentQueryIndex}function Jy(r){Ft.lFrame.currentQueryIndex=r}function x6e(r){const e=r[Je];return 2===e.type?e.declTNode:1===e.type?r[ki]:null}function Kz(r,e,t){if(t&ln.SkipSelf){let i=e,s=r;for(;!(i=i.parent,null!==i||t&ln.Host||(i=x6e(s),null===i||(s=s[o8],10&i.type))););if(null===i)return!1;e=i,r=s}const n=Ft.lFrame=Xz();return n.currentTNode=e,n.lView=r,!0}function eM(r){const e=Xz(),t=r[Je];Ft.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Xz(){const r=Ft.lFrame,e=null===r?null:r.child;return null===e?Qz(r):e}function Qz(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function Jz(){const r=Ft.lFrame;return Ft.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const eD=Jz;function tM(){const r=Jz();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function ls(){return Ft.lFrame.selectedIndex}function l6(r){Ft.lFrame.selectedIndex=r}function or(){const r=Ft.lFrame;return Hz(r.tView,r.selectedIndex)}function A(){Ft.lFrame.currentNamespace=zz}let nD=!0;function Gh(){return nD}function F4(r){nD=r}function Uh(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=r.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:f}=s;o&&(r.contentHooks??=[]).push(-t,o),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=f&&(r.destroyHooks??=[]).push(t,f)}}function Wh(r,e,t){rD(r,e,3,t)}function qh(r,e,t,n){(3&r[Jt])===t&&rD(r,e,t,n)}function nM(r,e){let t=r[Jt];(3&t)===e&&(t&=8191,t+=1,r[Jt]=t)}function rD(r,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let c=void 0!==n?65535&r[a8]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[a8]+=65536),(a<s||-1==s)&&(F6e(r,t,e,c),r[a8]=(4294901760&r[a8])+c+2),c++}function iD(r,e){mc(4,r,e);const t=k2(null);try{e.call(r)}finally{k2(t),mc(5,r,e)}}function F6e(r,e,t,n){const i=t[n]<0,s=t[n+1],a=r[i?-t[n]:t[n]];i?r[Jt]>>13<r[a8]>>16&&(3&r[Jt])===e&&(r[Jt]+=8192,iD(a,s)):iD(a,s)}const d8=-1;class g7{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function iM(r){return r!==d8}function m7(r){return 32767&r}function _7(r,e){let t=function U6e(r){return r>>16}(r),n=e;for(;t>0;)n=n[o8],t--;return n}let sM=!0;function jh(r){const e=sM;return sM=r,e}const sD=255,oD=5;let W6e=0;const vc={};function Zh(r,e){const t=aD(r,e);if(-1!==t)return t;const n=e[Je];n.firstCreatePass&&(r.injectorIndex=e.length,oM(n.data,r),oM(e,null),oM(n.blueprint,null));const i=Yh(r,e),s=r.injectorIndex;if(iM(i)){const o=m7(i),a=_7(i,e),c=a[Je].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function oM(r,e){r.push(0,0,0,0,0,0,0,0,e)}function aD(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function Yh(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=pD(i),null===n)return d8;if(t++,i=i[o8],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return d8}function aM(r,e,t){!function q6e(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(a7)&&(n=t[a7]),null==n&&(n=t[a7]=W6e++);const i=n&sD;e.data[r+(i>>oD)]|=1<<i}(r,e,t)}function cD(r,e,t){if(t&ln.Optional||void 0!==r)return r;wy()}function lD(r,e,t,n){if(t&ln.Optional&&void 0===n&&(n=null),!(t&(ln.Self|ln.Host))){const i=r[D4],s=Ds(void 0);try{return i?i.get(e,n,t&ln.Optional):sz(e,n,t&ln.Optional)}finally{Ds(s)}}return cD(n,0,t)}function uD(r,e,t,n=ln.Default,i){if(null!==r){if(2048&e[Jt]&&!(n&ln.Self)){const o=function Q6e(r,e,t,n,i){let s=r,o=e;for(;null!==s&&null!==o&&2048&o[Jt]&&!(512&o[Jt]);){const a=fD(s,o,t,n|ln.Self,vc);if(a!==vc)return a;let c=s.parent;if(!c){const l=o[Sz];if(l){const f=l.get(t,vc,n);if(f!==vc)return f}c=pD(o),o=o[o8]}s=c}return i}(r,e,t,n,vc);if(o!==vc)return o}const s=fD(r,e,t,n,vc);if(s!==vc)return s}return lD(e,t,n,i)}function fD(r,e,t,n,i){const s=function Y6e(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(a7)?r[a7]:void 0;return"number"==typeof e?e>=0?e&sD:X6e:e}(t);if("function"==typeof s){if(!Kz(e,r,n))return n&ln.Host?cD(i,0,n):lD(e,t,n,i);try{let o;if(o=s(n),null!=o||n&ln.Optional)return o;wy()}finally{eD()}}else if("number"==typeof s){let o=null,a=aD(r,e),c=d8,l=n&ln.Host?e[Vr][ki]:null;for((-1===a||n&ln.SkipSelf)&&(c=-1===a?Yh(r,e):e[a+8],c!==d8&&hD(n,!1)?(o=e[Je],a=m7(c),e=_7(c,e)):a=-1);-1!==a;){const f=e[Je];if(dD(s,a,f.data)){const d=Z6e(a,e,t,o,n,l);if(d!==vc)return d}c=e[a+8],c!==d8&&hD(n,e[Je].data[a+8]===l)&&dD(s,a,e)?(o=f,a=m7(c),e=_7(c,e)):a=-1}}return i}function Z6e(r,e,t,n,i,s){const o=e[Je],a=o.data[r+8],f=Kh(a,o,t,null==n?a6(a)&&sM:n!=o&&0!=(3&a.type),i&ln.Host&&s===a);return null!==f?u6(e,o,f,a):vc}function Kh(r,e,t,n,i){const s=r.providerIndexes,o=e.data,a=1048575&s,c=r.directiveStart,f=s>>20,m=i?a+f:r.directiveEnd;for(let E=n?a:a+f;E<m;E++){const w=o[E];if(E<c&&t===w||E>=c&&w.type===t)return E}if(i){const E=o[c];if(E&&Oa(E)&&E.type===t)return c}return null}function u6(r,e,t,n){let i=r[t];const s=e.data;if(function $6e(r){return r instanceof g7}(i)){const o=i;o.resolving&&function vle(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${t}`)}(function r1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Kt(r)}(s[t]));const a=jh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ds(o.injectImpl):null;Kz(r,n,ln.Default);try{i=r[t]=o.factory(void 0,s,r,n),e.firstCreatePass&&t>=n.directiveStart&&function V6e(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(n){const o=xz(e);(t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o)}i&&(t.preOrderHooks??=[]).push(0-r,i),s&&((t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s))}(t,s[t],e)}finally{null!==l&&Ds(l),jh(a),o.resolving=!1,eD()}}return i}function dD(r,e,t){return!!(t[e+(r>>oD)]&1<<r)}function hD(r,e){return!(r&ln.Self||r&ln.Host&&e)}class us{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return uD(this._tNode,this._lView,e,Ih(n),t)}}function X6e(){return new us(ai(),Se())}function ar(r){return S3(()=>{const e=r.prototype.constructor,t=e[P3]||cM(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const s=i[P3]||cM(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function cM(r){return Ty(r)?()=>{const e=cM(Bt(r));return e&&e()}:c6(r)}function pD(r){const e=r[Je],t=e.type;return 2===t?e.declTNode:1===t?r[ki]:null}const p8="__parameters__";function m8(r,e,t){return S3(()=>{const n=function lM(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...s){if(this instanceof i)return n.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(c,l,f){const d=c.hasOwnProperty(p8)?c[p8]:Object.defineProperty(c,p8,{value:[]})[p8];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function v8(r,e){r.forEach(t=>Array.isArray(t)?v8(t,e):e(t))}function mD(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function Qh(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function y7(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function po(r,e,t){let n=C8(r,e);return n>=0?r[1|n]=t:(n=~n,function s0e(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function uM(r,e){const t=C8(r,e);if(t>=0)return r[1|t]}function C8(r,e){return function _D(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const s=n+(i-n>>1),o=r[s<<t];if(e===o)return s<<t;o>e?i=s:n=s+1}return~(i<<t)}(r,e,1)}const fs=o7(m8("Optional"),8),ep=o7(m8("SkipSelf"),4);function sp(r){return 128==(128&r.flags)}var $4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}($4||{});const T0e=/^>|^->|<!--|-->|--!>|<!-$/g,b0e=/(<|>)/,w0e="\u200b$1\u200b";const gM=new Map;let N0e=0;const _M="__ngContext__";function xi(r,e){Hs(e)?(r[_M]=e[d7],function I0e(r){gM.set(r[d7],r)}(e)):r[_M]=e}let vM;function CM(r,e){return vM(r,e)}function S7(r){const e=r[Q1];return Vs(e)?e[Q1]:e}function DD(r){return VD(r[u7])}function HD(r){return VD(r[Pa])}function VD(r){for(;null!==r&&!Vs(r);)r=r[Pa];return r}function E8(r,e,t,n,i){if(null!=n){let s,o=!1;Vs(n)?s=n:Hs(n)&&(o=!0,n=n[Dr]);const a=w1(n);0===r&&null!==t?null==i?GD(e,t,a):f6(e,t,a,i||null,!0):1===r&&null!==t?f6(e,t,a,i||null,!0):2===r?dp(e,a,o):3===r&&e.destroyNode(a),null!=s&&function J0e(r,e,t,n,i){const s=t[pc];s!==w1(t)&&E8(e,r,n,s,i);for(let a=oi;a<t.length;a++){const c=t[a];O7(c[Je],c,r,e,n,s)}}(e,r,s,t,i)}}function ap(r,e){return r.createText(e)}function FD(r,e,t){r.setValue(e,t)}function yM(r,e){return r.createComment(function ND(r){return r.replace(T0e,e=>e.replace(b0e,w0e))}(e))}function cp(r,e,t){return r.createElement(e,t)}function $D(r,e){const t=r[c8],n=t.indexOf(e);Fz(e),t.splice(n,1)}function lp(r,e){if(r.length<=oi)return;const t=oi+e,n=r[t];if(n){const i=n[f7];null!==i&&i!==r&&$D(i,n),e>0&&(r[t-1][Pa]=n[Pa]);const s=Qh(r,oi+e);!function B0e(r,e){O7(r,e,e[Xt],2,null,null),e[Dr]=null,e[ki]=null}(n[Je],n);const o=s[hc];null!==o&&o.detachView(s[Je]),n[Q1]=null,n[Pa]=null,n[Jt]&=-129}return n}function MM(r,e){if(!(256&e[Jt])){const t=e[Xt];e[Rh]?.destroy(),e[zh]?.destroy(),t.destroyNode&&O7(r,e,t,3,null,null),function W0e(r){let e=r[u7];if(!e)return EM(r[Je],r);for(;e;){let t=null;if(Hs(e))t=e[u7];else{const n=e[oi];n&&(t=n)}if(!t){for(;e&&!e[Pa]&&e!==r;)Hs(e)&&EM(e[Je],e),e=e[Q1];null===e&&(e=r),Hs(e)&&EM(e[Je],e),t=e&&e[Pa]}e=t}}(e)}}function EM(r,e){if(!(256&e[Jt])){e[Jt]&=-129,e[Jt]|=256,function Y0e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof g7)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],c=s[o+1];mc(4,a,c);try{c.call(a)}finally{mc(5,a,c)}}else{mc(4,i,s);try{s.call(i)}finally{mc(5,i,s)}}}}}(r,e),function Z0e(r,e){const t=r.cleanup,n=e[i8];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else t[s].call(n[t[s+1]]);null!==n&&(e[i8]=null);const i=e[H4];if(null!==i){e[H4]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(r,e),1===e[Je].type&&e[Xt].destroy();const t=e[f7];if(null!==t&&Vs(e[Q1])){t!==e[Q1]&&$D(t,e);const n=e[hc];null!==n&&n.detachView(r)}!function k0e(r){gM.delete(r[d7])}(e)}}function SM(r,e,t){return BD(r,e.parent,t)}function BD(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[Dr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:s}=r.data[n.directiveStart+i];if(s===Go.None||s===Go.Emulated)return null}return Fs(n,t)}}function f6(r,e,t,n,i){r.insertBefore(e,t,n,i)}function GD(r,e,t){r.appendChild(e,t)}function UD(r,e,t,n,i){null!==n?f6(r,e,t,n,i):GD(r,e,t)}function up(r,e){return r.parentNode(e)}function WD(r,e,t){return jD(r,e,t)}function qD(r,e,t){return 40&r.type?Fs(r,t):null}let PM,hp,wM,pp,jD=qD;function ZD(r,e){jD=r,PM=e}function fp(r,e,t,n){const i=SM(r,n,e),s=e[Xt],a=WD(n.parent||e[ki],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)UD(s,i,t[c],a,!1);else UD(s,i,t,a,!1);void 0!==PM&&PM(s,n,e,t,i)}function P7(r,e){if(null!==e){const t=e.type;if(3&t)return Fs(e,r);if(4&t)return OM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return P7(r,n);{const i=r[e.index];return Vs(i)?OM(-1,i):w1(i)}}if(32&t)return CM(e,r)()||w1(r[e.index]);{const n=YD(r,e);return null!==n?Array.isArray(n)?n[0]:P7(S7(r[Vr]),n):P7(r,e.next)}}return null}function YD(r,e){return null!==e?r[Vr][ki].projection[e.projection]:null}function OM(r,e){const t=oi+r+1;if(t<e.length){const n=e[t],i=n[Je].firstChild;if(null!==i)return P7(n,i)}return e[pc]}function dp(r,e,t){const n=up(r,e);n&&function K0e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function TM(r,e,t,n,i,s,o){for(;null!=t;){const a=n[t.index],c=t.type;if(o&&0===e&&(a&&xi(w1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)TM(r,e,t.child,n,i,s,!1),E8(e,r,i,a,s);else if(32&c){const l=CM(t,n);let f;for(;f=l();)E8(e,r,i,f,s);E8(e,r,i,a,s)}else 16&c?XD(r,e,n,t,i,s):E8(e,r,i,a,s);t=o?t.projectionNext:t.next}}function O7(r,e,t,n,i,s){TM(t,n,r.firstChild,e,i,s,!1)}function XD(r,e,t,n,i,s){const o=t[Vr],c=o[ki].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)E8(e,r,i,c[l],s);else{let l=c;const f=o[Q1];sp(n)&&(l.flags|=128),TM(r,e,l,f,i,s,!0)}}function QD(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function JD(r,e,t){const{mergedAttrs:n,classes:i,styles:s}=t;null!==n&&Vy(r,e,n),null!==i&&QD(r,e,i),null!==s&&function t8e(r,e,t){r.setAttribute(e,"style",t)}(r,e,s)}function S8(r){return function bM(){if(void 0===hp&&(hp=null,C1.trustedTypes))try{hp=C1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return hp}()?.createHTML(r)||r}function P8(){if(void 0!==wM)return wM;if(typeof document<"u")return document;throw new ge(210,!1)}function NM(){if(void 0===pp&&(pp=null,C1.trustedTypes))try{pp=C1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return pp}function eH(r){return NM()?.createHTML(r)||r}function nH(r){return NM()?.createScriptURL(r)||r}class d6{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${tz})`}}class o8e extends d6{getTypeName(){return"HTML"}}class a8e extends d6{getTypeName(){return"Style"}}class c8e extends d6{getTypeName(){return"Script"}}class l8e extends d6{getTypeName(){return"URL"}}class u8e extends d6{getTypeName(){return"ResourceURL"}}function go(r){return r instanceof d6?r.changingThisBreaksApplicationSecurity:r}function Cc(r,e){const t=function f8e(r){return r instanceof d6&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${tz})`)}return t===e}function rH(r){const e=new v8e(r);return function C8e(){try{return!!(new window.DOMParser).parseFromString(S8(""),"text/html")}catch{return!1}}()?new _8e(e):e}class _8e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(S8(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class v8e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=S8(e),t}}const y8e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function gp(r){return(r=String(r)).match(y8e)?r:"unsafe:"+r}function w3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function T7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const iH=w3("area,br,col,hr,img,wbr"),sH=w3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),oH=w3("rp,rt"),AM=T7(iH,T7(sH,w3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),T7(oH,w3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),T7(oH,sH)),IM=w3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),aH=T7(IM,w3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),w3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),M8e=w3("script,style,template");class E8e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!AM.hasOwnProperty(t))return this.sanitizedSomething=!0,!M8e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const s=n.item(i),o=s.name,a=o.toLowerCase();if(!aH.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;IM[a]&&(c=gp(c)),this.buf.push(" ",o,'="',cH(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();AM.hasOwnProperty(t)&&!iH.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(cH(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const S8e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P8e=/([^\#-~ |!])/g;function cH(r){return r.replace(/&/g,"&amp;").replace(S8e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(P8e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let mp;function lH(r,e){let t=null;try{mp=mp||rH(r);let n=e?String(e):"";t=mp.getInertBodyElement(n);let i=5,s=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=s,s=t.innerHTML,t=mp.getInertBodyElement(n)}while(n!==s);return S8((new E8e).sanitizeChildren(kM(t)||t))}finally{if(t){const n=kM(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function kM(r){return"content"in r&&function O8e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Wo=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(Wo||{});function b7(r){const e=w7();return e?eH(e.sanitize(Wo.HTML,r)||""):Cc(r,"HTML")?eH(go(r)):lH(P8(),Kt(r))}function _p(r){const e=w7();return e?e.sanitize(Wo.URL,r)||"":Cc(r,"URL")?go(r):gp(Kt(r))}function uH(r){const e=w7();if(e)return nH(e.sanitize(Wo.RESOURCE_URL,r)||"");if(Cc(r,"ResourceURL"))return nH(go(r));throw new ge(904,!1)}function w7(){const r=Se();return r&&r[s8].sanitizer}class et{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=De({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const N7=new et("ENVIRONMENT_INITIALIZER"),dH=new et("INJECTOR",-1),hH=new et("INJECTOR_DEF_TYPES");class xM{get(e,t=s7){if(t===s7){const n=new Error(`NullInjectorError: No provider for ${f2(e)}!`);throw n.name="NullInjectorError",n}return t}}function I8e(...r){return{\u0275providers:pH(0,r),\u0275fromNgModule:!0}}function pH(r,...e){const t=[],n=new Set;let i;const s=o=>{t.push(o)};return v8(e,o=>{const a=o;vp(a,s,[],n)&&(i||=[],i.push(a))}),void 0!==i&&gH(i,s),t}function gH(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];RM(i,s=>{e(s,n)})}}function vp(r,e,t,n){if(!(r=Bt(r)))return!1;let i=null,s=wh(r);const o=!s&&Rn(r);if(s||o){if(o&&!o.standalone)return!1;i=r}else{const c=r.ngModule;if(s=wh(c),!s)return!1;i=c}const a=n.has(i);if(o){if(a)return!1;if(n.add(i),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)vp(l,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;n.add(i);try{v8(s.imports,f=>{vp(f,e,t,n)&&(l||=[],l.push(f))})}finally{}void 0!==l&&gH(l,e)}if(!a){const l=c6(i)||(()=>new i);e({provide:i,useFactory:l,deps:Yn},i),e({provide:hH,useValue:i,multi:!0},i),e({provide:N7,useValue:()=>Oe(i),multi:!0},i)}const c=s.providers;if(null!=c&&!a){const l=r;RM(c,f=>{e(f,l)})}}}return i!==r&&void 0!==r.providers}function RM(r,e){for(let t of r)by(t)&&(t=t.\u0275providers),Array.isArray(t)?RM(t,e):e(t)}const k8e=l1({provide:String,useValue:l1});function zM(r){return null!==r&&"object"==typeof r&&k8e in r}function h6(r){return"function"==typeof r}const DM=new et("Set Injector scope."),Cp={},L8e={};let HM;function yp(){return void 0===HM&&(HM=new xM),HM}class mo{}class Mp extends mo{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,FM(e,o=>this.processProvider(o)),this.records.set(dH,O8(void 0,this)),i.has("environment")&&this.records.set(mo,O8(void 0,this));const s=this.records.get(DM);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(hH.multi,Yn,ln.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=z4(this),n=Ds(void 0);try{return e()}finally{z4(t),Ds(n)}}get(e,t=s7,n=ln.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(uz))return e[uz](this);n=Ih(n);const s=z4(this),o=Ds(void 0);try{if(!(n&ln.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function V8e(r){return"function"==typeof r||"object"==typeof r&&r instanceof et}(e)&&bh(e);c=l&&this.injectableDefInScope(l)?O8(VM(e),Cp):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&ln.Self?yp():this.parent).get(e,t=n&ln.Optional&&t===s7?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Ah]=a[Ah]||[]).unshift(f2(e)),s)throw a;return function xle(r,e,t,n){const i=r[Ah];throw e[az]&&i.unshift(e[az]),r.message=function Lle(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=f2(e);if(Array.isArray(e))i=e.map(f2).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):f2(a)))}i=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(wle,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[Ah]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{Ds(o),z4(s)}}resolveInjectorInitializers(){const e=z4(this),t=Ds(void 0);try{const i=this.get(N7.multi,Yn,ln.Self);for(const s of i)s()}finally{z4(e),Ds(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(f2(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(e){let t=h6(e=Bt(e))?e:Bt(e&&e.provide);const n=function z8e(r){return zM(r)?O8(void 0,r.useValue):O8(vH(r),Cp)}(e);if(h6(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=O8(void 0,Cp,!0),i.factory=()=>zy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===Cp&&(t.value=L8e,t.value=t.factory()),"object"==typeof t.value&&t.value&&function H8e(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Bt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function VM(r){const e=bh(r),t=null!==e?e.factory:c6(r);if(null!==t)return t;if(r instanceof et)throw new ge(204,!1);if(r instanceof Function)return function R8e(r){const e=r.length;if(e>0)throw y7(e,"?"),new ge(204,!1);const t=function Ple(r){return r&&(r[Nh]||r[rz])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ge(204,!1)}function vH(r,e,t){let n;if(h6(r)){const i=Bt(r);return c6(i)||VM(i)}if(zM(r))n=()=>Bt(r.useValue);else if(function _H(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...zy(r.deps||[]));else if(function mH(r){return!(!r||!r.useExisting)}(r))n=()=>Oe(Bt(r.useExisting));else{const i=Bt(r&&(r.useClass||r.provide));if(!function D8e(r){return!!r.deps}(r))return c6(i)||VM(i);n=()=>new i(...zy(r.deps))}return n}function O8(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function FM(r,e){for(const t of r)Array.isArray(t)?FM(t,e):t&&by(t)?FM(t.\u0275providers,e):e(t)}const Ep=new et("AppId",{providedIn:"root",factory:()=>F8e}),F8e="ng",CH=new et("Platform Initializer"),N3=new et("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),yH=new et("AnimationModuleType"),MH=new et("CSP nonce",{providedIn:"root",factory:()=>P8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let SH=(r,e,t)=>null;function jM(r,e,t=!1){return SH(r,e,t)}class K8e{}class TH{}class Q8e{resolveComponentFactory(e){throw function X8e(r){const e=Error(`No component factory found for ${f2(r)}.`);return e.ngComponent=r,e}(e)}}let wp=(()=>{class e{}return e.NULL=new Q8e,e})();function J8e(){return b8(ai(),Se())}function b8(r,e){return new Li(Fs(r,e))}let Li=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=J8e,e})();function e5e(r){return r instanceof Li?r.nativeElement:r}class x7{}let yc=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function t5e(){const r=Se(),t=ho(ai().index,r);return(Hs(t)?t:r)[Xt]}(),e})(),n5e=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>null}),e})();class w8{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const wH=new w8("16.2.0"),KM={};function kH(r,e=null,t=null,n){const i=xH(r,e,t,n);return i.resolveInjectorInitializers(),i}function xH(r,e=null,t=null,n,i=new Set){const s=[t||Yn,I8e(r)];return n=n||("object"==typeof r?void 0:f2(r)),new Mp(s,e||yp(),n||null,i)}let ci=(()=>{var r;class e{static create(n,i){if(Array.isArray(n))return kH({name:""},i,n,"");{const s=n.name??"";return kH({name:s},n.parent,n.providers,s)}}}return(r=e).THROW_IF_NOT_FOUND=s7,r.NULL=new xM,r.\u0275prov=De({token:r,providedIn:"any",factory:()=>Oe(dH)}),r.__NG_ELEMENT_ID__=-1,e})();function A3(r){return r instanceof Function?r():r}let JM=(()=>{var r;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new ge(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const n of this.callbacks)n.invoke()}finally{this.runningCallbacks=!1;for(const n of this.deferredCallbacks)this.callbacks.add(n);this.deferredCallbacks.clear()}}register(n){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(n)}unregister(n){this.callbacks.delete(n),this.deferredCallbacks.delete(n)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function L7(r){for(;r;){r[Jt]|=64;const e=S7(r);if(Gy(r)&&!e)return r;r=e}return null}function eE(r){return r.ngOriginalError}class p6{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&eE(e);for(;t&&eE(t);)t=eE(t);return t||null}}const HH=new et("",{providedIn:"root",factory:()=>!1});class BH extends Nz{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){L7(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,n){const i=k2(this);this.trackingVersion++;try{e(t,n)}finally{k2(i)}}destroy(){this.trackingVersion++}}let Ap=null;function GH(){return Ap??=new BH,Ap}function UH(r,e){return r[e]??GH()}function WH(r,e){const t=GH();t.hasReadASignal&&(r[e]=Ap,t.lView=r,Ap=new BH)}const en={};function _(r){qH(zn(),Se(),ls()+r,!1)}function qH(r,e,t,n){if(!n)if(3==(3&e[Jt])){const s=r.preOrderCheckHooks;null!==s&&Wh(e,s,t)}else{const s=r.preOrderHooks;null!==s&&qh(e,s,0,t)}l6(t)}function U(r,e=ln.Default){const t=Se();return null===t?Oe(r,e):uD(ai(),t,Bt(r),e)}function Ip(r,e,t,n,i,s,o,a,c,l,f){const d=e.blueprint.slice();return d[Dr]=i,d[Jt]=140|n,(null!==l||r&&2048&r[Jt])&&(d[Jt]|=2048),Vz(d),d[Q1]=d[o8]=r,d[Hr]=t,d[s8]=o||r&&r[s8],d[Xt]=a||r&&r[Xt],d[D4]=c||r&&r[D4]||null,d[ki]=s,d[d7]=function A0e(){return N0e++}(),d[O3]=f,d[Sz]=l,d[Vr]=2==e.type?r[Vr]:d,d}function I8(r,e,t,n,i){let s=r.data[e];if(null===s)s=tE(r,e,t,n,i),function A6e(){return Ft.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=i;const o=p7();s.injectorIndex=null===o?-1:o.injectorIndex}return _c(s,!0),s}function tE(r,e,t,n,i){const s=Wz(),o=Yy(),c=r.data[e]=function O5e(r,e,t,n,i,s){let o=e?e.injectorIndex:-1,a=0;return u8()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}function R7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function ZH(r,e,t,n,i){const s=UH(e,Rh),o=ls(),a=2&n;try{if(l6(-1),a&&e.length>gn&&qH(r,e,gn,!1),mc(a?2:0,i),a)s.runInContext(t,n,i);else{const l=k2(null);try{t(n,i)}finally{k2(l)}}}finally{a&&null===e[Rh]&&WH(e,Rh),l6(o),mc(a?3:1,i)}}function nE(r,e,t){if(By(e)){const n=k2(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=r.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{k2(n)}}}function rE(r,e,t){Uz()&&(function k5e(r,e,t,n){const i=t.directiveStart,s=t.directiveEnd;a6(t)&&function V5e(r,e,t){const n=Fs(e,r),i=YH(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=kp(r,Ip(r,i,null,o,n,e,null,r[s8].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||Zh(t,e),xi(n,e);const o=t.initialInputs;for(let a=i;a<s;a++){const c=r.data[a],l=u6(e,r,a,t);xi(l,e),null!==o&&F5e(0,a-i,l,c,0,o),Oa(c)&&(ho(t.index,e)[Hr]=u6(e,r,a,t))}}(r,e,t,Fs(t,e)),64==(64&t.flags)&&eV(r,e,t))}function iE(r,e,t=Fs){const n=e.localNames;if(null!==n){let i=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,r):r[o];r[i++]=a}}}function YH(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=sE(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function sE(r,e,t,n,i,s,o,a,c,l,f){const d=gn+n,m=d+i,E=function C5e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:en);return t}(d,m),w="function"==typeof l?l():l;return E[Je]={type:r,blueprint:E,template:t,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:f}}let KH=r=>null;function XH(r,e,t,n){for(let i in r)if(r.hasOwnProperty(i)){t=null===t?{}:t;const s=r[i];null===n?QH(t,e,i,s):n.hasOwnProperty(i)&&QH(t,e,n[i],s)}return t}function QH(r,e,t,n){r.hasOwnProperty(t)?r[t].push(e,n):r[t]=[e,n]}function _o(r,e,t,n,i,s,o,a){const c=Fs(e,t);let f,l=e.inputs;!a&&null!=l&&(f=l[n])?(uE(r,t,f,n,i),a6(e)&&function w5e(r,e){const t=ho(e,r);16&t[Jt]||(t[Jt]|=64)}(t,e.index)):3&e.type&&(n=function b5e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=o?o(i,e.value||"",n):i,s.setProperty(c,n,i))}function oE(r,e,t,n){if(Uz()){const i=null===n?null:{"":-1},s=function L5e(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(_z(e,o.selectors,!1))if(n||(n=[]),Oa(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),n.unshift(...a,o),aE(r,e,a.length)}else n.unshift(o),aE(r,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,n,i),n.push(o)}return null===n?null:[n,i]}(r,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&JH(r,e,t,o,i,a),i&&function R5e(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new ge(-301,!1);n.push(e[i],s)}}}(t,n,i)}t.mergedAttrs=c7(t.mergedAttrs,t.attrs)}function JH(r,e,t,n,i,s){for(let l=0;l<n.length;l++)aM(Zh(t,e),r,n[l].type);!function D5e(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const f=n[l];f.providersResolver&&f.providersResolver(f)}let o=!1,a=!1,c=R7(r,e,n.length,null);for(let l=0;l<n.length;l++){const f=n[l];t.mergedAttrs=c7(t.mergedAttrs,f.hostAttrs),H5e(r,t,e,c,f),z5e(c,f,i),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const d=f.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function T5e(r,e,t){const i=e.directiveEnd,s=r.data,o=e.attrs,a=[];let c=null,l=null;for(let f=e.directiveStart;f<i;f++){const d=s[f],m=t?t.get(d):null,w=m?m.outputs:null;c=XH(d.inputs,f,c,m?m.inputs:null),l=XH(d.outputs,f,l,w);const R=null===c||null===o||mz(e)?null:$5e(c,f,o);a.push(R)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,s)}function eV(r,e,t){const n=t.directiveStart,i=t.directiveEnd,s=t.index,o=function k6e(){return Ft.lFrame.currentDirectiveIndex}();try{l6(s);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];Xy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&x5e(c,l)}}finally{l6(-1),Xy(o)}}function x5e(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function aE(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function z5e(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;Oa(e)&&(t[""]=r)}}function H5e(r,e,t,n,i){r.data[n]=i;const s=i.factory||(i.factory=c6(i.type)),o=new g7(s,Oa(i),U);r.blueprint[n]=o,t[n]=o,function A5e(r,e,t,n,i){const s=i.hostBindings;if(s){let o=r.hostBindingOpCodes;null===o&&(o=r.hostBindingOpCodes=[]);const a=~e.index;(function I5e(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(r,e,n,R7(r,t,i.hostVars,en),i)}function Mc(r,e,t,n,i,s){const o=Fs(r,e);cE(e[Xt],o,s,r.value,t,n,i)}function cE(r,e,t,n,i,s,o){if(null==s)r.removeAttribute(e,i,t);else{const a=null==o?Kt(s):o(s,n||"",i);r.setAttribute(e,i,a,t)}}function F5e(r,e,t,n,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)tV(n,t,o[a++],o[a++],o[a++])}function tV(r,e,t,n,i){const s=k2(null);try{const o=r.inputTransforms;null!==o&&o.hasOwnProperty(n)&&(i=o[n].call(e,i)),null!==r.setInput?r.setInput(e,i,t,n):e[n]=i}finally{k2(s)}}function $5e(r,e,t){let n=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(r.hasOwnProperty(s)){null===n&&(n=[]);const o=r[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function nV(r,e,t,n){return[r,!0,!1,e,null,0,n,t,null,null,null]}function rV(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=r.data[s];Jy(t[n]),o.contentQueries(2,e[s],s)}}}function kp(r,e){return r[u7]?r[Ez][Pa]=e:r[u7]=e,r[Ez]=e,e}function lE(r,e,t){Jy(0);const n=k2(null);try{e(r,t)}finally{k2(n)}}function iV(r){return r[i8]||(r[i8]=[])}function sV(r){return r.cleanup||(r.cleanup=[])}function aV(r,e){const t=r[D4],n=t?t.get(p6,null):null;n&&n.handleError(e)}function uE(r,e,t,n,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];tV(r.data[o],e[o],n,a,i)}}function I3(r,e,t){const n=Bh(e,r);FD(r[Xt],n,t)}function B5e(r,e){const t=ho(e,r),n=t[Je];!function G5e(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[Dr];null!==i&&null===t[O3]&&(t[O3]=jM(i,t[D4])),fE(n,t,t[Hr])}function fE(r,e,t){eM(e);try{const n=r.viewQuery;null!==n&&lE(1,n,t);const i=r.template;null!==i&&ZH(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&rV(r,e),r.staticViewQueries&&lE(2,r.viewQuery,t);const s=r.components;null!==s&&function U5e(r,e){for(let t=0;t<e.length;t++)B5e(r,e[t])}(e,s)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[Jt]&=-5,tM()}}let cV=(()=>{var r;class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,s){const o=typeof Zone>"u"?null:Zone.current,a=new c6e(n,f=>{this.all.has(f)&&this.queue.set(f,o)},s);let c;this.all.add(a),a.notify();const l=()=>{a.cleanup(),c?.(),this.all.delete(a),this.queue.delete(a)};return c=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function xp(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=Oy(i,a):2==s&&(n=Oy(n,a+": "+e[++o]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}function z7(r,e,t,n,i=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(w1(s)),Vs(s)){for(let a=oi;a<s.length;a++){const c=s[a],l=c[Je].firstChild;null!==l&&z7(c[Je],c,l,n)}s[pc]!==s[Dr]&&n.push(s[pc])}const o=t.type;if(8&o)z7(r,e,t.child,n);else if(32&o){const a=CM(t,e);let c;for(;c=a();)n.push(c)}else if(16&o){const a=YD(e,t);if(Array.isArray(a))n.push(...a);else{const c=S7(e[Vr]);z7(c[Je],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function Lp(r,e,t,n=!0){const i=e[s8],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{lV(r,e,r.template,t)}catch(c){throw n&&aV(e,c),c}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function lV(r,e,t,n){const i=e[Jt];if(256!=(256&i)){e[s8].effectManager?.flush(),eM(e);try{Vz(e),function jz(r){return Ft.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&ZH(r,e,t,2,n);const o=3==(3&i);if(o){const l=r.preOrderCheckHooks;null!==l&&Wh(e,l,null)}else{const l=r.preOrderHooks;null!==l&&qh(e,l,0,null),nM(e,0)}if(function j5e(r){for(let e=DD(r);null!==e;e=HD(e)){if(!e[Pz])continue;const t=e[c8];for(let n=0;n<t.length;n++){C6e(t[n])}}}(e),uV(e,2),null!==r.contentQueries&&rV(r,e),o){const l=r.contentCheckHooks;null!==l&&Wh(e,l)}else{const l=r.contentHooks;null!==l&&qh(e,l,1),nM(e,1)}!function v5e(r,e){const t=r.hostBindingOpCodes;if(null===t)return;const n=UH(e,zh);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)l6(~s);else{const o=s,a=t[++i],c=t[++i];I6e(a,o),n.runInContext(c,2,e[o])}}}finally{null===e[zh]&&WH(e,zh),l6(-1)}}(r,e);const a=r.components;null!==a&&dV(e,a,0);const c=r.viewQuery;if(null!==c&&lE(2,c,n),o){const l=r.viewCheckHooks;null!==l&&Wh(e,l)}else{const l=r.viewHooks;null!==l&&qh(e,l,2),nM(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[Jt]&=-73,Fz(e)}finally{tM()}}}function uV(r,e){for(let t=DD(r);null!==t;t=HD(t))for(let n=oi;n<t.length;n++)fV(t[n],e)}function Z5e(r,e,t){fV(ho(e,r),t)}function fV(r,e){if(!function _6e(r){return 128==(128&r[Jt])}(r))return;const t=r[Je];if(80&r[Jt]&&0===e||1024&r[Jt]||2===e)lV(t,r,t.template,r[Hr]);else if(r[l7]>0){uV(r,1);const i=r[Je].components;null!==i&&dV(r,i,1)}}function dV(r,e,t){for(let n=0;n<e.length;n++)Z5e(r,e[n],t)}class D7{get rootNodes(){const e=this._lView,t=e[Je];return z7(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Hr]}set context(e){this._lView[Hr]=e}get destroyed(){return 256==(256&this._lView[Jt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Q1];if(Vs(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(lp(e,n),Qh(t,n))}this._attachedToViewContainer=!1}MM(this._lView[Je],this._lView)}onDestroy(e){!function Bz(r,e){if(256==(256&r[Jt]))throw new ge(911,!1);null===r[H4]&&(r[H4]=[]),r[H4].push(e)}(this._lView,e)}markForCheck(){L7(this._cdRefInjectingView||this._lView)}detach(){this._lView[Jt]&=-129}reattach(){this._lView[Jt]|=128}detectChanges(){Lp(this._lView[Je],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function U0e(r,e){O7(r,e,e[Xt],2,null,null)}(this._lView[Je],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e}}class Y5e extends D7{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Lp(e[Je],e,e[Hr],!1)}checkNoChanges(){}get context(){return null}}class hV extends wp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Rn(e);return new H7(t,this.ngModule)}}function pV(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class X5e{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Ih(n);const i=this.injector.get(e,KM,n);return i!==KM||t===KM?i:this.parentInjector.get(e,t,n)}}class H7 extends TH{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=pV(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return pV(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Ule(r){return r.map(Gle).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let s=(i=i||this.ngModule)instanceof mo?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new X5e(e,s):e,a=o.get(x7,null);if(null===a)throw new ge(407,!1);const d={rendererFactory:a,sanitizer:o.get(n5e,null),effectManager:o.get(cV,null),afterRenderEventManager:o.get(JM,null)},m=a.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",w=n?function y5e(r,e,t,n){const s=n.get(HH,!1)||t===Go.ShadowDom,o=r.selectRootElement(e,s);return function M5e(r){KH(r)}(o),o}(m,n,this.componentDef.encapsulation,o):cp(m,E,function K5e(r){const e=r.toLowerCase();return"svg"===e?zz:"math"===e?"math":null}(E)),$=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let G=null;null!==w&&(G=jM(w,o,!0));const de=sE(0,null,null,1,0,null,null,null,null,null,null),Ce=Ip(null,de,null,$,null,null,d,m,o,null,G);let Le,tt;eM(Ce);try{const gt=this.componentDef;let yn,Et=null;gt.findHostDirectiveDefs?(yn=[],Et=new Map,gt.findHostDirectiveDefs(gt,yn,Et),yn.push(gt)):yn=[gt];const ti=function J5e(r,e){const t=r[Je],n=gn;return r[n]=e,I8(t,n,2,"#host",null)}(Ce,w),Y0=function eue(r,e,t,n,i,s,o){const a=i[Je];!function tue(r,e,t,n){for(const i of r)e.mergedAttrs=c7(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(xp(e,e.mergedAttrs,!0),null!==t&&JD(n,t,e))}(n,r,e,o);let c=null;null!==e&&(c=jM(e,i[D4]));const l=s.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const d=Ip(i,YH(t),null,f,i[r.index],r,s,l,null,null,c);return a.firstCreatePass&&aE(a,r,n.length-1),kp(i,d),i[r.index]=d}(ti,w,gt,yn,Ce,d,m);tt=Hz(de,gn),w&&function rue(r,e,t,n){if(n)Vy(r,t,["ng-version",wH.full]);else{const{attrs:i,classes:s}=function Wle(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let s=r[n];if("string"==typeof s)2===i?""!==s&&e.push(s,r[++n]):8===i&&t.push(s);else{if(!Sa(i))break;i=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&Vy(r,t,i),s&&s.length>0&&QD(r,t,s.join(" "))}}(m,gt,w,n),void 0!==t&&function iue(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const s=t[i];n.push(null!=s?Array.from(s):null)}}(tt,this.ngContentSelectors,t),Le=function nue(r,e,t,n,i,s){const o=ai(),a=i[Je],c=Fs(o,i);JH(a,i,o,t,null,n);for(let f=0;f<t.length;f++)xi(u6(i,a,o.directiveStart+f,o),i);eV(a,i,o),c&&xi(c,i);const l=u6(i,a,o.directiveStart+o.componentOffset,o);if(r[Hr]=i[Hr]=l,null!==s)for(const f of s)f(l,e);return nE(a,o,r),l}(Y0,gt,yn,Et,Ce,[sue]),fE(de,Ce,null)}finally{tM()}return new Q5e(this.componentType,Le,b8(tt,Ce),Ce,tt)}}class Q5e extends K8e{constructor(e,t,n,i,s){super(),this.location=n,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Y5e(i),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;uE(s[Je],s,i,e,t),this.previousInputValues.set(e,t),L7(ho(this._tNode.index,s))}}get injector(){return new us(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function sue(){const r=ai();Uh(Se()[Je],r)}function Ke(r){let e=function gV(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(Oa(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const o=r;o.inputs=Rp(r.inputs),o.inputTransforms=Rp(r.inputTransforms),o.declaredInputs=Rp(r.declaredInputs),o.outputs=Rp(r.outputs);const a=i.hostBindings;a&&lue(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&aue(r,c),l&&cue(r,l),Oh(r.inputs,i.inputs),Oh(r.declaredInputs,i.declaredInputs),Oh(r.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),Oh(o.inputTransforms,i.inputTransforms)),Oa(i)&&i.data.animation){const f=r.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(r),a===Ke&&(t=!1)}}e=Object.getPrototypeOf(e)}!function oue(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=c7(i.hostAttrs,t=c7(t,i.hostAttrs))}}(n)}function Rp(r){return r===dc?{}:r===Yn?[]:r}function aue(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function cue(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,s)=>{e(n,i,s),t(n,i,s)}:e}function lue(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function CV(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[2]&&(t[n]=i[2])}r.inputTransforms=t}function zp(r){return!!dE(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function dE(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function Ec(r,e,t){return r[e]=t}function Ri(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function g6(r,e,t,n){const i=Ri(r,e,t);return Ri(r,e+1,n)||i}function I(r,e,t,n){const i=Se();return Ri(i,f8(),e)&&(zn(),Mc(or(),i,r,e,t,n)),I}function x8(r,e,t,n){return Ri(r,f8(),t)?e+Kt(t)+n:en}function L8(r,e,t,n,i,s){const a=g6(r,T3(),t,i);return b3(2),a?e+Kt(t)+n+Kt(i)+s:en}function R8(r,e,t,n,i,s,o,a){const l=function Dp(r,e,t,n,i){const s=g6(r,e,t,n);return Ri(r,e+2,i)||s}(r,T3(),t,i,o);return b3(3),l?e+Kt(t)+n+Kt(i)+s+Kt(o)+a:en}function m6(r,e,t,n,i,s){const o=Se(),a=x8(o,e,t,n);return a!==en&&Mc(or(),o,r,a,i,s),m6}function O(r,e,t,n,i,s,o,a){const c=Se(),l=zn(),f=r+gn,d=l.firstCreatePass?function Lue(r,e,t,n,i,s,o,a,c){const l=e.consts,f=I8(e,r,4,o||null,V4(l,a));oE(e,t,f,V4(l,c)),Uh(e,f);const d=f.tView=sE(2,f,n,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,f),d.queries=e.queries.embeddedTView(f)),f}(f,l,c,e,t,n,i,s,o):l.data[f];_c(d,!1);const m=IV(l,c,d,r);Gh()&&fp(l,c,m,d),xi(m,c),kp(c,c[f]=nV(m,c,m,d)),Hh(d)&&rE(l,c,d),null!=o&&iE(c,d,a)}let IV=function kV(r,e,t,n){return F4(!0),e[Xt].createComment("")};function un(r){return l8(function N6e(){return Ft.lFrame.contextLView}(),gn+r)}function y(r,e,t){const n=Se();return Ri(n,f8(),e)&&_o(zn(),or(),n,r,e,n[Xt],t,!1),y}function vE(r,e,t,n,i){const o=i?"class":"style";uE(r,t,e.inputs[o],o,n)}function S(r,e,t,n){const i=Se(),s=zn(),o=gn+r,a=i[Xt],c=s.firstCreatePass?function Hue(r,e,t,n,i,s){const o=e.consts,c=I8(e,r,2,n,V4(o,i));return oE(e,t,c,V4(o,s)),null!==c.attrs&&xp(c,c.attrs,!1),null!==c.mergedAttrs&&xp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,i,e,t,n):s.data[o],l=xV(s,i,c,a,e,r);i[o]=l;const f=Hh(c);return _c(c,!0),JD(a,l,c),32!=(32&c.flags)&&Gh()&&fp(s,i,l,c),0===function M6e(){return Ft.lFrame.elementDepthCount}()&&xi(l,i),function E6e(){Ft.lFrame.elementDepthCount++}(),f&&(rE(s,i,c),nE(s,c,i)),null!==n&&iE(i,c),S}function P(){let r=ai();Yy()?Ky():(r=r.parent,_c(r,!1));const e=r;(function P6e(r){return Ft.skipHydrationRootTNode===r})(e)&&function w6e(){Ft.skipHydrationRootTNode=null}(),function S6e(){Ft.lFrame.elementDepthCount--}();const t=zn();return t.firstCreatePass&&(Uh(t,r),By(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function B6e(r){return 0!=(8&r.flags)}(e)&&vE(t,e,Se(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function G6e(r){return 0!=(16&r.flags)}(e)&&vE(t,e,Se(),e.stylesWithoutHost,!1),P}function V(r,e,t,n){return S(r,e,t,n),P(),V}let xV=(r,e,t,n,i,s)=>(F4(!0),cp(n,i,function tD(){return Ft.lFrame.currentNamespace}()));function Gt(r,e,t){const n=Se(),i=zn(),s=r+gn,o=i.firstCreatePass?function $ue(r,e,t,n,i){const s=e.consts,o=V4(s,n),a=I8(e,r,8,"ng-container",o);return null!==o&&xp(a,o,!0),oE(e,t,a,V4(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,n,e,t):i.data[s];_c(o,!0);const a=RV(i,n,o,r);return n[s]=a,Gh()&&fp(i,n,a,o),xi(a,n),Hh(o)&&(rE(i,n,o),nE(i,o,n)),null!=t&&iE(n,o),Gt}function Ut(){let r=ai();const e=zn();return Yy()?Ky():(r=r.parent,_c(r,!1)),e.firstCreatePass&&(Uh(e,r),By(r)&&e.queries.elementEnd(r)),Ut}let RV=(r,e,t,n)=>(F4(!0),yM(e[Xt],""));function pe(){return Se()}function G7(r){return!!r&&"function"==typeof r.then}function zV(r){return!!r&&"function"==typeof r.subscribe}function W(r,e,t,n){const i=Se(),s=zn(),o=ai();return function HV(r,e,t,n,i,s,o){const a=Hh(n),l=r.firstCreatePass&&sV(r),f=e[Hr],d=iV(e);let m=!0;if(3&n.type||o){const R=Fs(n,e),z=o?o(R):R,$=d.length,G=o?Ce=>o(w1(Ce[n.index])):n.index;let de=null;if(!o&&a&&(de=function Uue(r,e,t,n){const i=r.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===n){const a=e[i8],c=i[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(r,e,i,n.index)),null!==de)(de.__ngLastListenerFn__||de).__ngNextListenerFn__=s,de.__ngLastListenerFn__=s,m=!1;else{s=FV(n,e,f,s,!1);const Ce=t.listen(z,i,s);d.push(s,Ce),l&&l.push(i,G,$,$+1)}}else s=FV(n,e,f,s,!1);const E=n.outputs;let w;if(m&&null!==E&&(w=E[i])){const R=w.length;if(R)for(let z=0;z<R;z+=2){const Le=e[w[z]][w[z+1]].subscribe(s),tt=d.length;d.push(s,Le),l&&l.push(i,n.index,tt,-(tt+1))}}}(s,i,i[Xt],o,r,e,n),W}function VV(r,e,t,n){try{return mc(6,e,t),!1!==t(n)}catch(i){return aV(r,i),!1}finally{mc(7,e,t)}}function FV(r,e,t,n,i){return function s(o){if(o===Function)return n;L7(r.componentOffset>-1?ho(r.index,e):e);let c=VV(e,t,n,o),l=s.__ngNextListenerFn__;for(;l;)c=VV(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&o.preventDefault(),c}}function p(r=1){return function L6e(r){return(Ft.lFrame.contextLView=function R6e(r,e){for(;r>0;)e=e[o8],r--;return e}(r,Ft.lFrame.contextLView))[Hr]}(r)}function Wue(r,e){let t=null;const n=function Vle(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===n?_z(r,s,!0):Ble(n,s))return i}else t=i}return t}function Dn(r,e,t,n,i){const s=Se(),o=x8(s,e,t,n);return o!==en&&_o(zn(),or(),s,r,o,s[Xt],i,!1),Dn}function ve(r,e,t,n,i,s,o){const a=Se(),c=L8(a,e,t,n,i,s);return c!==en&&_o(zn(),or(),a,r,c,a[Xt],o,!1),ve}function zi(r,e,t,n,i,s,o,a,c){const l=Se(),f=R8(l,e,t,n,i,s,o,a);return f!==en&&_o(zn(),or(),l,r,f,l[Xt],c,!1),zi}function $p(r,e){return r<<17|e<<2}function B4(r){return r>>17&32767}function CE(r){return 2|r}function _6(r){return(131068&r)>>2}function yE(r,e){return-131069&r|e<<2}function ME(r){return 1|r}function KV(r,e,t,n,i){const s=r[t+1],o=null===e;let a=n?B4(s):_6(s),c=!1;for(;0!==a&&(!1===c||o);){const f=r[a+1];Xue(r[a],e)&&(c=!0,r[a+1]=n?ME(f):CE(f)),a=n?B4(f):_6(f)}c&&(r[t+1]=n?CE(s):ME(s))}function Xue(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&C8(r,e)>=0}const h2={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function XV(r){return r.substring(h2.key,h2.keyEnd)}function Que(r){return r.substring(h2.value,h2.valueEnd)}function JV(r,e){const t=h2.textEnd;let n=h2.key=$8(r,e,t);return t===n?-1:(n=h2.keyEnd=function n7e(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=tF(r,n,t),n=h2.value=$8(r,n,t),n=h2.valueEnd=function r7e(r,e,t){let n=-1,i=-1,s=-1,o=e,a=o;for(;o<t;){const c=r.charCodeAt(o++);if(59===c)return a;34===c||39===c?a=o=nF(r,c,o,t):e===o-4&&85===s&&82===i&&76===n&&40===c?a=o=nF(r,41,o,t):c>32&&(a=o),s=i,i=n,n=-33&c}return a}(r,n,t),tF(r,n,t))}function $8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function tF(r,e,t,n){return(e=$8(r,e,t))<t&&e++,e}function nF(r,e,t,n){let i=-1,s=t;for(;s<n;){const o=r.charCodeAt(s++);if(o==e&&92!==i)return s;i=92==o&&92===i?0:o}throw new Error}function Bp(r,e){return function Ta(r,e,t,n){const i=Se(),s=zn(),o=b3(2);s.firstUpdatePass&&sF(s,r,o,n),e!==en&&Ri(i,o,e)&&aF(s,s.data[ls()],i,i[Xt],r,i[o+1]=function h7e(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=f2(go(r)))),r}(e,t),n,o)}(r,e,null,!0),Bp}function li(r){!function ba(r,e,t,n){const i=zn(),s=b3(2);i.firstUpdatePass&&sF(i,null,s,n);const o=Se();if(t!==en&&Ri(o,s,t)){const a=i.data[ls()];if(lF(a,n)&&!iF(i,s)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=Oy(c,t||"")),vE(i,a,o,t,n)}else!function d7e(r,e,t,n,i,s,o,a){i===en&&(i=Yn);let c=0,l=0,f=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;null!==f||null!==d;){const m=c<i.length?i[c+1]:void 0,E=l<s.length?s[l+1]:void 0;let R,w=null;f===d?(c+=2,l+=2,m!==E&&(w=d,R=E)):null===d||null!==f&&f<d?(c+=2,w=f):(l+=2,w=d,R=E),null!==w&&aF(r,e,t,n,w,R,o,a),f=c<i.length?i[c]:null,d=l<s.length?s[l]:null}}(i,a,o,o[Xt],o[s+1],o[s+1]=function u7e(r,e,t){if(null==t||""===t)return Yn;const n=[],i=go(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)r(n,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&r(n,s,i[s]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,s)}}(oF,i7e,r,!1)}function i7e(r,e){for(let t=function e7e(r){return function eF(r){h2.key=0,h2.keyEnd=0,h2.value=0,h2.valueEnd=0,h2.textEnd=r.length}(r),JV(r,$8(r,0,h2.textEnd))}(e);t>=0;t=JV(e,t))oF(r,XV(e),Que(e))}function iF(r,e){return e>=r.expandoStartIndex}function sF(r,e,t,n){const i=r.data;if(null===i[t+1]){const s=i[ls()],o=iF(r,t);lF(s,n)&&null===e&&!o&&(e=!1),e=function o7e(r,e,t,n){const i=function Qy(r){const e=Ft.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let s=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=U7(t=EE(null,r,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||r[o]!==i)if(t=EE(i,r,e,t,n),null===s){let c=function a7e(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==_6(n))return r[B4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=EE(null,r,e,c[1],n),c=U7(c,e.attrs,n),function c7e(r,e,t,n){r[B4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else s=function l7e(r,e,t){let n;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)n=U7(n,r[s].hostAttrs,t);return U7(n,e.attrs,t)}(r,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,n),function Yue(r,e,t,n,i,s){let o=s?e.classBindings:e.styleBindings,a=B4(o),c=_6(o);r[n]=t;let f,l=!1;if(Array.isArray(t)?(f=t[1],(null===f||C8(t,f)>0)&&(l=!0)):f=t,i)if(0!==c){const m=B4(r[a+1]);r[n+1]=$p(m,a),0!==m&&(r[m+1]=yE(r[m+1],n)),r[a+1]=function jue(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=$p(a,0),0!==a&&(r[a+1]=yE(r[a+1],n)),a=n;else r[n+1]=$p(c,0),0===a?a=n:r[c+1]=yE(r[c+1],n),c=n;l&&(r[n+1]=CE(r[n+1])),KV(r,f,n,!0),KV(r,f,n,!1),function Kue(r,e,t,n,i){const s=i?r.residualClasses:r.residualStyles;null!=s&&"string"==typeof e&&C8(s,e)>=0&&(t[n+1]=ME(t[n+1]))}(e,f,r,n,s),o=$p(a,c),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,n)}}function EE(r,e,t,n,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=U7(n,s.hostAttrs,i),s!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function U7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),po(r,o,!!t||e[++s]))}return void 0===r?null:r}function oF(r,e,t){po(r,e,go(t))}function aF(r,e,t,n,i,s,o,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],f=function Zue(r){return 1==(1&r)}(l)?cF(c,e,t,i,_6(l),o):void 0;Gp(f)||(Gp(s)||function que(r){return 2==(2&r)}(l)&&(s=cF(c,null,t,i,a,o)),function e8e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:$4.DashCase;null==i?r.removeStyle(t,n,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=$4.Important),r.setStyle(t,n,i,s))}}(n,o,Bh(ls(),t),i,s))}function cF(r,e,t,n,i,s){const o=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),f=l?c[1]:c,d=null===f;let m=t[i+1];m===en&&(m=d?Yn:void 0);let E=d?uM(m,n):f===n?m:void 0;if(l&&!Gp(E)&&(E=uM(c,n)),Gp(E)&&(a=E,o))return a;const w=r[i+1];i=o?B4(w):_6(w)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=uM(c,n))}return a}function Gp(r){return void 0!==r}function lF(r,e){return 0!=(r.flags&(e?8:16))}function ct(r,e=""){const t=Se(),n=zn(),i=r+gn,s=n.firstCreatePass?I8(n,i,1,e,null):n.data[i],o=uF(n,t,s,e,r);t[i]=o,Gh()&&fp(n,t,o,s),_c(s,!1)}let uF=(r,e,t,n,i)=>(F4(!0),ap(e[Xt],n));function mn(r){return x2("",r,""),mn}function x2(r,e,t){const n=Se(),i=x8(n,r,e,t);return i!==en&&I3(n,ls(),i),x2}function SE(r,e,t,n,i){const s=Se(),o=L8(s,r,e,t,n,i);return o!==en&&I3(s,ls(),o),SE}function PE(r,e,t,n,i,s,o){const a=Se(),c=R8(a,r,e,t,n,i,s,o);return c!==en&&I3(a,ls(),c),PE}function OE(r,e,t){const n=Se();return Ri(n,f8(),e)&&_o(zn(),or(),n,r,e,n[Xt],t,!0),OE}const v6=void 0;var R7e=["en",[["a","p"],["AM","PM"],v6],[["AM","PM"],v6,v6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],v6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],v6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",v6,"{1} 'at' {0}",v6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function L7e(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let B8={};function ds(r){const e=function D7e(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=wF(e);if(t)return t;const n=e.split("-")[0];if(t=wF(n),t)return t;if("en"===n)return R7e;throw new ge(701,!1)}function wF(r){return r in B8||(B8[r]=C1.ng&&C1.ng.common&&C1.ng.common.locales&&C1.ng.common.locales[r]),B8[r]}var N1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(N1||{});const H7e=["zero","one","two","few","many"],G8="en-US",Up={marker:"element"},Wp={marker:"ICU"};var Bs=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(Bs||{});let NF=G8;function AF(r){(function Bo(r,e){null==r&&Vt(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(NF=r.toLowerCase().replace(/_/g,"-"))}function IF(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?qD(r,0,t):w1(t[i])}function kF(r,e,t,n,i){const s=e.insertBeforeIndex;if(Array.isArray(s)){let o=n,a=null;if(3&e.type||(a=o,o=i),null!==o&&-1===e.componentOffset)for(let c=1;c<s.length;c++)f6(r,o,t[s[c]],a,!1)}}function xF(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];LF(n)||B7e(n,e)&&null===G7e(n)&&U7e(n,e.index)}}function LF(r){return!(64&r.type)}function B7e(r,e){return LF(e)||r.index>e.index}function G7e(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function U7e(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(ZD(IF,kF),r.insertBeforeIndex=e)}function W7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function j7e(r,e,t){const n=tE(r,t,64,null,null);return xF(e,n),n}function qp(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function RF(r){return r>>>17}function zF(r){return(131070&r)>>>1}let q7=0,j7=0;function HF(r,e,t,n){const i=t[Xt];let o,s=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=ap(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=RF(c);let f,d;if(null===s&&(s=l,o=up(i,n)),l===s?(f=n,d=o):(f=null,d=w1(t[l])),null!==d){const R=zF(c);f6(i,d,t[R],f,!1);const $=W7(r,R);if(null!==$&&"object"==typeof $){const G=qp($,t);null!==G&&HF(r,$.create[G],t,t[$.anchorIdx])}}break;case 1:const E=e[++a],w=e[++a];cE(i,Bh(c>>>1,t),null,null,E,w,null)}else switch(c){case Wp:const l=e[++a],f=e[++a];null===t[f]&&xi(t[f]=yM(i,l),t);break;case Up:const d=e[++a],m=e[++a];null===t[m]&&xi(t[m]=cp(i,d,null),t)}}}function VF(r,e,t,n,i){for(let s=0;s<t.length;s++){const o=t[s],a=t[++s];if(o&i){let c="";for(let l=s+1;l<=s+a;l++){const f=t[l];if("string"==typeof f)c+=f;else if("number"==typeof f)if(f<0)c+=Kt(e[n-f]);else{const d=f>>>2;switch(3&f){case 1:const m=t[++l],E=t[++l],w=r.data[d];"string"==typeof w?cE(e[Xt],e[d],null,w,m,c,E):_o(r,w,e,m,c,e[Xt],E,!1);break;case 0:const R=e[d];null!==R&&FD(e[Xt],R,c);break;case 2:Q7e(r,W7(r,d),e,c);break;case 3:FF(r,W7(r,d),n,e)}}}}else{const c=t[s+1];if(c>0&&3==(3&c)){const f=W7(r,c>>>2);e[f.currentCaseLViewIndex]<0&&FF(r,f,n,e)}}s+=a}}function FF(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let s=q7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,s=-1),VF(r,n,e.update[i],t,s)}}function Q7e(r,e,t,n){const i=function J7e(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function V7e(r,e){const t=function bF(r){return ds(r)[N1.PluralCase]}(e)(parseInt(r,10)),n=H7e[t];return void 0!==n?n:"other"}(e,function $7e(){return NF}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(qp(e,t)!==i&&($F(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const o=t[e.anchorIdx];o&&HF(r,e.create[i],t,o)}}function $F(r,e,t){let n=qp(e,t);if(null!==n){const i=e.remove[n];for(let s=0;s<i.length;s++){const o=i[s];if(o>0){const a=Bh(o,t);null!==a&&dp(t[Xt],a)}else $F(r,W7(r,~o),t)}}}function efe(){const r=[];let t,n,e=-1;function s(a,c){e=0;const l=qp(a,c);n=null!==l?a.remove[l]:Yn}function o(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),s(t[Je].data[~a],t),o())}return 0===r.length?null:(n=r.pop(),e=r.pop(),o())}return function i(a,c){for(t=c;r.length;)r.pop();return s(a.value,c),o}}const jp=/\ufffd(\d+):?\d*\ufffd/gi,nfe=/\ufffd(\d+)\ufffd/,GF=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Z7="\ufffd",rfe=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,ife=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,sfe=/\uE500/g;function UF(r,e,t,n,i,s,o){const a=R7(r,n,1,null);let c=a<<Bs.SHIFT,l=p7();e===l&&(l=null),null===l&&(c|=Bs.APPEND_EAGERLY),o&&(c|=Bs.COMMENT,function V0e(r){void 0===vM&&(vM=r())}(efe)),i.push(c,null===s?"":s);const f=tE(r,a,o?32:1,null===s?"":s,null);xF(t,f);const d=f.index;return _c(f,!1),null!==l&&e!==l&&function q7e(r,e){let t=r.insertBeforeIndex;null===t?(ZD(IF,kF),t=r.insertBeforeIndex=[null,e]):(function o6(r,e,t){r!=e&&Vt(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,d),f}function cfe(r,e,t,n,i,s,o){const a=o.match(jp),c=UF(r,e,t,s,n,a?null:o,!1);a&&Y7(i,o,c.index,null,0,null)}function Y7(r,e,t,n,i,s){const o=r.length,a=o+1;r.push(null,null);const c=o+2,l=e.split(jp);let f=0;for(let d=0;d<l.length;d++){const m=l[d];if(1&d){const E=i+parseInt(m,10);r.push(-1-E),f|=WF(E)}else""!==m&&r.push(m)}return r.push(t<<2|(n?1:0)),n&&r.push(n,s),r[o]=f,r[a]=r.length-c,f}function WF(r){return 1<<Math.min(r,31)}function qF(r){let e,s,t="",n=0,i=!1;for(;null!==(e=rfe.exec(r));)i?e[0]===`${Z7}/*${s}${Z7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),s=e[1],i=!0);return t+=r.slice(n),t}function jF(r,e,t,n,i,s){let o=0;const a={type:i.type,currentCaseLViewIndex:R7(r,e,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};(function mfe(r,e,t){r.push(WF(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,s),function W7e(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,s,a);const c=i.values;for(let l=0;l<c.length;l++){const f=c[l],d=[];for(let m=0;m<f.length;m++){const E=f[m];if("string"!=typeof E){const w=d.push(E)-1;f[m]=`\x3c!--\ufffd${w}\ufffd--\x3e`}}o=pfe(r,a,e,t,n,i.cases[l],f.join(""),d)|o}o&&function _fe(r,e,t){r.push(e,1,t<<2|3)}(t,o,s)}function hfe(r){const e=[],t=[];let n=1,i=0;const s=TE(r=r.replace(GF,function(o,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let o=0;o<s.length;){let a=s[o++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=TE(s[o++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function TE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let s;for(i.lastIndex=0;s=i.exec(r);){const a=s.index;if("}"==s[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);GF.test(c)?n.push(hfe(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const o=r.substring(e);return n.push(o),n}function pfe(r,e,t,n,i,s,o,a){const c=[],l=[],f=[];e.cases.push(s),e.create.push(c),e.remove.push(l),e.update.push(f);const m=rH(P8()).getInertBodyElement(o),E=kM(m)||m;return E?ZF(r,e,t,n,c,l,f,E,i,a,0):0}function ZF(r,e,t,n,i,s,o,a,c,l,f){let d=0,m=a.firstChild;for(;m;){const E=R7(r,t,1,null);switch(m.nodeType){case Node.ELEMENT_NODE:const w=m,R=w.tagName.toLowerCase();if(AM.hasOwnProperty(R)){bE(i,Up,R,c,E),r.data[E]=R;const de=w.attributes;for(let Ce=0;Ce<de.length;Ce++){const Le=de.item(Ce),tt=Le.name.toLowerCase();Le.value.match(jp)?aH.hasOwnProperty(tt)&&Y7(o,Le.value,E,Le.name,0,IM[tt]?gp:null):vfe(i,E,Le)}d=ZF(r,e,t,n,i,s,o,m,E,l,f+1)|d,YF(s,E,f)}break;case Node.TEXT_NODE:const z=m.textContent||"",$=z.match(jp);bE(i,null,$?"":z,c,E),YF(s,E,f),$&&(d=Y7(o,z,E,null,0,null)|d);break;case Node.COMMENT_NODE:const G=nfe.exec(m.textContent||"");if(G){const Ce=l[parseInt(G[1],10)];bE(i,Wp,"",c,E),jF(r,t,n,c,Ce,E),gfe(s,E,f)}}m=m.nextSibling}return d}function YF(r,e,t){0===t&&r.push(e)}function gfe(r,e,t){0===t&&(r.push(~e),r.push(e))}function bE(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function Z7e(r,e,t){return r|e<<17|t<<1}(0,n,i))}function vfe(r,e,t){r.push(e<<1|1,t.name,t.value)}function Gs(r,e,t=-1){const n=zn(),i=Se(),s=gn+r,o=V4(n.consts,e),a=p7();n.firstCreatePass&&function afe(r,e,t,n,i,s){const o=p7(),a=[],c=[],l=[[]];i=function dfe(r,e){if(function ffe(r){return-1===r}(e))return qF(r);{const t=r.indexOf(`:${e}${Z7}`)+2+e.toString().length,n=r.search(new RegExp(`${Z7}\\/\\*\\d+:${e}${Z7}`));return qF(r.substring(t,n))}}(i,s);const f=function ofe(r){return r.replace(sfe," ")}(i).split(ife);for(let d=0;d<f.length;d++){let m=f[d];if(1&d){const E=47===m.charCodeAt(0),R=(m.charCodeAt(E?1:0),gn+Number.parseInt(m.substring(E?2:1)));if(E)l.shift(),_c(p7(),!1);else{const z=j7e(r,l[0],R);l.unshift([]),_c(z,!0)}}else{const E=TE(m);for(let w=0;w<E.length;w++){let R=E[w];if(1&w){const z=R;if("object"!=typeof z)throw new Error(`Unable to parse ICU expression in "${i}" message.`);jF(r,t,c,e,z,UF(r,o,l[0],t,a,"",!0).index)}else""!==R&&cfe(r,o,l[0],a,c,t,R)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,s,o,t),2===n.type?i[Vr][Jt]|=32:i[Jt]|=32;const c=n.data[s],f=BD(n,a===i[ki]?null:a,i);(function X7e(r,e,t,n){const i=r[Xt];for(let s=0;s<e.length;s++){const o=e[s++],a=e[s],l=(o&Bs.APPEND_EAGERLY)===Bs.APPEND_EAGERLY,f=o>>>Bs.SHIFT;let d=r[f];null===d&&(d=r[f]=(o&Bs.COMMENT)===Bs.COMMENT?i.createComment(a):ap(i,a)),l&&null!==t&&f6(i,t,d,n,!1)}})(i,c.create,f,a&&8&a.type?i[a.index]:null),Zz(!0)}function Us(){Zz(!1)}function oe(r,e,t){Gs(r,e,t),Us()}function Gn(r){return function Y7e(r){r&&(q7|=1<<Math.min(j7,31)),j7++}(Ri(Se(),f8(),r)),Gn}function Kn(r){!function K7e(r,e,t){if(j7>0){const n=r.data[t];VF(r,e,Array.isArray(n)?n:n.update,T3()-j7-1,q7)}q7=0,j7=0}(zn(),Se(),r+gn)}function wE(r,e,t,n,i){if(r=Bt(r),Array.isArray(r))for(let s=0;s<r.length;s++)wE(r[s],e,t,n,i);else{const s=zn(),o=Se(),a=ai();let c=h6(r)?r:Bt(r.provide);const l=vH(r),f=1048575&a.providerIndexes,d=a.directiveStart,m=a.providerIndexes>>20;if(h6(r)||!r.multi){const E=new g7(l,i,U),w=AE(c,e,i?f:f+m,d);-1===w?(aM(Zh(a,o),s,c),NE(s,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(E),o.push(E)):(t[w]=E,o[w]=E)}else{const E=AE(c,e,f+m,d),w=AE(c,e,f,f+m),z=w>=0&&t[w];if(i&&!z||!i&&!(E>=0&&t[E])){aM(Zh(a,o),s,c);const $=function xfe(r,e,t,n,i){const s=new g7(r,t,U);return s.multi=[],s.index=e,s.componentProviders=0,XF(s,i,n&&!t),s}(i?kfe:Ife,t.length,i,n,l);!i&&z&&(t[w].providerFactory=$),NE(s,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push($),o.push($)}else NE(s,r,E>-1?E:w,XF(t[i?w:E],l,!i&&n));!i&&n&&z&&t[w].componentProviders++}}}function NE(r,e,t,n){const i=h6(e),s=function x8e(r){return!!r.useClass}(e);if(i||s){const c=(s?Bt(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const f=l.indexOf(t);-1===f?l.push(t,[n,c]):l[f+1].push(n,c)}else l.push(t,c)}}}function XF(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function AE(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function Ife(r,e,t,n){return IE(this.multi,[])}function kfe(r,e,t,n){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=u6(t,t[Je],this.providerFactory.index,n);s=a.slice(0,o),IE(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],IE(i,s);return s}function IE(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function J1(r,e=[]){return t=>{t.providersResolver=(n,i)=>function Afe(r,e,t){const n=zn();if(n.firstCreatePass){const i=Oa(r);wE(t,n.data,n.blueprint,i,!0),wE(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class C6{}class QF{}class kE extends C6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new hV(this);const i=fo(e);this._bootstrapComponents=A3(i.bootstrap),this._r3Injector=xH(e,t,[{provide:C6,useValue:this},{provide:wp,useValue:this.componentFactoryResolver},...n],f2(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class xE extends QF{constructor(e){super(),this.moduleType=e}create(e){return new kE(this.moduleType,e,[])}}class JF extends C6{constructor(e){super(),this.componentFactoryResolver=new hV(this),this.instance=null;const t=new Mp([...e.providers,{provide:C6,useValue:this},{provide:wp,useValue:this.componentFactoryResolver}],e.parent||yp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function LE(r,e,t=null){return new JF({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let zfe=(()=>{var r;class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=pH(0,n.type),s=i.length>0?LE([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(r=e).\u0275prov=De({token:r,providedIn:"environment",factory:()=>new r(Oe(mo))}),e})();function e$(r){r.getStandaloneInjector=e=>e.get(zfe).getOrCreateStandaloneInjector(r)}function D1(r,e,t){const n=cs()+r,i=Se();return i[n]===en?Ec(i,n,t?e.call(t):e()):function V7(r,e){return r[e]}(i,n)}function wa(r,e,t,n){return a$(Se(),cs(),r,e,t,n)}function K7(r,e){const t=r[e];return t===en?void 0:t}function a$(r,e,t,n,i,s){const o=e+t;return Ri(r,o,i)?Ec(r,o+1,s?n.call(s,i):n(i)):K7(r,o+1)}function Na(r,e){const t=zn();let n;const i=r+gn;t.firstCreatePass?(n=function Jfe(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const s=n.factory||(n.factory=c6(n.type)),a=Ds(U);try{const c=jh(!1),l=s();return jh(c),function Due(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,Se(),i,l),l}finally{Ds(a)}}function Pc(r,e,t){const n=r+gn,i=Se(),s=l8(i,n);return X7(i,n)?a$(i,cs(),e,s.transform,t,s):s.transform(t)}function d$(r,e,t,n){const i=r+gn,s=Se(),o=l8(s,i);return X7(s,i)?function c$(r,e,t,n,i,s,o){const a=e+t;return g6(r,a,i,s)?Ec(r,a+2,o?n.call(o,i,s):n(i,s)):K7(r,a+2)}(s,cs(),e,o.transform,t,n,o):o.transform(t,n)}function X7(r,e){return r[Je].data[e].pure}function zE(r){return e=>{setTimeout(r,void 0,e)}}const A1=class r9e extends zs{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=zE(s),i&&(i=zE(i)),o&&(o=zE(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof En&&e.add(a),a}};function i9e(){return this._results[Symbol.iterator]()}class DE{get changes(){return this._changes||(this._changes=new A1)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=DE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=i9e)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=function Uo(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function r0e(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],s=e[n];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function o9e(r,e,t,n=!0){const i=e[Je];if(function q0e(r,e,t,n){const i=oi+n,s=t.length;n>0&&(t[i-1][Pa]=e),n<s-oi?(e[Pa]=t[i],mD(t,oi+n,e)):(t.push(e),e[Pa]=null),e[Q1]=t;const o=e[f7];null!==o&&t!==o&&function j0e(r,e){const t=r[c8];e[Vr]!==e[Q1][Q1][Vr]&&(r[Pz]=!0),null===t?r[c8]=[e]:t.push(e)}(o,e);const a=e[hc];null!==a&&a.insertView(r),e[Jt]|=128}(i,e,r,t),n){const s=OM(t,r),o=e[Xt],a=up(o,r[pc]);null!==a&&function G0e(r,e,t,n,i,s){n[Dr]=i,n[ki]=e,O7(r,n,t,1,i,s)}(i,r[ki],o,e,a,s)}}let k3=(()=>{class e{}return e.__NG_ELEMENT_ID__=l9e,e})();const a9e=k3,c9e=class extends a9e{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function s9e(r,e,t,n){const i=e.tView,a=Ip(r,i,t,4096&r[Jt]?4096:16,null,e,null,null,null,n?.injector??null,n?.hydrationInfo??null);a[f7]=r[e.index];const l=r[hc];return null!==l&&(a[hc]=l.createEmbeddedView(i)),fE(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:n});return new D7(i)}};function l9e(){return Zp(ai(),Se())}function Zp(r,e){return 4&r.type?new c9e(e,r,b8(r,e)):null}let vo=(()=>{class e{}return e.__NG_ELEMENT_ID__=g9e,e})();function g9e(){return C$(ai(),Se())}const m9e=vo,_$=class extends m9e{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return b8(this._hostTNode,this._hostLView)}get injector(){return new us(this._hostTNode,this._hostLView)}get parentInjector(){const e=Yh(this._hostTNode,this._hostLView);if(iM(e)){const t=_7(e,this._hostLView),n=m7(e);return new us(t[Je].data[n+8],t)}return new us(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=v$(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-oi}createEmbeddedView(e,t,n){let i,s;"number"==typeof n?i=n:null!=n&&(i=n.index,s=n.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,n,i,s){const o=e&&!function C7(r){return"function"==typeof r}(e);let a;if(o)a=t;else{const R=t||{};a=R.index,n=R.injector,i=R.projectableNodes,s=R.environmentInjector||R.ngModuleRef}const c=o?e:new H7(Rn(e)),l=n||this.parentInjector;if(!s&&null==c.ngModule){const z=(o?l:this.parentInjector).get(mo,null);z&&(s=z)}Rn(c.componentType??{});const E=c.create(l,i,null,s);return this.insertImpl(E.hostView,a,false),E}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,n){const i=e._lView;if(function v6e(r){return Vs(r[Q1])}(i)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=i[Q1],f=new _$(l,l[ki],l[Q1]);f.detach(f.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return o9e(a,i,o,!n),e.attachToViewContainerRef(),mD(HE(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=v$(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=lp(this._lContainer,t);n&&(Qh(HE(this._lContainer),t),MM(n[Je],n))}detach(e){const t=this._adjustIndex(e,-1),n=lp(this._lContainer,t);return n&&null!=Qh(HE(this._lContainer),t)?new D7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function v$(r){return r[8]}function HE(r){return r[8]||(r[8]=[])}function C$(r,e){let t;const n=e[r.index];return Vs(n)?t=n:(t=nV(n,e,null,r),e[r.index]=t,kp(e,t)),y$(t,e,r,n),new _$(t,r,e)}let y$=function M$(r,e,t,n){if(r[pc])return;let i;i=8&t.type?w1(n):function _9e(r,e){const t=r[Xt],n=t.createComment(""),i=Fs(e,r);return f6(t,up(t,i),n,function X0e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[pc]=i};class VE{constructor(e){this.queryList=e,this.matches=null}clone(){return new VE(this.queryList)}setDirty(){this.queryList.setDirty()}}class FE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new FE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==b$(e,t).matches&&this.queries[t].setDirty()}}class E${constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class $E{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,i);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new $E(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class BE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new BE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const s=n[i];this.matchTNodeWithReadOption(e,t,y9e(t,s)),this.matchTNodeWithReadOption(e,t,Kh(t,e,s,!1,!1))}else n===k3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Kh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Li||i===vo||i===k3&&4&t.type)this.addMatch(t.index,-2);else{const s=Kh(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function y9e(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function E9e(r,e,t,n){return-1===t?function M9e(r,e){return 11&r.type?b8(r,e):4&r.type?Zp(r,e):null}(e,r):-2===t?function S9e(r,e,t){return t===Li?b8(e,r):t===k3?Zp(e,r):t===vo?C$(e,r):void 0}(r,e,n):u6(r,r[Je],t,e)}function S$(r,e,t,n){const i=e[hc].queries[n];if(null===i.matches){const s=r.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:E9e(e,s[l],o[c+1],t.metadata.read))}i.matches=a}return i.matches}function GE(r,e,t,n){const i=r.queries.getByIndex(t),s=i.matches;if(null!==s){const o=S$(r,e,i,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)n.push(o[a/2]);else{const l=s[a+1],f=e[-c];for(let d=oi;d<f.length;d++){const m=f[d];m[f7]===m[Q1]&&GE(m[Je],m,l,n)}if(null!==f[c8]){const d=f[c8];for(let m=0;m<d.length;m++){const E=d[m];GE(E[Je],E,l,n)}}}}}return n}function x3(r){const e=Se(),t=zn(),n=Yz();Jy(n+1);const i=b$(t,n);if(r.dirty&&function m6e(r){return 4==(4&r[Jt])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const s=i.crossesNgTemplate?GE(t,e,n,[]):S$(t,e,i,n);r.reset(s,e5e),r.notifyOnChanges()}return!0}return!1}function G4(r,e,t){const n=zn();n.firstCreatePass&&(function T$(r,e,t){null===r.queries&&(r.queries=new $E),r.queries.track(new BE(e,t))}(n,new E$(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function O$(r,e,t){const n=new DE(4==(4&t));(function P5e(r,e,t,n){const i=iV(e);i.push(t),r.firstCreatePass&&sV(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[hc]&&(e[hc]=new FE),e[hc].queries.push(new VE(n))}(n,Se(),e)}function L3(){return function P9e(r,e){return r[hc].queries[e].queryList}(Se(),Yz())}function b$(r,e){return r.queries.getByIndex(e)}function dn(r,e){return Zp(r,e)}const YE=new et("Application Initializer");let KE=(()=>{var r;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=nt(YE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const s of this.appInits){const o=s();if(G7(o))n.push(o);else if(zV(o)){const a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});n.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(s=>{this.reject(s)}),0===n.length&&i(),this.initialized=!0}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),U$=(()=>{var r;class e{log(n){console.log(n)}warn(n){console.warn(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();const Oc=new et("LocaleId",{providedIn:"root",factory:()=>nt(Oc,ln.Optional|ln.SkipSelf)||function q9e(){return typeof $localize<"u"&&$localize.locale||G8}()});let Xp=(()=>{var r;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ss(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class Y9e{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let W$=(()=>{var r;class e{compileModuleSync(n){return new xE(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),o=A3(fo(n).declarations).reduce((a,c)=>{const l=Rn(c);return l&&a.push(new H7(l)),a},[]);return new Y9e(i,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function Y$(...r){}class u1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new A1(!1),this.onMicrotaskEmpty=new A1(!1),this.onStable=new A1(!1),this.onError=new A1(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function gde(){const r="function"==typeof C1.requestAnimationFrame;let e=C1[r?"requestAnimationFrame":"setTimeout"],t=C1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function vde(r){const e=()=>{!function _de(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(C1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,eS(r),r.isCheckStableRunning=!0,JE(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),eS(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,s,o,a)=>{try{return K$(r),t.invokeTask(i,s,o,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||r.shouldCoalesceRunChangeDetection)&&e(),X$(r)}},onInvoke:(t,n,i,s,o,a,c)=>{try{return K$(r),t.invoke(i,s,o,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),X$(r)}},onHasTask:(t,n,i,s)=>{t.hasTask(i,s),n===i&&("microTask"==s.change?(r._hasPendingMicrotasks=s.microTask,eS(r),JE(r)):"macroTask"==s.change&&(r.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,i,s)=>(t.handleError(i,s),r.runOutsideAngular(()=>r.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!u1.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(u1.isInAngularZone())throw new ge(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,mde,Y$,Y$);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const mde={};function JE(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function eS(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function K$(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function X$(r){r._nesting--,JE(r)}class Cde{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new A1,this.onMicrotaskEmpty=new A1,this.onStable=new A1,this.onError=new A1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}const Q$=new et("",{providedIn:"root",factory:J$});function J$(){const r=nt(u1);let e=!0;return function ple(...r){const e=i7(r),t=function ale(r,e){return"number"==typeof Sy(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?lo(n[0]):t8(t)(u2(n,e)):fc}(new T1(i=>{e=r.isStable&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks,r.runOutsideAngular(()=>{i.next(e),i.complete()})}),new T1(i=>{let s;r.runOutsideAngular(()=>{s=r.onStable.subscribe(()=>{u1.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=r.onUnstable.subscribe(()=>{u1.assertInAngularZone(),e&&(e=!1,r.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(ez()))}const eB=new et(""),Jp=new et("");let rS,tS=(()=>{var r;class e{constructor(n,i,s){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,rS||(function yde(r){rS=r}(s),s.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{u1.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:s})}whenStable(n,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,s){return[]}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(u1),Oe(nS),Oe(Jp))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),nS=(()=>{var r;class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return rS?.findTestabilityInTree(this,n,i)??null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})(),U4=null;const tB=new et("AllowMultipleToken"),iS=new et("PlatformDestroyListeners"),sS=new et("appBootstrapListener");class rB{constructor(e,t){this.name=e,this.token=t}}function sB(r,e,t=[]){const n=`Platform: ${e}`,i=new et(n);return(s=[])=>{let o=oS();if(!o||o.injector.get(tB,!1)){const a=[...t,...s,{provide:i,useValue:!0}];r?r(a):function Sde(r){if(U4&&!U4.get(tB,!1))throw new ge(400,!1);(function nB(){!function o6e(r){Az=r}(()=>{throw new ge(600,!1)})})(),U4=r;const e=r.get(aB);(function iB(r){r.get(CH,null)?.forEach(t=>t())})(r)}(function oB(r=[],e){return ci.create({name:e,providers:[{provide:DM,useValue:"platform"},{provide:iS,useValue:new Set([()=>U4=null])},...r]})}(a,n))}return function Ode(r){const e=oS();if(!e)throw new ge(401,!1);return e}()}}function oS(){return U4?.get(aB)??null}let aB=(()=>{var r;class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const s=function Tde(r="zone.js",e){return"noop"===r?new Cde:"zone.js"===r?new u1(e):r}(i?.ngZone,function cB(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{const o=function Rfe(r,e,t){return new kE(r,e,t)}(n.moduleType,this.injector,function hB(r){return[{provide:u1,useFactory:r},{provide:N7,multi:!0,useFactory:()=>{const e=nt(wde,{optional:!0});return()=>e.initialize()}},{provide:dB,useFactory:bde},{provide:Q$,useFactory:J$}]}(()=>s)),a=o.injector.get(p6,null);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{eg(this._modules,o),c.unsubscribe()})}),function lB(r,e,t){try{const n=t();return G7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(a,s,()=>{const c=o.injector.get(KE);return c.runInitializers(),c.donePromise.then(()=>(AF(o.injector.get(Oc,G8)||G8),this._moduleDoBootstrap(o),o))})})}bootstrapModule(n,i=[]){const s=uB({},i);return function Mde(r,e,t){const n=new xE(t);return Promise.resolve(n)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(n){const i=n.injector.get(y6);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!n.instance.ngDoBootstrap)throw new ge(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(iS,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(ci))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();function uB(r,e){return Array.isArray(e)?e.reduce(uB,r):{...r,...e}}let y6=(()=>{var r;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=nt(dB),this.zoneIsStable=nt(Q$),this.componentTypes=[],this.components=[],this.isStable=nt(Xp).hasPendingTasks.pipe(Ea(n=>n?Ht(!1):this.zoneIsStable),function gle(r,e=uc){return r=r??mle,Jr((t,n)=>{let i,s=!0;t.subscribe(Mr(n,o=>{const a=e(o);(s||!r(i,a))&&(s=!1,i=a,n.next(o))}))})}(),ez()),this._injector=nt(mo)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const s=n instanceof TH;if(!this._injector.get(KE).done)throw!s&&function r8(r){const e=Rn(r)||si(r)||os(r);return null!==e&&e.standalone}(n),new ge(405,!1);let a;a=s?n:this._injector.get(wp).resolveComponentFactory(n),this.componentTypes.push(a.componentType);const c=function Ede(r){return r.isBoundToModule}(a)?void 0:this._injector.get(C6),f=a.create(ci.NULL,[],i||a.selector,c),d=f.location.nativeElement,m=f.injector.get(eB,null);return m?.registerApplication(d),f.onDestroy(()=>{this.detachView(f.hostView),eg(this.components,f),m?.unregisterApplication(d)}),this._loadComponent(f),f}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;eg(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(sS,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>eg(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new ge(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function eg(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const dB=new et("",{providedIn:"root",factory:()=>nt(p6).handleError.bind(void 0)});function bde(){const r=nt(u1),e=nt(p6);return t=>r.runOutsideAngular(()=>e.handleError(t))}let wde=(()=>{var r;class e{constructor(){this.zone=nt(u1),this.applicationRef=nt(y6)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();let R3=(()=>{class e{}return e.__NG_ELEMENT_ID__=Ade,e})();function Ade(r){return function Ide(r,e,t){if(a6(r)&&!t){const n=ho(r.index,e);return new D7(n,n)}return 47&r.type?new D7(e[Vr],e):null}(ai(),Se(),16==(16&r))}class _B{constructor(){}supports(e){return zp(e)}create(e){return new Dde(e)}}const zde=(r,e)=>e;class Dde{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||zde}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<CB(n,i,s)?t:n,a=CB(o,i,s),c=o.currentIndex;if(o===n)i--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const l=a-i,f=c-i;if(l!=f){for(let m=0;m<l;m++){const E=m<s.length?s[m]:s[m]=0,w=E+m;f<=w&&w<l&&(s[m]=E+1)}s[o.previousIndex]=f-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!zp(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else i=0,function mue(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new Hde(t,n),s,i),e}_verifyReinsertion(e,t,n,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new vB),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new vB),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Hde{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Vde{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class vB{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new Vde,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function CB(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}class yB{constructor(){}supports(e){return e instanceof Map||dE(e)}create(){return new Fde}}class Fde{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||dE(e)))throw new ge(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const n=new $de(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class $de{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function MB(){return new rg([new _B])}let rg=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||MB()),deps:[[e,new ep,new fs]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(null!=i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:MB}),e})();function EB(){return new ef([new yB])}let ef=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||EB()),deps:[[e,new ep,new fs]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:EB}),e})();const Ude=sB(null,"core",[]);let Wde=(()=>{var r;class e{constructor(n){}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(y6))},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({}),e})();function q8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let dS=null;function W4(){return dS}class she{}const L2=new et("DocumentToken");let hS=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(ahe)},providedIn:"platform"}),e})();const ohe=new et("Location Initialized");let ahe=(()=>{var r;class e extends hS{constructor(){super(),this._doc=nt(L2),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return W4().getBaseHref(this._doc)}onPopState(n){const i=W4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=W4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,s){this._history.pushState(n,i,s)}replaceState(n,i,s){this._history.replaceState(n,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new r},providedIn:"platform"}),e})();function pS(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function AB(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function z3(r){return r&&"?"!==r[0]?"?"+r:r}let E6=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(kB)},providedIn:"root"}),e})();const IB=new et("appBaseHref");let kB=(()=>{var r;class e extends E6{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??nt(L2).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return pS(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+z3(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${i}${s}`:i}pushState(n,i,s,o){const a=this.prepareExternalUrl(s+z3(o));this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){const a=this.prepareExternalUrl(s+z3(o));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(hS),Oe(IB,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),che=(()=>{var r;class e extends E6{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=pS(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,s,o){let a=this.prepareExternalUrl(s+z3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){let a=this.prepareExternalUrl(s+z3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(hS),Oe(IB,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),gS=(()=>{var r;class e{constructor(n){this._subject=new A1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function fhe(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(AB(xB(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+z3(i))}normalize(n){return e.stripTrailingSlash(function uhe(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,xB(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",s=null){this._locationStrategy.pushState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+z3(i)),s)}replaceState(n,i="",s=null){this._locationStrategy.replaceState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+z3(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(s=>s(n,i))}subscribe(n,i,s){return this._subject.subscribe({next:n,error:i,complete:s})}}return(r=e).normalizeQueryParams=z3,r.joinWithSlash=pS,r.stripTrailingSlash=AB,r.\u0275fac=function(n){return new(n||r)(Oe(E6))},r.\u0275prov=De({token:r,factory:function(){return function lhe(){return new gS(Oe(E6))}()},providedIn:"root"}),e})();function xB(r){return r.replace(/\/index.html$/,"")}var sg=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(sg||{}),ps=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(ps||{}),y1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(y1||{}),Co=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(Co||{}),Fr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Fr||{});function og(r,e){return Zo(ds(r)[N1.DateFormat],e)}function ag(r,e){return Zo(ds(r)[N1.TimeFormat],e)}function cg(r,e){return Zo(ds(r)[N1.DateTimeFormat],e)}function jo(r,e){const t=ds(r),n=t[N1.NumberSymbols][e];if(typeof n>"u"){if(e===Fr.CurrencyDecimal)return t[N1.NumberSymbols][Fr.Decimal];if(e===Fr.CurrencyGroup)return t[N1.NumberSymbols][Fr.Group]}return n}function RB(r){if(!r[N1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[N1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Zo(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function _S(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const Ohe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,tf={},The=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var D3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(D3||{}),Xn=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(Xn||{}),Qn=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(Qn||{});function zB(r,e,t,n){let i=function Rhe(r){if(VB(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,s=1,o=1]=r.split("-").map(a=>+a);return lg(i,s-1,o)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(Ohe))return function zhe(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,s=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const o=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return s.call(e,o,a,c,l),e}(n)}const e=new Date(r);if(!VB(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=H3(t,e)||e;let a,o=[];for(;e;){if(a=The.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const f=o.pop();if(!f)break;e=f}}let c=i.getTimezoneOffset();n&&(c=HB(n,c),i=function Lhe(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function xhe(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(HB(e,i)-i))}(i,n,!0));let l="";return o.forEach(f=>{const d=function khe(r){if(CS[r])return CS[r];let e;switch(r){case"G":case"GG":case"GGG":e=I1(Qn.Eras,y1.Abbreviated);break;case"GGGG":e=I1(Qn.Eras,y1.Wide);break;case"GGGGG":e=I1(Qn.Eras,y1.Narrow);break;case"y":e=t2(Xn.FullYear,1,0,!1,!0);break;case"yy":e=t2(Xn.FullYear,2,0,!0,!0);break;case"yyy":e=t2(Xn.FullYear,3,0,!1,!0);break;case"yyyy":e=t2(Xn.FullYear,4,0,!1,!0);break;case"Y":e=hg(1);break;case"YY":e=hg(2,!0);break;case"YYY":e=hg(3);break;case"YYYY":e=hg(4);break;case"M":case"L":e=t2(Xn.Month,1,1);break;case"MM":case"LL":e=t2(Xn.Month,2,1);break;case"MMM":e=I1(Qn.Months,y1.Abbreviated);break;case"MMMM":e=I1(Qn.Months,y1.Wide);break;case"MMMMM":e=I1(Qn.Months,y1.Narrow);break;case"LLL":e=I1(Qn.Months,y1.Abbreviated,ps.Standalone);break;case"LLLL":e=I1(Qn.Months,y1.Wide,ps.Standalone);break;case"LLLLL":e=I1(Qn.Months,y1.Narrow,ps.Standalone);break;case"w":e=vS(1);break;case"ww":e=vS(2);break;case"W":e=vS(1,!0);break;case"d":e=t2(Xn.Date,1);break;case"dd":e=t2(Xn.Date,2);break;case"c":case"cc":e=t2(Xn.Day,1);break;case"ccc":e=I1(Qn.Days,y1.Abbreviated,ps.Standalone);break;case"cccc":e=I1(Qn.Days,y1.Wide,ps.Standalone);break;case"ccccc":e=I1(Qn.Days,y1.Narrow,ps.Standalone);break;case"cccccc":e=I1(Qn.Days,y1.Short,ps.Standalone);break;case"E":case"EE":case"EEE":e=I1(Qn.Days,y1.Abbreviated);break;case"EEEE":e=I1(Qn.Days,y1.Wide);break;case"EEEEE":e=I1(Qn.Days,y1.Narrow);break;case"EEEEEE":e=I1(Qn.Days,y1.Short);break;case"a":case"aa":case"aaa":e=I1(Qn.DayPeriods,y1.Abbreviated);break;case"aaaa":e=I1(Qn.DayPeriods,y1.Wide);break;case"aaaaa":e=I1(Qn.DayPeriods,y1.Narrow);break;case"b":case"bb":case"bbb":e=I1(Qn.DayPeriods,y1.Abbreviated,ps.Standalone,!0);break;case"bbbb":e=I1(Qn.DayPeriods,y1.Wide,ps.Standalone,!0);break;case"bbbbb":e=I1(Qn.DayPeriods,y1.Narrow,ps.Standalone,!0);break;case"B":case"BB":case"BBB":e=I1(Qn.DayPeriods,y1.Abbreviated,ps.Format,!0);break;case"BBBB":e=I1(Qn.DayPeriods,y1.Wide,ps.Format,!0);break;case"BBBBB":e=I1(Qn.DayPeriods,y1.Narrow,ps.Format,!0);break;case"h":e=t2(Xn.Hours,1,-12);break;case"hh":e=t2(Xn.Hours,2,-12);break;case"H":e=t2(Xn.Hours,1);break;case"HH":e=t2(Xn.Hours,2);break;case"m":e=t2(Xn.Minutes,1);break;case"mm":e=t2(Xn.Minutes,2);break;case"s":e=t2(Xn.Seconds,1);break;case"ss":e=t2(Xn.Seconds,2);break;case"S":e=t2(Xn.FractionalSeconds,1);break;case"SS":e=t2(Xn.FractionalSeconds,2);break;case"SSS":e=t2(Xn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=fg(D3.Short);break;case"ZZZZZ":e=fg(D3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=fg(D3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=fg(D3.Long);break;default:return null}return CS[r]=e,e}(f);l+=d?d(i,t,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function lg(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function H3(r,e){const t=function hhe(r){return ds(r)[N1.LocaleId]}(r);if(tf[t]=tf[t]||{},tf[t][e])return tf[t][e];let n="";switch(e){case"shortDate":n=og(r,Co.Short);break;case"mediumDate":n=og(r,Co.Medium);break;case"longDate":n=og(r,Co.Long);break;case"fullDate":n=og(r,Co.Full);break;case"shortTime":n=ag(r,Co.Short);break;case"mediumTime":n=ag(r,Co.Medium);break;case"longTime":n=ag(r,Co.Long);break;case"fullTime":n=ag(r,Co.Full);break;case"short":const i=H3(r,"shortTime"),s=H3(r,"shortDate");n=ug(cg(r,Co.Short),[i,s]);break;case"medium":const o=H3(r,"mediumTime"),a=H3(r,"mediumDate");n=ug(cg(r,Co.Medium),[o,a]);break;case"long":const c=H3(r,"longTime"),l=H3(r,"longDate");n=ug(cg(r,Co.Long),[c,l]);break;case"full":const f=H3(r,"fullTime"),d=H3(r,"fullDate");n=ug(cg(r,Co.Full),[f,d])}return n&&(tf[t][e]=n),n}function ug(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function Aa(r,e,t="-",n,i){let s="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,s=t));let o=String(r);for(;o.length<e;)o="0"+o;return n&&(o=o.slice(o.length-e)),s+o}function t2(r,e,t=0,n=!1,i=!1){return function(s,o){let a=function whe(r,e){switch(r){case Xn.FullYear:return e.getFullYear();case Xn.Month:return e.getMonth();case Xn.Date:return e.getDate();case Xn.Hours:return e.getHours();case Xn.Minutes:return e.getMinutes();case Xn.Seconds:return e.getSeconds();case Xn.FractionalSeconds:return e.getMilliseconds();case Xn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,s);if((t>0||a>-t)&&(a+=t),r===Xn.Hours)0===a&&-12===t&&(a=12);else if(r===Xn.FractionalSeconds)return function bhe(r,e){return Aa(r,3).substring(0,e)}(a,e);const c=jo(o,Fr.MinusSign);return Aa(a,e,c,n,i)}}function I1(r,e,t=ps.Format,n=!1){return function(i,s){return function Nhe(r,e,t,n,i,s){switch(t){case Qn.Months:return function mhe(r,e,t){const n=ds(r),s=Zo([n[N1.MonthsFormat],n[N1.MonthsStandalone]],e);return Zo(s,t)}(e,i,n)[r.getMonth()];case Qn.Days:return function ghe(r,e,t){const n=ds(r),s=Zo([n[N1.DaysFormat],n[N1.DaysStandalone]],e);return Zo(s,t)}(e,i,n)[r.getDay()];case Qn.DayPeriods:const o=r.getHours(),a=r.getMinutes();if(s){const l=function yhe(r){const e=ds(r);return RB(e),(e[N1.ExtraData][2]||[]).map(n=>"string"==typeof n?_S(n):[_S(n[0]),_S(n[1])])}(e),f=function Mhe(r,e,t){const n=ds(r);RB(n);const s=Zo([n[N1.ExtraData][0],n[N1.ExtraData][1]],e)||[];return Zo(s,t)||[]}(e,i,n),d=l.findIndex(m=>{if(Array.isArray(m)){const[E,w]=m,R=o>=E.hours&&a>=E.minutes,z=o<w.hours||o===w.hours&&a<w.minutes;if(E.hours<w.hours){if(R&&z)return!0}else if(R||z)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(-1!==d)return f[d]}return function phe(r,e,t){const n=ds(r),s=Zo([n[N1.DayPeriodsFormat],n[N1.DayPeriodsStandalone]],e);return Zo(s,t)}(e,i,n)[o<12?0:1];case Qn.Eras:return function _he(r,e){return Zo(ds(r)[N1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,s,r,e,t,n)}}function fg(r){return function(e,t,n){const i=-1*n,s=jo(t,Fr.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case D3.Short:return(i>=0?"+":"")+Aa(o,2,s)+Aa(Math.abs(i%60),2,s);case D3.ShortGMT:return"GMT"+(i>=0?"+":"")+Aa(o,1,s);case D3.Long:return"GMT"+(i>=0?"+":"")+Aa(o,2,s)+":"+Aa(Math.abs(i%60),2,s);case D3.Extended:return 0===n?"Z":(i>=0?"+":"")+Aa(o,2,s)+":"+Aa(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${r}"`)}}}const Ahe=0,dg=4;function DB(r){return lg(r.getFullYear(),r.getMonth(),r.getDate()+(dg-r.getDay()))}function vS(r,e=!1){return function(t,n){let i;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{const s=DB(t),o=function Ihe(r){const e=lg(r,Ahe,1).getDay();return lg(r,0,1+(e<=dg?dg:dg+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Aa(i,r,jo(n,Fr.MinusSign))}}function hg(r,e=!1){return function(t,n){return Aa(DB(t).getFullYear(),r,jo(n,Fr.MinusSign),e)}}const CS={};function HB(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function VB(r){return r instanceof Date&&!isNaN(r.valueOf())}const Dhe=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function SS(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function GB(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}const OS=/\s+/,UB=[];let Dt=(()=>{var r;class e{constructor(n,i,s,o){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=s,this._renderer=o,this.initialClasses=UB,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(OS):UB}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(OS):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const s=this.stateMap.get(n);void 0!==s?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],s=n[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(OS).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return(r=e).\u0275fac=function(n){return new(n||r)(U(rg),U(ef),U(Li),U(yc))},r.\u0275dir=Rt({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class Khe{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Wt=(()=>{var r;class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,s){this._viewContainer=n,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((s,o,a)=>{if(null==s.previousIndex)i.createEmbeddedView(this._template,new Khe(s.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===o?void 0:o);else if(null!==o){const c=i.get(o);i.move(c,a),qB(c,s)}});for(let s=0,o=i.length;s<o;s++){const c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{qB(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(U(vo),U(k3),U(rg))},r.\u0275dir=Rt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function qB(r,e){r.context.$implicit=e.item}let wt=(()=>{var r;class e{constructor(n,i){this._viewContainer=n,this._context=new Xhe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){jB("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){jB("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(U(vo),U(k3))},r.\u0275dir=Rt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class Xhe{constructor(){this.$implicit=null,this.ngIf=null}}function jB(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${f2(e)}'.`)}let KB=(()=>{var r;class e{constructor(n){this._locale=n}transform(n,i,s){if(!function wS(r){return!(null==r||""===r||r!=r)}(n))return null;s=s||this._locale;try{return function Ghe(r,e,t){return function MS(r,e,t,n,i,s,o=!1){let a="",c=!1;if(isFinite(r)){let l=function Whe(r){let n,i,s,o,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;"0"===e.charAt(s);s++);if(s===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=s,n=[],o=0;s<=a;s++,o++)n[o]=Number(e.charAt(s))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);o&&(l=function Uhe(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let f=e.minInt,d=e.minFrac,m=e.maxFrac;if(s){const G=s.match(Dhe);if(null===G)throw new Error(`${s} is not a valid digit info`);const de=G[1],Ce=G[3],Le=G[5];null!=de&&(f=SS(de)),null!=Ce&&(d=SS(Ce)),null!=Le?m=SS(Le):null!=Ce&&d>m&&(m=d)}!function qhe(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const s=Math.min(Math.max(e,i),t);let o=s+r.integerLen,a=n[o];if(o>0){n.splice(Math.max(r.integerLen,o));for(let d=o;d<n.length;d++)n[d]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,o=s+1),n[0]=0;for(let d=1;d<o;d++)n[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[o-1]++;for(;i<Math.max(0,s);i++)n.push(0);let c=0!==s;const l=e+r.integerLen,f=n.reduceRight(function(d,m,E,w){return w[E]=(m+=d)<10?m:m-10,c&&(0===w[E]&&E>=l?w.pop():c=!1),m>=10?1:0},0);f&&(n.unshift(f),r.integerLen++)}(l,d,m);let E=l.digits,w=l.integerLen;const R=l.exponent;let z=[];for(c=E.every(G=>!G);w<f;w++)E.unshift(0);for(;w<0;w++)E.unshift(0);w>0?z=E.splice(w,E.length):(z=E,E=[0]);const $=[];for(E.length>=e.lgSize&&$.unshift(E.splice(-e.lgSize,E.length).join(""));E.length>e.gSize;)$.unshift(E.splice(-e.gSize,E.length).join(""));E.length&&$.unshift(E.join("")),a=$.join(jo(t,n)),z.length&&(a+=jo(t,i)+z.join("")),R&&(a+=jo(t,Fr.Exponential)+"+"+R)}else a=jo(t,Fr.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function ES(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],s=n[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=o[0],c=o[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let f=0;f<c.length;f++){const d=c.charAt(f);"0"===d?t.minFrac=t.maxFrac=f+1:"#"===d?t.maxFrac=f+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,s){const f=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf("#");t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function mS(r,e){return ds(r)[N1.NumberFormats][e]}(e,sg.Decimal),jo(e,Fr.MinusSign)),e,Fr.Group,Fr.Decimal,t)}(function NS(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(n),s,i)}catch(o){throw function Ia(r,e){return new ge(2100,!1)}()}}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Oc,16))},r.\u0275pipe=Ii({name:"number",type:r,pure:!0,standalone:!0}),e})();let Mpe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({}),e})();function QB(r){return"server"===r}let Ope=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new Tpe(Oe(L2),window)}),e})();class Tpe{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function bpe(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class JB{}class Kpe extends she{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class kS extends Kpe{static makeCurrent(){!function ihe(r){dS||(dS=r)}(new kS)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Xpe(){return sf=sf||document.querySelector("base"),sf?sf.getAttribute("href"):null}();return null==t?null:function Qpe(r){_g=_g||document.createElement("a"),_g.setAttribute("href",r);const e=_g.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){sf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return GB(document.cookie,e)}}let _g,sf=null,ege=(()=>{var r;class e{build(){return new XMLHttpRequest}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const xS=new et("EventManagerPlugins");let iG=(()=>{var r;class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new ge(5101,!1);return this._eventNameToPlugin.set(n,i),i}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(xS),Oe(u1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class sG{constructor(e){this._doc=e}}const LS="ng-app-id";let oG=(()=>{var r;class e{constructor(n,i,s,o={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=QB(o),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${LS}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(s=>{null!=s.textContent&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){const s=this.styleRef;if(s.has(n)){const o=s.get(n);return o.usage+=i,o.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===n)return s.delete(i),o.removeAttribute(LS),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(LS,this.appId),a}}addStyleToHost(n,i){const s=this.getStyleElement(n,i);n.appendChild(s);const o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2),Oe(Ep),Oe(MH,8),Oe(N3))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const RS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},zS=/%COMP%/g,ige=new et("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function cG(r,e){return e.map(t=>t.replace(zS,r))}let DS=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=QB(c),this.defaultRenderer=new HS(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Go.ShadowDom&&(i={...i,encapsulation:Go.Emulated});const s=this.getOrCreateRenderer(n,i);return s instanceof uG?s.applyToHost(n):s instanceof VS&&s.applyStyles(),s}getOrCreateRenderer(n,i){const s=this.rendererByCompId;let o=s.get(i.id);if(!o){const a=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case Go.Emulated:o=new uG(l,f,i,this.appId,d,a,c,m);break;case Go.ShadowDom:return new cge(l,f,n,i,a,c,this.nonce,m);default:o=new VS(l,f,i,d,a,c,m)}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(iG),Oe(oG),Oe(Ep),Oe(ige),Oe(L2),Oe(N3),Oe(u1),Oe(MH))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class HS{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(RS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(lG(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(lG(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new ge(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const s=RS[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=RS[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&($4.DashCase|$4.Important)?e.style.setProperty(t,n,i&$4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&$4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=W4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function lG(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class cge extends HS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=cG(i.id,i.styles);for(const f of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=f,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class VS extends HS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?cG(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class uG extends VS{constructor(e,t,n,i,s,o,a,c){const l=i+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=function sge(r){return"_ngcontent-%COMP%".replace(zS,r)}(l),this.hostAttr=function oge(r){return"_nghost-%COMP%".replace(zS,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let lge=(()=>{var r;class e extends sG{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const fG=["alt","control","meta","shift"],uge={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},fge={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let dge=(()=>{var r;class e extends sG{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,s){const o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>W4().onAndCancel(n,o.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(i.pop());let a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),fG.forEach(f=>{const d=i.indexOf(f);d>-1&&(i.splice(d,1),a+=f+".")}),a+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let s=uge[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(s=n.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),fG.forEach(a=>{a!==s&&(0,fge[a])(n)&&(o+=a+".")}),o+=s,o===i)}static eventCallback(n,i,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>i(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const hG=[{provide:N3,useValue:"browser"},{provide:CH,useValue:function hge(){kS.makeCurrent()},multi:!0},{provide:L2,useFactory:function gge(){return function s8e(r){wM=r}(document),document},deps:[]}],mge=sB(Ude,"browser",hG),_ge=new et(""),pG=[{provide:Jp,useClass:class Jpe{addToWindow(e){C1.getAngularTestability=(n,i=!0)=>{const s=e.findTestabilityInTree(n,i);if(null==s)throw new ge(5103,!1);return s},C1.getAllAngularTestabilities=()=>e.getAllTestabilities(),C1.getAllAngularRootElements=()=>e.getAllRootElements(),C1.frameworkStabilizers||(C1.frameworkStabilizers=[]),C1.frameworkStabilizers.push(n=>{const i=C1.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(c){o=o||c,s--,0==s&&n(o)};i.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?W4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:eB,useClass:tS,deps:[u1,nS,Jp]},{provide:tS,useClass:tS,deps:[u1,nS,Jp]}],gG=[{provide:DM,useValue:"root"},{provide:p6,useFactory:function pge(){return new p6},deps:[]},{provide:xS,useClass:lge,multi:!0,deps:[L2,u1,N3]},{provide:xS,useClass:dge,multi:!0,deps:[L2]},DS,oG,iG,{provide:x7,useExisting:DS},{provide:JB,useClass:ege,deps:[]},[]];let mG=(()=>{var r;class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:Ep,useValue:n.appId}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(_ge,12))},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({providers:[...gG,...pG],imports:[Mpe,Wde]}),e})(),_G=(()=>{var r;class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function Cge(){return new _G(Oe(L2))}(),i},providedIn:"root"}),e})();typeof window<"u"&&window;let yG=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new(n||r):Oe(MG),i},providedIn:"root"}),e})(),MG=(()=>{var r;class e extends yG{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case Wo.NONE:return i;case Wo.HTML:return Cc(i,"HTML")?go(i):lH(this._doc,String(i)).toString();case Wo.STYLE:return Cc(i,"Style")?go(i):i;case Wo.SCRIPT:if(Cc(i,"Script"))return go(i);throw new ge(5200,!1);case Wo.URL:return Cc(i,"URL")?go(i):gp(String(i));case Wo.RESOURCE_URL:if(Cc(i,"ResourceURL"))return go(i);throw new ge(5201,!1);default:throw new ge(5202,!1)}}bypassSecurityTrustHtml(n){return function d8e(r){return new o8e(r)}(n)}bypassSecurityTrustStyle(n){return function h8e(r){return new a8e(r)}(n)}bypassSecurityTrustScript(n){return function p8e(r){return new c8e(r)}(n)}bypassSecurityTrustUrl(n){return function g8e(r){return new l8e(r)}(n)}bypassSecurityTrustResourceUrl(n){return function m8e(r){return new u8e(r)}(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function Sge(r){return new MG(r.get(L2))}(Oe(ci)),i},providedIn:"root"}),e})();function af(r){return(af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function u(r,e,t){return(e=function Oge(r){var e=function Pge(r,e){if("object"!==af(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!==af(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"===af(e)?e:String(e)}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const{isArray:Tge}=Array,{getPrototypeOf:bge,prototype:wge,keys:Nge}=Object;function SG(r){if(1===r.length){const e=r[0];if(Tge(e))return{args:e,keys:null};if(function Age(r){return r&&"object"==typeof r&&bge(r)===wge}(e)){const t=Nge(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:Ige}=Array;function PG(r){return Zn(e=>function kge(r,e){return Ige(e)?r(...e):r(e)}(r,e))}function OG(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let TG=(()=>{var r;class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(yc),U(Li))},r.\u0275dir=Rt({type:r}),e})(),S6=(()=>{var r;class e extends TG{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,features:[Ke]}),e})();const Tc=new et("NgValueAccessor"),Lge={provide:Tc,useExisting:b1(()=>$S),multi:!0};let $S=(()=>{var r;class e extends S6{writeValue(n){this.setProperty("checked",n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[J1([Lge]),Ke]}),e})();const Rge={provide:Tc,useExisting:b1(()=>bc),multi:!0},Dge=new et("CompositionEventMode");let bc=(()=>{var r;class e extends TG{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function zge(){const r=W4()?W4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(yc),U(Li),U(Dge,8))},r.\u0275dir=Rt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&W("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[J1([Rge]),Ke]}),e})();function j4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function bG(r){return null!=r&&"number"==typeof r.length}const Di=new et("NgValidators"),Z4=new et("NgAsyncValidators"),Hge=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class cf{static min(e){return function wG(r){return e=>{if(j4(e.value)||j4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function NG(r){return e=>{if(j4(e.value)||j4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return AG(e)}static requiredTrue(e){return function IG(r){return!0===r.value?null:{required:!0}}(e)}static email(e){return function kG(r){return j4(r.value)||Hge.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function xG(r){return e=>j4(e.value)||!bG(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return LG(e)}static pattern(e){return function RG(r){if(!r)return vg;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(j4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return $G(e)}static composeAsync(e){return BG(e)}}function AG(r){return j4(r.value)?{required:!0}:null}function LG(r){return e=>bG(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function vg(r){return null}function zG(r){return null!=r}function DG(r){return G7(r)?u2(r):r}function HG(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function VG(r,e){return e.map(t=>t(r))}function FG(r){return r.map(e=>function Vge(r){return!r.validate}(e)?e:t=>e.validate(t))}function $G(r){if(!r)return null;const e=r.filter(zG);return 0==e.length?null:function(t){return HG(VG(t,e))}}function BS(r){return null!=r?$G(FG(r)):null}function BG(r){if(!r)return null;const e=r.filter(zG);return 0==e.length?null:function(t){return function xge(...r){const e=QR(r),{args:t,keys:n}=SG(r),i=new T1(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let f=0;f<o;f++){let d=!1;lo(t[f]).subscribe(Mr(s,m=>{d||(d=!0,l--),a[f]=m},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(n?OG(n,a):a),s.complete())}))}});return e?i.pipe(PG(e)):i}(VG(t,e).map(DG)).pipe(Zn(HG))}}function GS(r){return null!=r?BG(FG(r)):null}function GG(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function UG(r){return r._rawValidators}function WG(r){return r._rawAsyncValidators}function US(r){return r?Array.isArray(r)?r:[r]:[]}function Cg(r,e){return Array.isArray(r)?r.includes(e):r===e}function qG(r,e){const t=US(e);return US(r).forEach(i=>{Cg(t,i)||t.push(i)}),t}function jG(r,e){return US(e).filter(t=>!Cg(r,t))}class ZG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=BS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=GS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class gs extends ZG{get formDirective(){return null}get path(){return null}}class Y4 extends ZG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class YG{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let V3=(()=>{var r;class e extends YG{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Y4,2))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&Bp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Ke]}),e})(),P6=(()=>{var r;class e extends YG{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(U(gs,10))},r.\u0275dir=Rt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&Bp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Ke]}),e})();const lf="VALID",Mg="INVALID",Z8="PENDING",uf="DISABLED";function jS(r){return(Eg(r)?r.validators:r)||null}function ZS(r,e){return(Eg(e)?e.asyncValidators:r)||null}function Eg(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function XG(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new ge(1e3,"");if(!n[t])throw new ge(1001,"")}function QG(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new ge(1002,"")})}class Sg{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===lf}get invalid(){return this.status===Mg}get pending(){return this.status==Z8}get disabled(){return this.status===uf}get enabled(){return this.status!==uf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(qG(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(qG(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(jG(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(jG(e,this._rawAsyncValidators))}hasValidator(e){return Cg(this._rawValidators,e)}hasAsyncValidator(e){return Cg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Z8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=uf,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=lf,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===lf||this.status===Z8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?uf:lf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Z8,this._hasOwnPendingAsyncValidator=!0;const t=DG(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new A1,this.statusChanges=new A1}_calculateStatus(){return this._allControlsDisabled()?uf:this.errors?Mg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Z8)?Z8:this._anyControlsHaveStatus(Mg)?Mg:lf}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Eg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Gge(r){return Array.isArray(r)?BS(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Uge(r){return Array.isArray(r)?GS(r):r||null}(this._rawAsyncValidators)}}class K4 extends Sg{constructor(e,t,n){super(jS(t),ZS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){QG(this,0,e),Object.keys(e).forEach(n=>{XG(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,s)=>{n=t(n,i,s)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class JG extends K4{}const O6=new et("CallSetDisabledState",{providedIn:"root",factory:()=>ff}),ff="always";function Pg(r,e){return[...e.path,r]}function df(r,e,t=ff){YS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function qge(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&eU(r,e)})}(r,e),function Zge(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function jge(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&eU(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function Wge(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function Og(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),bg(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function Tg(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function YS(r,e){const t=UG(r);null!==e.validator?r.setValidators(GG(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=WG(r);null!==e.asyncValidator?r.setAsyncValidators(GG(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();Tg(e._rawValidators,i),Tg(e._rawAsyncValidators,i)}function bg(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=UG(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,r.setValidators(s))}}if(null!==e.asyncValidator){const i=WG(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,r.setAsyncValidators(s))}}}const n=()=>{};return Tg(e._rawValidators,n),Tg(e._rawAsyncValidators,n),t}function eU(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function tU(r,e){YS(r,e)}function XS(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function nU(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function QS(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(s=>{s.constructor===bc?t=s:function Xge(r){return Object.getPrototypeOf(r.constructor)===S6}(s)?n=s:i=s}),i||n||t||null}const Jge={provide:gs,useExisting:b1(()=>pf)},hf=(()=>Promise.resolve())();let pf=(()=>{var r;class e extends gs{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new A1,this.form=new K4({},BS(n),GS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){hf.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),df(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){hf.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){hf.then(()=>{const i=this._findContainer(n.path),s=new K4({});tU(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){hf.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){hf.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,nU(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Di,10),U(Z4,10),U(O6,8))},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&W("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[J1([Jge]),Ke]}),e})();function rU(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function iU(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const yo=class extends Sg{constructor(e=null,t,n){super(jS(t),ZS(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Eg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=iU(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){rU(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){rU(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){iU(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},nme={provide:Y4,useExisting:b1(()=>gf)},aU=(()=>Promise.resolve())();let gf=(()=>{var r;class e extends Y4{constructor(n,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new yo,this._registered=!1,this.name="",this.update=new A1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=QS(0,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),XS(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){df(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){aU.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,s=0!==i&&q8(i);aU.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?Pg(n,this._parent):[n]}}return(r=e).\u0275fac=function(n){return new(n||r)(U(gs,9),U(Di,10),U(Z4,10),U(Tc,10),U(R3,8),U(O6,8))},r.\u0275dir=Rt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[J1([nme]),Ke,as]}),e})(),T6=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),lU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({}),e})();const ome={provide:Tc,useExisting:b1(()=>wg),multi:!0};let wg=(()=>{var r;class e extends S6{writeValue(n){this.setProperty("value",parseFloat(n))}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[J1([ome]),Ke]}),e})();const JS=new et("NgModelWithFormControlWarning"),ame={provide:Y4,useExisting:b1(()=>eP)};let eP=(()=>{var r;class e extends Y4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=a,this.update=new A1,this._ngModelWarningSent=!1,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=QS(0,s)}ngOnChanges(n){if(this._isControlChanged(n)){const i=n.form.previousValue;i&&Og(i,this,!1),df(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}XS(n,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Og(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_isControlChanged(n){return n.hasOwnProperty("form")}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(U(Di,10),U(Z4,10),U(Tc,10),U(JS,8),U(O6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[J1([ame]),Ke,as]}),e})();const cme={provide:gs,useExisting:b1(()=>b6)};let b6=(()=>{var r;class e extends gs{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new A1,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(bg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return df(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){Og(n.control||null,n,!1),function Qge(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,nU(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,s=this.form.get(n.path);i!==s&&(Og(i||null,n),(r=>r instanceof yo)(s)&&(df(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);tU(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function Yge(r,e){return bg(r,e)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){YS(this.form,this),this._oldForm&&bg(this._oldForm,this)}_checkFormPresent(){}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Di,10),U(Z4,10),U(O6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&W("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[J1([cme]),Ke,as]}),e})();const fme={provide:Y4,useExisting:b1(()=>Y8)};let Y8=(()=>{var r;class e extends Y4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new A1,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=QS(0,o)}ngOnChanges(n){this._added||this._setUpControl(),XS(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return Pg(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(U(gs,13),U(Di,10),U(Z4,10),U(Tc,10),U(JS,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[J1([fme]),Ke,as]}),e})();const dme={provide:Tc,useExisting:b1(()=>Ng),multi:!0};function dU(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let Ng=(()=>{var r;class e extends S6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const s=dU(this._getOptionId(n),n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function hme(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[J1([dme]),Ke]}),e})(),mf=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(dU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Li),U(yc),U(Ng,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const pme={provide:Tc,useExisting:b1(()=>rP),multi:!0};function hU(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let rP=(()=>{var r;class e extends S6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const s=n.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const s=[],o=i.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const f=this._getOptionValue(a[c].value);s.push(f)}}else{const a=i.options;for(let c=0;c<a.length;c++){const l=a[c];if(l.selected){const f=this._getOptionValue(l.value);s.push(f)}}}this.value=s,n(s)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function gme(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[J1([pme]),Ke]}),e})(),_f=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(hU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(hU(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Li),U(yc),U(rP,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();let w6=(()=>{var r;class e{constructor(){this._validator=vg}ngOnChanges(n){if(this.inputName in n){const i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):vg,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,features:[as]}),e})();const vme={provide:Di,useExisting:b1(()=>N6),multi:!0};let N6=(()=>{var r;class e extends w6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=q8,this.createValidator=n=>AG}enabled(n){return n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&I("required",i._enabled?"":null)},inputs:{required:"required"},features:[J1([vme]),Ke]}),e})();const Eme={provide:Di,useExisting:b1(()=>iP),multi:!0};let iP=(()=>{var r;class e extends w6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function pU(r){return"number"==typeof r?r:parseInt(r,10)}(n),this.createValidator=n=>LG(n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&I("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[J1([Eme]),Ke]}),e})(),EU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({imports:[lU]}),e})();class SU extends Sg{constructor(e,t,n){super(jS(t),ZS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){QG(this,0,e),e.forEach((n,i)=>{XG(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function PU(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let Pme=(()=>{var r;class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const s=this._reduceControls(n);let o={};return PU(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new K4(s,o)}record(n,i=null){const s=this._reduceControls(n);return new JG(s,i)}control(n,i,s){let o={};return this.useNonNullable?(PU(i)?o=i:(o.validators=i,o.asyncValidators=s),new yo(n,{...o,nonNullable:!0})):new yo(n,i,s)}array(n,i,s){const o=n.map(a=>this._createControl(a));return new SU(o,i,s)}_reduceControls(n){const i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){return n instanceof yo||n instanceof Sg?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Ome=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:O6,useValue:n.callSetDisabledState??ff}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({imports:[EU]}),e})(),Tme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:JS,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:O6,useValue:n.callSetDisabledState??ff}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({imports:[EU]}),e})();function K8(r,e){return Mn(e)?ri(r,e,1):ri(r,1)}function F3(r,e){return Jr((t,n)=>{let i=0;t.subscribe(Mr(n,s=>r.call(e,s,i++)&&n.next(s)))})}function vf(r){return Jr((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class Ag{}class Ig{}class wc{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof wc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new wc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof wc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class bme{encodeKey(e){return OU(e)}encodeValue(e){return OU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Nme=/%(\d[a-f0-9])/gi,Ame={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function OU(r){return encodeURIComponent(r).replace(Nme,(e,t)=>Ame[t]??e)}function kg(r){return`${r}`}class X4{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new bme,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function wme(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(kg):[kg(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new X4({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(kg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(kg(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Ime{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function TU(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function bU(r){return typeof Blob<"u"&&r instanceof Blob}function wU(r){return typeof FormData<"u"&&r instanceof FormData}class Cf{constructor(e,t,n,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function kme(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new wc),this.context||(this.context=new Ime),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new X4,this.urlWithParams=t}serializeBody(){return null===this.body?null:TU(this.body)||bU(this.body)||wU(this.body)||function xme(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof X4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||wU(this.body)?null:bU(this.body)?this.body.type||null:TU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof X4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),l)),new Cf(t,n,s,{params:l,headers:c,context:f,reportProgress:a,responseType:i,withCredentials:o})}}var X8=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(X8||{});class sP{constructor(e,t=200,n="OK"){this.headers=e.headers||new wc,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class oP extends sP{constructor(e={}){super(e),this.type=X8.ResponseHeader}clone(e={}){return new oP({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Q8 extends sP{constructor(e={}){super(e),this.type=X8.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Q8({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class NU extends sP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function aP(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let Lme=(()=>{var r;class e{constructor(n){this.handler=n}request(n,i,s={}){let o;if(n instanceof Cf)o=n;else{let l,f;l=s.headers instanceof wc?s.headers:new wc(s.headers),s.params&&(f=s.params instanceof X4?s.params:new X4({fromObject:s.params})),o=new Cf(n,i,void 0!==s.body?s.body:null,{headers:l,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const a=Ht(o).pipe(K8(l=>this.handler.handle(l)));if(n instanceof Cf||"events"===s.observe)return a;const c=a.pipe(F3(l=>l instanceof Q8));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(Zn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(Zn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(Zn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return c.pipe(Zn(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new X4).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,aP(s,i))}post(n,i,s={}){return this.request("POST",n,aP(s,i))}put(n,i,s={}){return this.request("PUT",n,aP(s,i))}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(Ag))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function kU(r,e){return e(r)}function zme(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const Hme=new et(""),yf=new et(""),xU=new et("");function Vme(){let r=null;return(e,t)=>{null===r&&(r=(nt(Hme,{optional:!0})??[]).reduceRight(zme,kU));const n=nt(Xp),i=n.add();return r(e,t).pipe(vf(()=>n.remove(i)))}}let LU=(()=>{var r;class e extends Ag{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=nt(Xp)}handle(n){if(null===this.chain){const s=Array.from(new Set([...this.injector.get(yf),...this.injector.get(xU,[])]));this.chain=s.reduceRight((o,a)=>function Dme(r,e,t){return(n,i)=>t.runInContext(()=>e(n,s=>r(s,i)))}(o,a,this.injector),kU)}const i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(vf(()=>this.pendingTasks.remove(i)))}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(Ig),Oe(mo))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const Gme=/^\)\]\}',?\n/;let zU=(()=>{var r;class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new ge(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?u2(i.\u0275loadImpl()):Ht(null)).pipe(Ea(()=>new T1(o=>{const a=i.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((z,$)=>a.setRequestHeader(z,$.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const z=n.detectContentTypeHeader();null!==z&&a.setRequestHeader("Content-Type",z)}if(n.responseType){const z=n.responseType.toLowerCase();a.responseType="json"!==z?z:"text"}const c=n.serializeBody();let l=null;const f=()=>{if(null!==l)return l;const z=a.statusText||"OK",$=new wc(a.getAllResponseHeaders()),G=function Ume(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(a)||n.url;return l=new oP({headers:$,status:a.status,statusText:z,url:G}),l},d=()=>{let{headers:z,status:$,statusText:G,url:de}=f(),Ce=null;204!==$&&(Ce=typeof a.response>"u"?a.responseText:a.response),0===$&&($=Ce?200:0);let Le=$>=200&&$<300;if("json"===n.responseType&&"string"==typeof Ce){const tt=Ce;Ce=Ce.replace(Gme,"");try{Ce=""!==Ce?JSON.parse(Ce):null}catch(gt){Ce=tt,Le&&(Le=!1,Ce={error:gt,text:Ce})}}Le?(o.next(new Q8({body:Ce,headers:z,status:$,statusText:G,url:de||void 0})),o.complete()):o.error(new NU({error:Ce,headers:z,status:$,statusText:G,url:de||void 0}))},m=z=>{const{url:$}=f(),G=new NU({error:z,status:a.status||0,statusText:a.statusText||"Unknown Error",url:$||void 0});o.error(G)};let E=!1;const w=z=>{E||(o.next(f()),E=!0);let $={type:X8.DownloadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),"text"===n.responseType&&a.responseText&&($.partialText=a.responseText),o.next($)},R=z=>{let $={type:X8.UploadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),o.next($)};return a.addEventListener("load",d),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),n.reportProgress&&(a.addEventListener("progress",w),null!==c&&a.upload&&a.upload.addEventListener("progress",R)),a.send(c),o.next({type:X8.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",d),a.removeEventListener("timeout",m),n.reportProgress&&(a.removeEventListener("progress",w),null!==c&&a.upload&&a.upload.removeEventListener("progress",R)),a.readyState!==a.DONE&&a.abort()}})))}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(JB))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const cP=new et("XSRF_ENABLED"),DU=new et("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),HU=new et("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class VU{}let jme=(()=>{var r;class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=GB(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2),Oe(N3),Oe(DU))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function Zme(r,e){const t=r.url.toLowerCase();if(!nt(cP)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=nt(VU).getToken(),i=nt(HU);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var Q4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(Q4||{});function A6(r,e){return{\u0275kind:r,\u0275providers:e}}function Yme(...r){const e=[Lme,zU,LU,{provide:Ag,useExisting:LU},{provide:Ig,useExisting:zU},{provide:yf,useValue:Zme,multi:!0},{provide:cP,useValue:!0},{provide:VU,useClass:jme}];for(const t of r)e.push(...t.\u0275providers);return function LM(r){return{\u0275providers:r}}(e)}const FU=new et("LEGACY_INTERCEPTOR_FN");let Xme=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({providers:[Yme(A6(Q4.LegacyInterceptors,[{provide:FU,useFactory:Vme},{provide:yf,useExisting:FU,multi:!0}]))]}),e})();function lP(...r){const e=i7(r),t=QR(r),{args:n,keys:i}=SG(r);if(0===n.length)return u2([],e);const s=new T1(function i_e(r,e,t=uc){return n=>{$U(e,()=>{const{length:i}=r,s=new Array(i);let o=i,a=i;for(let c=0;c<i;c++)$U(e,()=>{const l=u2(r[c],e);let f=!1;l.subscribe(Mr(n,d=>{s[c]=d,f||(f=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,i?o=>OG(i,o):uc));return t?s.pipe(PG(t)):s}function $U(r,e,t){r?E3(t,r,e):e()}const Lg=Fo(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function uP(...r){return function s_e(){return t8(1)}()(u2(r,i7(r)))}function BU(r){return new T1(e=>{lo(r()).subscribe(e)})}function Mf(r,e){const t=Mn(r)?r:()=>r,n=i=>i.error(t());return new T1(e?i=>e.schedule(n,0,i):n)}function fP(){return Jr((r,e)=>{let t=null;r._refCount++;const n=Mr(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class GU extends T1{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Mh(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new En;const t=this.getSubject();e.add(this.source.subscribe(Mr(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=En.EMPTY)}return e}refCount(){return fP()(this)}}function J8(r){return r<=0?()=>fc:Jr((e,t)=>{let n=0;e.subscribe(Mr(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function Rg(r){return Jr((e,t)=>{let n=!1;e.subscribe(Mr(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function UU(r=a_e){return Jr((e,t)=>{let n=!1;e.subscribe(Mr(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function a_e(){return new Lg}function I6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?F3((i,s)=>r(i,s,n)):uc,J8(1),t?Rg(e):UU(()=>new Lg))}function Hi(r,e,t){const n=Mn(r)||e||t?{next:r,error:e,complete:t}:r;return n?Jr((i,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;i.subscribe(Mr(s,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),s.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),s.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),s.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):uc}function k6(r){return Jr((e,t)=>{let s,n=null,i=!1;n=e.subscribe(Mr(t,void 0,void 0,o=>{s=lo(r(o,k6(r)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,s.subscribe(t))})}function dP(r){return r<=0?()=>fc:Jr((e,t)=>{let n=[];e.subscribe(Mr(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}const rn="primary",Ef=Symbol("RouteTitle");class d_e{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function e5(r){return new d_e(r)}function h_e(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let s=0;s<n.length;s++){const o=n[s],a=r[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function Nc(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!WU(r[i],e[i]))return!1;return!0}function WU(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}return r===e}function qU(r){return r.length>0?r[r.length-1]:null}function J4(r){return function r_e(r){return!!r&&(r instanceof T1||Mn(r.lift)&&Mn(r.subscribe))}(r)?r:G7(r)?u2(Promise.resolve(r)):Ht(r)}const g_e={exact:function YU(r,e,t){if(!x6(r.segments,e.segments)||!zg(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!YU(r.children[n],e.children[n],t))return!1;return!0},subset:KU},jU={exact:function m_e(r,e){return Nc(r,e)},subset:function __e(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>WU(r[t],e[t]))},ignored:()=>!0};function ZU(r,e,t){return g_e[t.paths](r.root,e.root,t.matrixParams)&&jU[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function KU(r,e,t){return XU(r,e,e.segments,t)}function XU(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!x6(i,t)||e.hasChildren()||!zg(i,t,n))}if(r.segments.length===t.length){if(!x6(r.segments,t)||!zg(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!KU(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!!(x6(r.segments,i)&&zg(r.segments,i,n)&&r.children[rn])&&XU(r.children[rn],e,s,n)}}function zg(r,e,t){return e.every((n,i)=>jU[t](r[i].parameters,n.parameters))}class t5{constructor(e=new f1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=e5(this.queryParams)),this._queryParamMap}toString(){return y_e.serialize(this)}}class f1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Dg(this)}}class Sf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=e5(this.parameters)),this._parameterMap}toString(){return eW(this)}}function x6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let Pf=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new hP},providedIn:"root"}),e})();class hP{parse(e){const t=new I_e(e);return new t5(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Of(e.root,!0)}`,n=function S_e(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${Hg(t)}=${Hg(i)}`).join("&"):`${Hg(t)}=${Hg(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function M_e(r){return encodeURI(r)}(e.fragment)}`:""}`}}const y_e=new hP;function Dg(r){return r.segments.map(e=>eW(e)).join("/")}function Of(r,e){if(!r.hasChildren())return Dg(r);if(e){const t=r.children[rn]?Of(r.children[rn],!1):"",n=[];return Object.entries(r.children).forEach(([i,s])=>{i!==rn&&n.push(`${i}:${Of(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function C_e(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===rn&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==rn&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===rn?[Of(r.children[rn],!1)]:[`${i}:${Of(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[rn]?`${Dg(r)}/${t[0]}`:`${Dg(r)}/(${t.join("//")})`}}function QU(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hg(r){return QU(r).replace(/%3B/gi,";")}function pP(r){return QU(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vg(r){return decodeURIComponent(r)}function JU(r){return Vg(r.replace(/\+/g,"%20"))}function eW(r){return`${pP(r.path)}${function E_e(r){return Object.keys(r).map(e=>`;${pP(e)}=${pP(r[e])}`).join("")}(r.parameters)}`}const P_e=/^[^\/()?;#]+/;function gP(r){const e=r.match(P_e);return e?e[0]:""}const O_e=/^[^\/()?;=#]+/,b_e=/^[^=?&#]+/,N_e=/^[^&#]+/;class I_e{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new f1([],{}):new f1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[rn]=new f1(e,t)),n}parseSegment(){const e=gP(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new Sf(Vg(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function T_e(r){const e=r.match(O_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=gP(this.remaining);i&&(n=i,this.capture(n))}e[Vg(t)]=Vg(n)}parseQueryParam(e){const t=function w_e(r){const e=r.match(b_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function A_e(r){const e=r.match(N_e);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const i=JU(t),s=JU(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=gP(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new ge(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=rn);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[rn]:new f1([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}}function tW(r){return r.segments.length>0?new f1([],{[rn]:r}):r}function nW(r){const e={};for(const n of Object.keys(r.children)){const s=nW(r.children[n]);if(n===rn&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function k_e(r){if(1===r.numberOfChildren&&r.children[rn]){const e=r.children[rn];return new f1(r.segments.concat(e.segments),e.children)}return r}(new f1(r.segments,e))}function L6(r){return r instanceof t5}function rW(r){let e;const i=tW(function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new f1(s.url,o);return s===r&&(e=a),a}(r.root));return e??i}function iW(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return mP(i,i,i,t,n);const s=function L_e(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new oW(!0,0,r);let e=0,t=!1;const n=r.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new oW(t,e,n)}(e);if(s.toRoot())return mP(i,i,new f1([],{}),t,n);const o=function R_e(r,e,t){if(r.isAbsolute)return new $g(e,!0,0);if(!t)return new $g(e,!1,NaN);if(null===t.parent)return new $g(t,!0,0);const n=Fg(r.commands[0])?0:1;return function z_e(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new ge(4005,!1);i=n.segments.length}return new $g(n,!1,i-s)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(s,i,r),a=o.processChildren?bf(o.segmentGroup,o.index,s.commands):aW(o.segmentGroup,o.index,s.commands);return mP(i,o.segmentGroup,a,t,n)}function Fg(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function Tf(r){return"object"==typeof r&&null!=r&&r.outlets}function mP(r,e,t,n,i){let o,s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),o=r===e?t:sW(r,e,t);const a=tW(nW(o));return new t5(a,s,i)}function sW(r,e,t){const n={};return Object.entries(r.children).forEach(([i,s])=>{n[i]=s===e?t:sW(s,e,t)}),new f1(r.segments,n)}class oW{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Fg(n[0]))throw new ge(4003,!1);const i=n.find(Tf);if(i&&i!==qU(n))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class $g{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function aW(r,e,t){if(r||(r=new f1([],{})),0===r.segments.length&&r.hasChildren())return bf(r,e,t);const n=function H_e(r,e,t){let n=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;const o=r.segments[i],a=t[n];if(Tf(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!lW(c,l,o))return s;n+=2}else{if(!lW(c,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const s=new f1(r.segments.slice(0,n.pathIndex),{});return s.children[rn]=new f1(r.segments.slice(n.pathIndex),r.children),bf(s,0,i)}return n.match&&0===i.length?new f1(r.segments,{}):n.match&&!r.hasChildren()?_P(r,e,t):n.match?bf(r,0,i):_P(r,e,t)}function bf(r,e,t){if(0===t.length)return new f1(r.segments,{});{const n=function D_e(r){return Tf(r[0])?r[0].outlets:{[rn]:r}}(t),i={};if(!n[rn]&&r.children[rn]&&1===r.numberOfChildren&&0===r.children[rn].segments.length){const s=bf(r.children[rn],e,t);return new f1(r.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=aW(r.children[s],e,o))}),Object.entries(r.children).forEach(([s,o])=>{void 0===n[s]&&(i[s]=o)}),new f1(r.segments,i)}}function _P(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(Tf(s)){const c=V_e(s.outlets);return new f1(n,c)}if(0===i&&Fg(t[0])){n.push(new Sf(r.segments[e].path,cW(t[0]))),i++;continue}const o=Tf(s)?s.outlets[rn]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Fg(a)?(n.push(new Sf(o,cW(a))),i+=2):(n.push(new Sf(o,{})),i++)}return new f1(n,{})}function V_e(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=_P(new f1([],{}),0,n))}),e}function cW(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function lW(r,e,t){return r==t.path&&Nc(e,t.parameters)}const wf="imperative";class Ac{constructor(e,t){this.id=e,this.url=t}}class vP extends Ac{constructor(e,t,n="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class el extends Ac{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Bg extends Ac{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Nf extends Ac{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=16}}class CP extends Ac{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class F_e extends Ac{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $_e extends Ac{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class B_e extends Ac{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class G_e extends Ac{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class U_e extends Ac{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class W_e{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class q_e{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class j_e{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Z_e{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Y_e{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class K_e{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uW{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class X_e{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Af,this.attachRef=null}}let Af=(()=>{var r;class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new X_e,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class fW{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=yP(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=yP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=MP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return MP(e,this._root).map(t=>t.value)}}function yP(r,e){if(r===e.value)return e;for(const t of e.children){const n=yP(r,t);if(n)return n}return null}function MP(r,e){if(r===e.value)return[e];for(const t of e.children){const n=MP(r,t);if(n.length)return n.unshift(e),n}return[]}class $3{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function n5(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class dW extends fW{constructor(e,t){super(e),this.snapshot=t,EP(this,e)}toString(){return this.snapshot.toString()}}function hW(r,e){const t=function Q_e(r,e){const o=new Gg([],{},{},"",{},rn,e,null,{});return new gW("",new $3(o,[]))}(0,e),n=new ss([new Sf("",{})]),i=new ss({}),s=new ss({}),o=new ss({}),a=new ss(""),c=new qs(n,i,o,a,s,rn,e,t.root);return c.snapshot=t.root,new dW(new $3(c,[]),t)}class qs{constructor(e,t,n,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Zn(l=>l[Ef]))??Ht(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Zn(e=>e5(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Zn(e=>e5(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function pW(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],s=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(s.component)break;n--}}return function J_e(r){return r.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Gg{get title(){return this.data?.[Ef]}constructor(e,t,n,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=e5(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=e5(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class gW extends fW{constructor(e,t){super(t),this.url=e,EP(this,t)}toString(){return mW(this._root)}}function EP(r,e){e.value._routerState=r,e.children.forEach(t=>EP(r,t))}function mW(r){const e=r.children.length>0?` { ${r.children.map(mW).join(", ")} } `:"";return`${r.value}${e}`}function SP(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Nc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Nc(e.params,t.params)||r.paramsSubject.next(t.params),function p_e(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Nc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),Nc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function PP(r,e){const t=Nc(r.params,e.params)&&function v_e(r,e){return x6(r,e)&&r.every((t,n)=>Nc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||PP(r.parent,e.parent))}let OP=(()=>{var r;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=rn,this.activateEvents=new A1,this.deactivateEvents=new A1,this.attachEvents=new A1,this.detachEvents=new A1,this.parentContexts=nt(Af),this.location=nt(vo),this.changeDetector=nt(R3),this.environmentInjector=nt(mo),this.inputBinder=nt(Ug,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=n;const s=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new eve(n,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[as]}),e})();class eve{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===qs?this.route:e===Af?this.childContexts:this.parent.get(e,t)}}const Ug=new et("");let _W=(()=>{var r;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,s=lP([i.queryParams,i.params,i.data]).pipe(Ea(([o,a,c],l)=>(c={...o,...a,...c},0===l?Ht(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const a=function rhe(r){const e=Rn(r);if(!e)return null;const t=new H7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,s)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function If(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function nve(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return If(r,n,i);return If(r,n)})}(r,e,t);return new $3(n,i)}{if(r.shouldAttach(e.value)){const s=r.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>If(r,a)),o}}const n=function rve(r){return new qs(new ss(r.url),new ss(r.params),new ss(r.queryParams),new ss(r.fragment),new ss(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(s=>If(r,s));return new $3(n,i)}}const TP="ngNavigationCancelingError";function vW(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=L6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=CW(!1,0,e);return i.url=t,i.navigationBehaviorOptions=n,i}function CW(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[TP]=!0,n.cancellationCode=e,t&&(n.url=t),n}function yW(r){return MW(r)&&L6(r.url)}function MW(r){return r&&r[TP]}let EW=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=Be({type:r,selectors:[["ng-component"]],standalone:!0,features:[e$],decls:1,vars:0,template:function(n,i){1&n&&V(0,"router-outlet")},dependencies:[OP],encapsulation:2}),e})();function bP(r){const e=r.children&&r.children.map(bP),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==rn&&(t.component=EW),t}function ka(r){return r.outlet||rn}function kf(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class uve{constructor(e,t,n,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),SP(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=n5(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=n5(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=n5(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=n5(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new K_e(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Z_e(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(SP(i),i===s)if(i.component){const o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),SP(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=kf(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class SW{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Wg{constructor(e,t){this.component=e,this.route=t}}function fve(r,e,t){const n=r._root;return xf(n,e?e._root:null,t,[n.value])}function r5(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function Sle(r){return null!==bh(r)}(r)?e.get(r):r:n}function xf(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=n5(e);return r.children.forEach(o=>{(function hve(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=r.value,o=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function pve(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!x6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!x6(r.url,e.url)||!Nc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!PP(r,e)||!Nc(r.queryParams,e.queryParams);default:return!PP(r,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new SW(n)):(s.data=o.data,s._resolvedData=o._resolvedData),xf(r,e,s.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Wg(a.outlet.component,o))}else o&&Lf(e,a,i),i.canActivateChecks.push(new SW(n)),xf(r,null,s.component?a?a.children:null:t,n,i)})(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Lf(a,t.getContext(o),i)),i}function Lf(r,e,t){const n=n5(r),i=r.value;Object.entries(n).forEach(([s,o])=>{Lf(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Wg(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Rf(r){return"function"==typeof r}function PW(r){return r instanceof Lg||"EmptyError"===r?.name}const qg=Symbol("INITIAL_VALUE");function i5(){return Ea(r=>lP(r.map(e=>e.pipe(J8(1),function o_e(...r){const e=i7(r);return Jr((t,n)=>{(e?uP(r,t,e):uP(r,t)).subscribe(n)})}(qg)))).pipe(Zn(e=>{for(const t of e)if(!0!==t){if(t===qg)return qg;if(!1===t||t instanceof t5)return t}return!0}),F3(e=>e!==qg),J8(1)))}function OW(r){return function _h(...r){return vh(r)}(Hi(e=>{if(L6(e))throw vW(0,e)}),Zn(e=>!0===e))}class jg{constructor(e){this.segmentGroup=e||null}}class TW{constructor(e){this.urlTree=e}}function s5(r){return Mf(new jg(r))}function bW(r){return Mf(new TW(r))}class Lve{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ge(4002,!1)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Ht(n);if(i.numberOfChildren>1||!i.children[rn])return Mf(new ge(4e3,!1));i=i.children[rn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,i){const s=this.createSegmentGroup(e,t.root,n,i);return new t5(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);n[i]=t[a]}else n[i]=s}),n}createSegmentGroup(e,t,n,i){const s=this.createSegments(e,t.segments,n,i);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,n,i)}),new f1(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new ge(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const wP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Rve(r,e,t,n,i){const s=NP(r,e,t);return s.matched?(n=function ive(r,e){return r.providers&&!r._injector&&(r._injector=LE(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function Ive(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?Ht(i.map(o=>{const a=r5(o,r);return J4(function yve(r){return r&&Rf(r.canMatch)}(a)?a.canMatch(e,t):r.runInContext(()=>a(e,t)))})).pipe(i5(),OW()):Ht(!0)}(n,e,t).pipe(Zn(o=>!0===o?s:{...wP}))):Ht(s)}function NP(r,e,t){if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...wP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||h_e)(t,r,e);if(!i)return{...wP};const s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function wW(r,e,t,n){return t.length>0&&function Hve(r,e,t){return t.some(n=>Zg(r,e,n)&&ka(n)!==rn)}(r,t,n)?{segmentGroup:new f1(e,Dve(n,new f1(t,r.children))),slicedSegments:[]}:0===t.length&&function Vve(r,e,t){return t.some(n=>Zg(r,e,n))}(r,t,n)?{segmentGroup:new f1(r.segments,zve(r,0,t,n,r.children)),slicedSegments:t}:{segmentGroup:new f1(r.segments,r.children),slicedSegments:t}}function zve(r,e,t,n,i){const s={};for(const o of n)if(Zg(r,t,o)&&!i[ka(o)]){const a=new f1([],{});s[ka(o)]=a}return{...i,...s}}function Dve(r,e){const t={};t[rn]=e;for(const n of r)if(""===n.path&&ka(n)!==rn){const i=new f1([],{});t[ka(n)]=i}return t}function Zg(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Gve{constructor(e,t,n,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new Lve(this.urlSerializer,this.urlTree)}noMatchError(e){return new ge(4002,!1)}recognize(){const e=wW(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,rn).pipe(k6(t=>{if(t instanceof TW)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof jg?this.noMatchError(t):t}),Zn(t=>{const n=new Gg([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},rn,this.rootComponentType,null,{}),i=new $3(n,t),s=new gW("",i),o=function x_e(r,e,t=null,n=null){return iW(rW(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,rn).pipe(k6(n=>{throw n instanceof jg?this.noMatchError(n):n}))}inheritParamsAndData(e){const t=e.value,n=pW(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0)}processChildren(e,t,n){const i=[];for(const s of Object.keys(n.children))"primary"===s?i.unshift(s):i.push(s);return u2(i).pipe(K8(s=>{const o=n.children[s],a=function cve(r,e){const t=r.filter(n=>ka(n)===e);return t.push(...r.filter(n=>ka(n)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function l_e(r,e){return Jr(function c_e(r,e,t,n,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Mr(o,f=>{const d=l++;c=a?r(c,f,d):(a=!0,f),n&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}(r,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),Rg(null),function u_e(r,e){const t=arguments.length>=2;return n=>n.pipe(r?F3((i,s)=>r(i,s,n)):uc,dP(1),t?Rg(e):UU(()=>new Lg))}(),ri(s=>{if(null===s)return s5(n);const o=NW(s);return function Uve(r){r.sort((e,t)=>e.value.outlet===rn?-1:t.value.outlet===rn?1:e.value.outlet.localeCompare(t.value.outlet))}(o),Ht(o)}))}processSegment(e,t,n,i,s,o){return u2(t).pipe(K8(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,s,o).pipe(k6(c=>{if(c instanceof jg)return Ht(null);throw c}))),I6(a=>!!a),k6(a=>{if(PW(a))return function $ve(r,e,t){return 0===e.length&&!r.children[t]}(n,i,s)?Ht([]):s5(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,s,o,a){return function Fve(r,e,t,n){return!!(ka(r)===n||n!==rn&&Zg(e,t,r))&&("**"===r.path||NP(e,r,t).matched)}(n,i,s,o)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,s,o):s5(i):s5(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const s=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?bW(s):this.applyRedirects.lineralizeSegments(n,s).pipe(ri(o=>{const a=new f1(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:f}=NP(t,i,s);if(!a)return s5(t);const d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?bW(d):this.applyRedirects.lineralizeSegments(i,d).pipe(ri(m=>this.processSegment(e,n,t,m.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s,o){let a;if("**"===n.path){const c=i.length>0?qU(i).parameters:{};a=Ht({snapshot:new Gg(i,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,AW(n),ka(n),n.component??n._loadedComponent??null,n,IW(n)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=Rve(t,n,i,e).pipe(Zn(({matched:c,consumedSegments:l,remainingSegments:f,parameters:d})=>c?{snapshot:new Gg(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,AW(n),ka(n),n.component??n._loadedComponent??null,n,IW(n)),consumedSegments:l,remainingSegments:f}:null));return a.pipe(Ea(c=>null===c?s5(t):this.getChildConfig(e=n._injector??e,n,i).pipe(Ea(({routes:l})=>{const f=n._loadedInjector??e,{snapshot:d,consumedSegments:m,remainingSegments:E}=c,{segmentGroup:w,slicedSegments:R}=wW(t,m,E,l);if(0===R.length&&w.hasChildren())return this.processChildren(f,l,w).pipe(Zn($=>null===$?null:[new $3(d,$)]));if(0===l.length&&0===R.length)return Ht([new $3(d,[])]);const z=ka(n)===s;return this.processSegment(f,l,w,R,z?rn:s,!0).pipe(Zn($=>[new $3(d,$)]))}))))}getChildConfig(e,t,n){return t.children?Ht({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Ht({routes:t._loadedRoutes,injector:t._loadedInjector}):function Ave(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?Ht(!0):Ht(i.map(o=>{const a=r5(o,r);return J4(function mve(r){return r&&Rf(r.canLoad)}(a)?a.canLoad(e,t):r.runInContext(()=>a(e,t)))})).pipe(i5(),OW())}(e,t,n).pipe(ri(i=>i?this.configLoader.loadChildren(e,t).pipe(Hi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function xve(r){return Mf(CW(!1,3))}())):Ht({routes:[],injector:e})}}function Wve(r){const e=r.value.routeConfig;return e&&""===e.path}function NW(r){const e=[],t=new Set;for(const n of r){if(!Wve(n)){e.push(n);continue}const i=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=NW(n.children);e.push(new $3(n.value,i))}return e.filter(n=>!t.has(n))}function AW(r){return r.data||{}}function IW(r){return r.resolve||{}}function kW(r){return"string"==typeof r.title||null===r.title}function AP(r){return Ea(e=>{const t=r(e);return t?u2(t).pipe(Zn(()=>e)):Ht(e)})}const o5=new et("ROUTES");let IP=(()=>{var r;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=nt(W$)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Ht(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=J4(n.loadComponent()).pipe(Zn(xW),Hi(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),vf(()=>{this.componentLoaders.delete(n)})),s=new GU(i,()=>new zs).pipe(fP());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ht({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(Zn(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,f;return Array.isArray(c)?f=c:(l=c.create(n).injector,f=l.get(o5,[],ln.Self|ln.Optional).flat()),{routes:f.map(bP),injector:l}}),vf(()=>{this.childrenLoaders.delete(i)})),a=new GU(o,()=>new zs).pipe(fP());return this.childrenLoaders.set(i,a),a}loadModuleFactoryOrRoutes(n){return J4(n()).pipe(Zn(xW),ri(i=>i instanceof QF||Array.isArray(i)?Ht(i):u2(this.compiler.compileModuleAsync(i))))}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function xW(r){return function Qve(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let Yg=(()=>{var r;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new zs,this.configLoader=nt(IP),this.environmentInjector=nt(mo),this.urlSerializer=nt(Pf),this.rootContexts=nt(Af),this.inputBindingEnabled=null!==nt(Ug,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Ht(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new q_e(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new W_e(s))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n){return this.transitions=new ss({id:0,currentUrlTree:n.currentUrlTree,currentRawUrl:n.currentUrlTree,extractedUrl:n.urlHandlingStrategy.extract(n.currentUrlTree),urlAfterRedirects:n.urlHandlingStrategy.extract(n.currentUrlTree),rawUrl:n.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:wf,restoredState:null,currentSnapshot:n.routerState.snapshot,targetSnapshot:null,currentRouterState:n.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(F3(i=>0!==i.id),Zn(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),Ea(i=>{let s=!1,o=!1;return Ht(i).pipe(Hi(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ea(a=>{const c=n.browserUrlTree.toString(),l=!n.navigated||a.extractedUrl.toString()!==c||c!==n.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const d="";return this.events.next(new Nf(a.id,n.serializeUrl(i.rawUrl),d,0)),n.rawUrlTree=a.rawUrl,a.resolve(null),fc}if(n.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return LW(a.source)&&(n.browserUrlTree=a.extractedUrl),Ht(a).pipe(Ea(d=>{const m=this.transitions?.getValue();return this.events.next(new vP(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?fc:Promise.resolve(d)}),function qve(r,e,t,n,i,s){return ri(o=>function Bve(r,e,t,n,i,s,o="emptyOnly"){return new Gve(r,e,t,n,i,o,s).recognize()}(r,e,t,n,o.extractedUrl,i,s).pipe(Zn(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Hi(d=>{if(i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},"eager"===n.urlUpdateStrategy){if(!d.extras.skipLocationChange){const E=n.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);n.setBrowserUrl(E,d)}n.browserUrlTree=d.urlAfterRedirects}const m=new F_e(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(l&&n.urlHandlingStrategy.shouldProcessUrl(n.rawUrlTree)){const{id:d,extractedUrl:m,source:E,restoredState:w,extras:R}=a,z=new vP(d,this.urlSerializer.serialize(m),E,w);this.events.next(z);const $=hW(0,this.rootComponentType).snapshot;return Ht(i={...a,targetSnapshot:$,urlAfterRedirects:m,extras:{...R,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new Nf(a.id,n.serializeUrl(i.extractedUrl),d,1)),n.rawUrlTree=a.rawUrl,a.resolve(null),fc}}),Hi(a=>{const c=new $_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Zn(a=>i={...a,guards:fve(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function Eve(r,e){return ri(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ht({...t,guardsResult:!0}):function Sve(r,e,t,n){return u2(r).pipe(ri(i=>function Nve(r,e,t,n,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ht(s.map(a=>{const c=kf(e)??i,l=r5(a,c);return J4(function Cve(r){return r&&Rf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):c.runInContext(()=>l(r,e,t,n))).pipe(I6())})).pipe(i5()):Ht(!0)}(i.component,i.route,t,e,n)),I6(i=>!0!==i,!0))}(o,n,i,r).pipe(ri(a=>a&&function gve(r){return"boolean"==typeof r}(a)?function Pve(r,e,t,n){return u2(e).pipe(K8(i=>uP(function Tve(r,e){return null!==r&&e&&e(new j_e(r)),Ht(!0)}(i.route.parent,n),function Ove(r,e){return null!==r&&e&&e(new Y_e(r)),Ht(!0)}(i.route,n),function wve(r,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function dve(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(o)).filter(o=>null!==o).map(o=>BU(()=>Ht(o.guards.map(c=>{const l=kf(o.node)??t,f=r5(c,l);return J4(function vve(r){return r&&Rf(r.canActivateChild)}(f)?f.canActivateChild(n,r):l.runInContext(()=>f(n,r))).pipe(I6())})).pipe(i5())));return Ht(s).pipe(i5())}(r,i.path,t),function bve(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Ht(!0);const i=n.map(s=>BU(()=>{const o=kf(e)??t,a=r5(s,o);return J4(function _ve(r){return r&&Rf(r.canActivate)}(a)?a.canActivate(e,r):o.runInContext(()=>a(e,r))).pipe(I6())}));return Ht(i).pipe(i5())}(r,i.route,t))),I6(i=>!0!==i,!0))}(n,s,r,e):Ht(a)),Zn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,a=>this.events.next(a)),Hi(a=>{if(i.guardsResult=a.guardsResult,L6(a.guardsResult))throw vW(0,a.guardsResult);const c=new B_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),F3(a=>!!a.guardsResult||(n.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),AP(a=>{if(a.guards.canActivateChecks.length)return Ht(a).pipe(Hi(c=>{const l=new G_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),Ea(c=>{let l=!1;return Ht(c).pipe(function jve(r,e){return ri(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Ht(t);let s=0;return u2(i).pipe(K8(o=>function Zve(r,e,t,n){const i=r.routeConfig,s=r._resolve;return void 0!==i?.title&&!kW(i)&&(s[Ef]=i.title),function Yve(r,e,t,n){const i=function Kve(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}(r);if(0===i.length)return Ht({});const s={};return u2(i).pipe(ri(o=>function Xve(r,e,t,n){const i=kf(e)??n,s=r5(r,i);return J4(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(r[o],e,t,n).pipe(I6(),Hi(a=>{s[o]=a}))),dP(1),function f_e(r){return Zn(()=>r)}(s),k6(o=>PW(o)?fc:Mf(o)))}(s,r,e,n).pipe(Zn(o=>(r._resolvedData=o,r.data=pW(r,t).resolve,i&&kW(i)&&(r.data[Ef]=i.title),null)))}(o.route,n,r,e)),Hi(()=>s++),dP(1),ri(o=>s===i.length?Ht(t):fc))})}(n.paramsInheritanceStrategy,this.environmentInjector),Hi({next:()=>l=!0,complete:()=>{l||(n.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),Hi(c=>{const l=new U_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),AP(a=>{const c=l=>{const f=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(l.routeConfig).pipe(Hi(d=>{l.component=d}),Zn(()=>{})));for(const d of l.children)f.push(...c(d));return f};return lP(c(a.targetSnapshot.root)).pipe(Rg(),J8(1))}),AP(()=>this.afterPreactivation()),Zn(a=>{const c=function tve(r,e,t){const n=If(r,e._root,t?t._root:void 0);return new dW(n,e)}(n.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:c}}),Hi(a=>{n.currentUrlTree=a.urlAfterRedirects,n.rawUrlTree=n.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),n.routerState=a.targetRouterState,"deferred"===n.urlUpdateStrategy&&(a.extras.skipLocationChange||n.setBrowserUrl(n.rawUrlTree,a),n.browserUrlTree=a.urlAfterRedirects)}),((r,e,t,n)=>Zn(i=>(new uve(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,n.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),J8(1),Hi({next:a=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,n.navigated=!0,this.events.next(new el(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(n.currentUrlTree))),n.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{s=!0}}),vf(()=>{s||o||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),k6(a=>{if(o=!0,MW(a)){yW(a)||(n.navigated=!0,n.restoreHistory(i,!0));const c=new Bg(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode);if(this.events.next(c),yW(a)){const l=n.urlHandlingStrategy.merge(a.url,n.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===n.urlUpdateStrategy||LW(i.source)};n.scheduleNavigation(l,wf,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{n.restoreHistory(i,!0);const c=new CP(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(n.errorHandler(a))}catch(l){i.reject(l)}}return fc}))}))}cancelNavigationTransition(n,i,s){const o=new Bg(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(o),n.resolve(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function LW(r){return r!==wf}let RW=(()=>{var r;class e{buildTitle(n){let i,s=n.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===rn);return i}getResolvedTitleForRoute(n){return n.data[Ef]}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(Jve)},providedIn:"root"}),e})(),Jve=(()=>{var r;class e extends RW{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(_G))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),eCe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(nCe)},providedIn:"root"}),e})();class tCe{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let nCe=(()=>{var r;class e extends tCe{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const Kg=new et("",{providedIn:"root",factory:()=>({})});let rCe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(iCe)},providedIn:"root"}),e})(),iCe=(()=>{var r;class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();var zf=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(zf||{});function zW(r,e){r.events.pipe(F3(t=>t instanceof el||t instanceof Bg||t instanceof CP||t instanceof Nf),Zn(t=>t instanceof el||t instanceof Nf?zf.COMPLETE:t instanceof Bg&&(0===t.code||1===t.code)?zf.REDIRECTING:zf.FAILED),F3(t=>t!==zf.REDIRECTING),J8(1)).subscribe(()=>{e()})}function sCe(r){throw r}function oCe(r,e,t){return e.parse("/")}const aCe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},cCe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Un=(()=>{var r;class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=nt(U$),this.isNgZoneEnabled=!1,this.options=nt(Kg,{optional:!0})||{},this.pendingTasks=nt(Xp),this.errorHandler=this.options.errorHandler||sCe,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||oCe,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=nt(rCe),this.routeReuseStrategy=nt(eCe),this.titleStrategy=nt(RW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=nt(o5,{optional:!0})?.flat()??[],this.navigationTransitions=nt(Yg),this.urlSerializer=nt(Pf),this.location=nt(gS),this.componentInputBindingEnabled=!!nt(Ug,{optional:!0}),this.isNgZoneEnabled=nt(u1)instanceof u1&&u1.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new t5,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=hW(0,null),this.navigationTransitions.setupNavigations(this).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId??0},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),wf,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,s){const o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const c=this.parseUrl(n);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(bP),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a;let m,d=null;switch(c){case"merge":d={...this.currentUrlTree.queryParams,...o};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}null!==d&&(d=this.removeEmptyProps(d));try{m=rW(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return iW(m,n,d,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){const s=L6(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,wf,null,i)}navigate(n,i={skipLocationChange:!1}){return function lCe(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new ge(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,n)}return i}isActive(n,i){let s;if(s=!0===i?{...aCe}:!1===i?{...cCe}:i,L6(n))return ZU(this.currentUrlTree,n,s);const o=this.parseUrl(n);return ZU(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.keys(n).reduce((i,s)=>{const o=n[s];return null!=o&&(i[s]=o),i},{})}scheduleNavigation(n,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,f;a?(c=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,E)=>{c=m,l=E});const d=this.pendingTasks.add();return zW(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}setBrowserUrl(n,i){const s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",a)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(s,"",o)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-(this.browserPageId??this.currentPageId);0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Ic=(()=>{var r;class e{constructor(n,i,s,o,a,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new zs,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof el&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,o,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||i||s||o||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function fH(r,e,t){return function A8e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?uH:_p}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,i){const s=this.renderer,o=this.el.nativeElement;null!==i?s.setAttribute(o,n,i):s.removeAttribute(o,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(r=e).\u0275fac=function(n){return new(n||r)(U(Un),U(qs),function Xh(r){return function j6e(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const s=t[i];if(dz(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(ai(),r)}("tabindex"),U(yc),U(Li),U(E6))},r.\u0275dir=Rt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&W("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&n&&I("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",q8],skipLocationChange:["skipLocationChange","skipLocationChange",q8],replaceUrl:["replaceUrl","replaceUrl",q8],routerLink:"routerLink"},standalone:!0,features:[CV,as]}),e})();class DW{}let dCe=(()=>{var r;class e{constructor(n,i,s,o,a){this.router=n,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(F3(n=>n instanceof el),K8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const s=[];for(const o of i){o.providers&&!o._injector&&(o._injector=LE(o.providers,n,`Route: ${o.path}`));const a=o._injector??n,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return u2(s).pipe(t8())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):Ht(null);const o=s.pipe(ri(a=>null===a?Ht(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??n,a.routes))));return i.loadComponent&&!i._loadedComponent?u2([o,this.loader.loadComponent(i)]).pipe(t8()):o})}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(Un),Oe(W$),Oe(mo),Oe(DW),Oe(IP))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const kP=new et("");let HW=(()=>{var r;class e{constructor(n,i,s,o,a={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof vP?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof el?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Nf&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof uW&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new uW(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){!function jH(){throw new Error("invalid")}()},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function B3(r,e){return{\u0275kind:r,\u0275providers:e}}function FW(){const r=nt(ci);return e=>{const t=r.get(y6);if(e!==t.components[0])return;const n=r.get(Un),i=r.get($W);1===r.get(xP)&&n.initialNavigation(),r.get(BW,null,ln.Optional)?.setUpPreloading(),r.get(kP,null,ln.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const $W=new et("",{factory:()=>new zs}),xP=new et("",{providedIn:"root",factory:()=>1}),BW=new et("");function mCe(r){return B3(0,[{provide:BW,useExisting:dCe},{provide:DW,useExisting:r}])}const GW=new et("ROUTER_FORROOT_GUARD"),vCe=[gS,{provide:Pf,useClass:hP},Un,Af,{provide:qs,useFactory:function VW(r){return r.routerState.root},deps:[Un]},IP,[]];function CCe(){return new rB("Router",Un)}let yCe=(()=>{var r;class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[vCe,[],{provide:o5,multi:!0,useValue:n},{provide:GW,useFactory:PCe,deps:[[Un,new fs,new ep]]},{provide:Kg,useValue:i||{}},i?.useHash?{provide:E6,useClass:che}:{provide:E6,useClass:kB},{provide:kP,useFactory:()=>{const r=nt(Ope),e=nt(u1),t=nt(Kg),n=nt(Yg),i=nt(Pf);return t.scrollOffset&&r.setOffset(t.scrollOffset),new HW(i,n,r,e,t)}},i?.preloadingStrategy?mCe(i.preloadingStrategy).\u0275providers:[],{provide:rB,multi:!0,useFactory:CCe},i?.initialNavigation?OCe(i):[],i?.bindToComponentInputs?B3(8,[_W,{provide:Ug,useExisting:_W}]).\u0275providers:[],[{provide:UW,useFactory:FW},{provide:sS,multi:!0,useExisting:UW}]]}}static forChild(n){return{ngModule:e,providers:[{provide:o5,multi:!0,useValue:n}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(GW,8))},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({}),e})();function PCe(r){return"guarded"}function OCe(r){return["disabled"===r.initialNavigation?B3(3,[{provide:YE,multi:!0,useFactory:()=>{const e=nt(Un);return()=>{e.setUpLocationChangeListener()}}},{provide:xP,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?B3(2,[{provide:xP,useValue:0},{provide:YE,multi:!0,deps:[ci],useFactory:e=>{const t=e.get(ohe,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Un),s=e.get($W);zW(i,()=>{n(!0)}),e.get(Yg).afterPreactivation=()=>(n(!0),s.closed?Ht(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const UW=new et("");class WW{}class bCe{}const G3="*";function qW(r,e=null){return{type:2,steps:r,options:e}}function jW(r){return{type:6,styles:r,offset:null}}class Df{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class ZW{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function YW(r){return new ge(3e3,!1)}function tl(r){switch(r.length){case 0:return new Df;case 1:return r[0];default:return new ZW(r)}}function KW(r,e,t=new Map,n=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),f=l==o,d=f&&a||new Map;c.forEach((m,E)=>{let w=E,R=m;if("offset"!==E)switch(w=r.normalizePropertyName(w,i),R){case"!":R=t.get(E);break;case G3:R=n.get(E);break;default:R=r.normalizeStyleValue(E,w,R,i)}d.set(w,R)}),f||s.push(d),a=d,o=l}),i.length)throw function KCe(r){return new ge(3502,!1)}();return s}function RP(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&zP(t,"start",r)));break;case"done":r.onDone(()=>n(t&&zP(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&zP(t,"destroy",r)))}}function zP(r,e,t){const s=DP(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),o=r._data;return null!=o&&(s._data=o),s}function DP(r,e,t,n,i="",s=0,o){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:s,disabled:!!o}}function Mo(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function XW(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const cye=(()=>typeof document>"u"?null:document.documentElement)();function HP(r){const e=r.parentNode||r.host||null;return e===cye?null:e}let R6=null,QW=!1;function JW(r,e){for(;e;){if(e===r)return!0;e=HP(e)}return!1}function eq(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let tq=(()=>{var r;class e{validateStyleProperty(n){return function uye(r){R6||(R6=function fye(){return typeof document<"u"?document.body:null}()||{},QW=!!R6.style&&"WebkitAppearance"in R6.style);let e=!0;return R6.style&&!function lye(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in R6.style,!e&&QW&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in R6.style)),e}(n)}matchesElement(n,i){return!1}containsElement(n,i){return JW(n,i)}getParentElement(n){return HP(n)}query(n,i,s){return eq(n,i,s)}computeStyle(n,i,s){return s||""}animate(n,i,s,o,a,c=[],l){return new Df(s,o)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),VP=(()=>{class e{}return e.NOOP=new tq,e})();const dye=1e3,FP="ng-enter",Xg="ng-leave",Qg="ng-trigger",Jg=".ng-trigger",rq="ng-animating",$P=".ng-animating";function U3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:BP(parseFloat(e[1]),e[2])}function BP(r,e){return"s"===e?r*dye:r}function em(r,e,t){return r.hasOwnProperty("duration")?r:function pye(r,e,t){let i,s=0,o="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(YW()),{duration:0,delay:0,easing:""};i=BP(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=BP(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function wCe(){return new ge(3100,!1)}()),a=!0),s<0&&(e.push(function NCe(){return new ge(3101,!1)}()),a=!0),a&&e.splice(c,0,YW())}return{duration:i,delay:s,easing:o}}(r,e,t)}function Hf(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function iq(r){const e=new Map;return Object.keys(r).forEach(t=>{e.set(t,r[t])}),e}function nl(r,e=new Map,t){if(t)for(let[n,i]of t)e.set(n,i);for(let[n,i]of r)e.set(n,i);return e}function kc(r,e,t){e.forEach((n,i)=>{const s=UP(i);t&&!t.has(i)&&t.set(i,r.style[s]),r.style[s]=n})}function z6(r,e){e.forEach((t,n)=>{const i=UP(n);r.style[i]=""})}function Vf(r){return Array.isArray(r)?1==r.length?r[0]:qW(r):r}const GP=new RegExp("{{\\s*(.+?)\\s*}}","g");function oq(r){let e=[];if("string"==typeof r){let t;for(;t=GP.exec(r);)e.push(t[1]);GP.lastIndex=0}return e}function Ff(r,e,t){const n=r.toString(),i=n.replace(GP,(s,o)=>{let a=e[o];return null==a&&(t.push(function ICe(r){return new ge(3003,!1)}()),a=""),a.toString()});return i==n?r:i}function tm(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const _ye=/-+([a-z0-9])/g;function UP(r){return r.replace(_ye,(...e)=>e[1].toUpperCase())}function Eo(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function kCe(r){return new ge(3004,!1)}()}}function aq(r,e){return window.getComputedStyle(r)[e]}const nm="*";function yye(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function Mye(r,e,t){if(":"==r[0]){const c=function Eye(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function qCe(r){return new ge(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function WCe(r){return new ge(3015,!1)}()),e;const i=n[1],s=n[2],o=n[3];e.push(cq(i,o));"<"==s[0]&&!(i==nm&&o==nm)&&e.push(cq(o,i))}(n,t,e)):t.push(r),t}const rm=new Set(["true","1"]),im=new Set(["false","0"]);function cq(r,e){const t=rm.has(r)||im.has(r),n=rm.has(e)||im.has(e);return(i,s)=>{let o=r==nm||r==i,a=e==nm||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?rm.has(r):im.has(r)),!a&&n&&"boolean"==typeof s&&(a=s?rm.has(e):im.has(e)),o&&a}}const Sye=new RegExp("s*:selfs*,?","g");function WP(r,e,t,n){return new Pye(r).build(e,t,n)}class Pye{constructor(e){this._driver=e}build(e,t,n){const i=new bye(t);return this._resetContextStyleTimingState(i),Eo(this,Vf(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function LCe(){return new ge(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,s.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push(function RCe(){return new ge(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{oq(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(tm(s.values()),t.errors.push(function zCe(r,e){return new ge(3008,!1)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=Eo(this,Vf(e.animation),t);return{type:1,matchers:yye(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:D6(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>Eo(this,n,t)),options:D6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=n;const a=Eo(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:D6(e.options)}}visitAnimate(e,t){const n=function Nye(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return qP(em(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=qP(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=em(t,e);return qP(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,s=e.styles?e.styles:jW({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};n.easing&&(l.easing=n.easing),o=jW(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===G3?n.push(a):t.errors.push(new ge(3002,!1)):n.push(iq(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),f=l.get(c);let d=!0;f&&(s!=i&&s>=f.startTime&&i<=f.endTime&&(t.errors.push(function HCe(r,e,t,n,i){return new ge(3010,!1)}()),d=!1),s=f.startTime),d&&l.set(c,{startTime:s,endTime:i}),t.options&&function mye(r,e,t){const n=e.params||{},i=oq(r);i.length&&i.forEach(s=>{n.hasOwnProperty(s)||t.push(function ACe(r){return new ge(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function VCe(){return new ge(3011,!1)}()),n;let s=0;const o=[];let a=!1,c=!1,l=0;const f=e.steps.map($=>{const G=this._makeStyleAst($,t);let de=null!=G.offset?G.offset:function wye(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(G.styles),Ce=0;return null!=de&&(s++,Ce=G.offset=de),c=c||Ce<0||Ce>1,a=a||Ce<l,l=Ce,o.push(Ce),G});c&&t.errors.push(function FCe(){return new ge(3012,!1)}()),a&&t.errors.push(function $Ce(){return new ge(3200,!1)}());const d=e.steps.length;let m=0;s>0&&s<d?t.errors.push(function BCe(){return new ge(3202,!1)}()):0==s&&(m=1/(d-1));const E=d-1,w=t.currentTime,R=t.currentAnimateTimings,z=R.duration;return f.forEach(($,G)=>{const de=m>0?G==E?1:m*G:o[G],Ce=de*z;t.currentTime=w+R.delay+Ce,R.duration=Ce,this._validateStyleAst($,t),$.offset=de,n.styles.push($)}),n}visitReference(e,t){return{type:8,animation:Eo(this,Vf(e.animation),t),options:D6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:D6(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:D6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Oye(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(Sye,"")),r=r.replace(/@\*/g,Jg).replace(/@\w+/g,t=>Jg+"-"+t.slice(1)).replace(/:animating/g,$P),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,Mo(t.collectedStyles,t.currentQuerySelector,new Map);const a=Eo(this,Vf(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:D6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function GCe(){return new ge(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:em(e.timings,t.errors,!0);return{type:12,animation:Eo(this,Vf(e.animation),t),timings:n,options:null}}}class bye{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function D6(r){return r?(r=Hf(r)).params&&(r.params=function Tye(r){return r?Hf(r):null}(r.params)):r={},r}function qP(r,e,t){return{duration:r,delay:e,easing:t}}function jP(r,e,t,n,i,s,o=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class sm{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const kye=new RegExp(":enter","g"),Lye=new RegExp(":leave","g");function ZP(r,e,t,n,i,s=new Map,o=new Map,a,c,l=[]){return(new Rye).buildKeyframes(r,e,t,n,i,s,o,a,c,l)}class Rye{buildKeyframes(e,t,n,i,s,o,a,c,l,f=[]){l=l||new sm;const d=new YP(e,t,l,i,s,f,[]);d.options=c;const m=c.delay?U3(c.delay):0;d.currentTimeline.delayNextStep(m),d.currentTimeline.setStyles([o],null,d.errors,c),Eo(this,n,d);const E=d.timelines.filter(w=>w.containsAnimation());if(E.length&&a.size){let w;for(let R=E.length-1;R>=0;R--){const z=E[R];if(z.element===t){w=z;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([a],null,d.errors,c)}return E.length?E.map(w=>w.buildKeyframes()):[jP(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:U3(Ff(s,i?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?U3(n.duration):null,a=null!=n.delay?U3(n.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Eo(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=om);const o=U3(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Eo(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?U3(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Eo(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return em(t.params?Ff(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?U3(i.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=om);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,f)=>{t.currentQueryIndex=f;const d=t.createSubContext(e.options,l);s&&d.delayNextStep(s),l===t.element&&(c=d.currentTimeline),Eo(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const f=t.currentTimeline;c&&f.delayNextStep(c);const d=f.currentTime;Eo(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-d+(i.startTime-n.currentTimeline.startTime)}}const om={};class YP{constructor(e,t,n,i,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=om,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new am(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=U3(n.duration)),null!=n.delay&&(i.delay=U3(n.delay));const s=n.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Ff(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,s=new YP(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=om,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new zye(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(kye,"."+this._enterClassName)).replace(Lye,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!s&&0==a.length&&o.push(function UCe(r){return new ge(3014,!1)}()),a}}class am{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new am(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||G3),this._currentKeyframe.set(t,G3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const s=i&&i.params||{},o=function Dye(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n=n||e.keys();for(let s of n)t.set(s,G3)}else nl(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=Ff(c,s,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??G3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=nl(a,new Map,this._backFill);l.forEach((f,d)=>{"!"===f?e.add(d):f===G3&&t.add(d)}),n||l.set("offset",c/this.duration),i.push(l)});const s=e.size?tm(e.values()):[],o=t.size?tm(t.values()):[];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return jP(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class zye extends am{constructor(e,t,n,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,c=nl(e[0]);c.set("offset",0),s.push(c);const l=nl(e[0]);l.set("offset",fq(a)),s.push(l);const f=e.length-1;for(let d=1;d<=f;d++){let m=nl(e[d]);const E=m.get("offset");m.set("offset",fq((t+E*n)/o)),s.push(m)}n=o,t=0,i="",e=s}return jP(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function fq(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class KP{}const Hye=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Vye extends KP{normalizePropertyName(e,t){return UP(e)}normalizeStyleValue(e,t,n,i){let s="";const o=n.toString().trim();if(Hye.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function xCe(r,e){return new ge(3005,!1)}())}return o+s}}function dq(r,e,t,n,i,s,o,a,c,l,f,d,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:f,totalTime:d,errors:m}}const XP={};class hq{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function Fye(r,e,t,n,i){return r.some(s=>s(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,s,o,a,c,l,f){const d=[],m=this.ast.options&&this.ast.options.params||XP,w=this.buildStyles(n,a&&a.params||XP,d),R=c&&c.params||XP,z=this.buildStyles(i,R,d),$=new Set,G=new Map,de=new Map,Ce="void"===i,Le={params:$ye(R,m),delay:this.ast.options?.delay},tt=f?[]:ZP(e,t,this.ast.animation,s,o,w,z,Le,l,d);let gt=0;if(tt.forEach(Et=>{gt=Math.max(Et.duration+Et.delay,gt)}),d.length)return dq(t,this._triggerName,n,i,Ce,w,z,[],[],G,de,gt,d);tt.forEach(Et=>{const ti=Et.element,Y0=Mo(G,ti,new Set);Et.preStyleProps.forEach(g3=>Y0.add(g3));const Xl=Mo(de,ti,new Set);Et.postStyleProps.forEach(g3=>Xl.add(g3)),ti!==t&&$.add(ti)});const yn=tm($.values());return dq(t,this._triggerName,n,i,Ce,w,z,tt,yn,G,de,gt)}}function $ye(r,e){const t=Hf(e);for(const n in r)r.hasOwnProperty(n)&&null!=r[n]&&(t[n]=r[n]);return t}class Bye{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=Hf(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Ff(o,i,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),n.set(a,o)})}),n}}class Uye{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new Bye(i.style,i.options&&i.options.params||{},n))}),pq(this.states,"true","1"),pq(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new hq(e,i,this.states))}),this.fallbackTransition=function Wye(r,e,t){return new hq(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(o=>o.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function pq(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const qye=new sm;class jye{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=WP(this._driver,t,n,[]);if(n.length)throw function XCe(r){return new ge(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const i=e.element,s=KW(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=ZP(this._driver,t,s,FP,Xg,new Map,new Map,n,qye,i),o.forEach(f=>{const d=Mo(a,f.element,new Map);f.postStyleProps.forEach(m=>d.set(m,null))})):(i.push(function QCe(){return new ge(3300,!1)}()),o=[]),i.length)throw function JCe(r){return new ge(3504,!1)}();a.forEach((f,d)=>{f.forEach((m,E)=>{f.set(E,this._driver.computeStyle(d,E,G3))})});const l=tl(o.map(f=>{const d=a.get(f.element);return this._buildPlayer(f,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function eye(r){return new ge(3301,!1)}();return t}listen(e,t,n,i){const s=DP(t,"","","");return RP(this._getPlayer(e),n,s,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const gq="ng-animate-queued",QP="ng-animate-disabled",Qye=[],mq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Jye={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},xa="__ng_removed";class JP{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function rMe(r){return r??null}(n?e.value:e),n){const s=Hf(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const $f="void",eO=new JP($f);class eMe{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Yo(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function tye(r,e){return new ge(3302,!1)}();if(null==n||0==n.length)throw function nye(r){return new ge(3303,!1)}();if(!function iMe(r){return"start"==r||"done"==r}(n))throw function rye(r,e){return new ge(3400,!1)}();const s=Mo(this._elementListeners,e,[]),o={name:t,phase:n,callback:i};s.push(o);const a=Mo(this._engine.statesByElement,e,new Map);return a.has(t)||(Yo(e,Qg),Yo(e,Qg+"-"+t),a.set(t,eO)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function iye(r){return new ge(3401,!1)}();return t}trigger(e,t,n,i=!0){const s=this._getTrigger(t),o=new tO(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Yo(e,Qg),Yo(e,Qg+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new JP(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=eO),l.value!==$f&&c.value===l.value){if(!function aMe(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||r[s]!==e[s])return!1}return!0}(c.params,l.params)){const R=[],z=s.matchStyles(c.value,c.params,R),$=s.matchStyles(l.value,l.params,R);R.length?this._engine.reportError(R):this._engine.afterFlush(()=>{z6(e,z),kc(e,$)})}return}const m=Mo(this._engine.playersByElement,e,[]);m.forEach(R=>{R.namespaceId==this.id&&R.triggerName==t&&R.queued&&R.destroy()});let E=s.matchTransition(c.value,l.value,e,l.params),w=!1;if(!E){if(!i)return;E=s.fallbackTransition,w=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:c,toState:l,player:o,isFallbackTransition:w}),w||(Yo(e,gq),o.onStart(()=>{a5(e,gq)})),o.onDone(()=>{let R=this.players.indexOf(o);R>=0&&this.players.splice(R,1);const z=this._engine.playersByElement.get(e);if(z){let $=z.indexOf(o);$>=0&&z.splice($,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Jg,!0);n.forEach(i=>{if(i[xa])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const f=this.trigger(e,l,$f,i);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&tl(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const c=this._triggers.get(o).fallbackTransition,l=n.get(o)||eO,f=new JP($f),d=new tO(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:f,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[xa];(!s||s===mq)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Yo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const c=DP(s,n.triggerName,n.fromState.value,n.toState.value);c._data=e,RP(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const s=n.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class tMe{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new eMe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,i){if(cm(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!cm(t))return;const s=t[xa];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Yo(e,QP)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),a5(e,QP))}removeNode(e,t,n){if(cm(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,s){this.collectedLeaveElements.push(t),t[xa]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,i,s){return cm(t)?this._fetchNamespace(e).listen(t,n,i,s):()=>{}}_buildInstruction(e,t,n,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Jg,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,$P,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return tl(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[xa];if(t&&t.setForRemoval){if(e[xa]=mq,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(QP)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Yo(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?tl(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function sye(r){return new ge(3402,!1)}()}_flushAnimations(e,t){const n=new sm,i=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,f=new Set;this.disabledNodes.forEach(dt=>{f.add(dt);const Tt=this.driver.query(dt,".ng-animate-queued",!0);for(let kt=0;kt<Tt.length;kt++)f.add(Tt[kt])});const d=this.bodyNode,m=Array.from(this.statesByElement.keys()),E=Cq(m,this.collectedEnterElements),w=new Map;let R=0;E.forEach((dt,Tt)=>{const kt=FP+R++;w.set(Tt,kt),dt.forEach(An=>Yo(An,kt))});const z=[],$=new Set,G=new Set;for(let dt=0;dt<this.collectedLeaveElements.length;dt++){const Tt=this.collectedLeaveElements[dt],kt=Tt[xa];kt&&kt.setForRemoval&&(z.push(Tt),$.add(Tt),kt.hasAnimation?this.driver.query(Tt,".ng-star-inserted",!0).forEach(An=>$.add(An)):G.add(Tt))}const de=new Map,Ce=Cq(m,Array.from($));Ce.forEach((dt,Tt)=>{const kt=Xg+R++;de.set(Tt,kt),dt.forEach(An=>Yo(An,kt))}),e.push(()=>{E.forEach((dt,Tt)=>{const kt=w.get(Tt);dt.forEach(An=>a5(An,kt))}),Ce.forEach((dt,Tt)=>{const kt=de.get(Tt);dt.forEach(An=>a5(An,kt))}),z.forEach(dt=>{this.processLeaveNode(dt)})});const Le=[],tt=[];for(let dt=this._namespaceList.length-1;dt>=0;dt--)this._namespaceList[dt].drainQueuedTransitions(t).forEach(kt=>{const An=kt.player,Nt=kt.element;if(Le.push(An),this.collectedEnterElements.length){const is=Nt[xa];if(is&&is.setForMove){if(is.previousTriggersValues&&is.previousTriggersValues.has(kt.triggerName)){const K0=is.previousTriggersValues.get(kt.triggerName),ya=this.statesByElement.get(kt.element);if(ya&&ya.has(kt.triggerName)){const hy=ya.get(kt.triggerName);hy.value=K0,ya.set(kt.triggerName,hy)}}return void An.destroy()}}const m3=!d||!this.driver.containsElement(d,Nt),Ho=de.get(Nt),Ql=w.get(Nt),yr=this._buildInstruction(kt,n,Ql,Ho,m3);if(yr.errors&&yr.errors.length)return void tt.push(yr);if(m3)return An.onStart(()=>z6(Nt,yr.fromStyles)),An.onDestroy(()=>kc(Nt,yr.toStyles)),void i.push(An);if(kt.isFallbackTransition)return An.onStart(()=>z6(Nt,yr.fromStyles)),An.onDestroy(()=>kc(Nt,yr.toStyles)),void i.push(An);const W4e=[];yr.timelines.forEach(is=>{is.stretchStartingKeyframe=!0,this.disabledNodes.has(is.element)||W4e.push(is)}),yr.timelines=W4e,n.append(Nt,yr.timelines),o.push({instruction:yr,player:An,element:Nt}),yr.queriedElements.forEach(is=>Mo(a,is,[]).push(An)),yr.preStyleProps.forEach((is,K0)=>{if(is.size){let ya=c.get(K0);ya||c.set(K0,ya=new Set),is.forEach((hy,FR)=>ya.add(FR))}}),yr.postStyleProps.forEach((is,K0)=>{let ya=l.get(K0);ya||l.set(K0,ya=new Set),is.forEach((hy,FR)=>ya.add(FR))})});if(tt.length){const dt=[];tt.forEach(Tt=>{dt.push(function oye(r,e){return new ge(3505,!1)}())}),Le.forEach(Tt=>Tt.destroy()),this.reportError(dt)}const gt=new Map,yn=new Map;o.forEach(dt=>{const Tt=dt.element;n.has(Tt)&&(yn.set(Tt,Tt),this._beforeAnimationBuild(dt.player.namespaceId,dt.instruction,gt))}),i.forEach(dt=>{const Tt=dt.element;this._getPreviousPlayers(Tt,!1,dt.namespaceId,dt.triggerName,null).forEach(An=>{Mo(gt,Tt,[]).push(An),An.destroy()})});const Et=z.filter(dt=>Mq(dt,c,l)),ti=new Map;vq(ti,this.driver,G,l,G3).forEach(dt=>{Mq(dt,c,l)&&Et.push(dt)});const Xl=new Map;E.forEach((dt,Tt)=>{vq(Xl,this.driver,new Set(dt),c,"!")}),Et.forEach(dt=>{const Tt=ti.get(dt),kt=Xl.get(dt);ti.set(dt,new Map([...Tt?.entries()??[],...kt?.entries()??[]]))});const g3=[],gh=[],mh={};o.forEach(dt=>{const{element:Tt,player:kt,instruction:An}=dt;if(n.has(Tt)){if(f.has(Tt))return kt.onDestroy(()=>kc(Tt,An.toStyles)),kt.disabled=!0,kt.overrideTotalTime(An.totalTime),void i.push(kt);let Nt=mh;if(yn.size>1){let Ho=Tt;const Ql=[];for(;Ho=Ho.parentNode;){const yr=yn.get(Ho);if(yr){Nt=yr;break}Ql.push(Ho)}Ql.forEach(yr=>yn.set(yr,Nt))}const m3=this._buildAnimation(kt.namespaceId,An,gt,s,Xl,ti);if(kt.setRealPlayer(m3),Nt===mh)g3.push(kt);else{const Ho=this.playersByElement.get(Nt);Ho&&Ho.length&&(kt.parentPlayer=tl(Ho)),i.push(kt)}}else z6(Tt,An.fromStyles),kt.onDestroy(()=>kc(Tt,An.toStyles)),gh.push(kt),f.has(Tt)&&i.push(kt)}),gh.forEach(dt=>{const Tt=s.get(dt.element);if(Tt&&Tt.length){const kt=tl(Tt);dt.setRealPlayer(kt)}}),i.forEach(dt=>{dt.parentPlayer?dt.syncPlayerEvents(dt.parentPlayer):dt.destroy()});for(let dt=0;dt<z.length;dt++){const Tt=z[dt],kt=Tt[xa];if(a5(Tt,Xg),kt&&kt.hasAnimation)continue;let An=[];if(a.size){let m3=a.get(Tt);m3&&m3.length&&An.push(...m3);let Ho=this.driver.query(Tt,$P,!0);for(let Ql=0;Ql<Ho.length;Ql++){let yr=a.get(Ho[Ql]);yr&&yr.length&&An.push(...yr)}}const Nt=An.filter(m3=>!m3.destroyed);Nt.length?sMe(this,Tt,Nt):this.processLeaveNode(Tt)}return z.length=0,g3.forEach(dt=>{this.players.push(dt),dt.onDone(()=>{dt.destroy();const Tt=this.players.indexOf(dt);this.players.splice(Tt,1)}),dt.play()}),g3}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==$f;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||o.push(l)})}}return(n||i)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,f=l!==s,d=Mo(n,l,[]);this._getPreviousPlayers(l,f,o,a,t.toState).forEach(E=>{const w=E.getRealPlayer();w.beforeDestroy&&w.beforeDestroy(),E.destroy(),d.push(E)})}z6(s,t.fromStyles)}_buildAnimation(e,t,n,i,s,o){const a=t.triggerName,c=t.element,l=[],f=new Set,d=new Set,m=t.timelines.map(w=>{const R=w.element;f.add(R);const z=R[xa];if(z&&z.removedBeforeQueried)return new Df(w.duration,w.delay);const $=R!==c,G=function oMe(r){const e=[];return yq(r,e),e}((n.get(R)||Qye).map(gt=>gt.getRealPlayer())).filter(gt=>!!gt.element&&gt.element===R),de=s.get(R),Ce=o.get(R),Le=KW(this._normalizer,w.keyframes,de,Ce),tt=this._buildPlayer(w,Le,G);if(w.subTimeline&&i&&d.add(R),$){const gt=new tO(e,a,R);gt.setRealPlayer(tt),l.push(gt)}return tt});l.forEach(w=>{Mo(this.playersByQueriedElement,w.element,[]).push(w),w.onDone(()=>function nMe(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,w.element,w))}),f.forEach(w=>Yo(w,rq));const E=tl(m);return E.onDestroy(()=>{f.forEach(w=>a5(w,rq)),kc(c,t.toStyles)}),d.forEach(w=>{Mo(i,w,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Df(e.duration,e.delay)}}class tO{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Df,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>RP(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Mo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function cm(r){return r&&1===r.nodeType}function _q(r,e){const t=r.style.display;return r.style.display=e??"none",t}function vq(r,e,t,n,i){const s=[];t.forEach(c=>s.push(_q(c)));const o=[];n.forEach((c,l)=>{const f=new Map;c.forEach(d=>{const m=e.computeStyle(l,d,i);f.set(d,m),(!m||0==m.length)&&(l[xa]=Jye,o.push(l))}),r.set(l,f)});let a=0;return t.forEach(c=>_q(c,s[a++])),o}function Cq(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);1!==c&&t.get(c).push(a)}),t}function Yo(r,e){r.classList?.add(e)}function a5(r,e){r.classList?.remove(e)}function sMe(r,e,t){tl(t).onDone(()=>r.processLeaveNode(e))}function yq(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof ZW?yq(n.players,e):e.push(n)}}function Mq(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(s=>i.add(s)):e.set(r,n),t.delete(r),!0}class lm{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new tMe(e,t,n),this._timelineEngine=new jye(e,t,n),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,n,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const c=[],f=WP(this._driver,s,c,[]);if(c.length)throw function YCe(r,e){return new ge(3404,!1)}();a=function Gye(r,e,t){return new Uye(r,e,t)}(i,f,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[s,o]=XW(n);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,s){if("@"==n.charAt(0)){const[o,a]=XW(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let lMe=(()=>{class e{constructor(n,i,s){this._element=n,this._startStyles=i,this._endStyles=s,this._state=0;let o=e.initialStylesByElement.get(n);o||e.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&kc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(kc(this._element,this._initialStyles),this._endStyles&&(kc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(z6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(z6(this._element,this._endStyles),this._endStyles=null),kc(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function nO(r){let e=null;return r.forEach((t,n)=>{(function uMe(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class Eq{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:aq(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class fMe{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return JW(e,t)}getParentElement(e){return HP(e)}query(e,t,n){return eq(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,s,o=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};s&&(c.easing=s);const l=new Map,f=o.filter(E=>E instanceof Eq);(function vye(r,e){return 0===r||0===e})(n,i)&&f.forEach(E=>{E.currentSnapshot.forEach((w,R)=>l.set(R,w))});let d=function gye(r){return r.length?r[0]instanceof Map?r:r.map(e=>iq(e)):[]}(t).map(E=>nl(E));d=function Cye(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((s,o)=>{n.has(o)||i.push(o),n.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,aq(r,a)))}}return e}(e,d,l);const m=function cMe(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=nO(e[0]),e.length>1&&(n=nO(e[e.length-1]))):e instanceof Map&&(t=nO(e)),t||n?new lMe(r,t,n):null}(e,d);return new Eq(e,d,c,m)}}let dMe=(()=>{var r;class e extends WW{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:Go.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(n)?qW(n):n;return Sq(this._renderer,null,i,"register",[s]),new hMe(i,this._renderer)}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(x7),Oe(L2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class hMe extends bCe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new pMe(this._id,e,t||{},this._renderer)}}class pMe{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Sq(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function Sq(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const Pq="@.disabled";let gMe=(()=>{var r;class e{constructor(n,i,s){this.delegate=n,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(o,a)=>{const c=a?.parentNode(o);c&&a.removeChild(c,o)}}createRenderer(n,i){const o=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(o);return d||(d=new Oq("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,d)),d}const a=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,n);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(a,c,n,d.name,d)};return i.data.animation.forEach(l),new mMe(this,c,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,s){n>=0&&n<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(x7),Oe(lm),Oe(u1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class Oq{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==Pq?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class mMe extends Oq{constructor(e,t,n,i,s){super(t,n,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==Pq?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function _Me(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function vMe(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let CMe=(()=>{var r;class e extends lm{constructor(n,i,s,o){super(n.body,i,s)}ngOnDestroy(){this.flush()}}return(r=e).\u0275fac=function(n){return new(n||r)(Oe(L2),Oe(VP),Oe(KP),Oe(y6))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const Tq=[{provide:WW,useClass:dMe},{provide:KP,useFactory:function yMe(){return new Vye}},{provide:lm,useClass:CMe},{provide:x7,useFactory:function MMe(r,e,t){return new gMe(r,e,t)},deps:[DS,lm,u1]}],rO=[{provide:VP,useFactory:()=>new fMe},{provide:yH,useValue:"BrowserAnimations"},...Tq],bq=[{provide:VP,useClass:tq},{provide:yH,useValue:"NoopAnimations"},...Tq];let EMe=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?bq:rO}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({providers:rO,imports:[mG]}),e})();const $r=void 0,PMe=["fr",[["AM","PM"],$r,$r],$r,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],$r,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],$r,[["av. J.-C.","ap. J.-C."],$r,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",$r],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[$r,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[$r,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[$r,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[$r,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[$r,"\xa5"],KMF:[$r,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[$r,"$C"],NZD:["$NZ","$"],PHP:[$r,"\u20b1"],RHD:["$RH"],RON:[$r,"L"],RWF:[$r,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[$r,"$T"],TTD:["$TT","$"],TWD:[$r,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[$r,"$"],XPF:["FCFP"],ZMW:[$r,"Kw"]},"ltr",function SMe(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function wq(r,e,t,n,i,s,o){try{var a=r[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function M(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function o(c){wq(s,n,i,o,a,"next",c)}function a(c){wq(s,n,i,o,a,"throw",c)}o(void 0)})}}const Nq=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},sO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,a=o?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let m=(15&a)<<2|l>>6,E=63&l;c||(E=64,o||(m=64)),n.push(t[s>>2],t[(3&s)<<4|a>>4],t[m],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Nq(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,null==s||null==a||null==l||null==d)throw new wMe;n.push(s<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==d&&n.push(l<<6&192|d))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class wMe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fm=function(r){return function(r){const e=Nq(r);return sO.encodeByteArray(e,!0)}(r).replace(/\./g,"")},dm=function(r){try{return sO.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},hm=()=>{try{return function IMe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&dm(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},Iq=r=>{var e,t;return null===(t=null===(e=hm())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},kq=()=>{var r;return null===(r=hm())||void 0===r?void 0:r.config},xq=r=>{var e;return null===(e=hm())||void 0===e?void 0:e[`_${r}`]};class pm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function R2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function oO(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function H6(){try{return"object"==typeof indexedDB}catch{return!1}}function Bf(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e((null===(s=i.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}function aO(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class So extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,So.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xc.prototype.create)}}class xc{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function BMe(r,e){return r.replace(GMe,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(s,n):"Error";return new So(i,`${this.serviceName}: ${o} (${i}).`,n)}}const GMe=/\{\$([^}]+)}/g;function mm(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(Rq(s)&&Rq(o)){if(!mm(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Rq(r){return null!==r&&"object"==typeof r}function Gf(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Uf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Wf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class qMe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function jMe(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=cO),void 0===i.error&&(i.error=cO),void 0===i.complete&&(i.complete=cO);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cO(){}const ZMe=1e3,YMe=2,KMe=144e5,XMe=.5;function uO(r,e=ZMe,t=YMe){const n=e*Math.pow(t,r),i=Math.round(XMe*n*(Math.random()-.5)*2);return Math.min(KMe,n+i)}function Sr(r){return r&&r._delegate?r._delegate:r}class Vi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const V6="[DEFAULT]";class JMe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new pm;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function tEe(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:V6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=V6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return M(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=V6){return this.instances.has(e)}getOptions(e=V6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===V6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=V6){return this.component?this.component.multipleInstances?e:V6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class nEe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new JMe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const fO=[];var Wn=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Wn||{});const zq={debug:Wn.DEBUG,verbose:Wn.VERBOSE,info:Wn.INFO,warn:Wn.WARN,error:Wn.ERROR,silent:Wn.SILENT},rEe=Wn.INFO,iEe={[Wn.DEBUG]:"log",[Wn.VERBOSE]:"log",[Wn.INFO]:"info",[Wn.WARN]:"warn",[Wn.ERROR]:"error"},sEe=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=iEe[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class c5{constructor(e){this.name=e,this._logLevel=rEe,this._logHandler=sEe,this._userLogHandler=null,fO.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?zq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wn.DEBUG,...e),this._logHandler(this,Wn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wn.VERBOSE,...e),this._logHandler(this,Wn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wn.INFO,...e),this._logHandler(this,Wn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wn.WARN,...e),this._logHandler(this,Wn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wn.ERROR,...e),this._logHandler(this,Wn.ERROR,...e)}}const oEe=(r,e)=>e.some(t=>r instanceof t);let Dq,Hq;const Vq=new WeakMap,dO=new WeakMap,Fq=new WeakMap,hO=new WeakMap,pO=new WeakMap;let gO={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return dO.get(r);if("objectStoreNames"===e)return r.objectStoreNames||Fq.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return rl(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function hEe(r){return"function"==typeof r?function dEe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function cEe(){return Hq||(Hq=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(mO(this),e),rl(Vq.get(this))}:function(...e){return rl(r.apply(mO(this),e))}:function(e,...t){const n=r.call(mO(this),e,...t);return Fq.set(n,e.sort?e.sort():[e]),rl(n)}}(r):(r instanceof IDBTransaction&&function uEe(r){if(dO.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});dO.set(r,e)}(r),oEe(r,function aEe(){return Dq||(Dq=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,gO):r)}function rl(r){if(r instanceof IDBRequest)return function lEe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(rl(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Vq.set(t,r)}).catch(()=>{}),pO.set(e,r),e}(r);if(hO.has(r))return hO.get(r);const e=hEe(r);return e!==r&&(hO.set(r,e),pO.set(e,r)),e}const mO=r=>pO.get(r),gEe=["get","getKey","getAll","getAllKeys","count"],mEe=["put","add","delete","clear"],_O=new Map;function $q(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(_O.get(e))return _O.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=mEe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!gEe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return _O.set(e,s),s}!function fEe(r){gO=r(gO)}(r=>({...r,get:(e,t,n)=>$q(e,t)||r.get(e,t,n),has:(e,t)=>!!$q(e,t)||r.has(e,t)}));class _Ee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function vEe(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const vO="@firebase/app",F6=new c5("@firebase/app"),_m="[DEFAULT]",UEe={[vO]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},$6=new Map,vm=new Map;function WEe(r,e){try{r.container.addComponent(e)}catch(t){F6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ms(r){const e=r.name;if(vm.has(e))return F6.debug(`There were multiple attempts to register component ${e}.`),!1;vm.set(e,r);for(const t of $6.values())WEe(t,r);return!0}function l5(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const W3=new xc("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class jEe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Vi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw W3.create("app-deleted",{appName:this._name})}}const B6="9.23.0";function Gq(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:_m,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw W3.create("bad-app-name",{appName:String(i)});if(t||(t=kq()),!t)throw W3.create("no-options");const s=$6.get(i);if(s){if(mm(t,s.options)&&mm(n,s.config))return s;throw W3.create("duplicate-app",{appName:i})}const o=new nEe(i);for(const c of vm.values())o.addComponent(c);const a=new jEe(t,n,o);return $6.set(i,a),a}function CO(r=_m){const e=$6.get(r);if(!e&&r===_m&&kq())return Gq();if(!e)throw W3.create("no-app",{appName:r});return e}function Uq(){return Array.from($6.values())}function Pr(r,e,t){var n;let i=null!==(n=UEe[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];return s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void F6.warn(a.join(" "))}ms(new Vi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const ZEe="firebase-heartbeat-database",YEe=1,qf="firebase-heartbeat-store";let MO=null;function Wq(){return MO||(MO=function pEe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=rl(o);return n&&o.addEventListener("upgradeneeded",c=>{n(rl(o.result),c.oldVersion,c.newVersion,rl(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(ZEe,YEe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(qf)}}).catch(r=>{throw W3.create("idb-open",{originalErrorMessage:r.message})})),MO}function EO(){return(EO=M(function*(r){try{return yield(yield Wq()).transaction(qf).objectStore(qf).get(jq(r))}catch(e){if(e instanceof So)F6.warn(e.message);else{const t=W3.create("idb-get",{originalErrorMessage:e?.message});F6.warn(t.message)}}})).apply(this,arguments)}function qq(r,e){return SO.apply(this,arguments)}function SO(){return(SO=M(function*(r,e){try{const n=(yield Wq()).transaction(qf,"readwrite");yield n.objectStore(qf).put(e,jq(r)),yield n.done}catch(t){if(t instanceof So)F6.warn(t.message);else{const n=W3.create("idb-set",{originalErrorMessage:t?.message});F6.warn(n.message)}}})).apply(this,arguments)}function jq(r){return`${r.name}!${r.options.appId}`}class JEe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tSe(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return M(function*(){const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Zq();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(s=>s.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return M(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=Zq(),{heartbeatsToSend:n,unsentEntries:i}=function eSe(r,e=1024){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Yq(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Yq(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),s=fm(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function Zq(){return(new Date).toISOString().substring(0,10)}class tSe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return M(function*(){return!!H6()&&Bf().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return M(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function KEe(r){return EO.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return qq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return qq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function Yq(r){return fm(JSON.stringify({version:2,heartbeats:r})).length}!function nSe(r){ms(new Vi("platform-logger",e=>new _Ee(e),"PRIVATE")),ms(new Vi("heartbeat",e=>new JEe(e),"PRIVATE")),Pr(vO,"0.9.13",r),Pr(vO,"0.9.13","esm2017"),Pr("fire-js","")}("");var Qe,rSe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},La={},PO=PO||{},Qt=rSe||self;function Cm(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function jf(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var OO="closure_uid_"+(1e9*Math.random()>>>0),sSe=0;function oSe(r,e,t){return r.call.apply(r.bind,arguments)}function aSe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function Fi(r,e,t){return(Fi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oSe:aSe).apply(null,arguments)}function ym(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function z2(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(n,o)}}function il(){this.s=this.s,this.o=this.o}il.prototype.s=!1,il.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function iSe(r){Object.prototype.hasOwnProperty.call(r,OO)&&r[OO]||(r[OO]=++sSe)}(this)},il.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Kq=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function TO(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function Xq(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(Cm(n)){const i=r.length||0,s=n.length||0;r.length=i+s;for(let o=0;o<s;o++)r[i+o]=n[o]}else r.push(n)}}function $i(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}$i.prototype.h=function(){this.defaultPrevented=!0};var lSe=function(){if(!Qt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{Qt.addEventListener("test",()=>{},e),Qt.removeEventListener("test",()=>{},e)}catch{}return r}();function Zf(r){return/^[\s\xa0]*$/.test(r)}function Mm(){var r=Qt.navigator;return r&&(r=r.userAgent)?r:""}function Lc(r){return-1!=Mm().indexOf(r)}function bO(r){return bO[" "](r),r}bO[" "]=function(){};var NO,r,fSe=Lc("Opera"),u5=Lc("Trident")||Lc("MSIE"),Qq=Lc("Edge"),wO=Qq||u5,Jq=Lc("Gecko")&&!(-1!=Mm().toLowerCase().indexOf("webkit")&&!Lc("Edge"))&&!(Lc("Trident")||Lc("MSIE"))&&!Lc("Edge"),dSe=-1!=Mm().toLowerCase().indexOf("webkit")&&!Lc("Edge");function ej(){var r=Qt.document;return r?r.documentMode:void 0}e:{var AO="",IO=(r=Mm(),Jq?/rv:([^\);]+)(\)|;)/.exec(r):Qq?/Edge\/([\d\.]+)/.exec(r):u5?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):dSe?/WebKit\/(\S+)/.exec(r):fSe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(IO&&(AO=IO?IO[1]:""),u5){var kO=ej();if(null!=kO&&kO>parseFloat(AO)){NO=String(kO);break e}}NO=AO}var hSe=Qt.document&&u5&&(ej()||parseInt(NO,10))||void 0;function Yf(r,e){if($i.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(Jq){e:{try{bO(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:pSe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Yf.$.h.call(this)}}z2(Yf,$i);var pSe={2:"touch",3:"pen",4:"mouse"};Yf.prototype.h=function(){Yf.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Kf="closure_listenable_"+(1e6*Math.random()|0),gSe=0;function mSe(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++gSe,this.fa=this.ia=!1}function Em(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function LO(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function nj(r){const e={};for(const t in r)e[t]=r[t];return e}const rj="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ij(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let s=0;s<rj.length;s++)t=rj[s],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function Sm(r){this.src=r,this.g={},this.h=0}function RO(r,e){var t=e.type;if(t in r.g){var s,n=r.g[t],i=Kq(n,e);(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(Em(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function zO(r,e,t,n){for(var i=0;i<r.length;++i){var s=r[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==n)return i}return-1}Sm.prototype.add=function(r,e,t,n,i){var s=r.toString();(r=this.g[s])||(r=this.g[s]=[],this.h++);var o=zO(r,e,n,i);return-1<o?(e=r[o],t||(e.ia=!1)):((e=new mSe(e,this.src,s,!!n,i)).ia=t,r.push(e)),e};var DO="closure_lm_"+(1e6*Math.random()|0),HO={};function sj(r,e,t,n,i){if(n&&n.once)return aj(r,e,t,n,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)sj(r,e[s],t,n,i);return null}return t=BO(t),r&&r[Kf]?r.O(e,t,jf(n)?!!n.capture:!!n,i):oj(r,e,t,!1,n,i)}function oj(r,e,t,n,i,s){if(!e)throw Error("Invalid event type");var o=jf(i)?!!i.capture:!!i,a=FO(r);if(a||(r[DO]=a=new Sm(r)),(t=a.add(e,t,n,o,s)).proxy)return t;if(n=function vSe(){const e=CSe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)lSe||(i=o),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(lj(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function aj(r,e,t,n,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)aj(r,e[s],t,n,i);return null}return t=BO(t),r&&r[Kf]?r.P(e,t,jf(n)?!!n.capture:!!n,i):oj(r,e,t,!0,n,i)}function cj(r,e,t,n,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)cj(r,e[s],t,n,i);else n=jf(n)?!!n.capture:!!n,t=BO(t),r&&r[Kf]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=zO(s=r.g[e],t,n,i))&&(Em(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete r.g[e],r.h--))):r&&(r=FO(r))&&(e=r.g[e.toString()],r=-1,e&&(r=zO(e,t,n,i)),(t=-1<r?e[r]:null)&&VO(t))}function VO(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[Kf])RO(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(lj(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=FO(e))?(RO(t,r),0==t.h&&(t.src=null,e[DO]=null)):Em(r)}}}function lj(r){return r in HO?HO[r]:HO[r]="on"+r}function CSe(r,e){if(r.fa)r=!0;else{e=new Yf(e,this);var t=r.listener,n=r.la||r.src;r.ia&&VO(r),r=t.call(n,e)}return r}function FO(r){return(r=r[DO])instanceof Sm?r:null}var $O="__closure_events_fn_"+(1e9*Math.random()>>>0);function BO(r){return"function"==typeof r?r:(r[$O]||(r[$O]=function(e){return r.handleEvent(e)}),r[$O])}function D2(){il.call(this),this.i=new Sm(this),this.S=this,this.J=null}function ui(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new $i(e,r);else if(e instanceof $i)e.target=e.target||r;else{var i=e;ij(e=new $i(n,r),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=Pm(o,n,!0,e)&&i}if(i=Pm(o=e.g=r,n,!0,e)&&i,i=Pm(o,n,!1,e)&&i,t)for(s=0;s<t.length;s++)i=Pm(o=e.g=t[s],n,!1,e)&&i}function Pm(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&RO(r.i,o),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}z2(D2,il),D2.prototype[Kf]=!0,D2.prototype.removeEventListener=function(r,e,t,n){cj(this,r,e,t,n)},D2.prototype.N=function(){if(D2.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)Em(t[n]);delete r.g[e],r.h--}}this.J=null},D2.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},D2.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var GO=Qt.JSON.stringify;function MSe(){var r=UO;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var uj=new class ySe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new SSe,r=>r.reset());class SSe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function PSe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function OSe(r){Qt.setTimeout(()=>{throw r},0)}let Xf,Qf=!1,UO=new class ESe{constructor(){this.h=this.g=null}add(e,t){const n=uj.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},fj=()=>{const r=Qt.Promise.resolve(void 0);Xf=()=>{r.then(TSe)}};var TSe=()=>{for(var r;r=MSe();){try{r.h.call(r.g)}catch(t){OSe(t)}var e=uj;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}Qf=!1};function Om(r,e){D2.call(this),this.h=r||1,this.g=e||Qt,this.j=Fi(this.qb,this),this.l=Date.now()}function WO(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function qO(r,e,t){if("function"==typeof r)t&&(r=Fi(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=Fi(r.handleEvent,r)}return 2147483647<Number(e)?-1:Qt.setTimeout(r,e||0)}function dj(r){r.g=qO(()=>{r.g=null,r.i&&(r.i=!1,dj(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}z2(Om,D2),(Qe=Om.prototype).ga=!1,Qe.T=null,Qe.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ui(this,"tick"),this.ga&&(WO(this),this.start()))}},Qe.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Qe.N=function(){Om.$.N.call(this),WO(this),delete this.g};class bSe extends il{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:dj(this)}N(){super.N(),this.g&&(Qt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jf(r){il.call(this),this.h=r,this.g={}}z2(Jf,il);var hj=[];function pj(r,e,t,n){Array.isArray(t)||(t&&(hj[0]=t.toString()),t=hj);for(var i=0;i<t.length;i++){var s=sj(e,t[i],n||r.handleEvent,!1,r.h||r);if(!s)break;r.g[s.key]=s}}function gj(r){LO(r.g,function(e,t){this.g.hasOwnProperty(t)&&VO(e)},r),r.g={}}function Tm(){this.g=!0}function f5(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function ISe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return GO(t)}catch{return e}}(r,t)+(n?" "+n:"")})}Jf.prototype.N=function(){Jf.$.N.call(this),gj(this)},Jf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Tm.prototype.Ea=function(){this.g=!1},Tm.prototype.info=function(){};var G6={},mj=null;function bm(){return mj=mj||new D2}function _j(r){$i.call(this,G6.Ta,r)}function e9(r){const e=bm();ui(e,new _j(e))}function vj(r,e){$i.call(this,G6.STAT_EVENT,r),this.stat=e}function _s(r){const e=bm();ui(e,new vj(e,r))}function Cj(r,e){$i.call(this,G6.Ua,r),this.size=e}function t9(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Qt.setTimeout(function(){r()},e)}G6.Ta="serverreachability",z2(_j,$i),G6.STAT_EVENT="statevent",z2(vj,$i),G6.Ua="timingevent",z2(Cj,$i);var wm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},yj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function jO(){}function Ej(){}jO.prototype.h=null;var KO,n9={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ZO(){$i.call(this,"d")}function YO(){$i.call(this,"c")}function Nm(){}function r9(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new Jf(this),this.P=kSe,this.V=new Om(r=wO?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Sj}function Sj(){this.i=null,this.g="",this.h=!1}z2(ZO,$i),z2(YO,$i),z2(Nm,jO),Nm.prototype.g=function(){return new XMLHttpRequest},Nm.prototype.i=function(){return{}},KO=new Nm;var kSe=45e3,XO={},Am={};function QO(r,e,t){r.L=1,r.v=Lm(q3(e)),r.s=t,r.S=!0,Pj(r,null)}function Pj(r,e){r.G=Date.now(),i9(r),r.A=q3(r.v);var t=r.A,n=r.W;Array.isArray(n)||(n=[String(n)]),Lj(t.i,"t",n),r.C=0,t=r.l.J,r.h=new Sj,r.g=iZ(r.l,t?e:null,!r.s),0<r.O&&(r.M=new bSe(Fi(r.Pa,r,r.g),r.O)),pj(r.U,r.g,"readystatechange",r.nb),e=r.I?nj(r.I):{},r.s?(r.u||(r.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.A,r.u,r.s,e)):(r.u="GET",r.g.ha(r.A,r.u,null,e)),e9(),function wSe(r,e,t,n,i,s){r.info(function(){if(r.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var f=l[0];l=l[1];var d=f.split("_");o=2<=d.length&&"type"==d[1]?o+(f+"=")+l+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(r.j,r.u,r.A,r.m,r.W,r.s)}function Oj(r){return!!r.g&&"GET"==r.u&&2!=r.L&&r.l.Ha}function Tj(r,e,t){let i,n=!0;for(;!r.J&&r.C<t.length;){if(i=xSe(r,t),i==Am){4==e&&(r.o=4,_s(14),n=!1),f5(r.j,r.m,null,"[Incomplete Response]");break}if(i==XO){r.o=4,_s(15),f5(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}f5(r.j,r.m,i,null),JO(r,i)}Oj(r)&&i!=Am&&i!=XO&&(r.h.g="",r.C=0),4!=e||0!=t.length||r.h.h||(r.o=1,_s(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),oT(e),e.M=!0,_s(11))):(f5(r.j,r.m,t,"[Invalid Chunked Response]"),U6(r),s9(r))}function xSe(r,e){var t=r.C,n=e.indexOf("\n",t);return-1==n?Am:(t=Number(e.substring(t,n)),isNaN(t)?XO:(n+=1)+t>e.length?Am:(e=e.slice(n,n+t),r.C=n+t,e))}function i9(r){r.Y=Date.now()+r.P,bj(r,r.P)}function bj(r,e){if(null!=r.B)throw Error("WatchDog timer not null");r.B=t9(Fi(r.lb,r),e)}function Im(r){r.B&&(Qt.clearTimeout(r.B),r.B=null)}function s9(r){0==r.l.H||r.J||eZ(r.l,r)}function U6(r){Im(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,WO(r.V),gj(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function JO(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||eT(t.i,r)))if(!r.K&&eT(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;Fm(t),Hm(t)}sT(t),_s(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=t9(Fi(t.ib,t),6e3));if(1>=Dj(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else q6(t,11)}else if((r.K||t.g==r)&&Fm(t),!Zf(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const f=l[3];null!=f&&(t.ra=f,t.l.info("VER="+t.ra));const d=l[4];null!=d&&(t.Ga=d,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=n=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const E=r.g;if(E){const w=E.g?E.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var s=n.i;s.g||-1==w.indexOf("spdy")&&-1==w.indexOf("quic")&&-1==w.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(tT(s,s.h),s.h=null))}if(n.F){const R=E.g?E.g.getResponseHeader("X-HTTP-Session-Id"):null;R&&(n.Da=R,H1(n.I,n.F,R))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=r;if((n=t).wa=rZ(n,n.J?n.pa:null,n.Y),o.K){Hj(n.i,o);var a=o,c=n.L;c&&a.setTimeout(c),a.B&&(Im(a),i9(a)),n.g=o}else Qj(n);0<t.j.length&&Vm(t)}else"stop"!=l[0]&&"close"!=l[0]||q6(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?q6(t,7):iT(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}e9()}catch{}}function wj(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(Cm(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function RSe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(Cm(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function LSe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(Cm(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,s=0;s<i;s++)e.call(void 0,n[s],t&&t[s],r)}(Qe=r9.prototype).setTimeout=function(r){this.P=r},Qe.nb=function(r){r=r.target;const e=this.M;e&&3==Rc(r)?e.l():this.Pa(r)},Qe.Pa=function(r){try{if(r==this.g)e:{const f=Rc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||wO||this.g&&(this.h.h||this.g.ja()||qj(this.g)))){this.J||4!=f||7==e||e9(),Im(this);var t=this.g.da();this.ca=t;t:if(Oj(this)){var n=qj(this.g);r="";var i=n.length,s=4==Rc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){U6(this),s9(this);var o="";break t}this.h.i=new Qt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:s&&e==i-1});n.splice(0,i),this.h.g+=r,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function NSe(r,e,t,n,i,s,o){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,f,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Zf(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,_s(12),U6(this),s9(this);break e}f5(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,JO(this,t)}this.S?(Tj(this,f,o),wO&&this.i&&3==f&&(pj(this.U,this.V,"tick",this.mb),this.V.start())):(f5(this.j,this.m,o,null),JO(this,o)),4==f&&U6(this),this.i&&!this.J&&(4==f?eZ(this.l,this):(this.i=!1,i9(this)))}else(function JSe(r){const e={};r=(r.g&&2<=Rc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(Zf(r[n]))continue;var t=PSe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function _Se(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,_s(12)):(this.o=0,_s(13)),U6(this),s9(this)}}}catch{}},Qe.mb=function(){if(this.g){var r=Rc(this.g),e=this.g.ja();this.C<e.length&&(Im(this),Tj(this,r,e),this.i&&4!=r&&i9(this))}},Qe.cancel=function(){this.J=!0,U6(this)},Qe.lb=function(){this.B=null;const r=Date.now();0<=r-this.Y?(function ASe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(e9(),_s(17)),U6(this),this.o=2,s9(this)):bj(this,this.Y-r)};var Nj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function W6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof W6){this.h=r.h,km(this,r.j),this.s=r.s,this.g=r.g,xm(this,r.m),this.l=r.l;var e=r.i,t=new c9;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Aj(this,t),this.o=r.o}else r&&(e=String(r).match(Nj))?(this.h=!1,km(this,e[1]||"",!0),this.s=o9(e[2]||""),this.g=o9(e[3]||"",!0),xm(this,e[4]),this.l=o9(e[5]||"",!0),Aj(this,e[6]||"",!0),this.o=o9(e[7]||"")):(this.h=!1,this.i=new c9(null,this.h))}function q3(r){return new W6(r)}function km(r,e,t){r.j=t?o9(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function xm(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function Aj(r,e,t){e instanceof c9?(r.i=e,function BSe(r,e){e&&!r.j&&(sl(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(kj(this,n),Lj(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=a9(e,FSe)),r.i=new c9(e,r.h))}function H1(r,e,t){r.i.set(e,t)}function Lm(r){return H1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function o9(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function a9(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,DSe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function DSe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}W6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(a9(e,Ij,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(a9(e,Ij,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(a9(t,"/"==t.charAt(0)?VSe:HSe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",a9(t,$Se)),r.join("")};var Ij=/[#\/\?@]/g,HSe=/[#\?:]/g,VSe=/[#\?]/g,FSe=/[#\?@]/g,$Se=/#/g;function c9(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function sl(r){r.g||(r.g=new Map,r.h=0,r.i&&function zSe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var s=r[t].substring(0,n);i=r[t].substring(n+1)}else s=r[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function kj(r,e){sl(r),e=d5(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function xj(r,e){return sl(r),e=d5(r,e),r.g.has(e)}function Lj(r,e,t){kj(r,e),0<t.length&&(r.i=null,r.g.set(d5(r,e),TO(t)),r.h+=t.length)}function d5(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}function Rj(r){this.l=r||USe,r=Qt.PerformanceNavigationTiming?0<(r=Qt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Qt.g&&Qt.g.Ka&&Qt.g.Ka()&&Qt.g.Ka().ec),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Qe=c9.prototype).add=function(r,e){sl(this),this.i=null,r=d5(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},Qe.forEach=function(r,e){sl(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},Qe.ta=function(){sl(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let s=0;s<i.length;s++)t.push(e[n])}return t},Qe.Z=function(r){sl(this);let e=[];if("string"==typeof r)xj(this,r)&&(e=e.concat(this.g.get(d5(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},Qe.set=function(r,e){return sl(this),this.i=null,xj(this,r=d5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},Qe.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},Qe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var i=s;""!==o[n]&&(i+="="+encodeURIComponent(String(o[n]))),r.push(i)}}return this.i=r.join("&")};var USe=10;function zj(r){return!!r.h||!!r.g&&r.g.size>=r.j}function Dj(r){return r.h?1:r.g?r.g.size:0}function eT(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function tT(r,e){r.g?r.g.add(e):r.h=e}function Hj(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function Vj(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return TO(r.i)}Rj.prototype.cancel=function(){if(this.i=Vj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var WSe=class{stringify(r){return Qt.JSON.stringify(r,void 0)}parse(r){return Qt.JSON.parse(r,void 0)}};function qSe(){this.g=new WSe}function jSe(r,e,t){const n=t||"";try{wj(r,function(i,s){let o=i;jf(i)&&(o=GO(i)),e.push(n+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function Rm(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function l9(r){this.l=r.fc||null,this.j=r.ob||!1}function zm(r,e){D2.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=nT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}z2(l9,jO),l9.prototype.g=function(){return new zm(this.l,this.j)},l9.prototype.i=function(r){return function(){return r}}({}),z2(zm,D2);var nT=0;function Fj(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function u9(r){r.readyState=4,r.l=null,r.j=null,r.A=null,f9(r)}function f9(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(Qe=zm.prototype).open=function(r,e){if(this.readyState!=nT)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,f9(this)},Qe.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Qt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Qe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,u9(this)),this.readyState=nT},Qe.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,f9(this)),this.g&&(this.readyState=3,f9(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Qt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Fj(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},Qe.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?u9(this):f9(this),3==this.readyState&&Fj(this)}},Qe.Za=function(r){this.g&&(this.response=this.responseText=r,u9(this))},Qe.Ya=function(r){this.g&&(this.response=r,u9(this))},Qe.ka=function(){this.g&&u9(this)},Qe.setRequestHeader=function(r,e){this.v.append(r,e)},Qe.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},Qe.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(zm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var YSe=Qt.JSON.parse;function Or(r){D2.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=$j,this.L=this.M=!1}z2(Or,D2);var $j="",KSe=/^https?$/i,XSe=["POST","PUT"];function Bj(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,Gj(r),Dm(r)}function Gj(r){r.F||(r.F=!0,ui(r,"complete"),ui(r,"error"))}function Uj(r){if(r.h&&typeof PO<"u"&&(!r.C[1]||4!=Rc(r)||2!=r.da()))if(r.v&&4==Rc(r))qO(r.La,0,r);else if(ui(r,"readystatechange"),4==Rc(r)){r.h=!1;try{const o=r.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===o){var i=String(r.I).match(Nj)[1]||null;!i&&Qt.self&&Qt.self.location&&(i=Qt.self.location.protocol.slice(0,-1)),n=!KSe.test(i?i.toLowerCase():"")}t=n}if(t)ui(r,"complete"),ui(r,"success");else{r.m=6;try{var s=2<Rc(r)?r.g.statusText:""}catch{s=""}r.j=s+" ["+r.da()+"]",Gj(r)}}finally{Dm(r)}}}function Dm(r,e){if(r.g){Wj(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||ui(r,"ready");try{t.onreadystatechange=n}catch{}}}function Wj(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Qt.clearTimeout(r.A),r.A=null)}function Rc(r){return r.g?r.g.readyState:0}function qj(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case $j:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function jj(r){let e="";return LO(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function rT(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=jj(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):H1(r,e,t))}function d9(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function Zj(r){this.Ga=0,this.j=[],this.l=new Tm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=d9("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=d9("baseRetryDelayMs",5e3,r),this.hb=d9("retryDelaySeedMs",1e4,r),this.eb=d9("forwardChannelMaxRetries",2,r),this.xa=d9("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.dc||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new Rj(r&&r.concurrentRequestLimit),this.Ja=new qSe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function iT(r){if(Yj(r),3==r.H){var e=r.W++,t=q3(r.I);if(H1(t,"SID",r.K),H1(t,"RID",e),H1(t,"TYPE","terminate"),h9(r,t),(e=new r9(r,r.l,e)).L=2,e.v=Lm(q3(t)),t=!1,Qt.navigator&&Qt.navigator.sendBeacon)try{t=Qt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Qt.Image&&((new Image).src=e.v,t=!0),t||(e.g=iZ(e.l,null),e.g.ha(e.v)),e.G=Date.now(),i9(e)}nZ(r)}function Hm(r){r.g&&(oT(r),r.g.cancel(),r.g=null)}function Yj(r){Hm(r),r.u&&(Qt.clearTimeout(r.u),r.u=null),Fm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Qt.clearTimeout(r.m),r.m=null)}function Vm(r){if(!zj(r.i)&&!r.m){r.m=!0;var e=r.Na;Xf||fj(),Qf||(Xf(),Qf=!0),UO.add(e,r),r.C=0}}function Kj(r,e){var t;t=e?e.m:r.W++;const n=q3(r.I);H1(n,"SID",r.K),H1(n,"RID",t),H1(n,"AID",r.V),h9(r,n),r.o&&r.s&&rT(n,r.o,r.s),t=new r9(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=Xj(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),tT(r.i,t),QO(t,n,e)}function h9(r,e){r.na&&LO(r.na,function(t,n){H1(e,n,t)}),r.h&&wj({},function(t,n){H1(e,n,t)})}function Xj(r,e,t){t=Math.min(r.j.length,t);var n=r.h?Fi(r.h.Va,r.h,r):null;e:{var i=r.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const f=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{jSe(f,o,"req"+l+"_")}catch{n&&n(f)}}if(a){n=o.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function Qj(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;Xf||fj(),Qf||(Xf(),Qf=!0),UO.add(e,r),r.A=0}}function sT(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=t9(Fi(r.Ma,r),tZ(r,r.A)),r.A++,0))}function oT(r){null!=r.B&&(Qt.clearTimeout(r.B),r.B=null)}function Jj(r){r.g=new r9(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=q3(r.wa);H1(e,"RID","rpc"),H1(e,"SID",r.K),H1(e,"AID",r.V),H1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&H1(e,"TO",r.qa),H1(e,"TYPE","xmlhttp"),h9(r,e),r.o&&r.s&&rT(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.v=Lm(q3(e)),t.s=null,t.S=!0,Pj(t,r)}function Fm(r){null!=r.v&&(Qt.clearTimeout(r.v),r.v=null)}function eZ(r,e){var t=null;if(r.g==e){Fm(r),oT(r),r.g=null;var n=2}else{if(!eT(r.i,e))return;t=e.F,Hj(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=r.C;ui(n=bm(),new Cj(n,t)),Vm(r)}else Qj(r);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function ePe(r,e){return!(Dj(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=t9(Fi(r.Na,r,e),tZ(r,r.C)),r.C++,0)))}(r,e)||2==n&&sT(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:q6(r,5);break;case 4:q6(r,10);break;case 3:q6(r,6);break;default:q6(r,2)}}function tZ(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function q6(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=Fi(r.pb,r);t||(t=new W6("//www.google.com/images/cleardot.gif"),Qt.location&&"http"==Qt.location.protocol||km(t,"https"),Lm(t)),function ZSe(r,e){const t=new Tm;if(Qt.Image){const n=new Image;n.onload=ym(Rm,t,n,"TestLoadImage: loaded",!0,e),n.onerror=ym(Rm,t,n,"TestLoadImage: error",!1,e),n.onabort=ym(Rm,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=ym(Rm,t,n,"TestLoadImage: timeout",!1,e),Qt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else _s(2);r.H=0,r.h&&r.h.za(e),nZ(r),Yj(r)}function nZ(r){if(r.H=0,r.ma=[],r.h){const e=Vj(r.i);(0!=e.length||0!=r.j.length)&&(Xq(r.ma,e),Xq(r.ma,r.j),r.i.i.length=0,TO(r.j),r.j.length=0),r.h.ya()}}function rZ(r,e,t){var n=t instanceof W6?q3(t):new W6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),xm(n,n.m);else{var i=Qt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new W6(null);n&&km(s,n),e&&(s.g=e),i&&xm(s,i),t&&(s.l=t),n=s}return e=r.Da,(t=r.F)&&e&&H1(n,t,e),H1(n,"VER",r.ra),h9(r,n),n}function iZ(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Or(t&&r.Ha&&!r.va?new l9({ob:!0}):r.va)).Oa(r.J),e}function sZ(){}function $m(){if(u5&&!(10<=Number(hSe)))throw Error("Environmental error: no available transport.")}function Po(r,e){D2.call(this),this.g=new Zj(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!Zf(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Zf(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new h5(this)}function oZ(r){ZO.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function aZ(){YO.call(this),this.status=1}function h5(r){this.g=r}function Ra(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function aT(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=r.g[3],o=(e=r.g[0])+(s^(t=r.g[1])&((i=r.g[2])^s))+n[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+s&4294967295}function d1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var s=0|r[i];n&&s==e||(t[i]=s,n=!1)}this.g=t}(Qe=Or.prototype).Oa=function(r){this.M=r},Qe.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():KO.g(),this.C=function Mj(r){return r.h||(r.h=r.i())}(this.u?this.u:KO),this.g.onreadystatechange=Fi(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(s){return void Bj(this,s)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const s of n.keys())t.set(s,n.get(s))}n=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=Qt.FormData&&r instanceof Qt.FormData,!(0<=Kq(XSe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Wj(this),0<this.B&&((this.L=function QSe(r){return u5&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Fi(this.ua,this)):this.A=qO(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(s){Bj(this,s)}},Qe.ua=function(){typeof PO<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ui(this,"timeout"),this.abort(8))},Qe.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,ui(this,"complete"),ui(this,"abort"),Dm(this))},Qe.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dm(this,!0)),Or.$.N.call(this)},Qe.La=function(){this.s||(this.G||this.v||this.l?Uj(this):this.kb())},Qe.kb=function(){Uj(this)},Qe.isActive=function(){return!!this.g},Qe.da=function(){try{return 2<Rc(this)?this.g.status:-1}catch{return-1}},Qe.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Qe.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),YSe(e)}},Qe.Ia=function(){return this.m},Qe.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Qe=Zj.prototype).ra=8,Qe.H=1,Qe.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new r9(this,this.l,r);let s=this.s;if(this.U&&(s?(s=nj(s),ij(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Xj(this,i,e),H1(t=q3(this.I),"RID",r),H1(t,"CVER",22),this.F&&H1(t,"X-HTTP-Session-Id",this.F),h9(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(jj(s)))+"&"+e:this.o&&rT(t,this.o,s)),tT(this.i,i),this.bb&&H1(t,"TYPE","init"),this.P?(H1(t,"$req",e),H1(t,"SID","null"),i.aa=!0,QO(i,t,null)):QO(i,t,e),this.H=2}}else 3==this.H&&(r?Kj(this,r):0==this.j.length||zj(this.i)||Kj(this))},Qe.Ma=function(){if(this.u=null,Jj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=t9(Fi(this.jb,this),r)}},Qe.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,_s(10),Hm(this),Jj(this))},Qe.ib=function(){null!=this.v&&(this.v=null,Hm(this),sT(this),_s(19))},Qe.pb=function(r){r?(this.l.info("Successfully pinged google.com"),_s(2)):(this.l.info("Failed to ping google.com"),_s(1))},Qe.isActive=function(){return!!this.h&&this.h.isActive(this)},(Qe=sZ.prototype).Ba=function(){},Qe.Aa=function(){},Qe.za=function(){},Qe.ya=function(){},Qe.isActive=function(){return!0},Qe.Va=function(){},$m.prototype.g=function(r,e){return new Po(r,e)},z2(Po,D2),Po.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;_s(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=rZ(r,null,r.Y),Vm(r)},Po.prototype.close=function(){iT(this.g)},Po.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=GO(r),r=t);e.j.push(new class{constructor(r,e){this.g=r,this.map=e}}(e.fb++,r)),3==e.H&&Vm(e)},Po.prototype.N=function(){this.g.h=null,delete this.j,iT(this.g),delete this.g,Po.$.N.call(this)},z2(oZ,ZO),z2(aZ,YO),z2(h5,sZ),h5.prototype.Ba=function(){ui(this.g,"a")},h5.prototype.Aa=function(r){ui(this.g,new oZ(r))},h5.prototype.za=function(r){ui(this.g,new aZ)},h5.prototype.ya=function(){ui(this.g,"b")},z2(Ra,function tPe(){this.blockSize=-1}),Ra.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ra.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)aT(this,r,s),s+=this.blockSize;if("string"==typeof r){for(;s<e;)if(n[i++]=r.charCodeAt(s++),i==this.blockSize){aT(this,n),i=0;break}}else for(;s<e;)if(n[i++]=r[s++],i==this.blockSize){aT(this,n),i=0;break}}this.h=i,this.i+=e},Ra.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var nPe={};function cT(r){return-128<=r&&128>r?function uSe(r,e){var t=nPe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new d1([0|e],0>e?-1:0)}):new d1([0|r],0>r?-1:0)}function zc(r){if(isNaN(r)||!isFinite(r))return p5;if(0>r)return fi(zc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=lT;return new d1(e,0)}var lT=4294967296,p5=cT(0),uT=cT(1),lZ=cT(16777216);function j3(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function Ko(r){return-1==r.h}function fi(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new d1(t,~r.h).add(uT)}function Bm(r,e){return r.add(fi(e))}function Gm(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function p9(r,e){this.g=r,this.h=e}function Um(r,e){if(j3(e))throw Error("division by zero");if(j3(r))return new p9(p5,p5);if(Ko(r))return e=Um(fi(r),e),new p9(fi(e.g),fi(e.h));if(Ko(e))return e=Um(r,fi(e)),new p9(fi(e.g),e.h);if(30<r.g.length){if(Ko(r)||Ko(e))throw Error("slowDivide_ only works with positive integers.");for(var t=uT,n=e;0>=n.X(r);)t=uZ(t),n=uZ(n);var i=g5(t,1),s=g5(n,1);for(n=g5(n,2),t=g5(t,2);!j3(n);){var o=s.add(n);0>=o.X(r)&&(i=i.add(t),s=o),n=g5(n,1),t=g5(t,1)}return e=Bm(r,i.R(e)),new p9(i,e)}for(i=p5;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),o=(s=zc(t)).R(e);Ko(o)||0<o.X(r);)o=(s=zc(t-=n)).R(e);j3(s)&&(s=uT),i=i.add(s),r=Bm(r,o)}return new p9(i,r)}function uZ(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new d1(t,r.h)}function g5(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],s=0;s<n;s++)i[s]=0<e?r.D(s+t)>>>e|r.D(s+t+1)<<32-e:r.D(s+t);return new d1(i,r.h)}(Qe=d1.prototype).ea=function(){if(Ko(this))return-fi(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:lT+n)*e,e*=lT}return r},Qe.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(j3(this))return"0";if(Ko(this))return"-"+fi(this).toString(r);for(var e=zc(Math.pow(r,6)),t=this,n="";;){var i=Um(t,e).g,s=((0<(t=Bm(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if(j3(t=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},Qe.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},Qe.X=function(r){return Ko(r=Bm(this,r))?-1:j3(r)?0:1},Qe.abs=function(){return Ko(this)?fi(this):this},Qe.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var s=n+(65535&this.D(i))+(65535&r.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new d1(t,-2147483648&t[t.length-1]?-1:0)},Qe.R=function(r){if(j3(this)||j3(r))return p5;if(Ko(this))return Ko(r)?fi(this).R(fi(r)):fi(fi(this).R(r));if(Ko(r))return fi(this.R(fi(r)));if(0>this.X(lZ)&&0>r.X(lZ))return zc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var s=this.D(n)>>>16,o=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=o*c,Gm(t,2*n+2*i),t[2*n+2*i+1]+=s*c,Gm(t,2*n+2*i+1),t[2*n+2*i+1]+=o*a,Gm(t,2*n+2*i+1),t[2*n+2*i+2]+=s*a,Gm(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new d1(t,0)},Qe.gb=function(r){return Um(this,r).h},Qe.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new d1(t,this.h&r.h)},Qe.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new d1(t,this.h|r.h)},Qe.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new d1(t,this.h^r.h)},$m.prototype.createWebChannel=$m.prototype.g,Po.prototype.send=Po.prototype.u,Po.prototype.open=Po.prototype.m,Po.prototype.close=Po.prototype.close,wm.NO_ERROR=0,wm.TIMEOUT=8,wm.HTTP_ERROR=6,yj.COMPLETE="complete",Ej.EventType=n9,n9.OPEN="a",n9.CLOSE="b",n9.ERROR="c",n9.MESSAGE="d",D2.prototype.listen=D2.prototype.O,Or.prototype.listenOnce=Or.prototype.P,Or.prototype.getLastError=Or.prototype.Sa,Or.prototype.getLastErrorCode=Or.prototype.Ia,Or.prototype.getStatus=Or.prototype.da,Or.prototype.getResponseJson=Or.prototype.Wa,Or.prototype.getResponseText=Or.prototype.ja,Or.prototype.send=Or.prototype.ha,Or.prototype.setWithCredentials=Or.prototype.Oa,Ra.prototype.digest=Ra.prototype.l,Ra.prototype.reset=Ra.prototype.reset,Ra.prototype.update=Ra.prototype.j,d1.prototype.add=d1.prototype.add,d1.prototype.multiply=d1.prototype.R,d1.prototype.modulo=d1.prototype.gb,d1.prototype.compare=d1.prototype.X,d1.prototype.toNumber=d1.prototype.ea,d1.prototype.toString=d1.prototype.toString,d1.prototype.getBits=d1.prototype.D,d1.fromNumber=zc,d1.fromString=function cZ(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return fi(cZ(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=zc(Math.pow(e,8)),n=p5,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),o=parseInt(r.substring(i,i+s),e);8>s?(s=zc(Math.pow(e,s)),n=n.R(s).add(zc(o))):n=(n=n.R(t)).add(zc(o))}return n};var rPe=La.createWebChannelTransport=function(){return new $m},iPe=La.getStatEventTarget=function(){return bm()},fT=La.ErrorCode=wm,sPe=La.EventType=yj,oPe=La.Event=G6,fZ=La.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},aPe=La.FetchXmlHttpFactory=l9,Wm=La.WebChannel=Ej,cPe=La.XhrIo=Or,lPe=La.Md5=Ra,m5=La.Integer=d1;const dZ="@firebase/firestore";class H2{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}H2.UNAUTHENTICATED=new H2(null),H2.GOOGLE_CREDENTIALS=new H2("google-credentials-uid"),H2.FIRST_PARTY=new H2("first-party-uid"),H2.MOCK_USER=new H2("mock-user");let _5="9.23.0";const ol=new c5("@firebase/firestore");function dT(){return ol.logLevel}function be(r,...e){if(ol.logLevel<=Wn.DEBUG){const t=e.map(hT);ol.debug(`Firestore (${_5}): ${r}`,...t)}}function Br(r,...e){if(ol.logLevel<=Wn.ERROR){const t=e.map(hT);ol.error(`Firestore (${_5}): ${r}`,...t)}}function za(r,...e){if(ol.logLevel<=Wn.WARN){const t=e.map(hT);ol.warn(`Firestore (${_5}): ${r}`,...t)}}function hT(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function lt(r="Unexpected state"){const e=`FIRESTORE (${_5}) INTERNAL ASSERTION FAILED: `+r;throw Br(e),new Error(e)}function mt(r,e){r||lt()}function qe(r,e){return r}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends So{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class p2{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class hZ{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uPe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(H2.UNAUTHENTICATED))}shutdown(){}}class fPe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class dPe{constructor(e){this.t=e,this.currentUser=H2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new p2;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new p2,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable(M(function*(){yield l.promise,yield s(n.currentUser)}))},c=l=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new p2)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mt("string"==typeof n.accessToken),new hZ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return mt(null===e||"string"==typeof e),new H2(e)}}class hPe{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=H2.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class pPe{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new hPe(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(H2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gPe{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=s=>{null!=s.error&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,be("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(mt("string"==typeof t.token),this.T=t.token,new pZ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function mPe(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class gZ{static A(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=mPe(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return n}}function Zt(r,e){return r<e?-1:r>e?1:0}function v5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class cr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return cr.fromMillis(Date.now())}static fromDate(e){return cr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new cr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Zt(this.nanoseconds,e.nanoseconds):Zt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new cr(0,0))}static max(){return new Ct(new cr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class g9{constructor(e,t,n){void 0===t?t=0:t>e.length&&lt(),void 0===n?n=e.length-t:n>e.length-t&&lt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===g9.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof g9?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Hn extends g9{construct(e,t,n){return new Hn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Hn(t)}static emptyPath(){return new Hn([])}}const _Pe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gr extends g9{construct(e,t,n){return new Gr(e,t,n)}static isValidIdentifier(e){return _Pe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Gr(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Te(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Te(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new Te(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gr(t)}static emptyPath(){return new Gr([])}}class Ge{constructor(e){this.path=e}static fromPath(e){return new Ge(Hn.fromString(e))}static fromName(e){return new Ge(Hn.fromString(e).popFirst(5))}static empty(){return new Ge(Hn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Hn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Hn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ge(new Hn(e.slice()))}}function vZ(r){return new Oo(r.readTime,r.key,-1)}class Oo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Oo(Ct.min(),Ge.empty(),-1)}static max(){return new Oo(Ct.max(),Ge.empty(),-1)}}function gT(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ge.comparator(r.documentKey,e.documentKey),0!==t?t:Zt(r.largestBatchId,e.largestBatchId))}const CZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yPe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function al(r){return mT.apply(this,arguments)}function mT(){return mT=M(function*(r){if(r.code!==fe.FAILED_PRECONDITION||r.message!==CZ)throw r;be("LocalStore","Unexpectedly lost primary lease")}),mT.apply(this,arguments)}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&lt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>n(c))}),o=!0,s===i&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(i=>i?ce.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(f=>{o[l]=f,++a,a===s&&n(o)},f=>i(f))}})}static doWhile(e,t){return new ce((n,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):n()};s()})}}function cl(r){return"IndexedDbTransactionError"===r.name}let To=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return r.ct=-1,r})();function v9(r){return null==r}function C9(r){return 0===r&&1/r==-1/0}function wZ(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ll(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function NZ(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class k1{constructor(e,t){this.comparator=e,this.root=t||di.EMPTY}insert(e,t){return new k1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,di.BLACK,null,null))}remove(e){return new k1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,di.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Km(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Km(this.root,e,this.comparator,!1)}getReverseIterator(){return new Km(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Km(this.root,e,this.comparator,!0)}}class Km{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class di{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??di.RED,this.left=i??di.EMPTY,this.right=s??di.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new di(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return di.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return di.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,di.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,di.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw lt();const e=this.left.check();if(e!==this.right.check())throw lt();return e+(this.isRed()?0:1)}}di.EMPTY=null,di.RED=!0,di.BLACK=!1,di.EMPTY=new class{constructor(){this.size=0}get key(){throw lt()}get value(){throw lt()}get color(){throw lt()}get left(){throw lt()}get right(){throw lt()}copy(r,e,t,n,i){return this}insert(r,e,t){return new di(r,e)}remove(r,e){return this}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class V1{constructor(e){this.comparator=e,this.data=new k1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AZ(this.data.getIterator())}getIteratorFrom(e){return new AZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof V1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new V1(this.comparator);return t.data=e,t}}class AZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class js{constructor(e){this.fields=e,e.sort(Gr.comparator)}static empty(){return new js([])}unionWith(e){let t=new V1(Gr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return v5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class IZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class g2{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new IZ("Invalid base64 string: "+i):i}}(e);return new g2(t)}static fromUint8Array(e){const t=function(n){let i="";for(let s=0;s<n.length;++s)i+=String.fromCharCode(n[s]);return i}(e);return new g2(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Zt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}g2.EMPTY_BYTE_STRING=new g2("");const GPe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ul(r){if(mt(!!r),"string"==typeof r){let e=0;const t=GPe.exec(r);if(mt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Tr(r.seconds),nanos:Tr(r.nanos)}}function Tr(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function Z3(r){return"string"==typeof r?g2.fromBase64String(r):g2.fromUint8Array(r)}function Xm(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Qm(r){const e=r.mapValue.fields.__previous_value__;return Xm(e)?Qm(e):e}function y9(r){const e=ul(r.mapValue.fields.__local_write_time__.timestampValue);return new cr(e.seconds,e.nanos)}class UPe{constructor(e,t,n,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class Y6{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Y6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Y6&&e.projectId===this.projectId&&e.database===this.database}}const fl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function dl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Xm(r)?4:RZ(r)?9007199254740991:10:lt()}function Hc(r,e){if(r===e)return!0;const t=dl(r);if(t!==dl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return y9(r).isEqual(y9(e));case 3:return function(n,i){if("string"==typeof n.timestampValue&&"string"==typeof i.timestampValue&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const s=ul(n.timestampValue),o=ul(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return i=e,Z3(r.bytesValue).isEqual(Z3(i.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(n,i){return Tr(n.geoPointValue.latitude)===Tr(i.geoPointValue.latitude)&&Tr(n.geoPointValue.longitude)===Tr(i.geoPointValue.longitude)}(r,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return Tr(n.integerValue)===Tr(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const s=Tr(n.doubleValue),o=Tr(i.doubleValue);return s===o?C9(s)===C9(o):isNaN(s)&&isNaN(o)}return!1}(r,e);case 9:return v5(r.arrayValue.values||[],e.arrayValue.values||[],Hc);case 10:return function(n,i){const s=n.mapValue.fields||{},o=i.mapValue.fields||{};if(wZ(s)!==wZ(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(void 0===o[a]||!Hc(s[a],o[a])))return!1;return!0}(r,e);default:return lt()}var i}function M9(r,e){return void 0!==(r.values||[]).find(t=>Hc(t,e))}function hl(r,e){if(r===e)return 0;const t=dl(r),n=dl(e);if(t!==n)return Zt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Zt(r.booleanValue,e.booleanValue);case 2:return function(i,s){const o=Tr(i.integerValue||i.doubleValue),a=Tr(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(r,e);case 3:return kZ(r.timestampValue,e.timestampValue);case 4:return kZ(y9(r),y9(e));case 5:return Zt(r.stringValue,e.stringValue);case 6:return function(i,s){const o=Z3(i),a=Z3(s);return o.compareTo(a)}(r.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=Zt(o[c],a[c]);if(0!==l)return l}return Zt(o.length,a.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,s){const o=Zt(Tr(i.latitude),Tr(s.latitude));return 0!==o?o:Zt(Tr(i.longitude),Tr(s.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=hl(o[c],a[c]);if(l)return l}return Zt(o.length,a.length)}(r.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===fl.mapValue&&s===fl.mapValue)return 0;if(i===fl.mapValue)return 1;if(s===fl.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),c=s.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let f=0;f<a.length&&f<l.length;++f){const d=Zt(a[f],l[f]);if(0!==d)return d;const m=hl(o[a[f]],c[l[f]]);if(0!==m)return m}return Zt(a.length,l.length)}(r.mapValue,e.mapValue);default:throw lt()}}function kZ(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return Zt(r,e);const t=ul(r),n=ul(e),i=Zt(t.seconds,n.seconds);return 0!==i?i:Zt(t.nanos,n.nanos)}function y5(r){return CT(r)}function CT(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(n){const i=ul(n);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?Z3(r.bytesValue).toBase64():"referenceValue"in r?Ge.fromName(r.referenceValue).toString():"geoPointValue"in r?`geo(${(e=r.geoPointValue).latitude},${e.longitude})`:"arrayValue"in r?function(n){let i="[",s=!0;for(const o of n.values||[])s?s=!1:i+=",",i+=CT(o);return i+"]"}(r.arrayValue):"mapValue"in r?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${CT(n.fields[a])}`;return s+"}"}(r.mapValue):lt();var e}function K6(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function yT(r){return!!r&&"integerValue"in r}function E9(r){return!!r&&"arrayValue"in r}function xZ(r){return!!r&&"nullValue"in r}function LZ(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function t_(r){return!!r&&"mapValue"in r}function S9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return ll(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=S9(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=S9(r.arrayValue.values[t]);return e}return Object.assign({},r)}function RZ(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class hi{constructor(e){this.value=e}static empty(){return new hi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!t_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=S9(t)}setAll(e){let t=Gr.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=S9(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());t_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];t_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ll(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new hi(S9(this.value))}}function HZ(r){const e=[];return ll(r.fields,(t,n)=>{const i=new Gr([t]);if(t_(n)){const s=HZ(n.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new js(e)}class F1{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new F1(e,0,Ct.min(),Ct.min(),Ct.min(),hi.empty(),0)}static newFoundDocument(e,t,n,i){return new F1(e,1,t,Ct.min(),n,i,0)}static newNoDocument(e,t){return new F1(e,2,t,Ct.min(),Ct.min(),hi.empty(),0)}static newUnknownDocument(e,t){return new F1(e,3,t,Ct.min(),Ct.min(),hi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=hi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=hi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof F1&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new F1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class pl{constructor(e,t){this.position=e,this.inclusive=t}}function VZ(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(n=s.field.isKeyField()?Ge.comparator(Ge.fromName(o.referenceValue),t.key):hl(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function FZ(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Hc(r.position[t],e.position[t]))return!1;return!0}class M5{constructor(e,t="asc"){this.field=e,this.dir=t}}function jPe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class $Z{}class Sn extends $Z{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new ZPe(e,t,n):"array-contains"===t?new XPe(e,n):"in"===t?new jZ(e,n):"not-in"===t?new QPe(e,n):"array-contains-any"===t?new JPe(e,n):new Sn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new YPe(e,n):new KPe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(hl(t,this.value)):null!==t&&dl(this.value)===dl(t)&&this.matchesComparison(hl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return lt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class h1 extends $Z{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new h1(e,t)}matches(e){return E5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function E5(r){return"and"===r.op}function ET(r){return function BZ(r){for(const e of r.filters)if(e instanceof h1)return!1;return!0}(r)&&E5(r)}function ST(r){if(r instanceof Sn)return r.field.canonicalString()+r.op.toString()+y5(r.value);if(ET(r))return r.filters.map(e=>ST(e)).join(",");{const e=r.filters.map(t=>ST(t)).join(",");return`${r.op}(${e})`}}function GZ(r,e){return r instanceof Sn?(t=r,(n=e)instanceof Sn&&t.op===n.op&&t.field.isEqual(n.field)&&Hc(t.value,n.value)):r instanceof h1?function(t,n){return n instanceof h1&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((i,s,o)=>i&&GZ(s,n.filters[o]),!0)}(r,e):void lt();var t,n}function WZ(r){return r instanceof Sn?`${(e=r).field.canonicalString()} ${e.op} ${y5(e.value)}`:r instanceof h1?function(e){return e.op.toString()+" {"+e.getFilters().map(WZ).join(" ,")+"}"}(r):"Filter";var e}class ZPe extends Sn{constructor(e,t,n){super(e,t,n),this.key=Ge.fromName(n.referenceValue)}matches(e){const t=Ge.comparator(e.key,this.key);return this.matchesComparison(t)}}class YPe extends Sn{constructor(e,t){super(e,"in",t),this.keys=qZ(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class KPe extends Sn{constructor(e,t){super(e,"not-in",t),this.keys=qZ(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function qZ(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Ge.fromName(n.referenceValue))}class XPe extends Sn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return E9(t)&&M9(t.arrayValue,this.value)}}class jZ extends Sn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&M9(this.value.arrayValue,t)}}class QPe extends Sn{constructor(e,t){super(e,"not-in",t)}matches(e){if(M9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!M9(this.value.arrayValue,t)}}class JPe extends Sn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!E9(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>M9(this.value.arrayValue,n))}}class eOe{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function PT(r,e=null,t=[],n=[],i=null,s=null,o=null){return new eOe(r,e,t,n,i,s,o)}function X6(r){const e=qe(r);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>ST(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(i=n).field.canonicalString()+i.dir;var i}).join(","),v9(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>y5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>y5(n)).join(",")),e.dt=t}return e.dt}function P9(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!jPe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!GZ(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!FZ(r.startAt,e.startAt)&&FZ(r.endAt,e.endAt)}function n_(r){return Ge.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class Y3{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null}}function S5(r){return new Y3(r)}function XZ(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function OT(r){return r.explicitOrderBy.length>0?r.explicitOrderBy[0].field:null}function i_(r){for(const e of r.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function TT(r){return null!==r.collectionGroup}function Q6(r){const e=qe(r);if(null===e.wt){e.wt=[];const t=i_(e),n=OT(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new M5(t)),e.wt.push(new M5(Gr.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new M5(Gr.keyField(),s))}}}return e.wt}function vs(r){const e=qe(r);if(!e._t)if("F"===e.limitType)e._t=PT(e.path,e.collectionGroup,Q6(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Q6(e))t.push(new M5(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new pl(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new pl(e.startAt.position,e.startAt.inclusive):null;e._t=PT(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function bT(r,e){e.getFirstInequalityField(),i_(r);const t=r.filters.concat([e]);return new Y3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function s_(r,e,t){return new Y3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function O9(r,e){return P9(vs(r),vs(e))&&r.limitType===e.limitType}function QZ(r){return`${X6(vs(r))}|lt:${r.limitType}`}function wT(r){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>WZ(n)).join(", ")}]`),v9(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>{return`${(i=n).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>y5(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>y5(n)).join(",")),`Target(${t})`}(vs(r))}; limitType=${r.limitType})`}function T9(r,e){return e.isFoundDocument()&&function(t,n){const i=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ge.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(r,e)&&function(t,n){for(const i of Q6(t))if(!i.field.isKeyField()&&null===n.data.field(i.field))return!1;return!0}(r,e)&&function(t,n){for(const i of t.filters)if(!i.matches(n))return!1;return!0}(r,e)&&(n=e,!((t=r).startAt&&!function(i,s,o){const a=VZ(i,s,o);return i.inclusive?a<=0:a<0}(t.startAt,Q6(t),n)||t.endAt&&!function(i,s,o){const a=VZ(i,s,o);return i.inclusive?a>=0:a>0}(t.endAt,Q6(t),n)));var t,n}function eY(r){return(e,t)=>{let n=!1;for(const i of Q6(r)){const s=tOe(i,e,t);if(0!==s)return s;n=n||i.field.isKeyField()}return 0}}function tOe(r,e,t){const n=r.field.isKeyField()?Ge.comparator(e.key,t.key):function(i,s,o){const a=s.data.field(i),c=o.data.field(i);return null!==a&&null!==c?hl(a,c):lt()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return lt()}}class K3{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ll(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return NZ(this.inner)}size(){return this.innerSize}}const nOe=new k1(Ge.comparator);function Zs(){return nOe}const tY=new k1(Ge.comparator);function b9(...r){let e=tY;for(const t of r)e=e.insert(t.key,t);return e}function nY(r){let e=tY;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Vc(){return w9()}function rY(){return w9()}function w9(){return new K3(r=>r.toString(),(r,e)=>r.isEqual(e))}const rOe=new k1(Ge.comparator),iOe=new V1(Ge.comparator);function sn(...r){let e=iOe;for(const t of r)e=e.add(t);return e}const sOe=new V1(Zt);function iY(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:C9(e)?"-0":e}}function sY(r){return{integerValue:""+r}}function oY(r,e){return function MZ(r){return"number"==typeof r&&Number.isInteger(r)&&!C9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?sY(e):iY(r,e)}class o_{constructor(){this._=void 0}}function oOe(r,e,t){return r instanceof P5?function(n,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&Xm(i)&&(i=Qm(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):r instanceof J6?cY(r,e):r instanceof e0?lY(r,e):function(n,i){const s=aY(n,i),o=uY(s)+uY(n.gt);return yT(s)&&yT(n.gt)?sY(o):iY(n.serializer,o)}(r,e)}function aOe(r,e,t){return r instanceof J6?cY(r,e):r instanceof e0?lY(r,e):t}function aY(r,e){return r instanceof O5?yT(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class P5 extends o_{}class J6 extends o_{constructor(e){super(),this.elements=e}}function cY(r,e){const t=fY(e);for(const n of r.elements)t.some(i=>Hc(i,n))||t.push(n);return{arrayValue:{values:t}}}class e0 extends o_{constructor(e){super(),this.elements=e}}function lY(r,e){let t=fY(e);for(const n of r.elements)t=t.filter(i=>!Hc(i,n));return{arrayValue:{values:t}}}class O5 extends o_{constructor(e,t){super(),this.serializer=e,this.gt=t}}function uY(r){return Tr(r.integerValue||r.doubleValue)}function fY(r){return E9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class N9{constructor(e,t){this.field=e,this.transform=t}}class lOe{constructor(e,t){this.version=e,this.transformResults=t}}class er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new er}static exists(e){return new er(void 0,e)}static updateTime(e){return new er(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function a_(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class c_{}function dY(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new b5(r.key,er.none()):new T5(r.key,r.data,er.none());{const t=r.data,n=hi.empty();let i=new V1(Gr.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),i=i.add(s)}return new X3(r.key,n,new js(i.toArray()),er.none())}}function uOe(r,e,t){r instanceof T5?function(n,i,s){const o=n.value.clone(),a=gY(n.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(r,e,t):r instanceof X3?function(n,i,s){if(!a_(n.precondition,i))return void i.convertToUnknownDocument(s.version);const o=gY(n.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(pY(n)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function A9(r,e,t,n){return r instanceof T5?function(i,s,o,a){if(!a_(i.precondition,s))return o;const c=i.value.clone(),l=mY(i.fieldTransforms,a,s);return c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof X3?function(i,s,o,a){if(!a_(i.precondition,s))return o;const c=mY(i.fieldTransforms,a,s),l=s.data;return l.setAll(pY(i)),l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null===o?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(r,e,t,n):(o=t,a_(r.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function fOe(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=aY(n.transform,i||null);null!=s&&(null===t&&(t=hi.empty()),t.set(n.field,s))}return t||null}function hY(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=r.fieldTransforms)&&void 0===n||t&&n&&v5(t,n,(i,s)=>function cOe(r,e){return r.field.isEqual(e.field)&&(n=e.transform,(t=r.transform)instanceof J6&&n instanceof J6||t instanceof e0&&n instanceof e0?v5(t.elements,n.elements,Hc):t instanceof O5&&n instanceof O5?Hc(t.gt,n.gt):t instanceof P5&&n instanceof P5);var t,n}(i,s))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var t,n}class T5 extends c_{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class X3 extends c_{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pY(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function gY(r,e,t){const n=new Map;mt(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,aOe(o,a,t[i]))}return n}function mY(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,oOe(s,o,e))}return n}class b5 extends c_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AT extends c_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class IT{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&uOe(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=A9(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=A9(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=rY();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const c=dY(o,a);null!==c&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ct.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),sn())}isEqual(e){return this.batchId===e.batchId&&v5(this.mutations,e.mutations,(t,n)=>hY(t,n))&&v5(this.baseMutations,e.baseMutations,(t,n)=>hY(t,n))}}class kT{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){mt(e.mutations.length===n.length);let i=rOe;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new kT(e,t,n,i)}}class xT{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class hOe{constructor(e,t){this.count=e,this.unchangedNames=t}}var n2,Vn;function vY(r){if(void 0===r)return Br("GRPC error has no .code"),fe.UNKNOWN;switch(r){case n2.OK:return fe.OK;case n2.CANCELLED:return fe.CANCELLED;case n2.UNKNOWN:return fe.UNKNOWN;case n2.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case n2.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case n2.INTERNAL:return fe.INTERNAL;case n2.UNAVAILABLE:return fe.UNAVAILABLE;case n2.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case n2.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case n2.NOT_FOUND:return fe.NOT_FOUND;case n2.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case n2.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case n2.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case n2.ABORTED:return fe.ABORTED;case n2.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case n2.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case n2.DATA_LOSS:return fe.DATA_LOSS;default:return lt()}}(Vn=n2||(n2={}))[Vn.OK=0]="OK",Vn[Vn.CANCELLED=1]="CANCELLED",Vn[Vn.UNKNOWN=2]="UNKNOWN",Vn[Vn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vn[Vn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vn[Vn.NOT_FOUND=5]="NOT_FOUND",Vn[Vn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vn[Vn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vn[Vn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vn[Vn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vn[Vn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vn[Vn.ABORTED=10]="ABORTED",Vn[Vn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vn[Vn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vn[Vn.INTERNAL=13]="INTERNAL",Vn[Vn.UNAVAILABLE=14]="UNAVAILABLE",Vn[Vn.DATA_LOSS=15]="DATA_LOSS";class LT{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return l_}static getOrCreateInstance(){return null===l_&&(l_=new LT),l_}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let l_=null;const pOe=new m5([4294967295,4294967295],0);function yY(r){const e=function CY(){return new TextEncoder}().encode(r),t=new lPe;return t.update(e),new Uint8Array(t.digest())}function MY(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new m5([t,n],0),new m5([i,s],0)]}class RT{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new I9(`Invalid padding: ${t}`);if(n<0)throw new I9(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new I9(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new I9(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=m5.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(m5.fromNumber(n)));return 1===i.compare(pOe)&&(i=new m5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=yY(e),[n,i]=MY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);if(!this.At(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new RT(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(0===this.It)return;const t=yY(e),[n,i]=MY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);this.Rt(o)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class I9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class k9{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,x9.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new k9(Ct.min(),i,new k1(Zt),Zs(),sn())}}class x9{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new x9(n,t,sn(),sn(),sn())}}class u_{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class EY{constructor(e,t){this.targetId=e,this.Vt=t}}class SY{constructor(e,t,n=g2.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class PY{constructor(){this.St=0,this.Dt=TY(),this.Ct=g2.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=sn(),t=sn(),n=sn();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:lt()}}),new x9(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=TY()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class gOe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Zs(),this.zt=OY(),this.Wt=new k1(Zt)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:lt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,i)=>{this.te(i)&&t(i)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,s=this.se(n);if(s){const o=s.target;if(n_(o))if(0===i){const a=new Ge(o.path);this.Yt(n,a,F1.newNoDocument(a,Ct.min()))}else mt(1===i);else{const a=this.ie(n);if(a!==i){const c=this.re(e,a);0!==c&&(this.ee(n),this.Wt=this.Wt.insert(n,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=LT.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(l,f,d){var m,E,w,R,z,$;const G={localCacheCount:f,existenceFilterCount:d.count},de=d.unchangedNames;return de&&(G.bloomFilter={applied:0===l,hashCount:null!==(m=de?.hashCount)&&void 0!==m?m:0,bitmapLength:null!==(R=null===(w=null===(E=de?.bits)||void 0===E?void 0:E.bitmap)||void 0===w?void 0:w.length)&&void 0!==R?R:0,padding:null!==($=null===(z=de?.bits)||void 0===z?void 0:z.padding)&&void 0!==$?$:0}),G}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=n;let c,l;try{c=Z3(s).toUint8Array()}catch(f){if(f instanceof IZ)return za("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{l=new RT(c,o,a)}catch(f){return za(f instanceof I9?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(a)||(this.Yt(e,s,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&n_(a.target)){const c=new Ge(a.target.path);null!==this.jt.get(c)||this.ae(o,c)||this.Yt(o,c,F1.newNoDocument(c,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let n=sn();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.se(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const i=new k9(e,t,this.Wt,this.jt,n);return this.jt=Zs(),this.zt=OY(),this.Wt=new k1(Zt),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new PY,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new V1(Zt),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||be("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new PY),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function OY(){return new k1(Ge.comparator)}function TY(){return new k1(Ge.comparator)}const mOe={asc:"ASCENDING",desc:"DESCENDING"},_Oe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vOe={and:"AND",or:"OR"};class COe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zT(r,e){return r.useProto3Json||v9(e)?e:{value:e}}function w5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bY(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function yOe(r,e){return w5(r,e.toTimestamp())}function Ur(r){return mt(!!r),Ct.fromTimestamp(function(e){const t=ul(e);return new cr(t.seconds,t.nanos)}(r))}function DT(r,e){return(t=r,new Hn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function wY(r){const e=Hn.fromString(r);return mt(DY(e)),e}function L9(r,e){return DT(r.databaseId,e.path)}function Fc(r,e){const t=wY(e);if(t.get(1)!==r.databaseId.projectId)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ge(AY(t))}function HT(r,e){return DT(r.databaseId,e)}function R9(r){return new Hn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function AY(r){return mt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function IY(r,e,t){return{name:L9(r,e),fields:t.value.mapValue.fields}}function xY(r,e){return{documents:[HT(r,e.path)]}}function FT(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=HT(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=HT(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return zY(h1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(c){if(0!==c.length)return c.map(l=>{return{field:gl((f=l).field),direction:OOe(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=zT(r,e.limit);var a,c;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function LY(r){let e=function NY(r){const e=wY(r);return 4===e.length?Hn.emptyPath():AY(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){mt(1===n);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(f){const d=RY(f);return d instanceof h1&&ET(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new M5(N5((d=f).field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;t.limit&&(a=function(f){let d;return d="object"==typeof f?f.value:f,v9(d)?null:d}(t.limit));let c=null;var f;t.startAt&&(c=new pl((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new pl(f.values||[],!f.before)}(t.endAt)),function KZ(r,e,t,n,i,s,o,a){return new Y3(r,e,t,n,i,s,o,a)}(e,i,o,s,a,"F",c,l)}function RY(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=N5(e.unaryFilter.field);return Sn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=N5(e.unaryFilter.field);return Sn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=N5(e.unaryFilter.field);return Sn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=N5(e.unaryFilter.field);return Sn.create(s,"!=",{nullValue:"NULL_VALUE"});default:return lt()}}(r):void 0!==r.fieldFilter?Sn.create(N5((e=r).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return lt()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return h1.create(e.compositeFilter.filters.map(t=>RY(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return lt()}}(e.compositeFilter.op))}(r):lt();var e}function OOe(r){return mOe[r]}function TOe(r){return _Oe[r]}function bOe(r){return vOe[r]}function gl(r){return{fieldPath:r.canonicalString()}}function N5(r){return Gr.fromServerFormat(r.fieldPath)}function zY(r){return r instanceof Sn?function(e){if("=="===e.op){if(LZ(e.value))return{unaryFilter:{field:gl(e.field),op:"IS_NAN"}};if(xZ(e.value))return{unaryFilter:{field:gl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(LZ(e.value))return{unaryFilter:{field:gl(e.field),op:"IS_NOT_NAN"}};if(xZ(e.value))return{unaryFilter:{field:gl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gl(e.field),op:TOe(e.op),value:e.value}}}(r):r instanceof h1?function(e){const t=e.getFilters().map(n=>zY(n));return 1===t.length?t[0]:{compositeFilter:{op:bOe(e.op),filters:t}}}(r):lt()}function wOe(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function DY(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class Q3{constructor(e,t,n,i,s=Ct.min(),o=Ct.min(),a=g2.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Q3(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Q3(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Q3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Q3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class HY{constructor(e){this.fe=e}}function $T(r){const e=LY({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?s_(e,e.limit,"L"):e}class s0{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Tr(e.integerValue));else if("doubleValue"in e){const n=Tr(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),C9(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Z3(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?RZ(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):lt()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),Ge.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}s0.Ve=new s0;class DOe{constructor(){this.rn=new jT}addToCollectionParentIndex(e,t){return this.rn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Oo.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Oo.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class jT{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new V1(Hn.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new V1(Hn.comparator)).toArray()}}new Uint8Array(0);class Gi{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Gi(e,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Gi.DEFAULT_COLLECTION_PERCENTILE=10,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gi.DEFAULT=new Gi(41943040,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gi.DISABLED=new Gi(-1,0,0);class a0{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new a0(0)}static Mn(){return new a0(-1)}}class GOe{constructor(){this.changes=new K3(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,F1.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class qOe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class uK{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&A9(n.mutation,i,js.empty(),cr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,sn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=sn()){const i=Vc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=b9();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Vc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,sn()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=Zs();const o=w9(),a=w9();return t.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(void 0===f||f.mutation instanceof X3)?s=s.insert(l.key,l):void 0!==f?(o.set(l.key,f.mutation.getFieldMask()),A9(f.mutation,l,f.mutation.getFieldMask(),cr.now())):o.set(l.key,js.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var d;return a.set(l,new qOe(f,null!==(d=o.get(l))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=w9();let i=new k1((o,a)=>o-a),s=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let f=n.get(c)||js.empty();f=a.applyToLocalView(l,f),n.set(c,f);const d=(i.get(a.batchId)||sn()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,f=c.value,d=rY();f.forEach(m=>{if(!s.has(m)){const E=dY(t.get(m),n.get(m));null!==E&&d.set(m,E),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Ge.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):TT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var i}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ce.resolve(Vc());let a=-1,c=s;return o.next(l=>ce.forEach(l,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(f)?ce.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,sn())).next(f=>({batchId:a,changes:nY(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ge(t)).next(n=>{let i=b9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let s=b9();return this.indexManager.getCollectionParents(e,i).next(o=>ce.forEach(o,a=>{const c=(l=t,f=a.child(i),new Y3(f,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,f;return this.getDocumentsMatchingCollectionQuery(e,c,n).next(l=>{l.forEach((f,d)=>{s=s.insert(f,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(s=>{i.forEach((a,c)=>{const l=c.getKey();null===s.get(l)&&(s=s.insert(l,F1.newInvalidDocument(l)))});let o=b9();return s.forEach((a,c)=>{const l=i.get(a);void 0!==l&&A9(l.mutation,c,js.empty(),cr.now()),T9(t,c)&&(o=o.insert(a,c))}),o})}}class jOe{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ce.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Ur(n.createTime)}),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:$T(n.bundledQuery),readTime:Ur(n.readTime)}),ce.resolve();var n}}class ZOe{constructor(){this.overlays=new k1(Ge.comparator),this.ls=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Vc();return ce.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.we(e,t,s)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Vc(),s=t.length+1,o=new Ge(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new k1((l,f)=>l-f);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=s.get(l.largestBatchId);null===f&&(f=Vc(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const a=Vc(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return ce.resolve(a)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const o=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new xT(t,n));let s=this.ls.get(t);void 0===s&&(s=sn(),this.ls.set(t,s)),this.ls.set(t,s.add(n.key))}}class ZT{constructor(){this.fs=new V1(F2.ds),this.ws=new V1(F2._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new F2(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new F2(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new Ge(new Hn([])),n=new F2(t,e),i=new F2(t,e+1),s=[];return this.ws.forEachInRange([n,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ge(new Hn([])),n=new F2(t,e),i=new F2(t,e+1);let s=sn();return this.ws.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new F2(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class F2{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ge.comparator(e.key,t.key)||Zt(e.As,t.As)}static _s(e,t){return Zt(e.As,t.As)||Ge.comparator(e.key,t.key)}}class YOe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new V1(F2.ds)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.vs;this.vs++;const o=new IT(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Rs=this.Rs.add(new F2(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),s=i<0?0:i;return ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new F2(t,0),i=new F2(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,i],o=>{const a=this.Ps(o.As);s.push(a)}),ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new V1(Zt);return t.forEach(i=>{const s=new F2(i,0),o=new F2(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{n=n.add(a.As)})}),ce.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;Ge.isDocumentKey(s)||(s=s.child(""));const o=new F2(new Ge(s),0);let a=new V1(Zt);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.As)),!0)},o),ce.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(n=>{const i=this.Ps(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){mt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ce.forEach(t.mutations,i=>{const s=new F2(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new F2(t,0),i=this.Rs.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ce.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class KOe{constructor(e){this.Ds=e,this.docs=new k1(Ge.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():F1.newInvalidDocument(t))}getEntries(e,t){let n=Zs();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():F1.newInvalidDocument(i))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Zs();const o=t.path,a=new Ge(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||gT(vZ(f),n)<=0||(i.has(f.key)||T9(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ce.resolve(s)}getAllFromCollectionGroup(e,t,n,i){lt()}Cs(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new XOe(this)}getSize(e){return ce.resolve(this.size)}}class XOe extends GOe{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class QOe{constructor(e){this.persistence=e,this.xs=new K3(t=>X6(t),P9),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Ns=0,this.ks=new ZT,this.targetCount=0,this.Ms=a0.kn()}forEachTarget(e,t){return this.xs.forEach((n,i)=>t(i)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ce.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new a0(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Fn(t),ce.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ce.waitFor(s).next(()=>i)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.ks.containsKey(t))}}class YT{constructor(e,t){this.$s={},this.overlays={},this.Os=new To(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new QOe(this),this.indexManager=new DOe,this.remoteDocumentCache=new KOe(n=>this.referenceDelegate.Ls(n)),this.serializer=new HY(t),this.qs=new jOe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZOe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new YOe(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){be("MemoryPersistence","Starting transaction:",e);const i=new JOe(this.Os.next());return this.referenceDelegate.Us(),n(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return ce.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class JOe extends yPe{constructor(e){super(),this.currentSequenceNumber=e}}class C_{constructor(e){this.persistence=e,this.Qs=new ZT,this.js=null}static zs(e){return new C_(e)}get Ws(){if(this.js)return this.js;throw lt()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Ws,n=>{const i=Ge.fromPath(n);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,Ct.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ce.or([()=>ce.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class JT{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=sn(),i=sn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new JT(e,t.fromCache,n,i)}}class dK{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,n)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(XZ(t))return ce.resolve(null);let n=vs(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=s_(t,null,"F"),n=vs(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=sn(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ji(t,a);return this.zi(t,l,o,c.readTime)?this.Ki(e,s_(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,n,i){return XZ(t)||i.isEqual(Ct.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(s=>{const o=this.ji(t,s);return this.zi(t,o,n,i)?this.Qi(e,t):(dT()<=Wn.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wT(t)),this.Wi(e,o,t,function _Z(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(1e9===n?new cr(t+1,0):new cr(t,n));return new Oo(i,Ge.empty(),e)}(i,-1)))})}ji(e,t){let n=new V1(eY(e));return t.forEach((i,s)=>{T9(e,s)&&(n=n.add(s))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return dT()<=Wn.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",wT(t)),this.Ui.getDocumentsMatchingQuery(e,t,Oo.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class tTe{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new k1(Zt),this.Yi=new K3(s=>X6(s),P9),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uK(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function pK(r,e){return eb.apply(this,arguments)}function eb(){return eb=M(function*(r,e){const t=qe(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let c=sn();for(const l of i){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of s){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({er:l,removedBatchIds:o,addedBatchIds:a}))})})}),eb.apply(this,arguments)}function gK(r){const e=qe(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function iTe(r,e){const t=qe(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function x5(r,e,t){return tb.apply(this,arguments)}function tb(){return tb=M(function*(r,e,t){const n=qe(r),i=n.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!cl(o))throw o;be("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}),tb.apply(this,arguments)}function E_(r,e,t){const n=qe(r);let i=Ct.min(),s=sn();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const f=qe(a),d=f.Yi.get(l);return void 0!==d?ce.resolve(f.Ji.get(d)):f.Bs.getTargetData(c,l)}(n,o,vs(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,t?i:Ct.min(),t?s:sn())).next(a=>(function CK(r,e,t){let n=r.Xi.get(e)||Ct.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Xi.set(e,n)}(n,function JZ(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ir:s})))}class ob{constructor(){this.activeTargetIds=function NT(){return sOe}()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EK{constructor(){this.Hr=new ob,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new ob,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class aTe{Yr(e){}shutdown(){}}class SK{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let O_=null;function cb(){return null===O_?O_=268435456+Math.round(2147483648*Math.random()):O_++,"0x"+O_.toString(16)}const cTe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lTe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Ui="WebChannelConnection";class uTe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,s){const o=cb(),a=this.To(e,t);be("RestConnection",`Sending RPC '${e}' ${o}:`,a,n);const c={};return this.Eo(c,i,s),this.Ao(e,a,c,n).then(l=>(be("RestConnection",`Received RPC '${e}' ${o}: `,l),l),l=>{throw za("RestConnection",`RPC '${e}' ${o} failed with error: `,l,"url: ",a,"request:",n),l})}vo(e,t,n,i,s,o){return this.Io(e,t,n,i,s)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+_5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}To(e,t){return`${this.mo}/v1/${t}:${cTe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const s=cb();return new Promise((o,a)=>{const c=new cPe;c.setWithCredentials(!0),c.listenOnce(sPe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case fT.NO_ERROR:const f=c.getResponseJson();be(Ui,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case fT.TIMEOUT:be(Ui,`RPC '${e}' ${s} timed out`),a(new Te(fe.DEADLINE_EXCEEDED,"Request time out"));break;case fT.HTTP_ERROR:const d=c.getStatus();if(be(Ui,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m?.error;if(E&&E.status&&E.message){const w=function(R){const z=R.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(z)>=0?z:fe.UNKNOWN}(E.status);a(new Te(w,E.message))}else a(new Te(fe.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Te(fe.UNAVAILABLE,"Connection failed."));break;default:lt()}}finally{be(Ui,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);be(Ui,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=cb(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=rPe(),a=iPe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new aPe({})),this.Eo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=s.join("");be(Ui,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=o.createWebChannel(f,c);let m=!1,E=!1;const w=new lTe({ro:z=>{E?be(Ui,`Not sending because RPC '${e}' stream ${i} is closed:`,z):(m||(be(Ui,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),be(Ui,`RPC '${e}' stream ${i} sending:`,z),d.send(z))},oo:()=>d.close()}),R=(z,$,G)=>{z.listen($,de=>{try{G(de)}catch(Ce){setTimeout(()=>{throw Ce},0)}})};return R(d,Wm.EventType.OPEN,()=>{E||be(Ui,`RPC '${e}' stream ${i} transport opened.`)}),R(d,Wm.EventType.CLOSE,()=>{E||(E=!0,be(Ui,`RPC '${e}' stream ${i} transport closed`),w.wo())}),R(d,Wm.EventType.ERROR,z=>{E||(E=!0,za(Ui,`RPC '${e}' stream ${i} transport errored:`,z),w.wo(new Te(fe.UNAVAILABLE,"The operation could not be completed")))}),R(d,Wm.EventType.MESSAGE,z=>{var $;if(!E){const G=z.data[0];mt(!!G);const Ce=G.error||(null===($=G[0])||void 0===$?void 0:$.error);if(Ce){be(Ui,`RPC '${e}' stream ${i} received error:`,Ce);const Le=Ce.status;let tt=function(yn){const Et=n2[yn];if(void 0!==Et)return vY(Et)}(Le),gt=Ce.message;void 0===tt&&(tt=fe.INTERNAL,gt="Unknown error status: "+Le+" with message "+Ce.message),E=!0,w.wo(new Te(tt,gt)),d.close()}else be(Ui,`RPC '${e}' stream ${i} received:`,G),w._o(G)}}),R(a,oPe.STAT_EVENT,z=>{z.stat===fZ.PROXY?be(Ui,`RPC '${e}' stream ${i} detected buffering proxy`):z.stat===fZ.NOPROXY&&be(Ui,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}}function T_(){return typeof document<"u"?document:null}function W9(r){return new COe(r,!0)}class lb{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&be("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class OK{constructor(e,t,n,i,s,o,a,c){this.ii=e,this.$o=n,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new lb(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return M(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return M(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return M(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(Br(t.toString()),Br("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===fe.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Fo===t&&this.Zo(n,i)},n=>{e(()=>{const i=new Te(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(i)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{n(()=>this.tu(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No(M(function*(){e.state=0,e.start()}))}tu(e){return be("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fTe extends OK{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function EOe(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:lt(),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(mt(void 0===l||"string"==typeof l),g2.fromBase64String(l||"")):(mt(void 0===l||l instanceof Uint8Array),g2.fromUint8Array(l||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=void 0===c.code?fe.UNKNOWN:vY(c.code);return new Te(l,c.message||"")}(o);t=new SY(n,i,s,a||null)}else if("documentChange"in e){const n=e.documentChange,i=Fc(r,n.document.name),s=Ur(n.document.updateTime),o=n.document.createTime?Ur(n.document.createTime):Ct.min(),a=new hi({mapValue:{fields:n.document.fields}}),c=F1.newFoundDocument(i,s,o,a);t=new u_(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=Fc(r,n.document),s=n.readTime?Ur(n.readTime):Ct.min(),o=F1.newNoDocument(i,s);t=new u_([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const n=e.documentRemove,i=Fc(r,n.document);t=new u_([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return lt();{const n=e.filter,{count:i=0,unchangedNames:s}=n,o=new hOe(i,s);t=new EY(n.targetId,o)}}var c;return t}(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ct.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?Ct.min():s.readTime?Ur(s.readTime):Ct.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=R9(this.serializer),t.addTarget=function(i,s){let o;const a=s.target;if(o=n_(a)?{documents:xY(i,a)}:{query:FT(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=bY(i,s.resumeToken);const c=zT(i,s.expectedCount);null!==c&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(Ct.min())>0){o.readTime=w5(i,s.snapshotVersion.toTimestamp());const c=zT(i,s.expectedCount);null!==c&&(o.expectedCount=c)}return o}(this.serializer,e);const n=function POe(r,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=R9(this.serializer),t.removeTarget=e,this.Wo(t)}}class dTe extends OK{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(mt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function SOe(r,e){return r&&r.length>0?(mt(void 0!==e),r.map(t=>function(n,i){let s=Ur(n.updateTime?n.updateTime:i);return s.isEqual(Ct.min())&&(s=Ur(i)),new lOe(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Ur(e.commitTime);return this.listener.cu(n,t)}return mt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=R9(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function z9(r,e){let t;if(e instanceof T5)t={update:IY(r,e.key,e.value)};else if(e instanceof b5)t={delete:L9(r,e.key)};else if(e instanceof X3)t={update:IY(r,e.key,e.data),updateMask:wOe(e.fieldMask)};else{if(!(e instanceof AT))return lt();t={verify:L9(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,s){const o=s.transform;if(o instanceof P5)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof J6)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof e0)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof O5)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw lt()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:yOe(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:lt()),t;var i}(this.serializer,n))};this.Wo(t)}}class hTe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,n,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(fe.UNKNOWN,i.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,n,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(fe.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class gTe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Br(t),this.mu=!1):be("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class mTe{constructor(e,t,n,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(a=>{n.enqueueAndForget(M(function*(){var c;Cl(o)&&(be("RemoteStore","Restarting streams for network reachability change."),yield(c=M(function*(l){const f=qe(l);f.vu.add(4),yield L5(f),f.bu.set("Unknown"),f.vu.delete(4),yield q9(f)}),function(l){return c.apply(this,arguments)})(o))}))}),this.bu=new gTe(n,i)}}function q9(r){return fb.apply(this,arguments)}function fb(){return fb=M(function*(r){if(Cl(r))for(const e of r.Ru)yield e(!0)}),fb.apply(this,arguments)}function L5(r){return db.apply(this,arguments)}function db(){return db=M(function*(r){for(const e of r.Ru)yield e(!1)}),db.apply(this,arguments)}function b_(r,e){const t=qe(r);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),gb(t)?pb(t):z5(t).Ko()&&hb(t,e))}function j9(r,e){const t=qe(r),n=z5(t);t.Au.delete(e),n.Ko()&&TK(t,e),0===t.Au.size&&(n.Ko()?n.jo():Cl(t)&&t.bu.set("Unknown"))}function hb(r,e){if(r.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}z5(r).su(e)}function TK(r,e){r.Vu.qt(e),z5(r).iu(e)}function pb(r){r.Vu=new gOe({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),le:e=>r.Au.get(e)||null,ue:()=>r.datastore.serializer.databaseId}),z5(r).start(),r.bu.gu()}function gb(r){return Cl(r)&&!z5(r).Uo()&&r.Au.size>0}function Cl(r){return 0===qe(r).vu.size}function bK(r){r.Vu=void 0}function _Te(r){return mb.apply(this,arguments)}function mb(){return mb=M(function*(r){r.Au.forEach((e,t)=>{hb(r,e)})}),mb.apply(this,arguments)}function vTe(r,e){return _b.apply(this,arguments)}function _b(){return _b=M(function*(r,e){bK(r),gb(r)?(r.bu.Iu(e),pb(r)):r.bu.set("Unknown")}),_b.apply(this,arguments)}function CTe(r,e,t){return vb.apply(this,arguments)}function vb(){return vb=M(function*(r,e,t){if(r.bu.set("Online"),e instanceof SY&&2===e.state&&e.cause)try{yield(n=M(function*(i,s){const o=s.cause;for(const a of s.targetIds)i.Au.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.Au.delete(a),i.Vu.removeTarget(a))}),function(i,s){return n.apply(this,arguments)})(r,e)}catch(n){be("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield w_(r,n)}else if(e instanceof u_?r.Vu.Ht(e):e instanceof EY?r.Vu.ne(e):r.Vu.Xt(e),!t.isEqual(Ct.min()))try{const n=yield gK(r.localStore);t.compareTo(n)>=0&&(yield function(i,s){const o=i.Vu.ce(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.Au.get(c);l&&i.Au.set(c,l.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,c)=>{const l=i.Au.get(a);if(!l)return;i.Au.set(a,l.withResumeToken(g2.EMPTY_BYTE_STRING,l.snapshotVersion)),TK(i,a);const f=new Q3(l.target,a,c,l.sequenceNumber);hb(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(r,t))}catch(n){be("RemoteStore","Failed to raise snapshot:",n),yield w_(r,n)}var n}),vb.apply(this,arguments)}function w_(r,e,t){return Cb.apply(this,arguments)}function Cb(){return Cb=M(function*(r,e,t){if(!cl(e))throw e;r.vu.add(1),yield L5(r),r.bu.set("Offline"),t||(t=()=>gK(r.localStore)),r.asyncQueue.enqueueRetryable(M(function*(){be("RemoteStore","Retrying IndexedDB access"),yield t(),r.vu.delete(1),yield q9(r)}))}),Cb.apply(this,arguments)}function wK(r,e){return e().catch(t=>w_(r,t,e))}function R5(r){return yb.apply(this,arguments)}function yb(){return yb=M(function*(r){const e=qe(r),t=yl(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;yTe(e);)try{const i=yield iTe(e.localStore,n);if(null===i){0===e.Eu.length&&t.jo();break}n=i.batchId,MTe(e,i)}catch(i){yield w_(e,i)}NK(e)&&AK(e)}),yb.apply(this,arguments)}function yTe(r){return Cl(r)&&r.Eu.length<10}function MTe(r,e){r.Eu.push(e);const t=yl(r);t.Ko()&&t.ou&&t.uu(e.mutations)}function NK(r){return Cl(r)&&!yl(r).Uo()&&r.Eu.length>0}function AK(r){yl(r).start()}function ETe(r){return Mb.apply(this,arguments)}function Mb(){return Mb=M(function*(r){yl(r).hu()}),Mb.apply(this,arguments)}function STe(r){return Eb.apply(this,arguments)}function Eb(){return Eb=M(function*(r){const e=yl(r);for(const t of r.Eu)e.uu(t.mutations)}),Eb.apply(this,arguments)}function PTe(r,e,t){return Sb.apply(this,arguments)}function Sb(){return Sb=M(function*(r,e,t){const n=r.Eu.shift(),i=kT.from(n,e,t);yield wK(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield R5(r)}),Sb.apply(this,arguments)}function OTe(r,e){return Pb.apply(this,arguments)}function Pb(){return Pb=M(function*(r,e){var t;e&&yl(r).ou&&(yield(t=M(function*(n,i){if(function _Y(r){switch(r){default:return lt();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}(s=i.code)&&s!==fe.ABORTED){const o=n.Eu.shift();yl(n).Qo(),yield wK(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield R5(n)}var s}),function(n,i){return t.apply(this,arguments)})(r,e)),NK(r)&&AK(r)}),Pb.apply(this,arguments)}function IK(r,e){return Ob.apply(this,arguments)}function Ob(){return Ob=M(function*(r,e){const t=qe(r);t.asyncQueue.verifyOperationInProgress(),be("RemoteStore","RemoteStore received new credentials");const n=Cl(t);t.vu.add(3),yield L5(t),n&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield q9(t)}),Ob.apply(this,arguments)}function bb(){return bb=M(function*(r,e){const t=qe(r);e?(t.vu.delete(2),yield q9(t)):e||(t.vu.add(2),yield L5(t),t.bu.set("Unknown"))}),bb.apply(this,arguments)}function z5(r){return r.Su||(r.Su=function(e,t,n){const i=qe(e);return i.fu(),new fTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:_Te.bind(null,r),ao:vTe.bind(null,r),nu:CTe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Su.Qo(),gb(r)?pb(r):r.bu.set("Unknown")):(yield r.Su.stop(),bK(r))});return function(t){return e.apply(this,arguments)}}())),r.Su}function yl(r){return r.Du||(r.Du=function(e,t,n){const i=qe(e);return i.fu(),new dTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:ETe.bind(null,r),ao:OTe.bind(null,r),au:STe.bind(null,r),cu:PTe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Du.Qo(),yield R5(r)):(yield r.Du.stop(),r.Eu.length>0&&(be("RemoteStore",`Stopping write stream with ${r.Eu.length} pending writes`),r.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),r.Du}class wb{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new p2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new wb(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Te(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function D5(r,e){if(Br("AsyncQueue",`${e}: ${r}`),cl(r))return new Te(fe.UNAVAILABLE,`${e}: ${r}`);throw r}class H5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ge.comparator(t.key,n.key):(t,n)=>Ge.comparator(t.key,n.key),this.keyedMap=b9(),this.sortedSet=new k1(this.comparator)}static emptySet(e){return new H5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof H5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new H5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class kK{constructor(){this.Cu=new k1(Ge.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):lt():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class V5{constructor(e,t,n,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new V5(e,t,H5.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&O9(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class TTe{constructor(){this.Nu=void 0,this.listeners=[]}}class bTe{constructor(){this.queries=new K3(e=>QZ(e),O9),this.onlineState="Unknown",this.ku=new Set}}function Nb(r,e){return Ab.apply(this,arguments)}function Ab(){return Ab=M(function*(r,e){const t=qe(r),n=e.query;let i=!1,s=t.queries.get(n);if(s||(i=!0,s=new TTe),i)try{s.Nu=yield t.onListen(n)}catch(o){const a=D5(o,`Initialization of query '${wT(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&xb(t)}),Ab.apply(this,arguments)}function Ib(r,e){return kb.apply(this,arguments)}function kb(){return kb=M(function*(r,e){const t=qe(r),n=e.query;let i=!1;const s=t.queries.get(n);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),kb.apply(this,arguments)}function wTe(r,e){const t=qe(r);let n=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.$u(i)&&(n=!0);o.Nu=i}}n&&xb(t)}function NTe(r,e,t){const n=qe(r),i=n.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);n.queries.delete(e)}function xb(r){r.ku.forEach(e=>{e.next()})}class Lb{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new V5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=V5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class RK{constructor(e){this.key=e}}class zK{constructor(e){this.key=e}}class DK{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=sn(),this.mutatedKeys=sn(),this.tc=eY(e),this.ec=new H5(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new kK,i=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const m=i.get(f),E=T9(this.query,d)?d:null,w=!!m&&this.mutatedKeys.has(m.key),R=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let z=!1;m&&E?m.data.isEqual(E.data)?w!==R&&(n.track({type:3,doc:E}),z=!0):this.rc(m,E)||(n.track({type:2,doc:E}),z=!0,(c&&this.tc(E,c)>0||l&&this.tc(E,l)<0)&&(a=!0)):!m&&E?(n.track({type:0,doc:E}),z=!0):m&&!E&&(n.track({type:1,doc:m}),z=!0,(c||l)&&(a=!0)),z&&(E?(o=o.add(E),s=R?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{ec:o,ic:n,zi:a,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((l,f)=>function(d,m){const E=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt()}};return E(d)-E(m)}(l.type,f.type)||this.tc(l.doc,f.doc)),this.oc(n);const o=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,0!==s.length||c?{snapshot:new V5(this.query,e.ec,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new kK,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=sn(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new zK(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new RK(n))}),t}hc(e){this.Yu=e.ir,this.Zu=sn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return V5.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class kTe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class xTe{constructor(e){this.key=e,this.fc=!1}}class LTe{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new K3(a=>QZ(a),O9),this._c=new Map,this.mc=new Set,this.gc=new k1(Ge.comparator),this.yc=new Map,this.Ic=new ZT,this.Tc={},this.Ec=new Map,this.Ac=a0.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function RTe(r,e){return Rb.apply(this,arguments)}function Rb(){return Rb=M(function*(r,e){const t=function iw(r){const e=qe(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=HK.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=UTe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HTe.bind(null,e),e.dc.nu=wTe.bind(null,e.eventManager),e.dc.Pc=NTe.bind(null,e.eventManager),e}(r);let n,i;const s=t.wc.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),i=s.view.lc();else{const o=yield function k5(r,e){const t=qe(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Bs.getTargetData(n,e).next(s=>s?(i=s,ce.resolve(i)):t.Bs.allocateTargetId(n).next(o=>(i=new Q3(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ji.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}(t.localStore,vs(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,i=yield function zb(r,e,t,n,i){return Db.apply(this,arguments)}(t,e,n,"current"===a,o.resumeToken),t.isPrimaryClient&&b_(t.remoteStore,o)}return i}),Rb.apply(this,arguments)}function Db(){return Db=M(function*(r,e,t,n,i){r.Rc=(d,m,E)=>{return(w=M(function*(R,z,$,G){let de=z.view.sc($);de.zi&&(de=yield E_(R.localStore,z.query,!1).then(({documents:tt})=>z.view.sc(tt,de)));const Ce=G&&G.targetChanges.get(z.targetId),Le=z.view.applyChanges(de,R.isPrimaryClient,Ce);return jb(R,z.targetId,Le.cc),Le.snapshot}),function(R,z,$,G){return w.apply(this,arguments)})(r,d,m,E);var w};const s=yield E_(r.localStore,e,!0),o=new DK(e,s.ir),a=o.sc(s.documents),c=x9.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=o.applyChanges(a,r.isPrimaryClient,c);jb(r,t,l.cc);const f=new kTe(e,t,o);return r.wc.set(e,f),r._c.has(t)?r._c.get(t).push(e):r._c.set(t,[e]),l.snapshot}),Db.apply(this,arguments)}function zTe(r,e){return Hb.apply(this,arguments)}function Hb(){return Hb=M(function*(r,e){const t=qe(r),n=t.wc.get(e),i=t._c.get(n.targetId);if(i.length>1)return t._c.set(n.targetId,i.filter(s=>!O9(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield x5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),j9(t.remoteStore,n.targetId),F5(t,n.targetId)}).catch(al))):(F5(t,n.targetId),yield x5(t.localStore,n.targetId,!0))}),Hb.apply(this,arguments)}function Vb(){return Vb=M(function*(r,e,t){const n=function sw(r){const e=qe(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VTe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FTe.bind(null,e),e}(r);try{const i=yield function(s,o){const a=qe(s),c=cr.now(),l=o.reduce((m,E)=>m.add(E.key),sn());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=Zs(),w=sn();return a.Zi.getEntries(m,l).next(R=>{E=R,E.forEach((z,$)=>{$.isValidDocument()||(w=w.add(z))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,E)).next(R=>{f=R;const z=[];for(const $ of o){const G=fOe($,f.get($.key).overlayedDocument);null!=G&&z.push(new X3($.key,G,HZ(G.value.mapValue),er.exists(!0)))}return a.mutationQueue.addMutationBatch(m,c,z,o)}).next(R=>{d=R;const z=R.applyToLocalDocumentSet(f,w);return a.documentOverlayCache.saveOverlays(m,R.batchId,z)})}).then(()=>({batchId:d.batchId,changes:nY(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.Tc[s.currentUser.toKey()];c||(c=new k1(Zt)),c=c.insert(o,a),s.Tc[s.currentUser.toKey()]=c}(n,i.batchId,t),yield J3(n,i.changes),yield R5(n.remoteStore)}catch(i){const s=D5(i,"Failed to persist write");t.reject(s)}}),Vb.apply(this,arguments)}function HK(r,e){return Fb.apply(this,arguments)}function Fb(){return Fb=M(function*(r,e){const t=qe(r);try{const n=yield function rTe(r,e){const t=qe(r),n=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const a=[];e.targetChanges.forEach((f,d)=>{const m=i.get(d);if(!m)return;a.push(t.Bs.removeMatchingKeys(s,f.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(s,f.addedDocuments,d)));let E=m.withSequenceNumber(s.currentSequenceNumber);var w,R,z;null!==e.targetMismatches.get(d)?E=E.withResumeToken(g2.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(d,E),R=E,z=f,(0===(w=m).resumeToken.approximateByteSize()||R.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0)&&a.push(t.Bs.updateTargetData(s,E))});let c=Zs(),l=sn();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(function mK(r,e,t){let n=sn(),i=sn();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=Zs();return t.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):be("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:o,sr:i}})}(s,o,e.documentUpdates).next(f=>{c=f.nr,l=f.sr})),!n.isEqual(Ct.min())){const f=t.Bs.getLastRemoteSnapshotVersion(s).next(d=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(f)}return ce.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ji=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.yc.get(s);o&&(mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?mt(o.fc):i.removedDocuments.size>0&&(mt(o.fc),o.fc=!1))}),yield J3(t,n,e)}catch(n){yield al(n)}}),Fb.apply(this,arguments)}function VK(r,e,t){const n=qe(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=qe(s);a.onlineState=o;let c=!1;a.queries.forEach((l,f)=>{for(const d of f.listeners)d.Mu(o)&&(c=!0)}),c&&xb(a)}(n.eventManager,e),i.length&&n.dc.nu(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function HTe(r,e,t){return $b.apply(this,arguments)}function $b(){return $b=M(function*(r,e,t){const n=qe(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.yc.get(e),s=i&&i.key;if(s){let o=new k1(Ge.comparator);o=o.insert(s,F1.newNoDocument(s,Ct.min()));const a=sn().add(s),c=new k9(Ct.min(),new Map,new k1(Zt),o,a);yield HK(n,c),n.gc=n.gc.remove(s),n.yc.delete(e),Zb(n)}else yield x5(n.localStore,e,!1).then(()=>F5(n,e,t)).catch(al)}),$b.apply(this,arguments)}function VTe(r,e){return Bb.apply(this,arguments)}function Bb(){return Bb=M(function*(r,e){const t=qe(r),n=e.batch.batchId;try{const i=yield function nTe(r,e){const t=qe(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const f=c.batch,d=f.keys();let m=ce.resolve();return d.forEach(E=>{m=m.next(()=>l.getEntry(a,E)).next(w=>{const R=c.docVersions.get(E);mt(null!==R),w.version.compareTo(R)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),l.addEntry(w)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(a,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=sn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);qb(t,n,null),Wb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield J3(t,i)}catch(i){yield al(i)}}),Bb.apply(this,arguments)}function FTe(r,e,t){return Gb.apply(this,arguments)}function Gb(){return Gb=M(function*(r,e,t){const n=qe(r);try{const i=yield function(s,o){const a=qe(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(f=>(mt(null!==f),l=f.keys(),a.mutationQueue.removeMutationBatch(c,f))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(n.localStore,e);qb(n,e,t),Wb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield J3(n,i)}catch(i){yield al(i)}}),Gb.apply(this,arguments)}function Wb(r,e){(r.Ec.get(e)||[]).forEach(t=>{t.resolve()}),r.Ec.delete(e)}function qb(r,e,t){const n=qe(r);let i=n.Tc[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function F5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r._c.get(e))r.wc.delete(n),t&&r.dc.Pc(n,t);r._c.delete(e),r.isPrimaryClient&&r.Ic.Is(e).forEach(n=>{r.Ic.containsKey(n)||FK(r,n)})}function FK(r,e){r.mc.delete(e.path.canonicalString());const t=r.gc.get(e);null!==t&&(j9(r.remoteStore,t),r.gc=r.gc.remove(e),r.yc.delete(t),Zb(r))}function jb(r,e,t){for(const n of t)n instanceof RK?(r.Ic.addReference(n.key,e),BTe(r,n)):n instanceof zK?(be("SyncEngine","Document no longer in limbo: "+n.key),r.Ic.removeReference(n.key,e),r.Ic.containsKey(n.key)||FK(r,n.key)):lt()}function BTe(r,e){const t=e.key,n=t.path.canonicalString();r.gc.get(t)||r.mc.has(n)||(be("SyncEngine","New document in limbo: "+t),r.mc.add(n),Zb(r))}function Zb(r){for(;r.mc.size>0&&r.gc.size<r.maxConcurrentLimboResolutions;){const e=r.mc.values().next().value;r.mc.delete(e);const t=new Ge(Hn.fromString(e)),n=r.Ac.next();r.yc.set(n,new xTe(t)),r.gc=r.gc.insert(t,n),b_(r.remoteStore,new Q3(vs(S5(t.path)),n,"TargetPurposeLimboResolution",To.ct))}}function J3(r,e,t){return Yb.apply(this,arguments)}function Yb(){return Yb=M(function*(r,e,t){const n=qe(r),i=[],s=[],o=[];var a;n.wc.isEmpty()||(n.wc.forEach((a,c)=>{o.push(n.Rc(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const f=JT.Li(c.targetId,l);s.push(f)}}))}),yield Promise.all(o),n.dc.nu(i),yield(a=M(function*(c,l){const f=qe(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ce.forEach(l,m=>ce.forEach(m.Fi,E=>f.persistence.referenceDelegate.addReference(d,m.targetId,E)).next(()=>ce.forEach(m.Bi,E=>f.persistence.referenceDelegate.removeReference(d,m.targetId,E)))))}catch(d){if(!cl(d))throw d;be("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const E=f.Ji.get(m),R=E.withLastLimboFreeSnapshotVersion(E.snapshotVersion);f.Ji=f.Ji.insert(m,R)}}}),function(c,l){return a.apply(this,arguments)})(n.localStore,s))}),Yb.apply(this,arguments)}function GTe(r,e){return Kb.apply(this,arguments)}function Kb(){return Kb=M(function*(r,e){const t=qe(r);if(!t.currentUser.isEqual(e)){be("SyncEngine","User change. New user:",e.toKey());const n=yield pK(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(o=>{o.forEach(a=>{a.reject(new Te(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield J3(t,n.er)}var i}),Kb.apply(this,arguments)}function UTe(r,e){const t=qe(r),n=t.yc.get(e);if(n&&n.fc)return sn().add(n.key);{let i=sn();const s=t._c.get(e);if(!s)return i;for(const o of s){const a=t.wc.get(o);i=i.unionWith(a.view.nc)}return i}}class N_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return M(function*(){t.serializer=W9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function hK(r,e,t,n){return new tTe(r,e,t,n)}(this.persistence,new dK,e.initialUser,this.serializer)}createPersistence(e){return new YT(C_.zs,this.serializer)}createSharedClientState(e){return new EK}terminate(){var e=this;return M(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class $5{initialize(e,t){var n=this;return M(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>VK(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=GTe.bind(null,n.syncEngine),yield function Tb(r,e){return bb.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new bTe}createDatastore(e){const t=W9(e.databaseInfo.databaseId),n=new uTe(e.databaseInfo);return new hTe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,s=a=>VK(this.syncEngine,a,0),o=SK.D()?new SK:new aTe,new mTe(t,n,i,s,o);var t,n,i,s,o}createSyncEngine(e,t){return function(n,i,s,o,a,c,l){const f=new LTe(n,i,s,o,a,c);return l&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=M(function*(t){const n=qe(t);be("RemoteStore","RemoteStore shutting down."),n.vu.add(5),yield L5(n),n.Pu.shutdown(),n.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class A_{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Br("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class rbe{constructor(e,t,n,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=H2.UNAUTHENTICATED,this.clientId=gZ.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var o=M(function*(a){be("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(n,o=>(be("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return M(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new p2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(M(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=D5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function I_(r,e){return ow.apply(this,arguments)}function ow(){return ow=M(function*(r,e){r.asyncQueue.verifyOperationInProgress(),be("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=M(function*(s){n.isEqual(s)||(yield pK(e.localStore,s),n=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),ow.apply(this,arguments)}function aw(r,e){return cw.apply(this,arguments)}function cw(){return cw=M(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function lw(r){return uw.apply(this,arguments)}(r);be("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>IK(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,s)=>IK(e.remoteStore,s)),r._onlineComponents=e}),cw.apply(this,arguments)}function uw(){return uw=M(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){be("FirestoreClient","Using user provided OfflineComponentProvider");try{yield I_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function qK(r){return"FirebaseError"===r.name?r.code===fe.FAILED_PRECONDITION||r.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;za("Error using user provided cache. Falling back to memory cache: "+t),yield I_(r,new N_)}}else be("FirestoreClient","Using default OfflineComponentProvider"),yield I_(r,new N_);return r._offlineComponents}),uw.apply(this,arguments)}function k_(r){return fw.apply(this,arguments)}function fw(){return fw=M(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(be("FirestoreClient","Using user provided OnlineComponentProvider"),yield aw(r,r._uninitializedComponentsProvider._online)):(be("FirestoreClient","Using default OnlineComponentProvider"),yield aw(r,new $5))),r._onlineComponents}),fw.apply(this,arguments)}function B5(r){return hw.apply(this,arguments)}function hw(){return hw=M(function*(r){const e=yield k_(r),t=e.eventManager;return t.onListen=RTe.bind(null,e.syncEngine),t.onUnlisten=zTe.bind(null,e.syncEngine),t}),hw.apply(this,arguments)}function QK(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const JK=new Map;function pw(r,e,t){if(!t)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function eX(r){if(!Ge.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function tX(r){if(Ge.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function L_(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(t=r).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof r?"a function":lt()}function In(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Te(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=L_(r);throw new Te(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class rX{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Te(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Te(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function dbe(r,e,t,n){if(!0===e&&!0===n)throw new Te(fe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=QK(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Z9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rX({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Te(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rX(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new uPe;switch(t.type){case"firstParty":return new pPe(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Te(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=JK.get(e);t&&(be("ComponentProvider","Removing Datastore"),JK.delete(e),t.terminate())}(this),Promise.resolve()}}function iX(r,e,t,n={}){var i;const s=(r=In(r,Z9))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&za("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=H2.MOCK_USER;else{a=function zMe(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[fm(JSON.stringify({alg:"none",type:"JWT"})),fm(JSON.stringify(o)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new H2(l)}r._authCredentials=new fPe(new hZ(a,c))}}class Wr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $c(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wr(this.firestore,e,this._key)}}class pi{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new pi(this.firestore,e,this._query)}}class $c extends pi{constructor(e,t,n){super(e,t,S5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wr(this.firestore,null,new Ge(e))}withConverter(e){return new $c(this.firestore,e,this._path)}}function hbe(r,e,...t){if(r=Sr(r),pw("collection","path",e),r instanceof Z9){const n=Hn.fromString(e,...t);return tX(n),new $c(r,null,n)}{if(!(r instanceof Wr||r instanceof $c))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Hn.fromString(e,...t));return tX(n),new $c(r.firestore,null,n)}}function sX(r,e,...t){if(r=Sr(r),1===arguments.length&&(e=gZ.A()),pw("doc","path",e),r instanceof Z9){const n=Hn.fromString(e,...t);return eX(n),new Wr(r,null,new Ge(n))}{if(!(r instanceof Wr||r instanceof $c))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Hn.fromString(e,...t));return eX(n),new Wr(r.firestore,r instanceof $c?r.converter:null,new Ge(n))}}class pbe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new lb(this,"async_queue_retry"),this.Xc=()=>{const t=T_();t&&be("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=T_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=T_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new p2;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return M(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!cl(t))throw t;be("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{throw this.Wc=n,this.Hc=!1,Br("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(n)),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=wb.createAndSchedule(this,e,t,n,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&lt()}verifyOperationInProgress(){}sa(){var e=this;return M(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function gw(r){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(r)}class $1 extends Z9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new pbe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||aX(this),this._firestoreClient.terminate()}}function mbe(r,e){const n="string"==typeof r?r:e||"(default)",i=l5("object"==typeof r?r:CO(),"firestore").getImmediate({identifier:n});if(!i._initialized){const s=(r=>{const e=Iq("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();s&&iX(i,...s)}return i}function r2(r){return r._firestoreClient||aX(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function aX(r){var e,t,n;const i=r._freezeSettings(),s=(a=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new UPe(r._databaseId,a,r._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,QK(l.experimentalLongPollingOptions),l.useFetchStreams));var a,l;r._firestoreClient=new rbe(r._authCredentials,r._appCheckCredentials,r._queue,s),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.cache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class l0{constructor(e){this._byteString=e}static fromBase64String(e){try{return new l0(g2.fromBase64String(e))}catch(t){throw new Te(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new l0(g2.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class G5{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Te(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class R_{constructor(e){this._methodName=e}}class mw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Zt(this._lat,e._lat)||Zt(this._long,e._long)}}const vbe=/^__.*__$/;class Cbe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new X3(e,this.data,this.fieldMask,t,this.fieldTransforms):new T5(e,this.data,t,this.fieldTransforms)}}class uX{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new X3(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fX(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt()}}class z_{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new z_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return H_(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(fX(this.ca)&&vbe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class ybe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||W9(e)}ya(e,t,n,i=!1){return new z_({ca:e,methodName:t,ga:n,path:Gr.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function U5(r){const e=r._freezeSettings(),t=W9(r._databaseId);return new ybe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function _w(r,e,t,n,i,s={}){const o=r.ya(s.merge||s.mergeFields?2:0,e,t,i);Cw("Data must be an object, but it was:",o,n);const a=mX(n,o);let c,l;if(s.merge)c=new js(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const m=X9(e,d,t);if(!o.contains(m))throw new Te(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);vX(f,m)||f.push(m)}c=new js(f),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new Cbe(new hi(a),c,l)}class K9 extends R_{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof K9}}class vw extends R_{_toFieldTransform(e){return new N9(e.path,new P5)}isEqual(e){return e instanceof vw}}function u0(r,e){if(_X(r=Sr(r)))return Cw("Unsupported field value:",e,r),mX(r,e);if(r instanceof R_)return function(t,n){if(!fX(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const i=[];let s=0;for(const o of t){let a=u0(o,n.wa(s));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(r,e)}return function(t,n){if(null===(t=Sr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return oY(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=cr.fromDate(t);return{timestampValue:w5(n.serializer,i)}}if(t instanceof cr){const i=new cr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:w5(n.serializer,i)}}if(t instanceof mw)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof l0)return{bytesValue:bY(n.serializer,t._byteString)};if(t instanceof Wr){const i=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw n._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:DT(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${L_(t)}`)}(r,e)}function mX(r,e){const t={};return NZ(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ll(r,(n,i)=>{const s=u0(i,e.ha(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function _X(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof cr||r instanceof mw||r instanceof l0||r instanceof Wr||r instanceof R_)}function Cw(r,e,t){if(!_X(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=L_(t);throw e._a("an object"===n?r+" a custom object":r+" "+n)}var n}function X9(r,e,t){if((e=Sr(e))instanceof G5)return e._internalPath;if("string"==typeof e)return D_(r,e);throw H_("Field path arguments must be of type string or ",r,!1,void 0,t)}const Pbe=new RegExp("[~\\*/\\[\\]]");function D_(r,e,t){if(e.search(Pbe)>=0)throw H_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new G5(...e.split("."))._internalPath}catch{throw H_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function H_(r,e,t,n,i){const s=n&&!n.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${i}`),c+=")"),new Te(fe.INVALID_ARGUMENT,a+r+c)}function vX(r,e){return r.some(t=>t.isEqual(e))}class yw{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Wr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Obe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(V_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Obe extends yw{data(){return super.data()}}function V_(r,e){return"string"==typeof e?D_(r,e):e instanceof G5?e._internalPath:e._delegate._internalPath}function CX(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Te(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mw{}class Ew extends Mw{}function Tbe(r,e,...t){let n=[];e instanceof Mw&&n.push(e),n=n.concat(t),function(i){const s=i.filter(a=>a instanceof W5).length,o=i.filter(a=>a instanceof Q9).length;if(s>1||s>0&&o>0)throw new Te(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Q9 extends Ew{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Q9(e,t,n)}_apply(e){const t=this._parse(e);return SX(e._query,t),new pi(e.firestore,e.converter,bT(e._query,t))}_parse(e){const t=U5(e.firestore);return function(i,s,o,a,c,l,f){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){EX(f,l);const m=[];for(const E of f)m.push(MX(a,i,E));d={arrayValue:{values:m}}}else d=MX(a,i,f)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||EX(f,l),d=function gX(r,e,t,n=!1){return u0(t,r.ya(n?4:3,e))}(o,"where",f,"in"===l||"not-in"===l);return Sn.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function bbe(r,e,t){const n=e,i=V_("where",r);return Q9._create(i,n,t)}class W5 extends Mw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new W5(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:h1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,i){let s=n;const o=i.getFlattenedFilters();for(const a of o)SX(s,a),s=bT(s,a)}(e._query,t),new pi(e.firestore,e.converter,bT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Sw extends Ew{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Sw(e,t)}_apply(e){const t=function(n,i,s){if(null!==n.startAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new M5(i,s);return function(a,c){if(null===OT(a)){const l=i_(a);null!==l&&PX(0,l,c.field)}}(n,o),o}(e._query,this._field,this._direction);return new pi(e.firestore,e.converter,function(n,i){const s=n.explicitOrderBy.concat([i]);return new Y3(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function wbe(r,e="asc"){const t=e,n=V_("orderBy",r);return Sw._create(n,t)}class F_ extends Ew{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new F_(e,t,n)}_apply(e){return new pi(e.firestore,e.converter,s_(e._query,this._limit,this._limitType))}}function Nbe(r){return function nX(r,e){if(e<=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),F_._create("limit",r,"F")}function MX(r,e,t){if("string"==typeof(t=Sr(t))){if(""===t)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!TT(e)&&-1!==t.indexOf("/"))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Hn.fromString(t));if(!Ge.isDocumentKey(n))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return K6(r,new Ge(n))}if(t instanceof Wr)return K6(r,t._key);throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${L_(t)}.`)}function EX(r,e){if(!Array.isArray(r)||0===r.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SX(r,e){if(e.isInequality()){const n=i_(r),i=e.field;if(null!==n&&!n.isEqual(i))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const s=OT(r);null!==s&&PX(0,i,s)}const t=function(n,i){for(const s of n)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Te(fe.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function PX(r,e,t){if(!t.isEqual(e))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class Abe{convertValue(e,t="none"){switch(dl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Tr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Z3(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw lt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ll(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new mw(Tr(e.latitude),Tr(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Qm(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(y9(e));default:return null}}convertTimestamp(e){const t=ul(e);return new cr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Hn.fromString(e);mt(DY(n));const i=new Y6(n.get(1),n.get(3)),s=new Ge(n.popFirst(5));return i.isEqual(t)||Br(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Pw(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class f0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class q5 extends yw{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new G_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(V_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class G_ extends q5{data(e={}){return super.data(e)}}class j5{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new f0(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new G_(this._firestore,this._userDataWriter,n.key,n,new f0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>({type:"added",doc:new G_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new f0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>i||3!==o.type).map(o=>{const a=new G_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new f0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,l=-1;return 0!==o.type&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),l=s.indexOf(o.doc.key)),{type:kbe(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function kbe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt()}}function xbe(r){r=In(r,Wr);const e=In(r.firestore,$1);return function KK(r,e,t={}){const n=new p2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,s,o,a,c){const l=new A_({next:d=>{s.enqueueAndForget(()=>Ib(i,f));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Te(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&a&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Lb(S5(o.path),l,{includeMetadataChanges:!0,Ku:!0});return Nb(i,f)}(yield B5(r),r.asyncQueue,e,t,n)})),n.promise}(r2(e),r._key).then(t=>Ow(e,r,t))}class Ml extends Abe{constructor(e){super(),this.firestore=e}convertBytes(e){return new l0(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wr(this.firestore,null,t)}}function Lbe(r){r=In(r,pi);const e=In(r.firestore,$1),t=r2(e),n=new Ml(e);return CX(r._query),function XK(r,e,t={}){const n=new p2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,s,o,a,c){const l=new A_({next:d=>{s.enqueueAndForget(()=>Ib(i,f)),d.fromCache&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Lb(o,l,{includeMetadataChanges:!0,Ku:!0});return Nb(i,f)}(yield B5(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new j5(e,n,r,i))}function Rbe(r,e,t){r=In(r,Wr);const n=In(r.firestore,$1),i=Pw(r.converter,e,t);return J9(n,[_w(U5(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,er.none())])}function zbe(r,e,t,...n){r=In(r,Wr);const i=In(r.firestore,$1),s=U5(i);let o;return o="string"==typeof(e=Sr(e))||e instanceof G5?function pX(r,e,t,n,i,s){const o=r.ya(1,e,t),a=[X9(e,n,t)],c=[i];if(s.length%2!=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(X9(e,s[m])),c.push(s[m+1]);const l=[],f=hi.empty();for(let m=a.length-1;m>=0;--m)if(!vX(l,a[m])){const E=a[m];let w=c[m];w=Sr(w);const R=o.da(E);if(w instanceof K9)l.push(E);else{const z=u0(w,R);null!=z&&(l.push(E),f.set(E,z))}}const d=new js(l);return new uX(f,d,o.fieldTransforms)}(s,"updateDoc",r._key,e,t,n):function hX(r,e,t,n){const i=r.ya(1,e,t);Cw("Data must be an object, but it was:",i,n);const s=[],o=hi.empty();ll(n,(c,l)=>{const f=D_(e,c,t);l=Sr(l);const d=i.da(f);if(l instanceof K9)s.push(f);else{const m=u0(l,d);null!=m&&(s.push(f),o.set(f,m))}});const a=new js(s);return new uX(o,a,i.fieldTransforms)}(s,"updateDoc",r._key,e),J9(i,[o.toMutation(r._key,er.exists(!0))])}function Dbe(r){return J9(In(r.firestore,$1),[new b5(r._key,er.none())])}function Hbe(r,e){const t=In(r.firestore,$1),n=sX(r),i=Pw(r.converter,e);return J9(t,[_w(U5(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,er.exists(!1))]).then(()=>n)}function Vbe(r,...e){var t,n,i;r=Sr(r);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||gw(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(gw(e[o])){const d=e[o];e[o]=null===(t=d.next)||void 0===t?void 0:t.bind(d),e[o+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),e[o+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let c,l,f;if(r instanceof Wr)l=In(r.firestore,$1),f=S5(r._key.path),c={next:d=>{e[o]&&e[o](Ow(l,r,d))},error:e[o+1],complete:e[o+2]};else{const d=In(r,pi);l=In(d.firestore,$1),f=d._query;const m=new Ml(l);c={next:E=>{e[o]&&e[o](new j5(l,m,d,E))},error:e[o+1],complete:e[o+2]},CX(r._query)}return function(d,m,E,w){const R=new A_(w),z=new Lb(m,R,E);return d.asyncQueue.enqueueAndForget(M(function*(){return Nb(yield B5(d),z)})),()=>{R.Dc(),d.asyncQueue.enqueueAndForget(M(function*(){return Ib(yield B5(d),z)}))}}(r2(l),f,a,c)}function J9(r,e){return function(t,n){const i=new p2;return t.asyncQueue.enqueueAndForget(M(function*(){return function DTe(r,e,t){return Vb.apply(this,arguments)}(yield function dw(r){return k_(r).then(e=>e.syncEngine)}(t),n,i)})),i.promise}(r2(r),e)}function Ow(r,e,t){const n=t.docs.get(e._key),i=new Ml(r);return new q5(r,i,e._key,n,new f0(t.hasPendingWrites,t.fromCache),e.converter)}function Bc(){return new vw("serverTimestamp")}function bX(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===bX(t[i],n[i]))return!1}return!0}}return r===e}function Tw(r){return null==r||function Xbe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function zRe(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function Qbe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===Tw(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function bo(r,e){if(Tw(r)&&Tw(e))return bX(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}!function(r,e=!0){_5=B6,ms(new Vi("firestore",(t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),o=new $1(new dPe(t.getProvider("auth-internal")),new gPe(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Te(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Y6(a.options.projectId,c)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Pr(dZ,"3.13.0",r),Pr(dZ,"3.13.0","esm2017")}();class we{static fromFunctions(e,t){return new class extends we{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return we.fromFunctions(e,e)}static constant(e,t){return new class extends we{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends we{encode(i){const s=t(i),o={};return Object.keys(s).forEach(a=>{o[a]=e[a].encode(s[a])}),o}decode(i){const s={};return Object.keys(e).reverse().forEach(o=>{s[o]=e[o].decode(i[o])}),n(Object.values(s))}}}static disjunction(e,t){return B.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends we{encode(n){let i=0;for(const s of e){if(!0===s(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=B.getNonNullable(n).type,s=B.getNonNullable(n).encoded;return t[i].decode(s)}}}static list(e){return new class extends we{encode(t){return t.map(n=>{const i=e.encode(n);return B.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class g{static of(e){return new g(e)}static ofNullable(e){return null==e?g.empty():g.of(e)}static empty(){return new g(null)}static getEncoder(e){return new class extends we{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?g.empty():g.of(e.decode(t))}}}constructor(e){u(this,"value",void 0),this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&bo(this.value,e.value)}equalsValue(e){return this.equals(g.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?g.of(e(this.get())):g.empty()}}class Q{static success(e){return new Jbe(e)}static failure(e){return new ewe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&bo(this.get(),e.get())}}class Jbe extends Q{constructor(e){super(),u(this,"value",void 0),u(this,"__nominal",void 0),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return g.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class ewe extends Q{constructor(e){super(),u(this,"reason",void 0),u(this,"__nominal",void 0),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return g.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return Q.failure(this.reason)}}var b;!function(r){r.SUCCESS=Q.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return Q.failure(n)}}(b||(b={})),Pr("firebase","9.23.0","app");const rwe=(r,e)=>e.some(t=>r instanceof t);let wX,NX;const AX=new WeakMap,bw=new WeakMap,IX=new WeakMap,ww=new WeakMap,Nw=new WeakMap;let Aw={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return bw.get(r);if("objectStoreNames"===e)return r.objectStoreNames||IX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return El(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function uwe(r){return"function"==typeof r?function lwe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function swe(){return NX||(NX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(Iw(this),e),El(AX.get(this))}:function(...e){return El(r.apply(Iw(this),e))}:function(e,...t){const n=r.call(Iw(this),e,...t);return IX.set(n,e.sort?e.sort():[e]),El(n)}}(r):(r instanceof IDBTransaction&&function awe(r){if(bw.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});bw.set(r,e)}(r),rwe(r,function iwe(){return wX||(wX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,Aw):r)}function El(r){if(r instanceof IDBRequest)return function owe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(El(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&AX.set(t,r)}).catch(()=>{}),Nw.set(e,r),e}(r);if(ww.has(r))return ww.get(r);const e=uwe(r);return e!==r&&(ww.set(r,e),Nw.set(e,r)),e}const Iw=r=>Nw.get(r),dwe=["get","getKey","getAll","getAllKeys","count"],hwe=["put","add","delete","clear"],kw=new Map;function kX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(kw.get(e))return kw.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=hwe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!dwe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return kw.set(e,s),s}!function cwe(r){Aw=r(Aw)}(r=>({...r,get:(e,t,n)=>kX(e,t)||r.get(e,t,n),has:(e,t)=>!!kX(e,t)||r.has(e,t)}));const xX="@firebase/installations",xw="0.6.4",LX=1e4,RX=`w:${xw}`,zX="FIS_v2",pwe="https://firebaseinstallations.googleapis.com/v1",gwe=36e5,e4=new xc("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function DX(r){return r instanceof So&&r.code.includes("request-failed")}function Lw({projectId:r}){return`${pwe}/projects/${r}/installations`}function HX(r){return{token:r.token,requestStatus:2,expiresIn:Cwe(r.expiresIn),creationTime:Date.now()}}function Rw(r,e){return zw.apply(this,arguments)}function zw(){return zw=M(function*(r,e){const n=(yield e.json()).error;return e4.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),zw.apply(this,arguments)}function VX({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Dw(r){return Hw.apply(this,arguments)}function Hw(){return Hw=M(function*(r){const e=yield r();return e.status>=500&&e.status<600?r():e}),Hw.apply(this,arguments)}function Cwe(r){return Number(r.replace("s","000"))}function Vw(){return Vw=M(function*({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=Lw(r),i=VX(r),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:zX,appId:r.appId,sdkVersion:RX})},c=yield Dw(()=>fetch(n,a));if(c.ok){const l=yield c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:HX(l.authToken)}}throw yield Rw("Create Installation",c)}),Vw.apply(this,arguments)}function $X(r){return new Promise(e=>{setTimeout(e,r)})}const Swe=/^[cdef][\w-]{21}$/,Fw="";function Pwe(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=function Owe(r){return function Ewe(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}(r).substr(0,22)}(r);return Swe.test(t)?t:Fw}catch{return Fw}}function Z5(r){return`${r.appName}!${r.appId}`}const Y5=new Map;function BX(r,e){const t=Z5(r);GX(t,e),function wwe(r,e){const t=function UX(){return!d0&&"BroadcastChannel"in self&&(d0=new BroadcastChannel("[Firebase] FID Change"),d0.onmessage=r=>{GX(r.data.key,r.data.fid)}),d0}();t&&t.postMessage({key:r,fid:e}),function WX(){0===Y5.size&&d0&&(d0.close(),d0=null)}()}(t,e)}function GX(r,e){const t=Y5.get(r);if(t)for(const n of t)n(e)}let d0=null;const Nwe="firebase-installations-database",Awe=1,h0="firebase-installations-store";let $w=null;function Bw(){return $w||($w=function fwe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=El(o);return n&&o.addEventListener("upgradeneeded",c=>{n(El(o.result),c.oldVersion,c.newVersion,El(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(Nwe,Awe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(h0)}})),$w}function W_(r,e){return Gw.apply(this,arguments)}function Gw(){return Gw=M(function*(r,e){const t=Z5(r),i=(yield Bw()).transaction(h0,"readwrite"),s=i.objectStore(h0),o=yield s.get(t);return yield s.put(e,t),yield i.done,(!o||o.fid!==e.fid)&&BX(r,e.fid),e}),Gw.apply(this,arguments)}function Uw(r){return Ww.apply(this,arguments)}function Ww(){return Ww=M(function*(r){const e=Z5(r),n=(yield Bw()).transaction(h0,"readwrite");yield n.objectStore(h0).delete(e),yield n.done}),Ww.apply(this,arguments)}function ed(r,e){return qw.apply(this,arguments)}function qw(){return qw=M(function*(r,e){const t=Z5(r),i=(yield Bw()).transaction(h0,"readwrite"),s=i.objectStore(h0),o=yield s.get(t),a=e(o);return void 0===a?yield s.delete(t):yield s.put(a,t),yield i.done,a&&(!o||o.fid!==a.fid)&&BX(r,a.fid),a}),qw.apply(this,arguments)}function jw(r){return Zw.apply(this,arguments)}function Zw(){return Zw=M(function*(r){let e;const t=yield ed(r.appConfig,n=>{const i=function Iwe(r){return jX(r||{fid:Pwe(),registrationStatus:0})}(n),s=function kwe(r,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(e4.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=function xwe(r,e){return Yw.apply(this,arguments)}(r,t);return{installationEntry:t,registrationPromise:n}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Lwe(r)}:{installationEntry:e}}(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===Fw?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),Zw.apply(this,arguments)}function Yw(){return Yw=M(function*(r,e){try{const t=yield function Mwe(r,e){return Vw.apply(this,arguments)}(r,e);return W_(r.appConfig,t)}catch(t){throw DX(t)&&409===t.customData.serverCode?yield Uw(r.appConfig):yield W_(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}),Yw.apply(this,arguments)}function Lwe(r){return Kw.apply(this,arguments)}function Kw(){return Kw=M(function*(r){let e=yield qX(r.appConfig);for(;1===e.registrationStatus;)yield $X(100),e=yield qX(r.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield jw(r);return n||t}return e}),Kw.apply(this,arguments)}function qX(r){return ed(r,e=>{if(!e)throw e4.create("installation-not-found");return jX(e)})}function jX(r){return function Rwe(r){return 1===r.registrationStatus&&r.registrationTime+LX<Date.now()}(r)?{fid:r.fid,registrationStatus:0}:r}function Xw(){return Xw=M(function*({appConfig:r,heartbeatServiceProvider:e},t){const n=function Dwe(r,{fid:e}){return`${Lw(r)}/${e}/authTokens:generate`}(r,t),i=function FX(r,{refreshToken:e}){const t=VX(r);return t.append("Authorization",function ywe(r){return`${zX} ${r}`}(e)),t}(r,t),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:RX,appId:r.appId}})},c=yield Dw(()=>fetch(n,a));if(c.ok)return HX(yield c.json());throw yield Rw("Generate Auth Token",c)}),Xw.apply(this,arguments)}function Qw(r){return Jw.apply(this,arguments)}function Jw(){return Jw=M(function*(r,e=!1){let t;const n=yield ed(r.appConfig,s=>{if(!YX(s))throw e4.create("not-registered");const o=s.authToken;if(!e&&function Fwe(r){return 2===r.requestStatus&&!function $we(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+gwe}(r)}(o))return s;if(1===o.requestStatus)return t=function Hwe(r,e){return eN.apply(this,arguments)}(r,e),s;{if(!navigator.onLine)throw e4.create("app-offline");const a=function Bwe(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}(s);return t=function Vwe(r,e){return tN.apply(this,arguments)}(r,a),a}});return t?yield t:n.authToken}),Jw.apply(this,arguments)}function eN(){return eN=M(function*(r,e){let t=yield ZX(r.appConfig);for(;1===t.authToken.requestStatus;)yield $X(100),t=yield ZX(r.appConfig);const n=t.authToken;return 0===n.requestStatus?Qw(r,e):n}),eN.apply(this,arguments)}function ZX(r){return ed(r,e=>{if(!YX(e))throw e4.create("not-registered");return function Gwe(r){return 1===r.requestStatus&&r.requestTime+LX<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function tN(){return tN=M(function*(r,e){try{const t=yield function zwe(r,e){return Xw.apply(this,arguments)}(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return yield W_(r.appConfig,n),t}catch(t){if(!DX(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield W_(r.appConfig,n)}else yield Uw(r.appConfig);throw t}}),tN.apply(this,arguments)}function YX(r){return void 0!==r&&2===r.registrationStatus}function nN(){return nN=M(function*(r){const e=r,{installationEntry:t,registrationPromise:n}=yield jw(e);return n?n.catch(console.error):Qw(e).catch(console.error),t.fid}),nN.apply(this,arguments)}function rN(){return rN=M(function*(r,e=!1){const t=r;return yield function qwe(r){return iN.apply(this,arguments)}(t),(yield Qw(t,e)).token}),rN.apply(this,arguments)}function iN(){return iN=M(function*(r){const{registrationPromise:e}=yield jw(r);e&&(yield e)}),iN.apply(this,arguments)}function aN(r){return e4.create("missing-app-config-values",{valueName:r})}const KX="installations",Xwe=r=>{const e=r.getProvider("app").getImmediate(),t=function Ywe(r){if(!r||!r.options)throw aN("App Configuration");if(!r.name)throw aN("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw aN(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:l5(e,"heartbeat"),_delete:()=>Promise.resolve()}},Qwe=r=>{const t=l5(r.getProvider("app").getImmediate(),KX).getImmediate();return{getId:()=>function Uwe(r){return nN.apply(this,arguments)}(t),getToken:i=>function Wwe(r){return rN.apply(this,arguments)}(t,i)}};(function Jwe(){ms(new Vi(KX,Xwe,"PUBLIC")),ms(new Vi("installations-internal",Qwe,"PRIVATE"))})(),Pr(xX,xw),Pr(xX,xw,"esm2017");const cN="@firebase/remote-config",Ys=new xc("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class uNe{constructor(e,t,n,i){this.client=e,this.storage=t,this.storageCache=n,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,i=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return i;e.eTag=i&&i.eTag;const s=yield t.client.fetch(e),o=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&o.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(o),s})()}}function fNe(r=navigator){return r.languages&&r.languages[0]||r.language}class dNe{constructor(e,t,n,i,s,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:t.appId,language_code:fNe()},l={method:"POST",headers:a,body:JSON.stringify(c)},f=fetch(o,l),d=new Promise(($,G)=>{e.signal.addEventListener(()=>{const de=new Error("The operation was aborted.");de.name="AbortError",G(de)})});let m;try{yield Promise.race([f,d]),m=yield f}catch($){let G="fetch-client-network";throw"AbortError"===$?.name&&(G="fetch-timeout"),Ys.create(G,{originalErrorMessage:$?.message})}let E=m.status;const w=m.headers.get("ETag")||void 0;let R,z;if(200===m.status){let $;try{$=yield m.json()}catch(G){throw Ys.create("fetch-client-parse",{originalErrorMessage:G?.message})}R=$.entries,z=$.state}if("INSTANCE_STATE_UNSPECIFIED"===z?E=500:"NO_CHANGE"===z?E=304:("NO_TEMPLATE"===z||"EMPTY_CONFIG"===z)&&(R={}),304!==E&&200!==E)throw Ys.create("fetch-status",{httpStatus:E});return{status:E,eTag:w,config:R}})()}}class gNe{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return M(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var i=this;return M(function*(){yield function hNe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(Ys.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),s}catch(s){if(!function pNe(r){if(!(r instanceof So&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const o={throttleEndTimeMillis:Date.now()+uO(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(o),i.attemptFetch(e,o)}})()}}class vNe{constructor(e,t,n,i,s){this.app=e,this._client=t,this._storageCache=n,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function j_(r,e){const t=r.target.error||void 0;return Ys.create(e,{originalErrorMessage:t&&t?.message})}const p0="app_namespace_store";class ENe{constructor(e,t,n,i=function MNe(){return new Promise((r,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=n=>{e(j_(n,"storage-open"))},t.onsuccess=n=>{r(n.target.result)},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(p0,{keyPath:"compositeKey"})}}catch(t){e(Ys.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([p0],"readonly").objectStore(p0),c=t.createCompositeKey(e);try{const l=a.get(c);l.onerror=f=>{s(j_(f,"storage-get"))},l.onsuccess=f=>{const d=f.target.result;i(d?d.value:void 0)}}catch(l){s(Ys.create("storage-get",{originalErrorMessage:l?.message}))}})})()}set(e,t){var n=this;return M(function*(){const i=yield n.openDbPromise;return new Promise((s,o)=>{const c=i.transaction([p0],"readwrite").objectStore(p0),l=n.createCompositeKey(e);try{const f=c.put({compositeKey:l,value:t});f.onerror=d=>{o(j_(d,"storage-set"))},f.onsuccess=()=>{s()}}catch(f){o(Ys.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([p0],"readwrite").objectStore(p0),c=t.createCompositeKey(e);try{const l=a.delete(c);l.onerror=f=>{s(j_(f,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){s(Ys.create("storage-delete",{originalErrorMessage:l?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class SNe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return M(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const o=yield n;o&&(e.lastSuccessfulFetchTimestampMillis=o);const a=yield i;a&&(e.activeConfig=a)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function ONe(){return hN.apply(this,arguments)}function hN(){return(hN=M(function*(){if(!H6())return!1;try{return yield Bf()}catch{return!1}})).apply(this,arguments)}!function PNe(){ms(new Vi("remote-config",function r(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ys.create("registration-window");if(!H6())throw Ys.create("indexed-db-unavailable");const{projectId:s,apiKey:o,appId:a}=n.options;if(!s)throw Ys.create("registration-project-id");if(!o)throw Ys.create("registration-api-key");if(!a)throw Ys.create("registration-app-id");const c=new ENe(a,n.name,t=t||"firebase"),l=new SNe(c),f=new c5(cN);f.logLevel=Wn.ERROR;const d=new dNe(i,B6,t,s,o,a),m=new gNe(d,c),E=new uNe(m,c,l,f),w=new vNe(n,E,l,c,f);return function aNe(r){const e=Sr(r);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(w),w},"PUBLIC").setMultipleInstances(!0)),Pr(cN,"0.4.4"),Pr(cN,"0.4.4","esm2017")}();const TNe=(r,e)=>e.some(t=>r instanceof t);let eQ,tQ;const nQ=new WeakMap,pN=new WeakMap,rQ=new WeakMap,gN=new WeakMap,mN=new WeakMap;let _N={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return pN.get(r);if("objectStoreNames"===e)return r.objectStoreNames||rQ.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return t4(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function xNe(r){return"function"==typeof r?function kNe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function wNe(){return tQ||(tQ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(vN(this),e),t4(nQ.get(this))}:function(...e){return t4(r.apply(vN(this),e))}:function(e,...t){const n=r.call(vN(this),e,...t);return rQ.set(n,e.sort?e.sort():[e]),t4(n)}}(r):(r instanceof IDBTransaction&&function ANe(r){if(pN.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});pN.set(r,e)}(r),TNe(r,function bNe(){return eQ||(eQ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,_N):r)}function t4(r){if(r instanceof IDBRequest)return function NNe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(t4(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&nQ.set(t,r)}).catch(()=>{}),mN.set(e,r),e}(r);if(gN.has(r))return gN.get(r);const e=xNe(r);return e!==r&&(gN.set(r,e),mN.set(e,r)),e}const vN=r=>mN.get(r);function iQ(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=t4(o);return n&&o.addEventListener("upgradeneeded",c=>{n(t4(o.result),c.oldVersion,c.newVersion,t4(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function CN(r,{blocked:e}={}){const t=indexedDB.deleteDatabase(r);return e&&t.addEventListener("blocked",()=>e()),t4(t).then(()=>{})}const LNe=["get","getKey","getAll","getAllKeys","count"],RNe=["put","add","delete","clear"],yN=new Map;function sQ(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(yN.get(e))return yN.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=RNe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!LNe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return yN.set(e,s),s}!function INe(r){_N=r(_N)}(r=>({...r,get:(e,t,n)=>sQ(e,t)||r.get(e,t,n),has:(e,t)=>!!sQ(e,t)||r.has(e,t)}));const zNe="/firebase-messaging-sw.js",DNe="/firebase-cloud-messaging-push-scope",oQ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",HNe="https://fcmregistrations.googleapis.com/v1",aQ="google.c.a.c_id",VNe="google.c.a.c_l",FNe="google.c.a.ts";var Z_=function(r){return r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked",r}(Z_||{});function n4(r){const e=new Uint8Array(r);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function GNe(r){const t=(r+"=".repeat((4-r.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),i=new Uint8Array(n.length);for(let s=0;s<n.length;++s)i[s]=n.charCodeAt(s);return i}const MN="fcm_token_details_db",UNe=5,cQ="fcm_token_object_Store";function EN(){return EN=M(function*(r){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(MN))return null;let e=null;return(yield iQ(MN,UNe,{upgrade:(n=M(function*(i,s,o,a){var c;if(s<2||!i.objectStoreNames.contains(cQ))return;const l=a.objectStore(cQ),f=yield l.index("fcmSenderId").get(r);if(yield l.clear(),f)if(2===s){const d=f;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:null!==(c=d.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:n4(d.vapidKey)}}}else if(3===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:n4(d.auth),p256dh:n4(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:n4(d.vapidKey)}}}else if(4===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:n4(d.auth),p256dh:n4(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:n4(d.vapidKey)}}}}),function(s,o,a,c){return n.apply(this,arguments)})})).close(),yield CN(MN),yield CN("fcm_vapid_details_db"),yield CN("undefined"),function qNe(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:e}=r;return"number"==typeof r.createTime&&r.createTime>0&&"string"==typeof r.token&&r.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var n}),EN.apply(this,arguments)}const jNe="firebase-messaging-database",ZNe=1,g0="firebase-messaging-store";let SN=null;function PN(){return SN||(SN=iQ(jNe,ZNe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(g0)}})),SN}function lQ(r){return ON.apply(this,arguments)}function ON(){return ON=M(function*(r){const e=NN(r),n=yield(yield PN()).transaction(g0).objectStore(g0).get(e);if(n)return n;{const i=yield function WNe(r){return EN.apply(this,arguments)}(r.appConfig.senderId);if(i)return yield TN(r,i),i}}),ON.apply(this,arguments)}function TN(r,e){return bN.apply(this,arguments)}function bN(){return bN=M(function*(r,e){const t=NN(r),i=(yield PN()).transaction(g0,"readwrite");return yield i.objectStore(g0).put(e,t),yield i.done,e}),bN.apply(this,arguments)}function wN(){return wN=M(function*(r){const e=NN(r),n=(yield PN()).transaction(g0,"readwrite");yield n.objectStore(g0).delete(e),yield n.done}),wN.apply(this,arguments)}function NN({appConfig:r}){return r.appId}const gi=new xc("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function XNe(r,e){return AN.apply(this,arguments)}function AN(){return AN=M(function*(r,e){const t=yield LN(r),n=fQ(e),i={method:"POST",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(xN(r.appConfig),i)).json()}catch(o){throw gi.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error)throw gi.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw gi.create("token-subscribe-no-token");return s.token}),AN.apply(this,arguments)}function IN(){return IN=M(function*(r,e){const t=yield LN(r),n=fQ(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(`${xN(r.appConfig)}/${e.token}`,i)).json()}catch(o){throw gi.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error)throw gi.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw gi.create("token-update-no-token");return s.token}),IN.apply(this,arguments)}function uQ(r,e){return kN.apply(this,arguments)}function kN(){return kN=M(function*(r,e){const n={method:"DELETE",headers:yield LN(r)};try{const s=yield(yield fetch(`${xN(r.appConfig)}/${e}`,n)).json();if(s.error)throw gi.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(i){throw gi.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}}),kN.apply(this,arguments)}function xN({projectId:r}){return`${HNe}/projects/${r}/registrations`}function LN(r){return RN.apply(this,arguments)}function RN(){return RN=M(function*({appConfig:r,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),RN.apply(this,arguments)}function fQ({p256dh:r,auth:e,endpoint:t,vapidKey:n}){const i={web:{endpoint:t,auth:e,p256dh:r}};return n!==oQ&&(i.web.applicationPubKey=n),i}const JNe=6048e5;function zN(){return zN=M(function*(r){const e=yield function nAe(r,e){return FN.apply(this,arguments)}(r.swRegistration,r.vapidKey),t={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:e.endpoint,auth:n4(e.getKey("auth")),p256dh:n4(e.getKey("p256dh"))},n=yield lQ(r.firebaseDependencies);if(n){if(function rAe(r,e){return e.vapidKey===r.vapidKey&&e.endpoint===r.endpoint&&e.auth===r.auth&&e.p256dh===r.p256dh}(n.subscriptionOptions,t))return Date.now()>=n.createTime+JNe?function tAe(r,e){return HN.apply(this,arguments)}(r,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{yield uQ(r.firebaseDependencies,n.token)}catch(i){console.warn(i)}return hQ(r.firebaseDependencies,t)}return hQ(r.firebaseDependencies,t)}),zN.apply(this,arguments)}function DN(){return DN=M(function*(r){const e=yield lQ(r.firebaseDependencies);e&&(yield uQ(r.firebaseDependencies,e.token),yield function YNe(r){return wN.apply(this,arguments)}(r.firebaseDependencies));const t=yield r.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),DN.apply(this,arguments)}function HN(){return HN=M(function*(r,e){try{const t=yield function QNe(r,e){return IN.apply(this,arguments)}(r.firebaseDependencies,e),n=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield TN(r.firebaseDependencies,n),t}catch(t){throw yield function dQ(r){return DN.apply(this,arguments)}(r),t}}),HN.apply(this,arguments)}function hQ(r,e){return VN.apply(this,arguments)}function VN(){return VN=M(function*(r,e){const n={token:yield XNe(r,e),createTime:Date.now(),subscriptionOptions:e};return yield TN(r,n),n.token}),VN.apply(this,arguments)}function FN(){return FN=M(function*(r,e){return(yield r.pushManager.getSubscription())||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:GNe(e)})}),FN.apply(this,arguments)}function pQ(r){const e={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return function iAe(r,e){if(!e.notification)return;r.notification={};const t=e.notification.title;t&&(r.notification.title=t);const n=e.notification.body;n&&(r.notification.body=n);const i=e.notification.image;i&&(r.notification.image=i);const s=e.notification.icon;s&&(r.notification.icon=s)}(e,r),function sAe(r,e){e.data&&(r.data=e.data)}(e,r),function oAe(r,e){var t,n,i,s,o;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;r.fcmOptions={};const a=null!==(i=null===(n=e.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==i?i:null===(s=e.notification)||void 0===s?void 0:s.click_action;a&&(r.fcmOptions.link=a);const c=null===(o=e.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(r.fcmOptions.analyticsLabel=c)}(e,r),e}function gQ(r,e){const t=[];for(let n=0;n<r.length;n++)t.push(r.charAt(n)),n<e.length&&t.push(e.charAt(n));return t.join("")}function $N(r){return gi.create("missing-app-config-values",{valueName:r})}gQ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),gQ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class lAe{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function cAe(r){if(!r||!r.options)throw $N("App Configuration Object");if(!r.name)throw $N("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=r;for(const n of e)if(!t[n])throw $N(n);return{appName:r.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function BN(){return BN=M(function*(r){try{r.swRegistration=yield navigator.serviceWorker.register(zNe,{scope:DNe}),r.swRegistration.update().catch(()=>{})}catch(e){throw gi.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),BN.apply(this,arguments)}function GN(){return GN=M(function*(r,e){if(!e&&!r.swRegistration&&(yield function mQ(r){return BN.apply(this,arguments)}(r)),e||!r.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw gi.create("invalid-sw-registration");r.swRegistration=e}}),GN.apply(this,arguments)}function UN(){return UN=M(function*(r,e){e?r.vapidKey=e:r.vapidKey||(r.vapidKey=oQ)}),UN.apply(this,arguments)}function WN(){return WN=M(function*(r,e){if(!navigator)throw gi.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw gi.create("permission-blocked");return yield function fAe(r,e){return UN.apply(this,arguments)}(r,e?.vapidKey),yield function uAe(r,e){return GN.apply(this,arguments)}(r,e?.serviceWorkerRegistration),function eAe(r){return zN.apply(this,arguments)}(r)}),WN.apply(this,arguments)}function qN(){return qN=M(function*(r,e,t){const n=function hAe(r){switch(r){case Z_.NOTIFICATION_CLICKED:return"notification_open";case Z_.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield r.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[aQ],message_name:t[VNe],message_time:t[FNe],message_device_time:Math.floor(Date.now()/1e3)})}),qN.apply(this,arguments)}function jN(){return jN=M(function*(r,e){const t=e.data;if(!t.isFirebaseMessaging)return;r.onMessageHandler&&t.messageType===Z_.PUSH_RECEIVED&&("function"==typeof r.onMessageHandler?r.onMessageHandler(pQ(t)):r.onMessageHandler.next(pQ(t)));const n=t.data;(function aAe(r){return"object"==typeof r&&!!r&&aQ in r})(n)&&"1"===n["google.c.a.e"]&&(yield function dAe(r,e,t){return qN.apply(this,arguments)}(r,t.messageType,n))}),jN.apply(this,arguments)}const vQ="@firebase/messaging",gAe=r=>{const e=new lAe(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function pAe(r,e){return jN.apply(this,arguments)}(e,t)),e},mAe=r=>{const e=r.getProvider("messaging").getImmediate();return{getToken:n=>function _Q(r,e){return WN.apply(this,arguments)}(e,n)}};function yQ(){return ZN.apply(this,arguments)}function ZN(){return(ZN=M(function*(){try{yield Bf()}catch{return!1}return typeof window<"u"&&H6()&&aO()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function _Ae(){ms(new Vi("messaging",gAe,"PUBLIC")),ms(new Vi("messaging-internal",mAe,"PRIVATE")),Pr(vQ,"0.12.4"),Pr(vQ,"0.12.4","esm2017")}();const Y_="analytics",yAe="firebase_id",MAe="origin",EAe=6e4,SAe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",XN="https://www.googletagmanager.com/gtag/js",$2=new c5("@firebase/analytics"),Cs=new xc("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function OAe(r){if(!r.startsWith(XN)){const e=Cs.create("invalid-gtag-resource",{gtagURL:r});return $2.warn(e.message),""}return r}function MQ(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function QN(){return QN=M(function*(r,e,t,n,i,s){const o=n[i];try{if(o)yield e[o];else{const c=(yield MQ(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){$2.error(a)}r("config",i,s)}),QN.apply(this,arguments)}function JN(){return JN=M(function*(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=yield MQ(t);for(const c of o){const l=a.find(d=>d.measurementId===c),f=l&&e[l.appId];if(!f){s=[];break}s.push(f)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),r("event",n,i||{})}catch(s){$2.error(s)}}),JN.apply(this,arguments)}const LAe=30,EQ=new class zAe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function DAe(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function eA(){return eA=M(function*(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:DAe(n)},s=SAe.replace("{app-id}",t),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let a="";try{const c=yield o.json();null!==(e=c.error)&&void 0!==e&&e.message&&(a=c.error.message)}catch{}throw Cs.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}),eA.apply(this,arguments)}function tA(){return tA=M(function*(r,e=EQ,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw Cs.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Cs.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new BAe;return setTimeout(M(function*(){a.abort()}),void 0!==t?t:EAe),SQ({appId:n,apiKey:i,measurementId:s},o,a,e)}),tA.apply(this,arguments)}function SQ(r,e,t){return nA.apply(this,arguments)}function nA(){return nA=M(function*(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=EQ){var s;const{appId:o,measurementId:a}=r;try{yield function FAe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(Cs.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,e)}catch(c){if(a)return $2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:a};throw c}try{const c=yield function HAe(r){return eA.apply(this,arguments)}(r);return i.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!function $Ae(r){if(!(r instanceof So&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(i.deleteThrottleMetadata(o),a)return $2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:o,measurementId:a};throw c}const f=503===Number(null===(s=l?.customData)||void 0===s?void 0:s.httpStatus)?uO(t,i.intervalMillis,LAe):uO(t,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return i.setThrottleMetadata(o,d),$2.debug(`Calling attemptFetch again in ${f} millis`),SQ(r,d,n,i)}}),nA.apply(this,arguments)}class BAe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let rA,uA;function iA(){return iA=M(function*(r,e,t,n,i){if(i&&i.global)r("event",t,n);else{const s=yield e;r("event",t,Object.assign(Object.assign({},n),{send_to:s}))}}),iA.apply(this,arguments)}function fA(){return fA=M(function*(){if(!H6())return $2.warn(Cs.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Bf()}catch(r){return $2.warn(Cs.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}return!0}),fA.apply(this,arguments)}function dA(){return dA=M(function*(r,e,t,n,i,s,o){var a;const c=function VAe(r){return tA.apply(this,arguments)}(r);c.then(E=>{t[E.measurementId]=E.appId,r.options.measurementId&&E.measurementId!==r.options.measurementId&&$2.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>$2.error(E)),e.push(c);const l=function YAe(){return fA.apply(this,arguments)}().then(E=>{if(E)return n.getId()}),[f,d]=yield Promise.all([c,l]);(function xAe(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(XN)&&t.src.includes(r))return t;return null})(s)||function bAe(r,e){const t=function TAe(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}("firebase-js-sdk-policy",{createScriptURL:OAe}),n=document.createElement("script"),i=`${XN}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}(s,f.measurementId),uA&&(i("consent","default",uA),function PQ(r){uA=r}(void 0)),i("js",new Date);const m=null!==(a=o?.config)&&void 0!==a?a:{};return m[MAe]="firebase",m.update=!0,null!=d&&(m[yAe]=d),i("config",f.measurementId,m),rA&&(i("set",rA),function OQ(r){rA=r}(void 0)),f.measurementId}),dA.apply(this,arguments)}class XAe{constructor(e){this.app=e}_delete(){return delete Gc[this.app.options.appId],Promise.resolve()}}let Gc={},TQ=[];const bQ={};let NQ,Uc,K_="dataLayer",hA=!1;function JAe(r,e,t){!function QAe(){const r=[];if(oO()&&r.push("This is a browser extension environment."),aO()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=Cs.create("invalid-analytics-context",{errorInfo:e});$2.warn(t.message)}}();const n=r.options.appId;if(!n)throw Cs.create("no-app-id");if(!r.options.apiKey){if(!r.options.measurementId)throw Cs.create("no-api-key");$2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Gc[n])throw Cs.create("already-exists",{id:n});if(!hA){!function wAe(r){let e=[];Array.isArray(window[r])?e=window[r]:window[r]=e}(K_);const{wrappedGtag:s,gtagCore:o}=function kAe(r,e,t,n,i){let s=function(...o){window[n].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function IAe(r,e,t,n){function s(){return s=M(function*(o,...a){try{if("event"===o){const[c,l]=a;yield function AAe(r,e,t,n,i){return JN.apply(this,arguments)}(r,e,t,c,l)}else if("config"===o){const[c,l]=a;yield function NAe(r,e,t,n,i,s){return QN.apply(this,arguments)}(r,e,t,n,c,l)}else if("consent"===o){const[c]=a;r("consent","update",c)}else if("get"===o){const[c,l,f]=a;r("get",c,l,f)}else if("set"===o){const[c]=a;r("set",c)}else r(o,...a)}catch(c){$2.error(c)}}),s.apply(this,arguments)}return function i(o){return s.apply(this,arguments)}}(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}(Gc,TQ,bQ,K_,"gtag");Uc=s,NQ=o,hA=!0}return Gc[n]=function KAe(r,e,t,n,i,s,o){return dA.apply(this,arguments)}(r,TQ,bQ,e,NQ,K_,t),new XAe(r)}function tIe(){return pA.apply(this,arguments)}function pA(){return(pA=M(function*(){if(oO()||!aO()||!H6())return!1;try{return yield Bf()}catch{return!1}})).apply(this,arguments)}const AQ="@firebase/analytics";!function rIe(){ms(new Vi(Y_,(e,{options:t})=>JAe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),ms(new Vi("analytics-internal",function r(e){try{const t=e.getProvider(Y_).getImmediate();return{logEvent:(n,i,s)=>function nIe(r,e,t,n){r=Sr(r),function GAe(r,e,t,n,i){return iA.apply(this,arguments)}(Uc,Gc[r.app.options.appId],e,t,n).catch(i=>$2.error(i))}(t,n,i,s)}}catch(t){throw Cs.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Pr(AQ,"0.10.0"),Pr(AQ,"0.10.0","esm2017")}();class iIe extends En{constructor(e,t){super()}schedule(e,t=0){return this}}const X_={setInterval(r,e,...t){const{delegate:n}=X_;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=X_;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class kQ extends iIe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return X_.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&X_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(s){n=!0,i=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,v3(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const mA={now:()=>(mA.delegate||Date).now(),delegate:void 0};class td{constructor(e,t=td.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}td.now=mA.now;class xQ extends td{constructor(e,t=td.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const aIe=new class oIe extends xQ{}(class sIe extends kQ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),cIe=new xQ(kQ),Q_=new w8("7.6.1"),_A="__angularfire_symbol__analyticsIsSupportedValue",vA="__angularfire_symbol__analyticsIsSupported",CA="__angularfire_symbol__remoteConfigIsSupportedValue",yA="__angularfire_symbol__remoteConfigIsSupported",MA="__angularfire_symbol__messagingIsSupportedValue",EA="__angularfire_symbol__messagingIsSupported";function PA(r,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(o=>o.app===t);if(1===s.length)return s[0]}return t.container.getProvider(r).getImmediate({optional:!0})}globalThis[vA]||(globalThis[vA]=tIe().then(r=>globalThis[_A]=r).catch(()=>globalThis[_A]=!1)),globalThis[EA]||(globalThis[EA]=yQ().then(r=>globalThis[MA]=r).catch(()=>globalThis[MA]=!1)),globalThis[yA]||(globalThis[yA]=ONe().then(r=>globalThis[CA]=r).catch(()=>globalThis[CA]=!1));const OA=(r,e)=>{const t=e?[e]:Uq(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n};function K5(){}class LQ{constructor(e,t=aIe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,n)}}class lIe{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",K5,{},K5,K5)),t.pipe(Hi({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let TA=(()=>{class r{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new LQ(Zone.current)),this.insideAngular=t.run(()=>new LQ(Zone.current,cIe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return r.\u0275fac=function(t){return new(t||r)(Oe(u1))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function m0(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function _0(r){return m0().ngZone.run(()=>r())}function fIe(r){return m0(),function dIe(r){return function(t){return(t=t.lift(new lIe(r.ngZone))).pipe(Ph(r.outsideAngular),Sh(r.insideAngular))}}(m0())(r)}const hIe=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),_0(()=>r.apply(void 0,n))},B1=(r,e)=>function(){let t;const n=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof n[s]&&(e&&(t||(t=_0(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",K5,{},K5,K5)))),n[s]=hIe(n[s],t));const i=function uIe(r){return m0().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof T1){const s=m0();return i.pipe(Ph(s.outsideAngular),Sh(s.insideAngular))}return _0(()=>i)}return i instanceof T1?i.pipe(fIe):i instanceof Promise?_0(()=>new Promise((s,o)=>i.then(a=>_0(()=>s(a)),a=>_0(()=>o(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:_0(()=>i)};class X5{constructor(e){return e}}class bA{constructor(){return Uq()}}const wA=new et("angularfire2._apps"),gIe={provide:X5,useFactory:function pIe(r){return r&&1===r.length?r[0]:new X5(CO())},deps:[[new fs,wA]]},mIe={provide:bA,deps:[[new fs,wA]]};function _Ie(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new X5(n)}}let vIe=(()=>{class r{constructor(t){Pr("angularfire",Q_.full,"core"),Pr("angularfire",Q_.full,"app"),Pr("angular",wH.full,t.toString())}}return r.\u0275fac=function(t){return new(t||r)(Oe(N3))},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({providers:[gIe,mIe]}),r})();const yIe=B1(Gq,!0),NA=new Map,RQ={activated:!1,tokenObservers:[]},MIe={initialized:!1,enabled:!1};function br(r){return NA.get(r)||Object.assign({},RQ)}function J_(){return MIe}const AA="https://content-firebaseappcheck.googleapis.com/v1",OIe="exchangeDebugToken",zQ={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class bIe{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return M(function*(){t.stop();try{t.pending=new pm,yield function wIe(r){return new Promise(e=>{setTimeout(e,r)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new pm,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const mi=new xc("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function IA(r){if(!br(r).activated)throw mi.create("use-before-activation",{appName:r.name})}function nv(r,e){return xA.apply(this,arguments)}function xA(){return xA=M(function*({url:r,body:e},t){const n={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&(n["X-Firebase-Client"]=d)}const s={method:"POST",body:JSON.stringify(e),headers:n};let o,a;try{o=yield fetch(r,s)}catch(d){throw mi.create("fetch-network-error",{originalErrorMessage:d?.message})}if(200!==o.status)throw mi.create("fetch-status-error",{httpStatus:o.status});try{a=yield o.json()}catch(d){throw mi.create("fetch-parse-error",{originalErrorMessage:d?.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw mi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const l=1e3*Number(c[1]),f=Date.now();return{token:a.token,expireTimeMillis:f+l,issuedAtTimeMillis:f}}),xA.apply(this,arguments)}function DQ(r,e){const{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${AA}/projects/${t}/apps/${n}:${OIe}?key=${i}`,body:{debug_token:e}}}const kIe="firebase-app-check-database",xIe=1,nd="firebase-app-check-store";let rv=null;function LA(){return LA=M(function*(r,e){const n=(yield function VQ(){return rv||(rv=new Promise((r,e)=>{try{const t=indexedDB.open(kIe,xIe);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(mi.create("storage-open",{originalErrorMessage:null===(i=n.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(nd,{keyPath:"compositeKey"})}}catch(t){e(mi.create("storage-open",{originalErrorMessage:t?.message}))}}),rv)}()).transaction(nd,"readwrite"),s=n.objectStore(nd).put({compositeKey:r,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var l;a(mi.create("storage-set",{originalErrorMessage:null===(l=c.target.error)||void 0===l?void 0:l.message}))}})}),LA.apply(this,arguments)}const rd=new c5("@firebase/app-check");function DA(r,e){return H6()?function RIe(r,e){return function FQ(r,e){return LA.apply(this,arguments)}(function BQ(r){return`${r.options.appId}-${r.name}`}(r),e)}(r,e).catch(t=>{rd.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function VA(){return J_().enabled}function FA(){return $A.apply(this,arguments)}function $A(){return $A=M(function*(){const r=J_();if(r.enabled&&r.token)return r.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),$A.apply(this,arguments)}const $Ie={error:"UNKNOWN_ERROR"};function BIe(r){return sO.encodeString(JSON.stringify(r),!1)}function iv(r){return BA.apply(this,arguments)}function BA(){return BA=M(function*(r,e=!1){const t=r.app;IA(t);const n=br(t);let s,i=n.token;if(i&&!Q5(i)&&(n.token=void 0,i=void 0),!i){const c=yield n.cachedTokenPromise;c&&(Q5(c)?i=c:yield DA(t,void 0))}if(!e&&i&&Q5(i))return{token:i.token};let a,o=!1;if(VA()){n.exchangeTokenPromise||(n.exchangeTokenPromise=nv(DQ(t,yield FA()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);const c=yield n.exchangeTokenPromise;return yield DA(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield br(t).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?rd.warn(c.message):rd.error(c),s=c}return i?s?a=Q5(i)?{token:i.token,internalError:s}:qQ(s):(a={token:i.token},n.token=i,yield DA(t,i)):a=qQ(s),o&&function WQ(r,e){const t=br(r).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(t,a),a}),BA.apply(this,arguments)}function GA(){return GA=M(function*(r){const e=r.app;IA(e);const{provider:t}=br(e);if(VA()){const n=yield FA(),{token:i}=yield nv(DQ(e,n),r.heartbeatServiceProvider);return{token:i}}{const{token:n}=yield t.getToken();return{token:n}}}),GA.apply(this,arguments)}function WA(r,e){const t=br(r),n=t.tokenObservers.filter(i=>i.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function UQ(r){const{app:e}=r,t=br(e);let n=t.tokenRefresher;n||(n=function GIe(r){const{app:e}=r;return new bIe(M(function*(){let n;if(n=br(e).token?yield iv(r,!0):yield iv(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=br(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},zQ.RETRIAL_MIN_WAIT,zQ.RETRIAL_MAX_WAIT)}(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function Q5(r){return r.expireTimeMillis-Date.now()>0}function qQ(r){return{token:BIe($Ie),error:r}}class UIe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=br(this.app);for(const t of e)WA(this.app,t.next);return Promise.resolve()}}const eJ="app-check-internal";!function ike(){ms(new Vi("app-check",r=>function WIe(r,e){return new UIe(r,e)}(r.getProvider("app").getImmediate(),r.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(eJ).initialize()})),ms(new Vi(eJ,r=>function qIe(r){return{getToken:e=>iv(r,e),getLimitedUseToken:()=>function GQ(r){return GA.apply(this,arguments)}(r),addTokenListener:e=>function UA(r,e,t,n){const{app:i}=r,s=br(i);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:n,type:e}],s.token&&Q5(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),UQ(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>UQ(r))}(r,"INTERNAL",e),removeTokenListener:e=>WA(r.app,e)}}(r.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),Pr("@firebase/app-check","0.8.0")}();class YA{constructor(){return OA("app-check")}}typeof window<"u"&&window;const lke=function nJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},rJ=new xc("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ov=new c5("@firebase/auth");function av(r,...e){ov.logLevel<=Wn.ERROR&&ov.error(`Auth (${B6}): ${r}`,...e)}function Ks(r,...e){throw XA(r,...e)}function wo(r,...e){return XA(r,...e)}function iJ(r,e,t){const n=Object.assign(Object.assign({},lke()),{[e]:t});return new xc("auth","Firebase",n).create(e,{appName:r.name})}function XA(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return rJ.create(r,...e)}function He(r,e,...t){if(!r)throw XA(e,...t)}function Wc(r){const e="INTERNAL ASSERTION FAILED: "+r;throw av(e),new Error(e)}function r4(r,e){r||Wc(e)}function id(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function sJ(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}class sd{constructor(e,t){this.shortDelay=e,this.longDelay=t,r4(t>e,"Short delay should be less than long delay!"),this.isMobile=function DMe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(R2())}()||function VMe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function fke(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function QA(){return"http:"===sJ()||"https:"===sJ()}()||oO()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function JA(r,e){r4(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class oJ{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Wc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Wc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Wc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const hke={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},pke=new sd(3e4,6e4);function lr(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function wr(r,e,t,n){return eI.apply(this,arguments)}function eI(){return eI=M(function*(r,e,t,n,i={}){return aJ(r,i,M(function*(){let s={},o={};n&&("GET"===e?o=n:s={body:JSON.stringify(n)});const a=Gf(Object.assign({key:r.config.apiKey},o)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),oJ.fetch()(cJ(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))}))}),eI.apply(this,arguments)}function aJ(r,e,t){return tI.apply(this,arguments)}function tI(){return tI=M(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},hke),e);try{const i=new gke(r),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=yield s.json();if("needConfirmation"in o)throw od(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw od(r,"credential-already-in-use",o);if("EMAIL_EXISTS"===c)throw od(r,"email-already-in-use",o);if("USER_DISABLED"===c)throw od(r,"user-disabled",o);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw iJ(r,f,l);Ks(r,f)}}catch(i){if(i instanceof So)throw i;Ks(r,"network-request-failed",{message:String(i)})}}),tI.apply(this,arguments)}function i4(r,e,t,n){return nI.apply(this,arguments)}function nI(){return nI=M(function*(r,e,t,n,i={}){const s=yield wr(r,e,t,n,i);return"mfaPendingCredential"in s&&Ks(r,"multi-factor-auth-required",{_serverResponse:s}),s}),nI.apply(this,arguments)}function cJ(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?JA(r.config,i):`${r.config.apiScheme}://${i}`}class gke{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(wo(this.auth,"network-request-failed")),pke.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function od(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=wo(r,e,n);return i.customData._tokenResponse=t,i}function rI(){return rI=M(function*(r,e){return wr(r,"POST","/v1/accounts:delete",e)}),rI.apply(this,arguments)}function sI(){return sI=M(function*(r,e){return wr(r,"POST","/v1/accounts:lookup",e)}),sI.apply(this,arguments)}function ad(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function oI(){return oI=M(function*(r,e=!1){const t=Sr(r),n=yield t.getIdToken(e),i=cv(n);He(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:n,authTime:ad(aI(i.auth_time)),issuedAtTime:ad(aI(i.iat)),expirationTime:ad(aI(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}),oI.apply(this,arguments)}function aI(r){return 1e3*Number(r)}function cv(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return av("JWT malformed, contained fewer than 3 sections"),null;try{const i=dm(t);return i?JSON.parse(i):(av("Failed to decode base64 JWT payload"),null)}catch(i){return av("Caught error parsing JWT payload as JSON",i?.toString()),null}}function s4(r,e){return cI.apply(this,arguments)}function cI(){return cI=M(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof So&&function Mke({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}}),cI.apply(this,arguments)}class Eke{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(M(function*(){yield t.iteration()}),n)}iteration(){var e=this;return M(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class lJ{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ad(this.lastLoginAt),this.creationTime=ad(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function cd(r){return lI.apply(this,arguments)}function lI(){return lI=M(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield s4(r,function vke(r,e){return sI.apply(this,arguments)}(t,{idToken:n}));He(i?.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=null!==(e=s.providerUserInfo)&&void 0!==e&&e.length?function Oke(r){return r.map(e=>{var{providerId:t}=e,n=n7(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(s.providerUserInfo):[],a=function Pke(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,o),f=!!r.isAnonymous&&!(r.email&&s.passwordHash||a?.length),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new lJ(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(r,d)}),lI.apply(this,arguments)}function uI(){return uI=M(function*(r){const e=Sr(r);yield cd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}),uI.apply(this,arguments)}function fI(){return fI=M(function*(r,e){const t=yield aJ(r,{},M(function*(){const n=Gf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=cJ(r,i,"/v1/token",`key=${s}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",oJ.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}),fI.apply(this,arguments)}class ld{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function yke(r){const e=cv(r);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return M(function*(){return He(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return M(function*(){const{accessToken:i,refreshToken:s,expiresIn:o}=yield function Tke(r,e){return fI.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,s,Number(o))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new ld;return n&&(He("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(He("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(He("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ld,this.toJSON())}_performRefresh(){return Wc("not implemented")}}function Sl(r,e){He("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class v0{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=n7(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Eke(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new lJ(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){var t=this;return M(function*(){const n=yield s4(t,t.stsTokenManager.getToken(t.auth,e));return He(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function Cke(r){return oI.apply(this,arguments)}(this,e)}reload(){return function Ske(r){return uI.apply(this,arguments)}(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new v0(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return M(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield cd(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return M(function*(){const t=yield e.getIdToken();return yield s4(e,function mke(r,e){return rI.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,a,c,l,f;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,m=null!==(i=t.email)&&void 0!==i?i:void 0,E=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,w=null!==(o=t.photoURL)&&void 0!==o?o:void 0,R=null!==(a=t.tenantId)&&void 0!==a?a:void 0,z=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,$=null!==(l=t.createdAt)&&void 0!==l?l:void 0,G=null!==(f=t.lastLoginAt)&&void 0!==f?f:void 0,{uid:de,emailVerified:Ce,isAnonymous:Le,providerData:tt,stsTokenManager:gt}=t;He(de&&gt,e,"internal-error");const yn=ld.fromJSON(this.name,gt);He("string"==typeof de,e,"internal-error"),Sl(d,e.name),Sl(m,e.name),He("boolean"==typeof Ce,e,"internal-error"),He("boolean"==typeof Le,e,"internal-error"),Sl(E,e.name),Sl(w,e.name),Sl(R,e.name),Sl(z,e.name),Sl($,e.name),Sl(G,e.name);const Et=new v0({uid:de,auth:e,email:m,emailVerified:Ce,displayName:d,isAnonymous:Le,photoURL:w,phoneNumber:E,tenantId:R,stsTokenManager:yn,createdAt:$,lastLoginAt:G});return tt&&Array.isArray(tt)&&(Et.providerData=tt.map(ti=>Object.assign({},ti))),z&&(Et._redirectEventId=z),Et}static _fromIdTokenResponse(e,t,n=!1){return M(function*(){const i=new ld;i.updateFromServerResponse(t);const s=new v0({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield cd(s),s})()}}const uJ=new Map;function o4(r){r4(r instanceof Function,"Expected a class definition");let e=uJ.get(r);return e?(r4(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,uJ.set(r,e),e)}const fJ=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return M(function*(){return!0})()}_set(t,n){var i=this;return M(function*(){i.storage[t]=n})()}_get(t){var n=this;return M(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return M(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function lv(r,e,t){return`firebase:${r}:${e}:${t}`}class eu{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=lv(this.userKey,i.apiKey,s),this.fullPersistenceKey=lv("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return M(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?v0._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return M(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return M(function*(){if(!t.length)return new eu(o4(fJ),e,n);const i=(yield Promise.all(t.map(function(){var l=M(function*(f){if(yield f._isAvailable())return f});return function(f){return l.apply(this,arguments)}}()))).filter(l=>l);let s=i[0]||o4(fJ);const o=lv(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const f=yield l._get(o);if(f){const d=v0._fromJSON(e,f);l!==s&&(a=d),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return s._shouldAllowMigration&&c.length?(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(function(){var l=M(function*(f){if(f!==s)try{yield f._remove(o)}catch{}});return function(f){return l.apply(this,arguments)}}())),new eu(s,e,n)):new eu(s,e,n)})()}}function dJ(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_J(e))return"Blackberry";if(vJ(e))return"Webos";if(dI(e))return"Safari";if((e.includes("chrome/")||pJ(e))&&!e.includes("edge/"))return"Chrome";if(mJ(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function hJ(r=R2()){return/firefox\//i.test(r)}function dI(r=R2()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pJ(r=R2()){return/crios\//i.test(r)}function gJ(r=R2()){return/iemobile/i.test(r)}function mJ(r=R2()){return/android/i.test(r)}function _J(r=R2()){return/blackberry/i.test(r)}function vJ(r=R2()){return/webos/i.test(r)}function uv(r=R2()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function CJ(r=R2()){return uv(r)||mJ(r)||vJ(r)||_J(r)||/windows phone/i.test(r)||gJ(r)}function yJ(r,e=[]){let t;switch(r){case"Browser":t=dJ(R2());break;case"Worker":t=`${dJ(R2())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${B6}/${n}`}function MJ(r,e){return pI.apply(this,arguments)}function pI(){return pI=M(function*(r,e){return wr(r,"GET","/v2/recaptchaConfig",lr(r,e))}),pI.apply(this,arguments)}function SJ(r){return void 0!==r&&void 0!==r.enterprise}class PJ{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function gI(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=wo("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",function Ike(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function OJ(r){return`__${r}${Math.floor(1e6*Math.random())}`}class TJ{constructor(e){this.type="recaptcha-enterprise",this.auth=B2(e)}verify(e="verify",t=!1){var n=this;return M(function*(){function s(){return s=M(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=M(function*(l,f){MJ(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0!==d.recaptchaKey){const m=new PJ(d);return null==a.tenantId?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}f(new Error("recaptcha Enterprise site key undefined"))}).catch(d=>{f(d)})});return function(l,f){return c.apply(this,arguments)}}())}),s.apply(this,arguments)}function o(a,c,l){const f=window.grecaptcha;SJ(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(d=>{c(d)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return s.apply(this,arguments)})(n.auth).then(l=>{if(!t&&SJ(window.grecaptcha))o(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));gI("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{o(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function Pl(r,e,t){return mI.apply(this,arguments)}function mI(){return mI=M(function*(r,e,t,n=!1){const i=new TJ(r);let s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}const o=Object.assign({},e);return Object.assign(o,n?{captchaResp:s}:{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}),mI.apply(this,arguments)}class Rke{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,a)=>{try{o(e(s))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return M(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}class zke{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bJ(this),this.idTokenSubscription=new bJ(this),this.beforeStateQueue=new Rke(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=rJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=o4(t)),this._initializationPromise=this.queue(M(function*(){var i,s;if(!n._deleted&&(n.persistenceManager=yield eu.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(s=n.currentUser)||void 0===s?void 0:s.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return M(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return M(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=s?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(s=l.user,o=!0)}if(!s)return t.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{yield t.beforeStateQueue.runMiddleware(s)}catch(a){s=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return s?t.reloadAndSetCurrentUserOrClear(s):t.directlySetCurrentUser(null)}return He(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===s._redirectEventId?t.directlySetCurrentUser(s):t.reloadAndSetCurrentUserOrClear(s)})()}tryRedirectSignIn(e){var t=this;return M(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return M(function*(){try{yield cd(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function dke(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return M(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return M(function*(){const n=e?Sr(e):null;return n&&He(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return M(function*(){if(!n._deleted)return e&&He(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(M(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return M(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(M(function*(){yield t.assertedPersistence.setPersistence(o4(e))}))}initializeRecaptchaConfig(){var e=this;return M(function*(){const t=yield MJ(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new PJ(t);null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.emailPasswordEnabled&&new TJ(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xc("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return M(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return M(function*(){if(!t.redirectPersistenceManager){const n=e&&o4(e)||t._popupRedirectResolver;He(n,t,"argument-error"),t.redirectPersistenceManager=yield eu.create(t,[o4(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return M(function*(){var n,i;return t._isInitialized&&(yield t.queue(M(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return M(function*(){if(e===t.currentUser)return t.queue(M(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return He(o,this,"internal-error"),o.then(()=>s(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return M(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return M(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const s=yield e._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n})()}_getAppCheckToken(){var e=this;return M(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function uke(r,...e){ov.logLevel<=Wn.WARN&&ov.warn(`Auth (${B6}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function B2(r){return Sr(r)}class bJ{constructor(e){this.auth=e,this.observer=null,this.addObserver=function WMe(r,e){const t=new qMe(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function wJ(r,e,t){const n=B2(r);He(n._canInitEmulator,n,"emulator-config-failed"),He(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,s=NJ(e),{host:o,port:a}=function Vke(r){const e=NJ(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:AJ(n.substr(s.length+1))}}{const[s,o]=n.split(":");return{host:s,port:AJ(o)}}}(e);n.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function Fke(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function NJ(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function AJ(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class _I{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wc("not implemented")}_getIdTokenResponse(e){return Wc("not implemented")}_linkToIdToken(e,t){return Wc("not implemented")}_getReauthenticationResolver(e){return Wc("not implemented")}}function CI(){return CI=M(function*(r,e){return wr(r,"POST","/v1/accounts:update",e)}),CI.apply(this,arguments)}function MI(r,e){return EI.apply(this,arguments)}function EI(){return EI=M(function*(r,e){return i4(r,"POST","/v1/accounts:signInWithPassword",lr(r,e))}),EI.apply(this,arguments)}function fv(r,e){return SI.apply(this,arguments)}function SI(){return SI=M(function*(r,e){return wr(r,"POST","/v1/accounts:sendOobCode",lr(r,e))}),SI.apply(this,arguments)}function PI(){return PI=M(function*(r,e){return fv(r,e)}),PI.apply(this,arguments)}function OI(r,e){return TI.apply(this,arguments)}function TI(){return TI=M(function*(r,e){return fv(r,e)}),TI.apply(this,arguments)}function AI(){return AI=M(function*(r,e){return i4(r,"POST","/v1/accounts:signInWithEmailLink",lr(r,e))}),AI.apply(this,arguments)}function II(){return II=M(function*(r,e){return i4(r,"POST","/v1/accounts:signInWithEmailLink",lr(r,e))}),II.apply(this,arguments)}class ud extends _I{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ud(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ud(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return M(function*(){var n;switch(t.signInMethod){case"password":const i={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=e._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const s=yield Pl(e,i,"signInWithPassword");return MI(e,s)}return MI(e,i).catch(function(){var s=M(function*(o){if("auth/missing-recaptcha-token"===o.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const a=yield Pl(e,i,"signInWithPassword");return MI(e,a)}return Promise.reject(o)});return function(o){return s.apply(this,arguments)}}());case"emailLink":return function Uke(r,e){return AI.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Ks(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return M(function*(){switch(n.signInMethod){case"password":return function kJ(r,e){return CI.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function Wke(r,e){return II.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Ks(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function a4(r,e){return kI.apply(this,arguments)}function kI(){return kI=M(function*(r,e){return i4(r,"POST","/v1/accounts:signInWithIdp",lr(r,e))}),kI.apply(this,arguments)}class tu extends _I{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ks("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=n7(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new tu(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return a4(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,a4(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,a4(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Gf(t)}return e}}class dd{constructor(e){var t,n,i,s,o,a;const c=Uf(Wf(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,f=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function Qke(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);He(l&&f&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=f,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function Jke(r){const e=Uf(Wf(r)).link,t=e?Uf(Wf(e)).deep_link_id:null,n=Uf(Wf(r)).deep_link_id;return(n?Uf(Wf(n)).link:null)||n||t||e||r}(e);try{return new dd(t)}catch{return null}}}let xJ=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return ud._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=dd.parseLink(n);return He(i,"argument-error"),ud._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class Ol{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class LJ extends Ol{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let exe=(()=>{class r extends LJ{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return tu._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function hv(r,e){return HI.apply(this,arguments)}function HI(){return HI=M(function*(r,e){return i4(r,"POST","/v1/accounts:signUp",lr(r,e))}),HI.apply(this,arguments)}class Xo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return M(function*(){const s=yield v0._fromIdTokenResponse(e,n,i),o=RJ(n);return new Xo({user:s,providerId:o,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return M(function*(){yield e._updateTokensIfNecessary(n,!0);const i=RJ(n);return new Xo({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function RJ(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class pv extends So{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,pv.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new pv(e,t,n,i)}}function zJ(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw"auth/multi-factor-auth-required"===s.code?pv._fromErrorAndOperation(r,s,e,n):s})}function BI(){return BI=M(function*(r,e,t=!1){const n=yield s4(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return Xo._forOperation(r,"link",n)}),BI.apply(this,arguments)}function UI(){return UI=M(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const s=yield s4(r,zJ(n,i,e,r),t);He(s.idToken,n,"internal-error");const o=cv(s.idToken);He(o,n,"internal-error");const{sub:a}=o;return He(r.uid===a,n,"user-mismatch"),Xo._forOperation(r,i,s)}catch(s){throw"auth/user-not-found"===s?.code&&Ks(n,"user-mismatch"),s}}),UI.apply(this,arguments)}function VJ(r,e){return WI.apply(this,arguments)}function WI(){return WI=M(function*(r,e,t=!1){const n="signIn",i=yield zJ(r,n,e),s=yield Xo._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(s.user)),s}),WI.apply(this,arguments)}function jI(){return jI=M(function*(r,e){return VJ(B2(r),e)}),jI.apply(this,arguments)}function nu(r,e,t){var n;He((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),He(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(He(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(He(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function oxe(r,e,t){return tk.apply(this,arguments)}function tk(){return tk=M(function*(r,e,t){var n;const i=B2(r),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const o=yield Pl(i,s,"getOobCode",!0);t&&nu(i,o,t),yield OI(i,o)}else t&&nu(i,s,t),yield OI(i,s).catch(function(){var o=M(function*(a){if("auth/missing-recaptcha-token"!==a.code)return Promise.reject(a);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const c=yield Pl(i,s,"getOobCode",!0);t&&nu(i,c,t),yield OI(i,c)}});return function(a){return o.apply(this,arguments)}}())}),tk.apply(this,arguments)}function cxe(r,e,t){return ok.apply(this,arguments)}function ok(){return ok=M(function*(r,e,t){var n;const i=B2(r),s={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let o;if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const l=yield Pl(i,s,"signUpPassword");o=hv(i,l)}else o=hv(i,s).catch(function(){var l=M(function*(f){if("auth/missing-recaptcha-token"===f.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=yield Pl(i,s,"signUpPassword");return hv(i,d)}return Promise.reject(f)});return function(f){return l.apply(this,arguments)}}());const a=yield o.catch(l=>Promise.reject(l)),c=yield Xo._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c}),ok.apply(this,arguments)}function lxe(r,e,t){return function qI(r,e){return jI.apply(this,arguments)}(Sr(r),xJ.credential(e,t))}function fxe(r,e){return fk.apply(this,arguments)}function fk(){return fk=M(function*(r,e){const t=Sr(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&nu(t.auth,i,e);const{email:s}=yield function Bke(r,e){return PI.apply(this,arguments)}(t.auth,i);s!==r.email&&(yield r.reload())}),fk.apply(this,arguments)}function hk(){return hk=M(function*(r,e){return wr(r,"POST","/v1/accounts:update",e)}),hk.apply(this,arguments)}function hxe(r,e){return pk.apply(this,arguments)}function pk(){return pk=M(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=Sr(r),s={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=yield s4(n,function dxe(r,e){return hk.apply(this,arguments)}(n.auth,s));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(o)}),pk.apply(this,arguments)}function Mxe(r,e,t,n){return Sr(r).onAuthStateChanged(e,t,n)}const mv="__sak";class $J{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mv,"1"),this.storage.removeItem(mv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Nxe=(()=>{class r extends $J{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Txe(){const r=R2();return dI(r)||uv(r)}()&&function Nke(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=CJ(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&t(n,s,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const s=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);!function wke(){return function FMe(){const r=R2();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===t.newValue||t.newValue===t.oldValue?s():setTimeout(s,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,s=this;return M(function*(){yield i().call(s,t,n),s.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return M(function*(){const s=yield n().call(i,t);return i.localCache[t]=JSON.stringify(s),s})()}_remove(t){var n=()=>super._remove,i=this;return M(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),BJ=(()=>{class r extends $J{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let Ixe=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return M(function*(){const i=t,{eventId:s,eventType:o,data:a}=i.data,c=n.handlersMap[o];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const l=Array.from(c).map(function(){var d=M(function*(m){return m(i.origin,a)});return function(m){return d.apply(this,arguments)}}()),f=yield function Axe(r){return Promise.all(r.map(function(){var e=M(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:f})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function _v(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class kxe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return M(function*(){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((c,l)=>{const f=_v("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(m){const E=m;if(E.data.eventId===f)switch(E.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(E.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"))}}},i.handlers.add(a),s.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function s2(){return window}function Mk(){return typeof s2().WorkerGlobalScope<"u"&&"function"==typeof s2().importScripts}function Ek(){return(Ek=M(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const GJ="firebaseLocalStorageDb",vv="firebaseLocalStorage",UJ="fbase_key";class pd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cv(r,e){return r.transaction([vv],e?"readwrite":"readonly").objectStore(vv)}function Sk(){const r=indexedDB.open(GJ,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(vv,{keyPath:UJ})}catch(i){t(i)}}),r.addEventListener("success",M(function*(){const n=r.result;n.objectStoreNames.contains(vv)?e(n):(n.close(),yield function Hxe(){const r=indexedDB.deleteDatabase(GJ);return new pd(r).toPromise()}(),e(yield Sk()))}))})}function WJ(r,e,t){return Pk.apply(this,arguments)}function Pk(){return Pk=M(function*(r,e,t){const n=Cv(r,!0).put({[UJ]:e,value:t});return new pd(n).toPromise()}),Pk.apply(this,arguments)}function Ok(){return Ok=M(function*(r,e){const t=Cv(r,!1).get(e),n=yield new pd(t).toPromise();return void 0===n?null:n.value}),Ok.apply(this,arguments)}function qJ(r,e){const t=Cv(r,!0).delete(e);return new pd(t).toPromise()}const Bxe=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return M(function*(){return t.db||(t.db=yield Sk()),t.db})()}_withRetries(t){var n=this;return M(function*(){let i=0;for(;;)try{const s=yield n._openDb();return yield t(s)}catch(s){if(i++>3)throw s;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return M(function*(){return Mk()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return M(function*(){t.receiver=Ixe._getInstance(function zxe(){return Mk()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=M(function*(i,s){return{keyProcessed:(yield t._poll()).includes(s.key)}});return function(i,s){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=M(function*(i,s){return["keyChanged"]});return function(i,s){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return M(function*(){var n,i;if(t.activeServiceWorker=yield function Lxe(){return Ek.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new kxe(t.activeServiceWorker);const s=yield t.sender._send("ping",{},800);s&&null!==(n=s[0])&&void 0!==n&&n.fulfilled&&null!==(i=s[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return M(function*(){if(n.sender&&n.activeServiceWorker&&function Rxe(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return M(function*(){try{if(!indexedDB)return!1;const t=yield Sk();return yield WJ(t,mv,"1"),yield qJ(t,mv),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return M(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return M(function*(){return i._withPendingWrite(M(function*(){return yield i._withRetries(s=>WJ(s,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return M(function*(){const i=yield n._withRetries(s=>function Vxe(r,e){return Ok.apply(this,arguments)}(s,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return M(function*(){return n._withPendingWrite(M(function*(){return yield n._withRetries(i=>qJ(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return M(function*(){const n=yield t._withRetries(o=>{const a=Cv(o,!1).getAll();return new pd(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],s=new Set;for(const{fbase_key:o,value:a}of n)s.add(o),JSON.stringify(t.localCache[o])!==JSON.stringify(a)&&(t.notifyListeners(o,a),i.push(o));for(const o of Object.keys(t.localCache))t.localCache[o]&&!s.has(o)&&(t.notifyListeners(o,null),i.push(o));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(M(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function y0(r,e){return e?o4(e):(He(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}OJ("rcb"),new sd(3e4,6e4);class Lk extends _I{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return a4(e,this._buildIdpRequest())}_linkToIdToken(e,t){return a4(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return a4(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function iLe(r){return VJ(r.auth,new Lk(r),r.bypassAuthState)}function sLe(r){const{auth:e,user:t}=r;return He(t,e,"internal-error"),function HJ(r,e){return UI.apply(this,arguments)}(t,new Lk(r),r.bypassAuthState)}function oLe(r){return Rk.apply(this,arguments)}function Rk(){return Rk=M(function*(r){const{auth:e,user:t}=r;return He(t,e,"internal-error"),function $I(r,e){return BI.apply(this,arguments)}(t,new Lk(r),r.bypassAuthState)}),Rk.apply(this,arguments)}class ZJ{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=M(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(s){e.reject(s)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return M(function*(){const{urlResponse:n,sessionId:i,postBody:s,tenantId:o,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(f){t.reject(f)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iLe;case"linkViaPopup":case"linkViaRedirect":return oLe;case"reauthViaPopup":case"reauthViaRedirect":return sLe;default:Ks(this.auth,"internal-error")}}resolve(e){r4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){r4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const aLe=new sd(2e3,1e4);function cLe(r,e,t){return zk.apply(this,arguments)}function zk(){return zk=M(function*(r,e,t){const n=B2(r);!function J5(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Ks(r,"argument-error"),iJ(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,Ol);const i=y0(n,t);return new Vk(n,"signInViaPopup",e,i).executeNotNull()}),zk.apply(this,arguments)}let Vk=(()=>{class r extends ZJ{constructor(t,n,i,s,o){super(t,n,s,o),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return M(function*(){const n=yield t.execute();return He(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return M(function*(){r4(1===t.filter.length,"Popup operations only handle one event");const n=_v();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(wo(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(wo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(wo(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,aLe.get())};t()}}return r.currentPopupAction=null,r})();const lLe="pendingRedirect",gd=new Map;class uLe extends ZJ{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return M(function*(){let n=gd.get(t.auth._key());if(!n){try{const s=(yield function fLe(r,e){return Fk.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(s)}catch(i){n=()=>Promise.reject(i)}gd.set(t.auth._key(),n)}return t.bypassAuthState||gd.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return M(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return M(function*(){})()}cleanUp(){}}function Fk(){return Fk=M(function*(r,e){const t=function KJ(r){return lv(lLe,r.config.apiKey,r.name)}(e),n=function YJ(r){return o4(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i}),Fk.apply(this,arguments)}function dLe(r,e){gd.set(r._key(),e)}function XJ(r,e){return jk.apply(this,arguments)}function jk(){return jk=M(function*(r,e,t=!1){const n=B2(r),i=y0(n,e),o=yield new uLe(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield n._persistUserIfCurrent(o.user),yield n._setRedirectUser(null,e)),o}),jk.apply(this,arguments)}class _Le{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function vLe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eee(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!eee(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(wo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(JJ(e))}saveEventToCache(e){this.cachedEventUids.add(JJ(e)),this.lastProcessedEventTime=Date.now()}}function JJ(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function eee({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function Yk(){return Yk=M(function*(r,e={}){return wr(r,"GET","/v1/projects",e)}),Yk.apply(this,arguments)}const yLe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MLe=/^https?/;function Kk(){return Kk=M(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function CLe(r){return Yk.apply(this,arguments)}(r);for(const t of e)try{if(SLe(t))return}catch{}Ks(r,"unauthorized-domain")}),Kk.apply(this,arguments)}function SLe(r){const e=id(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return""===o.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&o.hostname===n}if(!MLe.test(t))return!1;if(yLe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const PLe=new sd(3e4,6e4);function tee(){const r=s2().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let Mv=null;const bLe=new sd(5e3,15e3),wLe="__/auth/iframe",NLe="emulator/auth/iframe",ALe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ILe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kLe(r){const e=r.config;He(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?JA(e,NLe):`https://${r.config.authDomain}/${wLe}`,n={apiKey:e.apiKey,appName:r.name,v:B6},i=ILe.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${Gf(n).slice(1)}`}function Xk(){return Xk=M(function*(r){const e=yield function TLe(r){return Mv=Mv||function OLe(r){return new Promise((e,t)=>{var n,i,s;function o(){tee(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tee(),t(wo(r,"network-request-failed"))},timeout:PLe.get()})}if(null!==(i=null===(n=s2().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(s=s2().gapi)||void 0===s||!s.load){const a=OJ("iframefcb");return s2()[a]=()=>{gapi.load?o():t(wo(r,"network-request-failed"))},gI(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}o()}}).catch(e=>{throw Mv=null,e})}(r),Mv}(r),t=s2().gapi;return He(t,r,"internal-error"),e.open({where:document.body,url:kLe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ALe,dontclear:!0},n=>new Promise(function(){var i=M(function*(s,o){yield n.restyle({setHideOnLeave:!1});const a=wo(r,"network-request-failed"),c=s2().setTimeout(()=>{o(a)},bLe.get());function l(){s2().clearTimeout(c),s(n)}n.ping(l).then(l,()=>{o(a)})});return function(s,o){return i.apply(this,arguments)}}()))}),Xk.apply(this,arguments)}const LLe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class nee{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const $Le="__/auth/handler",BLe="emulator/auth/handler",GLe=encodeURIComponent("fac");function ree(r,e,t,n,i,s){return Qk.apply(this,arguments)}function Qk(){return Qk=M(function*(r,e,t,n,i,s){He(r.config.authDomain,r,"auth-domain-config-required"),He(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:B6,eventId:i};if(e instanceof Ol){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",function UMe(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries(s||{}))o[f]=d}if(e instanceof LJ){const f=e.getScopes().filter(d=>""!==d);f.length>0&&(o.scopes=f.join(","))}r.tenantId&&(o.tid=r.tenantId);const a=o;for(const f of Object.keys(a))void 0===a[f]&&delete a[f];const c=yield r._getAppCheckToken(),l=c?`#${GLe}=${encodeURIComponent(c)}`:"";return`${function ULe({config:r}){return r.emulator?JA(r,BLe):`https://${r.authDomain}/${$Le}`}(r)}?${Gf(a).slice(1)}${l}`}),Qk.apply(this,arguments)}const Jk="webStorageSupport",qLe=class WLe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BJ,this._completeRedirectFn=XJ,this._overrideRedirectResult=dLe}_openPopup(e,t,n,i){var s=this;return M(function*(){var o;r4(null===(o=s.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const a=yield ree(e,t,n,id(),i);return function VLe(r,e,t,n=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},LLe),{width:n.toString(),height:i.toString(),top:s,left:o}),l=R2().toLowerCase();t&&(a=pJ(l)?"_blank":t),hJ(l)&&(e=e||"http://localhost",c.scrollbars="yes");const f=Object.entries(c).reduce((m,[E,w])=>`${m}${E}=${w},`,"");if(function bke(r=R2()){var e;return uv(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function FLe(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new nee(null);const d=window.open(e||"",a,f);He(d,r,"popup-blocked");try{d.focus()}catch{}return new nee(d)}(e,a,_v())})()}_openRedirect(e,t,n,i){var s=this;return M(function*(){return yield s._originValidation(e),function xxe(r){s2().location.href=r}(yield ree(e,t,n,id(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(r4(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return M(function*(){const n=yield function xLe(r){return Xk.apply(this,arguments)}(e),i=new _Le(e);return n.register("authEvent",s=>(He(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Jk,{type:Jk},i=>{var s;const o=null===(s=i?.[0])||void 0===s?void 0:s[Jk];void 0!==o&&t(!!o),Ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function ELe(r){return Kk.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return CJ()||dI()||uv()}};var oee="@firebase/auth";class jLe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return M(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const XLe=xq("authIdTokenMaxAge")||300;let cee=null;const QLe=r=>function(){var e=M(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>XLe)return;const s=n?.token;cee!==s&&(cee=s,yield fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function JLe(r=CO()){const e=l5(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function Dke(r,e){const t=l5(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(mm(t.getOptions(),e??{}))return i;Ks(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:qLe,persistence:[Bxe,Nxe,BJ]}),n=xq("authTokenSyncURL");if(n){const s=QLe(n);(function yxe(r,e,t){Sr(r).beforeAuthStateChanged(e,t)})(t,s,()=>s(t.currentUser)),function Cxe(r,e,t,n){Sr(r).onIdTokenChanged(e,t,n)}(t,o=>s(o))}const i=Iq("auth");return i&&wJ(t,`http://${i}`),t}!function YLe(r){ms(new Vi("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;He(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yJ(r)},l=new zke(n,i,s,c);return function Hke(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(o4);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ms(new Vi("auth-internal",e=>{const t=B2(e.getProvider("auth").getImmediate());return new jLe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pr(oee,"0.23.2",function ZLe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),Pr(oee,"0.23.2","esm2017")}("Browser");class Sv{constructor(e){return e}}class uee{constructor(){return OA("auth")}}const tx=new et("angularfire2.auth-instances");function tRe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new Sv(n)}}const nRe={provide:uee,deps:[[new fs,tx]]},rRe={provide:Sv,useFactory:function eRe(r,e){const t=PA("auth",r,e);return t&&new Sv(t)},deps:[[new fs,tx],X5]};let iRe=(()=>{class r{constructor(){Pr("angularfire",Q_.full,"auth")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({providers:[rRe,nRe]}),r})();const aRe=B1(cxe,!0),cRe=B1(JLe,!0),lRe=B1(Mxe,!0),uRe=B1(fxe,!0),fRe=B1(oxe,!0),dRe=B1(lxe,!0),hRe=B1(cLe,!0),pRe=B1(hxe,!0);class Tl{constructor(e){return e}}const nx=new et("angularfire2.firestore-instances");function _Re(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new Tl(n)}}const vRe={provide:class gRe{constructor(){return OA("firestore")}},deps:[[new fs,nx]]},CRe={provide:Tl,useFactory:function mRe(r,e){const t=PA("firestore",r,e);return t&&new Tl(t)},deps:[[new fs,nx],X5]};let yRe=(()=>{class r{constructor(){Pr("angularfire",Q_.full,"fst")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({providers:[CRe,vRe]}),r})();const ERe=B1(Hbe,!0),SRe=B1(hbe,!0),ORe=B1(Dbe,!0),md=B1(sX,!0),TRe=B1(xbe,!0),bRe=B1(Lbe,!0),wRe=B1(mbe,!0),NRe=B1(Nbe,!0),dee=B1(Vbe,!0),ARe=B1(wbe,!0),Pv=B1(Tbe,!0),IRe=B1(Rbe,!0),kRe=B1(zbe,!0),xRe=B1(bbe,!0);class M0{constructor(e,t){u(this,"collectionName",void 0),u(this,"firestore",void 0),u(this,"collection",void 0),u(this,"subDAOs",{}),this.collectionName=e,this.firestore=t;this.collection=SRe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return M(function*(){return(yield ERe(t.collection,e)).id})()}read(e){var t=this;return M(function*(){const n=yield TRe(md(t.collection,e));return n.exists()?g.of(B.getNonNullable(n.data())):g.empty()})()}exists(e){var t=this;return M(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return M(function*(){return kRe(md(n.collection,e),t)})()}delete(e){return ORe(md(this.collection,e))}set(e,t){return IRe(md(this.collection,e),t)}subscribeToChanges(e,t){return new En(dee(md(this.collection,e),n=>{t(g.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return M(function*(){const s=i.constructQuery(e,t,n);return(yield bRe(s)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new En(dee(i,s=>{const o=[],a=[],c=[];s.docChanges().forEach(l=>{const f={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":o.push(f);break;case"modified":a.push(f);break;case"removed":c.push(f)}}),o.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+o.length+" NEW "+this.collectionName),t.onDocumentCreated(o)),a.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=Pv(this.collection);null!=t&&(i=Pv(i,ARe(t))),null!=n&&(i=Pv(i,NRe(n)));for(const s of e)i=Pv(i,xRe(s[0],s[1],s[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends M0{constructor(s){super(n,s)}}(this.firestore);return this.subDAOs[n]=i,i}}}let LRe=(()=>{var r;class e extends M0{constructor(n){super("errors",n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(Tl))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var RRe=Vo(1);let $t=(()=>{var r;class e{infoMessage(n){this.message(n,"is-info")}gameMessage(n){this.message(n,"is-warning")}criticalMessage(n){this.message(n,"is-danger")}message(n,i){const s=this.getDuration(n);this.toast(n,i,s)}toast(n,i,s){(0,RRe.toast)({message:n,duration:s,type:i,position:"top-center",closeOnClick:!0,dismissible:!0})}getDuration(n){const i=n.split(" ").length;return Math.max(60*i*1e3/150,3e3)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var Ov,E0;class m2{static setSingletonInstance(e){m2.singleton=g.of(e)}static logErrorAndFail(e,t,n){throw m2.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),b.failure(e+": "+t)}constructor(e,t,n){u(this,"errorDAO",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),this.errorDAO=e,this.router=t,this.messageDisplayer=n,m2.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return M(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const s=i.router.url,o=yield i.findErrors(e,s,t,n);if(0===o.length){const a={component:e,route:s,message:t,firstEncounter:Bc(),lastEncounter:Bc(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=o[0].id,c=o[0].data;yield i.errorDAO.update(a,{lastEncounter:Bc(),occurences:c.occurences+1})}})()}}Ov=m2,u(m2,"singleton",g.empty()),u(m2,"\u0275fac",function(e){return new(e||Ov)(Oe(LRe),Oe(Un),Oe($t))}),u(m2,"\u0275prov",De({token:Ov,factory:Ov.\u0275fac,providedIn:"root"}));class Ae{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let s={};null!=i&&(s=JSON.parse(i)),n?s[t+"."+n]=e:s[t]=e,localStorage.setItem("verbosity",JSON.stringify(s))}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];try{const n=JSON.parse(t);return null==n[e]?[!1,!1]:(B.assert(Array.isArray(n[e]),`malformed verbosity levels for ${e}: ${n[e]}`),n[e])}catch{throw new Error(`malformed verbosity object: ${t}`)}}static isMethodVerboseEntry(e,t){return Ae.isVerbose(e)[0]||Ae.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return Ae.isVerbose(e)[1]||Ae.isVerbose(e+"."+t)[1]}static display(e,t,n){Ae.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),s=B.getNonNullable(i);B.assert(s.value instanceof Function,"cannot add logging to properties that are not methods!");const a=s.value;s.value=function(...c){if(Ae.isMethodVerboseEntry(t,n)){const f=Array.from(c).map(d=>JSON.stringify(d)).join(", ");console.log(`> ${t}.${n}(${f})`)}const l=a.apply(this,c);return Ae.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${JSON.stringify(l)}`),l},Object.defineProperty(e.prototype,n,s)}}}window.enableLog=Ae.enableLog;class B{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw m2.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let rx=(u(E0=class extends M0{constructor(e){super("chats",e)}},"\u0275fac",function(e){return new(e||E0)(Oe(Tl))}),u(E0,"\u0275prov",De({token:E0,factory:E0.\u0275fac,providedIn:"root"})),E0);var S0;rx=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],rx);let hee=(()=>{class r{}return u(r,"CANNOT_SEND_MESSAGE",()=>$localize`You're not allowed to send a message here.`),u(r,"FORBIDDEN_MESSAGE",()=>$localize`This message is forbidden.`),r})(),ru=(S0=class{constructor(e){u(this,"chatDAO",void 0),this.chatDAO=e}addMessage(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return M(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return M(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var s=this;return M(function*(){if(!1===s.userCanSendMessage(t.name,e))return b.failure(hee.CANNOT_SEND_MESSAGE());if(s.isForbiddenMessage(n))return b.failure(hee.FORBIDDEN_MESSAGE());const o={content:n,sender:t,postedTime:Bc(),currentTurn:i};return yield s.addMessage(e,o),b.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}},u(S0,"\u0275fac",function(e){return new(e||S0)(Oe(rx))}),u(S0,"\u0275prov",De({token:S0,factory:S0.\u0275fac,providedIn:"root"})),S0);function je(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),m2.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var c4,ix;ru=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ru);let _d=(ix=c4=class extends M0{constructor(e){super(ix.COLLECTION_NAME,e)}},u(c4,"COLLECTION_NAME","users"),u(c4,"\u0275fac",function(e){return new(e||c4)(Oe(Tl))}),u(c4,"\u0275prov",De({token:c4,factory:c4.\u0275fac,providedIn:"root"})),c4);_d=ix=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],_d);let iu=(()=>{var r;class e{constructor(n){u(this,"userDAO",void 0),this.userDAO=n}usernameIsAvailable(n){var i=this;return M(function*(){return 0===(yield i.userDAO.findWhere([["username","==",n]])).length})()}setUsername(n,i){var s=this;return M(function*(){yield s.userDAO.update(n,{username:i})})()}markAsVerified(n){var i=this;return M(function*(){yield i.userDAO.update(n,{verified:!0})})()}observeUserOnServer(n,i){return this.userDAO.subscribeToChanges(n,s=>{s.isPresent()&&null===s.get().lastUpdateTime||i(s)})}getUserLastUpdateTime(n){var i=this;return M(function*(){const s=yield i.userDAO.read(n);if(s.isAbsent())return g.empty();{const o=s.get().lastUpdateTime;return je(null!=o,"should not receive a lastUpdateTime equal to null"),g.of(o)}})()}updatePresenceToken(n){return this.userDAO.update(n,{lastUpdateTime:Bc()})}getServerTime(n){var i=this;return M(function*(){return new Promise(s=>{let o=!1;const c=i.userDAO.subscribeToChanges(n,l=>{null==l.get().lastUpdateTime?o=!0:o&&(c.unsubscribe(),s(l.get().lastUpdateTime))});i.updatePresenceToken(n)})})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(_d))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class pee extends zs{constructor(e=1/0,t=1/0,n=mA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!i&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!i){const o=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}}var P0;let vd=(()=>{class r{}return u(r,"YOU_ARE_ALREADY_PLAYING",()=>$localize`You are already playing in another game.`),u(r,"YOU_ARE_ALREADY_CREATING",()=>$localize`You are already the creator of another game.`),u(r,"YOU_ARE_ALREADY_CHOSEN_OPPONENT",()=>$localize`You are already the chosen opponent in another game.`),u(r,"YOU_ARE_ALREADY_CANDIDATE",()=>$localize`You are already candidate in another game.`),u(r,"YOU_ARE_ALREADY_OBSERVING",()=>$localize`You are already observing another game.`),r})();class bl{static createUserWithEmailAndPassword(e,t,n){return aRe(e,t,n)}static sendEmailVerification(e){return uRe(e)}static sendPasswordResetEmail(e,t){return fRe(e,t)}static signInWithEmailAndPassword(e,t,n){return M(function*(){return(yield dRe(e,t,n)).user})()}static signInWithPopup(e,t){return M(function*(){return(yield hRe(e,t)).user})()}static updateProfile(e,t){return pRe(e,t)}}class O0{constructor(e,t,n,i){u(this,"id",void 0),u(this,"email",void 0),u(this,"username",void 0),u(this,"verified",void 0),this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}u(O0,"NOT_CONNECTED",new O0("",g.empty(),g.empty(),!1));let ur=(P0=class{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"auth",void 0),u(this,"authSubscription",void 0),u(this,"user",g.empty()),u(this,"userRS",void 0),u(this,"userObs",void 0),u(this,"userSubscription",new En),this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new pee(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new En(lRe(this.auth,function(){var s=M(function*(o){null==o?(Ae.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(O0.NOT_CONNECTED),i.user=g.empty()):(je(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(o.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;Ae.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(o)}`);const f=!0===i.emailVerified(o)&&null!=l;if(!0===f&&!1===c.verified)return i.userService.markAsVerified(o.uid);const d=new O0(o.uid,g.ofNullable(o.email),g.ofNullable(l),f);!1===i.user.equalsValue(d)&&(i.user=g.of(d),i.userRS.next(d))}}))});return function(o){return s.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return M(function*(){try{return yield bl.sendPasswordResetEmail(t.auth,e),b.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}doRegister(e,t,n){var i=this;return M(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):Q.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return M(function*(){try{const s=yield bl.createUserWithEmailAndPassword(i.auth,t,n);yield bl.signInWithEmailAndPassword(i.auth,t,n);const o=B.getNonNullable(s.user);return yield i.createUser(o.uid,e),Q.success(o)}catch(s){return i.catchFirebaseError(s)}})()}catchFirebaseError(e){if(e instanceof So)return Q.failure(this.mapFirebaseError(e));throw e}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return m2.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return M(function*(){const t=g.ofNullable(e.auth.currentUser);if(!t.isPresent())return m2.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return m2.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield bl.sendEmailVerification(t.get()),b.SUCCESS}catch(n){return e.catchFirebaseError(n)}})()}doEmailLogin(e,t){var n=this;return M(function*(){try{return yield bl.signInWithEmailAndPassword(n.auth,e,t),b.SUCCESS}catch(i){return n.catchFirebaseError(i)}})()}createUser(e,t){var n=this;return M(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return M(function*(){return b.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return M(function*(){try{const t=new exe;t.addScope("profile"),t.addScope("email");const n=yield bl.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),Q.success(n)}catch(t){return e.catchFirebaseError(t)}})()}disconnect(){var e=this;return M(function*(){return g.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),b.SUCCESS):b.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return M(function*(){if(""===e)return b.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return b.failure($localize`This username is already in use, please select a different one.`);const i=B.getNonNullable(t.auth.currentUser);return yield bl.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),b.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}setPicture(e){var t=this;return M(function*(){try{const n=B.getNonNullable(t.auth.currentUser);return yield bl.updateProfile(n,{photoURL:e}),b.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}reloadUser(){var e=this;return M(function*(){const t=B.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return je(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}},u(P0,"\u0275fac",function(e){return new(e||P0)(Oe(_d),Oe(iu),Oe(Sv))}),u(P0,"\u0275prov",De({token:P0,factory:P0.\u0275fac,providedIn:"root"})),P0);var l4,bv,wv,Cd,su,q,T0;ur=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ur);class x1{constructor(e){u(this,"value",void 0),this.value=e}}u(x1,"HARD_DRAW",new(l4=x1)(0)),u(x1,"RESIGN",new l4(1)),u(x1,"ESCAPE",new l4(2)),u(x1,"VICTORY",new l4(3)),u(x1,"TIMEOUT",new l4(4)),u(x1,"UNACHIEVED",new l4(5)),u(x1,"AGREED_DRAW_BY_ZERO",new l4(6)),u(x1,"AGREED_DRAW_BY_ONE",new l4(7));class Tv{constructor(e,t){u(this,"id",void 0),u(this,"data",void 0),this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===x1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===x1.AGREED_DRAW_BY_ZERO.value||this.data.result===x1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===x1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(je(this.data.result===x1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),B.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===x1.VICTORY.value}isTimeout(){return this.data.result===x1.TIMEOUT.value}isResign(){return this.data.result===x1.RESIGN.value}getWinner(){return g.ofNullable(this.data.winner)}getLoser(){return g.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new Tv(this.id,{...this.data,winner:e,loser:t})}}class G2{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"CREATOR":return G2.CREATOR;case"RANDOM":return G2.RANDOM;default:return je("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),G2.CHOSEN_PLAYER}}}u(G2,"CREATOR",new(bv=G2)("CREATOR")),u(G2,"RANDOM",new bv("RANDOM")),u(G2,"CHOSEN_PLAYER",new bv("CHOSEN_PLAYER"));class fr{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"STANDARD":return fr.STANDARD;case"BLITZ":return fr.BLITZ;case"CUSTOM":return fr.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}u(fr,"STANDARD",new(wv=fr)("STANDARD")),u(fr,"BLITZ",new wv("BLITZ")),u(fr,"CUSTOM",new wv("CUSTOM")),u(fr,"NORMAL_MOVE_DURATION",120),u(fr,"NORMAL_PART_DURATION",1800),u(fr,"BLITZ_MOVE_DURATION",30),u(fr,"BLITZ_PART_DURATION",900);class _i{constructor(e){u(this,"value",void 0),this.value=e}}u(_i,"PART_CREATED",new(Cd=_i)(0)),u(_i,"CONFIG_PROPOSED",new Cd(2)),u(_i,"PART_STARTED",new Cd(3)),u(_i,"PART_FINISHED",new Cd(4));class sx{constructor(){u(this,"value",2)}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}u(sx,"NONE",new sx);class k{static of(e){return 0===e?k.ZERO:(B.expectToBe(e,1),k.ONE)}static ofTurn(e){return e%2==0?k.ZERO:k.ONE}constructor(e){u(this,"value",void 0),this.value=e}isPlayer(){return!0}toString(){return this===k.ZERO?"PLAYER_ZERO":(B.expectToBe(this,k.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getVictoryValue(){return this===k.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===k.ZERO?k.ONE:(B.expectToBe(this,k.ONE),k.ZERO)}}su=k,u(k,"encoder",we.tuple([we.identity()],r=>[r.value],r=>su.of(r[0]))),u(k,"ZERO",new su(0)),u(k,"ONE",new su(1)),u(k,"PLAYERS",[su.ZERO,su.ONE]),function(r){r.ZERO=k.ZERO,r.ONE=k.ONE,r.NONE=sx.NONE,r.encoder=new class extends we{encode(e){return e.value}decode(e){return 2===e?r.NONE:(B.assert(0===e||1===e,"Invalid encoded player: "+e),k.of(e))}}}(q||(q={}));let yd=(u(T0=class extends M0{constructor(e){super("parts",e)}},"\u0275fac",function(e){return new(e||T0)(Oe(Tl))}),u(T0,"\u0275prov",De({token:T0,factory:T0.\u0275fac,providedIn:"root"})),T0);yd=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],yd);class Nv{constructor(e,t,n){u(this,"onDocumentCreated",void 0),u(this,"onDocumentModified",void 0),u(this,"onDocumentDeleted",void 0),this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let ox=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}eventsCollection(n){return this.partDAO.subCollectionDAO(n,"events")}addEvent(n,i){return this.eventsCollection(n).create(i)}addMove(n,i,s){return this.addEvent(n,{eventType:"Move",time:Bc(),player:i.value,move:s})}addRequest(n,i,s){return this.addEvent(n,{eventType:"Request",time:Bc(),player:i.value,requestType:s})}addReply(n,i,s,o,a=null){return this.addEvent(n,{eventType:"Reply",time:Bc(),player:i.value,reply:s,requestType:o,data:a})}startGame(n,i){return this.addAction(n,i,"StartGame")}addAction(n,i,s){return this.addEvent(n,{eventType:"Action",time:Bc(),player:i.value,action:s})}subscribeToEvents(n,i){const s=new Nv(o=>{const a=o.map(c=>c.data).filter(c=>null!=c.time);a.length>0&&i(a)},o=>{i(o.map(a=>a.data))},()=>{});return this.eventsCollection(n).observingWhere([],s,"time")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(yd))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var b0;let ax=(u(b0=class extends M0{constructor(e){super("config-room",e)}},"\u0275fac",function(e){return new(e||b0)(Oe(Tl))}),u(b0,"\u0275prov",De({token:b0,factory:b0.\u0275fac,providedIn:"root"})),b0);var u4,cx;ax=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ax);let Md=(u4=class{constructor(e,t){u(this,"configRoomDAO",void 0),u(this,"connectedUserService",void 0),this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new Nv(o=>{for(const a of o)n.push(a.data);t(n)},o=>{for(const a of o)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},o=>{for(const a of o)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser();return t.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:G2.RANDOM.value,partType:fr.STANDARD.value,partStatus:_i.PART_CREATED.value,maximalMoveDuration:fr.NORMAL_MOVE_DURATION,totalPartDuration:fr.NORMAL_PART_DURATION,creator:n})})()}joinGame(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?b.failure(cx.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),b.SUCCESS)})()}cancelJoining(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const s=i.get(),o=[t.removeCandidate(e,n)];s.chosenOpponent?.id===n.id&&o.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:_i.PART_CREATED.value})),yield Promise.all(o)}})()}deleteConfigRoom(e,t){var n=this;return M(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,s,o){var a=this;return M(function*(){return a.configRoomDAO.update(e,{partStatus:_i.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:s.value})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:_i.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:_i.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:_i.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return M(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return M(function*(){return(yield t.configRoomDAO.read(e)).get()})()}},cx=u4,u(u4,"GAME_DOES_NOT_EXIST",()=>$localize`Game does not exist`),u(u4,"\u0275fac",function(e){return new(e||u4)(Oe(ax),Oe(ur))}),u(u4,"\u0275prov",De({token:u4,factory:u4.\u0275fac,providedIn:"root"})),u4);var w0;Md=cx=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],Md);let ou=(w0=class{constructor(e,t,n,i,s){u(this,"partDAO",void 0),u(this,"gameEventService",void 0),u(this,"connectedUserService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=s}update(e,t){var n=this;return M(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return M(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?b.failure("NONEXISTENT_PART"):i.get().typeGame===t?b.SUCCESS:b.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:x1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return M(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=G2.of(e.firstPlayer);return t===G2.RANDOM&&(t=Math.random()<.5?G2.CREATOR:G2.CHOSEN_PLAYER),t===G2.CREATOR?(n=e.creator,i=B.getNonNullable(e.chosenOpponent)):(n=B.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:Bc()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return M(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);let s;s=i.playerZero===t.creator?k.ONE:k.ZERO,yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,s)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,i){var s=this;return M(function*(){const o={winner:n,loser:i,result:x1.RESIGN.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,n,i){var s=this;return M(function*(){const o={winner:n,loser:i,result:x1.TIMEOUT.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Accept","Draw");const s={result:(t===k.ZERO?x1.AGREED_DRAW_BY_ZERO:x1.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,s),yield n.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var n=this;return M(function*(){const i=B.getNonNullable(e.data),s=yield n.configRoomService.readConfigRoomById(e.id);let o;const a=n.connectedUserService.user.get().toMinimalUser();let c;i.playerZero.id===a.id?(c=B.getNonNullable(i.playerOne),o=G2.CHOSEN_PLAYER):(c=i.playerZero,o=G2.CREATOR);const l={...s,firstPlayer:o.value,creator:a,chosenOpponent:c,partStatus:_i.PART_STARTED.value},f=n.getStartingConfig(l),d={typeGame:i.typeGame,result:x1.UNACHIEVED.value,...f},m=yield n.partDAO.create(d);yield n.configRoomService.createConfigRoom(m,l),yield n.createChat(m),yield n.gameEventService.addReply(e.id,t,"Accept","Rematch",m),yield n.gameEventService.startGame(m,t.getOpponent())})()}askTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return M(function*(){let s=t-1;s%2===n.value&&s--;const o={turn:s};return yield i.gameEventService.addReply(e,n,"Accept","TakeBack"),yield i.partDAO.update(e,o)})()}refuseTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return M(function*(){let o={turn:(yield n.partDAO.read(e)).get().turn+1};return o=n.updateScore(o,t),o})()}updatePart(e,t){var n=this;return M(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t,n){var i=this;return M(function*(){let s=yield i.preparePartUpdate(e,n);s={...s,result:x1.HARD_DRAW.value},yield i.update(e,s),yield i.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,n,i,s){var o=this;return M(function*(){let a=yield o.preparePartUpdate(e,s);a={...a,winner:n,loser:i,result:x1.VICTORY.value},yield o.update(e,a),yield o.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,n){var i=this;return M(function*(){yield i.gameEventService.addMove(e,t,n)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}},u(w0,"\u0275fac",function(e){return new(e||w0)(Oe(yd),Oe(ox),Oe(ur),Oe(Md),Oe(ru))}),u(w0,"\u0275prov",De({token:w0,factory:w0.\u0275fac,providedIn:"root"})),w0);ou=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ou);var Fee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},qee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},jee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class Ed{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??Ed.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let Qee=(()=>{var r;class e{changeTheme(n){localStorage.setItem("theme",n)}getTheme(){return g.ofNullable(localStorage.getItem("theme"))}changeLanguage(n){localStorage.setItem("locale",n.toLowerCase())}getLanguage(){return Ed.getLocale()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Av=(()=>{var r;class e{constructor(n,i){u(this,"document",void 0),u(this,"userSettingsService",void 0),u(this,"theme",void 0),u(this,"availableThemes",["dark","light"]),this.document=n,this.userSettingsService=i;const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const n=this.userSettingsService.getTheme();if(n.isPresent()){const i=n.get();if(this.availableThemes.some(s=>s===i))return g.of(i)}return g.empty()}loadTheme(n){this.loadStyle(n+".css"),this.theme=n}loadStyle(n){const i=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=n;else{const o=this.document.createElement("link");o.id="theme",o.rel="stylesheet",o.href=`${n}`,i.appendChild(o)}}getTheme(){return this.theme}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(L2),Oe(Qee))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Jee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ut(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Jee(Object(t),!0).forEach(function(n){_2(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Jee(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Iv(r){return(Iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function ete(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _2(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ux(r,e){return function xUe(r){if(Array.isArray(r))return r}(r)||function RUe(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var o,a,n=[],i=!0,s=!1;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(c){s=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(s)throw a}}return n}}(r,e)||tte(r,e)||function DUe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pd(r){return function kUe(r){if(Array.isArray(r))return fx(r)}(r)||function LUe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||tte(r)||function zUe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tte(r,e){if(r){if("string"==typeof r)return fx(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fx(r,e)}}function fx(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var nte=function(){},dx={},rte={},ite=null,ste={mark:nte,measure:nte};try{typeof window<"u"&&(dx=window),typeof document<"u"&&(rte=document),typeof MutationObserver<"u"&&(ite=MutationObserver),typeof performance<"u"&&(ste=performance)}catch{}var Lv,Rv,zv,Dv,Hv,ote=(dx.navigator||{}).userAgent,ate=void 0===ote?"":ote,wl=dx,G1=rte,cte=ite,xv=ste,f4=!!G1.documentElement&&!!G1.head&&"function"==typeof G1.addEventListener&&"function"==typeof G1.createElement,lte=~ate.indexOf("MSIE")||~ate.indexOf("Trident/"),d4="___FONT_AWESOME___",ute="fa",fte="svg-inline--fa",N0="data-fa-i2svg",px="data-fa-pseudo-element",VUe="data-fa-pseudo-element-pending",gx="data-prefix",mx="data-icon",dte="fontawesome-i2svg",FUe="async",$Ue=["HTML","HEAD","STYLE","SCRIPT"],hte=function(){try{return!0}catch{return!1}}(),U1="classic",Nr="sharp",_x=[U1,Nr];function Od(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[U1]}})}var Td=Od((_2(Lv={},U1,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),_2(Lv,Nr,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),Lv)),bd=Od((_2(Rv={},U1,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),_2(Rv,Nr,{solid:"fass",regular:"fasr",light:"fasl"}),Rv)),wd=Od((_2(zv={},U1,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),_2(zv,Nr,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),zv)),BUe=Od((_2(Dv={},U1,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),_2(Dv,Nr,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),Dv)),GUe=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,pte="fa-layers-text",UUe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,WUe=Od((_2(Hv={},U1,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),_2(Hv,Nr,{900:"fass",400:"fasr",300:"fasl"}),Hv)),gte=[1,2,3,4,5,6,7,8,9,10],qUe=gte.concat([11,12,13,14,15,16,17,18,19,20]),jUe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],A0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Nd=new Set;Object.keys(bd[U1]).map(Nd.add.bind(Nd)),Object.keys(bd[Nr]).map(Nd.add.bind(Nd));var ZUe=[].concat(_x,Pd(Nd),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",A0.GROUP,A0.SWAP_OPACITY,A0.PRIMARY,A0.SECONDARY]).concat(gte.map(function(r){return"".concat(r,"x")})).concat(qUe.map(function(r){return"w-".concat(r)})),Ad=wl.FontAwesomeConfig||{};G1&&"function"==typeof G1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=ux(r,2),n=e[1],i=function KUe(r){return""===r||"false"!==r&&("true"===r||r)}(function YUe(r){var e=G1.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(Ad[n]=i)});var mte={styleDefault:"solid",familyDefault:"classic",cssPrefix:ute,replacementClass:fte,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Ad.familyPrefix&&(Ad.cssPrefix=Ad.familyPrefix);var au=ut(ut({},mte),Ad);au.autoReplaceSvg||(au.observeMutations=!1);var _t={};Object.keys(mte).forEach(function(r){Object.defineProperty(_t,r,{enumerable:!0,set:function(t){au[r]=t,Id.forEach(function(n){return n(_t)})},get:function(){return au[r]}})}),Object.defineProperty(_t,"familyPrefix",{enumerable:!0,set:function(e){au.cssPrefix=e,Id.forEach(function(t){return t(_t)})},get:function(){return au.cssPrefix}}),wl.FontAwesomeConfig=_t;var Id=[],qc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},eWe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function kd(){for(var r=12,e="";r-- >0;)e+=eWe[62*Math.random()|0];return e}function cu(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function vx(r){return r.classList?cu(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function _te(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Vv(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function Cx(r){return r.size!==qc.size||r.x!==qc.x||r.y!==qc.y||r.rotate!==qc.rotate||r.flipX||r.flipY}var iWe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function vte(){var r=ute,e=fte,t=_t.cssPrefix,n=_t.replacementClass,i=iWe;if(t!==r||n!==e){var s=new RegExp("\\.".concat(r,"\\-"),"g"),o=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(s,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var Cte=!1;function yx(){_t.autoAddCss&&!Cte&&(function JUe(r){if(r&&f4){var e=G1.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=G1.head.childNodes,n=null,i=t.length-1;i>-1;i--){var s=t[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(n=s)}G1.head.insertBefore(e,n)}}(vte()),Cte=!0)}var sWe={mixout:function(){return{dom:{css:vte,insertCss:yx}}},hooks:function(){return{beforeDOMElementCreation:function(){yx()},beforeI2svg:function(){yx()}}}},h4=wl||{};h4[d4]||(h4[d4]={}),h4[d4].styles||(h4[d4].styles={}),h4[d4].hooks||(h4[d4].hooks={}),h4[d4].shims||(h4[d4].shims=[]);var Ha=h4[d4],yte=[],Fv=!1;function xd(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,s=void 0===i?[]:i;return"string"==typeof r?_te(r):"<".concat(e," ").concat(function tWe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(_te(r[t]),'" ')},"").trim()}(n),">").concat(s.map(xd).join(""),"</").concat(e,">")}function Mte(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}f4&&((Fv=(G1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(G1.readyState))||G1.addEventListener("DOMContentLoaded",function r(){G1.removeEventListener("DOMContentLoaded",r),Fv=1,yte.map(function(e){return e()})}));var Mx=function(e,t,n,i){var c,l,f,s=Object.keys(e),o=s.length,a=void 0!==i?function(e,t){return function(n,i,s,o){return e.call(t,n,i,s,o)}}(t,i):t;for(void 0===n?(c=1,f=e[s[0]]):(c=0,f=n);c<o;c++)f=a(f,e[l=s[c]],l,e);return f};function Ex(r){var e=function lWe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var s=r.charCodeAt(t++);56320==(64512&s)?e.push(((1023&i)<<10)+(1023&s)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function Ete(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function Sx(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,s=Ete(e);"function"!=typeof Ha.hooks.addPack||i?Ha.styles[r]=ut(ut({},Ha.styles[r]||{}),s):Ha.hooks.addPack(r,Ete(e)),"fas"===r&&Sx("fa",e)}var $v,Bv,Gv,lu=Ha.styles,fWe=Ha.shims,dWe=(_2($v={},U1,Object.values(wd[U1])),_2($v,Nr,Object.values(wd[Nr])),$v),Px=null,Ste={},Pte={},Ote={},Tte={},bte={},hWe=(_2(Bv={},U1,Object.keys(Td[U1])),_2(Bv,Nr,Object.keys(Td[Nr])),Bv);var wte=function(){var e=function(s){return Mx(lu,function(o,a,c){return o[c]=Mx(a,s,{}),o},{})};Ste=e(function(i,s,o){return s[3]&&(i[s[3]]=o),s[2]&&s[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=o}),i}),Pte=e(function(i,s,o){return i[o]=o,s[2]&&s[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=o}),i}),bte=e(function(i,s,o){var a=s[2];return i[o]=o,a.forEach(function(c){i[c]=o}),i});var t="far"in lu||_t.autoFetchSvg,n=Mx(fWe,function(i,s){var o=s[0],a=s[1],c=s[2];return"far"===a&&!t&&(a="fas"),"string"==typeof o&&(i.names[o]={prefix:a,iconName:c}),"number"==typeof o&&(i.unicodes[o.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});Ote=n.names,Tte=n.unicodes,Px=Uv(_t.styleDefault,{family:_t.familyDefault})};function Ox(r,e){return(Ste[r]||{})[e]}function I0(r,e){return(bte[r]||{})[e]}function Nte(r){return Ote[r]||{prefix:null,iconName:null}}function Al(){return Px}(function QUe(r){Id.push(r)})(function(r){Px=Uv(r.styleDefault,{family:_t.familyDefault})}),wte();var Tx=function(){return{prefix:null,iconName:null,rest:[]}};function Uv(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?U1:t;return bd[n][r]||bd[n][Td[n][r]]||(r in Ha.styles?r:null)||null}var Ate=(_2(Gv={},U1,Object.keys(wd[U1])),_2(Gv,Nr,Object.keys(wd[Nr])),Gv);function Wv(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,s=(_2(e={},U1,"".concat(_t.cssPrefix,"-").concat(U1)),_2(e,Nr,"".concat(_t.cssPrefix,"-").concat(Nr)),e),o=null,a=U1;(r.includes(s[U1])||r.some(function(l){return Ate[U1].includes(l)}))&&(a=U1),(r.includes(s[Nr])||r.some(function(l){return Ate[Nr].includes(l)}))&&(a=Nr);var c=r.reduce(function(l,f){var d=function gWe(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function pWe(r){return~ZUe.indexOf(r)}(i)?null:i}(_t.cssPrefix,f);if(lu[f]?(f=dWe[a].includes(f)?BUe[a][f]:f,o=f,l.prefix=f):hWe[a].indexOf(f)>-1?(o=f,l.prefix=Uv(f,{family:a})):d?l.iconName=d:f!==_t.replacementClass&&f!==s[U1]&&f!==s[Nr]&&l.rest.push(f),!i&&l.prefix&&l.iconName){var m="fa"===o?Nte(l.iconName):{},E=I0(l.prefix,l.iconName);m.prefix&&(o=null),l.iconName=m.iconName||E||l.iconName,l.prefix=m.prefix||l.prefix,"far"===l.prefix&&!lu.far&&lu.fas&&!_t.autoFetchSvg&&(l.prefix="fas")}return l},Tx());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===Nr&&(lu.fass||_t.autoFetchSvg)&&(c.prefix="fass",c.iconName=I0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===o)&&(c.prefix=Al()||"fas"),c}var vWe=function(){function r(){(function NUe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function AUe(r,e,t){e&&ete(r.prototype,e),t&&ete(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var o=i.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=ut(ut({},t.definitions[a]||{}),o[a]),Sx(a,o[a]);var c=wd[U1][a];c&&Sx(c,o[a]),wte()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(s){var o=i[s],a=o.prefix,c=o.iconName,l=o.icon,f=l[2];t[a]||(t[a]={}),f.length>0&&f.forEach(function(d){"string"==typeof d&&(t[a][d]=l)}),t[a][c]=l}),t}}]),r}(),Ite=[],uu={},fu={},CWe=Object.keys(fu);function bx(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(uu[r]||[]).forEach(function(o){e=o.apply(null,[e].concat(n))}),e}function k0(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(uu[r]||[]).forEach(function(s){s.apply(null,t)})}function p4(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return fu[r]?fu[r].apply(null,e):void 0}function wx(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||Al();if(e)return e=I0(t,e)||e,Mte(kte.definitions,t,e)||Mte(Ha.styles,t,e)}var kte=new vWe,EWe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f4?(k0("beforeI2svg",e),p4("pseudoElements2svg",e),p4("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===_t.autoReplaceSvg&&(_t.autoReplaceSvg=!0),_t.observeMutations=!0,function aWe(r){f4&&(Fv?setTimeout(r,0):yte.push(r))}(function(){PWe({autoReplaceSvgRoot:t}),k0("watch",e)})}},No={noAuto:function(){_t.autoReplaceSvg=!1,_t.observeMutations=!1,k0("noAuto")},config:_t,dom:EWe,parse:{icon:function(e){if(null===e)return null;if("object"===Iv(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:I0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Uv(e[0]);return{prefix:n,iconName:I0(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(_t.cssPrefix,"-"))>-1||e.match(GUe))){var i=Wv(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||Al(),iconName:I0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var s=Al();return{prefix:s,iconName:I0(s,e)||e}}}},library:kte,findIconDefinition:wx,toHtml:xd},PWe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?G1:t;(Object.keys(Ha.styles).length>0||_t.autoFetchSvg)&&f4&&_t.autoReplaceSvg&&No.dom.i2svg({node:n})};function qv(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return xd(n)})}}),Object.defineProperty(r,"node",{get:function(){if(f4){var n=G1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function Nx(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,s=r.iconName,o=r.transform,a=r.symbol,c=r.title,l=r.maskId,f=r.titleId,d=r.extra,m=r.watchable,E=void 0!==m&&m,w=n.found?n:t,R=w.width,z=w.height,$="fak"===i,G=[_t.replacementClass,s?"".concat(_t.cssPrefix,"-").concat(s):""].filter(function(Et){return-1===d.classes.indexOf(Et)}).filter(function(Et){return""!==Et||!!Et}).concat(d.classes).join(" "),de={children:[],attributes:ut(ut({},d.attributes),{},{"data-prefix":i,"data-icon":s,class:G,role:d.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(R," ").concat(z)})},Ce=$&&!~d.classes.indexOf("fa-fw")?{width:"".concat(R/z*16*.0625,"em")}:{};E&&(de.attributes[N0]=""),c&&(de.children.push({tag:"title",attributes:{id:de.attributes["aria-labelledby"]||"title-".concat(f||kd())},children:[c]}),delete de.attributes.title);var Le=ut(ut({},de),{},{prefix:i,iconName:s,main:t,mask:n,maskId:l,transform:o,symbol:a,styles:ut(ut({},Ce),d.styles)}),tt=n.found&&t.found?p4("generateAbstractMask",Le)||{children:[],attributes:{}}:p4("generateAbstractIcon",Le)||{children:[],attributes:{}},yn=tt.attributes;return Le.children=tt.children,Le.attributes=yn,a?function TWe(r){var t=r.iconName,n=r.children,i=r.attributes,s=r.symbol,o=!0===s?"".concat(r.prefix,"-").concat(_t.cssPrefix,"-").concat(t):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ut(ut({},i),{},{id:o}),children:n}]}]}(Le):function OWe(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,s=r.styles,o=r.transform;if(Cx(o)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=Vv(ut(ut({},s),{},{"transform-origin":"".concat(l.x+o.x/16,"em ").concat(l.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(Le)}function xte(r){var e=r.content,t=r.width,n=r.height,i=r.transform,s=r.title,o=r.extra,a=r.watchable,c=void 0!==a&&a,l=ut(ut(ut({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});c&&(l[N0]="");var f=ut({},o.styles);Cx(i)&&(f.transform=function rWe(r){var e=r.transform,t=r.width,i=r.height,s=void 0===i?16:i,o=r.startCentered,a=void 0!==o&&o,c="";return c+=a&&lte?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-s/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),f["-webkit-transform"]=f.transform);var d=Vv(f);d.length>0&&(l.style=d);var m=[];return m.push({tag:"span",attributes:l,children:[e]}),s&&m.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),m}var Ax=Ha.styles;function Ix(r){var e=r[0],t=r[1],s=ux(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(s)?{tag:"g",attributes:{class:"".concat(_t.cssPrefix,"-").concat(A0.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(A0.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(A0.PRIMARY),fill:"currentColor",d:s[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:s}}}}var wWe={found:!1,width:512,height:512};function kx(r,e){var t=e;return"fa"===e&&null!==_t.styleDefault&&(e=Al()),new Promise(function(n,i){if(p4("missingIconAbstract"),"fa"===t){var o=Nte(r)||{};r=o.iconName||r,e=o.prefix||e}if(r&&e&&Ax[e]&&Ax[e][r])return n(Ix(Ax[e][r]));(function NWe(r,e){!hte&&!_t.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(ut(ut({},wWe),{},{icon:_t.showMissingIcons&&r&&p4("missingIconAbstract")||{}}))})}var Lte=function(){},xx=_t.measurePerformance&&xv&&xv.mark&&xv.measure?xv:{mark:Lte,measure:Lte},Ld='FA "6.4.2"',Rte=function(e){xx.mark("".concat(Ld," ").concat(e," ends")),xx.measure("".concat(Ld," ").concat(e),"".concat(Ld," ").concat(e," begins"),"".concat(Ld," ").concat(e," ends"))},Lx={begin:function(e){return xx.mark("".concat(Ld," ").concat(e," begins")),function(){return Rte(e)}},end:Rte},jv=function(){};function zte(r){return"string"==typeof(r.getAttribute?r.getAttribute(N0):null)}function LWe(r){return G1.createElementNS("http://www.w3.org/2000/svg",r)}function RWe(r){return G1.createElement(r)}function Dte(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?LWe:RWe:t;if("string"==typeof r)return G1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(o){i.setAttribute(o,r.attributes[o])}),(r.children||[]).forEach(function(o){i.appendChild(Dte(o,{ceFn:n}))}),i}var Zv={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(Dte(i),t)}),null===t.getAttribute(N0)&&_t.keepOriginalSource){var n=G1.createComment(function zWe(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~vx(t).indexOf(_t.replacementClass))return Zv.replace(e);var i=new RegExp("".concat(_t.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var s=n[0].attributes.class.split(" ").reduce(function(a,c){return c===_t.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),0===s.toNode.length?t.removeAttribute("class"):t.setAttribute("class",s.toNode.join(" "))}var o=n.map(function(a){return xd(a)}).join("\n");t.setAttribute(N0,""),t.innerHTML=o}};function Hte(r){r()}function Vte(r,e){var t="function"==typeof e?e:jv;if(0===r.length)t();else{var n=Hte;_t.mutateApproach===FUe&&(n=wl.requestAnimationFrame||Hte),n(function(){var i=function xWe(){return!0===_t.autoReplaceSvg?Zv.replace:Zv[_t.autoReplaceSvg]||Zv.replace}(),s=Lx.begin("mutate");r.map(i),s(),t()})}}var Rx=!1;function Fte(){Rx=!0}function zx(){Rx=!1}var Yv=null;function $te(r){if(cte&&_t.observeMutations){var e=r.treeCallback,t=void 0===e?jv:e,n=r.nodeCallback,i=void 0===n?jv:n,s=r.pseudoElementsCallback,o=void 0===s?jv:s,a=r.observeMutationsRoot,c=void 0===a?G1:a;Yv=new cte(function(l){if(!Rx){var f=Al();cu(l).forEach(function(d){if("childList"===d.type&&d.addedNodes.length>0&&!zte(d.addedNodes[0])&&(_t.searchPseudoElements&&o(d.target),t(d.target)),"attributes"===d.type&&d.target.parentNode&&_t.searchPseudoElements&&o(d.target.parentNode),"attributes"===d.type&&zte(d.target)&&~jUe.indexOf(d.attributeName))if("class"===d.attributeName&&function IWe(r){var e=r.getAttribute?r.getAttribute(gx):null,t=r.getAttribute?r.getAttribute(mx):null;return e&&t}(d.target)){var m=Wv(vx(d.target)),w=m.iconName;d.target.setAttribute(gx,m.prefix||f),w&&d.target.setAttribute(mx,w)}else(function kWe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(_t.replacementClass)})(d.target)&&i(d.target)})}}),f4&&Yv.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Bte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function VWe(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=Wv(vx(r));return i.prefix||(i.prefix=Al()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function mWe(r,e){return(Pte[r]||{})[e]}(i.prefix,r.innerText)||Ox(i.prefix,Ex(r.innerText))),!i.iconName&&_t.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,s=t.rest,o=function FWe(r){var e=cu(r.attributes).reduce(function(i,s){return"class"!==i.name&&"style"!==i.name&&(i[s.name]=s.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return _t.autoA11y&&(t?e["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(n||kd()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=bx("parseNodeAttributes",{},r),c=e.styleParser?function HWe(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var s=i.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(n[o]=a.join(":").trim()),n},{})),t}(r):[];return ut({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:qc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:c,attributes:o}},a)}var BWe=Ha.styles;function Gte(r){var e="nest"===_t.autoReplaceSvg?Bte(r,{styleParser:!1}):Bte(r);return~e.extra.classes.indexOf(pte)?p4("generateLayersText",r,e):p4("generateSvgReplacementMutation",r,e)}var Il=new Set;function Ute(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!f4)return Promise.resolve();var t=G1.documentElement.classList,n=function(d){return t.add("".concat(dte,"-").concat(d))},i=function(d){return t.remove("".concat(dte,"-").concat(d))},s=_t.autoFetchSvg?Il:_x.map(function(f){return"fa-".concat(f)}).concat(Object.keys(BWe));s.includes("fa")||s.push("fa");var o=[".".concat(pte,":not([").concat(N0,"])")].concat(s.map(function(f){return".".concat(f,":not([").concat(N0,"])")})).join(", ");if(0===o.length)return Promise.resolve();var a=[];try{a=cu(r.querySelectorAll(o))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=Lx.begin("onTree"),l=a.reduce(function(f,d){try{var m=Gte(d);m&&f.push(m)}catch(E){hte||"MissingIcon"===E.name&&console.error(E)}return f},[]);return new Promise(function(f,d){Promise.all(l).then(function(m){Vte(m,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),f()})}).catch(function(m){c(),d(m)})})}function GWe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Gte(r).then(function(t){t&&Vte([t],e)})}function UWe(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:wx(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:wx(i||{})),r(n,ut(ut({},t),{},{mask:i}))}}_x.map(function(r){Il.add("fa-".concat(r))}),Object.keys(Td[U1]).map(Il.add.bind(Il)),Object.keys(Td[Nr]).map(Il.add.bind(Il)),Il=Pd(Il);var WWe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?qc:n,s=t.symbol,o=void 0!==s&&s,a=t.mask,c=void 0===a?null:a,l=t.maskId,f=void 0===l?null:l,d=t.title,m=void 0===d?null:d,E=t.titleId,w=void 0===E?null:E,R=t.classes,z=void 0===R?[]:R,$=t.attributes,G=void 0===$?{}:$,de=t.styles,Ce=void 0===de?{}:de;if(e){var Le=e.prefix,tt=e.iconName,gt=e.icon;return qv(ut({type:"icon"},e),function(){return k0("beforeDOMElementCreation",{iconDefinition:e,params:t}),_t.autoA11y&&(m?G["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(w||kd()):(G["aria-hidden"]="true",G.focusable="false")),Nx({icons:{main:Ix(gt),mask:c?Ix(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Le,iconName:tt,transform:ut(ut({},qc),i),symbol:o,title:m,maskId:f,titleId:w,extra:{attributes:G,styles:Ce,classes:z}})})}},qWe={mixout:function(){return{icon:UWe(WWe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=Ute,t.nodeCallback=GWe,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,s=t.callback;return Ute(void 0===n?G1:n,void 0===s?function(){}:s)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,s=n.title,o=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,f=n.mask,d=n.maskId,m=n.extra;return new Promise(function(E,w){Promise.all([kx(i,a),f.iconName?kx(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(R){var z=ux(R,2);E([t,Nx({icons:{main:z[0],mask:z[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:d,title:s,titleId:o,extra:m,watchable:!0})])}).catch(w)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,s=t.main,o=t.transform,c=Vv(t.styles);return c.length>0&&(i.style=c),Cx(o)&&(l=p4("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),n.push(l||s.icon),{children:n,attributes:i}}}},jWe={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,s=void 0===i?[]:i;return qv({type:"layer"},function(){k0("beforeDOMElementCreation",{assembler:t,params:n});var o=[];return t(function(a){Array.isArray(a)?a.map(function(c){o=o.concat(c.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_t.cssPrefix,"-layers")].concat(Pd(s)).join(" ")},children:o}]})}}}},ZWe={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,s=void 0===i?null:i,o=n.classes,a=void 0===o?[]:o,c=n.attributes,l=void 0===c?{}:c,f=n.styles,d=void 0===f?{}:f;return qv({type:"counter",content:t},function(){return k0("beforeDOMElementCreation",{content:t,params:n}),function bWe(r){var e=r.content,t=r.title,n=r.extra,i=ut(ut(ut({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),s=Vv(n.styles);s.length>0&&(i.style=s);var o=[];return o.push({tag:"span",attributes:i,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}({content:t.toString(),title:s,extra:{attributes:l,styles:d,classes:["".concat(_t.cssPrefix,"-layers-counter")].concat(Pd(a))}})})}}}},YWe={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,s=void 0===i?qc:i,o=n.title,a=void 0===o?null:o,c=n.classes,l=void 0===c?[]:c,f=n.attributes,d=void 0===f?{}:f,m=n.styles,E=void 0===m?{}:m;return qv({type:"text",content:t},function(){return k0("beforeDOMElementCreation",{content:t,params:n}),xte({content:t,transform:ut(ut({},qc),s),title:a,extra:{attributes:d,styles:E,classes:["".concat(_t.cssPrefix,"-layers-text")].concat(Pd(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,s=n.transform,o=n.extra,a=null,c=null;if(lte){var l=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();a=f.width/l,c=f.height/l}return _t.autoA11y&&!i&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,xte({content:t.innerHTML,width:a,height:c,transform:s,title:i,extra:o,watchable:!0})])}}},KWe=new RegExp('"',"ug"),Wte=[1105920,1112319];function qte(r,e){var t="".concat(VUe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var o=cu(r.children).filter(function(gt){return gt.getAttribute(px)===e})[0],a=wl.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(UUe),l=a.getPropertyValue("font-weight"),f=a.getPropertyValue("content");if(o&&!c)return r.removeChild(o),n();if(c&&"none"!==f&&""!==f){var d=a.getPropertyValue("content"),m=~["Sharp"].indexOf(c[2])?Nr:U1,E=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?bd[m][c[2].toLowerCase()]:WUe[m][l],w=function XWe(r){var e=r.replace(KWe,""),t=function uWe(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=Wte[0]&&t<=Wte[1],i=2===e.length&&e[0]===e[1];return{value:Ex(i?e[0]:e),isSecondary:n||i}}(d),R=w.value,z=w.isSecondary,$=c[0].startsWith("FontAwesome"),G=Ox(E,R),de=G;if($){var Ce=function _We(r){var e=Tte[r],t=Ox("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(R);Ce.iconName&&Ce.prefix&&(G=Ce.iconName,E=Ce.prefix)}if(!G||z||o&&o.getAttribute(gx)===E&&o.getAttribute(mx)===de)n();else{r.setAttribute(t,de),o&&r.removeChild(o);var Le=function $We(){return{iconName:null,title:null,titleId:null,prefix:null,transform:qc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),tt=Le.extra;tt.attributes[px]=e,kx(G,E).then(function(gt){var yn=Nx(ut(ut({},Le),{},{icons:{main:gt,mask:Tx()},prefix:E,iconName:de,extra:tt,watchable:!0})),Et=G1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(Et,r.firstChild):r.appendChild(Et),Et.outerHTML=yn.map(function(ti){return xd(ti)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function QWe(r){return Promise.all([qte(r,"::before"),qte(r,"::after")])}function JWe(r){return!(r.parentNode===document.head||~$Ue.indexOf(r.tagName.toUpperCase())||r.getAttribute(px)||r.parentNode&&"svg"===r.parentNode.tagName)}function jte(r){if(f4)return new Promise(function(e,t){var n=cu(r.querySelectorAll("*")).filter(JWe).map(QWe),i=Lx.begin("searchPseudoElements");Fte(),Promise.all(n).then(function(){i(),zx(),e()}).catch(function(){i(),zx(),t()})})}var Zte=!1,Yte=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var s=i.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&"h"===a)return n.flipX=!0,n;if(o&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(o){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Dx={x:0,y:0,width:"100%",height:"100%"};function Kte(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function rqe(r){return"g"===r.tag?r.children:[r]}var iqe={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),s=i?Wv(i.split(" ").map(function(o){return o.trim()})):Tx();return s.prefix||(s.prefix=Al()),t.mask=s,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,s=t.main,o=t.mask,a=t.maskId,f=s.icon,m=o.icon,E=function nWe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},s="translate(".concat(32*e.x,", ").concat(32*e.y,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(s," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:o.width,iconWidth:s.width}),w={tag:"rect",attributes:ut(ut({},Dx),{},{fill:"white"})},R=f.children?{children:f.children.map(Kte)}:{},z={tag:"g",attributes:ut({},E.inner),children:[Kte(ut({tag:f.tag,attributes:ut(ut({},f.attributes),E.path)},R))]},$={tag:"g",attributes:ut({},E.outer),children:[z]},G="mask-".concat(a||kd()),de="clip-".concat(a||kd()),Ce={tag:"mask",attributes:ut(ut({},Dx),{},{id:G,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[w,$]},Le={tag:"defs",children:[{tag:"clipPath",attributes:{id:de},children:rqe(m)},Ce]};return n.push(Le,{tag:"rect",attributes:ut({fill:"currentColor","clip-path":"url(#".concat(de,")"),mask:"url(#".concat(G,")")},Dx)}),{children:n,attributes:i}}}};!function yWe(r,e){var t=e.mixoutsTo;Ite=r,uu={},Object.keys(fu).forEach(function(n){-1===CWe.indexOf(n)&&delete fu[n]}),Ite.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(o){"function"==typeof i[o]&&(t[o]=i[o]),"object"===Iv(i[o])&&Object.keys(i[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=i[o][a]})}),n.hooks){var s=n.hooks();Object.keys(s).forEach(function(o){uu[o]||(uu[o]=[]),uu[o].push(s[o])})}n.provides&&n.provides(fu)})}([sWe,qWe,jWe,ZWe,YWe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=jte,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;_t.searchPseudoElements&&jte(void 0===n?G1:n)}}},{mixout:function(){return{dom:{unwatch:function(){Fte(),Zte=!0}}}},hooks:function(){return{bootstrap:function(){$te(bx("mutationObserverCallbacks",{}))},noAuto:function(){!function DWe(){Yv&&Yv.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;Zte?zx():$te(bx("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return Yte(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=Yte(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,o=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),f="rotate(".concat(i.rotate," 0 0)"),E={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(f)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:ut({},E.outer),children:[{tag:"g",attributes:ut({},E.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ut(ut({},n.icon.attributes),E.path)}]}]}}}},iqe,{provides:function(e){var t=!1;wl.matchMedia&&(t=wl.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ut(ut({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=ut(ut({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:ut(ut({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:ut(ut({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ut(ut({},o),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:ut(ut({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:ut(ut({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:ut(ut({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ut(ut({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:No});var cqe=No.parse,lqe=No.icon;const uqe=["*"],hqe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let mqe=(()=>{var r;class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),_qe=(()=>{var r;class e{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const s of i.icon[2])"string"==typeof s&&(this.definitions[i.prefix][s]=i)}}addIconPacks(...n){for(const i of n){const s=Object.keys(i).map(o=>i[o]);this.addIcons(...s)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),vqe=(()=>{var r;class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[as]}),e})(),Cqe=(()=>{var r;class e{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(yc),U(Li))},r.\u0275cmp=Be({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},features:[as],ngContentSelectors:uqe,decls:1,vars:0,template:function(n,i){1&n&&(function $V(r){const e=Se()[Vr][ki];if(!e.projection){const n=e.projection=y7(r?r.length:1,null),i=n.slice();let s=e.child;for(;null!==s;){const o=r?Wue(s,r):0;null!==o&&(i[o]?i[o].projectionNext=s:n[o]=s,i[o]=s),s=s.next}}}(),function BV(r,e=0,t){const n=Se(),i=zn(),s=I8(i,gn+r,16,null,t||null);null===s.projection&&(s.projection=e),Ky(),(!n[O3]||u8())&&32!=(32&s.flags)&&function Q0e(r,e,t){XD(e[Xt],0,e,t,SM(r,t,e),WD(t.parent||e[ki],t,e))}(i,n,s)}(0))},encapsulation:2}),e})(),x0=(()=>{var r;class e{set spin(n){this.animation=n?"spin":void 0}set pulse(n){this.animation=n?"spin-pulse":void 0}constructor(n,i,s,o,a){this.sanitizer=n,this.config=i,this.iconLibrary=s,this.stackItem=o,this.classes=[],null!=a&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null!=this.icon||null!=this.config.fallbackIcon){if(n){const s=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=s){const o=this.buildParams();this.renderIcon(s,o)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(n,this.config.defaultPrefix);return"icon"in i?i:this.iconLibrary.getIconDefinition(i.prefix,i.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?cqe.transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...hqe(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const s=lqe(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return(r=e).\u0275fac=function(n){return new(n||r)(U(yG),U(mqe),U(_qe),U(vqe,8),U(Cqe,8))},r.\u0275cmp=Be({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(OE("innerHTML",i.renderedIconHTML,b7),I("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[as],decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})(),yqe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ai({type:r}),r.\u0275inj=ii({}),e})();var $x={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Jne={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},L1e={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},nL={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},Fie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},uL={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Kie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},moe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},TL={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Qoe={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class Tae{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>bo(i,n))&&t.push(n)}),t}}let bae;bae=Symbol.iterator;class st{constructor(e){u(this,"values",void 0),this.values=void 0===e?[]:Tae.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(bo(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new st(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(bo(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?g.of(this.values[0]):g.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new st(t)}flatMap(e){const t=new st;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new st;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return g.of(t);return g.empty()}intersection(e){const t=new st;for(const n of e)this.contains(n)&&t.add(n);return t}[bae](){return this.values.values()}}class Pn{static from(e){const t=Object.keys(e),n=new Pn;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){u(this,"map",void 0),u(this,"isImmutable",void 0),this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(bo(t.key,e))return g.of(t.value);return g.empty()}getAnyPair(){return this.size()>0?g.of(this.map[0]):g.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(bo(n.key,e)){const i=n.value;return n.value=t,g.of(i)}return this.map.push({key:e,value:t}),g.empty()}containsKey(e){return this.map.some(t=>bo(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}listValues(){return this.map.map(e=>e.value)}getKeySet(){return new st(this.listKeys())}filter(e){const t=new Pn;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(bo(this.map[t].key,e)){const i=this.map[t].value,s=this.map.slice(0,t),o=this.map.slice(t+1);return this.map=s.concat(o),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const s=this.get(i).get(),o=e.get(i);if(je(o.isPresent(),"value is absent in a map even though its key is present!"),!1===bo(s,o.get()))return!1}return!0}}class du extends Pn{reverse(){const e=new du;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new st;i.add(t),e.set(n,i)}}return e}}var dC;class ys{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"connectedUserService",void 0),u(this,"authSubscription",void 0),u(this,"userSubscription",new En),u(this,"currentGame",g.empty()),u(this,"currentGameRS",void 0),u(this,"currentGameObs",void 0),this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new pee(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var s=M(function*(o){yield i.onUserUpdate(o)});return function(o){return s.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return M(function*(){if(e===O0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=g.empty(),t.currentGameRS.next(g.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{je(i.isPresent(),"Observing part service expected user to already have a document!");const s=i.get();t.onCurrentGameUpdate(s.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=g.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=g.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(je(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)je(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return je(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return b.SUCCESS;{const e=ys.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return b.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return b.SUCCESS;{const n=ys.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new En;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function $7t(r,e){if(1&r&&(Gt(0),oe(1,31),Ut()),2&r){const t=p(2);_(1),Gn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Kn(1)}}function B7t(r,e){if(1&r&&(Gt(0),oe(1,33),Ut()),2&r){const t=p(3);_(1),Gn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Kn(1)}}function G7t(r,e){if(1&r&&(Gt(0),oe(1,34),Ut()),2&r){const t=p(3);_(1),Gn(t.currentGame.get().typeGame),Kn(1)}}function U7t(r,e){if(1&r&&(O(0,B7t,2,2,"ng-container",27),O(1,G7t,2,1,"ng-template",null,32,dn)),2&r){const t=un(2);y("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function W7t(r,e){if(1&r){const t=pe();S(0,"a",29),W("click",function(){return ne(t),re(p().navigateToPart())}),O(1,$7t,2,2,"ng-container",27),O(2,U7t,3,2,"ng-template",null,30,dn),P()}if(2&r){const t=un(3),n=p();_(1),y("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function q7t(r,e){if(1&r&&(Gt(0),V(1,"fa-icon",35),Ut()),2&r){const t=p();_(1),y("icon",t.faSpinner)}}function j7t(r,e){if(1&r){const t=pe();Gt(0),S(1,"div",10)(2,"a",37),ct(3),P(),S(4,"div",13)(5,"a",38),oe(6,39),P(),S(7,"a",40),W("click",function(){return ne(t),re(p(2).logout())}),oe(8,41),P()()(),Ut()}if(2&r){const t=p(2);_(3),mn(t.username.get())}}dC=ys,u(ys,"roleToMessage",new Pn([{key:"Candidate",value:vd.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:vd.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:vd.YOU_ARE_ALREADY_CREATING},{key:"Player",value:vd.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:vd.YOU_ARE_ALREADY_OBSERVING}])),u(ys,"\u0275fac",function(e){return new(e||dC)(Oe(_d),Oe(iu),Oe(ur))}),u(ys,"\u0275prov",De({token:dC,factory:dC.\u0275fac,providedIn:"root"}));const Z7t=function(){return["/register"]},Y7t=function(){return["/login"]};function K7t(r,e){1&r&&(S(0,"div",42)(1,"a",43)(2,"strong"),oe(3,44),P()(),S(4,"a",45),oe(5,46),P()()),2&r&&(_(1),y("routerLink",D1(2,Z7t)),_(3),y("routerLink",D1(3,Y7t)))}function X7t(r,e){if(1&r&&(O(0,j7t,9,1,"ng-container",27),O(1,K7t,6,4,"ng-template",null,36,dn)),2&r){const t=un(2);y("ngIf",p().username.isPresent())("ngIfElse",t)}}const wae=function(){return["/"]},Q7t=function(){return["/play"]},J7t=function(){return["/lobby"]},eft=function(){return["/local"]},tft=function(){return["/tutorial"]},nft=function(){return["/settings"]};let rft=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"loading",!0),u(this,"username",g.empty()),u(this,"faCog",Fie),u(this,"faSpinner",moe),u(this,"userSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"showMenu",!1),u(this,"currentGame",g.empty()),this.router=n,this.connectedUserService=i,this.currentGameService=s,this.userService=o}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(n=>{this.loading=!1,this.username=n.username.isPresent()?n.username:n.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(n=>{this.currentGame=n})}logout(){var n=this;return M(function*(){yield n.connectedUserService.disconnect(),yield n.router.navigate(["/"])})()}navigateToPart(){var n=this;return M(function*(){return n.router.navigate(["/play",n.currentGame.get().typeGame,n.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(ur),U(ys),U(iu))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R,z;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,s=$localize`Join a game`,o=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,w=$localize`Log out`,R=$localize`Register`,z=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,s,["id","playOffline",1,"navbar-link"],o,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],f,["waitingForOpponent",""],d,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],w,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],R,["id","login",1,"button","is-light",3,"routerLink"],z]},template:function(n,i){if(1&n&&(S(0,"nav",0)(1,"div",1)(2,"a",2),V(3,"img",3),P(),S(4,"a",4),W("click",function(){return i.showMenu=!i.showMenu}),V(5,"span",5)(6,"span",5)(7,"span",5),P()(),S(8,"div",6),W("click",function(){return i.showMenu=!i.showMenu}),S(9,"div",7)(10,"a",8),oe(11,9),P(),S(12,"div",10)(13,"a",11),oe(14,12),P(),S(15,"div",13)(16,"a",2),oe(17,14),P(),S(18,"a",2),oe(19,15),P()()(),S(20,"div",10)(21,"a",16),oe(22,17),P(),S(23,"div",13)(24,"a",18),oe(25,19),P(),S(26,"a",20),oe(27,21),P()()()(),S(28,"div",22),O(29,W7t,4,2,"a",23),S(30,"a",24),V(31,"fa-icon",25),P(),S(32,"div",26),O(33,q7t,2,1,"ng-container",27),O(34,X7t,3,2,"ng-template",null,28,dn),P()()()()),2&n){const s=un(35);_(2),y("routerLink",D1(13,wae)),_(2),y("ngClass",i.showMenu?"is-active":""),_(4),y("ngClass",i.showMenu?"is-active":""),_(2),y("routerLink",D1(14,wae)),_(6),y("routerLink",D1(15,Q7t)),_(2),y("routerLink",D1(16,J7t)),_(6),y("routerLink",D1(17,eft)),_(2),y("routerLink",D1(18,tft)),_(3),y("ngIf",i.currentGame.isPresent()),_(1),y("routerLink",D1(19,nft)),_(1),y("icon",i.faCog),_(2),y("ngIf",i.loading)("ngIfElse",s)}},dependencies:[Dt,wt,Ic,x0],encapsulation:2})),e})(),ift=(()=>{var r;class e{constructor(n,i){u(this,"_themeService",void 0),u(this,"_errorLoggerService",void 0),u(this,"faTwitter",jee),u(this,"faFacebook",Fee),u(this,"faGithub",qee),this._themeService=n,this._errorLoggerService=i}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Av),U(m2))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(V(0,"app-header"),S(1,"main",0),V(2,"router-outlet"),P(),S(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),Gs(7,3),V(8,"strong"),Us(),P(),ct(9," \xa0 "),S(10,"a",4),V(11,"fa-icon",5),P(),ct(12,"\xa0 "),S(13,"a",6),V(14,"fa-icon",5),P(),ct(15,"\xa0 "),S(16,"a",7),V(17,"fa-icon",5),P()()()()),2&n&&(_(11),y("icon",i.faGithub),_(3),y("icon",i.faTwitter),_(3),y("icon",i.faFacebook))},dependencies:[OP,x0,rft],encapsulation:2})),e})();class vi{constructor(){u(this,"__nominal",void 0)}}var hu;class tn{static of(e){switch(e){case 0:return tn.ZERO;case 1:return tn.ONE;case 2:return tn.TWO;default:return je(3===e,"Invalid Apagos Coord "+e),tn.THREE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}}hu=tn,u(tn,"encoder",we.tuple([we.identity()],r=>[r.x],r=>hu.of(r[0]))),u(tn,"ZERO",new hu(0)),u(tn,"ONE",new hu(1)),u(tn,"TWO",new hu(2)),u(tn,"THREE",new hu(3));let pu=(()=>{class r{}return u(r,"PIECE_SHOULD_MOVE_DOWNWARD",()=>$localize`Pieces should only move downward!`),u(r,"CANNOT_LAND_ON_A_FULL_SQUARE",()=>$localize`That square is already full, you cannot put a piece in it!`),u(r,"NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE",()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`),u(r,"NO_PIECE_REMAINING_TO_DROP",()=>$localize`There are no remaining pieces of that color to drop!`),u(r,"NO_POSSIBLE_TRANSFER_REMAINS",()=>$localize`There is no possible transfer from that square!`),r})();var Wi;class Ao extends vi{static drop(e,t){return B.getNonNullable(Ao.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(g.empty())))}static transfer(e,t){if(e.x<=t.x)return Q.failure(pu.PIECE_SHOULD_MOVE_DOWNWARD());const n=B.getNonNullable(Ao.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(g.empty())&&i.starting.equals(g.of(e))));return Q.success(n)}constructor(e,t,n){super(),u(this,"landing",void 0),u(this,"piece",void 0),u(this,"starting",void 0),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}u(Ao,"ALL_MOVES",[new(Wi=Ao)(tn.ZERO,g.of(k.ZERO),g.empty()),new Wi(tn.ONE,g.of(k.ZERO),g.empty()),new Wi(tn.TWO,g.of(k.ZERO),g.empty()),new Wi(tn.THREE,g.of(k.ZERO),g.empty()),new Wi(tn.ZERO,g.of(k.ONE),g.empty()),new Wi(tn.ONE,g.of(k.ONE),g.empty()),new Wi(tn.TWO,g.of(k.ONE),g.empty()),new Wi(tn.THREE,g.of(k.ONE),g.empty()),new Wi(tn.TWO,g.empty(),g.of(tn.THREE)),new Wi(tn.ONE,g.empty(),g.of(tn.THREE)),new Wi(tn.ZERO,g.empty(),g.of(tn.THREE)),new Wi(tn.ONE,g.empty(),g.of(tn.TWO)),new Wi(tn.ZERO,g.empty(),g.of(tn.TWO)),new Wi(tn.ZERO,g.empty(),g.of(tn.ONE))]),u(Ao,"encoder",we.tuple([tn.encoder,g.getEncoder(k.encoder),g.getEncoder(tn.encoder)],r=>[r.landing,r.piece,r.starting],r=>new Wi(r[0],r[1],r[2])));class hC{constructor(e){u(this,"turn",void 0),this.turn=e}getCurrentPlayer(){return k.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?k.ZERO:k.ONE}}let Nae;class qt{static create(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copy(e){return e.map(t=>t)}static sortByDescending(e,t){e.sort((n,i)=>{const s=t(n),o=t(i);return s<o?1:s>o?-1:0})}static compare(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===bo(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&qt.compare(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}static getRandomElement(e){return B.assert(e.length>0,"ArrayUtils.getRandomElement must be called on an array containing elements"),e[Math.floor(Math.random()*e.length)]}static maximumsBy(e,t){const n=[];let i=Number.MIN_SAFE_INTEGER;for(let s=0;s<e.length;s++){const o=t(e[s]);o>i&&(i=o,n.push(e[s]))}return n}static count(e,t){let n=0;for(const i of e)bo(i,t)&&n++;return n}}class xt{static create(e,t,n){const i=[];for(let s=0;s<t;s++)i.push(qt.create(e,n));return i}static map(e,t){return e.map(n=>n.map(t))}static copy(e){return xt.map(e,t=>t)}static compare(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===qt.compare(e[n],t[n]))return!1;return!0}}Nae=Symbol.iterator;class Aae{constructor(){u(this,"content",new Pn)}get(e){const t=this.content.get(e.y);return t.isAbsent()?g.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new Pn,this.content.set(e.y,i)),i.set(e.x,t)}[Nae](){const e=[],t=this.content.getKeySet().toList();t.sort(qt.smallerFirst);for(const n of t){const i=this.content.get(n).get(),s=i.getKeySet().toList();s.sort(qt.smallerFirst);for(const o of s){const a=i.get(o).get();e.push({x:o,y:n,content:a})}}return e.values()}}class sft{static create(e,t,n,i){const s=[];for(let o=0;o<e;o++)s.push(xt.create(t,n,i));return s}}class Fd{static from(e,t,n){if(e+t>n)return Q.failure("invalid starting space");const i=new Pn([{key:k.ZERO,value:e},{key:k.ONE,value:t},{key:q.NONE,value:n}]);i.makeImmutable();const s=new Fd(i);return Q.success(s)}constructor(e){u(this,"containing",void 0),this.containing=e}isFull(){return this.count(k.ZERO)+this.count(k.ONE)>=this.count(q.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(q.NONE);return e===k.ZERO?t++:n++,Fd.from(t,n,i).get()}substractPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(q.NONE);return e===k.ZERO?t--:n--,Fd.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(k.ZERO),t=this.count(k.ONE);return e>t?k.ZERO:t>e?k.ONE:q.NONE}equals(e){return this.containing.equals(e.containing)}}class g4 extends hC{static fromRepresentation(e,t,n,i){const s=[];for(let a=0;a<4;a++){const d=Fd.from(t[0][a],t[1][a],t[2][a]).get();s.push(d)}const o=new Pn;return o.set(k.ZERO,n),o.set(k.ONE,i),new g4(e,s,o)}constructor(e,t,n){super(e),u(this,"board",void 0),u(this,"remaining",void 0),this.board=t,this.remaining=n,this.remaining.makeImmutable()}getPieceAt(e){return this.board[e.x]}updateAt(e,t){const n=[];for(let s=0;s<4;s++)n.push(e.x===s?t:this.board[s]);const i=this.getRemainingCopy();return new g4(this.turn,n,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&qt.compare(e.board,this.board)&&this.remaining.equals(e.remaining)}}class j{static fromMove(e,t,n,i,s,o){return new oft(e,t,n,i,s,o)}static forClick(e,t,n,i,s,o){return new cft(e,t,n,i,s,o)}static anyMove(e,t,n,i,s){return new aft(e,t,n,i,s)}static fromPredicate(e,t,n,i,s,o){return new lft(e,t,n,i,s,o)}static informational(e,t,n){return new uft(e,t,n)}constructor(e,t,n){u(this,"title",void 0),u(this,"instruction",void 0),u(this,"state",void 0),u(this,"previousMove",g.empty()),this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=g.of(e),this}}class pC extends j{constructor(e,t,n,i){super(e,t,n),u(this,"successMessage",void 0),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class oft extends pC{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedMoves",void 0),u(this,"failureMessage",void 0),this.acceptedMoves=i,this.failureMessage=o,je(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class aft extends pC{constructor(e,t,n,i,s){super(e,t,n,s),u(this,"solutionMove",void 0),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class cft extends pC{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedClicks",void 0),u(this,"failureMessage",void 0),this.acceptedClicks=i,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class lft extends pC{constructor(e,t,n,i,s,o){super(e,t,n,o),u(this,"solutionMove",void 0),u(this,"predicate",void 0),this.solutionMove=i,this.predicate=s}getSolution(){return this.solutionMove}isPredicate(){return!0}}class uft extends j{isInformation(){return!0}}class qn{}class Jn{static isVictory(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER}static isPreVictory(e){return e===Number.MAX_SAFE_INTEGER-1||e===Number.MIN_SAFE_INTEGER+1}static of(e,t){return e*=k.ZERO.getScoreModifier(),t*=k.ONE.getScoreModifier(),new Jn(e+t)}constructor(e){u(this,"value",void 0),this.value=e}}var $d,gC,LL;u(Jn,"VICTORIES",[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]);class _e{static getVictory(e){return e===k.ZERO?_e.ZERO_WON:_e.ONE_WON}static getDefeat(e){return e===k.ZERO?_e.ONE_WON:_e.ZERO_WON}constructor(e,t){u(this,"isEndGame",void 0),u(this,"winner",void 0),this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?new Jn(this.winner.getVictoryValue()):new Jn(0)}}u(_e,"ZERO_WON",new($d=_e)(!0,k.ZERO)),u(_e,"ONE_WON",new $d(!0,k.ONE)),u(_e,"DRAW",new $d(!0,q.NONE)),u(_e,"ONGOING",new $d(!1,q.NONE));let Iae=(()=>{class r{}return u(r,"createdNodes",0),r})(),Qo=(gC=class{constructor(e,t=g.empty(),n=g.empty()){u(this,"gameState",void 0),u(this,"parent",void 0),u(this,"previousMove",void 0),u(this,"id",void 0),u(this,"children",new Pn),u(this,"cache",new Pn),this.gameState=e,this.parent=t,this.previousMove=n,this.id=LL.ID++,Iae.createdNodes++}getChild(e){return this.children.get(e)}hasChildren(){return this.getChildren().length>0}getChildren(){return this.children.listValues()}addChild(e){B.assert(e.previousMove.isPresent(),"GameNode: addChild expects a node with a previous move"),this.children.set(e.previousMove.get(),e)}printDot(e,t,n,i=0,s=0){0===i&&console.log("digraph G {");const o=e.getGameStatus(this);let a="white";if(o.isEndGame)switch(o.winner){case k.ZERO:a="#994d00";break;case k.ONE:a="#ffc34d";break;default:a="grey"}let c=`#${this.gameState.turn}: ${this.id}`;t&&(c+=` - ${t(this)}`),console.log(`    node_${s} [label="${c}", style=filled, fillcolor="${a}"];`);let l=s+1;if(void 0===n||i<n)for(const f of this.children.listValues())console.log(`    node_${s} -> node_${l} [label="${f.previousMove.get()}"];`),l=f.printDot(e,t,n,i+1,l);return 0===i&&console.log("}"),l}getCache(e){return this.cache.get(e)}setCache(e,t){this.cache.containsKey(e)?this.cache.replace(e,t):this.cache.set(e,t)}},LL=gC,u(gC,"ID",0),gC);Qo=LL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],Qo);class jn{constructor(){}choose(e,t){Ae.display("Rules","choose",t.toString()+" was proposed");const n=this.isLegal(t,e.gameState);if(n.isFailure())return Ae.display("Rules","choose","Move is illegal: "+n.getReason()),Q.failure(n.getReason());const i=e.getChild(t);if(i.isPresent())return B.assert(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),Ae.display("Rules","choose","and this proposed move is found in the list, so it is legal"),Q.success(i.get());const s=this.applyLegalMove(t,e.gameState,n.get()),o=new Qo(s,g.of(e),g.of(t));return Q.success(o)}getInitialNode(){const e=this.getInitialState();return new Qo(e)}}class Xs extends jn{static get(){return Xs.singleton.isAbsent()&&(Xs.singleton=g.of(new Xs)),Xs.singleton.get()}getInitialState(){return g4.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],Xs.PIECES_PER_PLAYER,Xs.PIECES_PER_PLAYER)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),i=n.get(e.piece.get()).get();n.put(e.piece.get(),i-1);const s=new g4(t.turn+1,t.board,n),o=e.piece.get(),a=s.getPieceAt(e.landing).addPiece(o);if(e.landing===tn.THREE)return s.updateAt(e.landing,a);{const c=tn.of(e.landing.x+1),l=s.getPieceAt(c);return s.updateAt(e.landing,l).updateAt(c,a)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),s=t.getPieceAt(i).substractPiece(n),o=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,s);return a=a.updateAt(e.landing,o),new g4(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?b.failure(pu.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?b.failure(pu.NO_PIECE_REMAINING_TO_DROP()):b.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?b.failure(pu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(tn.of(i)).isFull())return _e.ONGOING;const n=t.getPieceAt(tn.THREE).getDominatingPlayer();return je(n.isPlayer(),"winner can only be a player if the game is finished"),_e.getVictory(n)}}u(Xs,"PIECES_PER_PLAYER",10),u(Xs,"singleton",g.empty());class kae extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Xs.get().getInitialState()),j.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,g4.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),Ao.drop(tn.ZERO,k.ZERO),$localize`Congratulations!`),j.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,g4.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),Ao.transfer(tn.TWO,tn.ZERO).get(),(t,n,i)=>t.isDrop()?b.failure($localize`This move is a drop, please do a transfer!`):b.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,g4.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),Ao.drop(tn.TWO,k.ONE),(t,n,i)=>t.isDrop()?t.piece.equalsValue(k.ONE)?b.SUCCESS:b.failure($localize`You actively made your opponent win!`):b.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)])}}class RL{static gcd(e,t){return 0===t?Math.abs(e):RL.gcd(t,e%t)}}class St{constructor(e,t){u(this,"x",void 0),u(this,"y",void 0),this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isSingleOrthogonalStep(){const e=Math.abs(this.x)+Math.abs(this.y)===1;return this.isOrthogonal()&&e}isOrthogonal(){return 0===this.x||0===this.y}isDiagonal(){return 0!==this.x&&0!==this.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=RL.gcd(this.x,this.y);return new St(this.x/e,this.y/e)}combine(e,t=1){return new St(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}var M1,Ms;class zL extends St{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class DL{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return Q.success(n);return Q.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?Q.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):Q.failure(dft.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return Q.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return Q.failure(`Invalid int direction: ${e}`)}}}class ye extends zL{constructor(e,t){super(e,t)}getOpposite(){return ye.factory.from(-this.x,-this.y).get()}}u(ye,"UP",new(M1=ye)(0,-1)),u(ye,"UP_RIGHT",new M1(1,-1)),u(ye,"RIGHT",new M1(1,0)),u(ye,"DOWN_RIGHT",new M1(1,1)),u(ye,"DOWN",new M1(0,1)),u(ye,"DOWN_LEFT",new M1(-1,1)),u(ye,"LEFT",new M1(-1,0)),u(ye,"UP_LEFT",new M1(-1,-1)),u(ye,"factory",new class extends DL{constructor(...r){super(...r),u(this,"all",[M1.UP,M1.UP_RIGHT,M1.RIGHT,M1.DOWN_RIGHT,M1.DOWN,M1.DOWN_LEFT,M1.LEFT,M1.UP_LEFT])}}),u(ye,"DIRECTIONS",M1.factory.all),u(ye,"DIAGONALS",[M1.UP_RIGHT,M1.DOWN_RIGHT,M1.DOWN_LEFT,M1.UP_LEFT]),u(ye,"ORTHOGONALS",[M1.UP,M1.RIGHT,M1.DOWN,M1.LEFT]),u(ye,"encoder",we.fromFunctions(r=>r.toString(),r=>(je("string"==typeof r,"Invalid encoded direction"),M1.factory.fromString(r).get())));class Re extends zL{constructor(e,t){super(e,t)}getOpposite(){return Re.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Re.factory.from(-this.y,this.x).get()}}u(Re,"UP",new(Ms=Re)(0,-1)),u(Re,"RIGHT",new Ms(1,0)),u(Re,"DOWN",new Ms(0,1)),u(Re,"LEFT",new Ms(-1,0)),u(Re,"factory",new class extends DL{constructor(...r){super(...r),u(this,"all",[Ms.UP,Ms.RIGHT,Ms.DOWN,Ms.LEFT])}from(r,e){return 0===r&&-1===e?Q.success(Ms.UP):1===r&&0===e?Q.success(Ms.RIGHT):0===r&&1===e?Q.success(Ms.DOWN):-1===r&&0===e?Q.success(Ms.LEFT):Q.failure("Invalid orthogonal from x and y")}}),u(Re,"ORTHOGONALS",Ms.factory.all),u(Re,"encoder",we.fromFunctions(r=>r.toString(),r=>(je("string"==typeof r,"Invalid encoded orthogonal"),Ms.factory.fromString(r).get())));let dft=(()=>{class r{}return u(r,"DIRECTION_MUST_BE_LINEAR",()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`),r})();var HL,gu;class m4{static OUT_OF_RANGE(e){return`The coordinate ${e.toString()} is not on the board`}}class v extends St{static getEncoder(e){return we.tuple([we.identity(),we.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new v(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new v(this.x+e.y,this.y+-e.x)}getRight(e){return new v(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return ye.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}isNeighborWith(e){return!!this.isAlignedWith(e)&&1===this.getDistance(e)}getVectorToward(e){return new St(e.x-this.x,e.y-this.y)}toVector(){return new St(this.x,this.y)}getCoordsToward(e){if(B.assert(e.isAlignedWith(this),"Should only call getCoordsTowards on aligned coords"),e.equals(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getAllCoordsToward(e){let t=[this];if(!1===this.equals(e)){const n=this.getCoordsToward(e);t=t.concat(n).concat(e)}return t}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let i=this.getNext(n);for(;!1===i.equals(e);)t.push(i),i=i.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}}u(v,"encoder",(HL=v).getEncoder((r,e)=>new HL(r,e)));class xae{constructor(){u(this,"ArrayUtils",qt)}getPlayerClass(e){switch(e){case k.ZERO:return"player0-fill";case k.ONE:return"player1-fill";default:return B.expectToBe(e,q.NONE),""}}}let jc=(gu=class extends xae{constructor(e){super(),u(this,"messageDisplayer",void 0),u(this,"encoder",void 0),u(this,"Player",k),u(this,"SPACE_SIZE",100),u(this,"STROKE_WIDTH",8),u(this,"SMALL_STROKE_WIDTH",2),u(this,"rules",void 0),u(this,"node",void 0),u(this,"availableAIs",void 0),u(this,"canPass",!1),u(this,"scores",g.empty()),u(this,"imagesLocation","assets/images/"),u(this,"hasAsymmetricBoard",!1),u(this,"rotation",""),u(this,"tutorial",void 0),u(this,"isPlayerTurn",void 0),u(this,"chooseMove",void 0),u(this,"canUserPlay",void 0),u(this,"cancelMoveOnWrapper",void 0),u(this,"pointOfView",k.ZERO),u(this,"isInteractive",!1),this.messageDisplayer=e}getPointOfView(){return this.pointOfView}setPointOfView(e){this.pointOfView=e,this.hasAsymmetricBoard&&(this.rotation="rotate("+180*e.value+")")}setInteractive(e){this.isInteractive=e}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.cancelMoveOnWrapper(e),t.node.previousMove.isPresent()&&(yield t.showLastMove(t.node.previousMove.get())),null==e?b.SUCCESS:(t.messageDisplayer.gameMessage(e),b.failure(e))})()}cancelMoveAttempt(){}pass(){var e=this;return M(function*(){return m2.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.parent.get().gameState}showLastMove(e){return M(function*(){})()}hideLastMove(){}getTranslation(e){return this.getTranslationXY(e.x,e.y)}getTranslationXY(e,t){return`translate(${e*this.SPACE_SIZE} ${t*this.SPACE_SIZE})`}},u(gu,"\u0275fac",function(e){return new(e||gu)(U($t))}),u(gu,"\u0275cmp",Be({type:gu,selectors:[["ng-component"]],features:[Ke],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),gu);jc=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],jc);let mu=(()=>{var r;class e extends jc{constructor(...n){super(...n),u(this,"hexaLayout",void 0),u(this,"hexaBoard",void 0)}getHexaPointsAtXY(n,i){const s=new v(n,i);return this.getHexaPointsAt(s)}getHexaPointsAt(n){return this.hexaLayout.getHexaPointsAt(n)}getCenterAtXY(n,i){const s=new v(n,i);return this.getCenterAt(s)}getCenterAt(n){return this.hexaLayout.getCenterAt(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",Be({type:r,selectors:[["ng-component"]],features:[Ke],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();var Bd,v2;class Me{static of(e){switch(e){case Me.ZERO.value:return Me.ZERO;case Me.ONE.value:return Me.ONE;case Me.EMPTY.value:return Me.EMPTY;case Me.UNREACHABLE.value:return Me.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===k.ZERO?Me.ZERO:(B.expectToBe(e,k.ONE),Me.ONE)}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===Me.ZERO||this===Me.ONE}}u(Me,"ZERO",new(Bd=Me)(k.ZERO.value)),u(Me,"ONE",new Bd(k.ONE.value)),u(Me,"EMPTY",new Bd(q.NONE.value)),u(Me,"UNREACHABLE",new Bd(3));class Ne extends zL{static getAngle(e){switch(e){case Ne.UP:return 0;case Ne.UP_RIGHT:return 60;case Ne.RIGHT:return 120;case Ne.DOWN:return 180;case Ne.DOWN_LEFT:return 240;default:return B.expectToBe(e,Ne.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return Ne.factory.from(-this.x,-this.y).get()}}u(Ne,"UP",new(v2=Ne)(0,-1)),u(Ne,"LEFT",new v2(-1,0)),u(Ne,"UP_RIGHT",new v2(1,-1)),u(Ne,"DOWN_LEFT",new v2(-1,1)),u(Ne,"RIGHT",new v2(1,0)),u(Ne,"DOWN",new v2(0,1)),u(Ne,"factory",new class extends DL{constructor(...r){super(...r),u(this,"all",[v2.UP,v2.UP_RIGHT,v2.RIGHT,v2.DOWN,v2.DOWN_LEFT,v2.LEFT])}}),u(Ne,"encoder",we.fromFunctions(r=>{switch(r){case v2.UP:return 0;case v2.UP_RIGHT:return 1;case v2.RIGHT:return 2;case v2.DOWN:return 3;case v2.DOWN_LEFT:return 4;default:return 5}},r=>(B.assert(0<=r&&r<=5,"Invalid encoded number for HexaDirection "+r),v2.factory.all[r])));class zae{constructor(){u(this,"startAngle",void 0),u(this,"conversionMatrix",void 0),u(this,"inverseConversionMatrix",void 0)}}class mC extends zae{constructor(){super(),u(this,"startAngle",.5),u(this,"conversionMatrix",[Math.sqrt(3),Math.sqrt(3)/2,0,1.5]),u(this,"inverseConversionMatrix",[Math.sqrt(3)/3,-1/3,0,2/3])}}u(mC,"INSTANCE",new mC);class qr extends zae{constructor(){super(),u(this,"startAngle",0),u(this,"conversionMatrix",[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)]),u(this,"inverseConversionMatrix",[2/3,0,-1/3,Math.sqrt(3)/3])}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}u(qr,"INSTANCE",new qr);class _u{constructor(e,t,n){u(this,"size",void 0),u(this,"origin",void 0),u(this,"orientation",void 0),this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new v(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new v(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),n=[];for(let i=0;i<6;i+=1){const s=this.getCornerOffset(i);n.push(new v(t.x+s.x,t.y+s.y))}return n}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(n=>n.toSVGPoint()).join(" ")}getIsoPoints(e,t){B.assert(this.orientation===qr.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),s=this.getCornerOffset(1),o=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new v(n.x+a.x,n.y+a.y),new v(n.x+a.x,n.y+a.y+t),new v(n.x+o.x,n.y+o.y+t),new v(n.x+o.x,n.y+o.y)],[new v(n.x+i.x,n.y+i.y),new v(n.x+i.x,n.y+i.y+t),new v(n.x+s.x,n.y+s.y+t),new v(n.x+o.x,n.y+o.y+t),new v(n.x+o.x,n.y+o.y),new v(n.x+s.x,n.y+s.y)],[new v(n.x+a.x,n.y+a.y),new v(n.x+a.x,n.y+a.y+t),new v(n.x+o.x,n.y+o.y+t),new v(n.x+s.x,n.y+s.y+t),new v(n.x+i.x,n.y+i.y+t),new v(n.x+i.x,n.y+i.y),new v(n.x+s.x,n.y+s.y),new v(n.x+o.x,n.y+o.y)]]}}let Dae,Ee=(()=>{class r{}return u(r,"MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT",()=>$localize`You have selected a piece of the opponent. You must pick one of your pieces.`),u(r,"MUST_CHOOSE_OWN_PIECE_NOT_EMPTY",()=>$localize`You have selected an empty space, you must select one of your own pieces.`),u(r,"MUST_CLICK_ON_EMPTY_SPACE",()=>$localize`You must click on an empty space.`),u(r,"MUST_CLICK_ON_EMPTY_SQUARE",()=>$localize`You must click on an empty square.`),u(r,"SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE",()=>$localize`Your landing space should be empty or contain a piece of the opponent.`),u(r,"CANNOT_SELF_CAPTURE",()=>$localize`You cannot capture your own pieces.`),u(r,"CANNOT_PASS",()=>$localize`You cannot pass your turn.`),u(r,"MUST_LAND_ON_EMPTY_SPACE",()=>$localize`You must drop your piece on an empty space.`),u(r,"MUST_PASS",()=>$localize`You must pass your turn.`),u(r,"MOVE_CANNOT_BE_STATIC",()=>$localize`You must choose different starting and ending coordinates.`),u(r,"SOMETHING_IN_THE_WAY",()=>$localize`There is a piece between the piece you chose and its landing space.`),u(r,"MUST_MOVE_ON_NEIGHBOR",()=>$localize`You must move on a direct neighboring space.`),r})(),kl=(()=>{class r{}return u(r,"CANNOT_MOVE_MORE_THAN_THREE_PIECES",()=>$localize`You cannot move more than 3 of your pieces!`),u(r,"NOT_ENOUGH_PIECE_TO_PUSH",()=>$localize`You don't have enough pieces to push that group!`),u(r,"CANNOT_PUSH_YOUR_OWN_PIECES",()=>$localize`You cannot push this piece because it is blocked by one of yours!`),u(r,"MUST_ONLY_TRANSLATE_YOUR_PIECES",()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`),u(r,"TRANSLATION_IMPOSSIBLE",()=>$localize`This move is impossible, some landing spaces are occupied.`),u(r,"LINE_AND_COORD_NOT_ALIGNED",()=>$localize`This space is not aligned with the current line.`),r})();Dae=Symbol.iterator;class L1 extends hC{constructor(e,t){super(t),u(this,"board",void 0),this.board=e}getHeight(){return this.board.length}getWidth(){return this.board[0].length}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?g.of(this.board[e.y][e.x]):g.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new v(e,t))}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new v(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return xt.copy(this.board)}toMap(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new v(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}[Dae](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class Es extends jn{static get(){return Es.singleton.isAbsent()&&(Es.singleton=g.of(new Es)),Es.singleton.get()}getInitialState(){const e=Me.EMPTY,t=Me.UNREACHABLE,n=Me.ZERO,i=Me.ONE;return new Va([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isLegalRealPush(e,t,n,i,s){let o=0;const a=Me.ofPlayer(n.getCurrentOpponent()),c=Me.ofPlayer(n.getCurrentPlayer());for(;o<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)o++,e=e.getNext(t.dir);return o>=i?Q.failure(kl.NOT_ENOUGH_PIECE_TO_PUSH()):Va.isOnBoard(e)&&(n.getPieceAt(e)===Me.EMPTY&&(s[e.y][e.x]=a),n.getPieceAt(e)===c)?Q.failure(kl.CANNOT_PUSH_YOUR_OWN_PIECES()):Q.success(s)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?_e.ZERO_WON:t[1]>5?_e.ONE_WON:_e.ONGOING}applyLegalMove(e,t,n){return new Va(n,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Me.ofPlayer(t.getCurrentOpponent())?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):b.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const s=Me.ofPlayer(t.getCurrentPlayer()),o=Me.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=o;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===s;)n++,i=i.getNext(e.dir);return n>3?Q.failure(kl.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Va.isOnBoard(i)||(a[i.y][i.x]=s,t.getPieceAt(i)===o)?Q.success(a):Es.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let s=e.coord;const o=Me.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===s.equals(n)&&Va.isOnBoard(s);){if(t.getPieceAt(s)!==o)return Q.failure(kl.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=s.getNext(e.dir);if(a[s.y][s.x]=Me.EMPTY,Va.isOnBoard(c)){if(t.isPiece(c))return Q.failure(kl.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===Me.EMPTY&&(a[c.y][c.x]=o)}s=s.getNext(i)}return Q.success(a)}getGameStatus(e){return Es.getGameStatus(e)}}u(Es,"singleton",g.empty());class Va extends L1{static isOnBoard(e){return e.isInRange(9,9)&&Es.get().getInitialState().getPieceAt(e)!==Me.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===Me.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Me.ONE&&(e[0]=e[0]-1);return e}}class Ar extends vi{static getFallibleEncoder(e){return we.tuple([v.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return we.tuple([v.encoder],t=>[t.coord],t=>e(t[0]))}constructor(e,t){super(),u(this,"coord",void 0),this.coord=new v(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}var Hae;class U2 extends Ar{static ofSingleCoord(e,t){return B.assert(e.isInRange(9,9),m4.OUT_OF_RANGE(e)),new U2(e,t,g.empty())}static ofDoubleCoord(e,t,n){const i=[e,t];qt.sortByDescending(i,U2.sortCoord);const s=i[1].getDirectionToward(i[0]).get(),o=Ne.factory.fromDelta(s.x,s.y);B.assert(o.isSuccess(),"Invalid direction");const a=o.get(),c=i[1].getDistance(i[0]);return B.assert(c<=2,"Distance between first coord and last coord is too big"),a.equals(n)?U2.ofSingleCoord(i[1],n):a.getOpposite().equals(n)?U2.ofSingleCoord(i[0],n):new U2(i[1],n,g.of(i[0]))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){super(e.x,e.y),u(this,"dir",void 0),u(this,"lastPiece",void 0),this.dir=t,this.lastPiece=n}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Hae=U2,u(U2,"encoder",we.tuple([v.encoder,Ne.encoder,g.getEncoder(v.encoder)],r=>[r.coord,r.dir,r.lastPiece],r=>new Hae(r[0],r[1],r[2])));const nn=Me.EMPTY,o2=Me.UNREACHABLE,Jo=Me.ZERO,vu=Me.ONE;class Vae extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Es.get().getInitialState()),j.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Es.get().getInitialState(),U2.ofSingleCoord(new v(2,6),Ne.UP),$localize`Congratulations!`),j.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Va([[o2,o2,o2,o2,nn,Jo,Jo,vu,vu],[o2,o2,o2,nn,nn,nn,nn,nn,nn],[o2,o2,nn,Jo,Jo,Jo,vu,Jo,nn],[o2,nn,nn,nn,nn,nn,nn,nn,nn],[nn,nn,nn,nn,Jo,Jo,Jo,vu,vu],[nn,nn,nn,nn,nn,nn,nn,nn,o2],[nn,nn,nn,nn,Jo,vu,nn,o2,o2],[nn,nn,nn,Jo,nn,nn,o2,o2,o2],[nn,nn,Jo,nn,nn,o2,o2,o2,o2]],0),[U2.ofSingleCoord(new v(4,4),Ne.RIGHT)],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)])}}class On{constructor(e,t,n){u(this,"name",void 0),u(this,"moveGenerator",void 0),u(this,"rules",void 0),u(this,"explorationParameter",Math.sqrt(2)),u(this,"maxGameLength",8),u(this,"availableOptions",[]),this.name=e,this.moveGenerator=t,this.rules=n;for(let i=1;i<10;i++)this.availableOptions.push({name:i*i+" seconds",maxSeconds:i*i})}chooseNextMove(e,t){B.assert(!1===this.rules.getGameStatus(e).isEndGame,"cannot search from a finished game");const n=e.gameState.getCurrentPlayer(),i=Date.now(),s=Date.now()+1e3*t.maxSeconds;let o=0;for(;Date.now()<s;){const f=this.expand(this.select({node:e,path:[e]})),d=this.simulate(f.node,s);this.backpropagate(f.path,this.winScore(d,n)),o++}Ae.display("MCTS","chooseNextMove","root winRatio: "+this.winRatio(e)),Ae.display("MCTS","chooseNextMove","children winRatio: "+e.getChildren().map(f=>f.id+": "+this.winRatio(f)));const a=qt.maximumsBy(e.getChildren(),f=>this.winRatio(f)),c=qt.getRandomElement(a),l=(Date.now()-i)/1e3;return Ae.display("MCTS","chooseNextMove",`Computed ${o} in ${l} (rate: ${o/l} it/s)`),Ae.display("MCTS","chooseNextMove","Best child has a win ratio of: "+this.winRatio(c)),c.previousMove.get()}winScore(e,t){switch(e){case _e.DRAW:case _e.ONGOING:return.5;default:return e.winner===t?1:0}}ucb(e,t){const n=this.simulations(e);return 0===t||0===n?Number.MAX_SAFE_INTEGER:this.wins(e)/n+this.explorationParameter*Math.sqrt(Math.log(t)/n)}winRatio(e){const t=this.simulations(e);return 0===this.simulations(e)?1:this.wins(e)/t}wins(e){return this.getCounterFromCache(e,"wins")}simulations(e){return this.getCounterFromCache(e,"simulations")}getCounterFromCache(e,t){const n=e.getCache(t);return n.isPresent()?n.get():(e.setCache(t,0),0)}select(e){const t=e.node;if(Ae.display("MCTS","select","Exploring node: "+t.id),t.hasChildren()){const n=this.simulations(t);Ae.display("MCTS","select","UCB values: "+t.getChildren().map(o=>o.id+": "+this.ucb(t,n)));const i=qt.maximumsBy(t.getChildren(),o=>this.ucb(o,n)),s=qt.getRandomElement(i);return Ae.display("MCTS","select","selecting children "+s.id),this.select({node:s,path:e.path.concat([s])})}return Ae.display("MCTS","select","this is a leaf node, we select it"),e}expand(e){if(this.rules.getGameStatus(e.node).isEndGame)return e;const t=e.node,n=this.moveGenerator.getListMoves(t);B.assert(n.length>0,`${this.name}: move generator did not return any move on a non-finished game: ${this.moveGenerator.constructor.name}`);for(const s of n)t.addChild(this.play(t,s));const i=qt.getRandomElement(t.getChildren());return{node:i,path:e.path.concat([i])}}simulate(e,t){Ae.display("MCTS","simulate","simulate from node which has a last move of "+e.previousMove.get().toString());let n=e,i=0;for(;i<this.maxGameLength&&Date.now()<t;){const s=this.rules.getGameStatus(n);if(s.isEndGame)return Ae.display("MCTS","simulate",`end game in ${i} steps, winner is ${s.winner}`),s;i++,n=this.playRandomStep(n)}return _e.ONGOING}playRandomStep(e){const t=qt.getRandomElement(this.moveGenerator.getListMoves(e));return this.play(e,t)}play(e,t){const n=this.rules.isLegal(t,e.gameState);B.assert(n.isSuccess(),"heuristic returned illegal move");const i=this.rules.applyLegalMove(t,e.gameState,n.get());return new Qo(i,g.of(e),g.of(t))}backpropagate(e,t){for(const n of e)this.addSimulationResult(n,t),Ae.display("MCTS","backpropagate","backpropagate to node which now has "+this.wins(n)/this.simulations(n))}addSimulationResult(e,t){const n=this.simulations(e)+1,i=this.wins(e)+t;e.setCache("wins",i),e.setCache("simulations",n)}getInfo(e){return`wins/simulations=${this.getCounterFromCache(e,"wins")}/${this.getCounterFromCache(e,"simulations")}`}}class Fa{}class tr extends Fa{getBoardValue(e){const t=this.getMetrics(e);return Jn.of(t[0],t[1])}}class VL extends tr{getMetrics(e){return[0,0]}}class cn{constructor(e,t,n,i){u(this,"name",void 0),u(this,"rules",void 0),u(this,"heuristic",void 0),u(this,"moveGenerator",void 0),u(this,"random",!1),u(this,"prune",!0),u(this,"availableOptions",[]),this.name=e,this.rules=t,this.heuristic=n,this.moveGenerator=i;for(let s=1;s<10;s++)this.availableOptions.push({name:`Level ${s}`,maxDepth:s})}toString(){return this.name}chooseNextMove(e,t){B.assert(!1===this.rules.getGameStatus(e).isEndGame,"Minimax has been asked to choose a move from a finished game");let n=this.alphaBeta(e,t.maxDepth,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);for(;n.gameState.turn>e.gameState.turn+1;)n=n.parent.get();return n.previousMove.get()}alphaBeta(e,t,n,i){if(t<1)return e;if(this.rules.getGameStatus(e).isEndGame)return e;const s=this.getPossibleMoves(e);B.assert(s.size()>0,"Minimax "+this.name+" should give move, received none!");const o=this.getBestChildren(e,s,t,n,i),a=this.getBestChildAmong(o),c=this.getScore(a);return this.setScore(e,c),a}getPossibleMoves(e){const t=this.getMoves(e);if(t.isAbsent()){const n=this.moveGenerator.getListMoves(e);return this.setMoves(e,new st(n)),new st(n)}return t.get()}getBestChildren(e,t,n,i,s){let o=[];const a=e.gameState.getCurrentPlayer();let c=a===k.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const l=a===k.ZERO?(f,d)=>f<d:(f,d)=>d<f;for(const f of t){const d=this.getOrCreateChild(e,f),m=this.alphaBeta(d,n-1,i,s),E=this.getScore(m).value;if(l(E,c)||0===o.length?(c=E,o=[m]):E===c&&o.push(m),this.prune&&l(c,a===k.ZERO?i:s))break;a===k.ZERO?s=Math.min(c,s):i=Math.max(c,i)}return o}getBestChildAmong(e){return this.random?qt.getRandomElement(e):e[0]}getOrCreateChild(e,t){const n=e.getChild(t);if(n.isAbsent()){const i=this.rules.isLegal(t,e.gameState),s=t.toString();B.assert(i.isSuccess(),'The minimax "'+this.name+'" has proposed an illegal move ('+s+"), refusal reason: "+i.getReasonOr("")+" this should not happen.");const o=this.rules.applyLegalMove(t,e.gameState,i.get()),a=new Qo(o,g.of(e),g.of(t));return e.addChild(a),this.setScore(a,this.computeBoardValue(a)),a}return n.get()}setScore(e,t){e.setCache(this.name+"-score",t)}getScore(e){const t=e.getCache(this.name+"-score");if(t.isPresent())return t.get();{const n=this.computeBoardValue(e);return this.setScore(e,n),n}}computeBoardValue(e){const t=this.rules.getGameStatus(e);return t.isEndGame?t.toBoardValue():this.heuristic.getBoardValue(e)}setMoves(e,t){e.setCache(this.name+"-moves",t)}getMoves(e){return e.getCache(this.name+"-moves")}getInfo(e){return"BoardValue="+this.heuristic.getBoardValue(e).value}}class pft extends tr{getMetrics(e){return e.gameState.getScores()}}class Fn{}let gft=(()=>{class r{}return u(r,"aiTime",0),r})();class Fae extends Fn{getListMoves(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(let s=0;s<9;s++)for(let o=0;o<9;o++){const a=new v(o,s);if(!1!==n.getPieceAt(a).is(i))for(const c of Ne.factory.all){const l=U2.ofSingleCoord(a,c);if(this.isAcceptablePush(l,n)){t.push(l);for(const f of Ne.factory.all)for(let d=1;d<=2&&!f.equals(c);d++){const m=a.getNext(f,d);if(!Va.isOnBoard(m))break;{const E=U2.ofDoubleCoord(a,m,c);Es.get().isLegal(E,n).isSuccess()&&t.push(E)}}}}}return new st(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=Es.get().isLegal(e,t);if(i.isSuccess()){const s=t.getCurrentOpponent().value;return!(new Va(i.get(),t.turn+1).getScores()[s]>n[s])}return!1}}function mft(r,e){if(1&r){const t=pe();A(),S(0,"circle",6),W("click",function(){ne(t);const i=p(2).index,s=p().index;return re(p().onPieceClick(i,s))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();ve("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("cx",i.getCenterAtXY(t,n).x)("cy",i.getCenterAtXY(t,n).y)("r",.5*i.SPACE_SIZE)}}function _ft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",4),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().onSpaceClick(i,s))}),P(),O(2,mft,1,6,"circle",5),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();_(1),ve("id","space_",n,"_",s,""),y("ngClass",o.getSquareClasses(n,s)),I("points",o.getHexaPointsAtXY(n,s)),_(1),y("ngIf",o.isPiece(i))}}function vft(r,e){if(1&r&&(A(),S(0,"g"),O(1,_ft,3,5,"g",3),P()),2&r){const t=e.$implicit,n=p(2);_(1),y("ngIf",n.isBoard(t))}}function Cft(r,e){if(1&r&&(A(),S(0,"g"),O(1,vft,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function yft(r,e){1&r&&(A(),S(0,"marker",7),V(1,"polygon",8),P()),2&r&&Dn("id","arrowhead_",e.$implicit.dir.toString(),"")}function Mft(r,e){if(1&r){const t=pe();A(),S(0,"g"),V(1,"line",9),S(2,"line",10),W("click",function(){const s=ne(t).$implicit;return re(p().chooseDirection(s.dir))}),P(),S(3,"polygon",11),W("click",function(){const s=ne(t).$implicit;return re(p().chooseDirection(s.dir))}),P()()}if(2&r){const t=e.$implicit;_(1),Dn("id","line_start_",t.dir.toString(),""),I("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),_(1),Dn("id","line_end_",t.dir.toString(),""),I("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),_(1),Dn("id","direction_",t.dir.toString(),""),I("transform",t.transformation)}}class Eft{constructor(e,t,n,i,s,o){u(this,"startCenter",void 0),u(this,"middle",void 0),u(this,"landingCenter",void 0),u(this,"landing",void 0),u(this,"dir",void 0),u(this,"transformation",void 0),this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=i,this.dir=s,this.transformation=o}}let Sft=(()=>{var r;class e extends mu{constructor(n){super(n),u(this,"moveds",[]),u(this,"directions",[]),u(this,"selecteds",[]),this.rules=Es.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Score`,this.rules,new pft,new Fae),new On($localize`MCTS`,new Fae,this.rules)],this.encoder=U2.encoder,this.tutorial=(new Vae).tutorial,this.scores=g.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new _u(this.SPACE_SIZE,new v(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),mC.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.hexaBoard=i.getState().getCopiedBoard(),i.scores=g.of(i.getState().getScores())})()}hideLastMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(n){var i=this;return M(function*(){n.isSingleCoord()?i.showPushingMove(n):i.showSideStepMove(n)})()}showPushingMove(n){const i=this.getPreviousState();let s=n.coord;for(this.moveds=[s],s=s.getNext(n.dir);Va.isOnBoard(s)&&i.isPiece(s);)this.moveds.push(s),s=s.getNext(n.dir);Va.isOnBoard(s)&&this.moveds.push(s)}showSideStepMove(n){let i=n.lastPiece.get();const s=n.coord.getDirectionToward(i).get();i=i.getNext(s);let o=n.coord;for(;!1===o.equals(i);)this.moveds.push(o),this.moveds.push(o.getNext(n.dir)),o=o.getNext(s)}onPieceClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#piece_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentOpponent();return s.hexaBoard[i][n].is(a)?s.opponentClick(n,i):0===s.selecteds.length?s.firstClick(n,i):1===s.selecteds.length?s.secondClick(n,i):s.thirdClick(n,i)})()}opponentClick(n,i){var s=this;return M(function*(){return(yield s.tryChoosingDirection(n,i)).isSuccess()?b.SUCCESS:s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}firstClick(n,i){var s=this;return M(function*(){return s.selecteds=[new v(n,i)],s.showPossibleDirections(),b.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(n){const i=this.getState(),s=Me.ofPlayer(i.getCurrentPlayer()),o=this.selecteds[0],a=this.selecteds[this.selecteds.length-1];for(const c of Ne.factory.all){let f,l=o.getNext(c,1);if(i.isOnBoard(l)&&i.getPieceAt(l)===s){if(n)continue;if(l=a.getNext(c,1),i.isOnBoard(l)&&i.getPieceAt(l)===s)continue}if(f=n?U2.ofSingleCoord(o,c):U2.ofDoubleCoord(o,a,c),this.rules.isLegal(f,i).isSuccess()){const m=this.getCenterAt(o),E=this.getCenterAt(l),w=this.getMiddleOfArrow(c,l,E),R=E.x+" "+E.y,$="rotate("+(Ne.getAngle(c)+150)+" "+R+")",Ce=new Eft(m,w,E,l,c,$+" translate("+R+")");this.directions.push(Ce)}}}getMiddleOfArrow(n,i,s){const o=i.getPrevious(n),a=this.getCenterAt(o);return new v(a.x+(s.x-a.x)/2,a.y+(s.y-a.y)/2)}isBoard(n){return n!==Me.UNREACHABLE}isPiece(n){return n!==Me.EMPTY}secondClick(n,i){var s=this;return M(function*(){const o=s.selecteds[0],a=new v(n,i);if(a.equals(o))return s.cancelMoveAttempt(),b.SUCCESS;if(!1===a.isHexagonallyAlignedWith(o))return s.cancelMoveAttempt(),s.firstClick(n,i);const c=a.getDistance(o);if(c>2)return s.cancelMove(kl.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const l=o.getDirectionToward(a).get();s.selecteds=[o];for(let f=0;f<c;f++)s.selecteds.push(o.getNext(l,f+1));if(3===s.selecteds.length){const f=s.selecteds[1],d=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[f.y][f.x].is(d))return s.cancelMoveAttempt(),s.firstClick(n,i)}return s.showPossibleDirections(),b.SUCCESS})()}thirdClick(n,i){var s=this;return M(function*(){const o=new v(n,i),a=s.selecteds[0];if(o.equals(a))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return o.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&o.equals(s.selecteds[1])?(s.cancelMoveAttempt(),b.SUCCESS):s.tryExtension(o,a,c)})()}tryExtension(n,i,s){var o=this;return M(function*(){const a=ye.factory.fromMove(i,n);if(a.isSuccess()){const l=ye.factory.fromMove(s,n);if(a.equals(l)){const f=i.getDistance(n),d=s.getDistance(n);return 2===Math.max(f,d)?(o.selecteds.push(n),qt.sortByDescending(o.selecteds,U2.sortCoord),o.showPossibleDirections(),b.SUCCESS):o.cancelMove(kl.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=yield o.cancelMove(kl.LINE_AND_COORD_NOT_ALIGNED());return yield o.firstClick(n.x,n.y),c})()}deselectExtremity(n){var i=this;return M(function*(){return i.selecteds=i.selecteds.slice(n?1:0,n?void 0:-1),i.showPossibleDirections(),b.SUCCESS})()}chooseDirection(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#direction_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):i._chooseDirection(n)})()}_chooseDirection(n){var i=this;return M(function*(){const s=i.selecteds[0];if(1===i.selecteds.length){const o=U2.ofSingleCoord(s,n);return i.chooseMove(o)}{const a=U2.ofDoubleCoord(s,i.selecteds[i.selecteds.length-1],n);return i.chooseMove(a)}})()}onSpaceClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#space_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.tryChoosingDirection(n,i)})()}tryChoosingDirection(n,i){var s=this;return M(function*(){const o=new v(n,i);for(const a of s.directions)if(a.landing.equals(o))return s._chooseDirection(a.dir);return b.failure("not a direction")})()}getSquareClasses(n,i){const s=new v(n,i),o=[];return this.moveds.some(a=>a.equals(s))&&o.push("moved-fill"),o}getPieceClasses(n,i){const s=new v(n,i),o=k.of(this.hexaBoard[i][n].value),a=[this.getPlayerClass(o)];return this.selecteds.some(c=>c.equals(s))&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-abalone"]],features:[Ke],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Cft,2,1,"g",1),S(2,"defs"),O(3,yft,2,1,"marker",2),P(),O(4,Mft,4,12,"g",1),P()),2&n&&(_(1),y("ngForOf",i.hexaBoard),_(2),y("ngForOf",i.directions),_(1),y("ngForOf",i.directions))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Pft extends tr{getMetrics(e){const t=e.gameState.board[3].getDominatingPlayer(),n=[0,0];return t.isPlayer()&&(n[t.value]=1),n}}class $ae extends Fn{getListMoves(e){const t=e.gameState;return Ao.ALL_MOVES.filter(function n(i){return Xs.get().isLegal(i,t).isSuccess()})}}function Oft(r,e){if(1&r&&(A(),V(0,"circle",5)),2&r){const t=e.$implicit,n=p();I("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Tft(r,e){if(1&r&&(A(),V(0,"circle",6)),2&r){const t=e.$implicit,n=p();I("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function bft(r,e){if(1&r){const t=pe();A(),S(0,"polygon",9),W("click",function(){ne(t);const i=p().index,s=p();return re(s.onArrowClick(i,s.PlayerOrNone.ZERO))}),P()}if(2&r){const t=p().index,n=p();Dn("id","dropArrow_zero_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),I("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function wft(r,e){if(1&r){const t=pe();A(),S(0,"polygon",9),W("click",function(){ne(t);const i=p().index,s=p();return re(s.onArrowClick(i,s.PlayerOrNone.ONE))}),P()}if(2&r){const t=p().index,n=p();Dn("id","dropArrow_one_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),I("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function Nft(r,e){if(1&r){const t=pe();A(),Gt(0),S(1,"circle",10),W("click",function(){ne(t);const i=p().index;return re(p().onSquareClick(i))}),P(),Ut()}if(2&r){const t=e.$implicit,n=p(),i=n.index,s=n.$implicit,o=p();_(1),zi("id","square_",i,"_piece_",t,"_out_of_",s.count(o.PlayerOrNone.NONE),""),y("ngClass",o.getPieceClasses(i,t,s)),I("cx",o.getCircleCenter(i,t,s).x)("cy",o.getCircleCenter(i,t,s).y)}}function Aft(r,e){if(1&r){const t=pe();A(),S(0,"g"),O(1,bft,1,4,"polygon",7),O(2,wft,1,4,"polygon",7),S(3,"rect",8),W("click",function(){const s=ne(t).index;return re(p().onSquareClick(s))}),P(),O(4,Nft,2,6,"ng-container",4),P()}if(2&r){const t=e.$implicit,n=e.index,i=p();I("transform",i.getBlockTransform(n)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),_(1),Dn("id","square_",n,""),y("ngClass",i.getSquareClasses(n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let Bae,Ift=(()=>{var r;class e extends jc{static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(n){super(n),u(this,"PlayerOrNone",q),u(this,"BOARD_WIDTH",4*this.SPACE_SIZE),u(this,"BOARD_HEIGHT",4.5*this.SPACE_SIZE),u(this,"board",void 0),u(this,"remainingZero",void 0),u(this,"remainingOne",void 0),u(this,"ARROW_COORD",e.getArrowCoord()),u(this,"PIECES_PER_PLAYER",Xs.PIECES_PER_PLAYER),u(this,"PIECE_RADIUS",void 0),u(this,"movedSquare",void 0),u(this,"selectedPiece",g.empty()),u(this,"leftPiece",g.empty()),u(this,"droppedPiece",g.empty()),u(this,"displayableArrow",[]),this.rules=Xs.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableAIs=[new cn($localize`Minimax`,this.rules,new Pft,new $ae),new On($localize`MCTS`,new $ae,this.rules)],this.encoder=Ao.encoder,this.tutorial=(new kae).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.showPossibleDrops()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.board,i.remainingZero=s.remaining.get(k.ZERO).get(),i.remainingOne=s.remaining.get(k.ONE).get(),i.hideLastMove(),i.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=g.empty(),this.leftPiece=g.empty(),this.selectedPiece=g.empty()}showLastMove(n){var i=this;return M(function*(){n.isDrop()?i.showLastDrop(n):i.showLastTransfer(n)})()}showLastDrop(n){const i=n.piece.get();let s=n.landing.x;this.movedSquare=[s],3!==n.landing.x&&(s+=1,this.movedSquare.push(s));const a=this.getLowestPlayerPiece(this.board[s],i);this.droppedPiece=g.of({square:s,piece:a})}getLowestPlayerPiece(n,i){const s=n.count(i);return i===k.ZERO?s-1:n.count(q.NONE)-s}showLastTransfer(n){const i=this.getPreviousState(),s=i.getCurrentPlayer(),o=n.starting.get().x,c=this.getLowestPlayerPiece(i.board[o],s);this.leftPiece=g.of({square:o,piece:c});const l=n.landing.x,d=this.getLowestPlayerPiece(this.board[l],s);this.droppedPiece=g.of({square:l,piece:d})}showPossibleDrops(){this.displayableArrow=[];const n=this.getState();for(let i=0;i<4;i++)!1===n.board[i].isFull()&&(n.remaining.get(k.ZERO).get()>0&&this.displayableArrow.push({x:i,player:k.ZERO}),n.remaining.get(k.ONE).get()>0&&this.displayableArrow.push({x:i,player:k.ONE}))}getCircleCenter(n,i,s){const o=this.SPACE_SIZE/2,a=this.SPACE_SIZE/2;if(1===s.count(q.NONE))return new v(o,a);const c=s.count(q.NONE),l=2*i*Math.PI/c-Math.PI/2,f=.3*this.SPACE_SIZE,d=f*Math.cos(l),m=f*Math.sin(l);return new v(o+d,a+m)}canDisplayArrow(n,i){return this.displayableArrow.some(s=>s.x===n&&s.player.equals(i))}getArrowClasses(n,i){return[this.getPlayerClass(i)]}getBlockTransform(n){return"translate("+n*this.SPACE_SIZE+", "+((3-n)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(n){const i=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===n?i.push("selected-stroke"):this.movedSquare.includes(n)&&i.push("last-move-stroke"),i}onArrowClick(n,i){var s=this;return M(function*(){const o=i===k.ZERO?"zero":"one",a=yield s.canUserPlay("#dropArrow_"+o+"_"+n);if(a.isFailure())return s.cancelMove(a.getReason());const c=tn.of(n);if(s.selectedPiece.isPresent()){const l=s.selectedPiece.get().square,f=Ao.transfer(tn.of(l),c).get();return s.chooseMove(f)}{const l=Ao.drop(c,i);return s.chooseMove(l)}})()}getPieceClasses(n,i,s){const o={square:n,piece:i},a=[];let c=s.count(k.ZERO),l=s.count(k.ONE);if(this.selectedPiece.equalsValue(o))a.push("selected-stroke");else if(this.droppedPiece.equalsValue(o))a.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===n){if(this.leftPiece.get().piece===i)return a.push("captured-stroke"),a;this.getState().getCurrentOpponent()===k.ZERO?c++:l++}const f=s.count(q.NONE)-(l+c),d=this.getPieceColor(i,c,f);return""!==d&&a.push(d),a}getPieceColor(n,i,s){return n<i?"player0-fill":n>=i+s?"player1-fill":""}onSquareClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#square_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.selectedPiece.isPresent()&&i.selectedPiece.get().square===n)return i.cancelMoveAttempt(),b.SUCCESS;const o=i.getState().getCurrentPlayer(),a=i.board[n];return a.count(o)<=0?i.cancelMove(pu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(i.selectedPiece=g.of({square:n,piece:i.getLowestPlayerPiece(a,o)}),0===i.showAndGetPossibleTranfers().length?i.cancelMove(pu.NO_POSSIBLE_TRANSFER_REMAINS()):b.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let n=this.selectedPiece.get().square-1;const i=this.getState().getCurrentPlayer();for(;0<=n;)!1===this.board[n].isFull()&&this.displayableArrow.push({x:n,player:i}),n--;return this.displayableArrow}getRemainingPieceCx(n){return(n+.5)*this.PIECE_RADIUS*1.5}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-apagos"]],features:[Ke],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),O(2,Oft,1,3,"circle",1),O(3,Tft,1,3,"circle",2),P(),S(4,"g",3),O(5,Aft,5,8,"g",4),P()()),2&n&&(I("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),_(1),I("transform","rotate("+180*i.getPointOfView().value+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingOne)),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingZero)),_(2),y("ngForOf",i.board))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),i1=(()=>{class r extends L1{constructor(t,n,i){super(t,n),u(this,"scores",void 0),this.scores=i}getScoresCopy(){return[this.scores[0],this.scores[1]]}equals(t){return!1!==xt.compare(this.board,t.board)&&!1!==qt.compare(this.scores,t.scores)&&this.turn===t.turn}getCurrentPlayerY(){return this.getCurrentOpponent().value}getOpponentY(){return this.getCurrentPlayer().value}}return u(r,"WIDTH",6),r})(),Cu=(()=>{class r{}return u(r,"MUST_DISTRIBUTE_YOUR_OWN_HOUSES",()=>$localize`You must distribute one of your houses.`),u(r,"MUST_CHOOSE_NON_EMPTY_HOUSE",()=>$localize`You should choose a non-empty house to distribute.`),u(r,"SHOULD_DISTRIBUTE",()=>$localize`You should feed but you do not.`),r})();class Ss extends jn{static isStarving(e,t){let n=0;const i=e.getOpponent().value;for(;n<i1.WIDTH;)if(t[i][n++]>0)return!1;return!0}constructor(e){super(),u(this,"config",void 0),this.config=e}getInitialState(){const e=xt.create(i1.WIDTH,2,4);return new i1(e,0,[0,0])}mustMansoon(e){const t=e.getCopiedBoard(),n=e.getCurrentOpponent(),i=e.getCurrentPlayer();if(this.config.mustFeed){if(Ss.isStarving(i,t)&&!1===this.canDistribute(n,t))return n}else{if(Ss.isStarving(n,t))return i;if(Ss.isStarving(i,t))return n}return q.NONE}getGameStatus(e){const t=e.gameState;return t.scores[0]>24?_e.ZERO_WON:t.scores[1]>24?_e.ONE_WON:24===t.scores[0]&&24===t.scores[1]?_e.DRAW:_e.ONGOING}applyLegalMove(e,t,n){const i=this.distributeMove(e,t),s=this.applyCapture(i);let o=s.resultingState;const a=this.mustMansoon(o);return a!==q.NONE&&(o=this.monsoon(a,s).resultingState),new i1(o.board,o.turn+1,o.scores)}distributeHouse(e,t,n){let i=new v(e,t);const s=n.getCopiedBoard(),o=n.getCurrentPlayer(),a=new v(e,t);let c=s[t][e];const l=[];s[t][e]=0;let f=0,d=!1,m=!1;for(;c>0;){d=m,m=!1;const E=this.getNextCoord(i,o,d);m=E.isAbsent(),m?(f++,c--,l.push(Ss.FAKE_STORE_COORD.get(o).get())):(i=E.get(),(!1===a.equals(i)||this.config.feedOriginalHouse)&&(s[i.y][i.x]+=1,l.push(i),c--))}return{filledCoords:l,passedByKalahNTimes:f,endsUpInKalah:m,resultingState:new i1(s,n.turn,n.getScoresCopy())}}getNextCoord(e,t,n){return 0===e.y?e.x===i1.WIDTH-1?this.config.passByPlayerStore&&t===k.ONE&&!1===n?g.empty():g.of(new v(e.x,1)):g.of(new v(e.x+1,e.y)):0===e.x?this.config.passByPlayerStore&&t===k.ZERO&&!1===n?g.empty():g.of(new v(e.x,0)):g.of(new v(e.x-1,e.y))}doesDistribute(e,t,n){return 0===t?n[t][e]>i1.WIDTH-1-e:n[t][e]>e}canDistribute(e,t){for(let n=0;n<i1.WIDTH;n++)if(this.doesDistribute(n,e.getOpponent().value,t))return!0;return!1}monsoon(e,t){const n=t.resultingState,i=n.getCopiedBoard(),s=n.getScoresCopy();let o=0;const a=xt.copy(t.captureMap);let c=0;const l=e.getOpponent().value;for(;c<i1.WIDTH;)o+=i[l][c],a[l][c]+=i[l][c],i[l][c]=0,c++;return s[e.value]+=o,{capturedSum:o,captureMap:a,resultingState:new i1(i,n.turn,s)}}}u(Ss,"FAKE_STORE_COORD",new du([{key:k.ZERO,value:new v(-1,-1)},{key:k.ONE,value:new v(2,2)}]));class ea extends Ss{static get(){return ea.singleton.isAbsent()&&(ea.singleton=g.of(new ea)),ea.singleton.get()}constructor(){super({passByPlayerStore:!1,mustFeed:!0,feedOriginalHouse:!1})}distributeMove(e,t){const n=t.getCurrentPlayerY();return this.distributeHouse(e.x,n,t)}applyCapture(e){const t=e.filledCoords,n=t[t.length-1];return this.captureIfLegal(n.x,n.y,e.resultingState)}isLegal(e,t){const n=t.getCurrentOpponent(),i=t.getCurrentPlayerY(),s=e.x;if(0===t.getPieceAtXY(s,i))return b.failure(Cu.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=Ss.isStarving(n,t.board),a=!1===this.doesDistribute(s,i,t.board);return o&&a?b.failure(Cu.SHOULD_DISTRIBUTE()):b.SUCCESS}capture(e,t,n){const i=n.getCurrentPlayerY();B.assert(t!==i,"AwaleRules.capture cannot capture the players house");const s=n.getCopiedBoard();let o=s[t][e],a=0;const c=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(o<2||o>3)return{capturedSum:0,captureMap:c,resultingState:n};let l=-1,f=-1;n.getCurrentPlayer()===k.ONE&&(l=1,f=i1.WIDTH);do{c[t][e]=o,a+=o,s[t][e]=0,o=s[t][e+=l]}while(e!==f&&(2===o||3===o));const d=n.getScoresCopy();return d[n.getCurrentPlayer().value]+=a,{capturedSum:a,captureMap:c,resultingState:new i1(s,n.turn,d)}}captureIfLegal(e,t,n){const i=n.getCurrentPlayer(),s={capturedSum:0,resultingState:n,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]};if(t===i.getOpponent().value)return s;{const o=this.capture(e,t,n),a=Ss.isStarving(i.getOpponent(),o.resultingState.board);return o.capturedSum>0&&a?s:o}}}var xl,Ll;u(ea,"singleton",g.empty());class p1{static of(e){switch(e){case 0:return p1.ZERO;case 1:return p1.ONE;case 2:return p1.TWO;case 3:return p1.THREE;case 4:return p1.FOUR;default:return B.expectToBe(e,5,"Invalid x for AwaleMove: "+e),p1.FIVE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}}xl=p1,u(p1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>xl.of(r[0]))),u(p1,"ZERO",new xl(0)),u(p1,"ONE",new xl(1)),u(p1,"TWO",new xl(2)),u(p1,"THREE",new xl(3)),u(p1,"FOUR",new xl(4)),u(p1,"FIVE",new xl(5)),Bae=Symbol.iterator;class Gae extends vi{constructor(e){super(),u(this,"distributions",void 0),this.distributions=e}[Bae](){return this.distributions.values()}}class _1 extends Gae{static of(e){switch(e){case 0:return _1.ZERO;case 1:return _1.ONE;case 2:return _1.TWO;case 3:return _1.THREE;case 4:return _1.FOUR;default:return B.expectToBe(e,5,"Invalid x for AwaleMove: "+e),_1.FIVE}}constructor(e){super([p1.of(e)]),u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}u(_1,"ZERO",new(Ll=_1)(0)),u(_1,"ONE",new Ll(1)),u(_1,"TWO",new Ll(2)),u(_1,"THREE",new Ll(3)),u(_1,"FOUR",new Ll(4)),u(_1,"FIVE",new Ll(5)),u(_1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>Ll.of(r[0])));class Uae{static sowing(e,t){return j.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,e,[t],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)}}class Wae extends qn{constructor(...e){super(...e),u(this,"gameName",$localize`Awalé`),u(this,"tutorial",[j.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,ea.get().getInitialState()),j.informational($localize`Awalé`,$localize`Bonus fact: Awalé is the most common of all Mancalas.`,ea.get().getInitialState()),Uae.sowing(ea.get().getInitialState(),_1.FIVE),j.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new i1([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),_1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),j.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new i1([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),j.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new i1([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),j.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new i1([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),j.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new i1([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[_1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),j.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new i1([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[_1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),j.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new i1([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),_1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),j.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new i1([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[23,10]),_1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)])}}class $a{static fromLimits(e,t,n,i){return new $a(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(f=>t.getHexaPointsListAt(f)),s=$a.getLimits(i);return new $a(s.minX-n/2,s.minY-n/2,n+s.maxX-s.minX,n+s.maxY-s.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;for(const o of e)i=Math.min(i,o.x),s=Math.min(s,o.y),t=Math.max(t,o.x),n=Math.max(n,o.y);return{minX:i,minY:s,maxX:t,maxY:n}}constructor(e,t,n,i){u(this,"left",void 0),u(this,"up",void 0),u(this,"width",void 0),u(this,"height",void 0),this.left=e,this.up=t,this.width=n,this.height=i}center(){return new v(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,n,i){return new $a(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),s=Math.max(this.bottom(),e.bottom());return $a.fromLimits(t,n,i,s)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class kft{static getArrowTransform(e,t){let n,i,s;switch(t){case Re.UP:n=1,i=0,s=-90;break;case Re.DOWN:n=1,i=2,s=90;break;case Re.LEFT:n=0,i=1,s=180;break;default:B.expectToBe(t,Re.RIGHT),n=2,i=1,s=0}return["scale("+e/300+")",`translate(${100*n} ${100*i})`,"rotate("+s+" 50 50)"].join(" ")}}let Ci=(()=>{var r;class e extends jc{constructor(...n){super(...n),u(this,"board",void 0)}getWidth(){return this.getState().getWidth()}getHeight(){return this.getState().getHeight()}getViewBox(){const n=this.getWidth()*this.SPACE_SIZE,i=this.getHeight()*this.SPACE_SIZE,s=.5*this.STROKE_WIDTH;return $a.fromLimits(0,n,0,i).expand(s,s,s,s)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",Be({type:r,selectors:[["ng-component"]],features:[Ke],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();function qae(r){return 1e3*r.seconds+r.nanoseconds/1e6}function jae(r,e){return qae(e)-qae(r)}class FL{static sleep(e){return M(function*(){return new Promise(t=>{window.setTimeout(t,e)})})()}}class xft extends tr{getMetrics(e){const t=e.gameState.getScoresCopy();return[t[0],t[1]]}}class Lft extends cn{constructor(e,t){super($localize`Score`,e,new xft,t)}}let Zae=(()=>{class r extends Ci{constructor(t,n){super(t),u(this,"cdr",void 0),u(this,"MGPOptional",g),u(this,"lastDistributedHouses",[]),u(this,"currentMove",g.empty()),u(this,"clickOngoing",!1),u(this,"captured",[[0,0,0,0,0,0],[0,0,0,0,0,0]]),u(this,"droppedInStore",[0,0]),u(this,"filledCoords",[]),u(this,"constructedState",void 0),u(this,"opponentMoveIsBeingAnimated",!1),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0])}showLastMove(t){var n=this;return M(function*(){n.droppedInStore=[0,0];const i=n.getPreviousState(),s=n.rules.distributeMove(t,i);n.filledCoords=s.filledCoords;let o=n.rules.applyCapture(s);n.captured=o.captureMap;const a=i.getCurrentPlayerY();n.lastDistributedHouses=t.distributions.map(l=>new v(l.x,a));const c=n.rules.mustMansoon(o.resultingState);c!==q.NONE&&(o=n.rules.monsoon(c,o),n.captured=o.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(t){var n=this;return M(function*(){const i=n.getState();if(t){n.opponentMoveIsBeingAnimated=!0,B.assert(n.node.parent.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.parent.get().gameState);let s=0;const o=n.node.previousMove.get();for(const a of o)yield n.showSimpleDistribution(a),s+1<o.distributions.length&&(yield FL.sleep(r.TIMEOUT_BETWEEN_DISTRIBUTION)),s++;n.opponentMoveIsBeingAnimated=!1}n.scores=g.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(t,n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+t+"_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(!0===i.clickOngoing)return b.SUCCESS;if(!0===i.opponentMoveIsBeingAnimated)return b.SUCCESS;{i.clickOngoing=!0;const o=yield i.onLegalClick(t,n);return i.clickOngoing=!1,o}})()}onLegalClick(t,n){var i=this;return M(function*(){return n===i.getState().getCurrentPlayer().value?i.cancelMove(Cu.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(t),0===i.constructedState.getPieceAtXY(t,n)?i.cancelMove(Cu.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(t))})()}continueMoveConstruction(t){var n=this;return M(function*(){const i=yield n.showSimpleDistribution(p1.of(t));if(i.endsUpInKalah){const s=n.constructedState.getCurrentPlayer();return Ss.isStarving(s,i.resultingState.board)?n.chooseMove(n.currentMove.get()):b.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(t){var n=this;return M(function*(){const i=n.constructedState,s=i.getCurrentPlayerY(),o=new v(t.x,s);return n.lastDistributedHouses.push(o),yield n.showSeedBySeed(o,i),n.rules.distributeHouse(t.x,s,i)})()}showSeedBySeed(t,n){var i=this;return M(function*(){const s=n.getCopiedBoard(),o=n.getCurrentPlayer(),a=t;let c=s[t.y][t.x],l=!1;const f=n.getScoresCopy();for(s[t.y][t.x]=0,i.changeVisibleState(new i1(s,n.turn,f)),yield FL.sleep(r.TIMEOUT_BETWEEN_SEED);c>0;){const d=i.rules.getNextCoord(t,o,l);l=d.isAbsent(),l?(c--,i.filledCoords.push(Ss.FAKE_STORE_COORD.get(o).get()),i.droppedInStore[o.value]+=1,f[o.value]+=1):(t=d.get(),(!1===a.equals(t)||i.rules.config.feedOriginalHouse)&&(s[t.y][t.x]+=1,i.filledCoords.push(t),c--)),i.changeVisibleState(new i1(s,n.turn,f)),yield FL.sleep(r.TIMEOUT_BETWEEN_SEED)}})()}hideLastMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=g.empty(),this.droppedInStore=[0,0],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(t,n){const i=new v(t,n),s=this.getSpaceOwner(i),o=this.getPlayerClass(s);return this.getStoreOwner(i).isAbsent()&&this.captured[n][t]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",o]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",o]:[o]}getStoreOwner(t){return Ss.FAKE_STORE_COORD.reverse().get(t)}getSpaceOwner(t){const n=this.getStoreOwner(t);return n.isPresent()?n.get().getAnyElement().get():k.of((t.y+1)%2)}getPieceCx(t){return 80+100*(t+1)}getPieceCy(t){return 60+120*t}getPieceTransform(t,n){return"translate("+this.getPieceCx(t)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.getPointOfView().value+")"}getHouseSecondaryContent(t,n){const i=this.getPreviousStableState().getPieceAtXY(t,n),o=this.constructedState.getPieceAtXY(t,n)-i;return this.captured[n][t]>0?g.of("-"+this.captured[n][t]):o>0?g.of("+"+o):o<0?g.of(""+o):g.empty()}getStoreContent(t){return this.scores.get()[t.value]+this.droppedInStore[t.value]}getStoreSecondaryContent(t){const n=this.getPreviousStableState().scores[t.value],s=this.constructedState.scores[t.value]-n;return s>0?g.of("+"+s):g.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(B.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.parent.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.parent.isPresent()?this.node.parent.get().gameState:this.getState()}onStoreClick(t){var n=this;return M(function*(){const i=yield n.canUserPlay("#store_player_"+t.value);return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(Cu.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(t){this.constructedState=t,this.board=this.constructedState.board,this.cdr.detectChanges()}createAIs(t){return[new Lft(this.rules,t),new On($localize`MCTS`,t,this.rules)]}}return u(r,"TIMEOUT_BETWEEN_SEED",200),u(r,"TIMEOUT_BETWEEN_DISTRIBUTION",1e3),r})();class Rft extends Zae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){this.currentMove=g.of(this.generateMove(e))}}class zft extends Fn{getListMoves(e){const t=[],n=e.gameState,s=(n.turn+1)%2;let o,a=0;for(;a<i1.WIDTH;)0!==n.getPieceAtXY(a,s)&&(o=_1.of(a),ea.get().isLegal(o,n).isSuccess()&&(o=_1.of(a),t.push(o))),a++;return t}}const Dft=["app-numbered-circle",""];function Hft(r,e){if(1&r&&(A(),S(0,"text",3),ct(1),P()),2&r){const t=p();ve("id","secondary_message_",t.x,"_",t.y,""),I("x",15)("y",31)("transform",t.rotation),_(1),x2(" ",t.secondaryContent.get()," ")}}let Yae=(()=>{var r;class e{constructor(){u(this,"x",void 0),u(this,"y",void 0),u(this,"spaceClasses",void 0),u(this,"content",void 0),u(this,"secondaryContent",void 0),u(this,"rotation",void 0)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Be({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:Dft,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(A(),V(0,"circle",0),S(1,"text",1),ct(2),P(),O(3,Hft,2,6,"text",2)),2&n&&(ve("id","circle_",i.x,"_",i.y,""),y("ngClass",i.spaceClasses),_(1),ve("id","number_",i.x,"_",i.y,""),I("x",0)("y",16)("transform",i.rotation),_(1),x2(" ",i.content," "),_(1),y("ngIf",i.secondaryContent.isPresent()))},dependencies:[Dt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function Vft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",8),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",s.getSpaceClasses(n,i))("rotation",s.getPieceRotation())("secondaryContent",s.getHouseSecondaryContent(n,i)),I("transform",s.getPieceTransform(n,i))}}function Fft(r,e){if(1&r&&(A(),S(0,"g"),O(1,Vft,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let $ft=(()=>{var r;class e extends Rft{constructor(n,i){super(n,i),this.rules=ea.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(new zft),this.encoder=_1.encoder,this.tutorial=(new Wae).tutorial}generateMove(n){return _1.of(n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t),U(R3))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-awale-component"]],features:[Ke],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),V(1,"rect",1),O(2,Fft,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(I("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,Yae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class qi extends vi{static getFallibleEncoder(e){return we.tuple([v.encoder,v.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return we.tuple([v.encoder,v.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),u(this,"first",void 0),u(this,"second",void 0),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}getCoords(){return[this.first,this.second]}}class Qs extends qi{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Ee.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return ye.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}getMovedOverCoords(){return this.getStart().getAllCoordsToward(this.getEnd())}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}toString(){return`${this.getStart().toString()} -> ${this.getEnd().toString()}`}}let _C=(()=>{class r{}return u(r,"LANDING_ON_OCCUPIED_SQUARE",()=>$localize`You cannot land on an occupied square.`),u(r,"THRONE_IS_LEFT_FOR_GOOD",()=>$localize`Once you left the central throne, you cannot return to it.`),u(r,"SOLDIERS_CANNOT_SIT_ON_THRONE",()=>$localize`Soldiers cannot sit on the throne.`),u(r,"MOVE_MUST_BE_ORTHOGONAL",()=>$localize`Tafl moves must be orthogonal.`),r})();class yu extends Qs{static isValidDirection(e,t){const n=e.getDirectionToward(t);return n.isFailure()||n.get().isDiagonal()?b.failure(_C.MOVE_MUST_BE_ORTHOGONAL()):b.SUCCESS}constructor(e,t){super(e,t);const n=this.getMaximalDistance();B.assert(e.isInRange(n,n),"Starting coord of TaflMove must be on the board, not at "+e.toString()+"."),B.assert(t.isInRange(n,n),"Landing coord of TaflMove must be on the board, not at "+t.toString()+".")}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Js extends yu{static from(e,t){const n=yu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new Js(e,t))}getMaximalDistance(){return 7}}u(Js,"encoder",qi.getFallibleEncoder(Js.from));const Bft={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:k.ZERO};var Gd,vC;class on{constructor(e,t){u(this,"owner",void 0),u(this,"king",void 0),this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}u(on,"UNOCCUPIED",new(Gd=on)(q.NONE,!1)),u(on,"PLAYER_ONE_KING",new Gd(q.ONE,!0)),u(on,"INVADERS",new Gd(q.ZERO,!1)),u(on,"DEFENDERS",new Gd(q.ONE,!1));class E1{constructor(e){u(this,"value",void 0),this.value=e}}u(E1,"NONE",new(vC=E1)("NONE")),u(E1,"OPPONENT",new vC("OPPONENT")),u(E1,"PLAYER",new vC("PLAYER"));class $L extends jn{constructor(e,t){super(),u(this,"config",void 0),u(this,"generateMove",void 0),this.config=e,this.generateMove=t}isLegal(e,t){const n=t.getCurrentPlayer(),i=this.getMoveValidity(n,e,t);return i.isFailure()?b.failure(i.getReason()):b.SUCCESS}getMoveValidity(e,t,n){const i=n.getRelativeOwner(e,t.getStart());if(i===E1.NONE)return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===E1.OPPONENT)return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(n.getRelativeOwner(e,t.getEnd())!==E1.NONE)return b.failure(_C.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.getEnd())){if(!n.getPieceAt(t.getStart()).isKing())return b.failure(_C.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return b.failure(_C.THRONE_IS_LEFT_FOR_GOOD())}const o=t.getStart().getDirectionToward(t.getEnd()).get(),a=t.getStart().getOrthogonalDistance(t.getEnd());let c=t.getStart().getNext(o);for(let l=1;l<a;l++){if(n.getPieceAt(c)!==on.UNOCCUPIED)return b.failure(Ee.SOMETHING_IN_THE_WAY());c=c.getNext(o)}return b.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,i){const s=t.getNext(n);return s.isNotInRange(this.config.WIDTH,this.config.WIDTH)||i.getRelativeOwner(e,s)!==E1.OPPONENT?g.empty():i.getPieceAt(s).isKing()?this.captureKing(e,t,n,i):this.capturePawn(e,t,n,i)}captureKing(e,t,n,i){const s=t.getNext(n),{backCoord:o,back:a,backInRange:c,left:l,leftCoord:f,right:d,rightCoord:m}=this.getSurroundings(s,n,e,i);return!1===c?this.captureKingAgainstTheWall(l,d,s):a===E1.NONE&&this.isThrone(i,o)?this.captureKingAgainstThrone(o,s,l,d):a===E1.PLAYER?this.captureKingWithAtLeastASandwich(i,s,l,f,d,m):g.empty()}getSurroundings(e,t,n,i){const s=e.getNext(t),o=s.isInRange(this.config.WIDTH,this.config.WIDTH),a=o?i.getRelativeOwner(n,s):E1.NONE,c=e.getLeft(t),f=c.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,c):E1.NONE,d=e.getRight(t),E=d.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,d):E1.NONE;return{backCoord:s,back:a,backInRange:o,leftCoord:c,left:f,rightCoord:d,right:E}}captureKingAgainstTheWall(e,t,n){let i=e===E1.PLAYER?1:0;return i+=t===E1.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?g.of(n):g.empty()}captureKingAgainstThrone(e,t,n,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t)}else if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&(n===E1.PLAYER||i===E1.PLAYER))return g.of(t);return g.empty()}capturePawn(e,t,n,i){const s=t.getNext(n),o=s.getNext(n);let a=E1.NONE;return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&(a=i.getRelativeOwner(e,o)),a===E1.NONE?!1===this.isThrone(i,o)?(Ae.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")cannot capture a pawn without an ally behind"),g.empty()):(Ae.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):a===E1.PLAYER?(Ae.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):(Ae.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.empty())}captureKingWithAtLeastASandwich(e,t,n,i,s,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,c=this.isThrone(e,i),l=n===E1.PLAYER||c&&a,f=this.isThrone(e,o);return l&&(s===E1.PLAYER||f&&a)?g.of(t):g.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(e,t,n){const i=t.turn,s=t.getCopiedBoard(),o=t.getCurrentPlayer(),a=e.getStart(),c=e.getEnd();s[c.y][c.x]=s[a.y][a.x],s[a.y][a.x]=on.UNOCCUPIED;for(const l of Re.ORTHOGONALS){const f=this.tryCapture(o,e.getEnd(),l,t);f.isPresent()&&(s[f.get().y][f.get().x]=on.UNOCCUPIED)}return t.of(s,i+1)}getGameStatus(e){const n=this.getWinner(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return Ae.display("TaflRules","getWinner","The king is dead, victory to invader"),g.of(this.getInvader());const n=t.get();return this.isExternalThrone(n)?(Ae.display("TaflRules","getWinner","The king escape, victory to defender"),g.of(this.getDefender())):this.isPlayerImmobilized(k.ZERO,e)?(Ae.display("TaflRules","getWinner","Zero has no move, victory to one"),g.of(k.ONE)):this.isPlayerImmobilized(k.ONE,e)?(Ae.display("TaflRules","getWinner","One has no move, victory to zero"),g.of(k.ZERO)):(Ae.display("TaflRules","getWinner","no victory"),g.empty())}getKingCoord(e){for(let t=0;t<this.config.WIDTH;t++)for(let n=0;n<this.config.WIDTH;n++)if(e.getPieceAtXY(n,t).isKing())return g.of(new v(n,t));return g.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(e,t){const n=[],i=this.getPlayerListPawns(e,t);for(const s of i){const o=this.getPossibleDestinations(s,t);for(const a of o){const c=this.generateMove(s,a).get();n.push(c)}}return n}getPlayerListPawns(e,t){const n=[];for(let i=0;i<this.config.WIDTH;i++)for(let s=0;s<this.config.WIDTH;s++){const o=new v(s,i);t.getAbsoluteOwner(o)===e&&n.push(o)}return n}getPossibleDestinations(e,t){const n=[];let i;for(const s of Re.ORTHOGONALS){i=e.getNext(s,1);let o=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===o;)t.getAbsoluteOwner(i)===q.NONE?this.isExternalThrone(i)?t.getPieceAt(e).isKing()&&n.push(i):t.isCentralThrone(i)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(i):n.push(i):o=!0,i=i.getNext(s,1)}return n}}class W2 extends L1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new v(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===q.NONE?E1.NONE:e===n?E1.PLAYER:E1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}of(e,t){return new W2(e,t)}}class Zc extends $L{static get(){return Zc.singleton.isAbsent()&&(Zc.singleton=g.of(new Zc)),Zc.singleton.get()}constructor(){super(Bft,Js.from)}getInitialState(){const e=on.UNOCCUPIED,t=on.INVADERS,n=on.DEFENDERS;return new W2([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,on.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}u(Zc,"singleton",g.empty());let Qae,L0=class extends Fn{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=this.rules.getPlayerListMoves(n,t);return this.orderMoves(t,i)}orderMoves(e,t){const n=this.rules.getKingCoord(e).get();return e.getCurrentPlayer()===this.rules.config.INVADER?qt.sortByDescending(t,i=>-i.getEnd().getOrthogonalDistance(n)):qt.sortByDescending(t,i=>i.getStart().equals(n)?this.rules.isExternalThrone(i.getEnd())?2:1:0),t}};L0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],L0);class CC{constructor(e,t){u(this,"directThreats",void 0),u(this,"mover",void 0),this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class Xae extends CC{constructor(e,t){super(new st([e]),t),u(this,"directThreat",void 0),this.directThreat=e}}Qae=Symbol.iterator;class Uft extends st{constructor(e){if(super(),u(this,"valueMap",void 0),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0])void 0===n[s]&&(n[s]=[]),n=n[s];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0]){if(void 0===n[s])return!1;n=n[s]}return void 0!==n[t[1]]}[Qae](){return this.values.values()}}class W1 extends Uft{toFields(e){return[[e.y],e.x]}}class Jae extends tr{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getMetrics(e){const t=e.gameState,n=this.rules.getPlayerListPawns(k.ZERO,t).length,i=this.rules.getPlayerListPawns(k.ONE,t).length;return[n*[1,2][this.rules.config.INVADER.value],i*[2,1][this.rules.config.INVADER.value]]}}class ece extends Jae{constructor(e){super(e),u(this,"width",void 0),u(this,"maxInfluence",void 0),u(this,"scoreByThreatenedPiece",void 0),u(this,"scoreBySafePiece",void 0),this.width=this.rules.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.rules.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=on.UNOCCUPIED;let s=0;const o=this.getPiecesMap(n),a=this.getThreatMap(n,o),c=this.filterThreatMap(a,n);for(const l of k.PLAYERS)for(const f of o.get(l).get())if(c.get(f).isPresent())s+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{s+=l.getScoreModifier()*this.scoreBySafePiece;let d=0;for(const m of Re.ORTHOGONALS){let E=f.getNext(m,1);for(;E.isInRange(this.width,this.width)&&n.getPieceAt(E)===i;)d++,E=E.getNext(m,1)}s+=d*l.getScoreModifier()}return new Jn(s)}getPiecesMap(e){const t=on.UNOCCUPIED,n=[],i=[];for(let o=0;o<this.width;o++)for(let a=0;a<this.width;a++){const c=new v(a,o);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===k.ZERO?n.push(c):i.push(c))}return new Pn([{key:k.ZERO,value:new W1(n)},{key:k.ONE,value:new W1(i)}])}getThreatMap(e,t){const n=new Pn;for(const i of k.PLAYERS)for(const s of t.get(i).get()){const o=this.getThreats(s,e);this.isThreatReal(s,e,o)&&n.set(s,new st(o))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);je(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),s=[];for(const o of Re.ORTHOGONALS){const a=e.getPrevious(o,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of Re.ORTHOGONALS){if(l===o.getOpposite())continue;let f=e.getNext(o,1);for(;f.isInRange(this.width,this.width)&&t.getPieceAt(f)===on.UNOCCUPIED;)f=f.getNext(l);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===i&&!1===e.getNext(o,1).equals(f)&&c.push(f)}s.push(new Xae(a,new W1(c)))}}return s}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.rules.isThrone(t,e)||n!==k.ONE&&t.getPieceAt(e)!==on.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new Pn,i=e.listKeys(),s=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),o=new W1(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of s){const c=e.get(a).get(),l=[];for(const f of c)if(!1===o.contains(f.directThreat)){const d=[];for(const m of f.mover)!1===o.contains(m)&&d.push(m);d.length>0&&l.push(new Xae(f.directThreat,new W1(d)))}l.length>0&&n.set(a,new st(l))}for(const a of o){const c=e.get(a).get();n.set(a,c)}return n}}class Wft extends cn{constructor(e){super($localize`Pieces > Influence`,e,new ece(e),new L0(e))}}class qft extends cn{constructor(e){super($localize`Pieces`,e,new Jae(e),new L0(e))}}class tce extends ece{getBoardValue(e){const t=e.gameState,n=this.getControlScoreAndPieceScores(t);let i=n.controlScore;i+=n.safeScore*this.getScoreBySafePiece(t);const s=this.getScoreByThreatenedPiece(t);return i+=n.threatenedScore*s,je(n.controlScore<=s,"Control Score should be below "+s+", got "+n.controlScore),je(n.threatenedScore<=16,"Threatened Score should be below 16, got "+n.threatenedScore),je(n.safeScore<=16,"Safe Score should be below 16, got "+n.threatenedScore),new Jn(i)}getControlScoreAndPieceScores(e){const t=this.getPiecesMap(e),n=this.getThreatMap(e,t),i=this.filterThreatMap(n,e),s={safeScore:0,threatenedScore:0,controlScore:0};for(const o of k.PLAYERS){const a=new W1;for(const c of t.get(o).get())if(i.get(c).isPresent())s.threatenedScore+=o.getScoreModifier();else{s.safeScore+=o.getScoreModifier();for(const l of Re.ORTHOGONALS){let f=c.getNext(l,1);for(;f.isInRange(this.width,this.width)&&e.getPieceAt(f)===on.UNOCCUPIED;)a.add(f),f=f.getNext(l,1)}}for(const c of a){const l=this.getControlledPieceValue(c.x,c.y,this.width);s.controlScore+=o.getScoreModifier()*l}}return s}getControlledPieceValue(e,t,n){let i=1;return(0===e||e===n-1)&&(i*=n),(0===t||t===n-1)&&(i*=n),i}getScoreByThreatenedPiece(e){const t=e.getWidth(),n=t-2;return 4*t*t+4*n*t+n*n}getScoreBySafePiece(e){return 16*this.getScoreByThreatenedPiece(e)+1}}class jft extends cn{constructor(e){super($localize`Pieces > Control`,e,new tce(e),new L0(e))}}class Zft extends tce{getBoardValue(e){const t=e.gameState,n=this.getControlScoreAndPieceScores(t),i=t.getPieceAt(this.rules.getKingCoord(t).get()).getOwner(),s=this.getStepForEscape(t)*i.getScoreModifier();if(-1===s)return new Jn(i.getOpponent().getPreVictory());const o=this.getScoreByThreatenedPiece(t);return B.assert(n.controlScore<=o,"Control Score should be below "+o+", got "+n.controlScore),B.assert(n.threatenedScore<=16,"Threatened Score should be below 16, got "+n.threatenedScore),B.assert(n.safeScore<=16,"Safe Score should be below 16, got "+n.threatenedScore),new Jn(-1*s*(o+1)*17*17+n.safeScore*(o+1)*17+n.threatenedScore*(o+1)+n.controlScore)}getStepForEscape(e){const t=this.rules.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const s=this.getNextGen(e,n,i);return 0===s.length?g.empty():s.some(o=>this.rules.isExternalThrone(o))?g.of(t):(t++,i.push(...s),this._getStepForEscape(e,t,s,i))}getNextGen(e,t,n){const i=[];for(const s of t)for(const o of Re.ORTHOGONALS){let a=s.getNext(o,1);for(;a.isInRange(this.width,this.width)&&e.getPieceAt(a)===on.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(o,1)}return i}}class Yft extends cn{constructor(e){super($localize`Escape > Pieces > Control`,e,new Zft(e),new L0(e))}}class BL extends Ci{constructor(e,t){super(e),u(this,"generateMove",void 0),u(this,"viewInfo",{pieceClasses:[]}),u(this,"EMPTY",on.UNOCCUPIED),u(this,"capturedCoords",[]),u(this,"passedByCoords",[]),u(this,"chosen",g.empty()),this.generateMove=t}updateBoard(e){var t=this;return M(function*(){t.board=t.getState().getCopiedBoard(),t.capturedCoords=[],t.updateViewInfo()})()}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState(),i=t.getState().getCurrentOpponent();for(const s of Re.ORTHOGONALS){const o=e.getEnd().getNext(s,1);if(o.isInRange(t.rules.config.WIDTH,t.rules.config.WIDTH)){const c=n.getRelativeOwner(i,o)===E1.OPPONENT,f=t.getState().getPieceAt(o)===on.UNOCCUPIED;c&&f&&t.capturedCoords.push(o)}}t.passedByCoords=t.node.previousMove.get().getMovedOverCoords()})()}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.board.length;t++){const n=[];for(let i=0;i<this.board[0].length;i++){let s=[];s=this.board[t][i].getOwner()===q.NONE?[""]:this.getPieceClasses(i,t),n.push(s)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new v(e,t);return n.chosen.equalsValue(s)?(n.cancelMoveAttempt(),b.SUCCESS):n.chosen.isAbsent()||n.pieceBelongsToCurrentPlayer(s)?n.choosePiece(s):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return M(function*(){const i=n.chosen.get(),s=new v(e,t),o=n.generateMove(i,s);return o.isSuccess()?yield n.chooseMove(o.get()):n.cancelMove(o.getReason())})()}choosePiece(e){var t=this;return M(function*(){return t.board[e.y][e.x]===on.UNOCCUPIED?t.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):!1===t.pieceBelongsToCurrentPlayer(e)?t.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(t.chosen=g.of(e),t.updateViewInfo(),b.SUCCESS)})()}pieceBelongsToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===E1.PLAYER}cancelMoveAttempt(){this.chosen=g.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new v(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new v(e,t))}getPieceClasses(e,t){const n=[],i=new v(e,t),s=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(s)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new v(e,t);return this.capturedCoords.some(s=>s.equals(i))?n.push("captured-fill"):this.node.previousMove.isPresent()&&this.passedByCoords.some(s=>s.equals(i))&&n.push("moved-fill"),n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new v(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.isInteractive&&this.pieceBelongsToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===on.INVADERS}isKing(e,t){return this.board[t][e].isKing()}createAIs(){const e=new L0(this.rules);return[new qft(this.rules),new Wft(this.rules),new jft(this.rules),new Yft(this.rules),new On($localize`MCTS`,e,this.rules)]}}const Z=on.UNOCCUPIED,g1=on.INVADERS,eo=on.DEFENDERS,Ud=on.PLAYER_ONE_KING;class nce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Zc.get().getInitialState()),j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Zc.get().getInitialState(),Js.from(new v(3,1),new v(1,1)).get(),$localize`Congratulations!`),j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new W2([[Z,Z,Z,g1,Z,Z,Z],[Z,Z,Z,g1,Z,Z,Z],[g1,Z,Z,eo,Z,Z,Z],[Z,Z,eo,Ud,eo,g1,g1],[Z,Z,g1,Z,Z,Z,Z],[Z,Z,Z,eo,Z,g1,Z],[Z,Z,Z,g1,Z,Z,Z]],1),[Js.from(new v(3,5),new v(2,5)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new W2([[Z,Z,Z,g1,Z,Z,Z],[Z,Z,g1,Z,Z,Z,Z],[Z,Z,Z,eo,Z,Z,Z],[g1,eo,Z,Z,eo,g1,g1],[Z,eo,Z,Z,Z,Z,Z],[Z,g1,Z,Ud,Z,g1,Z],[Z,Z,Z,g1,Z,Z,Z]],12),[Js.from(new v(2,1),new v(3,1)).get(),Js.from(new v(3,0),new v(3,1)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),j.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new W2([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,eo,Z,Z,Z],[Z,Z,Z,g1,Z,Z,Z],[Z,g1,Z,Ud,g1,Z,Z],[Z,Z,Z,g1,Z,Z,Z],[Z,eo,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],72),[Js.from(new v(1,3),new v(2,3)).get()],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),j.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new W2([[Z,Z,g1,Z,Z,Z,Z],[Z,Z,Z,g1,Z,Z,Z],[Z,Z,Z,Ud,g1,Z,Z],[Z,g1,eo,Z,eo,Z,Z],[Z,Z,Z,g1,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],72),[Js.from(new v(2,0),new v(2,2)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),j.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new W2([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,g1,Z,g1,Z,Z,Z],[g1,Z,Z,Z,eo,Z,Z],[Z,Z,Z,eo,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Ud,Z,g1,Z,Z,Z]],72),[Js.from(new v(3,6),new v(2,6)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function Kft(r,e){1&r&&(A(),V(0,"polygon",8))}function Xft(r,e){1&r&&(A(),V(0,"rect",9))}function Qft(r,e){if(1&r&&(A(),S(0,"g"),O(1,Kft,1,0,"polygon",6),O(2,Xft,1,0,"ng-template",null,7,dn),P()),2&r){const t=un(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function Jft(r,e){if(1&r&&(A(),S(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function e9t(r,e){if(1&r&&(A(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function t9t(r,e){if(1&r&&(A(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function n9t(r,e){if(1&r&&(A(),O(0,e9t,1,1,"polyline",14),O(1,t9t,4,20,"ng-template",null,15,dn)),2&r){const t=un(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function r9t(r,e){if(1&r&&(A(),S(0,"g"),V(1,"circle",10),O(2,Jft,6,25,"g",11),O(3,n9t,3,2,"ng-template",null,12,dn),P()),2&r){const t=un(4),n=p().index,i=p().index,s=p();_(1),ve("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function i9t(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(1,"rect",4),O(2,Qft,4,2,"g",5),O(3,r9t,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ve("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ve("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function s9t(r,e){if(1&r&&(A(),S(0,"g"),O(1,i9t,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function o9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ve("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let a9t=(()=>{var r;class e extends BL{constructor(n){super(n,Js.from),this.rules=Zc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=Js.encoder,this.tutorial=(new nce).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-brandhub"]],features:[Ke],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,s9t,2,1,"g",1),O(2,o9t,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),yi=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();var GL;class Ba extends Ar{static of(e){return B.assert(yi.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),new Ba(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}u(Ba,"encoder",Ar.getEncoder(Ba.of));class Ga extends qi{static of(e,t){return B.assert(yi.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),B.assert(yi.isOnBoard(t),"SECOND_COORD_IS_OUT_OF_RANGE"),B.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new Ga(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),s=e.getSecond();return!(!t.equals(n)||!i.equals(s))||!(!t.equals(s)||!i.equals(n))}}u(Ga,"encoder",qi.getEncoder(Ga.of)),function(r){r.isFirstMove=function e(n){return n instanceof Ba},r.isDrop=function t(n){return n instanceof Ga},r.encoder=we.disjunction([r.isFirstMove,r.isDrop],[Ba.encoder,Ga.encoder])}(GL||(GL={}));class Mu{constructor(e,t,n){u(this,"isInRange",void 0),u(this,"getOwner",void 0),u(this,"N",void 0),this.isInRange=e,this.getOwner=t,this.N=n}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const s=n.coord;if(this.getOwner(n.content,e).isPlayer()){const o=this.getSquareScore(e,s);if(Jn.VICTORIES.some(a=>a===o))return new Jn(o);t+=o}}return new Jn(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);je(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const s=new Pn,o=new Pn;for(const c of ye.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);s.set(c,l[0]),o.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,s)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[ye.UP,ye.UP_RIGHT,ye.RIGHT,ye.DOWN_RIGHT]){const s=e.get(i).get(),o=e.get(i.getOpposite()).get();if(this.N<=s+o+1)return Number.MAX_SAFE_INTEGER;const f=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=f+1&&(n+=2+f-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let s=0,o=0,a=!0,c=new v(t.x+n.x,t.y+n.y),l=1;const f=i.getOpponent();for(;this.isInRange(c)&&l<this.N;){const d=e.getPieceAt(c);if(this.getOwner(d,e)===f)return[s,o];this.getOwner(d,e)===i&&a?o++:a=!1,d!==f&&d!==i&&s++,c=c.getNext(n),l++}return[s,o]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,s=this.getSquareScore(e,i);Jn.isVictory(s)&&(s===k.ZERO.getVictoryValue()||s===k.ONE.getVictoryValue())&&t.push(i)}return t}}class ji extends jn{static get(){return ji.singleton.isAbsent()&&(ji.singleton=g.of(new ji)),ji.singleton.get()}static getVictoriousCoords(e){return ji.CONNECT_SIX_HELPER.getVictoriousCoord(e)}getInitialState(){const e=xt.create(yi.WIDTH,yi.HEIGHT,q.NONE);return new yi(e,0)}applyLegalMove(e,t,n){return e instanceof Ga?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),s=e.getSecond(),o=t.getCopiedBoard();return o[i.y][i.x]=n,o[s.y][s.x]=n,new yi(o,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new yi(i,t.turn+1)}isLegal(e,t){return 0===t.turn?(B.assert(e instanceof Ba,"First move should be instance of ConnectSixFirstMove"),b.SUCCESS):(B.assert(e instanceof Ga,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?b.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return ji.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):181===t.turn?_e.DRAW:_e.ONGOING}}u(ji,"singleton",g.empty()),u(ji,"CONNECT_SIX_HELPER",new Mu(yi.isOnBoard,B.identity,6));const L=q.NONE,Mi=q.ZERO,q2=q.ONE;class sce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,ji.get().getInitialState()),j.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,ji.get().getInitialState(),Ba.of(new v(9,9)),$localize`Congratulations!`),j.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new yi([[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,q2,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,Mi,L,q2,Mi,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,Mi,Mi,L,L,q2,L,L,L,L,L,L],[L,L,L,L,L,L,L,q2,Mi,Mi,Mi,Mi,q2,L,L,L,L,L,L],[L,L,L,L,L,L,q2,Mi,Mi,Mi,Mi,q2,L,L,L,L,L,L,L],[L,L,L,L,L,L,q2,L,q2,Mi,q2,q2,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,Mi,q2,Mi,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,q2,L,q2,L,Mi,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,q2,q2,L,q2,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,q2,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,Mi,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L]],20),Ga.of(new v(4,11),new v(5,10)),$localize`Congratulations!`)])}}let UL=(()=>{var r;class e extends Ci{constructor(...n){super(...n),u(this,"hoshis",[])}createHoshis(){const n=this.board.length,i=Math.floor(n/2),s=n<12?2:3,o=n-(s+1);18<n&&this.hoshis.push(new v(s,i),new v(i,s),new v(i,o),new v(o,i)),this.hoshis.push(new v(i,i),new v(s,s),new v(s,o),new v(o,s),new v(o,o))}isHoshi(n,i){return this.hoshis.some(s=>s.x===n&&s.y===i)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",Be({type:r,selectors:[["ng-component"]],features:[Ke],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class oce extends Fn{getListMoves(e){return 0===e.gameState.turn?this.getFirstMove():this.getListDrops(e)}getFirstMove(){const t=yi.HEIGHT,n=Math.floor(yi.WIDTH/2),i=Math.floor(t/2);return[Ba.of(new v(n,i))]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const s=e.gameState.getCopiedBoard();s[i.y][i.x]=e.gameState.getCurrentPlayer();const o=new yi(s,e.gameState.turn),a=this.getAvailableCoords(o);for(const c of a){const l=Ga.of(i,c);n.push(l)}}return new st(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const s=i.coord;!0===t[s.y][s.x]&&!1===i.content.isPlayer()&&n.push(s)}return n}getUsefulCoordsMap(e){const t=xt.create(yi.WIDTH,yi.HEIGHT,!1);for(const n of e.getCoordsAndContents())n.content.isPlayer()&&this.addNeighboringCoord(t,n.coord);return t}addNeighboringCoord(e,t){const i=Math.max(0,t.x-1),s=Math.max(0,t.y-1),o=Math.min(yi.WIDTH-1,t.x+1),a=Math.min(yi.HEIGHT-1,t.y+1);for(let c=s;c<=a;c++)for(let l=i;l<=o;l++)e[c][l]=!0}}class c9t extends Fa{getBoardValue(e){const t=e.gameState;let n=0;for(const i of t.getCoordsAndContents())i.content.isPlayer()&&(n+=ji.CONNECT_SIX_HELPER.getSquareScore(t,i.coord));return new Jn(n)}}class l9t extends cn{constructor(){super($localize`Alignment`,ji.get(),new c9t,new oce)}}function u9t(r,e){if(1&r&&(A(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ve("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function f9t(r,e){if(1&r&&(A(),V(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ve("id","hoshi_",t,"_",n,""),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function d9t(r,e){if(1&r&&(A(),V(0,"rect",9)(1,"line",10)(2,"line",10),O(3,f9t,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function h9t(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),O(1,u9t,1,6,"circle",6),O(2,d9t,4,13,"ng-template",null,7,dn),P()}if(2&r){const t=e.$implicit,n=e.index,i=un(3);ve("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function p9t(r,e){if(1&r&&(A(),S(0,"g"),O(1,h9t,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function g9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",13),W("click",function(){ne(t);const i=p();return re(i.onClick(i.droppedCoord.get().x,i.droppedCoord.get().y))}),P()}if(2&r){const t=p();y("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),I("cx",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().y)("r",.22*t.SPACE_SIZE)}}let m9t=(()=>{var r;class e extends UL{constructor(n){super(n),u(this,"droppedCoord",g.empty()),u(this,"lastMoved",[]),u(this,"victoryCoords",[]),this.rules=ji.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new l9t,new On($localize`MCTS`,new oce,this.rules)],this.encoder=GL.encoder,this.tutorial=(new sce).tutorial}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.victoryCoords=ji.getVictoriousCoords(s),i.createHoshis()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=n instanceof Ba?[n.coord]:[n.getFirst(),n.getSecond()]})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i);if(0===s.getState().turn){const c=Ba.of(a);return s.chooseMove(c)}if(s.getState().getPieceAt(a).isPlayer())return s.cancelMove(Ee.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(a))return s.droppedCoord=g.empty(),b.SUCCESS;{const c=Ga.of(s.droppedCoord.get(),a);return s.chooseMove(c)}}return s.droppedCoord=g.of(a),b.SUCCESS})()}getSpaceClass(n,i){const s=new v(n,i),o=this.getState().getPieceAt(s),a=[];return this.droppedCoord.equalsValue(s)?(a.push(this.getPlayerClass(this.getState().getCurrentPlayer())),a.push("highlighted-stroke")):(a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&a.push("last-move-stroke")),a}cancelMoveAttempt(){this.droppedCoord=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-connect-six"]],features:[Ke],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),V(1,"rect",1),O(2,p9t,2,1,"g",2),O(3,g9t,1,4,"circle",3),P()),2&n&&(I("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),I("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.droppedCoord.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),_4=(()=>{class r{}return u(r,"SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP",()=>$localize`Your piece should land on a neighboring square.`),u(r,"CANNOT_DROP_AFTER_TURN_40",()=>$localize`You cannot drop a piece during the moving phase.`),u(r,"CANNOT_MOVE_BEFORE_TURN_40",()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`),u(r,"MUST_JUMP_OVER_PIECES",()=>$localize`A jump must be made over a piece, not over an empty square.`),u(r,"MUST_DROP_IN_CENTRAL_ZONE",()=>$localize`A drop must occur in the central zone of the board.`),u(r,"INVALID_JUMP",()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`),u(r,"SAME_LOCATION_VISITED_IN_JUMP",()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`),r})();var yC,lce,C2;class jt extends L1{static isOnBoard(e){return e.isInRange(jt.WIDTH,jt.HEIGHT)}isShelter(e){return 0===e.x||e.x===jt.WIDTH-1?jt.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===jt.HEIGHT-1)&&jt.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=jt.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=jt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=jt.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=jt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}yC=jt,u(jt,"WIDTH",17),u(jt,"HEIGHT",17),u(jt,"CENTRAL_ZONE_TOP_LEFT",new v(4,6)),u(jt,"CENTRAL_ZONE_BOTTOM_RIGHT",new v(12,10)),u(jt,"SHELTERS_INDICES",[0,1,3,5,7,8,9,11,13,15,16]),u(jt,"ALL_SHELTERS",new st(yC.SHELTERS_INDICES.flatMap(r=>[new v(r,0),new v(r,yC.HEIGHT-1),new v(0,r),new v(yC.WIDTH-1,r)])).toList());class v4 extends Ar{static of(e){return B.assert(jt.isOnBoard(e),"Move out of board"),new v4(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!C2.isDrop(e)&&this.coord.equals(e.coord)}}u(v4,"encoder",Ar.getEncoder(v4.of));class C4 extends Qs{static from(e,t){const n=jt.isOnBoard(e),i=jt.isOnBoard(t);return B.assert(n&&i,"Move out of board"),e.isAlignedWith(t)&&1===e.getDistance(t)?Q.success(new C4(e,t)):Q.failure(_4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!C2.isSimple(e)&&super.equals(e)}}u(C4,"encoder",qi.getFallibleEncoder(C4.from));class ta extends vi{static from(e){if(e.length<2)return Q.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const n of e)if(!1===jt.isOnBoard(n))return Q.failure("Move out of board");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return Q.failure(_4.INVALID_JUMP());return new W1(e).size()===e.length?Q.success(new ta(e)):Q.failure(_4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),u(this,"coords",void 0),this.coords=e}addJump(e){const t=qt.copy(this.coords);return t.push(e),ta.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(C2.isSimple(e)||C2.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}lce=ta,u(ta,"encoder",we.tuple([we.list(v.encoder)],r=>[qt.copy(r.coords)],r=>lce.from(r[0]).get())),function(r){r.isDrop=function e(i){return i instanceof v4},r.isSimple=function t(i){return i instanceof C4},r.isJump=function n(i){return i instanceof ta},r.encoder=we.disjunction([r.isDrop,r.isSimple,r.isJump],[v4.encoder,C4.encoder,ta.encoder])}(C2||(C2={}));class Zi extends jn{static get(){return Zi.singleton.isAbsent()&&(Zi.singleton=g.of(new Zi)),Zi.singleton.get()}constructor(){super()}getInitialState(){const e=xt.create(jt.WIDTH,jt.HEIGHT,q.NONE);return new jt(e,0)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();if(C2.isDrop(e))i[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(C2.isSimple(e))i[e.getStart().y][e.getStart().x]=q.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const s=e.getStartingCoord(),o=e.getEndingCoord();i[s.y][s.x]=q.NONE,i[o.y][o.x]=t.getCurrentPlayer()}return new jt(i,t.turn+1)}isLegal(e,t){return C2.isDrop(e)?this.dropLegality(e,t):C2.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?b.failure(_4.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?b.failure(_4.MUST_DROP_IN_CENTRAL_ZONE()):b.SUCCESS}simpleMoveLegality(e,t){if(t.turn<40)return b.failure(_4.CANNOT_MOVE_BEFORE_TURN_40());const n=t.getPieceAt(e.getStart());return n===q.NONE?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===t.getCurrentOpponent()?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.getPieceAt(e.getEnd()).isPlayer()?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}jumpLegality(e,t){if(t.turn<40)return b.failure(_4.CANNOT_MOVE_BEFORE_TURN_40());const n=t.getPieceAt(e.getStartingCoord());if(n===q.NONE)return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());for(const i of e.getJumpedOverCoords())if(t.getPieceAt(i)===q.NONE)return b.failure(_4.MUST_JUMP_OVER_PIECES());for(const i of e.getLandingCoords())if(t.getPieceAt(i).isPlayer())return b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());return b.SUCCESS}jumpTargetsFrom(e){const t=[new v(e.x+2,e.y),new v(e.x-2,e.y),new v(e.x,e.y+2),new v(e.x,e.y-2),new v(e.x+2,e.y+2),new v(e.x+2,e.y-2),new v(e.x-2,e.y+2),new v(e.x-2,e.y-2)],n=[];for(const i of t)ta.from([e,i]).isSuccess()&&n.push(i);return n}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const s of this.jumpTargetsFrom(n)){const o=e.addJump(s);o.isSuccess()&&this.jumpLegality(o.get(),t).isSuccess()&&i.push(o.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of jt.ALL_SHELTERS){const s=t.getPieceAt(i);if(s.isPlayer()&&(n[s.value]+=1,20===n[s.value]))return _e.getVictory(s)}return _e.ONGOING}}u(Zi,"singleton",g.empty());const C=q.NONE,vt=q.ZERO,pt=q.ONE;class uce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Zi.get().getInitialState()),j.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Zi.get().getInitialState(),v4.of(new v(7,7)),$localize`Congratulations!`),j.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new jt([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,vt,vt,pt,pt,vt,vt,pt,vt,pt,C,C,C,C],[C,C,C,C,vt,pt,vt,pt,vt,vt,vt,vt,pt,C,C,C,C],[C,C,C,C,vt,pt,C,C,C,C,C,pt,vt,C,C,C,C],[C,C,C,C,pt,vt,vt,pt,pt,pt,vt,vt,vt,C,C,C,C],[C,C,C,C,pt,vt,pt,pt,pt,pt,pt,pt,vt,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),C4.from(new v(4,6),new v(3,5)).get(),(t,n,i)=>C2.isSimple(t)?b.SUCCESS:b.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),j.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new jt([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,vt,vt,pt,pt,vt,vt,pt,vt,pt,C,C,C,C],[C,C,C,C,vt,pt,vt,pt,vt,vt,vt,vt,pt,C,C,C,C],[C,C,C,C,vt,pt,C,C,C,C,C,pt,vt,C,C,C,C],[C,C,C,C,pt,vt,vt,pt,pt,pt,vt,vt,vt,C,C,C,C],[C,C,C,C,pt,vt,pt,pt,pt,pt,pt,pt,vt,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),ta.from([new v(6,7),new v(6,5)]).get(),(t,n,i)=>C2.isJump(t)?b.SUCCESS:b.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),j.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new jt([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,pt,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,pt,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,pt,C,C,C,C,C,C,C,C,C],[C,C,C,C,vt,vt,C,pt,vt,vt,pt,vt,pt,C,C,C,C],[C,C,C,C,vt,C,vt,pt,vt,vt,vt,vt,pt,C,C,C,C],[C,C,C,C,vt,pt,C,C,C,C,C,pt,vt,C,C,C,C],[C,C,C,C,pt,vt,vt,pt,pt,pt,vt,vt,vt,C,C,C,C],[C,C,C,C,pt,vt,pt,pt,pt,pt,pt,pt,vt,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),[ta.from([new v(8,6),new v(6,4),new v(6,2),new v(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)])}}let Wd=(()=>{class r{}return u(r,"NO_MORE_PIECES_OF_THIS_TYPE",()=>$localize`You do not have any pieces of this type anymore.`),u(r,"SPACE_IS_FULL",()=>$localize`You cannot play here: this space is already full.`),u(r,"TARGET_STACK_TOO_HIGH",()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`),u(r,"MUST_SHIFT_TO_NEIGHBOR",()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`),u(r,"MUST_SELECT_PIECE_FIRST",()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`),r})();var Ua,fce,dce;class Tn{static of(e,t){return e===k.ZERO?t?Tn.ZERO_SECOND:Tn.ZERO_FIRST:e===k.ONE?t?Tn.ONE_SECOND:Tn.ONE_FIRST:Tn.EMPTY}constructor(e,t){u(this,"owner",void 0),u(this,"otherPieceType",void 0),this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}Ua=Tn,u(Tn,"encoder",we.tuple([q.encoder,we.identity()],r=>[r.owner,r.otherPieceType],r=>Ua.of(r[0],r[1]))),u(Tn,"EMPTY",new Ua(q.NONE,!1)),u(Tn,"ZERO_FIRST",new Ua(k.ZERO,!1)),u(Tn,"ZERO_SECOND",new Ua(k.ZERO,!0)),u(Tn,"ONE_FIRST",new Ua(k.ONE,!1)),u(Tn,"ONE_SECOND",new Ua(k.ONE,!0)),u(Tn,"PLAYER_PIECES",[Ua.ZERO_FIRST,Ua.ZERO_SECOND,Ua.ONE_FIRST,Ua.ONE_SECOND]);class hce extends vi{isDrop(){return this instanceof y4}isShift(){return this instanceof j2}}class y4 extends hce{constructor(e,t){if(super(),u(this,"target",void 0),u(this,"piece",void 0),this.target=e,this.piece=t,t===Tn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof y4&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}fce=y4,u(y4,"encoder",we.tuple([we.identity(),Tn.encoder],r=>[r.target,r.piece],r=>new fce(r[0],r[1])));class j2 extends hce{static ofRepresentation(e,t){return new j2(new v(e.x,3-e.y),t)}constructor(e,t){super(),u(this,"start",void 0),u(this,"moveDirection",void 0),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof j2&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}dce=j2,u(j2,"encoder",we.tuple([v.encoder,we.identity()],r=>[r.start,"clockwise"===r.moveDirection],r=>new dce(r[0],r[1]?"clockwise":"counterclockwise")));const _9t=we.disjunction([r=>r.isDrop(),r=>r.isShift()],[y4.encoder,j2.encoder]);let nr=(()=>{class r extends L1{static ofRepresentation(t,n){const i=t.reverse(),s=[4,4,4,4];for(let o=0;o<r.HEIGHT;o++)for(let a=0;a<r.WIDTH;a++)i[o][a]!==Tn.EMPTY&&s[r.pieceIndex(i[o][a])]--;return je(s.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new r(i,s,n)}static pieceIndex(t){switch(t){case Tn.ZERO_FIRST:return 0;case Tn.ZERO_SECOND:return 1;case Tn.ONE_FIRST:return 2;default:return B.expectToBe(t,Tn.ONE_SECOND),3}}constructor(t,n,i){super(t,i),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==Tn.EMPTY;i++)n++;return n}}return u(r,"WIDTH",8),u(r,"HEIGHT",4),r})();class Wa extends jn{static get(){return Wa.singleton.isAbsent()&&(Wa.singleton=g.of(new Wa)),Wa.singleton.get()}getInitialState(){const e=Tn.EMPTY;return new nr([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=xt.copy(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=qt.copy(t.remainingPieces);return i[nr.pieceIndex(e.piece)]-=1,new nr(n,i,t.turn+1)}applyLegalShift(e,t){const n=xt.copy(t.board),i=e.getTarget();let s=t.getStackHeight(i),o=e.start.y;for(;o<nr.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==Tn.EMPTY;)n[s][i]=t.getPieceAtXY(e.start.x,o),n[o][e.start.x]=Tn.EMPTY,s++,o++;return new nr(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return B.assert(e.target<nr.WIDTH,"DiamMoveDrop out of board"),B.assert(e.piece.owner!==q.NONE,"DiamMoveDrop cannot contain an empty piece"),e.piece.owner===t.getCurrentOpponent()?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===t.getRemainingPiecesOf(e.piece)?b.failure(Wd.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===nr.HEIGHT?b.failure(Wd.SPACE_IS_FULL()):b.SUCCESS}isShiftLegal(e,t){const n=t.getPieceAt(e.start);return n.owner===q.NONE?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.owner===t.getCurrentOpponent()?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>nr.HEIGHT?b.failure(Wd.TARGET_STACK_TOO_HIGH()):b.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return je(n.owner.isPlayer(),"highest alignment is owned by a player"),_e.getVictory(n.owner)}return _e.ONGOING}findHighestAlignment(e){for(let t=0;t<nr.WIDTH/2;t++)for(let n=nr.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),s=e.getPieceAtXY(t+nr.WIDTH/2,n);if(i!==Tn.EMPTY&&i===s)return g.of(new v(t,n))}return g.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new j2(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new j2(t,"counterclockwise"),e).isSuccess()}}u(Wa,"singleton",g.empty());const Fe=Tn.EMPTY,Eu=Tn.ZERO_FIRST,pce=Tn.ZERO_SECOND,MC=Tn.ONE_FIRST,WL=Tn.ONE_SECOND;class gce{constructor(){u(this,"tutorial",[j.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Wa.get().getInitialState()),j.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,nr.ofRepresentation([[Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,MC,Fe,Fe,Fe],[Eu,Fe,Fe,Fe,Eu,Fe,Fe,Fe]],3),[new y4(0,Tn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),j.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,nr.ofRepresentation([[Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,WL,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,Eu,Fe,Fe,Fe],[MC,Fe,Fe,Fe,pce,Fe,Fe,Fe]],4),[j2.ofRepresentation(new v(4,3),"counterclockwise"),j2.ofRepresentation(new v(4,3),"clockwise"),j2.ofRepresentation(new v(4,2),"counterclockwise"),j2.ofRepresentation(new v(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),j.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,nr.ofRepresentation([[Fe,Fe,Fe,Fe,Eu,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,WL,Fe,Fe,Eu],[Fe,Fe,Fe,Fe,Eu,Fe,Fe,WL],[Fe,MC,Fe,Fe,pce,Fe,Fe,MC]],8),[j2.ofRepresentation(new v(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)])}}let mce=(()=>{var r;class e extends jc{constructor(...n){super(...n),u(this,"SPACE_SIZE",100),u(this,"board",void 0)}getTriangleCornerCoords(n,i){return(n+i)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(n,i){return this.getTriangleCornerCoords(n,i).map(a=>a.x+","+a.y).reduce((a,c)=>a+","+c)}getTriangleTranslateCoord(n,i){return new v(.5*n*this.SPACE_SIZE,i*this.SPACE_SIZE)}getTriangleTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i);return"translate("+s.x+", "+s.y+")"}getDownwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new v(-this.SPACE_SIZE/2,o);return[c,new v(0,a),new v(s,o),c]}getUpwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new v(-this.SPACE_SIZE/2,a);return[c,new v(0,o),new v(s,a),c]}getPyramidPoints(n,i){return(n+i)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+-n,s=n+", "+-n,o="0, "+n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}getUpwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+n,s=n+", "+n,o="0, "+-n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",Be({type:r,selectors:[["ng-component"]],features:[Ke],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),qd=(()=>{class r{}return u(r,"INVALID_DISTANCE",()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`),u(r,"NOT_ENOUGH_TILES_TO_EXCHANGE",()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`),u(r,"FIRST_CLICK_SHOULD_NOT_BE_NULL",()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`),u(r,"CANNOT_CAPTURE_FROM_EMPTY",()=>$localize`You cannot capture from an empty space.`),r})();class na{static getNeighbors(e){let t;const n=new v(e.x-1,e.y),i=new v(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new v(e.x,e.y-1)]:[n,i,new v(e.x,e.y+1)],t}static getFakeNeighbors(e){return new v(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=na.getNeighbors(e),i=na.getNeighbors(t);let s=0;for(;s<n.length;){const o=n[s];let a=0;for(;a<i.length;){if(o.equals(i[a]))return g.of(o);a++}s++}return g.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class R0 extends L1{static getEmptyNeighbors(e,t,n){const i=[];for(const s of na.getNeighbors(t))s.isInRange(e[0].length,e.length)&&e[s.y][s.x]===n&&i.push(s);return i}getEmptyNeighbors(e,t){return R0.getEmptyNeighbors(this.board,e,t)}}var EC,Yc;let y2=(EC=class extends R0{static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new v(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new v(e.x+1,e.y-1),new v(e.x+3,e.y+0),new v(e.x+3,e.y+1),new v(e.x+1,e.y+2),new v(e.x-1,e.y+1),new v(e.x-1,e.y+0)].filter(Yc.isOnBoard)}constructor(e,t,n,i){super(e,t),u(this,"tiles",void 0),u(this,"captures",void 0),this.tiles=n,this.captures=i}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Me.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Me.EMPTY,new Yc(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return na.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Me.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return t[e.y][e.x]=Me.EMPTY,n[this.getCurrentPlayer().value]+=1,new Yc(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=Yc.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const s=Yc.getPresentNeighborEntrances(i);for(const o of s){const a=n.getPieceAt(o);a===Me.EMPTY?n=n.removeTilesIfNeeded(o,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(o)&&(n=n.capture(o))}}return n}isTileEmpty(e){B.assert(this.getPieceAt(e)!==Me.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new St(n,t),1);if(this.getPieceAt(i)!==Me.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=g.empty();for(let i=0;i<6;i++){const o=e.getNext(Yc.NEIGHBORS_TILES_DIRECTIONS[i],1);Yc.isOnBoard(o)&&this.getPieceAt(o)!==Me.UNREACHABLE&&(n.isAbsent()&&(n=g.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,s=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[s+a][i+c]=Me.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return t&&(o[this.getCurrentPlayer().value]+=1),new Yc(n,this.turn,o,this.captures)}getLegalLandings(e){const t=[];for(const n of Ps.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Me.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const s=this.getEmptyNeighbors(new v(n,t),Me.EMPTY).length;e[i.value][s]=e[i.value][s]+1}}return e}},Yc=EC,u(EC,"NEIGHBORS_TILES_DIRECTIONS",[new St(0,-2),new St(3,-1),new St(3,1),new St(0,2),new St(-3,1),new St(-3,-1)]),EC);var Io,Rl,SC,z0;y2=Yc=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],y2);class Ps{static ofCoords(e,t){const n=e.getVectorToward(t),i=Ps.STEPS.findIndex(s=>s.direction.equals(n));return B.assert(-1!==i,qd.INVALID_DISTANCE()),Ps.STEPS[i]}constructor(e,t){u(this,"direction",void 0),u(this,"str",void 0),this.direction=e,this.str=t}}u(Ps,"LEFT",new(Io=Ps)(new St(-2,0),"LEFT")),u(Ps,"UP_LEFT",new Io(ye.UP_LEFT,"UP_LEFT")),u(Ps,"UP_RIGHT",new Io(ye.UP_RIGHT,"UP_RIGHT")),u(Ps,"RIGHT",new Io(new St(2,0),"RIGHT")),u(Ps,"DOWN_LEFT",new Io(ye.DOWN_LEFT,"DOWN_LEFT")),u(Ps,"DOWN_RIGHT",new Io(ye.DOWN_RIGHT,"DOWN_RIGHT")),u(Ps,"STEPS",[Io.LEFT,Io.UP_LEFT,Io.UP_RIGHT,Io.RIGHT,Io.DOWN_LEFT,Io.DOWN_RIGHT]);class Z2 extends Qs{static of(e,t){const n=Ps.ofCoords(e,t);return Z2.ofMovement(e,n)}static ofMovement(e,t){B.assert(y2.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new v(e.x+t.direction.x,e.y+t.direction.y);return B.assert(y2.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new Z2(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!Rl.isTileExchange(e)&&super.equals(e)}}u(Z2,"encoder",Qs.getEncoder(Z2.of));class M4 extends Ar{static of(e){return B.assert(y2.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new M4(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!Rl.isTileExchange(e)&&e.coord.equals(this.coord)}}u(M4,"encoder",Ar.getEncoder(M4.of)),function(r){r.isNormalMove=function e(n){return n instanceof Z2},r.isTileExchange=function t(n){return n instanceof M4},r.encoder=we.disjunction([r.isNormalMove,r.isTileExchange],[Z2.encoder,M4.encoder])}(Rl||(Rl={}));let Su=(SC=class extends jn{static get(){return z0.singleton.isAbsent()&&(z0.singleton=g.of(new z0)),z0.singleton.get()}getInitialState(){const e=Me.EMPTY,t=Me.UNREACHABLE,n=Me.ZERO,i=Me.ONE;return new y2([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}applyLegalMove(e,t,n){return Rl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=Me.EMPTY;const s=[t.captures[0],t.captures[1]];s[t.getCurrentPlayer().value]+=1;const o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;const c=new y2(n,t.turn,o,s).removeTilesIfNeeded(i,!1);return new y2(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures)}applyLegalMovement(e,t){const s=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new y2(s.board,t.turn+1,s.tiles,s.captures)}isLegal(e,t){return Rl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return b.failure(qd.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===Me.UNREACHABLE||n===Me.EMPTY?b.failure(qd.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?b.failure(Ee.CANNOT_SELF_CAPTURE()):b.SUCCESS}isLegalMovement(e,t){B.assert(t.getPieceAt(e.getStart())!==Me.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),B.assert(t.getPieceAt(e.getEnd())!==Me.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===Me.EMPTY?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?_e.ZERO_WON:t.captures[1]>=18?_e.ONE_WON:_e.ONGOING}getGameStatus(e){return z0.getGameStatus(e)}},z0=SC,u(SC,"singleton",g.empty()),SC);Su=z0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],Su);const te=Me.EMPTY,x=Me.UNREACHABLE,s1=Me.ZERO,_n=Me.ONE;class Cce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,Su.get().getInitialState()),j.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,Su.get().getInitialState(),Z2.of(new v(3,5),new v(5,5)),$localize`Congratulations! Let's see captures now.`),j.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new y2([[x,x,x,x,x,x,s1,te,s1,x,x,x,x,x,x],[x,x,x,s1,te,te,te,te,te,s1,te,te,x,x,x],[te,_n,te,_n,s1,_n,te,te,s1,te,te,_n,te,_n,te],[_n,te,te,te,te,te,te,te,te,te,_n,te,te,te,_n],[te,_n,te,_n,te,te,te,te,te,te,te,_n,te,_n,te],[te,s1,te,s1,te,te,te,te,te,te,te,s1,te,s1,te],[s1,te,te,te,s1,te,te,te,te,te,s1,te,te,te,s1],[te,s1,te,s1,te,te,_n,te,_n,te,te,s1,te,s1,te],[x,x,x,te,te,_n,te,te,te,_n,te,te,x,x,x],[x,x,x,x,x,x,_n,te,_n,x,x,x,x,x,x]],3,[0,0],[0,0]),[Z2.of(new v(5,2),new v(4,1)),Z2.of(new v(3,4),new v(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),j.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new y2([[x,x,x,x,x,x,te,te,te,x,x,x,x,x,x],[x,x,x,x,x,x,_n,te,te,x,x,x,x,x,x],[te,te,te,x,x,x,te,te,te,x,x,x,x,x,x],[te,te,_n,te,te,te,te,s1,te,x,x,x,x,x,x],[te,te,te,_n,te,te,te,te,te,x,x,x,x,x,x],[te,te,te,te,te,te,te,te,te,te,te,s1,x,x,x],[te,te,s1,te,te,_n,te,te,te,te,s1,te,te,te,s1],[te,te,te,te,te,te,_n,te,_n,te,te,s1,te,s1,te],[x,x,x,te,te,_n,te,te,te,_n,te,te,x,x,x],[x,x,x,x,x,x,_n,te,_n,x,x,x,x,x,x]],2,[0,0],[0,0]),[Z2.of(new v(2,6),new v(4,6)),Z2.of(new v(2,6),new v(3,5)),Z2.of(new v(2,6),new v(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),j.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new y2([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,te,te,s1,x,x,x,x,x,x,x,x,x],[x,x,x,te,te,te,te,te,te,x,x,x,x,x,x],[x,x,x,te,te,te,_n,te,_n,x,x,x,x,x,x],[x,x,x,te,te,_n,te,te,te,x,x,x,x,x,x],[x,x,x,x,x,x,_n,te,_n,x,x,x,x,x,x]],1,[0,2],[0,0]),[M4.of(new v(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),j.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new y2([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,te,te,s1,x,x,x,x,x,x],[x,x,x,te,te,s1,te,te,te,x,x,x,x,x,x],[x,x,x,te,s1,_n,te,_n,te,x,x,x,x,x,x],[x,x,x,te,_n,s1,te,te,te,x,x,x,x,x,x],[x,x,x,te,te,_n,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],1,[0,0],[0,0]),[Z2.of(new v(7,6),new v(6,5)),Z2.of(new v(7,6),new v(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)])}}class y9t extends tr{getMetrics(e){const t=e.gameState,n=t.getPiecesByFreedom(),i=this.getPiecesScore(n);return[2*t.captures[0]+i[0],2*t.captures[1]+i[1]]}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}}class qL extends Fn{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),t}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer().value,s=Me.ofPlayer(n.getCurrentOpponent());if(n.tiles[i]<2)return t;for(const o of n.getCoordsAndContents())if(o.content===s){const a=M4.of(o.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const s of n.getCoordsAndContents()){const o=s.coord;if(s.content.is(i)){const a=n.getLegalLandings(o);for(const c of a){const l=Z2.of(o,c);t.push(l)}}}return t}}let M9t=(()=>{class r extends tr{getMetrics(t){const n=t.gameState,i=this.getPiecesMap(n),s=this.getThreatMap(n,i),o=this.filterThreatMap(s,n),a=[0,0];for(const c of k.PLAYERS){for(const l of i.get(c).get())o.get(l).isPresent()?a[c.value]+=r.SCORE_BY_THREATENED_PIECE:a[c.value]+=r.SCORE_BY_SAFE_PIECE;a[c.value]+=n.tiles[c.value]}return a}getPiecesMap(t){const n=new Pn,i=[],s=[];for(const o of t.getCoordsAndContents()){const a=o.coord,c=t.getPieceAt(a);c===Me.ZERO?i.push(a):c===Me.ONE&&s.push(a)}return n.set(k.ZERO,new W1(i)),n.set(k.ONE,new W1(s)),n}getThreatMap(t,n){const i=new Pn;for(const s of k.PLAYERS)for(const o of n.get(s).get()){const a=this.getThreat(o,t);a.isPresent()&&i.set(o,a.get())}return i}getThreat(t,n){const s=k.of(n.getPieceAt(t).value).getOpponent();let o=g.empty(),a=g.empty(),c=[];const l=na.getNeighbors(t).filter(y2.isOnBoard);for(const f of l){const d=n.getPieceAt(f);if(d.is(s))c.push(f),this.tileCouldBeRemovedThisTurn(f,n,s)&&(a=g.of(f));else if(d===Me.EMPTY){if(o.isPresent())return g.empty();o=g.of(f)}}if(o.isPresent()){const f=[];for(const d of Ps.STEPS){const m=o.get().getNext(d.direction,1);y2.isOnBoard(m)&&n.getPieceAt(m).is(s)&&!1===c.some(E=>E.equals(m))&&f.push(m)}if(f.length>0)return g.of(new CC(new W1(c),new W1(f)))}if(a.isPresent()){c=c.filter(d=>d.equals(a.get()));const f=new W1(c);return g.of(new CC(f,new W1([a.get()])))}return g.empty()}tileCouldBeRemovedThisTurn(t,n,i){const s=i.getOpponent();if(!1===n.isDeconnectable(t))return!1;let a=g.empty();const c=y2.getTilesUpperLeftCoord(t);for(let l=0;l<2;l++)for(let f=0;f<3;f++){const d=c.getNext(new St(f,l),1);if(n.getPieceAt(d).is(i)){if(!this.pieceCouldLeaveTheTile(d,n))return!1;a=g.of(d)}else if(n.getPieceAt(d).is(s))return!1}return a.isPresent()}pieceCouldLeaveTheTile(t,n){const i=y2.getTilesUpperLeftCoord(t);for(const s of Ps.STEPS){const o=t.getNext(s.direction,1),a=y2.getTilesUpperLeftCoord(o);if(!1===i.equals(a)&&y2.isOnBoard(o)&&n.getPieceAt(o)===Me.EMPTY)return!0}return!1}filterThreatMap(t,n){const i=new Pn,s=t.listKeys(),o=s.filter(c=>n.getPieceAt(c).is(n.getCurrentPlayer())),a=new W1(s.filter(c=>n.getPieceAt(c).is(n.getCurrentOpponent())));for(const c of o){const l=t.get(c).get();let f=g.empty();for(const d of l.directThreats)if(!1===a.contains(d)){const m=[];for(const E of l.mover)!1===a.contains(E)&&m.push(E);m.length>0&&(f=g.of(new CC(l.directThreats,new W1(m))))}f.isPresent()&&i.set(c,f.get())}for(const c of a){const l=t.get(c).get();i.set(c,l)}return i}}return u(r,"SCORE_BY_THREATENED_PIECE",1e3),u(r,"SCORE_BY_SAFE_PIECE",1e6),r})();class E9t extends qL{getListMoves(e){const t=super.getListMoves(e);return this.putCaptureFirst(e,t)}putCaptureFirst(e,t){return qt.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return Rl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}function S9t(r,e){if(1&r&&(A(),V(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();ve("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function P9t(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),O(1,S9t,1,5,"polygon",6),P()}if(2&r){const t=e.index,n=p().index,i=p();ve("id","click_",t,"_",n,""),_(1),y("ngIf",i.mustDraw(t,n))}}function O9t(r,e){if(1&r&&(A(),S(0,"g"),O(1,P9t,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function T9t(r,e){if(1&r&&(A(),V(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();ve("id","pyramid_",t,"_",n,""),y("ngClass",i.getPyramidClass(t,n)),I("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function b9t(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),O(1,T9t,1,5,"polygon",8),P()}if(2&r){const t=e.index,n=p().index,i=p();ve("id","click_",t,"_",n,""),_(1),y("ngIf",i.isPyramid(t,n))}}function w9t(r,e){if(1&r&&(A(),S(0,"g"),O(1,b9t,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function N9t(r,e){if(1&r){const t=pe();A(),S(0,"rect",12),W("click",function(){const s=ne(t).$implicit;return re(p(2).onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p(2);I("x",-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslate(t.x,t.y))}}function A9t(r,e){if(1&r&&(A(),S(0,"g"),V(1,"polygon",10),O(2,N9t,1,5,"rect",11),P()),2&r){const t=p();_(1),ve("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y)),_(1),y("ngForOf",t.possibleLandings)}}function I9t(r,e){if(1&r&&(A(),V(0,"polygon",14)),2&r){const t=p(2);ve("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),I("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslate(t.lastStart.get().x,t.lastStart.get().y))}}function k9t(r,e){if(1&r&&(A(),V(0,"polygon",14)),2&r){const t=p(2);ve("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),I("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslate(t.lastEnd.get().x,t.lastEnd.get().y))}}function x9t(r,e){if(1&r&&(A(),O(0,I9t,1,4,"polygon",13),O(1,k9t,1,4,"polygon",13)),2&r){const t=p();y("ngIf",t.lastStart.isPresent()),_(1),y("ngIf",t.lastEnd.isPresent())}}const L9t=function(r){return["base",r]};function R9t(r,e){if(1&r&&(A(),S(0,"g",16),V(1,"polygon",17),S(2,"text",18),ct(3),P()()),2&r){const t=p().$implicit,n=p();y("id","tilesCount"+t.value),I("transform",n.getTilesCountTranslate(t)),_(1),y("ngClass",wa(7,L9t,"player"+t.value+"-fill")),I("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),_(1),I("font-size",n.SPACE_SIZE/2),_(1),mn(n.tiles[t.value])}}function z9t(r,e){if(1&r&&(A(),S(0,"g"),O(1,R9t,4,9,"g",15),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngIf",n.mustShowTilesOf(t))}}let D9t=(()=>{var r;class e extends mce{constructor(n){super(n),u(this,"state",void 0),u(this,"tiles",[0,0]),u(this,"NONE",Me.UNREACHABLE),u(this,"INDICATOR_SIZE",10),u(this,"chosenCoord",g.empty()),u(this,"lastStart",g.empty()),u(this,"lastEnd",g.empty()),u(this,"possibleLandings",[]),this.scores=g.of([0,0]),this.rules=Su.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Pieces > Threats > Tiles`,this.rules,new M9t,new E9t),new cn($localize`Captures > Freedom`,this.rules,new y9t,new qL),new On($localize`MCTS`,new qL,this.rules)],this.encoder=Rl.encoder,this.tutorial=(new Cce).tutorial}updateBoard(n){var i=this;return M(function*(){i.chosenCoord=g.empty(),i.state=i.getState(),i.scores=g.of(i.state.captures),i.tiles=i.state.tiles,i.board=i.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.possibleLandings=[]}showLastMove(n){var i=this;return M(function*(){n instanceof Z2?(i.lastStart=g.of(n.getStart()),i.lastEnd=g.of(n.getEnd())):(i.lastStart=g.empty(),i.lastEnd=g.empty())})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(a)?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(a).is(c)?s.firstClick(a):s.secondClick(a)})()}firstClick(n){var i=this;return M(function*(){const s=i.state.getPieceAt(n);if(s.is(i.state.getCurrentOpponent())){const o=M4.of(n);return i.chooseMove(o)}return s.is(i.state.getCurrentPlayer())?(i.chosenCoord=g.of(n),i.showHighlight(),b.SUCCESS):i.cancelMove(qd.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(n){var i=this;return M(function*(){if(i.possibleLandings.some(s=>s.equals(n))){const s=Z2.of(i.chosenCoord.get(),n);return i.chooseMove(s)}return i.cancelMove(qd.INVALID_DISTANCE())})()}isPyramid(n,i){return this.board[i][n].isPlayer()||this.wasOpponent(n,i)}wasOpponent(n,i){const s=this.node.parent;if(s.isPresent()){const o=s.get().gameState.getCurrentOpponent();return s.get().gameState.getPieceAtXY(n,i).is(o)}return!1}getPyramidClass(n,i){const s=this.board[i][n];return s===Me.ZERO?this.getPlayerClass(k.ZERO):s===Me.ONE?this.getPlayerClass(k.ONE):"captured-fill"}mustDraw(n,i){return this.board[i][n]!==Me.UNREACHABLE||this.wasRemoved(n,i)}wasRemoved(n,i){const o=this.node.parent;if(this.board[i][n]===Me.UNREACHABLE&&o.isPresent()){const a=o.get().gameState.getPieceAtXY(n,i);return a===Me.EMPTY||a.is(o.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(n,i){return this.wasRemoved(n,i)?"captured-alternate-fill":(n+i)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(n){return this.tiles[n.value]>0||this.lastTurnWasTilesExchange(n)}lastTurnWasTilesExchange(n){return!this.node.parent.isAbsent()&&this.getPreviousState().tiles[n.value]>this.tiles[n.value]}getIndicatorY(n){const i=this.INDICATOR_SIZE/2;return(n.x+n.y)%2==0?i:i-30}getTriangleInHexTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i),o=s.x+2*Math.floor(n/3)*this.STROKE_WIDTH;let a=s.y;return Math.floor(n/3)%2==0?a+=2*Math.floor(i/2)*this.STROKE_WIDTH:(a+=2*Math.abs(Math.floor((i-1)/2))*this.STROKE_WIDTH,a+=this.STROKE_WIDTH),"translate("+o+", "+a+")"}getTilesCountTranslate(n){let i,s;return n===k.ZERO?(i=-.05,s=-.1):(i=7.5,s=9.45),i*=this.SPACE_SIZE,s*=this.SPACE_SIZE,"translate("+i+", "+s+")"}getViewBox(){const a=this.STROKE_WIDTH/2;return new $a(-this.SPACE_SIZE/2,-this.SPACE_SIZE/2,8.5*this.SPACE_SIZE+2*this.STROKE_WIDTH,10.5*this.SPACE_SIZE+2*this.STROKE_WIDTH).expand(a,a,a,a)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-coerceo"]],features:[Ke],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base normal-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","normal-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","normal-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill normal-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","normal-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(A(),S(0,"svg",0),O(1,O9t,2,1,"g",1),O(2,w9t,2,1,"g",1),O(3,A9t,3,5,"g",2),O(4,x9t,2,2,"ng-template",null,3,dn),O(6,z9t,2,1,"g",1),P()),2&n){const s=un(5);I("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s),_(3),y("ngForOf",i.Player.PLAYERS)}},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class yce extends Fn{getListMoves(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=jt.CENTRAL_ZONE_TOP_LEFT,i=jt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let s=n.y;s<=i.y;s++)for(let o=n.x;o<=i.x;o++)e.getPieceAtXY(o,s)===q.NONE&&t.push(v4.of(new v(o,s)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let i=0;i<jt.HEIGHT;i++)for(let s=0;s<jt.WIDTH;s++){const o=new v(s,i);e.getPieceAt(o)===n&&(t=t.concat(this.getListSimpleMoves(e,o)),t=t.concat(this.getListJumps(e,o)))}return t}getListSimpleMoves(e,t){const n=[],i=[new v(t.x+1,t.y),new v(t.x-1,t.y),new v(t.x,t.y+1),new v(t.x,t.y-1),new v(t.x+1,t.y+1),new v(t.x+1,t.y-1),new v(t.x-1,t.y+1),new v(t.x-1,t.y-1)].filter(s=>jt.isOnBoard(s));for(const s of i){const o=C4.from(t,s);o.isSuccess()&&Zi.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}getListJumps(e,t){const n=new st;for(const i of Zi.get().jumpTargetsFrom(t)){const s=ta.from([t,i]).get();Zi.get().jumpLegality(s,e).isSuccess()&&(n.add(s),n.addAll(this.getListJumpStartingFrom(e,s)))}return n.toList()}getListJumpStartingFrom(e,t){const n=Zi.get().nextJumps(t,e),i=new st(n);for(const s of n)i.addAll(this.getListJumpStartingFrom(e,s));return i}}class H9t extends tr{getMetrics(e){const t=e.gameState,n=[0,0];for(let i=0;i<jt.HEIGHT;i++)for(let s=0;s<jt.WIDTH;s++){const o=new v(s,i),a=t.getPieceAt(o);if(a.isPlayer())if(t.isShelter(o))n[a.value]+=20;else{let c=100;for(const l of jt.ALL_SHELTERS)if(t.getPieceAt(l)===q.NONE){const f=o.getOrthogonalDistance(l);c=Math.min(c,f)}n[a.value]-=c}}return n}}class V9t extends yce{getListMoves(e){return this.sortByNumberOfJumps(super.getListMoves(e))}sortByNumberOfJumps(e){return e.sort((t,n)=>{const i=C2.isDrop(t)?1:C2.isSimple(t)?2:t.coords.length;return(C2.isDrop(n)?1:C2.isSimple(n)?2:n.coords.length)-i})}}class F9t extends cn{constructor(){super($localize`Jump`,Zi.get(),new H9t,new V9t)}}function $9t(r,e){if(1&r){const t=pe();A(),S(0,"rect",9),W("click",function(){ne(t);const i=p().$implicit;return re(p(2).onClick(i.coord))}),P()}if(2&r){const t=p().$implicit,n=p(2);I("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function B9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",6),W("click",function(){ne(t);const i=p().$implicit;return re(p(2).onClick(i.coord))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function G9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",6),W("click",function(){const s=ne(t).$implicit;return re(p(2).onClick(s.coord))}),P(),O(2,$9t,1,4,"rect",7),O(3,B9t,1,6,"circle",8),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","click_",n,"_",i,""),y("ngClass",t.squareClasses),I("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isShelter),_(1),y("ngIf",t.hasPiece)}}function U9t(r,e){if(1&r&&(A(),S(0,"g"),O(1,G9t,4,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function W9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",10),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),I("x",n.SPACE_SIZE*t.x+2.5*n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+2.5*n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function q9t(r,e){if(1&r&&(A(),V(0,"circle",11)),2&r){const t=e.$implicit,n=p();Dn("id","sidePiece_0_",t,""),I("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function j9t(r,e){if(1&r&&(A(),V(0,"circle",12)),2&r){const t=e.$implicit,n=p();Dn("id","sidePiece_1_",t,""),I("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Z9t(r,e){if(1&r&&(A(),V(0,"rect",13)),2&r){const t=p();I("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let Y9t=(()=>{var r;class e extends jc{constructor(n){super(n),u(this,"PIECE_RADIUS",void 0),u(this,"ALL_SHELTERS",jt.ALL_SHELTERS),u(this,"CENTRAL_ZONE_START",jt.CENTRAL_ZONE_TOP_LEFT),u(this,"CENTRAL_ZONE_SIZE",new St(jt.CENTRAL_ZONE_BOTTOM_RIGHT.x-jt.CENTRAL_ZONE_TOP_LEFT.x+1,jt.CENTRAL_ZONE_BOTTOM_RIGHT.y-jt.CENTRAL_ZONE_TOP_LEFT.y+1)),u(this,"viewInfo",{dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]}),u(this,"selected",g.empty()),u(this,"jumpInConstruction",g.empty()),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Zi.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new F9t,new On($localize`MCTS`,new yce,this.rules)],this.encoder=C2.encoder,this.tutorial=(new uce).tutorial}updateBoard(n){var i=this;return M(function*(){i.updateViewInfo()})()}updateViewInfo(){const n=this.getState();this.viewInfo.dropPhase=n.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let i=0;i<jt.HEIGHT;i++){this.viewInfo.boardInfo.push([]);for(let s=0;s<jt.WIDTH;s++){const o=new v(s,i),a=n.getPieceAt(o),c={coord:o,squareClasses:[],shelterClasses:["no-fill"],pieceClasses:[this.getPlayerClass(a)],hasPiece:a.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[i].push(c)}}this.viewInfo.sidePieces=n.getSidePieces(),this.updateSelected(),this.updateShelterHighlights()}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const n=this.jumpInConstruction.get(),i=n.getStartingCoord(),s=n.getEndingCoord();this.viewInfo.boardInfo[i.y][i.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const o of n.coords)this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill")}else{const n=this.selected.get();this.viewInfo.boardInfo[n.y][n.x].pieceClasses.push("selected-stroke")}}updateShelterHighlights(){const n=this.getState(),i=Zi.get().getGameStatus(this.node),s=!0===i.isEndGame;for(const o of jt.ALL_SHELTERS){const a=this.viewInfo.boardInfo[o.y][o.x],c=n.getPieceAt(o),l=!1===s&&c.isPlayer();(s&&c===i.winner||l)&&(a.shelterClasses.push("selectable-stroke"),a.pieceClasses.push("victory-stroke"),a.squareClasses.push("victory-fill"))}}showLastMove(n){var i=this;return M(function*(){if(C2.isDrop(n))i.viewInfo.boardInfo[n.coord.y][n.coord.x].squareClasses.push("moved-fill");else if(C2.isSimple(n))i.viewInfo.boardInfo[n.getStart().y][n.getStart().x].squareClasses.push("moved-fill"),i.viewInfo.boardInfo[n.getEnd().y][n.getEnd().x].squareClasses.push("moved-fill");else{i.viewInfo.lastMoveArrow="";for(const s of n.coords)i.viewInfo.boardInfo[s.y][s.x].squareClasses.push("moved-fill"),i.viewInfo.lastMoveArrow+=s.x*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" ",i.viewInfo.lastMoveArrow+=s.y*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" "}})()}cancelMoveAttempt(){var n=this;return M(function*(){n.jumpInConstruction=g.empty(),n.selected=g.empty(),yield n.updateBoard(!1)})()}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());const o=i.getState(),a=o.getPieceAt(n);if(o.getPieceAt(n)===i.getCurrentPlayer())return i.selected.equalsValue(n)?yield i.cancelMoveAttempt():(i.selected=g.of(n),i.jumpInConstruction=g.empty()),i.updateViewInfo(),b.SUCCESS;if(i.jumpInConstruction.isPresent())return i.constructJump(n);if(i.selected.isPresent())return i.selectNextCoord(n);if(o.isDropPhase()){const c=v4.of(n);return i.chooseMove(c)}return i.cancelMove(a===q.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}constructJump(n){var i=this;return M(function*(){const s=i.jumpInConstruction.get(),o=i.getState();if(n.equals(s.getEndingCoord()))return i.chooseMove(s);{const a=s.addJump(n);if(a.isFailure())return i.cancelMove(a.getReason());const c=i.rules.jumpLegality(a.get(),o);return c.isFailure()?i.cancelMove(c.getReason()):i.updateJump(a.get())}})()}updateJump(n){var i=this;return M(function*(){const s=i.getState();return i.rules.jumpHasPossibleNextTargets(n,s)?(i.jumpInConstruction=g.of(n),i.updateViewInfo(),b.SUCCESS):i.chooseMove(n)})()}selectNextCoord(n){var i=this;return M(function*(){const s=i.selected.get(),o=C4.from(s,n);if(o.isSuccess())return i.chooseMove(o.get());{const a=ta.from([s,n]);return a.isFailure()?i.cancelMove(a.getReason()):i.updateJump(a.get())}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-conspirateurs"]],features:[Ke],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke big-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","big-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,U9t,2,1,"g",1),O(2,W9t,2,5,"g",1),O(3,q9t,1,4,"circle",2),O(4,j9t,1,4,"circle",3),O(5,Z9t,1,4,"rect",4),V(6,"polyline",5),P()),2&n&&(_(1),y("ngForOf",i.viewInfo.boardInfo),_(1),y("ngForOf",i.ALL_SHELTERS),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[0])),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[1])),_(1),y("ngIf",i.viewInfo.dropPhase),_(1),I("points",i.viewInfo.lastMoveArrow))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),D0=(()=>{class r{}return u(r,"CANNOT_MOVE_WITH_BALL",()=>$localize`You cannot move the piece holding the ball.`),u(r,"MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE",()=>$localize`You must move by exactly one orthogonal space.`),u(r,"PASS_PATH_OBSTRUCTED",()=>$localize`The path of this pass is obstructed.`),u(r,"PASS_MUST_BE_IN_STRAIGHT_LINE",()=>$localize`A pass must be done in a straight line, orthogonally or diagonally.`),u(r,"CAN_ONLY_DO_ONE_PASS",()=>$localize`You can only perform one pass per turn.`),u(r,"CAN_ONLY_TRANSLATE_TWICE",()=>$localize`You can only perform two translations per turn, not three.`),u(r,"CANNOT_PASS_TO_OPPONENT",()=>$localize`You cannot pass the ball to the opponent. You must pick one of your pieces.`),r})();var Pu,Ou;class Os extends Qs{static from(e,t){return ye.factory.fromMove(e,t).isFailure()?Q.failure(D0.PASS_MUST_BE_IN_STRAIGHT_LINE()):Q.success(new Os(e,t))}constructor(e,t){super(e,t)}equals(e){return e instanceof Os&&super.equals(e)}}u(Os,"encoder",qi.getFallibleEncoder(Os.from));class Ei extends Qs{static from(e,t){return e.getVectorToward(t).isSingleOrthogonalStep()?Q.success(new Ei(e,t)):Q.failure(D0.MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE())}constructor(e,t){super(e,t)}equals(e){return e instanceof Ei&&super.equals(e)}}function jL(r){return r instanceof Ei}u(Ei,"encoder",qi.getFallibleEncoder(Ei.from));class Ts extends vi{static countPassesAndTranslations(e,t){e instanceof Os?t.passes++:t.translations++}constructor(e,t,n){super(),u(this,"first",void 0),u(this,"second",void 0),u(this,"third",void 0),this.first=e,this.second=t,this.third=n,n.isPresent()&&B.assert(t.isPresent(),"DiaballikMove should have two first actions to have a third one");const i={passes:0,translations:0};Ts.countPassesAndTranslations(e,i),t.isPresent()&&Ts.countPassesAndTranslations(t.get(),i),n.isPresent()&&Ts.countPassesAndTranslations(n.get(),i),B.assert(i.passes<=1,"DiaballikMove should have at most one pass"),B.assert(i.translations<=2,"DiaballikMove should have at most two translations")}toString(){return`DiaballikMove(${this.first.toString()}, ${this.second.toString()}, ${this.third.toString()})`}equals(e){return!(!1===this.first.equals(e.first)||!1===this.second.equals(e.second)||!1===this.third.equals(e.third))}getSubMoves(){const e=[this.first];return this.second.isPresent()&&e.push(this.second.get()),this.third.isPresent()&&e.push(this.third.get()),e}}Pu=Ts,u(Ts,"subMoveEncoder",we.disjunction([jL,function K9t(r){return r instanceof Os}],[Ei.encoder,Os.encoder])),u(Ts,"subMoveOptionalEncoder",g.getEncoder(Pu.subMoveEncoder)),u(Ts,"encoder",we.tuple([Pu.subMoveEncoder,Pu.subMoveOptionalEncoder,Pu.subMoveOptionalEncoder],r=>[r.first,r.second,r.third],r=>new Pu(r[0],r[1],r[2])));class Y2{constructor(e,t){u(this,"owner",void 0),u(this,"holdsBall",void 0),this.owner=e,this.holdsBall=t}equals(e){return this===e}}u(Y2,"NONE",new(Ou=Y2)(q.NONE,!1)),u(Y2,"ZERO",new Ou(k.ZERO,!1)),u(Y2,"ZERO_WITH_BALL",new Ou(k.ZERO,!0)),u(Y2,"ONE",new Ou(k.ONE,!1)),u(Y2,"ONE_WITH_BALL",new Ou(k.ONE,!0));class Tu extends L1{equals(e){return xt.compare(this.board,e.board)}}class Sce{constructor(e){u(this,"winner",void 0),this.winner=e}}class ZL extends Sce{constructor(e,t){super(e),u(this,"coord",void 0),this.coord=t}}class Pce extends Sce{constructor(e,t,n){super(e.getOpponent()),u(this,"allLoserPieces",void 0),u(this,"opponentPiecesInContact",void 0),this.allLoserPieces=t,this.opponentPiecesInContact=n}}class bs extends jn{static get(){return bs.singleton.isAbsent()&&(bs.singleton=g.of(new bs)),bs.singleton.get()}getInitialState(){const e=Y2.ZERO,n=Y2.ONE,s=Y2.NONE;return new Tu([[n,n,n,Y2.ONE_WITH_BALL,n,n,n],[s,s,s,s,s,s,s],[s,s,s,s,s,s,s],[s,s,s,s,s,s,s],[s,s,s,s,s,s,s],[s,s,s,s,s,s,s],[e,e,e,Y2.ZERO_WITH_BALL,e,e,e]],0)}isLegal(e,t){let n=t;for(const i of e.getSubMoves()){const s=i.getStart();if(!1===t.isOnBoard(s))return Q.failure(m4.OUT_OF_RANGE(s));const o=i.getEnd();if(!1===t.isOnBoard(o))return Q.failure(m4.OUT_OF_RANGE(o));const a=this.isLegalSubMove(n,i);if(a.isFailure())return a;n=a.get()}return Q.success(n)}isLegalSubMove(e,t){return t instanceof Ei?this.isLegalTranslation(e,t):this.isLegalPass(e,t)}isLegalTranslation(e,t){const n=t.getStart(),i=e.getPieceAt(n);if(i.owner===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===e.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!0===i.holdsBall)return Q.failure(D0.CANNOT_MOVE_WITH_BALL());const s=t.getEnd();if(e.getPieceAt(s).owner.isPlayer())return Q.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const o=e.getCopiedBoard();o[n.y][n.x]=Y2.NONE,o[s.y][s.x]=i;const a=new Tu(o,e.turn);return Q.success(a)}isLegalPass(e,t){const n=t.getStart(),i=e.getPieceAt(n);if(i.owner===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===e.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());B.assert(i.holdsBall,"DiaballikRules: cannot pass without the ball");const s=t.getEnd(),o=e.getPieceAt(s);if(o.owner===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(o.owner===e.getCurrentOpponent())return Q.failure(D0.CANNOT_PASS_TO_OPPONENT());const a=ye.factory.fromMove(n,s).get();for(let m=n.getNext(a);!1===m.equals(s);m=m.getNext(a))if(e.getPieceAt(m)!==Y2.NONE)return Q.failure(D0.PASS_PATH_OBSTRUCTED());const l=e.getCopiedBoard(),f=l[n.y][n.x];return l[n.y][n.x]=l[s.y][s.x],l[s.y][s.x]=f,Q.success(new Tu(l,e.turn))}applyLegalMove(e,t,n){return new Tu(n.board,t.turn+1)}getGameStatus(e){const n=this.getVictoryOrDefeatCoords(e.gameState);return n.isPresent()?_e.getVictory(n.get().winner):_e.ONGOING}getVictoryOrDefeatCoords(e){const t=this.getBallCoordInRow(e,0,k.ZERO);if(t.isPresent())return g.of(new ZL(k.ZERO,t.get()));const n=this.getBallCoordInRow(e,e.getHeight()-1,k.ONE);return n.isPresent()?g.of(new ZL(k.ONE,n.get())):this.getBlockerAndCoords(e)}getBallCoordInRow(e,t,n){for(let i=0;i<e.board.length;i++){const s=e.getPieceAtXY(i,t);if(!0===s.holdsBall&&s.owner===n)return g.of(new v(i,t))}return g.empty()}getBlockerAndCoords(e){const t=[this.getBlockerCoords(e,k.ZERO),this.getBlockerCoords(e,k.ONE)];return t[0].isPresent()&&t[1].isPresent()?t[e.getCurrentPlayer().value]:t[0].isPresent()?t[0]:t[1].isPresent()?t[1]:g.empty()}getBlockerCoords(e,t){const n=new st,i=[];for(let s=0;s<e.getWidth();s++){const o=this.getConnectedPieceCoord(s,n,e,t);if(!o.isPresent())return g.empty();i.push(o.get())}return n.size()>=3?g.of(new Pce(t,i,n.toList())):g.empty()}getConnectedPieceCoord(e,t,n,i){for(let s=0;s<n.getHeight();s++){const o=new v(e,s);if(n.getPieceAt(o).owner===i)return this.isConnectedOnTheLeft(o,n,i)?(this.addConnectedOpponents(o,t,n,i),g.of(o)):g.empty()}return g.empty()}isConnectedOnTheLeft(e,t,n){if(0===e.x)return!0;for(const i of[ye.LEFT,ye.UP_LEFT,ye.DOWN_LEFT]){const s=e.getNext(i);if(t.isOnBoard(s)&&t.getPieceAt(s).owner===n)return!0}return!1}addConnectedOpponents(e,t,n,i){for(const s of Re.factory.all){const o=e.getNext(s);n.isOnBoard(o)&&n.getPieceAt(o).owner===i.getOpponent()&&t.add(o)}}}u(bs,"singleton",g.empty());const ra=Y2.ZERO,Oce=Y2.ZERO_WITH_BALL,ia=Y2.ONE,Tce=Y2.ONE_WITH_BALL,rt=Y2.NONE;class bce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of Diaballik is to bring your ball, represented by the small circle, into the home line of the opponent (i.e, its starting position). The ball is currently being held by your center piece.`,bs.get().getInitialState()),j.fromMove($localize`Translations`,$localize`During a turn, you are allowed up to three actions, including at most two translations. A translation is an orthogonal step of any piece that does not hold the ball.<br/><br/>Move your leftmost piece by one step. Once you are done, click on the green button that will appear on the bottom right of the board to indicate that you are done with your turn.`,bs.get().getInitialState(),[new Ts(Ei.from(new v(0,6),new v(0,5)).get(),g.empty(),g.empty())],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Pass`,$localize`Another action that you are allowed to do at most once per turn is a pass. You can pass the ball by clicking on the piece that holds the ball, then on another one of your piece that can receive it. A pass must be made in a straight line along an unobstructed path.<br/><br/>Here, playing Dark, you can make two moves and a pass to win the game, do it!`,new Tu([[ia,ia,ia,Tce,rt,ia,ia],[rt,rt,rt,ra,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[Oce,rt,rt,ia,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[rt,ra,ra,rt,ra,ra,ra]],0),[new Ts(Ei.from(new v(3,1),new v(4,1)).get(),g.of(Ei.from(new v(4,1),new v(4,0)).get()),g.of(Os.from(new v(0,4),new v(4,0)).get()))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Blocking the opponent`,$localize`There is a special anti-game rule. If a player forms a contiguous line, with one piece in each column, they block the opponent from reaching their home line. If the opponent is in contact with three pieces in this case, they win instantaneously.<br/><br/>Here, playing Light, your opponent is blocking you and you already have two pieces in contact with their line. If you can connect a third piece, you win. Do it!`,new Tu([[ia,ia,ia,rt,rt,rt,rt],[ia,rt,rt,rt,rt,rt,Tce],[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[ra,ia,rt,rt,rt,rt,rt],[rt,ra,rt,ia,rt,rt,rt],[rt,rt,ra,Oce,ra,ra,ra]],1),[new Ts(Ei.from(new v(0,1),new v(0,2)).get(),g.of(Ei.from(new v(0,2),new v(0,3)).get()),g.empty())],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class X9t extends tr{getMetrics(e){const t=e.gameState,n=[-1,-1];for(const i of t.getCoordsAndContents()){const s=i.content;s.holdsBall&&(s.owner===k.ZERO?n[0]=t.board.length-1-i.coord.y:n[1]=i.coord.y)}return n}}class wce extends cn{constructor(e,t){super(e,bs.get(),new X9t,t)}}class bu{static finalize(e){return e.finalize()}constructor(e,t,n){u(this,"subMoves",void 0),u(this,"stateBefore",void 0),u(this,"stateAfterSubMoves",void 0),u(this,"hasPass",void 0),u(this,"translations",void 0),this.subMoves=e,this.stateBefore=t,this.stateAfterSubMoves=n,B.assert(this.subMoves.length<=3,"DiaballikMoveInConstruction can have at most 3 submoves");let i=!1,s=0;for(const o of e)o instanceof Os?(B.assert(!1===i,"DiaballikMoveInConstruction can have at most one pass"),i=!0):(B.assert(s<2,"DiaballikMoveInConstruction can have at most two translations"),s++);this.hasPass=i,this.translations=s}equals(e){return qt.compare(this.subMoves,e.subMoves)}addIfLegal(e,t){const n=bs.get().isLegalSubMove(this.stateAfterSubMoves,e);if(n.isSuccess()){const i=this.subMoves.concat([e]);this.sortIfNeeded(i);const s=new bu(i,this.stateBefore,n.get());t.push(s)}}sortIfNeeded(e){const t=this.getFirstTranslationIndex(e);if(t.isAbsent())return;const n=t.get();if(n+1>=e.length||!1===jL(e[n+1]))return;const i=e[n],s=new st(i.getCoords()),o=e[n+1],a=new st(o.getCoords());s.intersection(a).size()>0||i.getStart().compareTo(o.getStart())>0&&(e[n]=o,e[n+1]=i)}getFirstTranslationIndex(e){for(let t=0;t<e.length;t++)if(jL(e[t]))return g.of(t);return g.empty()}getPassEnd(){for(const e of this.subMoves)if(e instanceof Os)return g.of(e.getEnd());return g.empty()}passPathContains(e){for(const t of this.subMoves)if(t instanceof Os)return t.getStart().getCoordsToward(t.getEnd()).some(i=>i.equals(e));return!1}getPreviousTranslation(){for(const e of this.subMoves)if(e instanceof Ei)return g.of(e);return g.empty()}hasOppositeTranslation(e,t){if(this.translations>0){const n=this.getPreviousTranslation().get();return n.getStart().equals(t)&&n.getEnd().equals(e)}return!1}finalize(){B.assert(this.subMoves.length>0,"DiaballikMoveInConstruction can only be finalized if it contains something");const e=this.subMoves[0];let t=g.empty();this.subMoves.length>1&&(t=g.of(this.subMoves[1]));let n=g.empty();this.subMoves.length>2&&(n=g.of(this.subMoves[2]));const i=new Ts(e,t,n);return B.assert(bs.get().isLegal(i,this.stateBefore).isSuccess(),"DiaballikMoveGenerator should only generate legal moves"),i}}class PC extends Fn{constructor(e=!0){super(),u(this,"avoidDuplicates",void 0),this.avoidDuplicates=e}getListMoves(e){let n=[new bu([],e.gameState,e.gameState)];const i=new st;for(let s=0;s<3;s++){let o=[];for(const a of n){const c=this.addAllPossibleSubMoves(a);i.addAll(new st(c.map(bu.finalize))),o=o.concat(c)}n=o}return this.removeDuplicates(e.gameState,i)}removeDuplicates(e,t){if(!1===this.avoidDuplicates)return t.toList();const n=new st,i=[];for(const s of t){const o=bs.get().isLegal(s,e),a=bs.get().applyLegalMove(s,e,o.get());!1===n.contains(a)&&(i.push(s),n.add(a))}return i}addAllPossibleSubMoves(e){const t=e.stateAfterSubMoves,n=t.getCurrentPlayer(),i=[];for(const s of t.getCoordsAndContents()){const o=s.coord,a=s.content;if(a.owner===n)if(a.holdsBall&&!1===e.hasPass)for(const c of this.getPassEnds(t,s.coord)){const l=Os.from(o,c).get();e.addIfLegal(l,i)}else if(e.translations<2)for(const l of this.getTranslationEnds(t,s.coord))if(!1===e.hasOppositeTranslation(s.coord,l)||!1===this.avoidDuplicates){let d=!0;if(e.hasPass){const m=e.getPassEnd().equalsValue(o),E=e.passPathContains(l);d=m||E}if(d||!1===this.avoidDuplicates){const m=Ei.from(o,l).get();e.addIfLegal(m,i)}}}return i}getPassEnds(e,t){const n=e.getCurrentPlayer(),i=[];for(const s of ye.factory.all){let o=t.getNext(s);for(;e.isOnBoard(o);){const a=e.getPieceAt(o);if(a.owner===n){i.push(o);break}if(a.owner!==q.NONE)break;o=o.getNext(s)}}return i}getTranslationEnds(e,t){const n=[];for(const i of Re.factory.all){const s=t.getNext(i);e.isOnBoard(s)&&e.getPieceAt(s).owner===q.NONE&&n.push(s)}return n}}class Nce{constructor(e,t,n,i){u(this,"x1",void 0),u(this,"y1",void 0),u(this,"x2",void 0),u(this,"y2",void 0),this.x1=e,this.y1=t,this.x2=n,this.y2=i}}class YL extends PC{constructor(e,t=!0){super(t),u(this,"moveLength",void 0),this.moveLength=e,B.assert(1<=e&&e<=3,"Diaballik moves should be of length [1,3]")}getListMoves(e){let n=[new bu([],e.gameState,e.gameState)];for(let i=0;i<this.moveLength;i++){let s=[];for(const o of n)s=s.concat(this.addAllPossibleSubMoves(o));n=s}return n.map(bu.finalize)}}function Q9t(r,e){if(1&r&&(A(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","piece_",n,"_",s,""),y("ngClass",o.getPieceClasses(n,s,i)),I("r",42)("cx",o.SPACE_SIZE/2)("cy",o.SPACE_SIZE/2)}}function J9t(r,e){if(1&r&&(A(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","ball_",n,"_",s,""),y("ngClass",o.getBallClasses(n,s,i)),I("r",22)("cx",o.SPACE_SIZE/2)("cy",o.SPACE_SIZE/2)}}function edt(r,e){if(1&r){const t=pe();A(),S(0,"g",9),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(1,"rect",10),O(2,Q9t,1,6,"circle",11),O(3,J9t,1,6,"circle",11),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ve("id","click_",n,"_",i,""),I("transform",s.getTranslationXY(n,i)),_(1),ve("id","space_",n,"_",i,""),y("ngClass",s.getSpaceClasses(n,i)),I("x",0)("y",0)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.owner.isPlayer()),_(1),y("ngIf",t.holdsBall)}}function tdt(r,e){if(1&r&&(A(),S(0,"g"),O(1,edt,4,12,"g",8),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function ndt(r,e){if(1&r&&(A(),V(0,"line",12)),2&r){const t=e.$implicit;I("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function rdt(r,e){if(1&r){const t=pe();A(),S(0,"rect",13),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","indicator_",t.x,"_",t.y,""),I("transform",n.getTranslation(t))("x",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("y",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function idt(r,e){if(1&r&&(A(),S(0,"g")(1,"g",14),V(2,"rect",15)(3,"circle",16)(4,"rect",15)(5,"line",17),S(6,"text",18),ct(7),P()(),S(8,"g",19),V(9,"rect",15)(10,"circle",16)(11,"circle",16)(12,"rect",15)(13,"circle",16)(14,"line",17),S(15,"text",20),ct(16),P()()()),2&r){const t=p();_(1),I("transform",t.getTranslationXY(0,t.HEIGHT+.3)+" scale(0.5)"),_(1),I("x",0)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("r",42)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),I("x",t.SPACE_SIZE)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),I("x1",t.SPACE_SIZE/2)("y1",t.SPACE_SIZE/2)("x2",t.SPACE_SIZE+t.SPACE_SIZE/2)("y2",t.SPACE_SIZE/2),_(1),I("x",2.3*t.SPACE_SIZE)("y",t.SPACE_SIZE/2)("font-size",t.SPACE_SIZE/2),_(1),mn(t.translationsMade),_(1),I("transform",t.getTranslationXY(t.WIDTH-1,t.HEIGHT+.3)+" scale(0.5)"),_(1),I("x",0)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("r",42)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("r",22)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),I("x",t.SPACE_SIZE)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("r",42)("cx",t.SPACE_SIZE+t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),_(1),I("x1",t.SPACE_SIZE/2)("y1",t.SPACE_SIZE/2)("x2",t.SPACE_SIZE+t.SPACE_SIZE/2)("y2",t.SPACE_SIZE/2),_(1),I("x",-.6*t.SPACE_SIZE)("y",t.SPACE_SIZE/2)("font-size",t.SPACE_SIZE/2),_(1),mn(t.hasMadePass?1:0)}}function sdt(r,e){if(1&r){const t=pe();A(),S(0,"g",21),W("click",function(){return ne(t),re(p().done())}),V(1,"circle",22)(2,"polygon",23),P()}if(2&r){const t=p();I("transform",t.getTranslationXY(t.WIDTH/2,t.HEIGHT+.5)),_(1),I("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2.5)}}let odt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"stateInConstruction",void 0),u(this,"WIDTH",void 0),u(this,"HEIGHT",void 0),u(this,"INDICATOR_SIZE",20),u(this,"victoryCoord",g.empty()),u(this,"loserCoords",[]),u(this,"blockedLines",[]),u(this,"indicators",[]),u(this,"currentSelection",g.empty()),u(this,"hasMadePass",!1),u(this,"translationsMade",0),u(this,"subMoves",[]),u(this,"highlightedBallCoords",[]),u(this,"highlightedPiecesCoords",[]),u(this,"moveGenerator",new PC(!1)),this.hasAsymmetricBoard=!0,this.rules=bs.get(),this.node=this.rules.getInitialNode(),this.WIDTH=this.getState().getWidth(),this.HEIGHT=this.getState().getHeight(),this.encoder=Ts.encoder,this.tutorial=(new bce).tutorial,this.availableAIs=[new wce($localize`AllMoves`,new PC(!0)),new On($localize`MCTS`,this.moveGenerator,this.rules),new On($localize`MCTS (3 only)`,new YL(3,!1),this.rules),new On($localize`MCTS (without dups)`,new PC(!0),this.rules),new On($localize`MCTS (3, no dups)`,new YL(3,!1),this.rules)];for(let i=1;i<=3;i++)this.availableAIs.push(new wce($localize`Distance (${i})`,new YL(i)))}updateBoard(n){var i=this;return M(function*(){const s=i.node.gameState;i.board=s.board,i.stateInConstruction=s;const o=i.rules.getVictoryOrDefeatCoords(s);if(i.victoryCoord=g.empty(),i.loserCoords=[],i.blockedLines=[],o.isPresent()){const a=o.get();if(a instanceof ZL)i.victoryCoord=g.of(a.coord);else if(a instanceof Pce){i.loserCoords=a.allLoserPieces;const c=a.winner===k.ZERO?0:i.SPACE_SIZE;for(const l of a.opponentPiecesInContact){const f=l.x*i.SPACE_SIZE,d=l.y*i.SPACE_SIZE+c,m=new Nce(f,d,f+i.SPACE_SIZE,d);i.blockedLines.push(m)}}}})()}showLastMove(n){var i=this;return M(function*(){for(const s of n.getSubMoves())i.showSubMove(s)})()}showSubMove(n){n instanceof Ei?this.highlightedPiecesCoords.push(n.getStart(),n.getEnd()):(B.assert(n instanceof Os,"DiaballikMove can only be a translation or a pass"),this.highlightedBallCoords.push(n.getStart(),n.getEnd()))}hideLastMove(){this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}cancelMoveAttempt(){this.stateInConstruction=this.getState(),this.currentSelection=g.empty(),this.hasMadePass=!1,this.translationsMade=0,this.subMoves=[],this.indicators=[],this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}getSpaceClasses(n,i){const s=new v(n,i),o=[];return this.highlightedPiecesCoords.some(a=>a.equals(s))&&o.push("moved-fill"),this.highlightedBallCoords.some(a=>a.equals(s))&&o.push("moved-fill"),o}getPieceClasses(n,i,s){const o=new v(n,i),a=[this.getPlayerClass(s.owner)];return this.highlightedPiecesCoords.some(c=>c.equals(o))&&a.push("last-move-stroke"),!1===s.holdsBall&&this.currentSelection.equalsValue(new v(n,i))&&a.push("selected-stroke"),this.victoryCoord.equalsValue(o)&&a.push("victory-stroke"),this.loserCoords.some(c=>c.equals(o))&&a.push("defeat-stroke"),a}getBallClasses(n,i,s){const o=new v(n,i),a=[this.getPlayerClass(s.owner)];return this.highlightedBallCoords.some(c=>c.equals(o))&&a.push("last-move-stroke"),this.currentSelection.equalsValue(new v(n,i))&&a.push("selected-stroke"),a}addSubMove(n,i){var s=this;return M(function*(){if(s.currentSelection=g.empty(),s.indicators=[],s.subMoves.push(n),s.stateInConstruction=i,3===s.subMoves.length){const o=new Ts(s.subMoves[0],g.of(s.subMoves[1]),g.of(s.subMoves[2]));return s.chooseMove(o)}return s.showSubMove(n),b.SUCCESS})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i),c=s.stateInConstruction.getPieceAt(a);if(0===s.subMoves.length&&s.hideLastMove(),s.currentSelection.isPresent()){const l=s.currentSelection.get();return l.equals(a)?(s.currentSelection=g.empty(),s.indicators=[],0===s.subMoves.length?s.cancelMove():b.SUCCESS):s.stateInConstruction.getPieceAt(l).holdsBall?s.performPass(l,a):s.performTranslation(l,a)}return c.owner===s.getCurrentPlayer()?s.hasMadePass&&c.holdsBall?s.cancelMove(D0.CAN_ONLY_DO_ONE_PASS()):2===s.translationsMade&&!1===c.holdsBall?s.cancelMove(D0.CAN_ONLY_TRANSLATE_TWICE()):(s.currentSelection=g.of(a),s.indicators=c.holdsBall?s.moveGenerator.getPassEnds(s.stateInConstruction,a):s.moveGenerator.getTranslationEnds(s.stateInConstruction,a),b.SUCCESS):s.cancelMove(c.owner===q.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}performPass(n,i){const s=Os.from(n,i);if(s.isSuccess()){const o=this.rules.isLegalPass(this.stateInConstruction,s.get());return o.isSuccess()?(this.hasMadePass=!0,this.addSubMove(s.get(),o.get())):this.cancelMove(o.getReason())}return this.cancelMove(s.getReason())}performTranslation(n,i){const s=Ei.from(n,i);if(s.isSuccess()){const o=this.rules.isLegalTranslation(this.stateInConstruction,s.get());return o.isSuccess()?(this.translationsMade++,this.addSubMove(s.get(),o.get())):this.cancelMove(o.getReason())}return this.cancelMove(s.getReason())}showDoneButton(){return this.isInteractive&&this.subMoves.length>=1}done(){var n=this;return M(function*(){const i=yield n.canUserPlay("#done");if(i.isFailure())return n.cancelMove(i.getReason());let s=g.empty();n.subMoves.length>=2&&(s=g.of(n.subMoves[1]));const o=new Ts(n.subMoves[0],s,g.empty());return n.chooseMove(o)})()}getBoardRotation(){return`rotate(${180*this.getPointOfView().value} ${(this.getState().getWidth()*this.SPACE_SIZE+this.STROKE_WIDTH)/2} ${(this.getState().getHeight()*this.SPACE_SIZE+this.STROKE_WIDTH)/2})`}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-diaballik"]],features:[Ke],decls:10,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],[4,"ngFor","ngForOf"],["class","defeat-stroke normal-stroke",4,"ngFor","ngForOf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["id","done",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"defeat-stroke","normal-stroke"],[1,"indicator",3,"id","click"],["id","translationCountIndicator"],[1,"base"],[1,"base",3,"ngClass"],["marker-end","url(#arrowhead)",1,"arrow"],["id","translationCount",1,"base-no-stroke","text-giant"],["id","passCountIndicator"],["id","passCount",1,"base-no-stroke","text-giant"],["id","done",3,"click"],["fill","green",1,"base-no-fill","small-stroke"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","black",1,"base-no-fill","small-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P()(),S(4,"g"),O(5,tdt,2,1,"g",3),O(6,ndt,1,4,"line",4),O(7,rdt,1,7,"rect",5),P(),O(8,idt,17,50,"g",6),O(9,sdt,3,4,"g",7),P()),2&n&&(I("viewBox",i.getViewBox().toSVGString()),_(4),I("transform",i.getBoardRotation()),_(1),y("ngForOf",i.stateInConstruction.board),_(1),y("ngForOf",i.blockedLines),_(1),y("ngForOf",i.indicators),_(1),y("ngIf",i.isInteractive),_(1),y("ngIf",i.showDoneButton()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Ace extends Fn{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),i=this.getListShifts(t);return n.concat(i)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const s of[new j2(i,"clockwise"),new j2(i,"counterclockwise")])Wa.get().shiftHeightValidity(s,e).isSuccess()&&t.push(s);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<nr.WIDTH;i++)for(const s of t){const o=new y4(i,s);Wa.get().dropHeightValidity(o,e).isSuccess()&&n.push(o)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of Tn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<nr.HEIGHT;i++)for(let s=0;s<nr.WIDTH;s++)e.getPieceAtXY(s,i).owner===n&&t.push(new v(s,i));return t}}var KL;function adt(r,e){if(1&r){const t=pe();A(),S(0,"g",6)(1,"path",7),W("click",function(){const s=ne(t).$implicit;return re(p().onSpaceClick(s))}),P(),S(2,"path",8),W("click",function(){const s=ne(t).$implicit;return re(p().onSpaceClick(s))}),P()()}if(2&r){const t=e.$implicit,n=p();Dn("id","board_space_",t,""),_(1),Dn("id","click_",t,""),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),I("d",n.BOARD_PATHS[t]),_(1),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),I("d",n.DECORATION_PATHS[t])}}function cdt(r,e){if(1&r){const t=pe();A(),S(0,"g",10),W("click",function(){const s=ne(t).$implicit,o=p().$implicit;return re(p().onPieceInGameClick(o,s.y))}),V(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit;ve("id","click_",p().$implicit,"_",t.y,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),I("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),I("x",t.drawPosition.x)("y",t.drawPosition.y)}}function ldt(r,e){if(1&r&&(A(),S(0,"g"),O(1,cdt,3,8,"g",9),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function udt(r,e){if(1&r){const t=pe();A(),S(0,"g",14),W("click",function(){const i=ne(t),s=i.$implicit,o=i.index;return re(p(2).onRemainingPieceClick(s.actualPiece,o))}),V(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit,n=e.index;zi("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),I("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),I("x",t.drawPosition.x)("y",t.drawPosition.y)}}function fdt(r,e){if(1&r&&(A(),S(0,"g"),O(1,udt,3,9,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const ddt=function(){return[0,1,2,3,4,5,6,7]},hdt=function(){return[2,1,3,0,4,7,5,6]};class Kc extends jc{constructor(e){super(e),u(this,"BOARD_PATHS",["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"]),u(this,"DECORATION_PATHS",["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"]),u(this,"selected",g.empty()),u(this,"viewInfo",{boardInfo:[],remainingPieces:new Pn([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}])}),this.rules=Wa.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Dummy`,this.rules,new VL,new Ace),new On($localize`MCTS`,new Ace,this.rules)],this.encoder=_9t,this.tutorial=(new gce).tutorial}onSpaceClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return M(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new y4(e,n.piece);else if((n.position.x+1)%nr.WIDTH===e)i=new j2(n.position,"clockwise");else{if((n.position.x+(nr.WIDTH-1))%nr.WIDTH!==e)return t.cancelMove(Wd.MUST_SHIFT_TO_NEIGHBOR());i=new j2(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(Wd.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new v(e,t);return n.getState().getPieceAt(s).owner===n.getCurrentPlayer()?(n.isSelected(null,s)?yield n.cancelMoveAttempt():n.selected=g.of({type:"pieceFromBoard",position:s}),n.updateViewInfo(),b.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}onRemainingPieceClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentOpponent()?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selected=n.isSelected(e)?g.empty():g.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),b.SUCCESS)})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(e){var t=this;return M(function*(){t.updateViewInfo()})()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),s=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(i,s),a=new v(i,s);return[{start:g.empty(),end:a,startDrawPosition:n,endDrawPosition:o}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let s=t.getStackHeight(i);const o=[];for(let a=e.start.y;a<nr.HEIGHT&&t.getPieceAtXY(n,a)!==Tn.EMPTY;a++,s++)o.push({start:g.of(new v(n,a)),end:new v(i,s),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,s)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<nr.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){var t=this;return M(function*(){t.showLastMoveOnSpaces(e),t.showLastMoveOnPieces(e)})()}showLastMoveOnSpaces(e){for(let t=0;t<nr.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Pn([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of Tn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let s=0;s<i;s++){const o=[];this.isTopPieceOfReserveAndSelected(s,i,n)&&o.push("selected-stroke"),t&&s===i-1&&n.owner===e&&o.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),a.push({backgroundClasses:c,foregroundClasses:o,y:s,drawPosition:this.getDrawPositionRemainingPiece(n,s),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===k.ZERO?-100:600,i=e.otherPieceType?100:450,new v(n,i).getNext(new St(0,-t*Kc.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let s=0;s<nr.HEIGHT;s++){const o=this.getState().getPieceAtXY(e,s),a=new v(e,s);if(o!==Tn.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,s)&&c.push("selected-stroke"),this.isVictory(e,s,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:s,drawPosition:this.getDrawPositionOnBoard(e,s),actualPiece:o})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return Kc.CENTER[e].getNext(new St(0,-t*Kc.PIECE_HEIGHT))}cancelMoveAttempt(){var e=this;return M(function*(){e.selected=g.empty(),yield e.updateBoard(!1)})()}}KL=Kc,u(Kc,"CENTER",[new v(40,160),new v(100,50),new v(255,2),new v(400,50),new v(460,160),new v(400,270),new v(255,320),new v(100,270)]),u(Kc,"PIECE_HEIGHT",36),u(Kc,"\u0275fac",function(e){return new(e||KL)(U($t))}),u(Kc,"\u0275cmp",Be({type:KL,selectors:[["app-diam"]],features:[Ke],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),P()(),O(5,adt,3,6,"g",4),O(6,ldt,2,1,"g",5),O(7,fdt,2,1,"g",5),P()),2&e&&(_(5),y("ngForOf",D1(3,ddt)),_(1),y("ngForOf",D1(4,hdt)),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Dt,Wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class ko{static fromTwoCoords(e,t){const n=e.x,i=t.x,s=e.y,o=t.y,a=n+s,c=i+o;return n===i&&s!==o&&a!==c?g.of(ko.constantQ(n)):n!==i&&s===o&&a!==c?g.of(ko.constantR(s)):n!==i&&s!==o&&a===c?g.of(ko.constantS(a)):g.empty()}static constantQ(e){return new ko(e,"q")}static constantR(e){return new ko(e,"r")}static constantS(e){return new ko(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=ko.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){u(this,"offset",void 0),u(this,"constant",void 0),this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return Ne.DOWN;case"r":return Ne.RIGHT;case"s":return Ne.DOWN_LEFT}}}class XL extends L1{constructor(e,t,n,i,s,o){super(t,e),u(this,"width",void 0),u(this,"height",void 0),u(this,"excludedSpaces",void 0),u(this,"empty",void 0),this.width=n,this.height=i,this.excludedSpaces=s,this.empty=o,je(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(ko.constantQ(t));for(let t=0;t<this.height;t++)e.push(ko.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(ko.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new v(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new v(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new v(e.offset,0):new v(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const s=m2.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(s.getReason())}}class M2{static getNeighbors(e,t=1){const n=[];for(const i of Ne.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of Ne.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}var H0;class m1{static append(e,t){return new m1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){u(this,"owner",void 0),u(this,"size",void 0),u(this,"source",void 0),this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}H0=m1,u(m1,"encoder",we.tuple([we.identity(),k.encoder,we.identity()],r=>[r.source,r.owner,r.size],r=>new H0(r[1],r[2],r[0]))),u(m1,"MAX_SIZE",49),u(m1,"EMPTY",new H0(q.NONE,0,!1)),u(m1,"UNREACHABLE",new H0(q.NONE,-1,!1)),u(m1,"PLAYER_ZERO",new H0(k.ZERO,1,!1)),u(m1,"PLAYER_ONE",new H0(k.ONE,1,!1)),u(m1,"SOURCE",new H0(q.NONE,1,!0));let sa=(()=>{class r extends XL{static balancedBoard(){const t=m1.UNREACHABLE,n=m1.PLAYER_ZERO,i=m1.PLAYER_ONE,s=m1.SOURCE;return[[t,t,n,i,i,i,n,n,i,s,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,s,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,s,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==m1.UNREACHABLE}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,m1.EMPTY),u(this,"alreadyPassed",void 0),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const s=new v(i,n);this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()&&t.push(s)}return t}numberOfNeighbors(t){return M2.getNeighbors(t,1).filter(s=>this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()).length}setAtUnsafe(t,n){const i=xt.copy(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==m1.UNREACHABLE}}return u(r,"WIDTH",11),u(r,"HEIGHT",5),u(r,"EXCLUDED_SPACES",[2,1]),r})(),V0=(()=>{class r{}return u(r,"NOT_PLAYER_PIECE",()=>$localize`You must select a piece or a stack of your color.`),u(r,"EMPTY_STACK",()=>$localize`You must select a stack.`),u(r,"TOO_MANY_NEIGHBORS",()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`),u(r,"CANT_REACH_TARGET",()=>$localize`This stack cannot move because it could never land on another piece.`),u(r,"INVALID_MOVE_LENGTH",()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`),u(r,"EMPTY_TARGET_STACK",()=>$localize`The stack must land on an occupied space.`),u(r,"MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`A stack must move in a straight line.`),r})();var QL;class dr extends Qs{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?Q.success(dr.PASS):!1===sa.isOnBoard(e)?Q.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===sa.isOnBoard(t)?Q.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?Q.success(new dr(e,t)):Q.failure(V0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===dr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}u(dr,"PASS",new(QL=dr)(new v(-1,-1),new v(-2,-2))),u(dr,"encoder",qi.getFallibleEncoder(QL.from));class hr extends jn{static get(){return hr.singleton.isAbsent()&&(hr.singleton=g.of(new hr)),hr.singleton.get()}getInitialState(){return new sa(sa.balancedBoard(),0,!1)}static getGameStatus(e){const t=e.gameState,n=hr.getScores(t);return 0===hr.getMovablePieces(t).length?n[0]>n[1]?_e.ZERO_WON:n[0]<n[1]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static getMovablePieces(e){return hr.getFreePieces(e).filter(t=>hr.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==M2.getNeighbors(t,n).find(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return M2.getNeighbors(t,n).filter(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const s=e.getPieceAt(i);s.belongsTo(k.ZERO)?t+=s.getSize():s.belongsTo(k.ONE)&&(n+=s.getSize())}),[t,n]}isMovablePiece(e,t){je(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?b.failure(V0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?b.failure(V0.NOT_PLAYER_PIECE()):e.numberOfNeighbors(t)>=6?b.failure(V0.TOO_MANY_NEIGHBORS()):!1===hr.pieceHasTarget(e,t)?b.failure(V0.CANT_REACH_TARGET()):b.SUCCESS}canOnlyPass(e){return 0===hr.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){M2.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=xt.create(sa.WIDTH,sa.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,m1.EMPTY))}),n}applyLegalMove(e,t,n){if(e===dr.PASS)return new sa(t.board,t.turn+1,!0);{const i=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd()),o=t.setAt(e.getStart(),m1.EMPTY).setAt(e.getEnd(),m1.append(i,s));return this.removeDisconnectedPieces(new sa(o.board,t.turn+1,!1))}}isLegal(e,t){if(0===hr.getMovablePieces(t).length)return e===dr.PASS&&!1===t.alreadyPassed?b.SUCCESS:b.failure(Ee.MUST_PASS());if(e===dr.PASS)return b.failure(Ee.CANNOT_PASS());const n=this.isMovablePiece(t,e.getStart());if(n.isFailure())return n;const i=t.getPieceAt(e.getStart());return e.length()!==i.getSize()?Q.failure(V0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?Q.failure(V0.EMPTY_TARGET_STACK()):Q.success(void 0)}getGameStatus(e){return hr.getGameStatus(e)}}u(hr,"singleton",g.empty());const se=m1.EMPTY,rr=m1.UNREACHABLE,zl=m1.SOURCE,wu=m1.PLAYER_ZERO,Nu=m1.PLAYER_ONE,pdt=new m1(k.ZERO,2,!1),JL=new m1(k.ONE,2,!1),Ice=new m1(k.ZERO,4,!1),gdt=new m1(k.ONE,4,!1);class kce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,hr.get().getInitialState(),dr.from(new v(2,0),new v(3,0)).get(),$localize`Congratulations!`),j.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new sa([[rr,rr,Nu,zl,se,se,se,se,se,se,se],[rr,se,wu,se,se,se,se,se,se,se,se],[se,se,gdt,se,se,se,se,Nu,zl,se,se],[se,se,se,se,se,se,se,se,se,se,rr],[se,se,se,se,se,se,se,se,se,rr,rr]],0,!1),dr.from(new v(2,1),new v(2,0)).get(),(t,n,i)=>t.getEnd().equals(new v(3,0))?b.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(je(t.getEnd().equals(new v(2,0)),"player made an impossible move"),b.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),j.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new sa([[rr,rr,zl,Nu,se,se,se,se,se,se,se],[rr,wu,wu,se,se,se,se,se,se,se,se],[se,Nu,wu,Nu,se,se,wu,JL,zl,se,se],[se,se,Nu,se,se,se,se,se,se,se,rr],[se,se,se,se,se,se,se,se,se,rr,rr]],0,!1),dr.from(new v(2,1),new v(2,0)).get(),(t,n,i)=>t.getEnd().equals(new v(2,0))?b.SUCCESS:b.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),j.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new sa([[rr,rr,zl,se,se,se,se,se,se,se,se],[rr,se,pdt,se,se,se,se,se,se,se,se],[se,se,JL,se,se,se,se,JL,zl,Ice,se],[se,se,se,se,se,se,se,se,se,se,rr],[se,se,se,se,se,se,se,se,se,rr,rr]],0,!1)),j.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new sa([[rr,rr,zl,se,se,se,se,se,se,se,se],[rr,se,wu,se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se,zl,Ice,se],[se,se,se,se,se,se,se,se,se,se,rr],[se,se,se,se,se,se,se,se,se,rr,rr]],0,!1),[dr.from(new v(2,1),new v(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)])}}class mdt extends tr{getMetrics(e){return hr.getScores(e.gameState)}}class xce extends Fn{getListMoves(e){const t=e.previousMove,n=e.gameState,i=[];return hr.getMovablePieces(n).forEach(s=>hr.pieceTargets(n,s).forEach(o=>{const a=dr.from(s,o).get();i.push(a)})),0===i.length&&!1===t.equalsValue(dr.PASS)&&i.push(dr.PASS),i}}class Lce extends xce{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),i=t.getCurrentOpponent();return qt.sortByDescending(n,s=>{je(s!==dr.PASS,"Cannot sort with DvonnMove.PASS");const o=t.getPieceAt(s.getEnd());return o.belongsTo(i)?o.getSize():0}),n}}class _dt extends tr{getMetrics(e){const t=e.gameState,n=hr.getScores(t),i=t.getAllPieces(),s=i.length;for(const o of k.PLAYERS){const a=i.filter(c=>t.getPieceAt(c).belongsTo(o)).length;n[o.value]=n[o.value]*a/s}return n}}function vdt(r,e){if(1&r&&(A(),V(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();ve("id","piece_",n.x,"_",n.y,""),y("ngClass",i.getPieceClasses(t)),I("cx",i.getCenterAt(n).x)("cy",i.getCenterAt(n).y)("r",i.SPACE_SIZE)}}function Cdt(r,e){if(1&r&&(A(),V(0,"polygon",12)),2&r){const t=p().$implicit,n=p().$implicit,i=p();I("transform",1===t.getSize()?"translate("+(i.getCenterAt(n).x-18)+" "+(i.getCenterAt(n).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(n).x-3)+" "+(i.getCenterAt(n).y-12)+") scale(0.07)")}}function ydt(r,e){if(1&r){const t=pe();A(),S(0,"text",13),W("click",function(){ne(t);const i=p(2).$implicit;return re(p().onClick(i.x,i.y))}),ct(1),P()}if(2&r){const t=p().$implicit,n=p().$implicit,i=p();I("x",t.containsSource()?i.getCenterAt(n).x-7:i.getCenterAt(n).x)("y",i.getCenterAt(n).y),_(1),mn(t.getSize())}}function Mdt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){ne(t);const i=p().$implicit;return re(p().onClick(i.x,i.y))}),V(1,"polygon",7),O(2,vdt,1,6,"circle",8),O(3,Cdt,1,1,"polygon",9),O(4,ydt,2,3,"text",10),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();ve("id","click_",n.x,"_",n.y,""),_(1),I("points",i.getHexaPointsAt(n)),_(1),y("ngIf",t.getSize()>0),_(1),y("ngIf",t.containsSource()),_(1),y("ngIf",t.getSize()>1)}}const Edt=function(r){return[r]};function Sdt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Mdt,5,6,"g",5),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",wa(1,Edt,n.state.getPieceAt(t)))}}function Pdt(r,e){if(1&r&&(A(),S(0,"text",18),ct(1),P()),2&r){const t=p().$implicit,n=p();I("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),_(1),mn(t.spaceContent.getSize())}}function Odt(r,e){if(1&r&&(A(),S(0,"g",14),V(1,"polygon",15)(2,"circle",16),O(3,Pdt,2,3,"text",17),P()),2&r){const t=e.$implicit,n=p();ve("id","disconnected_",t.coord.x,"_",t.coord.y,""),_(1),I("points",n.getHexaPointsAt(t.coord)),_(1),ve("id","captured_",t.coord.x,"_",t.coord.y,""),y("ngClass",n.getPieceClasses(t.spaceContent)),I("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),_(1),y("ngIf",t.spaceContent.getSize()>1)}}function Tdt(r,e){if(1&r&&(A(),Gt(0),V(1,"polygon",19)(2,"polygon",19),Ut()),2&r){const t=p();_(1),I("points",t.getHexaPointsAt(t.lastMove.get().getStart())),_(1),I("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function bdt(r,e){if(1&r&&(A(),V(0,"polygon",20)),2&r){const t=p();ve("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),I("points",t.getHexaPointsAt(t.chosen.get()))}}let wdt=(()=>{var r;class e extends mu{constructor(n){super(n),u(this,"lastMove",g.empty()),u(this,"chosen",g.empty()),u(this,"disconnecteds",[]),u(this,"state",void 0),this.rules=hr.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Stacks`,this.rules,new _dt,new Lce),new cn($localize`Score`,this.rules,new mdt,new Lce),new On($localize`MCTS`,new xce,this.rules)],this.encoder=dr.encoder,this.tutorial=(new kce).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=g.of(hr.getScores(this.getState())),this.hexaLayout=new _u(1.5*this.SPACE_SIZE,new v(-this.SPACE_SIZE,2*this.SPACE_SIZE),mC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=g.empty()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.state=i.getState(),i.disconnecteds=[],i.hideLastMove(),i.canPass=i.rules.canOnlyPass(i.state),i.scores=g.of(hr.getScores(i.state))})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=g.of(n);const s=i.getPreviousState(),o=i.getState();for(let a=0;a<o.board.length;a++)for(let c=0;c<o.board[a].length;c++){const l=new v(c,a);if(!0===o.isOnBoard(l)&&!1===l.equals(i.lastMove.get().getStart())){const f=o.getPieceAt(l),d=s.getPieceAt(l);if(f.isEmpty()&&d.hasPieces()){const E={coord:new v(c,a),spaceContent:d};i.disconnecteds.push(E)}}}})()}cancelMoveAttempt(){this.chosen=g.empty()}pass(){var n=this;return M(function*(){return je(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(dr.PASS)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.chosen.isAbsent()?s.choosePiece(n,i):s.chosen.equalsValue(new v(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):yield s.chooseDestination(n,i)})()}choosePiece(n,i){var s=this;return M(function*(){const o=new v(n,i),a=s.rules.isMovablePiece(s.getState(),o);return a.isSuccess()?(s.chosen=g.of(o),b.SUCCESS):s.cancelMove(a.getReason())})()}chooseDestination(n,i){var s=this;return M(function*(){const o=s.getState(),a=s.chosen.get(),c=new v(n,i),l=dr.from(a,c);return l.isFailure()?s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.cancelMove(l.getReason()):s.rules.isLegal(l.get(),o).isFailure()&&s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.chooseMove(l.get())})()}getPieceClasses(n){if(n.containsSource()&&1===n.getSize())return["nonplayer-fill","dashed-stroke"];const i=this.getPlayerClass(n.getOwner());return n.containsSource()?[i,"nonplayer-stroke","dashed-stroke"]:[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-dvonn"]],features:[Ke],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Sdt,2,3,"g",1),O(2,Odt,4,10,"g",2),O(3,Tdt,3,2,"ng-container",3),O(4,bdt,1,3,"polygon",4),P()),2&n&&(_(1),y("ngForOf",i.state.allCoords()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.lastMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var E4,R1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(R1||{});class Ue{static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===k.ZERO&&e===R1.BIG?Ue.BIG_DARK:t===k.ZERO&&e===R1.MEDIUM?Ue.MEDIUM_DARK:t===k.ZERO&&e===R1.SMALL?Ue.SMALL_DARK:t===k.ONE&&e===R1.BIG?Ue.BIG_LIGHT:t===k.ONE&&e===R1.MEDIUM?Ue.MEDIUM_LIGHT:t===k.ONE&&e===R1.SMALL?Ue.SMALL_LIGHT:Ue.NONE}constructor(e){u(this,"value",void 0),this.value=e}getPlayer(){switch(this){case Ue.SMALL_DARK:case Ue.MEDIUM_DARK:case Ue.BIG_DARK:return k.ZERO;case Ue.SMALL_LIGHT:case Ue.MEDIUM_LIGHT:case Ue.BIG_LIGHT:return k.ONE;default:return q.NONE}}getSize(){switch(this){case Ue.BIG_DARK:case Ue.BIG_LIGHT:return R1.BIG;case Ue.MEDIUM_DARK:case Ue.MEDIUM_LIGHT:return R1.MEDIUM;case Ue.SMALL_DARK:case Ue.SMALL_LIGHT:return R1.SMALL;default:return B.expectToBe(this,Ue.NONE),R1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case Ue.BIG_DARK:return"BIG_DARK";case Ue.BIG_LIGHT:return"BIG_LIGHT";case Ue.MEDIUM_DARK:return"MEDIUM_DARK";case Ue.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Ue.SMALL_DARK:return"SMALL_DARK";case Ue.SMALL_LIGHT:return"SMALL_LIGHT";default:return B.expectToBe(this,Ue.NONE),"EMPTY"}}}E4=Ue,u(Ue,"encoder",we.tuple([we.identity()],r=>[r.value],r=>E4.of(r[0]))),u(Ue,"SMALL_DARK",new E4(0)),u(Ue,"SMALL_LIGHT",new E4(1)),u(Ue,"MEDIUM_DARK",new E4(2)),u(Ue,"MEDIUM_LIGHT",new E4(3)),u(Ue,"BIG_DARK",new E4(4)),u(Ue,"BIG_LIGHT",new E4(5)),u(Ue,"NONE",new E4(6));class jd extends L1{constructor(e,t,n){super(e,t),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPieces(){return qt.copy(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class K2{constructor(e,t,n){u(this,"small",void 0),u(this,"medium",void 0),u(this,"big",void 0),this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===q.NONE&&this.medium===q.NONE&&this.big===q.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(Ue.ofSizeAndPlayer(R1.SMALL,this.small)),this.medium.isPlayer()&&e.push(Ue.ofSizeAndPlayer(R1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Ue.ofSizeAndPlayer(R1.BIG,this.big)),e}toOrderedPieceNames(){const e=Ue.ofSizeAndPlayer(R1.SMALL,this.small),t=Ue.ofSizeAndPlayer(R1.MEDIUM,this.medium),n=Ue.ofSizeAndPlayer(R1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===k.ZERO?Ue.BIG_DARK:this.big===k.ONE?Ue.BIG_LIGHT:this.medium===k.ZERO?Ue.MEDIUM_DARK:this.medium===k.ONE?Ue.MEDIUM_LIGHT:this.small===k.ZERO?Ue.SMALL_DARK:this.small===k.ONE?Ue.SMALL_LIGHT:Ue.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===Ue.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?g.of(this.put(e)):g.empty()}removeBiggest(){const e=this.getBiggest();if(e===Ue.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case R1.BIG:t=new K2(this.small,this.medium,q.NONE);break;case R1.MEDIUM:t=new K2(this.small,q.NONE,q.NONE);break;default:B.expectToBe(n,R1.SMALL),t=new K2(q.NONE,q.NONE,q.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===Ue.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case R1.BIG:return new K2(this.small,this.medium,t);case R1.MEDIUM:return je(this.big===q.NONE,"Cannot put a piece on top of a bigger one"),new K2(this.small,t,this.big);default:return B.expectToBe(n,R1.SMALL),je(this.big===q.NONE,"Cannot put a piece on top of a bigger one"),je(this.medium===q.NONE,"Cannot put a piece on top of a bigger one"),new K2(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}u(K2,"EMPTY",new K2(q.NONE,q.NONE,q.NONE));let Zd=(()=>{class r{}return u(r,"PIECE_OUT_OF_STOCK",()=>$localize`You do not have pieces of this type anymore.`),u(r,"INVALID_PLACEMENT",()=>$localize`You must put your piece on an empty square or on a smaller piece.`),u(r,"NOT_DROPPABLE",()=>$localize`You must pick your piece among the remaining ones.`),u(r,"INVALID_PIECE_SELECTED",()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`),u(r,"END_YOUR_MOVE",()=>$localize`You are performing a move, you must select a landing square.`),r})();var Yd,qa;let F0=(Yd=class extends jn{static get(){return qa.singleton.isAbsent()&&(qa.singleton=g.of(new qa)),qa.singleton.get()}getInitialState(){const e=new K2(q.NONE,q.NONE,q.NONE),t=xt.create(3,3,e);return new jd(t,0,[Ue.BIG_DARK,Ue.BIG_DARK,Ue.BIG_LIGHT,Ue.BIG_LIGHT,Ue.MEDIUM_DARK,Ue.MEDIUM_DARK,Ue.MEDIUM_LIGHT,Ue.MEDIUM_LIGHT,Ue.SMALL_DARK,Ue.SMALL_DARK,Ue.SMALL_LIGHT,Ue.SMALL_LIGHT])}static isVictory(e){const t=e.getCopiedBoard();for(const n of qa.LINES){const s=qa.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(s.isPresent())return s}return g.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===q.NONE?g.empty():n[0]===n[1]&&n[1]===n[2]?g.of(n[0]):g.empty()}static isLegal(e,t){let n;if(e.isDropping()){n=e.piece.get();const o=n.getPlayer();if(o===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(o===t.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===t.isInRemainingPieces(n))return Q.failure(Zd.PIECE_OUT_OF_STOCK())}else{const o=e.startingCoord.get();n=t.getPieceAt(o).getBiggest();const c=n.getPlayer();if(c===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(c===t.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}const s=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return s.isPresent()?Q.success(s.get()):Q.failure(Zd.INVALID_PLACEMENT())}isLegal(e,t){return qa.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();let s=t.getRemainingPieces();const o=t.turn+1;let a;if(i[e.landingCoord.y][e.landingCoord.x]=n,e.isDropping()){a=e.piece.get();const l=s.indexOf(a);s=s.slice(0,l).concat(s.slice(l+1))}else{const l=e.startingCoord.get(),d=i[l.y][l.x].removeBiggest();i[l.y][l.x]=d.removedSpace,a=d.removedPiece}return new jd(i,o,s)}static getGameStatus(e){const n=qa.isVictory(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getGameStatus(e){return qa.getGameStatus(e)}},qa=Yd,u(Yd,"singleton",g.empty()),u(Yd,"LINES",[[new v(0,0),new v(0,1),new v(0,2)],[new v(1,0),new v(1,1),new v(1,2)],[new v(2,0),new v(2,1),new v(2,2)],[new v(0,0),new v(1,0),new v(2,0)],[new v(0,1),new v(1,1),new v(2,1)],[new v(0,2),new v(1,2),new v(2,2)],[new v(0,0),new v(1,1),new v(2,2)],[new v(0,2),new v(1,1),new v(2,0)]]),Yd);var zce;F0=qa=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],F0);class E2 extends vi{constructor(e,t,n){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"piece",void 0),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return B.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new E2(g.of(e),t,g.empty())}static ofDrop(e,t){return new E2(g.empty(),t,g.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}zce=E2,u(E2,"encoder",we.tuple([g.getEncoder(v.encoder),v.encoder,g.getEncoder(Ue.encoder)],r=>[r.startingCoord,r.landingCoord,r.piece],r=>new zce(r[0],r[1],r[2])));const ws=new K2(q.NONE,q.NONE,q.NONE),Dce=new K2(k.ZERO,q.NONE,q.NONE),Adt=new K2(q.NONE,k.ZERO,q.NONE),Idt=new K2(q.NONE,q.NONE,k.ZERO),Hce=new K2(k.ONE,q.NONE,q.NONE),OC=new K2(q.NONE,q.NONE,k.ONE),kdt=new K2(k.ONE,k.ZERO,q.NONE),xdt=new K2(k.ZERO,k.ZERO,q.NONE);class Vce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new jd([[Dce,Hce,OC],[ws,Adt,ws],[ws,ws,Idt]],0,[Ue.SMALL_DARK,Ue.MEDIUM_DARK,Ue.BIG_DARK,Ue.SMALL_LIGHT,Ue.MEDIUM_LIGHT,Ue.MEDIUM_LIGHT,Ue.BIG_LIGHT])),j.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,F0.get().getInitialState(),E2.ofDrop(Ue.SMALL_DARK,new v(1,1)),$localize`Congratulations!`),j.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new jd([[Dce,OC,ws],[ws,ws,ws],[ws,ws,ws]],0,[]),[E2.ofMove(new v(0,0),new v(2,0)),E2.ofMove(new v(0,0),new v(0,1)),E2.ofMove(new v(0,0),new v(1,1)),E2.ofMove(new v(0,0),new v(2,1)),E2.ofMove(new v(0,0),new v(0,2)),E2.ofMove(new v(0,0),new v(1,2)),E2.ofMove(new v(0,0),new v(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new jd([[kdt,ws,Hce],[xdt,OC,OC],[ws,ws,ws]],0,[Ue.MEDIUM_DARK,Ue.BIG_DARK,Ue.MEDIUM_LIGHT,Ue.MEDIUM_LIGHT]),E2.ofMove(new v(0,1),new v(0,2)),(t,n,i)=>{if(t.landingCoord.equals(new v(0,2))){if(t.isDropping())return b.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new v(0,1)))return b.SUCCESS}return b.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)])}}class Fce extends Fn{getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getCurrentPlayer(),o=Tae.toComparableObjectSet(n.getPlayerRemainingPieces());for(let a=0;a<3;a++)for(let c=0;c<3;c++){const l=new v(c,a);for(const f of o){const d=E2.ofDrop(f,l);F0.isLegal(d,n).isSuccess()&&t.push(d)}if(i[a][c].belongsTo(s))for(let f=0;f<3;f++)for(let d=0;d<3;d++){const m=new v(d,f);if(!1===m.equals(l)){const E=E2.ofMove(l,m);F0.isLegal(E,n).isSuccess()&&t.push(E)}}}return t}}function Ldt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",5),W("click",function(){const i=ne(t),s=i.$implicit,o=i.index,a=p().$implicit;return re(p().onPieceClick(a.value,s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();_(1),zi("id","piece_",i.value,"_",t.toString(),"_",n,""),y("ngClass",s.getSidePieceClasses(t,n)),I("transform","rotate("+180*(s.getPointOfView().value+i.value)+" "+s.CENTER+" "+s.CENTER+")")("r",s.getPieceRadius(t))("cx",s.getRemainingPieceCenterCoord(i,n).x)("cy",s.getRemainingPieceCenterCoord(i,n).y)}}function Rdt(r,e){if(1&r&&(A(),S(0,"g",null,4),O(2,Ldt,2,8,"g",1),P()),2&r){const t=e.$implicit,n=p();_(2),y("ngForOf",n.getRemainingPieces(t))}}function zdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",8),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().onBoardClick(i,s))}),P()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,s=p();y("ngClass",s.getPieceClasses(t)),I("r",s.getPieceRadius(t))("cx",s.getPieceCenter(n))("cy",s.getPieceCenter(i))}}function Ddt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",6),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onBoardClick(s,o))}),P(),O(2,zdt,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","click_",n,"_",i,""),y("ngClass",s.getRectClasses(n,i)),I("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngForOf",s.getListPieces(t))}}function Hdt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Ddt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Vdt(r,e){if(1&r){const t=pe();A(),S(0,"rect",9),W("click",function(){ne(t);const i=p();return re(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),P()}if(2&r){const t=p();ve("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let Fdt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"CENTER",this.getPieceCenter(1)),u(this,"UPLEFT",-(this.SPACE_SIZE+.5*this.STROKE_WIDTH)),u(this,"WIDTH",5*this.SPACE_SIZE+3*this.STROKE_WIDTH),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenPiece",g.empty()),u(this,"chosenPieceIndex",void 0),u(this,"remainingPieceCenterCoords",new Pn),this.rules=F0.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Dummy`,this.rules,new VL,new Fce),new On($localize`MCTS`,new Fce,this.rules)],this.encoder=E2.encoder,this.tutorial=(new Vce).tutorial}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard();const o=i.node.previousMove;i.calculateLeftPieceCoords(),o.isPresent()?(i.lastLandingCoord=g.of(o.get().landingCoord),i.lastStartingCoord=o.get().startingCoord):(i.lastLandingCoord=g.empty(),i.lastStartingCoord=g.empty())})()}getListPieces(n){return n.toList()}getRemainingPieces(n){return this.getState().getRemainingPiecesOfPlayer(n)}onBoardClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=g.of(a),s.chosenPiece.isPresent()){const l=E2.ofDrop(s.chosenPiece.get(),a);return s.chooseMove(l)}return!1===c.getPieceAt(a).belongsTo(c.getCurrentPlayer())?s.cancelMove(Zd.INVALID_PIECE_SELECTED()):b.SUCCESS}if(s.chosenCoord.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const l=E2.ofMove(s.chosenCoord.get(),a);return s.chooseMove(l)}})()}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.chosenPiece=g.empty(),this.chosenPieceIndex=g.empty()}onPieceClick(n,i,s){var o=this;return M(function*(){const a="#piece_"+n+"_"+i.toString()+"_"+s,c=yield o.canUserPlay(a);return c.isFailure()?o.cancelMove(c.getReason()):!1===o.getState().isDroppable(i)?o.cancelMove(Zd.NOT_DROPPABLE()):o.chosenCoord.isAbsent()?(o.chosenPiece.equalsValue(i)&&o.chosenPieceIndex.equalsValue(s)?(o.chosenPiece=g.empty(),o.chosenPieceIndex=g.empty()):(o.chosenPiece=g.of(i),o.chosenPieceIndex=g.of(s)),b.SUCCESS):o.cancelMove(Zd.END_YOUR_MOVE())})()}getRectClasses(n,i){return this.isSelected(n,i)?"moved-fill":""}isSelected(n,i){const s=new v(n,i);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(n){return[this.getPieceStrokeClass(n)]}getPieceCenter(n){return this.SPACE_SIZE*n+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(n){const i=n.getPlayer();return je(i.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+i.value+"-stroke"}getPieceRadius(n){switch(n.getSize()){case R1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case R1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return B.expectToBe(n.getSize(),R1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(n,i){const s=this.getPieceClasses(n);return this.isSelectedPiece(n)&&this.chosenPieceIndex.equalsValue(i)&&s.push("selected-stroke"),s}isSelectedPiece(n){return this.chosenPiece.equalsValue(n)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Pn;for(const n of k.PLAYERS){const i=[],s=this.getRemainingPieces(n);for(let o=0;o<s.length;o++){let a,c=0,l=0;o<=2?(a=new v(2-o,3),l=this.STROKE_WIDTH):(a=new v(-1,5-o),c=-this.STROKE_WIDTH);const f=this.getPieceCenter(a.x),d=this.getPieceCenter(a.y);i.push(new v(f+c,d+l))}this.remainingPieceCenterCoords.set(n,i)}}getRemainingPieceCenterCoord(n,i){return this.remainingPieceCenterCoords.get(n).get()[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-encapsule"]],features:[Ke],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Rdt,3,1,"g",1),S(2,"g",null,2),O(4,Hdt,2,1,"g",1),O(5,Vdt,1,6,"rect",3),P()()),2&n&&(I("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),_(1),y("ngForOf",i.Player.PLAYERS),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),kn=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}count(t,n){let i=0;for(let s=0;s<14;s++)this.board[n][s]===t&&i++;return i}doesOwnPiece(t){for(const n of this.getCoordsAndContents())if(n.content===t)return!0;return!1}}return u(r,"WIDTH",14),u(r,"HEIGHT",12),r})();var $ce;class oa extends Ar{constructor(e,t,n,i,s){super(e,t),u(this,"movedPieces",void 0),u(this,"stepSize",void 0),u(this,"direction",void 0),this.movedPieces=n,this.stepSize=i,this.direction=s,B.assert(kn.isOnBoard(this.coord),"Illegal coord outside of board "+this.coord.toString()+"."),B.assert(n>0,"Must select minimum one piece (got "+n+")."),B.assert(i>0,"Step size must be minimum one (got "+i+")."),B.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}$ce=oa,u(oa,"encoder",we.tuple([v.encoder,we.identity(),we.identity(),ye.encoder],r=>[r.coord,r.movedPieces,r.stepSize,r.direction],r=>new $ce(r[0].x,r[0].y,r[1],r[2],r[3])));let aa=(()=>{class r{}return u(r,"PHALANX_IS_LEAVING_BOARD",()=>$localize`The move distance of your phalanx puts it out of the board.`),u(r,"SOMETHING_IN_PHALANX_WAY",()=>$localize`There is something in the way of your phalanx.`),u(r,"PHALANX_SHOULD_BE_GREATER_TO_CAPTURE",()=>$localize`Your phalanx must be bigger than the one you are capturing.`),u(r,"SQUARE_NOT_ALIGNED_WITH_SELECTED",()=>$localize`This square is not aligned with the selected piece.`),u(r,"SINGLE_PIECE_MUST_MOVE_BY_ONE",()=>$localize`A single piece can only move by one square.`),u(r,"SINGLE_PIECE_CANNOT_CAPTURE",()=>$localize`A single piece cannot make a capture.`),u(r,"SQUARE_NOT_ALIGNED_WITH_PHALANX",()=>$localize`This square is not aligned with the direction of the phalanx.`),u(r,"PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD",()=>$localize`A phalanx can't contain pieces outside of the board.`),u(r,"PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE",()=>$localize`A phalanx cannot contain an empty square.`),u(r,"PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE",()=>$localize`A phalanx cannot contain a piece of the opponent.`),r})();class S2 extends jn{static get(){return S2.singleton.isAbsent()&&(S2.singleton=g.of(new S2)),S2.singleton.get()}constructor(){super()}getInitialState(){const e=q.NONE,t=q.ZERO,n=q.ONE;return new kn([[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return Q.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const s=xt.copy(i.get()),o=t.getCurrentOpponent(),a=S2.getCaptureValidity(t,s,e,o);return a.isFailure()?a:Q.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord,i=0;const s=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===kn.isOnBoard(n))return b.failure(aa.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=e.getPieceAt(n);if(o===q.NONE)return b.failure(aa.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===s)return b.failure(aa.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return b.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let s=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[s.y][s.x]=q.NONE,n[o.y][o.x]=i,!1===kn.isOnBoard(o))return Q.failure(aa.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o).isPlayer())return Q.failure(aa.SOMETHING_IN_PHALANX_WAY());a++,o=o.getNext(t.direction,1),s=s.getNext(t.direction,1)}return!1===kn.isOnBoard(o)?Q.failure(aa.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===i?Q.failure(Ee.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[s.y][s.x]=q.NONE,n[o.y][o.x]=i,Q.success(n))}static getCaptureValidity(e,t,n,i){let s=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),o=0;for(;kn.isOnBoard(s)&&e.getPieceAt(s)===i;){if(o>0&&(t[s.y][s.x]=q.NONE),o++,o>=n.movedPieces)return Q.failure(aa.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());s=s.getNext(n.direction,1)}return Q.success(t)}isLegal(e,t){return S2.isLegal(e,t)}applyLegalMove(e,t,n){return new kn(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(k.ZERO,0),i=t.count(k.ONE,kn.HEIGHT-1);if(t.turn%2==0){if(n>i)return _e.ZERO_WON}else if(i>n)return _e.ONE_WON;return!1===t.doesOwnPiece(k.ZERO)?_e.ONE_WON:!1===t.doesOwnPiece(k.ONE)?_e.ZERO_WON:_e.ONGOING}}u(S2,"singleton",g.empty());const T=q.NONE,q1=q.ZERO,o1=q.ONE;class Bce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,S2.get().getInitialState()),j.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new kn([[T,T,T,T,T,q1,T,T,o1,o1,o1,o1,o1,o1],[T,T,T,T,T,q1,T,T,T,T,T,T,o1,o1],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,o1,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,q1,q1,q1,q1,T,T,T]],0)),j.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new kn([[T,T,T,T,T,q1,T,T,T,T,o1,o1,o1,o1],[T,T,T,T,T,q1,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,o1,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,o1,o1,T,T,T,q1,q1,T,q1,q1,q1,q1]],1)),j.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,S2.get().getInitialState(),new oa(0,10,1,1,ye.UP),(t,n,i)=>1===t.movedPieces?b.SUCCESS:b.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),j.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,S2.get().getInitialState(),new oa(0,11,2,1,ye.UP),(t,n,i)=>t.movedPieces>1?b.SUCCESS:b.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),j.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new kn([[T,T,T,T,T,T,T,T,o1,o1,o1,o1,o1,o1],[T,T,T,T,T,T,o1,T,T,T,T,T,T,T],[T,T,T,T,T,o1,T,T,T,T,T,T,T,T],[T,T,o1,T,o1,T,T,T,T,T,T,T,T,T],[T,T,o1,o1,T,T,T,T,T,T,T,T,T,T],[T,T,o1,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,q1,T,T,T,T,T,T,T,T,T,T,T],[T,T,q1,T,T,T,T,o1,T,T,T,T,T,T],[T,T,q1,T,T,T,T,T,T,T,T,T,T,T],[T,T,q1,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,q1,q1,q1,q1,q1,q1,q1]],0),[new oa(2,10,4,2,ye.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)])}}class Gce extends Fn{getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),i=q.NONE;let s=[];const o=e.gameState;for(const a of o.getCoordsAndContents()){const c=a.coord;if(a.content===t){let l;for(const f of ye.DIRECTIONS){let d=1,m=c.getNext(f,1);for(;kn.isOnBoard(m)&&o.getPieceAt(m)===t;)d+=1,m=m.getNext(f,1);let E=1;for(;kn.isOnBoard(m)&&E<=d&&o.getPieceAt(m)===i;)l=new oa(c.x,c.y,d,E,f),s=this.addMove(s,l,o),E++,m=m.getNext(f,1);kn.isOnBoard(m)&&E<=d&&o.getPieceAt(m)===n&&(l=new oa(c.x,c.y,d,E,f),s=this.addMove(s,l,o))}}}return s}addMove(e,t,n){return S2.isLegal(t,n).isSuccess()&&e.push(t),e}}class Uce extends Fa{getBoardValue(e){return new Jn(this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){const t=13*kn.WIDTH*11;let o=0;for(let a=0;a<kn.HEIGHT;a++){let c=0;const l=[0,0];for(let f=0;f<kn.WIDTH;f++){const d=new v(f,a),m=e.getPieceAt(d);if(m.isPlayer()){const E=m.getScoreModifier();o+=t*E,l[m.value]=E,c+=E;for(const w of[ye.UP_LEFT,ye.UP,ye.UP_RIGHT]){let R=d.getNext(w,1);for(;kn.isOnBoard(R)&&e.getPieceAt(R)===m;)o+=1*E,R=R.getNext(w,1)}}}0!==c&&(o+=Math.abs(c)/c*2),o+=1*l.reduce((f,d)=>f+d)}return o}}class $dt extends Uce{constructor(...e){super(...e),u(this,"DOMINANCE_FACTOR",20),u(this,"DEFENSE_FACTOR",5),u(this,"TERRITORY_FACTOR",2),u(this,"OFFENSE_FACTOR",10),u(this,"CENTER_FACTOR",5),u(this,"MOBILITY_FACTOR",.12)}getBoardValue(e){const t=e.gameState,n=this.getDominance(t),i=this.getDefense(t),s=this.getTerritory(t),o=this.getCenter(t),a=this.getOffense(t),c=this.getMobility(t);return new Jn(n+i+s+o+a+c)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<kn.WIDTH;n++)e.getPieceAtXY(n,kn.HEIGHT-1)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(n,0)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){const a=n.coord.getNext(new v(s,o),1);if(kn.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===q.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<kn.WIDTH;n++)e.getPieceAtXY(n,0)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(n,kn.HEIGHT-1)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const n=(kn.WIDTH-1)/2;for(const i of e.getCoordsAndContents()){const s=i.content;s.isPlayer()&&(t+=s.getScoreModifier()*Math.abs(i.coord.x-n))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const s of e.getCoordsAndContents()){const o=s.coord,a=s.content;if(a.isPlayer())for(const c of ye.DIRECTIONS){let l=1,f=o.getNext(c,1);for(;kn.isOnBoard(f)&&e.getPieceAt(f)===a;)l+=1,f=f.getNext(c,1);let d=1;for(;kn.isOnBoard(f)&&d<=l&&e.getPieceAt(f)===q.NONE;)d++,f=f.getNext(c,1);t+=d*d*a.getScoreModifier(),a===k.ZERO?n=Math.max(n,d):a===k.ONE&&(i=Math.max(i,d))}}return(t+n*k.ZERO.getScoreModifier()+i*k.ONE.getScoreModifier())*this.MOBILITY_FACTOR}}class eR extends Gce{getListMoves(e){const t=super.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return qt.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}}class Bdt extends cn{constructor(){super($localize`Attack`,S2.get(),new $dt,new eR)}}class Gdt extends Fa{getBoardValue(e){return new Jn(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const n=28*kn.WIDTH+1,s=444*n+1;let o=0;for(const a of e.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer()){let f,d;l===k.ZERO?(f=kn.HEIGHT-c.y,d=[ye.UP_LEFT,ye.UP,ye.UP_RIGHT]):(f=c.y+1,d=[ye.DOWN_LEFT,ye.DOWN,ye.DOWN_RIGHT]);const m=l.getScoreModifier();o+=f*m,o+=s*m;for(const E of d){let w=c.getNext(E,1);for(;kn.isOnBoard(w)&&e.getPieceAt(w)===l;)o+=m*n,w=w.getNext(E,1)}}}return o}}class Udt extends cn{constructor(){super($localize`Positional`,S2.get(),new Gdt,new eR)}}class Wdt extends cn{constructor(){super($localize`Minimax`,S2.get(),new Uce,new eR)}}function qdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",4),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().onClick(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClasses(t,n)),I("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function jdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",2),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P(),O(2,qdt,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ve("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*n+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.NONE)}}function Zdt(r,e){if(1&r&&(A(),S(0,"g"),O(1,jdt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Ydt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",5),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),I("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Kdt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"NONE",q.NONE),u(this,"firstPiece",g.empty()),u(this,"validExtensions",[]),u(this,"phalanxValidLandings",[]),u(this,"lastPiece",g.empty()),u(this,"phalanxDirection",g.empty()),u(this,"phalanxMiddles",[]),u(this,"moveds",[]),u(this,"capturedCoords",[]),this.hasAsymmetricBoard=!0,this.rules=S2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Wdt,new Udt,new Bdt,new On($localize`MCTS`,new Gce,this.rules)],this.encoder=oa.encoder,this.tutorial=(new Bce).tutorial}updateBoard(n){var i=this;return M(function*(){i.firstPiece=g.empty(),i.lastPiece=g.empty(),i.hideLastMove(),i.board=i.getState().getCopiedBoard()})()}showLastMove(n){var i=this;return M(function*(){let s=n.coord;i.moveds=[s];for(let c=1;c<n.stepSize+n.movedPieces;c++)s=s.getNext(n.direction,1),i.moveds.push(s);const o=i.node.parent.get(),a=o.gameState.getCurrentOpponent();for(;kn.isOnBoard(s)&&o.gameState.getPieceAt(s)===a;)i.capturedCoords.push(s),s=s.getNext(n.direction,1)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.firstPiece.isAbsent()?s.firstClick(n,i):s.lastPiece.isAbsent()?s.secondClick(n,i):s.thirdClick(n,i)})()}firstClick(n,i){var s=this;return M(function*(){const o=s.getState().getCurrentOpponent(),a=s.getState().getCurrentPlayer();switch(s.board[i][n]){case a:return s.firstPiece=g.of(new v(n,i)),s.validExtensions=s.getValidExtensions(a),s.phalanxValidLandings=s.getPhalanxValidLandings(),b.SUCCESS;case o:return s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());default:return B.expectToBe(s.board[i][n],q.NONE),s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(n){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(n):this.getFirstPieceExtensions(n)}getFirstPieceExtensions(n){const i=[];for(const s of ye.DIRECTIONS){let o=this.firstPiece.get().getNext(s,1);for(;kn.isOnBoard(o)&&this.board[o.y][o.x]===n;)i.push(o),o=o.getNext(s,1)}return i}getPhalanxValidExtensions(n){let i=ye.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(i,1),o=this.getExtensionsToward(s,i,n);i=i.getOpposite();const a=this.firstPiece.get().getNext(i,1),c=this.getExtensionsToward(a,i,n);return o.concat(c)}getExtensionsToward(n,i,s){const o=[];for(;kn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o.push(n),n=n.getNext(i,1);return o}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const n=this.firstPiece.get(),i=this.lastPiece.get(),s=Math.abs(n.x-i.x),o=Math.abs(n.y-i.y),a=Math.max(s,o)+1;let c=ye.factory.fromMove(n,i).get();const l=i.getNext(c,1),f=this.getLandingsToward(l,c,a);c=c.getOpposite();const d=n.getNext(c,1);return this.getLandingsToward(d,c,a).concat(f)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const n=[];for(const i of ye.DIRECTIONS){const s=this.firstPiece.get().getNext(i,1);kn.isOnBoard(s)&&this.board[s.y][s.x]===q.NONE&&n.push(s)}return n}getLandingsToward(n,i,s){const o=this.getState().getCurrentPlayer(),a=this.getState().getCurrentOpponent(),c=[];for(;kn.isOnBoard(n)&&c.length<s&&this.board[n.y][n.x]!==o;){if(this.board[n.y][n.x]===a)return this.getPhalanxLength(n,i,a)<s&&c.push(n),c;c.push(n),n=n.getNext(i,1)}return c}getPhalanxLength(n,i,s){let o=0;for(;kn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o++,n=n.getNext(i,1);return o}cancelMoveAttempt(){this.firstPiece=g.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=g.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(n,i){var s=this;return M(function*(){const o=new v(n,i),a=s.firstPiece.get();if(o.equals(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentOpponent(),l=s.getState().getCurrentPlayer();if(!1===o.isAlignedWith(a))return s.cancelMove(aa.SQUARE_NOT_ALIGNED_WITH_SELECTED());const f=o.getDistance(a),d=a.getDirectionToward(o).get();switch(s.board[i][n]){case q.NONE:return 1===f?s.chooseMove(new oa(a.x,a.y,1,1,d)):s.cancelMove(aa.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(aa.SINGLE_PIECE_CANNOT_CAPTURE());default:B.expectToBe(s.board[i][n],l);const m=new oa(a.x,a.y,f,1,d),E=s.getState(),w=S2.getPhalanxValidity(E,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=g.of(o),s.validExtensions=s.getValidExtensions(l),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=a.getCoordsToward(o),s.phalanxDirection=g.of(d),b.SUCCESS)}})()}thirdClick(n,i){var s=this;return M(function*(){const o=s.getState().getCurrentPlayer(),a=new v(n,i);if(s.firstPiece.equalsValue(a))return s.moveFirstPiece(o);if(s.lastPiece.equalsValue(a))return s.moveLastPiece(o);const c=s.firstPiece.get(),l=s.lastPiece.get();if(!1===a.isAlignedWith(c))return s.cancelMove(aa.SQUARE_NOT_ALIGNED_WITH_PHALANX());let f=ye.factory.fromMove(c,l).get();const d=ye.factory.fromMove(c,a).get();if(f===d.getOpposite()&&(s.firstPiece=g.of(l),s.lastPiece=g.of(c),f=d),f!==d)return s.cancelMove(aa.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[i][n]===o)return s.thirdClickOnPlayerPiece(a,f,o);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,E=s.lastPiece.get().getDistance(a),w=new oa(s.firstPiece.get().x,s.firstPiece.get().y,m,E,f);return s.chooseMove(w)}})()}thirdClickOnPlayerPiece(n,i,s){var o=this;return M(function*(){o.lastPiece=g.of(n);const a=o.firstPiece.get().getDistance(n)+1,c=new oa(o.firstPiece.get().x,o.firstPiece.get().y,a,1,i),l=S2.getPhalanxValidity(o.node.gameState,c);return l.isFailure()?o.cancelMove(l.getReason()):(o.phalanxMiddles=o.firstPiece.get().getCoordsToward(o.lastPiece.get()),o.validExtensions=o.getValidExtensions(s),o.phalanxValidLandings=o.getPhalanxValidLandings(),b.SUCCESS)})()}moveFirstPiece(n){var i=this;return M(function*(){return i.firstPiece=g.of(i.firstPiece.get().getNext(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?yield i.moveOnlyPiece(n):(i.phalanxMiddles=i.phalanxMiddles.slice(1),i.validExtensions=i.getPhalanxValidExtensions(n)),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}moveLastPiece(n){var i=this;return M(function*(){return i.lastPiece=g.of(i.lastPiece.get().getPrevious(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?i.moveOnlyPiece(n):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getPhalanxValidExtensions(n),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS)})()}moveOnlyPiece(n){var i=this;return M(function*(){return i.lastPiece=g.empty(),i.validExtensions=i.getFirstPieceExtensions(n),i.phalanxDirection=g.empty(),i.phalanxMiddles=[],i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}getPieceClasses(n,i){const s=this.getPlayerClass(this.board[i][n]);return this.getPieceStrokeClasses(n,i).concat([s])}getPieceStrokeClasses(n,i){const s=new v(n,i);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(o=>o.equals(s))?["selected-stroke"]:[]}getRectClasses(n,i){const s=new v(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:this.moveds.some(o=>o.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return!1===this.isInteractive?[]:this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const n=[],s=this.getState().getCurrentPlayer();for(let o=0;o<this.board.length;o++)for(let a=0;a<this.board[o].length;a++)this.board[o][a]===s&&n.push(new v(a,o));return n}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-epaminondas"]],features:[Ke],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Zdt,2,1,"g",1),O(2,Ydt,2,4,"g",1),P()),2&n&&(I("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getHighlightedCoords()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var tR,Wce,qce;class X2{constructor(e){u(this,"capturedSpaces",void 0),B.assert(e.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),B.assert(ko.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=qt.copy(e).sort((n,i)=>n.x===i.x?(B.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=g.empty();for(const n of this.capturedSpaces)B.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=g.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return ko.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}tR=X2,u(X2,"encoder",we.tuple([we.list(v.encoder)],r=>[r.capturedSpaces],r=>new tR(r[0]))),u(X2,"listEncoder",we.list(tR.encoder));class TC{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=TC.computeIntersections(e);let n=[[]];return e.forEach((i,s)=>{if(0===t[s].length)n.forEach(o=>{o.push(s)});else{const o=[],a=t[s].some(c=>c>s);for(const c of n)!0===c.some(f=>t[s].some(d=>f===d))?o.push(qt.copy(c)):a?(o.push(qt.copy(c)),c.push(s),o.push(qt.copy(c))):(c.push(s),o.push(qt.copy(c)));n=o}}),n.map(i=>i.map(s=>e[s]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((s,o)=>{i!==o&&n.intersectsWith(s)&&t[i].push(o)})}),t}}class ca{constructor(e,t){u(this,"coord",void 0),u(this,"direction",void 0),this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}Wce=ca,u(ca,"encoder",we.tuple([v.encoder,g.getEncoder(Ne.encoder)],r=>[r.coord,r.direction],r=>new Wce(r[0],r[1])));class ja extends vi{constructor(e,t,n){super(),u(this,"placement",void 0),u(this,"initialCaptures",void 0),u(this,"finalCaptures",void 0),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===qt.compare(this.initialCaptures,e.initialCaptures)||!1===qt.compare(this.finalCaptures,e.finalCaptures))}}qce=ja,u(ja,"encoder",we.tuple([ca.encoder,X2.listEncoder,X2.listEncoder],r=>[r.placement,r.initialCaptures,r.finalCaptures],r=>new qce(r[0],r[1],r[2])));class S4 extends XL{constructor(e,t,n,i){super(t,e,7,7,[3,2,1],Me.EMPTY),u(this,"sidePieces",void 0),u(this,"capturedPieces",void 0),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&xt.compare(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=xt.copy(this.board);return n[e.y][e.x]=t,new S4(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Me.UNREACHABLE}}let la=(()=>{class r{}return u(r,"CAPTURE_MUST_BE_ALIGNED",()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`),u(r,"INVALID_CAPTURED_PIECES",()=>$localize`You must select a valid capture that contains 4 pieces or more.`),u(r,"MISSING_CAPTURES",()=>$localize`There are still possible captures to be done.`),u(r,"PLACEMENT_NOT_ON_BORDER",()=>$localize`Pieces must be inserted in spaces on the edge of the board.`),u(r,"INVALID_PLACEMENT_DIRECTION",()=>$localize`You must select a valid placement direction.`),u(r,"PLACEMENT_WITHOUT_DIRECTION",()=>$localize`You must select a placement with a direction alongside the insertion space.`),u(r,"PLACEMENT_ON_COMPLETE_LINE",()=>$localize`You cannot place a piece on a complete line.`),u(r,"AMBIGUOUS_CAPTURE_COORD",()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`),u(r,"NO_DIRECTIONS_AVAILABLE",()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`),r})();class Yt extends jn{static get(){return Yt.singleton.isAbsent()&&(Yt.singleton=g.of(new Yt)),Yt.singleton.get()}getInitialState(){const e=Me.EMPTY,t=Me.UNREACHABLE,n=Me.ZERO,i=Me.ONE;return new S4([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,[12,12],[0,0])}applyLegalMove(e,t,n){return new S4(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=Yt.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const s=[t.sidePieces[0],t.sidePieces[1]],o=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,Me.EMPTY),c.is(n)?s[n.value]+=1:o[n.value]+=1}),new S4(i.board,t.turn,s,o)}static getPlacements(e){const t=[];return qr.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===Me.EMPTY?t.push(new ca(n,g.empty())):Yt.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===Yt.isLineComplete(e,n,i)&&t.push(new ca(n,g.of(i)))})}),t}static isLineComplete(e,t,n){return Yt.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===Me.EMPTY)return g.of(i);return g.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,s=Me.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==Me.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,s)}else for(let a=e.coord;i.isOnBoard(a)&&s!==Me.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,s),s=c}const o=[t.sidePieces[0],t.sidePieces[1]];return o[n.value]-=1,new S4(i.board,t.turn,o,t.capturedPieces)}getPiecesMoved(e,t,n){const i=Yt.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const s=n.direction.get(),o=[];o.push(n.coord);let a=n.coord.getNext(s);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Me.EMPTY;)o.push(a),a=a.getNext(s);return je(i.isOnBoard(a)&&i.getPieceAt(a)===Me.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(a),o}}static getAllDirectionsForEntrance(e,t){if(qr.INSTANCE.isTopLeftCorner(e,t))return[Ne.RIGHT,Ne.DOWN,Ne.UP_RIGHT];if(qr.INSTANCE.isTopCorner(e,t))return[Ne.DOWN,Ne.DOWN_LEFT,Ne.RIGHT];if(qr.INSTANCE.isTopRightCorner(e,t))return[Ne.DOWN_LEFT,Ne.DOWN,Ne.LEFT];if(qr.INSTANCE.isBottomLeftCorner(e,t))return[Ne.UP_RIGHT,Ne.UP,Ne.RIGHT];if(qr.INSTANCE.isBottomCorner(e,t))return[Ne.UP,Ne.LEFT,Ne.UP_RIGHT];if(qr.INSTANCE.isBottomRightCorner(e,t))return[Ne.LEFT,Ne.UP,Ne.DOWN_LEFT];if(qr.INSTANCE.isOnTopLeftBorder(e,t))return[Ne.RIGHT,Ne.DOWN];if(qr.INSTANCE.isOnLeftBorder(e,t))return[Ne.UP_RIGHT,Ne.RIGHT];if(qr.INSTANCE.isOnBottomLeftBorder(e,t))return[Ne.UP,Ne.UP_RIGHT];if(qr.INSTANCE.isOnBottomRightBorder(e,t))return[Ne.LEFT,Ne.UP];if(qr.INSTANCE.isOnRightBorder(e,t))return[Ne.LEFT,Ne.DOWN_LEFT];if(qr.INSTANCE.isOnTopRightBorder(e,t))return[Ne.DOWN_LEFT,Ne.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=Yt.applyCaptures(e.initialCaptures,t),s=this.noMoreCapturesValidity(i);if(s.isFailure())return s.toOtherFallible();const o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toOtherFallible();const a=Yt.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=Yt.applyCaptures(e.finalCaptures,a),f=this.noMoreCapturesValidity(l);return f.isFailure()?f.toOtherFallible():Q.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=Yt.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=Yt.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return b.failure(la.CAPTURE_MUST_BE_ALIGNED());const s=i.get();return Yt.getCapturable(e,s).equals(t)?b.SUCCESS:b.failure(la.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=Yt.getLinePortionWithFourPiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let a=s;for(let c=s;e.isOnBoard(c);c=c.getNext(o))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return g.of({0:a,1:c,2:o});return g.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===Yt.getLinePortionsWithFourPiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(la.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==Me.EMPTY){if(t.direction.isAbsent())return b.failure(la.PLACEMENT_WITHOUT_DIRECTION());if(Yt.isLineComplete(e,t.coord,t.direction.get()))return b.failure(la.PLACEMENT_ON_COMPLETE_LINE());for(const i of Yt.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return b.SUCCESS;return b.failure(la.INVALID_PLACEMENT_DIRECTION())}return b.SUCCESS}placementCoordValidity(e,t){return qr.INSTANCE.isOnBorder(e,t)?b.SUCCESS:b.failure(la.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],s=t[1],o=t[2],a=o.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==Me.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(s);l=l.getNext(o))n.push(l);for(let l=s;e.isOnBoard(l)&&e.getPieceAt(l)!==Me.EMPTY;l=l.getNext(o))n.push(l);return new X2(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return Yt.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(Yt.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===Yt.getPossibleCaptures(e).length)return g.empty();const i=e.getNumberOfPiecesCaptured(t);return g.of(n+3*i)}static isGameOver(e){const t=Yt.getPlayerScore(e,k.ZERO),n=Yt.getPlayerScore(e,k.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=Yt.getPlayerScore(t,k.ZERO),i=Yt.getPlayerScore(t,k.ONE);return n.isAbsent()?_e.ONE_WON:i.isAbsent()?_e.ZERO_WON:_e.ONGOING}}u(Yt,"singleton",g.empty());class jce extends Nce{constructor(e,t,n,i,s,o){super(n,i,s,o),u(this,"source",void 0),u(this,"destination",void 0),this.source=e,this.destination=t}}const bn=Me.UNREACHABLE,Xe=Me.EMPTY,j1=Me.ZERO,Xc=Me.ONE;class Zce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Yt.get().getInitialState()),j.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Yt.get().getInitialState(),new ja(new ca(new v(3,0),g.of(Ne.DOWN)),[],[]),$localize`Congratulations!`),j.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new S4([[bn,bn,bn,j1,Xc,Xe,Xe],[bn,bn,Xe,Xe,Xe,Xe,Xe],[bn,Xe,Xe,Xe,Xe,Xe,Xe],[j1,j1,j1,Xe,Xe,Xe,Xe],[Xc,Xe,Xe,Xe,Xe,Xe,bn],[Xe,Xe,Xe,Xc,Xe,bn,bn],[Xe,Xe,Xe,Xc,bn,bn,bn]],42,[8,8],[0,0]),[new ja(new ca(new v(0,3),g.of(Ne.RIGHT)),[],[new X2([new v(0,3),new v(1,3),new v(2,3),new v(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),j.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new S4([[bn,bn,bn,Xe,Xe,Xe,Xe],[bn,bn,Xe,Xc,Xe,Xe,Xe],[bn,Xe,Xe,j1,Xe,Xe,Xe],[j1,j1,j1,Xc,Xe,Xe,Xe],[Xe,Xe,Xe,j1,Xe,Xe,bn],[Xe,Xe,Xe,j1,Xe,bn,bn],[Xe,Xe,Xe,Xc,bn,bn,bn]],42,[8,4],[2,3]),[new ja(new ca(new v(0,3),g.of(Ne.RIGHT)),[],[new X2([new v(3,1),new v(3,2),new v(3,3),new v(3,4),new v(3,5),new v(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),j.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new S4([[bn,bn,bn,j1,Xe,Xe,j1],[bn,bn,Xe,j1,Xe,Xe,j1],[bn,j1,j1,Xe,j1,Xc,j1],[Xe,Xe,Xe,j1,Xe,Xe,j1],[Xe,Xe,Xe,j1,Xe,Xe,bn],[j1,j1,j1,Xc,Xc,bn,bn],[Xe,Xe,Xe,j1,bn,bn,bn]],42,[3,4],[2,3]),[new ja(new ca(new v(3,6),g.of(Ne.UP)),[new X2([new v(6,0),new v(6,1),new v(6,2),new v(6,3)])],[new X2([new v(0,5),new v(1,5),new v(2,5),new v(3,5),new v(4,5)]),new X2([new v(1,2),new v(2,2),new v(3,2),new v(4,2),new v(5,2)])]),new ja(new ca(new v(4,6),g.of(Ne.UP)),[new X2([new v(6,0),new v(6,1),new v(6,2),new v(6,3)])],[new X2([new v(0,5),new v(1,5),new v(2,5),new v(3,5),new v(4,5)]),new X2([new v(3,0),new v(3,1),new v(3,2),new v(3,3),new v(3,4)])]),new ja(new ca(new v(3,6),g.of(Ne.UP)),[new X2([new v(6,0),new v(6,1),new v(6,2),new v(6,3)])],[new X2([new v(1,2),new v(2,2),new v(3,2),new v(4,2),new v(5,2)]),new X2([new v(0,5),new v(1,5),new v(2,5),new v(3,5),new v(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)])}}class Yce extends Fn{getListMoves(e){const t=e.gameState,n=[];return Yt.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(i=>{const s=Yt.applyCaptures(i,t);Yt.getPlacements(s).forEach(o=>{const a=Yt.applyPlacement(o,s);this.getPossibleCaptureCombinations(a).forEach(c=>{const l=new ja(o,i,c);n.push(l)})})}),n}getPossibleCaptureCombinations(e){const t=Yt.getPossibleCaptures(e);return TC.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class Xdt extends tr{getMetrics(e){const t=e.gameState;return[Yt.getPlayerScore(t,k.ZERO).get(),Yt.getPlayerScore(t,k.ONE).get()]}}function Qdt(r,e){if(1&r&&(A(),V(0,"circle",13)),2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClass(t)),I("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function Jdt(r,e){if(1&r){const t=pe();A(),S(0,"g",10),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s))}),V(1,"polygon",11),O(2,Qdt,1,4,"circle",12),P()}if(2&r){const t=e.$implicit,n=p();ve("id","click_",t.x,"_",t.y,""),_(1),ve("id","space_",t.x,"_",t.y,""),y("ngClass",n.getSpaceClass(t)),I("points",n.getHexaPointsAt(t)),_(1),y("ngIf",n.isPiece(t))}}function eht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",16),W("click",function(){const s=ne(t).$implicit;return re(p(2).onClick(s))}),P()}if(2&r){const t=e.$implicit;I("points",p(2).getHexaPointsAt(t))}}function tht(r,e){if(1&r&&(A(),S(0,"g",14),O(1,eht,1,1,"polygon",15),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.capturedSpaces)}}function nht(r,e){if(1&r){const t=pe();A(),S(0,"line",17),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.destination))}),P()}if(2&r){const t=e.$implicit;I("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function rht(r,e){if(1&r&&(A(),S(0,"g"),V(1,"circle",18),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),ve("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),I("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function iht(r,e){if(1&r&&(A(),S(0,"g"),O(1,rht,2,6,"g",8),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function sht(r,e){if(1&r&&(A(),V(0,"line",19)),2&r){const t=p();I("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let oht=(()=>{var r;class e extends mu{constructor(n){super(n),u(this,"inserted",g.empty()),u(this,"arrows",[]),u(this,"captured",[]),u(this,"moved",[]),u(this,"hexagonWidth",this.SPACE_SIZE),u(this,"sharedHexagonX",Math.cos(30)*this.hexagonWidth*.5),u(this,"boardWidth",this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2),u(this,"boardHeight",7*this.hexagonWidth+4.5*this.STROKE_WIDTH),u(this,"movePhase",e.PHASE_PLACEMENT_COORD),u(this,"constructedState",void 0),u(this,"possibleCaptures",[]),u(this,"initialCaptures",[]),u(this,"placement",g.empty()),u(this,"placementEntrance",g.empty()),u(this,"finalCaptures",[]),this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.rules=Yt.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Score`,this.rules,new Xdt,new Yce),new On($localize`MCTS`,new Yce,this.rules)],this.encoder=ja.encoder,this.tutorial=(new Zce).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new _u(1.5*this.SPACE_SIZE,new v(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),qr.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){if(i.inserted=g.empty(),n.placement.direction.isPresent()){const s=n.placement;i.inserted=g.of(i.arrowTowards(s.coord,s.direction.get()))}i.cancelMoveAttempt()})()}arrowTowards(n,i){const s=n.getNext(i.getOpposite()),o=this.getCenterAt(n),a=this.getCenterAt(s);return new jce(s,n,a.x,a.y,o.x,o.y)}markCapture(n){n.forEach(i=>{this.captured.push(i)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(n){const i=this.constructedState.getNumberOfPiecesToPlace(n),s=[];for(let o=0;o<i;o+=1)s.push(o);return s}isPiece(n){return this.getPiece(n)!==Me.EMPTY}getPiece(n){return this.constructedState.getPieceAt(n)}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());switch(i.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return i.selectCapture(n);case e.PHASE_PLACEMENT_COORD:return i.selectPlacementCoord(n);default:return B.expectToBe(i.movePhase,e.PHASE_PLACEMENT_DIRECTION),i.selectPlacementDirectionOrPlacementCoord(n)}})()}selectCapture(n){var i=this;return M(function*(){const s=[];if(i.possibleCaptures.forEach(a=>{a.contains(n)&&s.push(a)}),s.length>1)return i.cancelMove(la.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return i.cancelMove(la.MISSING_CAPTURES());const o=s[0];return i.constructedState=Yt.applyCapture(o,i.constructedState),i.markCapture(o),i.possibleCaptures=Yt.getPossibleCaptures(i.constructedState),i.movePhase===e.PHASE_INITIAL_CAPTURE?(i.initialCaptures.push(o),0===i.possibleCaptures.length?i.moveToPlacementPhase():b.SUCCESS):(B.expectToBe(i.movePhase,e.PHASE_FINAL_CAPTURE),i.finalCaptures.push(o),0===i.possibleCaptures.length?i.tryMove(i.initialCaptures,i.placement.get(),i.finalCaptures):b.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,b.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Yt.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,b.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var n=this;return M(function*(){return n.possibleCaptures=Yt.getPossibleCaptures(n.constructedState),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):(n.movePhase=e.PHASE_FINAL_CAPTURE,b.SUCCESS)})()}computeArrows(n){this.arrows=[];for(const i of Yt.getAllDirectionsForEntrance(this.constructedState,n))if(!1===Yt.isLineComplete(this.constructedState,n,i)){const s=n.getNext(i),o=this.getCenterAt(n),a=this.getCenterAt(s);this.arrows.push(new jce(n,s,o.x,o.y,a.x,a.y))}}selectPlacementCoord(n){var i=this;return M(function*(){const s=i.rules.placementCoordValidity(i.constructedState,n);return s.isFailure()?i.cancelMove(s.getReason()):i.placementEntrance.equalsValue(n)?(i.cancelMoveAttempt(),b.SUCCESS):(i.placementEntrance=g.of(n),i.constructedState.getPieceAt(n)===Me.EMPTY?i.selectPlacementDirection(g.empty()):(i.movePhase=e.PHASE_PLACEMENT_DIRECTION,i.computeArrows(n),0===i.arrows.length&&(yield i.cancelMove(la.NO_DIRECTIONS_AVAILABLE())),b.SUCCESS))})()}selectPlacementDirection(n){var i=this;return M(function*(){i.placement=g.of(new ca(i.placementEntrance.get(),n));const s=i.rules.placementValidity(i.constructedState,i.placement.get());return s.isFailure()?i.cancelMove(s.getReason()):(i.arrows=[],i.constructedState=Yt.applyPlacement(i.placement.get(),i.constructedState),i.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(n){var i=this;return M(function*(){const s=i.placementEntrance.get();if(!1===s.isAlignedWith(n)||1!==s.getDistance(n))return i.selectPlacementCoord(n);const o=Ne.factory.fromMove(s,n);return i.selectPlacementDirection(o.toOptional())})()}tryMove(n,i,s){const o=new ja(i,n,s);return this.chooseMove(o)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const n=this.node.previousMove;if(n.isPresent()){const i=n.get(),s=this.getPreviousState();i.initialCaptures.forEach(o=>this.markCapture(o)),i.finalCaptures.forEach(o=>this.markCapture(o)),this.moved=this.rules.getPiecesMoved(s,i.initialCaptures,i.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=g.empty(),this.placement=g.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(n){return this.captured.some(i=>i.equals(n))?"captured-fill":this.moved.some(i=>i.equals(n))?"moved-fill":""}getPieceClass(n){const i=this.getPiece(n);return this.getPlayerClass(k.of(i.value))}getRemainingPieceCy(n){return n===k.ONE?25:this.boardHeight-25}getRemainingPieceCx(n,i){const s=20+i*this.SPACE_SIZE*.5;return n===k.ONE?s:this.boardWidth-(15+s)}}return r=e,u(e,"PHASE_INITIAL_CAPTURE",0),u(e,"PHASE_PLACEMENT_COORD",1),u(e,"PHASE_PLACEMENT_DIRECTION",2),u(e,"PHASE_FINAL_CAPTURE",3),u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-gipf"]],features:[Ke],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P(),S(4,"marker",3),V(5,"polygon",4),P()(),O(6,Jdt,3,7,"g",5),O(7,tht,2,1,"g",6),O(8,nht,1,4,"line",7),O(9,iht,2,1,"g",8),O(10,sht,1,4,"line",9),P()),2&n&&(I("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),_(6),y("ngForOf",i.getAllCoords()),_(1),y("ngForOf",i.possibleCaptures),_(1),y("ngForOf",i.arrows),_(1),y("ngForOf",i.Player.PLAYERS),_(1),y("ngIf",i.inserted.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var bC,Dl;class ir extends Ar{static of(e){return new ir(e.x,e.y)}toString(){return this===ir.PASS?"GoMove.PASS":this===ir.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}u(ir,"PASS",new(bC=ir)(-1,0)),u(ir,"ACCEPT",new bC(-2,0)),u(ir,"encoder",Ar.getEncoder(bC.of));class xe{constructor(e,t){u(this,"player",void 0),u(this,"type",void 0),this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case xe.DARK:return"GoPiece.DARK";case xe.LIGHT:return"GoPiece.LIGHT";case xe.EMPTY:return"GoPiece.EMPTY";case xe.DEAD_DARK:return"GoPiece.DEAD_DARK";case xe.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case xe.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return je(this===xe.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===k.ZERO?xe.DARK:xe.LIGHT}isOccupied(){return[xe.DARK,xe.LIGHT,xe.DEAD_DARK,xe.DEAD_LIGHT].includes(this)}isEmpty(){return[xe.DARK_TERRITORY,xe.LIGHT_TERRITORY,xe.EMPTY].includes(this)}isDead(){return[xe.DEAD_DARK,xe.DEAD_LIGHT].includes(this)}isTerritory(){return[xe.DARK_TERRITORY,xe.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return je(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),xe.EMPTY}}u(xe,"DARK",new(Dl=xe)(k.ZERO,"alive")),u(xe,"LIGHT",new Dl(k.ONE,"alive")),u(xe,"EMPTY",new Dl(q.NONE,"empty")),u(xe,"DEAD_DARK",new Dl(k.ZERO,"dead")),u(xe,"DEAD_LIGHT",new Dl(k.ONE,"dead")),u(xe,"DARK_TERRITORY",new Dl(q.NONE,"territory")),u(xe,"LIGHT_TERRITORY",new Dl(q.NONE,"territory"));var hn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(hn||{});let Ir=(()=>{class r extends L1{constructor(t,n,i,s,o){super(t,i),u(this,"koCoord",void 0),u(this,"captured",void 0),u(this,"phase",void 0),this.captured=n,this.koCoord=s,this.phase=o}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return xt.create(r.WIDTH,r.HEIGHT,xe.EMPTY)}copy(){return new r(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})(),nR=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const s of this.getDirections()){const o=e.getNext(s);o.isInRange(t[0].length,t.length)&&!1===n.contains(o)&&(n=this._getGroupDatas(o,t,n))}return n}};nR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],nR);class Au{constructor(e){u(this,"color",void 0),this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class lht extends Au{constructor(e,t,n,i,s,o){super(e),u(this,"emptyCoords",void 0),u(this,"darkCoords",void 0),u(this,"lightCoords",void 0),u(this,"deadDarkCoords",void 0),u(this,"deadLightCoords",void 0),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=s,this.deadLightCoords=o}getCoords(){return this.color===xe.DARK?this.darkCoords:this.color===xe.LIGHT?this.lightCoords:this.color===xe.DEAD_DARK?this.deadDarkCoords:this.color===xe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(je(!1===this.contains(e),"This group already contains "+e.toString()),t){case xe.DARK:this.darkCoords=Au.insertAsEntryPoint(this.darkCoords,e);break;case xe.LIGHT:this.lightCoords=Au.insertAsEntryPoint(this.lightCoords,e);break;case xe.DEAD_DARK:this.deadDarkCoords=Au.insertAsEntryPoint(this.deadDarkCoords,e);break;case xe.DEAD_LIGHT:this.deadLightCoords=Au.insertAsEntryPoint(this.deadLightCoords,e);break;default:B.expectToBeMultiple(t,[xe.EMPTY,xe.DARK_TERRITORY,xe.LIGHT_TERRITORY]),this.emptyCoords=Au.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new Pn;e.set(xe.EMPTY,this.emptyCoords.length),e.set(xe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(xe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);if(1===t.size())return t.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==xe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==xe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==xe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==xe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==xe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class Kd extends nR{getNewInstance(e){return new lht(e,[],[],[],[],[])}getDirections(){return Re.ORTHOGONALS}}let Xd=(()=>{class r{}return u(r,"ILLEGAL_KO",()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`),u(r,"CANNOT_PASS_AFTER_PASSED_PHASE",()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`),u(r,"CANNOT_ACCEPT_BEFORE_COUNTING_PHASE",()=>$localize`You cannot accept before the counting phase.`),u(r,"OCCUPIED_INTERSECTION",()=>$localize`This intersection is already occupied.`),u(r,"CANNOT_COMMIT_SUICIDE",()=>$localize`You cannot commit suicide.`),r})();var wC,vn;let Za=(wC=class extends jn{static get(){return vn.singleton.isAbsent()&&(vn.singleton=g.of(new vn)),vn.singleton.get()}constructor(){super()}getInitialState(){const e=Ir.getStartingBoard();return new Ir(e,[0,0],0,g.empty(),hn.PLAYING)}static isLegal(e,t){if(vn.isPass(e)){const n=t.phase===hn.PLAYING,i=t.phase===hn.PASSED;return Ae.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?Q.success([]):Q.failure(Xd.CANNOT_PASS_AFTER_PASSED_PHASE())}return vn.isAccept(e)?t.phase===hn.COUNTING||t.phase===hn.ACCEPT?Q.success([]):Q.failure(Xd.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):vn.isOccupied(e.coord,t.getCopiedBoard())?(Ae.display("GoRules","isLegal","move is marking"),vn.isLegalDeadMarking(e,t)?Q.success([]):Q.failure(Xd.OCCUPIED_INTERSECTION())):(Ae.display("GoRules","isLegal","move is normal stuff: "+e.toString()),vn.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],s=e.coord,o=t[s.y][s.x],c=(new Kd).getGroupDatas(s,t),l=c.emptyCoords,f=xe.pieceBelongTo(o,k.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===f.length)return g.of(i)}return g.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=vn.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const s of n){const o=s.getWrapper();if(o===xe.LIGHT){i[1]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=xe.LIGHT_TERRITORY}else{je(o===xe.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),i[0]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=xe.DARK_TERRITORY}}return new Ir(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let i;for(let s=0;s<e.getHeight();s++)for(let o=0;o<e.getWidth();o++)i=t[s][o],i===xe.DARK_TERRITORY?(t[s][o]=xe.EMPTY,n[0]=n[0]-1):i===xe.LIGHT_TERRITORY&&(t[s][o]=xe.EMPTY,n[1]=n[1]-1);return new Ir(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return vn.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,s,o;const a=new Kd;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new v(l,c),o=e[c][l],t(o)&&!1===n.some(f=>f.selfContains(i))&&(s=a.getGroupDatas(i,e),n.push(s));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let s,n=t[1],i=t[0];for(let o=0;o<e.getHeight();o++)for(let a=0;a<e.getWidth();a++)s=e.getPieceAtXY(a,o),s===xe.DEAD_DARK?n++:s===xe.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();je(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new Kd).getGroupDatas(e,n),a=t.getCapturedCopy();switch(o.color){case xe.DEAD_DARK:a[1]-=2*o.deadDarkCoords.length;for(const c of o.deadDarkCoords)n[c.y][c.x]=xe.DARK;break;case xe.DEAD_LIGHT:a[0]-=2*o.deadLightCoords.length;for(const c of o.deadLightCoords)n[c.y][c.x]=xe.LIGHT;break;case xe.LIGHT:a[0]+=2*o.lightCoords.length;for(const c of o.lightCoords)n[c.y][c.x]=xe.DEAD_LIGHT;break;default:B.expectToBe(o.color,xe.DARK),a[1]+=2*o.darkCoords.length;for(const c of o.darkCoords)n[c.y][c.x]=xe.DEAD_DARK}return new Ir(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===hn.FINISHED?t.captured[0]>t.captured[1]?_e.ZERO_WON:t.captured[1]>t.captured[0]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static isPass(e){return e.equals(ir.PASS)}static isAccept(e){return e.equals(ir.ACCEPT)}static isLegalDeadMarking(e,t){return vn.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===hn.COUNTING||t.phase===hn.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(vn.isKo(e,t))return Q.failure(Xd.ILLEGAL_KO());[hn.COUNTING,hn.ACCEPT].includes(t.phase)&&(t=vn.resurrectStones(t));const i=vn.getCaptureState(e,t);if(Xce.isCapturing(i))return Q.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?xe.DARK:xe.LIGHT;const a=0===(new Kd).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=xe.EMPTY,a?Q.failure(Xd.CANNOT_COMMIT_SUICIDE()):Q.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new Xce;let i;for(const s of Re.ORTHOGONALS)i=vn.getCapturedInDirection(e.coord,s,t),i.length>0&&n.capturedCoords.every(o=>!1===i[0].equals(o))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),s=e.getNext(t);if(s.isInRange(n.getWidth(),n.getHeight())&&i[s.y][s.x]===(n.turn%2==0?xe.LIGHT:xe.DARK)){Ae.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new Kd).getGroupDatas(s,i);if(vn.isCapturableGroup(c,n.koCoord))return Ae.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return vn.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let s,o;return e.phase===hn.PASSED?(s=hn.COUNTING,o=new Ir(t,n,i+1,g.empty(),s),o=vn.markTerritoryAndCount(o)):(je(e.phase===hn.PLAYING,"Cannot pass in counting phase!"),s=hn.PASSED,o=new Ir(t,n,i+1,g.empty(),s)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===hn.COUNTING?hn.ACCEPT:hn.FINISHED,new Ir(t,e.getCapturedCopy(),e.turn+1,g.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[hn.COUNTING,hn.ACCEPT].includes(t.phase)?vn.resurrectStones(t):t.copy();const s=e.coord.x,o=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=xe.ofPlayer(i.getCurrentPlayer()),f=c+1;a[o][s]=l;for(const E of n)a[E.y][E.x]=xe.EMPTY;const d=vn.getNewKo(e,a,n),m=i.getCapturedCopy();return m[l.player.value]+=n.length,new Ir(a,m,f,d,hn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.getHeight();t++)for(let n=0;n<e.getWidth();n++)e.getPieceAtXY(n,t).isDead()&&(e=vn.switchAliveness(new v(n,t),e));return vn.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=vn.removeAndSubstractTerritory(t),i=vn.switchAliveness(e.coord,n),s=new Ir(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,g.empty(),hn.COUNTING);return vn.markTerritoryAndCount(s)}isLegal(e,t){return vn.isLegal(e,t)}applyLegalMove(e,t,n){return vn.isPass(e)?(Ae.display("GoRules","applyLegalMove","isPass"),vn.applyPass(t)):vn.isAccept(e)?(Ae.display("GoRules","applyLegalMove","isAccept"),vn.applyLegalAccept(t)):vn.isLegalDeadMarking(e,t)?(Ae.display("GoRules","applyLegalMove","isDeadMarking"),vn.applyDeadMarkingMove(e,t)):(Ae.display("GoRules","applyLegalMove","else it is normal move"),vn.applyNormalLegalMove(e,t,n))}getGameStatus(e){return vn.getGameStatus(e)}},vn=wC,u(wC,"singleton",g.empty()),wC);Za=vn=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],Za);class Xce{constructor(){u(this,"capturedCoords",[])}static isCapturing(e){return e.capturedCoords.length>0}}const We=xe.LIGHT,Ve=xe.DARK,rR=xe.DEAD_LIGHT,Iu=xe.LIGHT_TERRITORY,ua=xe.DARK_TERRITORY,le=xe.EMPTY;class Qce extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Za.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Ir([[le,Ve,le,le,We,We],[le,Ve,le,le,We,le],[le,Ve,Ve,We,We,le],[le,le,Ve,We,le,le],[le,le,Ve,We,le,le],[le,le,Ve,We,le,le]],[0,0],0,g.empty(),hn.PLAYING)),j.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Ir([[le,le,le,le,le],[le,le,Ve,le,le],[le,Ve,We,le,le],[le,le,Ve,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),hn.PLAYING),[new ir(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),j.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Ir([[le,Ve,le,le,le],[Ve,We,le,le,le],[Ve,We,We,Ve,le],[le,Ve,Ve,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),hn.PLAYING),[new ir(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),j.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Ir([[le,Ve,le,le,le],[Ve,le,le,le,le],[Ve,le,le,le,We],[We,Ve,le,We,le],[le,We,le,We,Ve]],[0,0],0,g.empty(),hn.PLAYING)),j.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Ir([[le,le,le,le,le],[Ve,Ve,Ve,le,le],[We,We,Ve,le,le],[le,We,Ve,le,le],[We,We,Ve,le,le]],[0,0],0,g.empty(),hn.PLAYING)),j.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Ir([[le,Ve,We,le,le],[We,Ve,We,le,le],[Ve,Ve,We,le,le],[We,Ve,We,le,le],[le,Ve,We,le,le]],[0,0],0,g.empty(),hn.PLAYING)),j.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Ir([[le,We,Ve,le,We,Ve,le],[le,We,Ve,Ve,We,Ve,le],[le,We,Ve,Ve,We,Ve,le],[le,We,Ve,Ve,We,Ve,le],[le,We,Ve,We,We,Ve,le],[le,We,Ve,We,We,Ve,le],[le,We,Ve,le,We,Ve,le]],[0,0],0,g.empty(),hn.PLAYING)),j.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Ir([[le,le,le,le,le,le,le],[le,le,le,le,le,le,le],[le,le,le,Ve,We,le,le],[le,le,Ve,We,le,We,le],[le,le,le,Ve,We,le,le],[le,le,le,le,le,le,le],[le,le,le,le,le,le,le]],[0,0],0,g.empty(),hn.PLAYING),[new ir(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),j.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Ir([[We,Ve,Ve,Ve,Ve,Ve,ua,ua,ua],[We,We,We,We,Ve,Ve,Ve,ua,ua],[We,Iu,We,We,Ve,rR,rR,Ve,ua],[Ve,We,We,We,We,Ve,ua,ua,ua],[le,We,Iu,We,Ve,Ve,rR,Ve,ua],[We,Iu,We,We,Ve,Ve,Ve,Ve,Ve],[We,We,Ve,Ve,Ve,We,We,Ve,We],[Ve,Ve,Ve,We,We,We,Iu,We,We],[ua,ua,Ve,Ve,Ve,We,We,Iu,Iu]],[0,0],0,g.empty(),hn.COUNTING),[new ir(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)])}}class fht extends tr{getMetrics(e){const t=Za.markTerritoryAndCount(e.gameState),n=t.getCapturedCopy(),i=this.getDeadStones(t);return[n[0]+2*i[1],n[1]+2*i[0]]}getDeadStones(e){const t=[0,0];for(const n of e.getCoordsAndContents()){const i=n.content;"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}let NC=class extends Fn{getListMoves(e){const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===hn.PLAYING||t.phase===hn.PASSED)return n.push(ir.PASS),n;{const i=this.getCountingMovesList(t);return 0===i.length?[ir.ACCEPT]:i}}getPlayingMovesList(e){const t=[];let n;for(const i of e.getCoordsAndContents()){const s=i.coord,o=i.content;n=new ir(s.x,s.y),o===xe.EMPTY&&Za.isLegal(n,e).isSuccess()&&t.push(n)}return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=Za.getGroupsDatasWhere(n,s=>s!==xe.EMPTY);for(const s of i){const o=s.getCoords()[0],a=n[o.y][o.x];if(e.getPieceAt(o)!==a){const l=new ir(o.x,o.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),o=>o===xe.DARK?xe.DEAD_DARK:o===xe.LIGHT?xe.DEAD_LIGHT:o.isTerritory()?xe.EMPTY:o),i=new Ir(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),s=Za.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,s)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let s=0;s<e[0].length;s++)n[i][s]=t(e[i][s])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const s of t){i=s.deadDarkCoords.concat(s.deadLightCoords);for(const o of i)n.isDead(o)&&(n=Za.switchAliveness(o,n))}return n}};var ku;function pht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",8),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P(),S(2,"line",9),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P(),S(3,"line",9),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ve("id","click_",t,"_",n,""),I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function ght(r,e){if(1&r&&(A(),S(0,"g"),O(1,pht,4,14,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function mht(r,e){if(1&r){const t=pe();A(),S(0,"circle",10),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","hoshi_",t.x,"_",t.y,""),I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.1*n.SPACE_SIZE)}}function _ht(r,e){if(1&r&&(A(),V(0,"circle",16)),2&r){const t=p(2).index,n=p().index,i=p();I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function vht(r,e){if(1&r){const t=pe();A(),S(0,"line",17),W("click",function(){ne(t);const i=p(2).index,s=p().index;return re(p().onClick(i,s))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();I("x1",.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function Cht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",13),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().onClick(i,s))}),P(),O(2,_ht,1,3,"circle",14),O(3,vht,1,4,"line",15),P()}if(2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE),_(1),y("ngIf",i.isLastSpace(t,n)),_(1),y("ngIf",i.isDead(t,n))}}function yht(r,e){if(1&r){const t=pe();A(),S(0,"circle",19),W("click",function(){ne(t);const i=p(2).index,s=p().index;return re(p().onClick(i,s))}),P()}if(2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();I("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*n)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*s)("r",.1*o.SPACE_SIZE)("class",i===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function Mht(r,e){if(1&r&&(A(),O(0,yht,1,4,"circle",18)),2&r){const t=p().index,n=p().index;y("ngIf",p().isTerritory(t,n))}}function Eht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Cht,4,6,"g",11),O(2,Mht,1,1,"ng-template",null,12,dn),P()),2&r){const t=e.index,n=un(3),i=p().index,s=p();_(1),y("ngIf",s.spaceIsFull(t,i))("ngIfElse",n)}}function Sht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Eht,4,2,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Pht(r,e){if(1&r&&(A(),V(0,"rect",20)),2&r){const t=p();I("width",.25*t.SPACE_SIZE)("height",.25*t.SPACE_SIZE)("x",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().x)("y",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().y)}}function Oht(r,e){if(1&r){const t=pe();A(),S(0,"circle",21),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}NC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],NC);let iR=(ku=class extends UL{constructor(e){super(e),u(this,"boardInfo",void 0),u(this,"ko",g.empty()),u(this,"last",g.empty()),u(this,"captures",[]),u(this,"GoPiece",xe),u(this,"boardHeight",Ir.HEIGHT),u(this,"boardWidth",Ir.WIDTH),this.scores=g.of([0,0]),this.rules=Za.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,Za.get(),new fht,new NC),new On($localize`MCTS`,new NC,this.rules)],this.encoder=ir.encoder,this.tutorial=(new Qce).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.last=g.empty();const s=new ir(e,t);return n.chooseMove(s)})()}updateBoard(e){var t=this;return M(function*(){const n=t.getState(),i=t.node.previousMove,s=n.phase;t.board=n.getCopiedBoard(),t.scores=g.of(n.getCapturedCopy()),t.ko=n.koCoord,i.isPresent()?t.showCaptures():t.captures=[],t.last=i.map(o=>o.coord),t.canPass=s!==hn.FINISHED,t.createHoshis()})()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new v(n,t),s=e.getPieceAt(i).isOccupied(),o=this.board[t][n]===xe.EMPTY,a=!1===this.ko.equalsValue(i);s&&o&&a&&this.captures.push(i)}}pass(){var e=this;return M(function*(){const t=e.getState().phase;return t===hn.PLAYING||t===hn.PASSED?e.onClick(ir.PASS.coord.x,ir.PASS.coord.y):(je(t===hn.COUNTING||t===hn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(ir.ACCEPT.coord.x,ir.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==xe.EMPTY&&!1===this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new v(e,t))}isTerritory(e,t){return this.getState().isTerritory(new v(e,t))}},u(ku,"\u0275fac",function(e){return new(e||ku)(U($t))}),u(ku,"\u0275cmp",Be({type:ku,selectors:[["app-go"]],features:[Ke],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),V(1,"rect",1),S(2,"g",2),O(3,ght,2,1,"g",3),O(4,mht,1,5,"circle",4),P(),S(5,"g",5),O(6,Sht,2,1,"g",3),P(),O(7,Pht,1,4,"rect",6),O(8,Oht,1,3,"circle",7),P()),2&e&&(I("viewBox","0 -3 "+t.boardWidth*t.SPACE_SIZE*.5+" "+(6+t.boardHeight*t.SPACE_SIZE*.5)),_(1),I("width",t.boardWidth*t.SPACE_SIZE*.5)("height",t.boardHeight*t.SPACE_SIZE*.5),_(2),y("ngForOf",t.board),_(1),y("ngForOf",t.hoshis),_(2),y("ngForOf",t.board),_(1),y("ngIf",t.ko.isPresent()),_(1),y("ngForOf",t.captures))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),ku);iR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],iR);let pr=(()=>{class r{}return u(r,"CANNOT_DROP_PIECE_YOU_DONT_HAVE",()=>"You cannot drop a piece that you do not have in your reserve."),u(r,"QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The queen bee can only move to one of its direct neighbors.`),u(r,"BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The beetle can only move to one of its direct neighbors.`),u(r,"GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`The grasshopper must move in a straight line.`),u(r,"GRASSHOPPER_MUST_JUMP_OVER_PIECES",()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`),u(r,"SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES",()=>$localize`The spider must move on neighboring spaces.`),u(r,"SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT",()=>$localize`The spider can only move around pieces that are in direct contact with it.`),u(r,"SPIDER_CANNOT_BACKTRACK",()=>$localize`The spider cannot go twice through the same space in the same move.`),u(r,"QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE",()=>$localize`The queen bee must be placed on the board before moving a piece.`),u(r,"THIS_PIECE_CANNOT_CLIMB",()=>$localize`Only the beetle is allowed to climb over other pieces.`),u(r,"CANNOT_DISCONNECT_HIVE",()=>$localize`You are not allowed to split the hive.`),u(r,"MUST_BE_ABLE_TO_SLIDE",()=>$localize`This piece must be able to slide to its destination.`),u(r,"MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN",()=>$localize`You must place your queen bee at this turn!`),u(r,"CANNOT_DROP_NEXT_TO_OPPONENT",()=>$localize`You cannot drop a piece next to one of your opponent's stack.`),u(r,"MUST_DROP_ON_EMPTY_SPACE",()=>$localize`You must always drop your piece on an empty space.`),u(r,"MUST_BE_CONNECTED_TO_HIVE",()=>$localize`The piece you are dropping must be connected to the hive.`),r})();var Jce;const Tht=we.fromFunctions(r=>r,r=>r);class a2{constructor(e,t){u(this,"owner",void 0),u(this,"kind",void 0),this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}Jce=a2,u(a2,"encoder",we.tuple([k.encoder,Tht],r=>[r.owner,r.kind],r=>new Jce(r[0],r[1])));class Qc{constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.size()===e.size()&&qt.compare(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new Qc([e,...this.pieces])}topPiece(){return B.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new Qc(e)}size(){return this.pieces.length}}var t3e,r3e,P2;u(Qc,"EMPTY",new Qc([]));class fa extends Ar{static of(e,t){return new fa(e,t.x,t.y)}constructor(e,t,n){super(t,n),u(this,"piece",void 0),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof fa&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}t3e=fa,u(fa,"encoder",we.tuple([a2.encoder,v.encoder],r=>[r.piece,r.coord],r=>new t3e(r[0],r[1].x,r[1].y)));class Yi extends Qs{static from(e,t){return e.equals(t)?Q.failure(Ee.MOVE_CANNOT_BE_STATIC()):Q.success(new Yi(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof Ya)&&e instanceof Yi&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}u(Yi,"encoder",qi.getFallibleEncoder(Yi.from));class Ya extends Yi{static ofCoords(e){return new Ya(e)}constructor(e){super(e[0],e[3]),u(this,"coords",void 0),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof Ya&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}r3e=Ya,u(Ya,"encoder",we.tuple([v.encoder,v.encoder,v.encoder,v.encoder],r=>r.coords,r=>new r3e(r)));class $0 extends vi{toString(){return"HiveMovePass"}equals(e){return e instanceof $0}}function bht(r){return r instanceof fa}function wht(r){return r instanceof Ya}function Nht(r){return r instanceof Yi}function Aht(r){return r instanceof $0}u($0,"encoder",we.constant("HiveMovePass",new $0)),function(r){r.PASS=new $0,r.drop=function e(i,s){return fa.of(i,s)},r.move=function t(i,s){return Yi.from(i,s)},r.spiderMove=function n(i){return Ya.ofCoords(i)},r.encoder=we.disjunction([bht,wht,Nht,Aht],[fa.encoder,Ya.encoder,Yi.encoder,$0.encoder])}(P2||(P2={}));class da{static of(e){return da.INSTANCES.isAbsent()&&(da.INSTANCES=g.of({QueenBee:AC.get(),Beetle:IC.get(),Grasshopper:kC.get(),Spider:Qd.get(),SoldierAnt:xC.get()})),da.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?b.failure(pr.THIS_PIECE_CANNOT_CLIMB()):b.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new st(M2.getNeighbors(t)),s=new st(M2.getNeighbors(n)),o=i.intersection(s);for(const a of o)if(e.getAt(a).isEmpty())return!0;return!1}}u(da,"INSTANCES",g.empty());class AC extends da{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new AC)),this.INSTANCE.get()}moveValidity(e,t){return!1===M2.areNeighbors(e.getStart(),e.getEnd())?b.failure(pr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?b.failure(pr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of M2.getNeighbors(e))t.getAt(i).isEmpty()&&n.push(Yi.from(e,i).get());return n}}u(AC,"INSTANCE",g.empty());class IC extends da{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new IC)),this.INSTANCE.get()}moveValidity(e,t){return!1===M2.areNeighbors(e.getStart(),e.getEnd())?b.failure(pr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):b.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of M2.getNeighbors(e))n.push(Yi.from(e,i).get());return n}}u(IC,"INSTANCE",g.empty());class kC extends da{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new kC)),this.INSTANCE.get()}moveValidity(e,t){if(Ne.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return b.failure(pr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return b.failure(pr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const s of i)if(t.getAt(s).isEmpty())return b.failure(pr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of Ne.factory.all){const s=e.getNext(i);if(t.getAt(s).hasPieces()){let o=s;for(;t.getAt(o).hasPieces();)o=o.getNext(i);n.push(Yi.from(e,o).get())}}return n}}u(kC,"INSTANCE",g.empty());class Qd extends da{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new Qd)),this.INSTANCE.get()}prefixLegality(e,t){const n=new st,i=t.update().setAt(e[0],Qc.EMPTY).increaseTurnAndFinalizeUpdate();for(let s=1;s<e.length;s++){if(i.getAt(e[s]).hasPieces())return b.failure(pr.THIS_PIECE_CANNOT_CLIMB());if(!1===M2.areNeighbors(e[s-1],e[s]))return b.failure(pr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[s],e[s-1]))return b.failure(pr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[s-1],e[s]))return b.failure(pr.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[s]))return b.failure(pr.SPIDER_CANNOT_BACKTRACK());n.add(e[s])}return b.SUCCESS}moveValidity(e,t){B.assert(e instanceof Ya,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,Qc.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new st(i.map(function s(a){return Ya.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new st(M2.getNeighbors(n)).filter(function i(o){return!e.getAt(o).hasPieces()&&void 0===t.find(a=>o.equals(a))&&e.haveCommonNeighbor(o,n)}).toList().map(o=>[...t,o])}}u(Qd,"INSTANCE",g.empty());class xC extends da{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new xC)),this.INSTANCE.get()}pathExists(e,t,n){const i=new st,s=[t];for(;s.length>0;){const o=s.pop();if(!i.contains(o)){if(i.add(o),o.equals(n))return!0;for(const a of M2.getNeighbors(o)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,f=this.canSlideBetweenNeighbors(e,o,a);c&&l&&f&&s.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?b.failure(pr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new st;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const s of t.emptyNeighbors(i))n.add(Yi.from(e,s).get());return n.toList()}}u(xC,"INSTANCE",g.empty());class s3e extends hC{constructor(e,t){super(t),u(this,"pieces",void 0),u(this,"width",void 0),u(this,"height",void 0),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const s of this.pieces.listKeys())e=Math.min(s.x,e),t=Math.max(s.x,t),n=Math.min(s.y,n),i=Math.max(s.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new st(M2.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new st,t=new st;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new st,s=new st([n.key]);for(;s.hasElements();){const o=s.getAnyElement().get();s.remove(o),e.add(o),i.add(o),s.addAll(this.getOccupiedNeighbors(o).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class LC{static getInitial(){const e=new Pn;for(const t of k.PLAYERS)e.set(new a2(t,"QueenBee"),1),e.set(new a2(t,"Beetle"),2),e.set(new a2(t,"Spider"),2),e.set(new a2(t,"Grasshopper"),3),e.set(new a2(t,"SoldierAnt"),3);return e.makeImmutable(),new LC(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return g.of(t);return g.empty()}remove(e){const t=this.pieces.get(e).get();B.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new LC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new Qc(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class Jd{static of(e){return new Jd(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){u(this,"pieces",void 0),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),u(this,"turn",void 0),this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const s of k.PLAYERS)n.get(s).equalsValue(e)&&n.delete(s);for(const s of t.pieces)"QueenBee"===s.kind&&n.put(s.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new Jd(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new Jd(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new Ns(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class Ns extends s3e{static fromRepresentation(e,t,n=new St(0,0)){const i=new du;let s=LC.getInitial();const o=new Pn;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new v(c,a).getNext(n,1);i.set(l,new Qc(e[a][c]));const f=g.ofNullable(e[a][c].find(d=>"QueenBee"===d.kind));f.isPresent()&&o.set(f.get().owner,l);for(const d of e[a][c])s=s.remove(d)}return new Ns(i,s,o,t)}constructor(e,t,n,i){super(e,i),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const s of n.listKeys()){const o=n.get(s).get();this.queenBees.replace(s,o)}this.queenBees.makeImmutable()}update(){return Jd.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():Qc.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of M2.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of M2.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class c2 extends jn{static get(){return c2.singleton.isAbsent()&&(c2.singleton=g.of(new c2)),c2.singleton.get()}getInitialState(){return Ns.fromRepresentation([],0)}applyLegalMove(e,t,n){return e instanceof fa?this.applyLegalDrop(e,t):e instanceof Yi?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof fa?this.isLegalDrop(e,t):e instanceof Yi?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?b.SUCCESS:b.failure(Ee.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return b.failure(pr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const s=da.of(i).moveValidity(e,t);if(s.isFailure())return s;const o=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return b.failure(pr.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===o.numberOfNeighbors(a)?b.failure(pr.CANNOT_DISCONNECT_HIVE()):b.SUCCESS}mustPlaceQueenBee(e){return e.turn>=6&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===t.remainingPieces.hasRemaining(e.piece))return b.failure(pr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return b.failure(pr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?b.failure(pr.MUST_DROP_ON_EMPTY_SPACE()):b.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const s of M2.getNeighbors(e.coord)){const o=t.getAt(s);if(o.hasPieces()&&(i=!0,1!==t.turn&&o.topPiece().owner===n.getOpponent()))return b.failure(pr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?b.failure(pr.MUST_BE_CONNECTED_TO_HIVE()):b.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new st([new v(0,0)]);if(1===e.turn)return new st(M2.getNeighbors(new v(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new st;const i=n.get(),s=new st;for(const o of e.occupiedSpaces())if(e.getAt(o).topPiece().owner===t)for(const a of e.emptyNeighbors(o)){const c=fa.of(i,a);this.isLegalDrop(c,e).isSuccess()&&s.add(a)}return s}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new st,s=e.getAt(t).topPiece();if(s.owner===n)for(const o of da.of(s).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(o,e).isSuccess()&&i.add(o);return i}getPossibleMovesOnBoard(e){const t=new st;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of k.PLAYERS){const s=t.queenBeeLocation(i);s.isPresent()&&(n[i.value]=t.numberOfNeighbors(s.get()))}return 6===n[0]&&6===n[1]?_e.DRAW:6===n[0]?_e.getVictory(k.ONE):6===n[1]?_e.getVictory(k.ZERO):_e.ONGOING}}u(c2,"singleton",g.empty());class Iht extends tr{getMetrics(e){return[this.queenBeeMobility(e.gameState,k.ZERO),this.queenBeeMobility(e.gameState,k.ONE)]}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?c2.get().getPossibleMovesFrom(e,n.get()).size():0}}class o3e extends Fn{getListMoves(e){const t=this.getListDrops(e.gameState),n=this.getListOfOnBoardMoves(e.gameState),i=t.concat(n);return 0===i.length?[P2.PASS]:i}getListOfOnBoardMoves(e){return c2.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new a2(n,"QueenBee");for(const s of c2.get().getPossibleDropLocations(e))if(c2.get().mustPlaceQueenBee(e))t.push(P2.drop(i,s));else for(const o of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(P2.drop(o,s));return t}}const Jc=new a2(k.ZERO,"QueenBee"),B0=new a2(k.ZERO,"Beetle"),xu=new a2(k.ZERO,"Grasshopper"),RC=new a2(k.ZERO,"Spider"),zC=new a2(k.ZERO,"SoldierAnt"),G0=new a2(k.ONE,"QueenBee"),xo=new a2(k.ONE,"Beetle"),sR=new a2(k.ONE,"Grasshopper"),oR=new a2(k.ONE,"Spider"),eh=new a2(k.ONE,"SoldierAnt");class a3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,Ns.fromRepresentation([[[G0],[xo],[oR],[xu]],[[xu],[],[zC],[]],[[zC],[],[],[]]],8)),j.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,Ns.fromRepresentation([[[],[xo],[RC]],[[eh],[G0],[Jc]],[[xu],[B0],[]]],7)),j.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,c2.get().getInitialState(),P2.drop(B0,new v(0,0)),$localize`Congratulations!`),j.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,Ns.fromRepresentation([[[xo],[xu]]],2),P2.drop(Jc,new v(2,0)),$localize`Congratulations!`),j.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,Ns.fromRepresentation([[[],[RC],[sR],[G0],[xo]],[[xo],[Jc],[B0],[],[]]],4),[P2.move(new v(1,1),new v(0,2)).get(),P2.move(new v(1,1),new v(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,Ns.fromRepresentation([[[Jc],[G0],[B0]],[[xo],[],[]]],6),[P2.move(new v(2,0),new v(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,Ns.fromRepresentation([[[xo,Jc],[G0],[B0]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,Ns.fromRepresentation([[[xu],[Jc],[xo],[eh]],[[sR],[],[],[]]],6),[P2.move(new v(0,0),new v(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,Ns.fromRepresentation([[[],[zC],[G0]],[[],[Jc],[xo]],[[eh],[oR],[]]],6),P2.move(new v(1,0),new v(3,1)).get(),(t,n,i)=>t.equals(P2.move(new v(1,0),new v(0,1)).get())?b.failure($localize`You have not freed your queen, try again!`):b.SUCCESS,$localize`Congratulations!`),j.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,Ns.fromRepresentation([[[],[RC],[oR],[xo]],[[],[],[],[B0]],[[xo],[],[],[eh]],[[zC],[],[xu],[]],[[Jc],[sR],[],[]]],6),P2.spiderMove([new v(1,0),new v(1,1),new v(2,1),new v(2,2)]),$localize`Congratulations!`),j.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,Ns.fromRepresentation([[[],[RC],[]],[[],[Jc],[xo]],[[eh],[],[]]],6)),j.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,Ns.fromRepresentation([[[xo,B0],[Jc],[G0]]],4))])}}const kht=["app-hive-piece",""];function xht(r,e){1&r&&(A(),V(0,"path",9))}function Lht(r,e){1&r&&(A(),V(0,"path",10))}function Rht(r,e){1&r&&(A(),V(0,"path",11))}function zht(r,e){1&r&&(A(),V(0,"path",12))}function Dht(r,e){1&r&&(A(),V(0,"path",13))}let Hht=(()=>{var r;class e extends xae{constructor(...n){super(...n),u(this,"piece",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"hexaLayout",void 0),u(this,"layer",void 0),u(this,"pieceHeight",void 0),u(this,"hexaPoints",""),u(this,"pieceClass",""),u(this,"isoPointsLight",""),u(this,"isoPointsDark",""),u(this,"isoPointsStroke",""),u(this,"layerTransform",""),u(this,"hexaCenter",new v(0,0))}ngAfterContentChecked(){const n=new v(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(n),this.hexaCenter=this.hexaLayout.getCenterAt(n);const s=this.hexaLayout.getIsoPoints(n,this.pieceHeight).map(o=>o.map(a=>a.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",Be({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[Ke],attrs:kht,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(A(),S(0,"g"),V(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),S(5,"g"),O(6,xht,1,0,"path",4),O(7,Lht,1,0,"path",5),O(8,Rht,1,0,"path",6),O(9,zht,1,0,"path",7),O(10,Dht,1,0,"path",8),P()()),2&n&&(I("transform",i.layerTransform),_(1),y("ngClass",i.pieceClass),I("points",i.isoPointsLight),_(1),y("ngClass",i.pieceClass),I("points",i.isoPointsDark),_(1),I("points",i.isoPointsStroke),_(1),y("ngClass",i.pieceClass),I("points",i.hexaPoints),_(1),I("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),_(1),y("ngIf","QueenBee"===i.piece.kind),_(1),y("ngIf","Beetle"===i.piece.kind),_(1),y("ngIf","Grasshopper"===i.piece.kind),_(1),y("ngIf","Spider"===i.piece.kind),_(1),y("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[Dt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function Vht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",4),W("click",function(){const s=ne(t).$implicit;return re(p().selectSpace(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ve("id","space_",t.x,"_",t.y,""),y("ngClass",t.content.spaceClasses),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function Fht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",6),W("click",function(){ne(t);const i=p().$implicit;return re(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ve("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function $ht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Fht,1,4,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function Bht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",8),W("click",function(){ne(t);const i=p().$implicit;return re(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ve("id","stroke_",t.x,"_",t.y,""),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function Ght(r,e){if(1&r&&(A(),S(0,"g"),O(1,Bht,1,3,"polygon",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.selected)}}function Uht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",9),W("click",function(){const s=ne(t).$implicit;return re(p(2).selectStack(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p().index,i=p();_(1),ve("id","piece_",t.x,"_",t.y,""),y("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n)}}function Wht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",6),W("click",function(){ne(t);const i=p().$implicit;return re(p(2).selectStack(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p().index,i=p();ve("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),I("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")("points",i.getHexaPointsAtXY(t.x,t.y))}}function qht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Wht,1,5,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function jht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Uht,2,8,"g",1),O(2,qht,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t),_(1),y("ngForOf",t)}}function Zht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",10),W("click",function(){const s=ne(t).$implicit;return re(p(2).selectRemaining(s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),Dn("id","remainingPiece_",t.toString(),""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),I("transform",i.getRemainingPieceTransform(t))}}function Yht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Zht,2,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.pieces)}}function Kht(r,e){if(1&r&&(A(),V(0,"polygon",11)),2&r){const t=p();I("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function Xht(r,e){if(1&r&&(A(),V(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);Dn("id","inspectedStack_",n,""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),I("transform",i.inspectedStackTransform)}}function Qht(r,e){if(1&r&&(A(),S(0,"g"),O(1,Xht,1,8,"g",12),P()),2&r){const t=p();_(1),y("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class c3e extends Aae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class Jht extends Aae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let ept=(()=>{var r;class e extends mu{constructor(n){super(n),u(this,"ORIGIN",new v(0,0)),u(this,"remainingStacks",[]),u(this,"layers",[]),u(this,"ground",new c3e),u(this,"inspectedStack",g.empty()),u(this,"inspectedStackCoord",g.empty()),u(this,"selectedRemaining",g.empty()),u(this,"selectedStart",g.empty()),u(this,"selectedSpiderCoords",[]),u(this,"PIECE_HEIGHT",void 0),u(this,"boardViewBox",void 0),u(this,"viewBox",void 0),u(this,"inspectedStackTransform",void 0),this.rules=c2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,c2.get(),new Iht,new o3e),new On($localize`MCTS`,new o3e,this.rules)],this.encoder=P2.encoder,this.tutorial=(new a3e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new _u(1.5*this.SPACE_SIZE,new v(2*this.SPACE_SIZE,0),qr.INSTANCE),this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.layers=[];for(const o of i.getState().occupiedSpaces()){const a=i.getState().getAt(o),c=o.x,l=o.y;for(let f=0;f<a.size();f++){f in i.layers||(i.layers[f]=new Jht);const d=a.pieces[a.size()-1-f];i.layers[f].initialize(new v(c,l),d)}}i.ground=i.getGround(),i.computeViewBox(),i.remainingStacks=i.getState().remainingPieces.toListOfStacks(),i.canPass=c2.get().shouldPass(i.getState());const s=c2.get().getGameStatus(i.node);switch(s){case _e.ONGOING:break;case _e.DRAW:i.highlight(i.getState().queenBeeLocation(k.ZERO).get(),"victory-stroke"),i.highlight(i.getState().queenBeeLocation(k.ONE).get(),"victory-stroke");break;default:const a=s.winner.getOpponent();i.highlight(i.getState().queenBeeLocation(a).get(),"victory-stroke")}})()}highlight(n,i){const s=this.getState().getAt(n).size();s-1 in this.layers&&this.layers[s-1].highlight(n,i)}pass(){var n=this;return M(function*(){return B.assert(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(P2.PASS)})()}computeViewBox(){const n=this.getPieceCoords().union(this.getAllNeighbors()).toList();n.push(new v(0,0)),this.boardViewBox=$a.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH);const i=new $a(this.getRemainingPieceTransformAsCoord(new a2(k.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let o=0;this.getState().remainingPieces.getAny(k.ZERO).isPresent()&&(o=s);let a=0;this.getState().remainingPieces.getAny(k.ONE).isPresent()&&(a=s);const c=this.boardViewBox.containingAtLeast(i).expand(0,0,o,a);if(this.inspectedStack.isPresent()){const l=new v(c.right()+this.SPACE_SIZE,c.center().y),f=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${l.x} ${l.y+3*(f-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const n=new c3e;for(const i of this.getAllNeighbors())n.initialize(i);return n}getAllNeighbors(){const n=new st;for(const i of this.getPieceCoords())n.addAll(new st(this.getState().emptyNeighbors(i)));return n.isEmpty()&&n.add(new v(0,0)),n}clearHighlights(){for(const n of this.layers)n.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=g.empty(),this.selectedRemaining=g.empty(),this.selectedSpiderCoords=[],this.inspectedStack=g.empty(),this.computeViewBox()}showLastMove(n){var i=this;return M(function*(){for(const s of i.getLastMoveCoords(n))i.highlight(s,"last-move-stroke"),i.ground.highlightStroke(s,"last-move-stroke"),i.ground.highlightFill(s,"moved-fill")})()}getLastMoveCoords(n){let i=[];return n instanceof fa?i=[n.coord]:n instanceof Yi&&(i=[n.getStart(),n.getEnd()]),i}getRemainingPieceTransformAsCoord(n){const i=this.getRemainingPieceShift(n),s=this.boardViewBox.center().x+i*this.SPACE_SIZE*4;let o;return o=n.owner===this.getPointOfView()?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new v(s,o)}getRemainingPieceTransform(n){const i=this.getRemainingPieceTransformAsCoord(n);return`translate(${i.x} ${i.y})`}getRemainingPieceHighlightTransform(n){const i=this.getRemainingPieceTransformAsCoord(n),s=this.getState().remainingPieces.getQuantity(n);return`translate(${i.x} ${i.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(n){switch(n.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return B.expectToBe(n.kind,"SoldierAnt"),1.5}}selectRemaining(n){var i=this;return M(function*(){const s=yield i.canUserPlay(`#remainingPiece_${n.toString()}`);if(s.isFailure())return i.cancelMove(s.getReason());if(n.owner===i.getCurrentOpponent())return i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if("QueenBee"!==n.kind&&c2.get().mustPlaceQueenBee(i.getState()))return i.cancelMove(pr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(i.selectedRemaining.equalsValue(n))i.cancelMoveAttempt();else{i.cancelMoveAttempt(),i.selectedRemaining=g.of(n),i.clearHighlights();const o=c2.get().getPossibleDropLocations(i.getState()).toList();for(const a of o)i.ground.highlightStroke(a,"clickable-stroke")}return b.SUCCESS})()}selectStack(n,i){var s=this;return M(function*(){return yield s.select(new v(n,i),"piece")})()}selectSpace(n,i){var s=this;return M(function*(){return yield s.select(new v(n,i),"space")})()}select(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay(`#${i}_${n.x}_${n.y}`);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState(),c=a.getAt(n);if(s.selectedRemaining.isPresent()){const l=P2.drop(s.selectedRemaining.get(),n);return s.chooseMove(l)}if(s.selectedStart.isPresent()){const l=a.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(n)?s.cancelMove():s.selectTarget(n,l)}return 0===c.size()?s.cancelMove():s.selectStart(n,c)})()}selectTarget(n,i){var s=this;return M(function*(){if("Spider"===i.kind)return s.selectNextSpiderSpace(n);{const o=P2.move(s.selectedStart.get(),n);return je(o.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(o.get())}})()}selectStart(n,i){var s=this;return M(function*(){const o=s.getState(),a=i.topPiece();return a.owner===o.getCurrentOpponent()?1===i.size()?s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),b.SUCCESS):(s.highlight(n,"selected-stroke"),s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox(),b.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==a.kind&&c2.get().mustPlaceQueenBee(o)?s.cancelMove(pr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=g.of(n),s.highlight(n,"selected-stroke"),"Spider"===a.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),i.size()>1&&(s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox()),s.highlightNextPossibleCoords(n),b.SUCCESS))})()}highlightNextPossibleCoords(n){for(const i of this.getNextPossibleCoords(n))this.highlight(i,"clickable-stroke"),this.ground.highlightStroke(i,"clickable-stroke")}getNextPossibleCoords(n){const i=this.getState(),s=i.getAt(n).topPiece(),o=c2.get().getPossibleMovesFrom(i,n);return"Spider"===s.kind?o.filter(c=>qt.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():o.map(a=>a.getEnd()).toList()}selectNextSpiderSpace(n){var i=this;return M(function*(){if(i.selectedSpiderCoords.push(n),4===i.selectedSpiderCoords.length){const o=P2.spiderMove(i.selectedSpiderCoords);return i.chooseMove(o)}const s=Qd.get().prefixLegality(i.selectedSpiderCoords,i.getState());if(s.isFailure())return i.cancelMove(s.getReason());i.clearHighlights(),i.highlight(i.selectedStart.get(),"selected-stroke");for(const o of i.selectedSpiderCoords)i.ground.select(o);return i.highlightNextPossibleCoords(i.selectedStart.get()),b.SUCCESS})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-hive"]],features:[Ke],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Vht,2,4,"g",1),O(2,$ht,2,1,"g",1),O(3,Ght,2,1,"g",1),O(4,jht,3,2,"g",1),O(5,Yht,2,1,"g",1),O(6,Kht,1,2,"polygon",2),O(7,Qht,2,1,"g",3),P()),2&n&&(I("viewBox",i.viewBox),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.layers),_(1),y("ngForOf",i.remainingStacks),_(1),y("ngIf",i.selectedRemaining.isPresent()),_(1),y("ngIf",i.inspectedStack.isPresent()))},dependencies:[Dt,Wt,wt,Hht],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const tpt={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:k.ZERO};class to extends yu{static from(e,t){const n=yu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new to(e,t))}getMaximalDistance(){return 11}}u(to,"encoder",qi.getFallibleEncoder(to.from));class e3 extends $L{static get(){return e3.singleton.isAbsent()&&(e3.singleton=g.of(new e3)),e3.singleton.get()}constructor(){super(tpt,to.from)}getInitialState(){const e=on.UNOCCUPIED,t=on.INVADERS,n=on.DEFENDERS;return new W2([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,n,e,e,e,e,t],[t,e,e,e,n,n,n,e,e,e,t],[t,t,e,n,n,on.PLAYER_ONE_KING,n,n,e,t,t],[t,e,e,e,n,n,n,e,e,e,t],[t,e,e,e,e,n,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}}u(e3,"singleton",g.empty());const N=on.UNOCCUPIED,At=on.INVADERS,gr=on.DEFENDERS,DC=on.PLAYER_ONE_KING;class u3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,e3.get().getInitialState()),j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,e3.get().getInitialState(),to.from(new v(5,1),new v(1,1)).get(),$localize`Congratulations!`),j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new W2([[N,N,N,N,At,At,At,At,N,N,N],[N,N,N,N,N,At,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[At,N,N,N,N,gr,N,N,N,N,At],[At,N,N,At,gr,gr,gr,N,N,N,At],[At,At,N,gr,gr,DC,gr,gr,N,At,At],[At,N,N,N,gr,gr,gr,N,N,N,At],[At,N,N,N,N,gr,N,N,N,N,At],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,At,N,N,N,N,N],[N,N,N,At,At,At,At,At,N,N,N]],1),[to.from(new v(5,3),new v(3,3)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(to.from(new v(3,0),new v(3,4)).get()),j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new W2([[N,N,N,At,At,At,At,At,N,N,N],[N,gr,N,N,N,At,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,gr,N,N,N,N,At],[At,N,N,N,N,gr,gr,N,N,N,At],[At,At,DC,N,gr,N,gr,gr,N,N,At],[N,N,At,N,N,gr,gr,N,N,N,At],[At,N,N,N,N,gr,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[N,N,N,At,At,At,At,N,At,N,N]],12),[to.from(new v(3,0),new v(3,5)).get(),to.from(new v(3,10),new v(3,5)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),j.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new W2([[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[At,DC,N,At,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[to.from(new v(3,4),new v(2,4)).get()],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),j.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new W2([[N,N,At,DC,At,N,N,N,N,N,N],[N,N,N,N,N,N,gr,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,At,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[to.from(new v(3,3),new v(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function npt(r,e){1&r&&(A(),V(0,"polygon",8))}function rpt(r,e){1&r&&(A(),V(0,"rect",9))}function ipt(r,e){if(1&r&&(A(),S(0,"g"),O(1,npt,1,0,"polygon",6),O(2,rpt,1,0,"ng-template",null,7,dn),P()),2&r){const t=un(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function spt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function opt(r,e){if(1&r&&(A(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function apt(r,e){if(1&r&&(A(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function cpt(r,e){if(1&r&&(A(),O(0,opt,1,1,"polyline",14),O(1,apt,4,20,"ng-template",null,15,dn)),2&r){const t=un(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function lpt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"circle",10),O(2,spt,6,25,"g",11),O(3,cpt,3,2,"ng-template",null,12,dn),P()),2&r){const t=un(4),n=p().index,i=p().index,s=p();_(1),ve("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function upt(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(1,"rect",4),O(2,ipt,4,2,"g",5),O(3,lpt,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ve("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ve("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function fpt(r,e){if(1&r&&(A(),S(0,"g"),O(1,upt,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function dpt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ve("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let hpt=(()=>{var r;class e extends BL{constructor(n){super(n,to.from),this.rules=e3.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=to.encoder,this.tutorial=(new u3e).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-hnefatafl"]],features:[Ke],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,fpt,2,1,"g",1),O(2,dpt,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class ppt extends Zae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=g.of(this.generateMove(e));else{const t=this.addToMove(e);this.currentMove=g.of(t)}}}class no extends Ss{static get(){return no.singleton.isAbsent()&&(no.singleton=g.of(new no)),no.singleton.get()}constructor(){super({passByPlayerStore:!0,mustFeed:!1,feedOriginalHouse:!0})}isLegal(e,t){const n=t.getCurrentPlayerY();let i=!0;for(const s of e){B.assert(!0===i,"CANNOT_PLAY_AFTER_NON_KALAH_MOVE");const o=this.isLegalDistribution(s,t);if(o.isFailure())return b.ofFallible(o);t=this.distributeHouse(s.x,n,t).resultingState,i=o.get()}return B.assert(!1===i,"MUST_CONTINUE_PLAYING_AFTER_KALAH_MOVE"),b.SUCCESS}isLegalDistribution(e,t){const n=t.getCurrentPlayerY();if(0===t.getPieceAtXY(e.x,n))return Q.failure(Cu.MUST_CHOOSE_NON_EMPTY_HOUSE());const i=this.distributeHouse(e.x,n,t),s=Ss.isStarving(i.resultingState.getCurrentPlayer(),i.resultingState.board);return Q.success(i.endsUpInKalah&&!1===s)}distributeMove(e,t){const n=t.getCurrentPlayer().value,i=t.getCurrentPlayerY(),s=[];let o=0,a=!1,c=t;for(const d of e){const m=this.distributeHouse(d.x,i,c);c.getScoresCopy()[n]+=m.passedByKalahNTimes,c=m.resultingState,s.push(...m.filledCoords),o+=m.passedByKalahNTimes,a=m.endsUpInKalah}const l=c.getScoresCopy();return l[n]+=o,{endsUpInKalah:a,filledCoords:s,passedByKalahNTimes:o,resultingState:new i1(c.getCopiedBoard(),c.turn,l)}}applyCapture(e){const t=e.resultingState,n={capturedSum:0,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]],resultingState:t};if(e.endsUpInKalah)return n;{const i=e.filledCoords[e.filledCoords.length-1],s=e.resultingState.getCurrentPlayerY(),o=e.resultingState.getOpponentY(),a=e.resultingState.getPieceAt(i),c=e.resultingState.getPieceAtXY(i.x,o);if(i.y===s&&1===a&&c>0){const l=t.getCopiedBoard(),f=l[0][i.x]+l[1][i.x],d=xt.create(i1.WIDTH,2,0);d[0][i.x]=l[0][i.x],d[1][i.x]=l[1][i.x],l[0][i.x]=0,l[1][i.x]=0;const m=t.getScoresCopy();return m[t.getCurrentPlayer().value]+=f,{capturedSum:f,captureMap:d,resultingState:new i1(l,t.turn,m)}}return n}}}var f3e;u(no,"singleton",g.empty());class ha extends Gae{static of(e,t=[]){const n=[e];return n.push(...t),new ha(n)}add(e){return ha.of(this.distributions[0],this.distributions.slice(1).concat(e))}toString(){return"KalahMove(["+this.distributions.map(t=>t.x).join(", ")+"])"}equals(e){return qt.compare(this.distributions,e.distributions)}}f3e=ha,u(ha,"encoder",we.tuple([we.list(p1.encoder)],r=>[r.distributions],r=>f3e.of(r[0][0],r[0].slice(1))));class d3e extends qn{constructor(...e){super(...e),u(this,"gameName",$localize`Kalah`),u(this,"tutorial",[j.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,no.get().getInitialState()),j.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,no.get().getInitialState()),Uae.sowing(no.get().getInitialState(),ha.of(p1.FIVE)),j.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your last house to the first of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,no.get().getInitialState(),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),j.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,no.get().getInitialState(),ha.of(p1.THREE,[p1.ONE]),(t,n,i)=>1===t.distributions.length?b.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):b.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Capture`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new i1([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,[0,0]),ha.of(p1.ONE,[p1.ZERO,p1.THREE]),(t,n,i)=>0===i.getPieceAtXY(1,0)?b.SUCCESS:b.failure($localize`You did not capture, try again!`),$localize`Congratulations!`),j.fromMove($localize`End of the game`,$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new i1([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,[19,24]),[ha.of(p1.FIVE)],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)])}}class gpt extends Fn{getListMoves(e){const t=[],n=e.gameState.getCurrentPlayerY();for(let i=0;i<i1.WIDTH;i++)if(e.gameState.getPieceAtXY(i,n)>0){const s=e.gameState,o=ha.of(p1.of(i));t.push(...this.getPossibleMoveContinuations(s,i,n,o))}return t}getPossibleMoveContinuations(e,t,n,i){const s=[],o=no.get().distributeHouse(t,n,e),a=o.resultingState,c=!1===Ss.isStarving(a.getCurrentPlayer(),a.board);if(o.endsUpInKalah&&c){for(let l=0;l<i1.WIDTH;l++)if(a.getPieceAtXY(l,n)>0){const f=i.add(p1.of(l));s.push(...this.getPossibleMoveContinuations(a,l,n,f))}return s}return[i]}}function mpt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",8),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",s.getSpaceClasses(n,i))("rotation",s.getPieceRotation())("secondaryContent",s.getHouseSecondaryContent(n,i)),I("transform",s.getPieceTransform(n,i))}}function _pt(r,e){if(1&r&&(A(),S(0,"g"),O(1,mpt,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let vpt=(()=>{var r;class e extends ppt{constructor(n,i){super(n,i),this.rules=no.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(new gpt),this.encoder=ha.encoder,this.tutorial=(new d3e).tutorial}generateMove(n){return ha.of(p1.of(n))}addToMove(n){return this.currentMove.get().add(p1.of(n))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t),U(R3))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-kalah-component"]],features:[Ke],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),V(1,"rect",1),O(2,_pt,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(I("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,Yae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})),e})();var t3,HC,aR,O2;class Cn{static of(e){switch(e){case 0:return Cn.ANY;case 1:return Cn.ORANGE;case 2:return Cn.BLUE;case 3:return Cn.PURPLE;case 4:return Cn.PINK;case 5:return Cn.YELLOW;case 6:return Cn.RED;case 7:return Cn.GREEN;default:return B.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),Cn.BROWN}}constructor(e,t,n){u(this,"value",void 0),u(this,"name",void 0),u(this,"rgb",void 0),this.value=e,this.name=t,this.rgb=n}}u(Cn,"ANY",new(t3=Cn)(0,"any","#000")),u(Cn,"ORANGE",new t3(1,"orange","#d67421")),u(Cn,"BLUE",new t3(2,"blue","#006bac")),u(Cn,"PURPLE",new t3(3,"purple","#6f3787")),u(Cn,"PINK",new t3(4,"pink","#d2719e")),u(Cn,"YELLOW",new t3(5,"yellow","#e2c200")),u(Cn,"RED",new t3(6,"red","#d23339")),u(Cn,"GREEN",new t3(7,"green","#009157")),u(Cn,"BROWN",new t3(8,"brown","#562500"));class pn{constructor(e,t){u(this,"player",void 0),u(this,"color",void 0),this.player=e,this.color=t}static of(e,t){return new pn(e,Cn.of(t))}static createPlayerColors(e){return{ORANGE:new pn(e,Cn.ORANGE),BLUE:new pn(e,Cn.BLUE),PURPLE:new pn(e,Cn.PURPLE),PINK:new pn(e,Cn.PINK),YELLOW:new pn(e,Cn.YELLOW),RED:new pn(e,Cn.RED),GREEN:new pn(e,Cn.GREEN),BROWN:new pn(e,Cn.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(q.NONE)}belongsTo(e){return this.player===e}}u(pn,"EMPTY",new(HC=pn)(q.NONE,Cn.ANY)),u(pn,"ZERO",HC.createPlayerColors(k.ZERO)),u(pn,"ONE",HC.createPlayerColors(k.ONE));class Si{static getColorAt(e,t){return Si.COLORS[t][e]}static getInitialBoard(){const e=pn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>pn.of(k.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>pn.of(k.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(pn.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const s=new v(i,n);!1===Si.isEmptyAt(e,s)&&t.push(s)}return t}}u(Si,"INITIAL",Si.getInitialBoard()),u(Si,"SIZE",8),u(Si,"COLORS",xt.map([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Cn.of));class P4 extends L1{static isOnBoard(e){return e.isInRange(Si.SIZE,Si.SIZE)}constructor(e,t,n,i,s){super(xt.copy(s),e),u(this,"colorToPlay",void 0),u(this,"coordToPlay",void 0),u(this,"alreadyPassed",void 0),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class Lu extends vi{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}u(Lu,"PASS",new(aR=Lu)),u(Lu,"encoder",we.constant("PASS",aR.PASS));class U0 extends Qs{static of(e,t){return B.assert(P4.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),B.assert(P4.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new U0(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!O2.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function Cpt(r){return r instanceof Lu}u(U0,"encoder",qi.getEncoder(U0.of)),function(r){r.PASS=Lu.PASS,r.of=function e(n,i){return U0.of(n,i)},r.isPiece=function t(n){return n instanceof U0},r.encoder=we.disjunction([r.isPiece,Cpt],[U0.encoder,Lu.encoder])}(O2||(O2={}));let th=(()=>{class r{}return u(r,"NOT_RIGHT_COLOR",()=>$localize`This piece is not of the color you have to play.`),u(r,"DIRECTION_NOT_ALLOWED",()=>$localize`You can only move forward, orthogonally or diagonally.`),u(r,"MOVE_BLOCKED",()=>$localize`This move is blocked by another piece.`),u(r,"PLAY_WITH_SELECTED_PIECE",()=>$localize`You must play with the selected piece.`),r})();class T2 extends jn{static get(){return T2.singleton.isAbsent()&&(T2.singleton=g.of(new T2)),T2.singleton.get()}getInitialState(){return new P4(0,Cn.ANY,g.empty(),!1,Si.INITIAL)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new v(0,7),new v(1,7),new v(2,7),new v(3,7),new v(4,7),new v(5,7),new v(6,7),new v(7,7)]}static getMovablePieces(e){return T2.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&Si.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===k.ONE?[ye.DOWN,ye.DOWN_LEFT,ye.DOWN_RIGHT]:[ye.UP,ye.UP_LEFT,ye.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===k.ZERO?e.y<0:e.y>0}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return Si.allPieceCoords(e.board).forEach(i=>{const s=e.getPieceAt(i);je(s!==pn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),s.player===k.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),[t,n]}static isLegal(e,t){if(O2.isPiece(e)){const n=e.getStart(),i=e.getEnd(),s=t.colorToPlay,o=t.getPieceAt(n);if(o.isEmpty())return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(o.belongsTo(t.getCurrentOpponent()))return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(s!==Cn.ANY&&o.color!==s)return b.failure(th.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return b.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const c=ye.factory.fromMove(n,i);if(c.isFailure())return b.failure(th.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===T2.directionAllowedForPlayer(l,t.getCurrentPlayer()))return b.failure(th.DIRECTION_NOT_ALLOWED());let f=n;for(;!1===f.equals(i);)if(f=f.getNext(l),!1===t.getPieceAt(f).isEmpty())return b.failure(th.MOVE_BLOCKED());return b.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?b.SUCCESS:b.failure(Ee.CANNOT_PASS())}nextCoordToPlay(e,t){return g.ofNullable(Si.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n){if(O2.isPiece(e)){const i=e.getStart(),s=e.getEnd(),o=t.getCopiedBoard();o[s.y][s.x]=o[i.y][i.x],o[i.y][i.x]=pn.EMPTY;const a=Si.getColorAt(s.x,s.y),c=this.nextCoordToPlay(t,a);return new P4(t.turn+1,a,c,!1,o)}{const i=this.nextCoordToPlay(t,t.colorToPlay);return new P4(t.turn+1,t.colorToPlay,i,!0,t.board)}}isLegal(e,t){return T2.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(T2.mustPass(t)&&t.alreadyPassed)return _e.getDefeat(n);const[i,s]=T2.getFurthestPiecePositions(t);return 7===s?_e.ONE_WON:0===i?_e.ZERO_WON:_e.ONGOING}}u(T2,"singleton",g.empty());const K=pn.EMPTY,VC=pn.ZERO.ORANGE,FC=pn.ONE.ORANGE,$C=pn.ZERO.BLUE,BC=pn.ONE.BLUE,cR=pn.ZERO.PURPLE,nh=pn.ONE.PURPLE,GC=pn.ZERO.PINK,UC=pn.ONE.PINK,WC=pn.ZERO.YELLOW,qC=pn.ONE.YELLOW,jC=pn.ZERO.RED,ZC=pn.ONE.RED,YC=pn.ZERO.GREEN,KC=pn.ONE.GREEN,XC=pn.ZERO.BROWN,QC=pn.ONE.BROWN;class g3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new P4(5,Cn.ORANGE,g.empty(),!1,[[XC,BC,nh,UC,qC,ZC,KC,QC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,FC,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,YC,jC,WC,GC,cR,$C,VC]])).withPreviousMove(O2.of(new v(0,7),new v(0,0))),j.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,T2.get().getInitialState(),O2.of(new v(7,7),new v(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),j.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new P4(1,Cn.PINK,g.of(new v(3,0)),!1,[[FC,BC,nh,UC,qC,ZC,KC,QC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,$C,K],[K,K,K,K,K,K,K,K],[XC,YC,jC,WC,GC,cR,K,VC]]),[O2.of(new v(3,0),new v(3,6)),O2.of(new v(3,0),new v(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(O2.of(new v(6,7),new v(6,5))),j.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new P4(1,Cn.PINK,g.of(new v(3,6)),!1,[[FC,BC,nh,K,qC,ZC,KC,QC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,$C],[K,K,K,K,K,K,K,K],[K,K,K,UC,K,K,K,K],[XC,YC,jC,WC,GC,cR,K,VC]])).withPreviousMove(O2.of(new v(6,5),new v(7,4))),j.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new P4(2,Cn.RED,g.of(new v(2,4)),!1,[[K,BC,nh,K,K,ZC,K,K],[K,K,K,qC,K,K,K,K],[K,K,K,UC,K,nh,K,K],[K,K,K,WC,K,K,K,K],[K,K,jC,K,K,K,K,K],[K,K,K,K,K,K,KC,K],[FC,K,K,K,K,GC,K,QC],[XC,YC,K,K,K,K,$C,VC]]),[O2.of(new v(2,4),new v(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(O2.of(new v(4,0),new v(3,1)))])}}class ypt extends tr{getMetrics(e){const t=e.gameState,[n,i]=T2.getFurthestPiecePositions(t);return[7-n,i]}}class m3e extends Fn{getListMoves(e){const t=e.gameState,n=T2.getMovablePieces(t);if(0===n.length)return B.assert(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[O2.PASS];{const i=this.getListMovesFromNonBlockedState(t,n);return qt.sortByDescending(i,s=>s.length()),i}}getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const s of t)for(const o of T2.playerDirections(i))for(let a=1;a<Si.SIZE;a++){const c=s.getNext(o,a);if(!e.isOnBoard(c)||!Si.isEmptyAt(e.board,c))break;{const l=O2.of(s,c);n.push(l)}}return n}}function Mpt(r,e){if(1&r&&(A(),V(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.piecePlayerClass(n)),I("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function Ept(r,e){if(1&r&&(A(),V(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();I("x",o.SPACE_SIZE/2+n*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+s*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Spt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",4),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(2,"rect",5),O(3,Mpt,1,4,"circle",6),O(4,Ept,1,7,"rect",7),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","click_",n,"_",i,""),_(1),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("fill",s.backgroundColor(n,i)),_(1),y("ngIf",t!==s.UNOCCUPIED),_(1),y("ngIf",t!==s.UNOCCUPIED)}}function Ppt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Spt,5,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Opt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"rect",10)(2,"rect",10),P()),2&r){const t=p();_(1),ve("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),I("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),ve("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),I("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Tpt(r,e){if(1&r&&(A(),V(0,"circle",11)),2&r){const t=p();I("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let bpt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"UNOCCUPIED",pn.EMPTY),u(this,"lastMove",g.empty()),u(this,"lastPieceMove",g.empty()),u(this,"chosen",g.empty()),u(this,"chosenAutomatically",!1),this.hasAsymmetricBoard=!0,this.rules=T2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,T2.get(),new ypt,new m3e),new On($localize`MCTS`,new m3e,this.rules)],this.encoder=O2.encoder,this.tutorial=(new g3e).tutorial,this.canPass=!1}backgroundColor(n,i){return Si.getColorAt(n,i).rgb}isPlayerZero(n){return n.player===k.ZERO}pieceColor(n){return n.color.rgb}piecePlayerClass(n){return this.getPlayerClass(n.player)}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.lastPieceMove=g.empty(),i.canPass=T2.mustPass(s);const o=i.rules.getGameStatus(i.node)!==_e.ONGOING;i.canPass||s.coordToPlay.isAbsent()||o?(i.chosenAutomatically=!1,i.chosen=g.empty()):(i.chosenAutomatically=!0,i.chosen=s.coordToPlay)})()}showLastMove(n){var i=this;return M(function*(){O2.isPiece(n)&&(i.lastPieceMove=g.of(n))})()}pass(){var n=this;return M(function*(){return je(n.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),n.chooseMove(O2.PASS)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i);if(s.canPass)return s.cancelMove(Ee.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(n,i);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const c=s.getState().getPieceAtXY(n,i),l=s.getState().getCurrentPlayer();return c.belongsTo(l)?s.chosenAutomatically?s.cancelMove(th.PLAY_WITH_SELECTED_PIECE()):(s.chosen=g.of(a),b.SUCCESS):yield s.chooseDestination(n,i)}})()}choosePiece(n,i){var s=this;return M(function*(){const o=s.getState().getPieceAtXY(n,i),a=s.getState().getCurrentOpponent();return o.belongsTo(a)?s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(s.chosen=g.of(new v(n,i)),b.SUCCESS)})()}chooseDestination(n,i){var s=this;return M(function*(){const o=s.chosen.get(),a=new v(n,i),c=O2.of(o,a);return s.chooseMove(c)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=g.empty())}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-kamisado"]],features:[Ke],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Ppt,2,1,"g",1),O(2,Opt,3,12,"g",2),O(3,Tpt,1,3,"circle",3),P()),2&n&&(I("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.lastPieceMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),_3e=(()=>{var r;class e extends Ci{getParallelogramCoords(n){const i=n.parallelogramHeight,s=i*n.horizontalWidthRatio,o=i*n.offsetRatio,a=s,l=s-o,f=i,d=-o,m=i;return[new v(0,0),new v(a,0),new v(l,f),new v(d,m)]}getCoordTranslate(n,i,s,o){const a=o.parallelogramHeight;return new v(n*(a*o.horizontalWidthRatio)+o.offsetRatio*a*(o.abstractBoardSize-i),i*a-o.pieceHeightRatio*a*s)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",Be({type:r,selectors:[["ng-component"]],features:[Ke],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),O4=(()=>{class r{}return u(r,"CANNOT_GO_BACKWARD",()=>$localize`You cannot go backward with normal pieces!`),u(r,"CANNOT_CAPTURE_EMPTY_SPACE",()=>$localize`You cannot capture an empty square, nor jump over it!`),u(r,"CANNOT_SKIP_CAPTURE",()=>$localize`You must capture when it is possible!`),u(r,"MUST_FINISH_CAPTURING",()=>$localize`You must finish this capture!`),u(r,"THIS_PIECE_CANNOT_MOVE",()=>$localize`This piece cannot move!`),u(r,"CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL",()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`),u(r,"MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL",()=>$localize`You must move in a single diagonal step!`),u(r,"CANNOT_CAPTURE_TWICE_THE_SAME_COORD",()=>$localize`You cannot jump over the same square several times!`),r})();var rh;class Q2{static getPlayerOfficer(e){return e===k.ZERO?Q2.ZERO_OFFICER:Q2.ONE_OFFICER}constructor(e,t){u(this,"player",void 0),u(this,"isOfficer",void 0),this.player=e,this.isOfficer=t}toString(){switch(this){case Q2.ZERO:return"u";case Q2.ONE:return"v";case Q2.ZERO_OFFICER:return"O";default:return B.expectToBe(this,Q2.ONE_OFFICER),"X"}}equals(e){return this===e}}u(Q2,"ZERO",new(rh=Q2)(k.ZERO,!1)),u(Q2,"ONE",new rh(k.ONE,!1)),u(Q2,"ZERO_OFFICER",new rh(k.ZERO,!0)),u(Q2,"ONE_OFFICER",new rh(k.ONE,!0));class As{constructor(e){u(this,"pieces",void 0),this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new As(this.pieces.slice(1))}capturePiece(e){return new As(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=Q2.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new As([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}u(As,"EMPTY",new As([]));let mr=(()=>{class r extends L1{static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++)this.getPieceAtXY(s,i).isCommandedBy(t)&&n.push(new v(s,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,As.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===k.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++){const o=this.getPieceAtXY(s,i).getStackSize();t=Math.max(t,o)}const n=[];for(let i=0;i<r.SIZE;i++){const s=[];for(let o=0;o<r.SIZE;o++)s.push(this.getPieceAtXY(o,i).toString(t));n.push(s.join(" "))}return n.join("\n")}}return u(r,"SIZE",7),r})();class wpt extends st{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===bo(e.get(t),this.get(t)))return!1;return!0}get(e){return B.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return B.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}var C3e;class jr extends vi{static of(e,t){return new jr(e,t)}static fromCapture(e){const t=jr.getSteppedOverCoords(e);return t.isSuccess()?Q.success(new jr(e,!1)):Q.failure(t.getReason())}static getSteppedOverCoords(e){let t=g.empty();const n=new st;for(const i of e){if(mr.isNotOnBoard(i))return Q.failure(m4.OUT_OF_RANGE(i));if(t.isPresent()){const s=t.get();if(!1===s.getVectorToward(i).isDiagonalOfLength(2))return Q.failure(O4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=s.getCoordsToward(i)[0];if(n.contains(a))return Q.failure(O4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=g.of(i)}return Q.success(n)}static fromStep(e,t){return mr.isNotOnBoard(e)?Q.failure(m4.OUT_OF_RANGE(e)):mr.isNotOnBoard(t)?Q.failure(m4.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?Q.failure(O4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):Q.success(new jr([e,t],!0))}constructor(e,t){super(),u(this,"isStep",void 0),u(this,"coords",void 0),this.isStep=t,this.coords=new wpt(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let s=0;s<i;s++)if(!1===this.coords.toList()[s].equals(e.coords.toList()[s]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return jr.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];je(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),s=qt.copy(i),o=e.coords.toList(),a=qt.copy(o).slice(1);return jr.fromCapture(s.concat(a)).get()}}C3e=jr,u(jr,"encoder",we.tuple([we.list(v.encoder),we.identity()],r=>[r.coords.toList(),r.isStep],r=>C3e.of(r[0],r[1])));class Is extends jn{static get(){return Is.singleton.isAbsent()&&(Is.singleton=g.of(new Is)),Is.singleton.get()}getInitialState(){const e=new As([Q2.ZERO]),t=new As([Q2.ONE]),n=As.EMPTY;return new mr([[t,n,t,n,t,n,t],[n,t,n,t,n,t,n],[t,n,t,n,t,n,t],[n,n,n,n,n,n,n],[e,n,e,n,e,n,e],[n,e,n,e,n,e,n],[e,n,e,n,e,n,e]],0)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceCaptures(e,s));return n}getPieceCaptures(e,t){let n=[];const o=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const f=t.getNext(l,1);if(mr.isOnBoard(f)&&e.getPieceAt(f).isCommandedBy(o)){const d=f.getNext(l,1);if(mr.isOnBoard(d)&&e.getPieceAt(d).isEmpty()){const m=e.remove(t).remove(f).set(d,c),E=jr.fromCapture([t,d]).get(),w=this.getPieceCaptures(m,d);if(0===w.length)n=n.concat(E);else{const R=w.map(z=>E.concatenate(z));n=n.concat(R)}}}}return n}getPieceDirections(e,t){const s=e.getPieceAt(t).getCommander().player.getScoreModifier(),o=[ye.factory.fromDelta(-1,s).get(),ye.factory.fromDelta(1,s).get()];return e.getPieceAt(t).getCommander().isOfficer&&o.push(ye.factory.fromDelta(-1,-s).get(),ye.factory.fromDelta(1,-s).get()),o}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceSteps(e,s));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const s of i){const o=t.getNext(s,1);if(mr.isOnBoard(o)&&e.getPieceAt(o).isEmpty()){const a=jr.fromStep(t,o).get();n.push(a)}}return n}applyLegalMove(e,t,n){const i=e.getStartingCoord(),s=e.getEndingCoord();let o=t.getPieceAt(i),a=t.remove(i);if(!1===e.isStep)for(const c of e.getCapturedCoords().get()){const l=t.getPieceAt(c),f=l.getCommander();o=o.capturePiece(f);const d=l.getPiecesUnderCommander();a=a.set(c,d)}if(a=a.set(s,o),s.y===t.getFinishLineOf(t.getCurrentPlayer())){const c=o.promoteCommander();a=a.set(s,c)}return a.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),s=t.getCurrentOpponent();if(i.isCommandedBy(s))return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const o=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(o).get().y===s.getScoreModifier())return b.failure(O4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(o).isEmpty())return b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?b.failure(O4.CANNOT_SKIP_CAPTURE()):b.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),s=e.getCapturedCoords().get();for(const o of s){const a=t.getPieceAt(o);if(a.isCommandedBy(i))return b.failure(Ee.CANNOT_SELF_CAPTURE());if(a.isEmpty())return b.failure(O4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(o=>o.equals(e))?b.SUCCESS:b.failure(O4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?_e.ONGOING:_e.getVictory(t.getCurrentOpponent())}}u(Is,"singleton",g.empty());const y3e=Q2.ZERO,lR=Q2.ONE,Zr=new As([y3e]),z1=new As([lR]),Npt=new As([y3e,lR]),Apt=new As([Q2.ZERO_OFFICER,lR]),Y=As.EMPTY;class M3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,Is.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,Is.get().getInitialState()),j.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,Is.get().getInitialState(),jr.fromStep(new v(4,4),new v(3,3)).get(),$localize`Congratulations!`),j.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,mr.of([[z1,Y,Y,Y,z1,Y,z1],[Y,Y,Y,z1,Y,z1,Y],[Y,Y,z1,Y,z1,Y,z1],[Y,z1,Y,Y,Y,Y,Y],[Zr,Y,Zr,Y,Zr,Y,Zr],[Y,Zr,Y,Zr,Y,Zr,Y],[Zr,Y,Zr,Y,Zr,Y,Zr]],2),jr.fromCapture([new v(2,4),new v(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),j.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,mr.of([[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[z1,Y,Y,Y,z1,Y,z1],[Y,z1,Y,z1,Y,z1,Y],[Y,Y,z1,Y,z1,Y,z1],[Y,z1,Y,Y,Y,Y,Y],[Y,Y,Zr,Y,Zr,Y,Zr]],2),jr.fromCapture([new v(2,6),new v(0,4),new v(2,2)]).get(),$localize`Congratulations!`),j.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,mr.of([[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,z1,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,z1,Y,z1,Y,Y,Y],[Y,Y,Zr,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y]],2)),j.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,mr.of([[Y,Y,Y,Y,Y,Y,z1],[Y,Y,Y,Npt,Y,z1,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Zr,Y,Zr,Y,Zr]],2),[jr.fromStep(new v(3,1),new v(2,0)).get(),jr.fromStep(new v(3,1),new v(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),j.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,mr.of([[Y,Y,Y,Y,Apt,Y,z1],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,z1,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y],[Y,Y,Zr,Y,Zr,Y,Zr]],2),[jr.fromStep(new v(4,0),new v(3,1)).get(),jr.fromStep(new v(4,0),new v(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)])}}class E3e extends tr{getMetrics(e){const t=e.gameState;return[this.getNumberOfMobileCoords(t,k.ZERO),this.getNumberOfMobileCoords(t,k.ONE)]}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(o=>o.getStartingCoord());return new st(i).size()}getCapturesAndSteps(e,t){const n=Is.get().getCapturesOf(e,t),i=Is.get().getStepsOf(e,t);return n.concat(i)}}class Ipt extends Fn{getListMoves(e){const t=Is.get().getCaptures(e.gameState);return t.length>0?t:Is.get().getSteps(e.gameState)}}class kpt extends E3e{getBoardValue(e){const t=12*super.getBoardValue(e).value;let n=0;for(let i=0;i<mr.SIZE;i++)for(let s=0;s<mr.SIZE;s++){const o=e.gameState.getPieceAtXY(s,i);if(o.getStackSize()>0){const a=o.getStackSize();let c=0;const l=o.getCommander().player;for(;c<a&&o.get(c).player===l;)c++;n+=c*l.getScoreModifier()}}return new Jn(t+n)}}function xpt(r,e){if(1&r&&(A(),V(0,"circle",15)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p(2);zi("id","square_",s.x,"_",s.y,"_piece_",n,"_officer_symbol"),y("ngClass",i.classes),I("cx",.4*o.SPACE_SIZE)("cy",.575*o.SPACE_SIZE)("r",.045*o.SPACE_SIZE)}}function Lpt(r,e){if(1&r&&(A(),S(0,"g",12),V(1,"use",13),O(2,xpt,1,7,"circle",14),P()),2&r){const t=e.$implicit,n=e.index,i=p().$implicit;I("transform",p(2).getPieceTranslate(n)),_(1),zi("id","square_",i.x,"_",i.y,"_piece_",n,""),y("ngClass",t.classes),_(1),y("ngIf",t.isOfficer)}}function Rpt(r,e){if(1&r){const t=pe();A(),S(0,"g",8)(1,"g",9),W("click",function(){const s=ne(t).$implicit;return re(p(2).onClick(s.x,s.y))}),V(2,"polygon",10),O(3,Lpt,3,6,"g",11),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ve("id","square_at_",n,"_",i,""),_(1),ve("id","coord_",t.x,"_",t.y,""),I("transform",s.getTranslate(n,i,0)),_(1),ve("id","square_",t.x,"_",t.y,""),y("ngClass",t.squareClasses),I("points",s.getParallelogramPoints()),_(1),y("ngForOf",t.pieceInfos)}}function zpt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Rpt,4,10,"g",7),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Dpt=(()=>{var r;class e extends _3e{constructor(n){super(n),u(this,"THICKNESS",40),u(this,"mode",{horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:mr.SIZE}),u(this,"LEFT",0),u(this,"UP",-this.SPACE_SIZE),u(this,"basicWidth",this.mode.abstractBoardSize*this.mode.parallelogramHeight),u(this,"WIDTH",this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio)),u(this,"HEIGHT",this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP),u(this,"CX",this.WIDTH/2),u(this,"CY",(this.HEIGHT+this.UP)/2),u(this,"adaptedBoard",{isAlreadySwitched:!1,spaceInfo:[]}),u(this,"lastMove",g.empty()),u(this,"currentMoveClicks",[]),u(this,"capturedCoords",[]),u(this,"legalMoves",[]),u(this,"moveGenerator",new Ipt),this.hasAsymmetricBoard=!0,this.rules=Is.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Control`,this.rules,new E3e,this.moveGenerator),new cn($localize`Control and Domination`,this.rules,new kpt,this.moveGenerator),new On($localize`MCTS`,this.moveGenerator,this.rules)],this.encoder=jr.encoder,this.tutorial=(new M3e).tutorial,this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.lastMove=i.node.previousMove;const s=i.getState();i.board=s.getCopiedBoard(),i.legalMoves=i.moveGenerator.getListMoves(i.node),i.createAdaptedBoardFrom(s),i.showPossibleMoves(),i.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(n){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let o=0;o<mr.SIZE;o++){const a=[];for(let c=0;c<mr.SIZE;c++){const l=this.getSpaceInfo(n,c,o);a.push(l)}this.adaptedBoard.spaceInfo.push(a)}const s=g.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const o=s.get();for(const a of this.getSpaceInfoAt(o).pieceInfos)a.classes.push("selected-stroke");this.showPossibleLandings(o,n)}for(const o of this.capturedCoords)this.getSpaceInfoAt(o).squareClasses.push("captured-fill");for(const o of this.currentMoveClicks)this.getSpaceInfoAt(o).squareClasses.push("moved-fill")}getSpaceInfo(n,i,s){const o=n.getPieceAtXY(i,s),a=[];for(let c=o.getStackSize()-1;c>=0;c--){const l=o.get(c);a.push({classes:[this.getPlayerClass(l.player)],isOfficer:l.isOfficer})}return{pieceInfos:a,x:i,y:s,squareClasses:[]}}showLastMove(n){var i=this;return M(function*(){i.showLastCapture(n),i.showSteppedOnCoord(n)})()}showLastCapture(n){if(!1===n.isStep){const i=n.getCapturedCoords();B.assert(i.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of i.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(n){for(const i of n.coords)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}showPossibleMoves(){if(this.isInteractive)for(const n of this.legalMoves){const i=n.getStartingCoord();this.getSpaceInfoAt(i).squareClasses.push("selectable-fill")}}getSpaceInfoAt(n){if(this.getPointOfView()===k.ONE&&this.adaptedBoard.isAlreadySwitched){const i=mr.SIZE-1,s=new v(i-n.x,i-n.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[n.y][n.x]}rotateAdaptedBoardIfNeeded(){if(this.getPointOfView()===k.ONE){const n=[];for(let i=0;i<mr.SIZE;i++){n[mr.SIZE-1-i]=[];for(let s=0;s<mr.SIZE;s++)n[mr.SIZE-1-i][mr.SIZE-1-s]=this.getSpaceInfoAt(new v(s,i))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:n}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#coord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i),c=s.getState().getPieceAt(a),l=s.getState().getCurrentOpponent();return c.isCommandedBy(l)?s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===s.currentMoveClicks.length?s.trySelectingPiece(a):s.moveClick(a)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(n){var i=this;return M(function*(){if(n.equals(i.currentMoveClicks[0]))return i.cancelMoveAttempt(),b.SUCCESS;const s=i.getState().getPieceAt(n),o=i.getState().getCurrentPlayer();if(s.isCommandedBy(o))return i.cancelMoveAttempt(),i.trySelectingPiece(n);if(1===i.currentMoveClicks.length&&i.currentMoveClicks[0].getVectorToward(n).isDiagonalOfLength(1)){const c=jr.fromStep(i.currentMoveClicks[0],n).get();return i.chooseMove(c)}return i.capture(n)})()}capture(n){var i=this;return M(function*(){const o=i.currentMoveClicks[i.currentMoveClicks.length-1],a=o.getVectorToward(n);if(a.isDiagonalOfLength(2)){const c=new v(o.x+a.x/2,o.y+a.y/2);i.capturedCoords.push(c),i.currentMoveClicks.push(n);const l=jr.fromCapture(i.currentMoveClicks).get();return i.legalMoves.some(f=>f.isPrefix(l))?i.applyPartialCapture():i.chooseMove(l)}return i.cancelMove(O4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let n=this.getState().remove(this.currentMoveClicks[0]),i=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const o of this.capturedCoords){const a=this.getState().getPieceAt(o),c=a.getCommander(),l=a.getPiecesUnderCommander();n=n.set(o,l),i=i.capturePiece(c)}return n=n.set(this.currentMoveClicks[this.currentMoveClicks.length-1],i),this.createAdaptedBoardFrom(n),this.rotateAdaptedBoardIfNeeded(),b.SUCCESS}trySelectingPiece(n){var i=this;return M(function*(){return i.getState().getPieceAt(n).isEmpty()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.selectPiece(n)})()}selectPiece(n){var i=this;return M(function*(){return i.capturedCoords=[],i.legalMoves.some(s=>s.getStartingCoord().equals(n))?(i.currentMoveClicks=[n],i.hideLastMove(),b.SUCCESS):i.cancelMove(O4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(n,i){const s=this.rules.getPieceCaptures(i,n);if(0===s.length){const o=this.rules.getPieceSteps(i,n);for(const a of o)this.getSpaceInfoAt(a.getEndingCoord()).squareClasses.push("selectable-fill")}else{const o=s.map(a=>a.coords.get(1));for(const a of o)this.getSpaceInfoAt(a).squareClasses.push("capturable-fill")}}getTranslate(n,i,s){const o=this.getCoordTranslate(n,i,s,this.mode);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(i=>i.x+", "+i.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const n=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(n[0],n[1],n[2],n[3])}getParallelogramCenterOf(n,i,s,o){const a=Math.max(n.x,i.x,s.x,o.x),c=Math.max(n.y,i.y,s.y,o.y),l=Math.min(n.x,i.x,s.x,o.x),f=Math.min(n.y,i.y,s.y,o.y);return new v((a-l)/2,(c-f)/2)}getRightEdge(){const n=this.basicWidth*this.mode.horizontalWidthRatio,i=this.basicWidth*this.mode.offsetRatio;return[i+n,0,i+n,this.THICKNESS,n,this.basicWidth+this.THICKNESS,n,this.basicWidth].join(" ")}getPieceTranslate(n){return"translate(0 "+(this.getParallelogramCenter().y-32.5-n*(.15*this.SPACE_SIZE))+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-lasca"]],features:[Ke],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),P()(),O(5,zpt,2,1,"g",4),V(6,"rect",5)(7,"polygon",6),P()),2&n&&(I("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(5),y("ngForOf",i.adaptedBoard.spaceInfo),_(1),I("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),_(1),I("points",i.getRightEdge()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ki=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return u(r,"SIZE",8),r})();class Xi extends Qs{static from(e,t){const n=ye.factory.fromMove(e,t);return n.isFailure()?Q.failure(n.getReason()):e.isNotInRange(Ki.SIZE,Ki.SIZE)?Q.failure("start coord is not in range"):t.isNotInRange(Ki.SIZE,Ki.SIZE)?Q.failure("end coord is not in range"):Q.success(new Xi(e,t,n.get()))}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n,this.direction=ye.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}u(Xi,"encoder",qi.getFallibleEncoder(Xi.from));let uR=(()=>{class r{}return u(r,"INVALID_MOVE_LENGTH",()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`),u(r,"CANNOT_JUMP_OVER_OPPONENT",()=>$localize`You cannot jump over the opponent's pieces.`),u(r,"PIECE_CANNOT_MOVE",()=>$localize`This piece has no possible move, select another one.`),r})();class Yr extends jn{static get(){return Yr.singleton.isAbsent()&&(Yr.singleton=g.of(new Yr)),Yr.singleton.get()}getInitialState(){const e=q.NONE,t=q.ZERO,n=q.ONE;return new Ki([[e,t,t,t,t,t,t,e],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[e,t,t,t,t,t,t,e]],0)}static getNumberOfGroups(e){const t=xt.create(Ki.SIZE,Ki.SIZE,-1),n=[0,0];let i=0;for(const s of e.getCoordsAndContents())-1===t[s.coord.y][s.coord.x]&&s.content.isPlayer()&&(i+=1,Yr.markGroupStartingAt(e,t,s.coord,i),n[s.content.value]+=1);return n}static markGroupStartingAt(e,t,n,i){const s=[n],o=e.getPieceAt(n);for(;s.length>0;){const a=B.getNonNullable(s.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===o){t[a.y][a.x]=i;for(const l of ye.DIRECTIONS){const f=a.getNext(l);e.isOnBoard(f)&&s.push(f)}}else c===q.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getStart().y][e.getStart().x]=q.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new Ki(i,t.turn+1)}static isLegal(e,t){const n=t.getPieceAt(e.getStart());return n===q.NONE?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===t.getCurrentOpponent()?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?b.failure(uR.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(i=>t.getPieceAt(i)===t.getCurrentOpponent())?b.failure(uR.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?b.failure(Ee.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):b.SUCCESS}isLegal(e,t){return Yr.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const s of Yr.getLineCoords(t,n))e.getPieceAt(s).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=Yr.getEntranceAndForwardDirection(e,t);let i=n[0];const s=n[1],o=[];for(;Ki.isOnBoard(i);)o.push(i),i=i.getNext(s);return o}static getEntranceAndForwardDirection(e,t){switch(t){case ye.UP:case ye.DOWN:return[new v(e.x,0),ye.DOWN];case ye.LEFT:case ye.RIGHT:return[new v(0,e.y),ye.RIGHT];case ye.UP_RIGHT:case ye.DOWN_LEFT:return[new v(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),ye.UP_RIGHT];default:return B.expectToBeMultiple(t,[ye.UP_LEFT,ye.DOWN_RIGHT]),[new v(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),ye.DOWN_RIGHT]}}static getVictory(e){const[t,n]=Yr.getNumberOfGroups(e);return 1===t&&1===n?g.of(q.NONE):1===t?g.of(k.ZERO):1===n?g.of(k.ONE):g.empty()}static possibleTargets(e,t){const n=[];for(const i of ye.DIRECTIONS){const s=Yr.numberOfPiecesOnLine(e,t,i),o=t.getNext(i,s);if(e.isOnBoard(o)){const a=Xi.from(t,o).get();Yr.isLegal(a,e).isSuccess()&&n.push(o)}}return n}getGameStatus(e){const t=e.gameState,[n,i]=Yr.getNumberOfGroups(t);return 1===n&&i>1?_e.ZERO_WON:n>1&&1===i?_e.ONE_WON:_e.ONGOING}}u(Yr,"singleton",g.empty());const F=q.NONE,S1=q.ZERO,v1=q.ONE;class P3e{constructor(){u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new Ki([[F,F,F,F,F,F,F,F],[v1,F,F,F,S1,F,F,v1],[F,F,S1,S1,v1,F,F,F],[F,F,F,S1,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F]],0)),j.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,Yr.get().getInitialState(),Xi.from(new v(1,7),new v(1,5)).get(),$localize`Congratulations!`),j.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new Ki([[F,F,F,F,F,F,F,F],[F,F,v1,S1,S1,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,v1],[F,F,F,F,F,F,F,S1]],0),[Xi.from(new v(3,1),new v(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),j.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new Ki([[F,F,F,F,F,F,v1,F],[F,F,F,F,F,S1,F,F],[F,F,F,F,v1,F,F,F],[F,F,F,S1,F,F,F,F],[F,F,F,F,F,F,F,v1],[F,F,F,F,F,v1,F,v1],[F,F,F,S1,F,F,v1,v1],[F,F,F,S1,F,F,F,F]],0),[Xi.from(new v(3,3),new v(3,0)).get(),Xi.from(new v(3,3),new v(0,0)).get(),Xi.from(new v(3,3),new v(2,3)).get(),Xi.from(new v(3,3),new v(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),j.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new Ki([[F,S1,F,S1,S1,S1,S1,F],[v1,F,F,F,F,F,F,v1],[F,F,S1,F,v1,F,F,F],[v1,F,F,F,F,F,F,v1],[v1,F,F,F,F,F,F,v1],[v1,F,F,F,F,F,F,v1],[v1,F,F,F,F,F,F,v1],[F,S1,S1,S1,S1,S1,S1,F]],0),Xi.from(new v(2,2),new v(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===q.ONE?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations!`),j.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new Ki([[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[S1,F,F,S1,v1,S1,F,F],[F,F,F,S1,F,F,F,v1],[F,F,F,F,F,F,F,v1],[F,F,F,F,F,F,F,v1],[F,F,F,F,F,F,F,v1],[F,F,F,F,F,F,F,F]],0),[Xi.from(new v(0,2),new v(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class Hpt extends tr{getMetrics(e){const t=e.gameState,[n,i]=Yr.getNumberOfGroups(t);return[100/n,100/i]}}class O3e extends Fn{getListMoves(e){const t=e.gameState,n=[];if(Yr.getVictory(t).isPresent())return n;for(let i=0;i<Ki.SIZE;i++)for(let s=0;s<Ki.SIZE;s++){const o=new v(s,i);if(t.getPieceAt(o).isPlayer())for(const c of Yr.possibleTargets(t,o)){const l=Xi.from(o,c).get();n.push(l)}}return n}}function Vpt(r,e){if(1&r&&(A(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ve("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Fpt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",3),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(2,"rect",4),O(3,Vpt,1,6,"circle",5),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","click_",n,"_",i,""),_(1),ve("id","space_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function $pt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Fpt,4,10,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Bpt(r,e){if(1&r){const t=pe();A(),S(0,"rect",6),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();I("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let Gpt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"EMPTY",q.NONE),u(this,"targets",[]),u(this,"state",void 0),u(this,"selected",g.empty()),u(this,"lastMove",g.empty()),u(this,"captured",g.empty()),this.rules=Yr.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,this.rules,new Hpt,new O3e),new On($localize`MCTS`,new O3e,this.rules)],this.encoder=Xi.encoder,this.tutorial=(new P3e).tutorial}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i);if(s.selected.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(a)===c?s.select(a):s.concludeMove(a)})()}concludeMove(n){var i=this;return M(function*(){const s=Xi.from(i.selected.get(),n);return s.isSuccess()?i.chooseMove(s.get()):i.cancelMove(s.getReason())})()}select(n){var i=this;return M(function*(){const s=i.getState().getPieceAt(n);return s===q.NONE?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s===i.getState().getCurrentOpponent()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.selected=g.of(n),i.targets=Yr.possibleTargets(i.getState(),i.selected.get()),0===i.targets.length?i.cancelMove(uR.PIECE_CANNOT_MOVE()):b.SUCCESS)})()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.board=i.getState().board,i.lastMove=i.node.previousMove})()}showLastMove(n){var i=this;return M(function*(){i.captured=i.getPreviousState().getPieceAt(n.getEnd()).isPlayer()?g.of(n.getEnd()):g.empty()})()}cancelMoveAttempt(){this.selected=g.empty(),this.targets=[]}getSquareClasses(n,i){const s=new v(n,i);if(this.lastMove.isPresent()){const o=this.lastMove.get().getStart(),a=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(o)||s.equals(a))return["moved-fill"]}return[]}getPieceClasses(n,i){const s=this.board[i][n],o=new v(n,i),a=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(o)&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-linesofaction"]],features:[Ke],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,$pt,2,1,"g",1),O(2,Bpt,1,4,"rect",2),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.targets))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var T3e,fR,dR,T4,hR;class n3 extends Ar{constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),u(this,"direction",void 0),u(this,"orientation",void 0),u(this,"captures",void 0),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}T3e=n3,u(n3,"encoder",new class extends we{encode(r){return{coord:v.encoder.encode(r.coord),direction:r.direction,orientation:r.orientation,captures:r.captures}}decode(r){const e=r;return je(null!=e.coord,"Invalid encoded LodestoneMove"),je(null!=e.direction,"Invalid encoded LodestoneMove"),je(null!=e.orientation,"Invalid encoded LodestoneMove"),je(null!=e.captures,"Invalid encoded LodestoneMove"),new T3e(v.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}});class ks{constructor(e){u(this,"unreachable",void 0),this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}u(ks,"UNREACHABLE",new(fR=ks)(!0)),u(ks,"EMPTY",new fR(!1));class Ka{static of(e){return e===k.ZERO?Ka.ZERO:Ka.ONE}constructor(e){u(this,"owner",void 0),this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(Ka,"ZERO",new(dR=Ka)(k.ZERO)),u(Ka,"ONE",new dR(k.ONE));class Hl{constructor(e,t,n){u(this,"owner",void 0),u(this,"direction",void 0),u(this,"orientation",void 0),this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return Hl.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(Hl,"LODESTONES",{0:{push:{diagonal:new(T4=Hl)(k.ZERO,"push","diagonal"),orthogonal:new T4(k.ZERO,"push","orthogonal")},pull:{diagonal:new T4(k.ZERO,"pull","diagonal"),orthogonal:new T4(k.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new T4(k.ONE,"push","diagonal"),orthogonal:new T4(k.ONE,"push","orthogonal")},pull:{diagonal:new T4(k.ONE,"pull","diagonal"),orthogonal:new T4(k.ONE,"pull","orthogonal")}}});class Z1{constructor(e,t){u(this,"width",void 0),u(this,"pieces",void 0),this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?Z1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(je(this.pieces.length+t===3,"should never put more pieces than the plate can support"),g.empty());{const n=qt.copy(this.pieces);for(let i=0;i<t;i++)n.push(Ka.of(e));return g.of(new Z1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:ks.EMPTY}}hR=Z1,u(Z1,"POSITIONS",["top","bottom","left","right"]),u(Z1,"EMPTY_5",new hR(5,[])),u(Z1,"EMPTY_3",new hR(3,[]));let kr=(()=>{class r extends L1{constructor(t,n,i,s){super(t,n),u(this,"lodestones",void 0),u(this,"pressurePlates",void 0),this.lodestones=i,this.pressurePlates=s}withBoard(t){return new r(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const n of Z1.POSITIONS){const i=this.pressurePlates[n];i.isPresent()&&(t[n]=i.get().remainingSpaces())}return t}numberOfPieces(){const t=[0,0];for(let n=0;n<r.SIZE;n++)for(let i=0;i<r.SIZE;i++){const s=this.getPieceAtXY(i,n);s.isPlayerPiece()&&(t[s.owner.value]+=1)}return t}getScores(){const t=this.numberOfPieces();return[24-t[1],24-t[0]]}nextLodestoneDirection(){const t=this.getCurrentPlayer(),n=this.lodestones.get(t);if(!n.isPresent())return g.empty();{const i=this.getPieceAt(n.get());switch(je(i.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+n.get()),i.direction){case"push":return g.of("pull");case"pull":return g.of("push")}}}}return u(r,"SIZE",8),r})(),Ru=(()=>{class r{}return u(r,"MUST_FLIP_LODESTONE",()=>$localize`You must flip your lodestone before putting it back on the board.`),u(r,"MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES",()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`),u(r,"TARGET_IS_CRUMBLED",()=>$localize`You must place your lodestone on a non-crumbled square!`),u(r,"TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE",()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`),u(r,"MUST_PLACE_CAPTURES",()=>$localize`You must place your captures on the pressure plates, on the side of the board.`),u(r,"NO_CAPTURES_TO_PLACE_YET",()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`),r})();class _r extends jn{static get(){return _r.singleton.isAbsent()&&(_r.singleton=g.of(new _r)),_r.singleton.get()}getInitialState(){const e=ks.EMPTY,t=Ka.ZERO,n=Ka.ONE;return new kr([[e,e,t,n,t,n,e,e],[e,t,n,t,n,t,n,e],[t,n,t,n,t,n,t,n],[n,t,n,e,e,t,n,t],[t,n,t,e,e,n,t,n],[n,t,n,t,n,t,n,t],[e,n,t,n,t,n,t,e],[e,e,n,t,n,t,e,e]],0,new Pn,{top:g.of(Z1.EMPTY_5),bottom:g.of(Z1.EMPTY_5),left:g.of(Z1.EMPTY_5),right:g.of(Z1.EMPTY_5)})}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=i.getOpponent(),o=xt.copy(n.board),a=t.lodestones.getCopy();a.put(i,e.coord);const c={...t.pressurePlates};return this.updatePressurePlates(o,c,a,s,e.captures),new kr(o,t.turn+1,a,c)}updatePressurePlates(e,t,n,i,s){for(const o of Z1.POSITIONS)t[o]=this.updatePressurePlate(e,o,t[o],n,i,s[o])}updatePressurePlate(e,t,n,i,s,o){if(n.isPresent()){const a=n.get().addCaptured(s,o),c=_r.THREATENED_COORD_RANGE.get(t).get();return a.isAbsent()?(this.removePressurePlate(e,c.startForBigPlate,c.direction,i),this.removePressurePlate(e,c.startForSmallPlate,c.direction,i)):a.get().width<n.get().width&&this.removePressurePlate(e,c.startForBigPlate,c.direction,i),a}return n}removePressurePlate(e,t,n,i){for(let s=t;s.isInRange(kr.SIZE,kr.SIZE);s=s.getNext(n)){for(const o of k.PLAYERS)i.get(o).equalsValue(s)&&i.delete(o);e[s.y][s.x]=ks.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return Q.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return Q.failure(Ru.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of Z1.POSITIONS){const c=t.pressurePlates[a];if(c.isPresent()&&c.get().remainingSpaces()<e.captures[a])return Q.failure(Ru.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return Q.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const s=xt.copy(e.board),o=e.lodestones.get(e.getCurrentPlayer());if(o.isPresent()){const a=o.get();s[a.y][a.x]=ks.EMPTY}return i="pull"===n.direction?this.applyPull(e,s,t,n.orientation):this.applyPush(e,s,t,n.orientation),i.board[t.y][t.x]=Hl.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const s=e.getCurrentPlayer(),o=s.getOpponent(),a=[],c=[],l="diagonal"===i?ye.DIAGONALS:ye.ORTHOGONALS;for(const f of l)for(let d=n.getNext(f);e.isOnBoard(d);d=d.getNext(f)){const m=t[d.y][d.x],E=d.getNext(f);if(e.isOnBoard(E)){const w=t[E.y][E.x];w.isPlayerPiece()&&w.owner===s&&(m.isEmpty()?(c.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=ks.EMPTY):m.isPlayerPiece()&&m.owner===o&&(a.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=ks.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const o=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?ye.DIAGONALS:ye.ORTHOGONALS;for(const f of l)for(let m=n.getNext(f,kr.SIZE);!1===m.equals(n);m=m.getPrevious(f))if(e.isOnBoard(m)){const E=t[m.y][m.x];if(E.isPlayerPiece()&&E.owner===o){const w=m.getNext(f);if(e.isOnBoard(w)){const R=t[w.y][w.x];R.isUnreachable()?(a.push(m),t[m.y][m.x]=ks.EMPTY):R.isEmpty()&&(c.push(w),t[w.y][w.x]=E,c.push(m),t[m.y][m.x]=ks.EMPTY)}else a.push(m),t[m.y][m.x]=ks.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const s=e.nextLodestoneDirection();return!1===(s.isAbsent()||s.equalsValue(n))?b.failure(Ru.MUST_FLIP_LODESTONE()):b.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return b.failure(Ru.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return b.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?b.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces();return 0===n[0]&&0===n[1]?_e.DRAW:0===n[0]?_e.ONE_WON:0===n[1]?_e.ZERO_WON:_e.ONGOING}}u(_r,"THREATENED_COORD_RANGE",Pn.from({top:{startForBigPlate:new v(0,0),startForSmallPlate:new v(0,1),direction:ye.RIGHT},bottom:{startForBigPlate:new v(0,kr.SIZE-1),startForSmallPlate:new v(0,kr.SIZE-2),direction:ye.RIGHT},left:{startForBigPlate:new v(0,0),startForSmallPlate:new v(1,0),direction:ye.DOWN},right:{startForBigPlate:new v(kr.SIZE-1,0),startForSmallPlate:new v(kr.SIZE-2,0),direction:ye.DOWN}})),u(_r,"singleton",g.empty());const Ie=ks.UNREACHABLE,ee=ks.EMPTY,xr=Ka.ZERO,Qi=Ka.ONE,ih=Hl.of(k.ONE,{direction:"push",orientation:"orthogonal"}),pR={top:g.of(Z1.EMPTY_5),bottom:g.of(Z1.EMPTY_5),left:g.of(Z1.EMPTY_5),right:g.of(Z1.EMPTY_5)};class b3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,_r.get().getInitialState()),j.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,_r.get().getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),j.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,_r.get().getInitialState()),j.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,_r.get().getInitialState()),j.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,_r.get().getInitialState()),j.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,_r.get().getInitialState(),new n3(new v(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,n,i)=>32===i.remainingSpaces()?b.failure($localize`You have not captured any of the opponent's pieces, try again!`):b.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new kr([[ee,ee,ee,ee,Qi,ee,ee,ee],[ee,ee,xr,ee,ee,Qi,ee,ee],[ee,ee,ih,ee,ee,ee,ee,xr],[ee,ee,ee,ee,Qi,ee,ee,xr],[ee,ee,ee,ee,ee,xr,ee,ee],[ee,ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee,ee]],0,new Pn([{key:k.ONE,value:new v(2,2)}]),{...pR,top:Z1.EMPTY_5.addCaptured(k.ONE,4)}),new n3(new v(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>5===i.pressurePlates.top.get().width?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):b.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new kr([[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[ee,ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee,xr],[ee,ee,ee,ee,ee,xr,ee,xr],[ee,ih,ee,ee,Qi,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,Qi,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee,ee]],0,new Pn([{key:k.ONE,value:new v(1,4)}]),{...pR,top:Z1.EMPTY_3.addCaptured(k.ONE,2)}),new n3(new v(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>i.pressurePlates.top.isPresent()?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):b.SUCCESS,$localize`Congratulations!`),j.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new kr([[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,xr,Qi,ee,ee,Ie,Ie],[Ie,Ie,ih,Qi,ee,ee,Ie,Ie],[Ie,Ie,ee,xr,xr,ee,Ie,Ie],[Ie,Ie,xr,ee,ee,ee,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie]],0,new Pn([{key:k.ONE,value:new v(2,3)}]),{top:g.empty(),bottom:g.empty(),left:g.empty(),right:g.empty()})),j.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new kr([[ee,ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,Qi,ee,ee],[ee,ee,ee,ih,ee,ee,xr,ee],[ee,ee,xr,xr,Qi,ee,ee,xr],[ee,ee,ee,ee,ee,xr,ee,ee],[ee,ee,xr,ee,ee,ee,ee,ee],[ee,ee,Qi,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee,ee]],0,new Pn([{key:k.ONE,value:new v(3,2)}]),{...pR,top:Z1.EMPTY_5.addCaptured(k.ONE,4)}),[new n3(new v(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),j.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new kr([[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie],[Ie,Qi,xr,Qi,ee,ee,Ie,Ie],[Ie,Qi,ih,ee,Qi,ee,Ie,Ie],[Ie,ee,ee,xr,xr,ee,Ie,Ie],[Ie,Qi,xr,ee,Qi,ee,Ie,Ie],[Ie,ee,ee,ee,xr,ee,Ie,Ie],[Ie,Ie,Ie,Ie,Ie,Ie,Ie,Ie]],0,new Pn([{key:k.ONE,value:new v(2,3)}]),{top:g.empty(),bottom:Z1.EMPTY_3.addCaptured(k.ZERO,2),left:g.of(Z1.EMPTY_3),right:g.empty()}),[new n3(new v(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)])}}class w3e extends Fn{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,n=>{const i=[];for(const s of this.nextDirection(t)){const o=["diagonal","orthogonal"];for(const a of o){const f=_r.get().applyMoveWithoutPlacingCaptures(t,n,{direction:s,orientation:a}).captures.length;for(const d of this.captureCombinations(t,f))i.push(new n3(n,s,a,d))}}return i})}captureCombinations(e,t){if(0===t)return new st([{top:0,bottom:0,left:0,right:0}]);{const n=new st,i=e.remainingSpacesDetails(),s=this.captureCombinations(e,t-1);for(const o of s)o.top+1<=i.top&&n.add({...o,top:o.top+1}),o.bottom+1<=i.bottom&&n.add({...o,bottom:o.bottom+1}),o.left+1<=i.left&&n.add({...o,left:o.left+1}),o.right+1<=i.right&&n.add({...o,right:o.right+1});return 0===n.size()?s:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<kr.SIZE;i++)for(let s=0;s<kr.SIZE;s++){const o=new v(s,i),a=e.getPieceAt(o);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(o)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}}class Upt extends tr{getMetrics(e){return e.gameState.getScores()}}var Xa;function Wpt(r,e){if(1&r&&(A(),V(0,"circle",10)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function qpt(r,e){if(1&r&&(A(),V(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);m6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),I("points",i.TRIANGLE_OUT)}}function jpt(r,e){if(1&r&&(A(),V(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);m6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),I("points",i.TRIANGLE_IN)}}function Zpt(r,e){if(1&r&&(A(),S(0,"g"),O(1,qpt,1,3,"polygon",14),O(2,jpt,1,3,"polygon",14),P()),2&r){const t=p(3).$implicit;_(1),y("ngIf","push"===t.lodestone.direction),_(1),y("ngIf","pull"===t.lodestone.direction)}}const N3e=function(){return[0,1,2,3]};function Ypt(r,e){if(1&r&&(A(),S(0,"g",11),V(1,"circle",12)(2,"circle",13),S(3,"g"),O(4,Zpt,3,2,"g",1),P()()),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();I("transform",o.getSquareTransform(n,s)),_(1),y("ngClass",i.lodestone.selectedClass),I("r",o.PIECE_RADIUS),_(1),y("ngClass",i.lodestone.pieceClasses),I("r",o.PIECE_RADIUS/4),_(1),m6("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),_(1),y("ngForOf",D1(7,N3e))}}function Kpt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){ne(t);const i=p().$implicit;return re(p(2).selectCoord(i.coord))}),V(1,"rect",7),O(2,Wpt,1,6,"circle",8),O(3,Ypt,5,8,"g",9),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","square_",n,"_",s,""),_(1),y("ngClass",i.squareClasses),I("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*s+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",i.hasPiece),_(1),y("ngIf",i.lodestone)}}function Xpt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Kpt,4,9,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",!1===t.crumbled)}}function Qpt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Xpt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Jpt(r,e){if(1&r&&(A(),S(0,"g",16),V(1,"circle",17),P()),2&r){const t=e.$implicit,n=e.index,i=p();Dn("id","capture_",n,""),I("transform",i.getCaptureTransform(n)),_(1),y("ngClass",t.pieceClasses),I("r",i.PIECE_RADIUS)}}function egt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"polygon",15),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),m6("transform","rotate(",90*t,")"),y("ngClass",n.movingClass),I("points","push"===n.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function tgt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){const s=ne(t).$implicit;return re(p().selectLodestone(s))}),V(1,"circle",12)(2,"circle",13),S(3,"g"),O(4,egt,2,3,"g",1),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p();ve("id","lodestone_",t.direction,"_",t.orientation,""),I("transform",i.getAvailableLodestoneTransform(n)),_(1),y("ngClass",t.selectedClass),I("r",i.PIECE_RADIUS),_(1),y("ngClass",t.pieceClasses),I("r",i.PIECE_RADIUS/4),_(1),m6("transform","rotate(","diagonal"===t.orientation?45:0,")"),_(1),y("ngForOf",D1(9,N3e))}}function ngt(r,e){if(1&r&&(A(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();ve("id","platePiece_",s.position,"_",n,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function rgt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",6),W("click",function(){const i=ne(t),s=i.$implicit,o=i.index,a=p().$implicit;return re(p().onPressurePlateClick(s.temporary,a.position,o))}),V(2,"rect",18),O(3,ngt,1,6,"circle",8),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();I("transform",s.getPressurePlateTransform(i.position)),_(1),ve("id","plate_",i.position,"_",n,""),_(1),ve("id","plateSquare_",i.position,"_",n,""),y("ngClass",t.squareClasses),I("x",s.SPACE_SIZE*t.coord.x+s.STROKE_WIDTH)("y",s.SPACE_SIZE*t.coord.y+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.hasPiece)}}function igt(r,e){if(1&r&&(A(),S(0,"g",16),O(1,rgt,4,11,"g",1),P()),2&r){const t=e.$implicit;Dn("id","pressurePlate_",t.position,""),_(1),y("ngForOf",t.coords)}}function sgt(r,e){if(1&r&&(A(),V(0,"rect",19)),2&r){const t=p();ve("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),I("x",t.SPACE_SIZE*t.viewInfo.selected.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class Vl extends jc{constructor(e){super(e),u(this,"PIECE_RADIUS",void 0),u(this,"TRIANGLE_OUT",void 0),u(this,"TRIANGLE_IN",void 0),u(this,"viewInfo",{availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:g.empty(),pressurePlateShift:{top:new St(0,0),left:new St(0,0),right:new St(0,0),bottom:new St(0,0)}}),u(this,"displayedState",void 0),u(this,"stateAfterPlacingLodestone",g.empty()),u(this,"lastInfos",g.empty()),u(this,"capturesToPlace",0),u(this,"selectedCoord",g.empty()),u(this,"selectedLodestone",g.empty()),u(this,"captures",{top:0,bottom:0,left:0,right:0}),this.rules=_r.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new b3e).tutorial,this.availableAIs=[new cn($localize`Score`,this.rules,new Upt,new w3e),new On($localize`MCTS`,new w3e,this.rules)],this.encoder=n3.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.getState(),this.scores=g.of([0,0])}selectCoord(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(Ru.MUST_PLACE_CAPTURES());const i=_r.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedCoord=g.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}selectLodestone(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());je(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const i=t.getCurrentPlayer(),s=Hl.of(i,e);return t.selectedLodestone.equalsValue(s)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedLodestone=g.of(s),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}putLodestone(){var e=this;return M(function*(){je(e.selectedCoord.isPresent(),"coord should have been selected"),je(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState();je(_r.get().isLegalWithoutCaptures(i,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=_r.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=g.of(o),e.capturesToPlace=Math.min(o.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(o.board),e.stateAfterPlacingLodestone=g.of(e.displayedState),e.updateViewInfo(),b.SUCCESS)})()}applyMove(){var e=this;return M(function*(){je(e.selectedCoord.isPresent(),"coord should have been selected"),je(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new n3(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(0===n.capturesToPlace)return n.cancelMove(Ru.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentOpponent(),a=xt.copy(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return _r.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new kr(a,s.turn,l,c),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.capturesToPlace++,n.captures[e]--;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentOpponent(),a=xt.copy(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return _r.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new kr(a,s.turn,l,c),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS})()}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt(),t.scores=g.of(t.getState().getScores())})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=g.empty(),this.lastInfos=g.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=xt.copy(this.displayedState.board);t[e.get().y][e.get().x]=ks.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=g.empty(),this.selectedLodestone=g.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<kr.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<kr.SIZE;t++){const n=new v(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:g.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=Hl.of(e,t),i={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return i.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of Z1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const i=Vl.PRESSURE_PLATES_POSITIONS.get(e).get(),s=n.get().width;let o=5===s?i.startForBigPlate:i.startForSmallPlate;for(let a=0;a<s;a++){o=o.getNext(i.direction);const c=n.get().getPieceAt(a);let l="";c.isPlayerPiece()&&(l=this.getPlayerClass(c.owner)),t.push({coord:o,hasPiece:c.isPlayerPiece(),pieceClasses:[l],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState();t.lastInfos=g.of(_r.get().applyMoveWithoutPlacingCaptures(n,e.coord,e)),t.updateViewInfo();const i=t.getState();t.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(e,t,n){for(const i of Z1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[i],t.pressurePlates[i],i,n)}showPressurePlateDifference(e,t,n,i){if(e.isPresent()&&t.isPresent()){const s=e.get(),o=t.get(),a=B.getNonNullable(this.viewInfo.pressurePlates.find(c=>c.position===n));if(s.width===o.width)for(let c=0;c<o.width;c++){const l=s.getPieceAt(c),f=o.getPieceAt(c);!1===l.equals(f)&&(a.coords[c].squareClasses.push("moved-fill"),a.coords[c].temporary=i,i&&a.coords[c].pieceClasses.push("semi-transparent"))}else for(const c of a.coords)c.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),i=this.getPressurePlateShift(e.pressurePlates.top),s=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new St(0,.5*(i-s)),this.viewInfo.pressurePlateShift.right=new St(0,.5*(i-s))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(kr.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(kr.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}var sh,A3e;Xa=Vl,u(Vl,"PRESSURE_PLATE_EXTRA_SHIFT",.2),u(Vl,"PRESSURE_PLATES_POSITIONS",Pn.from({top:{startForBigPlate:new v(.5,-1-Xa.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new v(1.5,0-Xa.PRESSURE_PLATE_EXTRA_SHIFT),direction:ye.RIGHT},bottom:{startForBigPlate:new v(.5,8+Xa.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new v(1.5,7+Xa.PRESSURE_PLATE_EXTRA_SHIFT),direction:ye.RIGHT},left:{startForBigPlate:new v(-1-Xa.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new v(0-Xa.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:ye.DOWN},right:{startForBigPlate:new v(8+Xa.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new v(7+Xa.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:ye.DOWN}})),u(Vl,"\u0275fac",function(e){return new(e||Xa)(U($t))}),u(Vl,"\u0275cmp",Be({type:Xa,selectors:[["app-lodestone"]],features:[Ke],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),O(1,Qpt,2,1,"g",1),O(2,Jpt,2,4,"g",2),O(3,tgt,5,10,"g",3),O(4,igt,2,2,"g",2),O(5,sgt,1,6,"rect",4),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.boardInfo),_(1),y("ngForOf",t.viewInfo.capturesToPlace),_(1),y("ngForOf",t.viewInfo.availableLodestones),_(1),y("ngForOf",t.viewInfo.pressurePlates),_(1),y("ngIf",t.viewInfo.selected.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class bt{static tryMerge(e,t){je(e!==bt.EMPTY&&t!==bt.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?g.of(bt.of(i)):g.empty()}static of(e){return e===bt.DRONE.value?bt.DRONE:(B.expectToBe(e,bt.QUEEN.value),bt.QUEEN)}constructor(e){u(this,"value",void 0),this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}u(bt,"EMPTY",new(sh=bt)(0)),u(bt,"PAWN",new sh(1)),u(bt,"DRONE",new sh(2)),u(bt,"QUEEN",new sh(3));class W0{static of(e){const t=new Pn;for(const n of e)W0.addToMap(t,n);return new W0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){u(this,"captures",void 0),this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return W0.addToMap(t,e),new W0(t)}}class a1 extends L1{static isOnBoard(e){return e.isInRange(a1.WIDTH,a1.HEIGHT)}constructor(e,t,n=g.empty(),i=g.empty(),s){super(e,t),u(this,"lastMove",void 0),u(this,"countDown",void 0),u(this,"captured",void 0),this.lastMove=n,this.countDown=i,null==s&&(s=new Pn([{key:k.ZERO,value:W0.of([])},{key:k.ONE,value:W0.of([])}])),s.makeImmutable(),this.captured=s}getPlayerTerritory(e){return e===k.ZERO?a1.PLAYER_ZERO_TERRITORY:a1.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let s=0;s<a1.WIDTH;s++)if(this.getPieceAtXY(s,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(k.ZERO)?g.of(k.ZERO):this.isTerritoryEmpty(k.ONE)?g.of(k.ONE):g.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<a1.WIDTH;i++)if(this.getPieceAtXY(i,n)!==bt.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(bt.PAWN).getOrElse(0),t.captures.get(bt.DRONE).getOrElse(0),t.captures.get(bt.QUEEN).getOrElse(0)]}}u(a1,"WIDTH",4),u(a1,"HEIGHT",8),u(a1,"PLAYER_ZERO_TERRITORY",new st([4,5,6,7])),u(a1,"PLAYER_ONE_TERRITORY",new st([0,1,2,3]));let JC=(()=>{class r{}return u(r,"START_COORD_OUT_OF_RANGE",()=>$localize`Start coord cannot be out of range`),u(r,"END_COORD_OUT_OF_RANGE",()=>$localize`End coord cannot be out of range`),u(r,"PAWN_MUST_MOVE_ONE_DIAGONAL_STEP",()=>$localize`Pawns must move one step diagonally.`),u(r,"DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS",()=>$localize`Drones must move one or two steps in any direction.`),r})();class Lr extends Qs{static from(e,t,n=!1){if(!1===a1.isOnBoard(e))return Q.failure(JC.START_COORD_OUT_OF_RANGE());if(!1===a1.isOnBoard(t))return Q.failure(JC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return Q.failure(Ee.MOVE_CANNOT_BE_STATIC());const i=ye.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?Q.failure(i.getReason()):Q.success(new Lr(e,t,n))}constructor(e,t,n){super(e,t),u(this,"calledTheClock",void 0),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}A3e=Lr,u(Lr,"encoder",we.tuple([v.encoder,v.encoder,we.identity()],r=>[r.getStart(),r.getEnd(),r.calledTheClock],r=>A3e.from(r[0],r[1],r[2]).get()));let I3e=(()=>{class r{}return u(r,"YOU_DID_NOT_CAPTURE_ANY_PIECE",()=>$localize`Failed, you did not capture any piece.`),r})(),ey=(()=>{class r{}return u(r,"MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY",()=>$localize`You must pick a piece from your side of the board in order to move it.`),u(r,"CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT",()=>$localize`This is not a valid promotion nor a valid capture.`),u(r,"CANNOT_UNDO_LAST_MOVE",()=>$localize`You cannot perform a move that is the reverse of the previous one.`),r})();class Ji extends jn{static get(){return Ji.singleton.isAbsent()&&(Ji.singleton=g.of(new Ji)),Ji.singleton.get()}constructor(){super()}getInitialState(){const e=bt.EMPTY,t=bt.PAWN,n=bt.DRONE,i=bt.QUEEN;return new a1([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,g.empty())}applyLegalMove(e,t,n){const i=t.getCopiedBoard();i[e.getStart().y][e.getStart().x]=bt.EMPTY;const s=n.finalPiece;i[e.getEnd().y][e.getEnd().x]=s;const o=n.score;let a=t.countDown;if(a.isPresent())if(this.isCapture(e,t))a=Ji.STARTING_COUNT_DOWN;else{const l=t.countDown.get();a=g.of(l-1)}return e.calledTheClock&&(a=Ji.STARTING_COUNT_DOWN),new a1(i,t.turn+1,g.of(e),a,o)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return Q.failure(ey.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),s=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=s.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),s.replace(a,c),s.makeImmutable()}return Q.success({finalPiece:i,score:s})}assertNonDoubleClockCall(e,t){je(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return Q.failure(ey.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return Q.failure(ey.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const s={finalPiece:i,score:t.captured.getCopy()};return Q.success(s)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return b.failure(ey.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===bt.EMPTY)return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===bt.PAWN)return e.isValidForPawn()?b.SUCCESS:b.failure(JC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===bt.DRONE&&!1===e.isValidForDrone())return b.failure(JC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const s of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(s)!==bt.EMPTY)return b.failure(Ee.SOMETHING_IN_THE_WAY());return b.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return bt.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,_e.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),s=_e.getVictory(i);return this.getGameStatusScoreVictoryOr(t,s)}return _e.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(k.ZERO),i=e.getScoreOf(k.ONE);return n>i?_e.ZERO_WON:i>n?_e.ONE_WON:t}}u(Ji,"STARTING_COUNT_DOWN",g.of(7)),u(Ji,"singleton",g.empty());const X=bt.EMPTY,Pi=bt.PAWN,b4=bt.DRONE,Fl=bt.QUEEN;class k3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ji.get().getInitialState()),j.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ji.get().getInitialState()),j.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ji.get().getInitialState(),Lr.from(new v(2,5),new v(1,4)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.PAWN?b.SUCCESS:b.failure($localize`This is not a pawn!`),$localize`Congratulations!`),j.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ji.get().getInitialState(),Lr.from(new v(1,7),new v(0,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.DRONE?b.SUCCESS:b.failure($localize`This is not a drone!`),$localize`Congratulations!`),j.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new a1([[b4,Pi,X,X],[Fl,X,X,X],[X,X,X,X],[X,X,Fl,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[Fl,b4,Pi,X]],1),Lr.from(new v(2,3),new v(2,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a queen!`),$localize`Congratulations!`),j.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new a1([[b4,Pi,Pi,X],[X,X,X,X],[Fl,X,X,X],[X,X,X,X],[X,X,Pi,X],[X,X,X,X],[X,X,X,X],[X,b4,Pi,X]],1),[Lr.from(new v(0,2),new v(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,I3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),j.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new a1([[X,X,X,Fl],[X,Pi,X,X],[X,X,Pi,X],[X,X,X,X],[X,X,X,X],[X,X,X,Fl],[X,X,b4,X],[X,Pi,X,X]],1),[Lr.from(new v(1,1),new v(2,2)).get(),Lr.from(new v(2,2),new v(1,1)).get()],$localize`Congratulations!`,$localize`This is not a field promotion!`),j.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new a1([[Pi,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,b4,X],[X,Pi,X,X]],0),Lr.from(new v(1,7),new v(2,6)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a field promotion!`),$localize`Congratulations!`),j.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ji.get().getInitialState(),Lr.from(new v(1,5),new v(0,4),!0).get(),(t,n,i)=>t.calledTheClock?b.SUCCESS:b.failure($localize`You did not call the clock!`),$localize`Congratulations!`),j.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new a1([[X,X,X,X],[X,Pi,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,Pi],[X,X,b4,X],[X,Pi,X,X]],15,g.empty(),g.of(1)),[Lr.from(new v(1,1),new v(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),j.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new a1([[X,X,X,Fl],[X,Pi,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[b4,X,X,X],[X,X,X,X],[X,b4,X,X]],15,g.empty(),g.of(1)),Lr.from(new v(1,1),new v(2,2)).get(),$localize`Congratulations!`),j.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new a1([[X,X,X,Fl],[X,Pi,X,X],[X,X,X,X],[X,X,X,X],[X,X,Pi,X],[X,X,X,X],[X,X,X,X],[X,X,X,X]],0),Lr.from(new v(2,4),new v(1,3)).get(),(t,n,i)=>3===t.getEnd().y?b.SUCCESS:b.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)])}}class x3e extends Fn{getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=t.getPlayerTerritory(n);let s=[];for(const o of i)for(let a=0;a<a1.WIDTH;a++)switch(t.getPieceAtXY(a,o)){case bt.PAWN:s=s.concat(this.getMovesForPawnAt(t,a,o));break;case bt.DRONE:s=s.concat(this.getMovesForDroneAt(t,a,o));break;case bt.QUEEN:s=s.concat(this.getMovesForQueenAt(t,a,o))}return s}getMovesForPawnAt(e,t,n){const i=new v(t,n),s=[];for(const o of ye.DIAGONALS){const a=i.getNext(o);a1.isOnBoard(a)&&s.push(a)}return this.addLegalMoves(e,i,s)}addLegalMoves(e,t,n){const i=[],s=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(bt.DRONE),a=!1===e.isTherePieceOnPlayerSide(bt.QUEEN),c=e.lastMove;for(const l of n){const f=e.getPieceAt(l);if(f===bt.EMPTY)this.add(i,Lr.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const d=bt.tryMerge(f,s);if(d.isPresent()){const m=d.get(),E=Lr.from(t,l).get();(m===bt.DRONE&&o||m===bt.QUEEN&&a)&&this.add(i,E,c)}}else this.add(i,Lr.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new v(t,n),s=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,s)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const s of ye.DIRECTIONS){let o=1,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY);for(;l;)i.push(a),o++,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY)&&o<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new v(t,n),s=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,s)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,a1.HEIGHT)}}class ogt extends tr{getMetrics(e){return[e.gameState.getScoreOf(k.ZERO),e.gameState.getScoreOf(k.ONE)]}}function agt(r,e){if(1&r&&(A(),V(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();li(i.style),ve("mainShapeId","pawn_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function cgt(r,e){if(1&r&&(A(),V(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();li(i.style),ve("mainShapeId","drone_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function lgt(r,e){if(1&r&&(A(),V(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();li(i.style),ve("mainShapeId","queen_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function ugt(r,e){if(1&r&&(A(),S(0,"g"),O(1,agt,1,5,"g",16),O(2,cgt,1,5,"g",17),O(3,lgt,1,5,"g",18),P()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();I("transform",o.getPieceLocation(n,s)),_(1),y("ngIf",i===o.pieces.PAWN),_(1),y("ngIf",i===o.pieces.DRONE),_(1),y("ngIf",i===o.pieces.QUEEN)}}function fgt(r,e){if(1&r){const t=pe();A(),S(0,"g",14),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(1,"rect",15),O(2,ugt,4,4,"g",13),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ve("id","click_",n,"_",i,""),I("transform",s.getPieceTranslation(i)),_(1),ve("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.pieces.EMPTY)}}function dgt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",22),W("click",function(){const s=ne(t).$implicit;return re(p(3).onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p(3);_(1),ve("id","indicator_",t.x,"_",t.y,""),I("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function hgt(r,e){if(1&r&&(A(),S(0,"g"),O(1,dgt,2,7,"g",1),P()),2&r){const t=p(2);_(1),y("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function pgt(r,e){if(1&r&&(A(),S(0,"g"),O(1,fgt,3,11,"g",12),O(2,hgt,2,1,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",t),_(1),y("ngIf",n.selectedPieceInfo.isPresent())}}function ggt(r,e){if(1&r&&(A(),S(0,"text",23),ct(1),P()),2&r){const t=p();y("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),I("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),_(1),mn(t.countDown.get())}}function mgt(r,e){if(1&r&&(A(),V(0,"polyline",24)),2&r){const t=p();y("ngClass",t.getClockCircleClasses()),I("points",t.clockNeedlesPoints)}}const ty=function(r){return[r]};function _gt(r,e){if(1&r){const t=pe();A(),Gt(0),S(1,"g",27),W("click",function(){const s=ne(t).index;return re(p(2).chooseStyle(s))}),P(),Ut()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),li(t.style),y("id",t.name)("pieceClasses",wa(5,ty,"player"+i.getCurrentPlayer().value+"-fill")),I("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function vgt(r,e){if(1&r&&(A(),S(0,"g",25),V(1,"rect",26),O(2,_gt,2,7,"ng-container",1),P()),2&r){const t=p();_(1),I("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),_(1),y("ngForOf",t.listOfStyles)}}function Cgt(r,e){if(1&r&&(A(),S(0,"text",33),ct(1),P()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();y("ngClass",i.getPlayerClass(n)),I("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),_(1),mn(t+" x ")}}function ygt(r,e){if(1&r&&(A(),V(0,"g",34)),2&r){const t=p(3).$implicit,n=p();li(n.style),y("pieceClasses",wa(3,ty,n.getPlayerClass(t)))}}function Mgt(r,e){if(1&r&&(A(),V(0,"g",35)),2&r){const t=p(3).$implicit,n=p();li(n.style),y("pieceClasses",wa(3,ty,n.getPlayerClass(t)))}}function Egt(r,e){if(1&r&&(A(),V(0,"g",36)),2&r){const t=p(3).$implicit,n=p();li(n.style),y("pieceClasses",wa(3,ty,n.getPlayerClass(t)))}}function Sgt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Cgt,2,4,"text",29),S(2,"g",28),O(3,ygt,1,5,"g",30),O(4,Mgt,1,5,"g",31),O(5,Egt,1,5,"g",32),P()()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();I("transform","translate(0, "+2*n*o.SPACE_SIZE+")"),_(1),y("ngIf",i>1),_(1),ve("id","piece_",n,"_player_",s.value,""),I("transform","translate("+o.SPACE_SIZE+", 0)"),_(1),y("ngIf",0===n),_(1),y("ngIf",1===n),_(1),y("ngIf",2===n)}}function Pgt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Sgt,6,8,"g",13),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t>0)}}function Ogt(r,e){if(1&r&&(A(),S(0,"g")(1,"g",28),O(2,Pgt,2,1,"g",1),P()()),2&r){const t=e.$implicit,n=p();_(1),Dn("id","capture_of_player_",t.value,""),I("transform",n.getCapturesTransformation(t)),_(1),y("ngForOf",n.state.getCapturesOf(t))}}let xs=(()=>{var r;class e extends Ci{static getRegularPolygon(n,i=0){const s=e.getRegularPolygonCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStar(n,i){const s=this.getNPointedStarCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStarCoords(n,i){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;n*=2;for(let c=0;c<n;c++){const f=(c*(360/n)+i)/180*Math.PI,d=c%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,m=o+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f);s.push(new v(m,E))}return s}static getRegularPolygonCoords(n,i=0){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;for(let c=0;c<n;c++){const f=(c*(360/n)-90)/180*Math.PI,d=.5*e.SPACE_SIZE,m=o+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f)+i;s.push(new v(m,E))}return s}static mapCoordsToString(n){let i="";for(const s of n)i+=s.x+", "+s.y+" ";return i}static getRadius(n){return this.SPACE_SIZE*n/10}constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"HORIZONTAL_CENTER",.5*a1.WIDTH*e.SPACE_SIZE),u(this,"UNSTROKED_HEIGHT",a1.HEIGHT*e.SPACE_SIZE),u(this,"VERTICAL_CENTER",.5*this.UNSTROKED_HEIGHT+e.STROKE_WIDTH),u(this,"LEFT",e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2),u(this,"UNSTROKED_WIDTH",a1.WIDTH*e.SPACE_SIZE),u(this,"UP",-e.STROKE_WIDTH/2),u(this,"WIDTH",this.UNSTROKED_WIDTH+2.5*e.SPACE_SIZE+e.STROKE_WIDTH),u(this,"HEIGHT",this.UNSTROKED_HEIGHT+3*e.STROKE_WIDTH),u(this,"MartianChessComponent",e),u(this,"style",{shape:"Circle",points:"Horizontal Points"}),u(this,"pieces",bt),u(this,"state",void 0),u(this,"configViewTranslation",void 0),u(this,"configCogTransformation",void 0),u(this,"selectedPieceInfo",g.empty()),u(this,"countDown",g.empty()),u(this,"callTheClock",!1),u(this,"displayModePanel",!1),u(this,"listOfStyles",[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}]),u(this,"clockNeedlesPoints",void 0),this.hasAsymmetricBoard=!0,this.rules=Ji.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Score`,this.rules,new ogt,new x3e),new On($localize`MCTS`,new x3e,this.rules)],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=Lr.encoder,this.tutorial=(new k3e).tutorial,this.scores=g.of([0,0])}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const n=this.STROKE_WIDTH,s=(this.SPACE_SIZE-n)/40;return"translate("+1*n+", "+1*n+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const n=.5*this.SPACE_SIZE;return n+" "+.1*this.SPACE_SIZE+", "+n+" "+n+", "+.75*this.SPACE_SIZE+" "+n}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board;const s=i.state.getScoreOf(k.ZERO),o=i.state.getScoreOf(k.ONE);i.countDown=i.state.countDown,i.scores=g.of([s,o])})()}getPieceLocation(n,i){return"translate("+this.SPACE_SIZE*n+", "+this.SPACE_SIZE*i+")"}getPieceClasses(n,i){const s=new v(n,i),o=[];return o.push(i>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&o.push("selected-stroke"),this.node.previousMove.isPresent()&&this.node.previousMove.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==bt.EMPTY&&this.getState().isInOpponentTerritory(new v(0,i))&&o.push("last-move-stroke"),o}onClick(n,i){var s=this;return M(function*(){s.displayModePanel=!1;const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i);return s.selectedPieceInfo.isPresent()?s.secondClick(a):s.firstClick(a)})()}firstClick(n){var i=this;return M(function*(){return i.isOneOfUsersPieces(n)?i.selectAsFirstPiece(n):(i.cancelMoveAttempt(),b.SUCCESS)})()}selectAsFirstPiece(n){var i=this;return M(function*(){const s=i.getLegalLandings(n);return i.selectedPieceInfo=g.of({selectedPiece:n,legalLandings:s}),b.SUCCESS})()}getLegalLandings(n){const i=this.state.getPieceAt(n);let s;return s=i===bt.PAWN?ye.DIAGONALS.map(o=>n.getNext(o)):this.getValidLinearLandingSquareUntil(n,i===bt.DRONE?2:a1.HEIGHT),s.filter(o=>{const a=Lr.from(n,o);return!!a.isSuccess()&&this.rules.isLegal(a.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(n,i){return ye.DIRECTIONS.flatMap(s=>{const o=[];let a=n.getNext(s),c=1;for(;a1.isOnBoard(a)&&c<=i&&(o.push(a),this.getState().getPieceAt(a)===bt.EMPTY);)a=a.getNext(s),c++;return o})}secondClick(n){var i=this;return M(function*(){const s=i.selectedPieceInfo.get();if(s.selectedPiece.equals(n))return i.cancelMoveAttempt(),b.SUCCESS;if(s.legalLandings.some(o=>o.equals(n))){const o=Lr.from(s.selectedPiece,n,i.callTheClock);return B.assert(o.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),i.chooseMove(o.get())}if(i.isOneOfUsersPieces(n))return i.selectAsFirstPiece(n);{const o=Lr.from(s.selectedPiece,n,i.callTheClock);return o.isSuccess()?i.chooseMove(o.get()):i.cancelMove(o.getReason())}})()}isOneOfUsersPieces(n){return this.state.getPieceAt(n)!==bt.EMPTY&&this.state.isInPlayerTerritory(n)}cancelMoveAttempt(){this.selectedPieceInfo=g.empty(),this.callTheClock=!1}onClockClick(){var n=this;return M(function*(){const i=yield n.canUserPlay("#clockOrCountDownView");return i.isFailure()?n.cancelMove(i.getReason()):(n.getState().countDown.isAbsent()&&(n.callTheClock=!1===n.callTheClock),b.SUCCESS)})()}getClockCircleClasses(){const n=["base"];return this.callTheClock&&n.push("selected-stroke"),this.getCurrentPlayer()===k.ZERO?n.push("player0-stroke"):n.push("player1-stroke"),n}getSquareClasses(n,i){const s=new v(n,i),o=["base"];if(this.node.previousMove.isPresent()){const a=this.node,c=a.previousMove.get();c.getStart().equals(s)?o.push("moved-fill"):c.getEnd().equals(s)&&(a.parent.get().gameState.getPieceAt(s)===bt.EMPTY||a.gameState.isInOpponentTerritory(new v(0,i))?o.push("moved-fill"):o.push("captured-fill"))}return o}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(n){this.style=this.listOfStyles[n].style,this.displayModePanel=!1}getPieceTranslation(n){return"translate(0, "+(n<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.getPointOfView().value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(n){const s=-this.SPACE_SIZE/2;let o=this.SPACE_SIZE/2;return n===this.getPointOfView()&&(o+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+s+", "+o+")"}}return r=e,u(e,"SPACE_SIZE",100),u(e,"STROKE_WIDTH",8),u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-martian-chess"]],features:[Ke],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),O(2,pgt,3,2,"g",1),P(),S(3,"g",2),W("click",function(){return i.onClockClick()}),V(4,"rect",3)(5,"circle",4),O(6,ggt,2,5,"text",5),O(7,mgt,1,2,"polyline",6),P(),S(8,"g",7)(9,"g",8),W("click",function(){return i.onModeCogClick()}),V(10,"rect",3)(11,"path",9),P(),O(12,vgt,3,5,"g",10),P(),S(13,"g",11),O(14,Ogt,3,3,"g",1),P()()),2&n&&(I("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(1),I("transform",i.getBoardTransformation()),_(1),y("ngForOf",i.board),_(1),I("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),_(1),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getClockCircleClasses()),I("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),_(1),y("ngIf",i.countDown.isPresent()),_(1),y("ngIf",i.countDown.isAbsent()),_(1),I("transform",i.configViewTranslation),_(2),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getPlayerClass(i.getCurrentPlayer())),I("transform",i.configCogTransformation),_(1),y("ngIf",i.displayModePanel),_(2),y("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),q0=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"WIDTH",7),u(r,"HEIGHT",6),r})(),Tgt=(()=>{class r{}return u(r,"COLUMN_IS_FULL",()=>$localize`Please put your piece in an incomplete column.`),r})();var oh,w4;let r3=(oh=class extends jn{static get(){return w4.singleton.isAbsent()&&(w4.singleton=g.of(new w4)),w4.singleton.get()}static getVictoriousCoords(e){return w4.P4_HELPER.getVictoriousCoord(e)}static getLowestUnoccupiedSpace(e,t){let n=0;for(;n<e.length&&e[n][t]===q.NONE;)n++;return n-1}getInitialState(){const e=xt.create(7,6,q.NONE);return new q0(e,0)}applyLegalMove(e,t,n){const i=e.x,s=t.getCopiedBoard(),o=w4.getLowestUnoccupiedSpace(s,i),a=t.turn;return s[o][i]=t.getCurrentPlayer(),new q0(s,a+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?b.failure(Tgt.COLUMN_IS_FULL()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return w4.P4_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):42===t.turn?_e.DRAW:_e.ONGOING}},w4=oh,u(oh,"singleton",g.empty()),u(oh,"P4_HELPER",new Mu(q0.isOnBoard,B.identity,4)),oh);var N4;r3=w4=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],r3);class sr extends vi{static of(e){switch(e){case 0:return sr.ZERO;case 1:return sr.ONE;case 2:return sr.TWO;case 3:return sr.THREE;case 4:return sr.FOUR;case 5:return sr.FIVE;case 6:return sr.SIX;default:throw new Error("Invalid P4Move")}}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}u(sr,"ZERO",new(N4=sr)(0)),u(sr,"ONE",new N4(1)),u(sr,"TWO",new N4(2)),u(sr,"THREE",new N4(3)),u(sr,"FOUR",new N4(4)),u(sr,"FIVE",new N4(5)),u(sr,"SIX",new N4(6)),u(sr,"encoder",we.tuple([we.identity()],r=>[r.x],r=>N4.of(r[0])));const it=q.NONE,A4=q.ZERO,zu=q.ONE;class L3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,r3.get().getInitialState()),j.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,r3.get().getInitialState(),sr.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),j.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new q0([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,zu,it,it,it],[it,it,it,zu,it,it,it],[it,it,A4,A4,A4,zu,it]],0),[sr.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),j.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new q0([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,A4,zu,it,it],[it,it,A4,A4,zu,it,it],[it,A4,zu,A4,A4,it,it]],0),[sr.of(3),sr.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)])}}let ny=class extends Fn{getListMoves(e){const t=e.gameState,n=[];for(let i=0;i<t.getWidth();i++)if(t.getPieceAtXY(i,0)===q.NONE){const s=sr.of(i);n.push(s)}return n}};ny=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ny);class Ngt extends Fa{getBoardValue(e){const t=e.gameState;let n=0;for(let i=0;i<q0.WIDTH;i++)for(let s=q0.HEIGHT-1;-1!==s&&t.board[s][i].isPlayer();s--)n+=r3.P4_HELPER.getSquareScore(t,new v(i,s));return new Jn(n)}}class Agt extends ny{getListMoves(e){const t=(e.gameState.getWidth()-1)/2;return super.getListMoves(e).sort(function n(i,s){return Math.abs(i.x-t)-Math.abs(s.x-t)})}}class Igt extends cn{constructor(){super($localize`Minimax`,r3.get(),new Ngt,new Agt)}}function kgt(r,e){if(1&r&&(A(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getSquareFillClass(t,n)),I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function xgt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=ne(t).index;return re(p(2).onClick(s))}),V(1,"rect",6),O(2,kgt,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();Dn("id","click_",n,""),_(1),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function Lgt(r,e){if(1&r&&(A(),S(0,"g"),O(1,xgt,3,6,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Rgt(r,e){if(1&r&&(A(),V(0,"rect",9)),2&r){const t=p();I("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function zgt(r,e){if(1&r&&(A(),V(0,"rect",10)),2&r){const t=e.$implicit,n=p();ve("id","victory_coord_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Dgt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"EMPTY",q.NONE),u(this,"last",void 0),u(this,"victoryCoords",[]),this.rules=r3.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Igt,new On($localize`MCTS`,new ny,this.rules)],this.encoder=sr.encoder,this.tutorial=(new L3e).tutorial}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n);if(s.isFailure())return i.cancelMove(s.getReason());const o=sr.of(n);return yield i.chooseMove(o)})()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.victoryCoords=r3.getVictoriousCoords(s),i.board=s.board})()}showLastMove(n){var i=this;return M(function*(){const s=i.getState(),o=r3.getLowestUnoccupiedSpace(s.board,n.x)+1;i.last=g.of(new v(n.x,o))})()}hideLastMove(){this.last=g.empty()}getSquareFillClass(n,i){return[this.getPlayerClass(this.board[i][n])]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-p4"]],features:[Ke],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Lgt,2,1,"g",1),O(2,Rgt,1,4,"rect",2),O(3,zgt,1,6,"rect",3),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngIf",i.last.isPresent()),_(1),y("ngForOf",i.victoryCoords))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Y1 extends L1{static isOnBoard(e){return e.isInRange(Y1.SIZE,Y1.SIZE)}constructor(e,t){super(e,t),u(this,"neutralBlocks",void 0),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=Y1.getBlockCenter(e),n=this.getPieceAt(t.getNext(ye.UP,1)),i=this.getPieceAt(t.getNext(ye.UP_LEFT,1));return this.getPieceAt(t.getNext(ye.RIGHT,1))===n&&this.getPieceAt(t.getNext(ye.DOWN,1))===n&&this.getPieceAt(t.getNext(ye.LEFT,1))===n&&this.getPieceAt(t.getNext(ye.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(ye.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(ye.DOWN_LEFT,1))===i}static getBlockCenter(e){return new v(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new Y1(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const s=Y1.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const o of Y1.ROTATION_MAP){const a=o[0].getNext(s),c=o[1].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const o of Y1.ROTATION_MAP){const a=o[1].getNext(s),c=o[0].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new Y1(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}var R3e;u(Y1,"SIZE",6),u(Y1,"ROTATION_MAP",[[new v(-1,-1),new v(1,-1)],[new v(0,-1),new v(1,0)],[new v(1,-1),new v(1,1)],[new v(1,0),new v(0,1)],[new v(1,1),new v(-1,1)],[new v(0,1),new v(-1,0)],[new v(-1,1),new v(-1,-1)],[new v(-1,0),new v(0,-1)]]);class Kr extends Ar{static of(e,t,n){return new Kr(e.x,e.y,t,n)}static withRotation(e,t,n,i){return B.assert(0<=n&&n<=3,"This block does not exist: "+n),new Kr(e,t,g.of(n),i)}static rotationless(e,t){return new Kr(e,t,g.empty())}constructor(e,t,n,i=!1){super(e,t),u(this,"blockTurned",void 0),u(this,"turnedClockwise",void 0),this.blockTurned=n,this.turnedClockwise=i,B.assert(Y1.isOnBoard(this.coord),"The board is a "+Y1.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}R3e=Kr,u(Kr,"encoder",we.tuple([v.encoder,g.getEncoder(we.identity()),we.identity()],r=>[r.coord,r.blockTurned,r.turnedClockwise],r=>R3e.of(r[0],r[1],r[2])));let z3e=(()=>{class r{}return u(r,"CANNOT_ROTATE_NEUTRAL_BLOCK",()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`),u(r,"MUST_CHOOSE_BLOCK_TO_ROTATE",()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`),r})();class Qa extends jn{static get(){return Qa.singleton.isAbsent()&&(Qa.singleton=g.of(new Qa)),Qa.singleton.get()}getInitialState(){const e=xt.create(Y1.SIZE,Y1.SIZE,q.NONE);return new Y1(e,0)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return b.failure(z3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return b.failure(z3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return b.SUCCESS}getVictoryCoords(e){let t=[];for(const n of Qa.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),s=[n[0]];if(i.isPlayer()){let o=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(o)!==i?a=!1:(s.push(o),o=o.getNext(n[1]));if(a&&(e.getPieceAt(o)===i&&(s.push(o),t=t.concat(s)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(s.push(c),t=t.concat(s))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=[!1,!1];for(let s=0;s<n.length;s+=5)i[t.getPieceAt(n[s]).value]=!0;return!0===i[0]?!0===i[1]?_e.DRAW:_e.ZERO_WON:!0===i[1]?_e.ONE_WON:t.turn===Y1.SIZE*Y1.SIZE?_e.DRAW:_e.ONGOING}}u(Qa,"singleton",g.empty()),u(Qa,"VICTORY_SOURCE",[[new v(1,0),new St(1,1),!1],[new v(0,1),new St(1,1),!1],[new v(4,0),new St(-1,1),!1],[new v(5,1),new St(-1,1),!1],[new v(1,1),new St(1,1),!0],[new v(4,1),new St(-1,1),!0],[new v(0,1),new St(0,1),!0],[new v(1,1),new St(0,1),!0],[new v(2,1),new St(0,1),!0],[new v(3,1),new St(0,1),!0],[new v(4,1),new St(0,1),!0],[new v(5,1),new St(0,1),!0],[new v(1,0),new St(1,0),!0],[new v(1,1),new St(1,0),!0],[new v(1,2),new St(1,0),!0],[new v(1,3),new St(1,0),!0],[new v(1,4),new St(1,0),!0],[new v(1,5),new St(1,0),!0]]);const ze=q.NONE,i3=q.ZERO,I4=q.ONE;class D3e{constructor(){u(this,"tutorial",[j.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,Qa.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new Y1([[i3,ze,ze,i3,I4,ze],[i3,I4,ze,ze,ze,ze],[i3,ze,I4,ze,ze,ze],[i3,ze,ze,ze,ze,I4],[i3,ze,ze,ze,I4,ze],[ze,ze,ze,ze,ze,ze]],10)).withPreviousMove(Kr.withRotation(0,0,0,!1)),j.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new Y1([[ze,ze,ze,ze,ze,ze],[ze,i3,ze,ze,I4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,I4,ze,ze,i3,ze],[ze,ze,ze,ze,ze,ze]],10),Kr.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?b.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):b.SUCCESS,$localize`Congratulations!`),j.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new Y1([[ze,ze,ze,ze,ze,ze],[ze,i3,ze,ze,I4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,I4,ze,ze,i3,ze],[ze,ze,ze,ze,ze,ze]],10),Kr.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?b.SUCCESS:b.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)])}}class ah extends Fn{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return ah.FIRST_TURN_MOVES;const i=this.getLegalDrops(e.gameState);for(const s of i){const o=Kr.rotationless(s.x,s.y),a=e.gameState.applyLegalDrop(o),c=this.getLegalRotations(a,n);for(const f of c)t.push(Kr.withRotation(s.x,s.y,f[0],f[1]));0===a.neutralBlocks.length==0&&t.push(o)}return t}getLegalDrops(e){const t=[];for(let n=0;n<Y1.SIZE;n++)for(let i=0;i<Y1.SIZE;i++){const s=new v(i,n);e.getPieceAt(s)===q.NONE&&t.push(s)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let s=0;s<4;s++)!1===e.blockIsNeutral(s)&&(t.includes(s)?n&&i.push([s,!0]):i.push([s,!0],[s,!1]));return i}}function Hgt(r,e){if(1&r){const t=pe();A(),S(0,"circle",12),W("click",function(){const s=ne(t).$implicit,o=p().$implicit,a=p().index,c=p().index;return re(p().onClick(3*a+s,3*c+o))}),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),s=i.index,o=i.$implicit,a=p(),c=a.index,l=a.$implicit,f=p();ve("id","click_",3*s+t,"_",3*c+n,""),y("ngClass",f.getSquareClasses(3*s+t,3*c+n)),I("cx",o+2*f.STROKE_WIDTH+(t+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(n+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}u(ah,"FIRST_TURN_MOVES",[Kr.rotationless(0,0),Kr.rotationless(1,0),Kr.rotationless(2,0),Kr.rotationless(0,1),Kr.rotationless(1,1),Kr.rotationless(0,2)]);const H3e=function(){return[0,1,2]};function Vgt(r,e){1&r&&(A(),Gt(0),O(1,Hgt,1,6,"circle",11),Ut()),2&r&&(_(1),y("ngForOf",D1(1,H3e)))}function Fgt(r,e){if(1&r&&(A(),Gt(0),V(1,"rect",10),O(2,Vgt,2,2,"ng-container",4),Ut()),2&r){const t=e.$implicit,n=e.index,i=p(),s=i.index,o=i.$implicit,a=p();_(1),y("ngClass",a.getBlockClasses(n,s)),I("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+o)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),_(1),y("ngForOf",D1(8,H3e))}}const V3e=function(r){return[0,r]};function $gt(r,e){if(1&r&&(A(),Gt(0),O(1,Fgt,3,9,"ng-container",4),Ut()),2&r){const t=p();_(1),y("ngForOf",wa(1,V3e,t.BLOCK_SEPARATION))}}function Bgt(r,e){if(1&r&&(A(),V(0,"circle",13)),2&r){const t=p();ve("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function Ggt(r,e){if(1&r){const t=pe();A(),S(0,"path",14),W("click",function(){const s=ne(t).$implicit;return re(p().rotate(s))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),I("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function Ugt(r,e){if(1&r&&(A(),V(0,"path",15)),2&r){const t=p();ve("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),I("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function Wgt(r,e){if(1&r&&(A(),V(0,"circle",16)),2&r){const t=e.$implicit,n=p();ve("id","victoryCoord_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),I("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function qgt(r,e){if(1&r){const t=pe();A(),S(0,"g",17),W("click",function(){return ne(t),re(p().skipRotation())}),V(1,"circle",18)(2,"line",19),P()}if(2&r){const t=p();_(1),I("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),_(1),I("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let jgt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"BLOCK_WIDTH",void 0),u(this,"BLOCK_SEPARATION",void 0),u(this,"DIAGONAL_BAR_OFFSET",void 0),u(this,"arrows",[]),u(this,"victoryCoords",[]),u(this,"canSkipRotation",void 0),u(this,"currentDrop",g.empty()),u(this,"movedBlock",g.empty()),u(this,"lastDrop",g.empty()),u(this,"lastRotation",g.empty()),u(this,"ARROWS",void 0),this.rules=Qa.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Dummy`,this.rules,new VL,new ah),new On($localize`MCTS`,new ah,this.rules)],this.encoder=Kr.encoder,this.tutorial=(new D3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(n){var i=this;return M(function*(){i.board=i.getState().getCopiedBoard(),i.victoryCoords=i.rules.getVictoryCoords(i.getState()),i.lastDrop=g.empty(),i.lastRotation=g.empty()})()}showLastMove(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.movedBlock=n.blockTurned;const s=new v(n.coord.x%3-1,n.coord.y%3-1);if(n.blockTurned.isPresent()&&(i.showLastRotation(n),!1===s.equals(new v(0,0))&&i.coordBelongToBlock(n)))return i.showLastDrop(n,s);i.lastDrop=g.of(n.coord)})()}showLastRotation(n){if(n.blockTurned.isPresent()){const i=n.blockTurned.get(),s=this.ARROWS.filter(o=>o.blockIndex===i&&o.clockwise===n.turnedClockwise)[0];this.lastRotation=g.of(s)}}showLastDrop(n,i){let s;s=n.turnedClockwise?B.getNonNullable(Y1.ROTATION_MAP.find(f=>f[0].equals(i)))[1]:B.getNonNullable(Y1.ROTATION_MAP.find(f=>f[1].equals(i)))[0];const o=n.blockTurned.get(),l=new v(o%2==0?1:4,o<2?1:4);s=s.getNext(l,1),this.lastDrop=g.of(s)}coordBelongToBlock(n){return n.blockTurned.equalsValue(2*(n.coord.y<3?0:1)+(n.coord.x<3?0:1))}hideLastMove(){this.lastDrop=g.empty(),this.movedBlock=g.empty(),this.lastRotation=g.empty(),this.victoryCoords=[]}generateArrowsCoord(){const n=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,o=n-s,a=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+a+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+a,blockIndex:0,clockwise:!1},{path:"M "+n+" "+c+" q  "+s+"  "+s+"  0  "+a,blockIndex:1,clockwise:!0},{path:"M "+o+" 0 q -"+s+" -"+s+" -"+a+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+o+" q -"+s+" -"+s+"  0 -"+a,blockIndex:2,clockwise:!0},{path:"M "+c+" "+n+" q  "+s+"  "+s+"  "+a+"  0",blockIndex:2,clockwise:!1},{path:"M "+o+" "+n+" q -"+s+"  "+s+" -"+a+"  0",blockIndex:3,clockwise:!0},{path:"M "+n+" "+o+" q  "+s+" -"+s+"  0 -"+a,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=g.empty(),this.canSkipRotation=!1}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n].isPlayer())return s.cancelMove(Ee.MUST_LAND_ON_EMPTY_SPACE());const a=Kr.rotationless(n,i),l=s.getState().applyLegalDrop(a);if(4===l.neutralBlocks.length)return s.chooseMove(a);const f=s.rules.getGameStatus(s.node);return s.canSkipRotation=l.neutralBlocks.length>0&&!1===f.isEndGame,s.currentDrop=g.of(new v(n,i)),s.displayArrows(l.neutralBlocks),b.SUCCESS})()}getCenter(n){return(n<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(n%3+.5)*this.SPACE_SIZE}displayArrows(n){this.arrows=[];for(let i=0;i<4;i++)if(!1===n.includes(i)){const s=this.ARROWS.filter(o=>o.blockIndex===i);this.arrows=this.arrows.concat(s)}}getBlockClasses(n,i){return this.movedBlock.equalsValue(n+2*i)?["last-move-stroke"]:[]}getSquareClasses(n,i){const s=[],o=this.getPlayerClass(this.board[i][n]);return s.push(o),this.lastDrop.equalsValue(new v(n,i))&&s.push("last-move-stroke"),s}rotate(n){var i=this;return M(function*(){const s=n.clockwise?"clockwise":"counterclockwise",o=yield i.canUserPlay("#rotate_"+n.blockIndex+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const a=i.currentDrop.get(),c=Kr.withRotation(a.x,a.y,n.blockIndex,n.clockwise);return i.chooseMove(c)})()}skipRotation(){var n=this;return M(function*(){const i=yield n.canUserPlay("#skipRotation");if(i.isFailure())return n.cancelMove(i.getReason());const s=n.currentDrop.get(),o=Kr.rotationless(s.x,s.y);return n.chooseMove(o)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-pentago"]],features:[Ke],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P()(),S(4,"defs")(5,"marker",3),V(6,"polygon",2),P()(),O(7,$gt,2,3,"ng-container",4),O(8,Bgt,1,6,"circle",5),O(9,Ggt,1,4,"path",6),O(10,Ugt,1,4,"path",7),O(11,Wgt,1,7,"circle",8),O(12,qgt,3,9,"g",9),P()),2&n&&(_(7),y("ngForOf",wa(6,V3e,i.BLOCK_SEPARATION)),_(1),y("ngIf",i.currentDrop.isPresent()),_(1),y("ngForOf",i.arrows),_(1),y("ngIf",i.lastRotation.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngIf",i.canSkipRotation))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ja=(()=>{class r extends L1{constructor(t,n,i){super(t,i),u(this,"captures",void 0),this.captures=n}}return u(r,"SIZE",19),r})();class J2 extends Ar{static isOnBoard(e){return e.isInRange(Ja.SIZE,Ja.SIZE)}static of(e){return B.assert(J2.isOnBoard(e),"PenteMove: coord is out of the board"),new J2(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}u(J2,"encoder",Ar.getEncoder(J2.of));class Ls extends jn{static get(){return Ls.singleton.isAbsent()&&(Ls.singleton=g.of(new Ls)),Ls.singleton.get()}getInitialState(){const e=xt.create(Ja.SIZE,Ja.SIZE,q.NONE);return e[9][9]=q.ONE,new Ja(e,[0,0],0)}isLegal(e,t){return t.getPieceAt(e.coord).isPlayer()?b.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=t.getCopiedBoard();s[e.coord.y][e.coord.x]=i;const o=this.getCaptures(e.coord,t,i);for(const c of o)s[c.y][c.x]=q.NONE;const a=[t.captures[0],t.captures[1]];return a[i.value]+=o.length,new Ja(s,a,t.turn+1)}getCaptures(e,t,n){const i=n.getOpponent(),s=[];for(const o of ye.factory.all){const a=e.getNext(o,1),c=e.getNext(o,2),l=e.getNext(o,3);J2.isOnBoard(a)&&t.getPieceAt(a)===i&&J2.isOnBoard(c)&&t.getPieceAt(c)===i&&J2.isOnBoard(l)&&t.getPieceAt(l)===n&&(s.push(a),s.push(c))}return s}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();return t.captures[n.value]>=10||Ls.PENTE_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(n):this.stillHaveEmptySquare(t)?_e.ONGOING:_e.DRAW}stillHaveEmptySquare(e){for(let t=0;t<Ja.SIZE;t++)for(let n=0;n<Ja.SIZE;n++)if(e.board[t][n]===q.NONE)return!0;return!1}}u(Ls,"PENTE_HELPER",new Mu(J2.isOnBoard,B.identity,5)),u(Ls,"singleton",g.empty());const h=q.NONE,s3=q.ZERO,ec=q.ONE;class $3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,Ls.get().getInitialState()),j.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Ls.get().getInitialState(),J2.of(new v(9,8)),$localize`Congratulations!`),j.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new Ja([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,s3,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,ec,s3,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,ec,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],3),[J2.of(new v(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new Ja([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,ec,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,ec,s3,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,ec,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],4),[J2.of(new v(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new Ja([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,ec,h,h,s3,s3,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,s3,h,s3,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,ec,s3,s3,s3,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,ec,ec,ec,ec,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[8,8],7),[J2.of(new v(9,6)),J2.of(new v(8,9)),J2.of(new v(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class B3e extends Fn{getListMoves(e){const n=[];return e.gameState.forEachCoord((i,s)=>{!1===s.isPlayer()&&n.push(J2.of(i))}),n}}class Zgt extends Fa{getBoardValue(e){return Ls.PENTE_HELPER.getBoardValue(e.gameState)}}function Ygt(r,e){if(1&r&&(A(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ve("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function Kgt(r,e){if(1&r&&(A(),V(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ve("id","hoshi_",t,"_",n,""),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function Xgt(r,e){if(1&r&&(A(),V(0,"rect",9)(1,"line",10)(2,"line",10),O(3,Kgt,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function Qgt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),O(1,Ygt,1,6,"circle",6),O(2,Xgt,4,13,"ng-template",null,7,dn),P()}if(2&r){const t=e.$implicit,n=e.index,i=un(3);ve("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function Jgt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Qgt,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function emt(r,e){if(1&r){const t=pe();A(),S(0,"circle",13),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","capture_",t.x,"_",t.y,""),I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}let tmt=(()=>{var r;class e extends UL{constructor(n){super(n),u(this,"lastMoved",g.empty()),u(this,"victoryCoords",[]),u(this,"captured",[]),this.scores=g.of([0,0]),this.rules=Ls.get(),this.node=this.rules.getInitialNode(),this.encoder=J2.encoder,this.tutorial=(new $3e).tutorial,this.availableAIs=[new cn($localize`Alignment`,this.rules,new Zgt,new B3e),new On($localize`MCTS`,new B3e,this.rules)]}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.board,i.scores=g.of(i.getState().captures),i.victoryCoords=Ls.PENTE_HELPER.getVictoriousCoord(s),i.createHoshis(),i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=g.of(n.coord);const s=i.getCurrentOpponent();i.captured=Ls.get().getCaptures(n.coord,i.getPreviousState(),s)})()}cancelMoveAttempt(){this.lastMoved=g.empty(),this.captured=[]}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i);return s.chooseMove(J2.of(a))})()}getSpaceClass(n,i){const s=new v(n,i),o=this.getState().getPieceAt(s),a=[];return a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.equalsValue(s)&&a.push("last-move-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-new-game"]],features:[Ke],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),V(1,"rect",1),O(2,Jgt,2,1,"g",2),O(3,emt,1,5,"circle",3),P()),2&n&&(I("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),I("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.captured))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class ch extends v{static getCoord3DEncoder(e){return we.tuple([we.identity(),we.identity(),we.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new ch(e,t,n)}constructor(e,t,n){super(e,t),u(this,"z",void 0),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}var gR;class fn extends ch{static of(e,t,n){return new fn(e,t,n)}constructor(e,t,n){super(e,t,n),B.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),B.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),B.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;B.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new fn(this.x,this.y,e),new fn(this.x+1,this.y,e),new fn(this.x,this.y+1,e),new fn(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new v(this.x-1,this.y-1),n=new v(this.x,this.y-1),i=new v(this.x-1,this.y),s=new v(this.x,this.y),o=4-e;return[t,n,i,s].filter(a=>a.isInRange(o,o)).map(a=>new fn(a.x,a.y,e))}getNextValid(e){const t=new v(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?g.empty():g.of(new fn(t.x,t.y,this.z))}}u(fn,"coordEncoder",ch.getCoord3DEncoder((gR=fn).of)),u(fn,"optionalEncoder",g.getEncoder(gR.coordEncoder));let $l=(()=>{class r{}return u(r,"MUST_MOVE_UPWARD",()=>$localize`You must move your pieces upward.`),u(r,"SHOULD_HAVE_SUPPORTING_PIECES",()=>$localize`Your piece must land on the board or on 4 other pieces.`),u(r,"CANNOT_MOVE_SUPPORTING_PIECE",()=>$localize`You cannot move a supporting piece.`),u(r,"CANNOT_CAPTURE",()=>$localize`You cannot capture.`),u(r,"INVALID_FIRST_CAPTURE",()=>$localize`Your first capture is invalid.`),u(r,"INVALID_SECOND_CAPTURE",()=>$localize`Your second capture is invalid.`),r})();var G3e;let U3e=(()=>{class r{}return u(r,"MUST_CAPTURE_MAXIMUM_TWO_PIECES",()=>$localize`You must capture one or two pieces, not more.`),r})();class vr extends vi{static ofClimb(e,t,n){const i=g.of(e),s=vr.checkCaptures(n),o=new vr(i,t,s.firstCapture,s.secondCapture);return B.assert(t.isHigherThan(e),$l.MUST_MOVE_UPWARD()),o}static checkCaptures(e){let t=g.empty(),n=g.empty();if(e.length>0&&(t=g.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=g.of(e[1]),e[1].isHigherThan(e[0])&&(t=g.of(e[1]),n=g.of(e[0])),e.length>2)throw new Error(U3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=g.empty(),i=vr.checkCaptures(t);return new vr(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=vr.checkCaptures(t);return new vr(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new vr(e,t,n,i)}constructor(e,t,n,i){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"firstCapture",void 0),u(this,"secondCapture",void 0),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}G3e=vr,u(vr,"encoder",we.tuple([fn.optionalEncoder,fn.coordEncoder,fn.optionalEncoder,fn.optionalEncoder],r=>[r.startingCoord,r.landingCoord,r.firstCapture,r.secondCapture],r=>G3e.of(r[0],r[1],r[2],r[3])));class Bl extends hC{static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return B.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),u(this,"boards",void 0),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:q.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:q.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:q.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[xt.copy(this.boards[0]),xt.copy(this.boards[1]),xt.copy(this.boards[2]),xt.copy(this.boards[3])];for(const i of e){const s=i.coord;n[s.z][s.y][s.x]=i.value}return new Bl(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===q.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[q.NONE.value]=0,e[k.ZERO.value]=0,e[k.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const s=new fn(i,n,t),o=this.getPieceAt(s);e[o.value]=1+e[o.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:q.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Bl.getLevelRange(n);for(const s of i)for(const o of i){const a=new fn(o,s,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class Xr extends jn{static get(){return Xr.singleton.isAbsent()&&(Xr.singleton=g.of(new Xr)),Xr.singleton.get()}getInitialState(){const e=xt.create(4,4,q.NONE),t=xt.create(3,3,q.NONE),n=xt.create(2,2,q.NONE);return new Bl([e,t,n,[[q.NONE]]],0)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let s=0;s<4-i;s++)for(let o=0;o<4-i;o++){const a=new fn(o,s,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(s=>n.equals(s))){const s=vr.ofClimb(n,i,[]);t.push(s)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=vr.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[Re.UP,Re.DOWN]){const s=t.getNextValid(i);if(s.isPresent()&&e.getPieceAt(s.get())===n)for(const o of[Re.LEFT,Re.RIGHT]){const a=s.get().getNextValid(o);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new st,n=e.getFreeToMoves();for(const i of n){t.add(new st([i]));const o=e.removePieceAt(i).getFreeToMoves();for(const a of o){const c=new st([i,a]);t.add(c)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(o=>e.getPieceAt(o).isPlayer()&&!1===o.equals(t.firstCapture.get())).length}static getGameStatus(e){const n=e.gameState.getPiecesRepartition();return 15===n[k.ZERO.value]?_e.ONE_WON:15===n[k.ONE.value]?_e.ZERO_WON:_e.ONGOING}applyLegalMove(e,t,n){return Xr.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),s=this.isLegalLandingCoord(e,i);if(s.isFailure())return s.toOtherFallible();const o=s.get(),a=this.isLegalCaptures(e,o);return a.isFailure()?a:b.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),s=t.getPieceAt(i);if(s===n)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(s===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return Q.success(a)}return Q.failure($l.CANNOT_MOVE_SUPPORTING_PIECE())}return Q.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?Q.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?Q.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):Q.failure($l.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return b.SUCCESS;if(!1===Xr.canCapture(t,e.landingCoord))return b.failure($l.CANNOT_CAPTURE());if(Xr.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||Xr.isValidCapture(n,e,e.secondCapture.get())?b.SUCCESS:b.failure($l.INVALID_SECOND_CAPTURE())}return b.failure($l.INVALID_FIRST_CAPTURE())}getGameStatus(e){return Xr.getGameStatus(e)}}u(Xr,"singleton",g.empty());const $e=q.NONE,k4=q.ZERO,W3e=q.ONE;class q3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Xr.get().getInitialState()),j.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Xr.get().getInitialState(),vr.ofDrop(new fn(1,1,0),[]),$localize`There you go, as simple as that.`),j.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Bl([[[k4,W3e,$e,$e],[W3e,k4,$e,$e],[$e,$e,$e,$e],[$e,$e,$e,k4]],[[$e,$e,$e],[$e,$e,$e],[$e,$e,$e]],[[$e,$e],[$e,$e]],[[$e]]],0),[vr.ofClimb(new fn(3,3,0),new fn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),j.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Bl([[[k4,k4,$e,$e],[$e,k4,$e,$e],[$e,$e,$e,$e],[$e,$e,$e,$e]],[[$e,$e,$e],[$e,$e,$e],[$e,$e,$e]],[[$e,$e],[$e,$e]],[[$e]]],0),[vr.ofDrop(new fn(0,1,0),[new fn(0,0,0)]),vr.ofDrop(new fn(0,1,0),[new fn(0,1,0)]),vr.ofDrop(new fn(0,1,0),[new fn(1,0,0)]),vr.ofDrop(new fn(0,1,0),[new fn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),j.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Bl([[[k4,k4,$e,$e],[$e,k4,$e,$e],[$e,$e,$e,$e],[$e,$e,$e,$e]],[[$e,$e,$e],[$e,$e,$e],[$e,$e,$e]],[[$e,$e],[$e,$e]],[[$e]]],0),vr.ofDrop(new fn(0,1,0),[new fn(0,0,0),new fn(1,0,0)]),(t,n,i)=>t.secondCapture.isPresent()?b.SUCCESS:t.firstCapture.isPresent()?b.failure($localize`Failed, you only captured one piece.`):b.failure(I3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)])}}class j3e extends Fn{getListMoves(e){const t=e.gameState,n=[],i=Xr.getStateInfo(t),s=Xr.getClimbingMoves(i),o=Xr.getDropMoves(i),a=s.concat(o);for(const c of a){const l=t.applyLegalMove(c,!1);let f=new st;Xr.canCapture(l,c.landingCoord)?f=Xr.getPossibleCaptures(l):n.push(c);for(const d of f){const m=vr.changeCapture(c,d.toList());n.push(m)}}return n}}class nmt extends j3e{getListMoves(e){const t=super.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((t,n)=>{const i=12*this.countStoneUsed(t),s=12*this.countStoneUsed(n);return i+this.sumMoveEmplacementByValue(t)-(s+this.sumMoveEmplacementByValue(n))})}countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}class rmt extends tr{getMetrics(e){const t=e.gameState.getPiecesRepartition();return[t[k.ZERO.value],t[k.ONE.value]]}}function imt(r,e){if(1&r&&(A(),V(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ve("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),I("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function smt(r,e){if(1&r&&(A(),S(0,"g"),O(1,imt,1,6,"circle",7),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function omt(r,e){if(1&r){const t=pe();A(),S(0,"circle",12),W("click",function(){ne(t);const i=p(2).$implicit,s=p().$implicit,o=p().$implicit;return re(p().onPieceClick(i,s,o))}),P()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,s=p();zi("id","piece_",t,"_",n,"_",i,""),y("ngClass",s.getPieceClasses(t,n,i)),I("r",s.getPieceRadius(i)-s.STROKE_WIDTH)("cx",s.getPieceCx(t,n,i))("cy",s.getPieceCy(t,n,i))}}function amt(r,e){if(1&r){const t=pe();A(),S(0,"rect",12),W("click",function(){ne(t);const i=p(3).$implicit,s=p().$implicit,o=p().$implicit;return re(p().onDrop(i,s,o))}),P()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,s=p();zi("id","drop_",t,"_",n,"_",i,""),y("ngClass",s.getSquareClasses(t,n,i)),I("width",2*s.getPieceRadius(i))("height",2*s.getPieceRadius(i))("x",s.getPieceCx(t,n,i)-s.getPieceRadius(i))("y",s.getPieceCy(t,n,i)-s.getPieceRadius(i))}}function cmt(r,e){if(1&r&&(A(),O(0,amt,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;y("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function lmt(r,e){if(1&r&&(A(),Gt(0),O(1,omt,1,7,"circle",10),O(2,cmt,1,1,"ng-template",null,11,dn),Ut()),2&r){const t=un(3),n=p().$implicit,i=p().$implicit,s=p().$implicit,o=p();_(1),y("ngIf",o.isOccupied(n,i,s))("ngIfElse",t)}}function umt(r,e){if(1&r&&(A(),S(0,"g"),O(1,lmt,4,2,"ng-container",9),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,s=p();_(1),y("ngIf",s.mustDraw(t,n,i))}}function fmt(r,e){if(1&r&&(A(),S(0,"g"),O(1,umt,2,1,"g",1),P()),2&r){const t=p().$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function dmt(r,e){if(1&r&&(A(),S(0,"g"),O(1,fmt,2,1,"g",1),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function hmt(r,e){if(1&r&&(A(),V(0,"rect",14)),2&r){const t=p();zi("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),I("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function pmt(r,e){if(1&r){const t=pe();A(),S(0,"g",15),W("click",function(){return ne(t),re(p().validateCapture())}),V(1,"circle",16)(2,"polygon",17),P()}if(2&r){const t=p();I("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),_(1),y("ngClass",t.getCaptureValidationButtonClasses()),I("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function gmt(r,e){if(1&r){const t=pe();A(),S(0,"g",18),W("click",function(){const s=ne(t).$implicit;return re(p().onPieceClick(s.x,s.y,s.z))}),V(1,"line",19)(2,"line",19),P()}if(2&r){const t=e.$implicit,n=p();zi("id","capturable_",t.x,"_",t.y,"_",t.z,""),I("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),_(1),I("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),_(1),I("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const mmt=function(){return[0,1,2]};let _mt=(()=>{var r;class e extends jc{constructor(n){super(n),u(this,"boardWidth",4*this.SPACE_SIZE+this.STROKE_WIDTH),u(this,"pieceRowHeight",this.SPACE_SIZE/2),u(this,"boardHeight",this.boardWidth+2*this.pieceRowHeight),u(this,"state",void 0),u(this,"constructedState",void 0),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"lastFirstCapture",g.empty()),u(this,"lastSecondCapture",g.empty()),u(this,"highCapture",g.empty()),u(this,"capturables",[]),u(this,"chosenStartingCoord",g.empty()),u(this,"chosenLandingCoord",g.empty()),u(this,"chosenFirstCapture",g.empty()),u(this,"chosenSecondCapture",g.empty()),u(this,"lastMove",g.empty()),u(this,"remainingPieces",{0:15,1:15}),this.hasAsymmetricBoard=!0,this.rules=Xr.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,this.rules,new rmt,new nmt),new On($localize`MCTS`,new j3e,this.rules)],this.encoder=vr.encoder,this.tutorial=(new q3e).tutorial}getPiecesCyForPlayer(n){return n===k.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(n){return Bl.getLevelRange(n)}mustDraw(n,i,s){const o=new fn(n,i,s);return!!(this.constructedState.getPieceAt(o).isPlayer()||this.justClimbed(o)||this.isCaptured(o))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(o)}isCaptured(n){return this.chosenFirstCapture.equalsValue(n)||this.chosenSecondCapture.equalsValue(n)}onPieceClick(n,i,s){var o=this;return M(function*(){const a=yield o.canUserPlay("#piece_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new fn(n,i,s);return o.state.getPieceAt(c)===o.state.getCurrentOpponent()?o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):o.chosenStartingCoord.equalsValue(c)?(o.cancelMoveAttempt(),b.SUCCESS):o.chosenLandingCoord.isPresent()?o.isSupporting(c,o.constructedState)?o.cancelMove($l.CANNOT_MOVE_SUPPORTING_PIECE()):o.onCaptureClick(c):o.isSupporting(c,o.getState())?o.cancelMove($l.CANNOT_MOVE_SUPPORTING_PIECE()):o.onClimbClick(c)})()}isSupporting(n,i){return i.isSupporting(n)}onClimbClick(n){var i=this;return M(function*(){return i.chosenStartingCoord=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),b.SUCCESS})()}onCaptureClick(n){var i=this;return M(function*(){return i.chosenFirstCapture.equalsValue(n)?(i.chosenFirstCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.equalsValue(n)?(i.chosenSecondCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenFirstCapture.isAbsent()?(i.chosenFirstCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.isAbsent()?(i.chosenSecondCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.cancelMove(U3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var n=this;return M(function*(){const i=yield n.canUserPlay("#capture_validation");return i.isFailure()?n.cancelMove(i.getReason()):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isAbsent()?b.SUCCESS:n.chosenFirstCapture.isPresent()&&n.chosenSecondCapture.isAbsent()?n.concludeMoveWithCapture([n.chosenFirstCapture.get()]):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isPresent()?n.concludeMoveWithCapture([n.chosenSecondCapture.get()]):n.concludeMoveWithCapture([n.chosenFirstCapture.get(),n.chosenSecondCapture.get()])})()}concludeMoveWithCapture(n){var i=this;return M(function*(){if(i.chosenStartingCoord.isAbsent()){const s=vr.ofDrop(i.chosenLandingCoord.get(),n);return i.chooseMove(s)}{const s=vr.ofClimb(i.chosenStartingCoord.get(),i.chosenLandingCoord.get(),n);return i.chooseMove(s)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=g.empty(),this.chosenLandingCoord=g.empty(),this.chosenFirstCapture=g.empty(),this.chosenSecondCapture=g.empty(),this.capturables=[]}onDrop(n,i,s){var o=this;return M(function*(){const a=yield o.canUserPlay("#drop_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new fn(n,i,s);return Xr.canCapture(o.constructedState,c)?(o.chosenLandingCoord=g.of(c),o.constructedState=o.constructedState.dropCurrentPlayersPieceAt(c),o.updateCapturableList(),b.SUCCESS):(o.chosenLandingCoord=g.of(c),o.concludeMoveWithCapture([]))})()}getSquareClasses(n,i,s){const o=new fn(n,i,s);if(this.lastMove.isPresent()){const a=this.lastMove.get();if(a.firstCapture.equalsValue(o)||a.secondCapture.equalsValue(o))return["captured-fill"];if(o.equals(a.landingCoord)||a.startingCoord.equalsValue(o))return["moved-fill"]}else if(this.justClimbed(o))return["moved-fill"];return[]}justClimbed(n){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(n)}getPieceRadius(n){return this.SPACE_SIZE*(.45+.025*n)}getPieceCx(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCy(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+i*this.SPACE_SIZE}getPieceCxByCoord(n){return this.getPieceCx(n.x,n.y,n.z)}getPieceCyByCoord(n){return this.getPieceCy(n.x,n.y,n.z)}isOccupied(n,i,s){const o=new fn(n,i,s);if(this.justClimbed(o))return!1;const a=this.getState().getPieceAt(o).isPlayer(),c=this.chosenLandingCoord.equalsValue(o);return a||c}getPieceClasses(n,i,s){const o=new fn(n,i,s),a=[this.getPieceFillClass(o)];return(this.lastLandingCoord.equalsValue(o)||this.lastStartingCoord.equalsValue(o))&&a.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(o)||this.chosenLandingCoord.equalsValue(o))&&a.push("selected-stroke"),this.isCaptured(o)&&a.push("pre-captured-fill"),a}getPieceFillClass(n){return this.chosenLandingCoord.equalsValue(n)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(n))}getPlayerSidePieces(n){const i=this.remainingPieces[n.value],s=[];for(let o=0;o<i;o++)s.push(o);return s}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.constructedState=i.state,i.lastMove=i.node.previousMove;const s=i.state.getPiecesRepartition();i.remainingPieces={0:15-s[0],1:15-s[1]},i.highCapture=g.empty(),i.cancelMoveAttempt(),i.hideLastMove()})()}showLastMove(n){var i=this;return M(function*(){i.lastLandingCoord=g.of(n.landingCoord),i.lastStartingCoord=n.startingCoord,i.lastFirstCapture=n.firstCapture,i.lastSecondCapture=n.secondCapture,i.lastFirstCapture.isPresent()&&!1===i.mustDrawCoord(i.lastFirstCapture.get())&&(i.highCapture=i.lastFirstCapture)})()}hideLastMove(){this.lastStartingCoord=g.empty(),this.lastLandingCoord=g.empty(),this.lastFirstCapture=g.empty(),this.lastSecondCapture=g.empty()}mustDrawCoord(n){return this.mustDraw(n.x,n.y,n.z)}mustDisplayLandingCoord(n,i,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new fn(n,i,s))||this.chosenStartingCoord.get().z<s}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-pylos"]],features:[Ke],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),O(2,smt,2,1,"g",1),P(),S(3,"g",null,2),V(5,"rect",3),O(6,dmt,2,1,"g",1),O(7,hmt,1,7,"rect",4),O(8,pmt,3,5,"g",5),O(9,gmt,3,12,"g",6),P()()),2&n&&(I("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),_(1),I("transform","rotate("+180*i.getPointOfView().value+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),_(1),y("ngForOf",i.Player.PLAYERS),_(1),I("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),_(2),I("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),_(1),y("ngForOf",D1(10,mmt)),_(1),y("ngIf",i.highCapture.isPresent()),_(1),y("ngIf",i.chosenLandingCoord.isPresent()),_(1),y("ngForOf",i.capturables))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var xn,Z3e;class yt{static ofInt(e){if(0<=e&&e<=15)return yt.pieces[e];if(16===e)return yt.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}u(yt,"AAAA",new(xn=yt)(0)),u(yt,"AAAB",new xn(1)),u(yt,"AABA",new xn(2)),u(yt,"AABB",new xn(3)),u(yt,"ABAA",new xn(4)),u(yt,"ABAB",new xn(5)),u(yt,"ABBA",new xn(6)),u(yt,"ABBB",new xn(7)),u(yt,"BAAA",new xn(8)),u(yt,"BAAB",new xn(9)),u(yt,"BABA",new xn(10)),u(yt,"BABB",new xn(11)),u(yt,"BBAA",new xn(12)),u(yt,"BBAB",new xn(13)),u(yt,"BBBA",new xn(14)),u(yt,"BBBB",new xn(15)),u(yt,"EMPTY",new xn(16)),u(yt,"pieces",[xn.AAAA,xn.AAAB,xn.AABA,xn.AABB,xn.ABAA,xn.ABAB,xn.ABBA,xn.ABBB,xn.BAAA,xn.BAAB,xn.BABA,xn.BABB,xn.BBAA,xn.BBAB,xn.BBBA,xn.BBBB]),u(yt,"encoder",we.fromFunctions(r=>r.value,xn.ofInt));class o3 extends Ar{constructor(e,t,n){super(e,t),u(this,"piece",void 0),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}Z3e=o3,u(o3,"encoder",we.tuple([v.encoder,yt.encoder],r=>[r.coord,r.piece],r=>new Z3e(r[0].x,r[0].y,r[1])));class a3 extends L1{constructor(e,t,n){super(e,t),u(this,"pieceInHand",void 0),this.pieceInHand=n}static isGivable(e,t,n){return e!==n&&!1===a3.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=yt.pieces,t=[];for(const n of e)a3.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}var c1=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(c1||{});let mR=(()=>{class r{}return u(r,"MUST_GIVE_A_PIECE",()=>$localize`You must give a piece.`),u(r,"PIECE_ALREADY_ON_BOARD",()=>$localize`That piece is already on the board.`),u(r,"CANNOT_GIVE_PIECE_IN_HAND",()=>$localize`You cannot give the piece that was in your hands.`),r})();class lh{constructor(e){u(this,"subCriterion",[g.empty(),g.empty(),g.empty(),g.empty()]),this.subCriterion[0]=g.of(8==(8&e.value)),this.subCriterion[1]=g.of(4==(4&e.value)),this.subCriterion[2]=g.of(2==(2&e.value)),this.subCriterion[3]=g.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=g.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new lh(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new lh(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class c3{constructor(e,t){u(this,"initialCoord",void 0),u(this,"direction",void 0),this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class Rr extends jn{static get(){return Rr.singleton.isAbsent()&&(Rr.singleton=g.of(new Rr)),Rr.singleton.get()}constructor(){super()}getInitialState(){const e=xt.create(4,4,yt.EMPTY);return new a3(e,0,yt.AAAA)}static isOccupied(e){return e!==yt.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,s=e.piece,o=t.getCopiedBoard(),a=t.pieceInHand;return Rr.isOccupied(o[i][n])?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):s===yt.EMPTY?15===t.turn?b.SUCCESS:b.failure(mR.MUST_GIVE_A_PIECE()):a3.isAlreadyOnBoard(s,o)?b.failure(mR.PIECE_ALREADY_ON_BOARD()):a===s?b.failure(mR.CANNOT_GIVE_PIECE_IN_HAND()):b.SUCCESS}isLegal(e,t){return Rr.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=t.pieceInHand,new a3(i,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===c1.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:c1.VICTORY,sensitiveSquares:new W1}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const s=new lh(i);for(let o=0;o<3&&!1!==Rr.isOccupied(i)&&!s.areAllAbsent();o++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),s.mergeWithQuartoPiece(i);return!(!Rr.isOccupied(i)||!1!==s.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=Rr.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const s=i.commonCriterion,o=i.sensitiveCoord;if(s.isPresent()&&!1===s.get().areAllAbsent()){if(o.isAbsent())return{score:c1.VICTORY,sensitiveSquares:new W1};{s.get().matchPiece(t.pieceInHand)&&(n.score=c1.PRE_VICTORY);const a=o.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=g.empty(),s=g.empty(),o=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(o);if(c===yt.EMPTY){if(!i.isAbsent())return{sensitiveCoord:g.of(o),commonCriterion:s,boardStatus:g.of(n)};i=g.of(o)}else s.isAbsent()?(s=g.of(new lh(c)),Ae.display("QuartoRules","getLineInfos","set commonCrit to "+s.toString())):(s.get().mergeWithQuartoPiece(c),Ae.display("QuartoRules","getLineInfos","update commonCrit: "+s.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:s,sensitiveCoord:i,boardStatus:g.empty()}}static scoreToGameStatus(e,t){const n=k.of(t%2);return e===c1.VICTORY?_e.getDefeat(n):16===t?_e.DRAW:_e.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:c1.DEFAULT,sensitiveSquares:new W1};for(const i of Rr.lines)if(n=Rr.updateBoardStatus(i,t,n),n.score===c1.VICTORY)return Rr.scoreToGameStatus(n.score,t.turn);return Rr.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of Rr.lines)if(Rr.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}u(Rr,"singleton",g.empty()),u(Rr,"lines",[new c3(new v(0,0),ye.DOWN),new c3(new v(1,0),ye.DOWN),new c3(new v(2,0),ye.DOWN),new c3(new v(3,0),ye.DOWN),new c3(new v(0,0),ye.RIGHT),new c3(new v(0,1),ye.RIGHT),new c3(new v(0,2),ye.RIGHT),new c3(new v(0,3),ye.RIGHT),new c3(new v(0,0),ye.DOWN_RIGHT),new c3(new v(0,3),ye.UP_RIGHT)]);const vmt=yt.AABA,Cmt=yt.AABB,Y3e=yt.ABAA,ymt=yt.ABAB,Mmt=yt.ABBA,K3e=yt.BAAA,Emt=yt.BAAB,Smt=yt.BABB,X3e=yt.BBAA,Pmt=yt.BBAB,_R=yt.BBBA,Omt=yt.BBBB,e1=yt.EMPTY;class Q3e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new a3([[_R,X3e,Y3e,vmt],[e1,e1,e1,e1],[e1,e1,e1,e1],[e1,e1,e1,e1]],7,yt.ABAB)),j.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new a3([[_R,Cmt,Mmt,e1],[e1,e1,e1,e1],[e1,K3e,e1,e1],[e1,e1,e1,e1]],7,yt.ABAA),new o3(2,2,yt.BAAB),$localize`Perfect!`),j.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new a3([[Omt,_R,Pmt,e1],[Y3e,Smt,X3e,e1],[ymt,K3e,Emt,e1],[e1,e1,e1,e1]],7,yt.AABA),[new o3(3,3,yt.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)])}}class Tmt extends Fa{scoreToBoardValue(e,t){if(e===c1.DEFAULT)return new Jn(0);{B.assert(e===c1.PRE_VICTORY,"QuartoHeuristic score can only be pre-victory or default");const n=k.of(t%2);return new Jn(n.getPreVictory())}}getBoardValue(e){const t=e.gameState;let n={score:c1.DEFAULT,sensitiveSquares:new W1};for(const i of Rr.lines)n=Rr.updateBoardStatus(i,t,n);return this.scoreToBoardValue(n.score,t.turn)}}class J3e extends Fn{getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getRemainingPieces(),o=n.pieceInHand;let a;for(let c=0;c<4;c++)for(let l=0;l<4;l++)if(i[c][l]===yt.EMPTY){if(a=n.getCopiedBoard(),a[c][l]=o,15===n.turn){const f=new o3(l,c,yt.EMPTY);return t.push(f),t}for(const f of s){const d=new o3(l,c,f);t.push(d)}}return t}}function bmt(r,e){if(1&r&&(A(),V(0,"rect",13)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),I("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("y",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("width",2*o.getPieceSize(n.value))("height",2*o.getPieceSize(n.value))}}function wmt(r,e){if(1&r&&(A(),V(0,"circle",13)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),I("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("r",o.getPieceSize(n.value))}}function Nmt(r,e){if(1&r&&(A(),V(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function Amt(r,e){if(1&r&&(A(),S(0,"g"),O(1,bmt,1,5,"rect",11),O(2,wmt,1,4,"ng-template",null,12,dn),O(4,Nmt,1,3,"circle",10),P()),2&r){const t=un(3),n=p().$implicit,i=p(2);_(1),y("ngIf",n.isRectangle())("ngIfElse",t),_(3),y("ngIf",i.pieceHasDot(n.value))}}function Imt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",9),W("click",function(){const s=ne(t).index,o=p().index;return re(p().chooseCoord(s,o))}),P(),O(2,Amt,5,3,"g",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","chooseCoord_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function kmt(r,e){if(1&r&&(A(),S(0,"g",null,8),O(2,Imt,3,8,"g",2),P()),2&r){const t=e.$implicit;_(2),y("ngForOf",t)}}function xmt(r,e){if(1&r&&(A(),V(0,"rect",18)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function Lmt(r,e){if(1&r&&(A(),V(0,"circle",13)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function Rmt(r,e){if(1&r&&(A(),V(0,"circle")),2&r){const t=p(2);I("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function zmt(r,e){if(1&r){const t=pe();A(),S(0,"g",14,15),W("click",function(){return ne(t),re(p().deselectDroppedPiece())}),V(2,"rect",16),O(3,xmt,1,5,"rect",17),O(4,Lmt,1,4,"ng-template",null,12,dn),O(6,Rmt,1,3,"circle",10),P()}if(2&r){const t=un(5),n=p();ve("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),I("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),_(2),I("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function Dmt(r,e){if(1&r&&(A(),S(0,"g",null,19),V(2,"rect",20),P()),2&r){const t=e.$implicit,n=p();_(2),I("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function Hmt(r,e){if(1&r&&(A(),V(0,"rect",13)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function Vmt(r,e){if(1&r&&(A(),V(0,"circle",23)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function Fmt(r,e){1&r&&(A(),V(0,"circle",24)),2&r&&I("cy",.75*p(2).SPACE_SIZE)("r",10)}function $mt(r,e){if(1&r&&(A(),S(0,"g",21),O(1,Hmt,1,6,"rect",11),O(2,Vmt,1,3,"ng-template",null,12,dn),O(4,Fmt,1,2,"circle",22),P()),2&r){const t=un(3),n=p();_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function Bmt(r,e){if(1&r&&(A(),V(0,"rect",29)),2&r){const t=p(2).index,n=p().index,i=p();Dn("id","chosenPiece_",4*n+t,""),I("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Gmt(r,e){if(1&r&&(A(),V(0,"rect",13)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),I("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function Umt(r,e){if(1&r&&(A(),V(0,"circle",13)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function Wmt(r,e){if(1&r&&(A(),V(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function qmt(r,e){if(1&r){const t=pe();A(),S(0,"g",14),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().choosePiece(4*s+i))}),O(1,Bmt,1,5,"rect",28),O(2,Gmt,1,5,"rect",11),O(3,Umt,1,4,"ng-template",null,12,dn),O(5,Wmt,1,3,"circle",10),P()}if(2&r){const t=un(4),n=p().index,i=p().index,s=p();Dn("id","choosePiece_",4*i+n,""),_(1),y("ngIf",s.pieceToGive.equalsValue(s.QuartoPiece.ofInt(4*i+n))),_(1),y("ngIf",(4*i+n)%4<2)("ngIfElse",t),_(3),y("ngIf",s.pieceHasDot(4*i+n))}}function jmt(r,e){if(1&r&&(A(),S(0,"g"),O(1,qmt,6,5,"g",3),P()),2&r){const t=e.index,n=p().index,i=p();_(1),y("ngIf",i.isRemaining(4*n+t))}}function Zmt(r,e){if(1&r&&(A(),S(0,"g",null,25),V(2,"rect",26,27),O(4,jmt,2,1,"g",2),P()),2&r){const t=e.$implicit,n=p();I("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),_(2),I("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),_(2),y("ngForOf",t)}}let Ymt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"EMPTY",yt.EMPTY),u(this,"QuartoPiece",yt),u(this,"chosen",g.empty()),u(this,"lastMove",g.empty()),u(this,"pieceInHand",yt.EMPTY),u(this,"pieceToGive",g.empty()),u(this,"victoriousCoords",[]),this.rules=Rr.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,this.rules,new Tmt,new J3e),new On($localize`MCTS`,new J3e,this.rules)],this.encoder=o3.encoder,this.tutorial=(new Q3e).tutorial,this.pieceInHand=this.getState().pieceInHand}updateBoard(n){var i=this;return M(function*(){const s=i.getState(),o=i.node.previousMove;i.board=s.getCopiedBoard(),i.chosen=g.empty(),i.pieceInHand=s.pieceInHand,i.victoriousCoords=i.rules.getVictoriousCoords(s),i.lastMove=o.map(a=>a.coord)})()}chooseCoord(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#chooseCoord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n]===yt.EMPTY){if(s.showPieceInHandOnBoard(n,i),15===s.getState().turn){const a=new o3(n,i,yt.EMPTY);return s.chooseMove(a)}if(s.pieceToGive.isAbsent())return b.SUCCESS;{const a=new o3(n,i,s.pieceToGive.get());return s.chooseMove(a)}}return s.cancelMove(Ee.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#choosePiece_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.hideLastMove(),i.pieceToGive.equalsValue(yt.ofInt(n)))return i.cancelMoveAttempt(),b.SUCCESS;if(i.pieceToGive=g.of(yt.ofInt(n)),i.chosen.isAbsent())return b.SUCCESS;{const o=i.chosen.get(),a=new o3(o.x,o.y,i.pieceToGive.get());return i.chooseMove(a)}})()}hideLastMove(){this.lastMove=g.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=g.empty(),this.chosen=g.empty()}deselectDroppedPiece(){var n=this;return M(function*(){const i=n.chosen.getOrElse(new v(404,404)),s="#droppedPiece_"+i.x+"_"+i.y,o=yield n.canUserPlay(s);return o.isFailure()?n.cancelMove(o.getReason()):(n.cancelMoveAttempt(),b.SUCCESS)})()}showPieceInHandOnBoard(n,i){this.chosen=g.of(new v(n,i))}isRemaining(n){return a3.isGivable(yt.ofInt(n),this.board,this.pieceInHand)}getSquareClasses(n,i){const s=new v(n,i);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(n){const i=[];return i.push(n%2==0?"player0-fill":"player1-fill"),i}getPieceSize(n){return n<8?40:25}pieceHasDot(n){return n!==yt.EMPTY.value&&n%8<4}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-quarto"]],features:[Ke],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["id","pieceInHand",4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["id","pieceInHand"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g",1),O(2,kmt,3,1,"g",2),O(3,zmt,7,8,"g",3),O(4,Dmt,3,3,"g",2),S(5,"g",null,4),V(7,"rect",5,6),O(9,$mt,5,3,"g",7),P(),O(10,Zmt,5,6,"g",2),P()()),2&n&&(I("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),_(2),y("ngForOf",i.board),_(1),y("ngIf",i.chosen.isPresent()),_(1),y("ngForOf",i.victoriousCoords),_(1),I("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),_(2),I("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),_(2),y("ngIf",i.chosen.isAbsent()&&i.pieceInHand!==i.EMPTY),_(1),y("ngForOf",i.board))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Kmt=(()=>{class r{}return u(r,"NO_INSIDE_CLICK",()=>$localize`You must pick a space from the edge of the board.`),r})(),K1=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}applyLegalMove(t){const n=this.getCopiedBoard(),i=this.turn+1;let s=t.coord,o=t.coord.getNext(t.direction);for(;r.isOnBoard(o);)n[s.y][s.x]=n[o.y][o.x],s=s.getNext(t.direction),o=o.getNext(t.direction);return n[s.y][s.x]=this.getCurrentPlayer(),new r(n,i)}}return u(r,"SIZE",5),r})();var e4e;class l3 extends Ar{static isValidCoord(e){return!1===K1.isOnBoard(e)?b.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&e.x!==K1.SIZE-1&&0!==e.y&&e.y!==K1.SIZE-1?b.failure(Kmt.NO_INSIDE_CLICK()):b.SUCCESS}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n;const i=l3.isValidCoord(this.coord);if(i.isFailure())throw new Error(i.getReason());if(0===e&&n===Re.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(e===K1.SIZE-1&&n===Re.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===Re.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(t===K1.SIZE-1&&n===Re.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}e4e=l3,u(l3,"encoder",we.tuple([v.encoder,Re.encoder],r=>[r.coord,r.direction],r=>new e4e(r[0].x,r[0].y,r[1])));class b2 extends jn{static get(){return b2.singleton.isAbsent()&&(b2.singleton=g.of(new b2)),b2.singleton.get()}getInitialState(){const e=xt.create(K1.SIZE,K1.SIZE,q.NONE);return new K1(e,0)}static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=0;i<K1.SIZE;i++)e.gameState.getPieceAtXY(0,i)!==t&&n.push(new v(0,i)),e.gameState.getPieceAtXY(K1.SIZE-1,i)!==t&&n.push(new v(K1.SIZE-1,i));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=1;i<K1.SIZE-1;i++)e.gameState.getPieceAtXY(i,0)!==t&&n.push(new v(i,0)),e.gameState.getPieceAtXY(i,K1.SIZE-1)!==t&&n.push(new v(i,K1.SIZE-1));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(Re.LEFT),0!==e.y&&t.push(Re.UP),e.x!==K1.SIZE-1&&t.push(Re.RIGHT),e.y!==K1.SIZE-1&&t.push(Re.DOWN),t}static getLinesSums(e){const t={};t[k.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[k.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(const n of e.getCoordsAndContents()){const i=n.content,s=n.coord.x,o=n.coord.y;if(i.isPlayer()){const a=i.value;t[a].columns[s]=t[a].columns[s]+1,t[a].rows[o]=t[a].rows[o]+1,s===o&&(t[a].diagonals[0]=t[a].diagonals[0]+1),s+o===K1.SIZE-1&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}static getVictoriousCoords(e){return b2.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):b.SUCCESS}getGameStatus(e){const t=e.gameState,i=b2.QUIXO_HELPER.getVictoriousCoord(t).map(o=>t.getPieceAt(o)),s=new st(i);return 0===s.size()?_e.ONGOING:1===s.size()?_e.getVictory(s.getAnyElement().get()):_e.getVictory(t.getCurrentPlayer())}}u(b2,"singleton",g.empty()),u(b2,"QUIXO_HELPER",new Mu(K1.isOnBoard,B.identity,K1.SIZE));const P1=q.NONE,pa=q.ZERO,tc=q.ONE;class t4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,b2.get().getInitialState()),j.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new K1([[P1,P1,P1,P1,P1],[P1,P1,P1,P1,P1],[P1,P1,P1,P1,P1],[P1,P1,P1,P1,P1],[pa,pa,pa,pa,P1]],1),[new l3(4,4,Re.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),j.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new K1([[P1,tc,P1,tc,tc],[P1,pa,pa,P1,pa],[tc,tc,tc,pa,tc],[pa,P1,pa,tc,tc],[tc,pa,P1,tc,pa]],31),[new l3(3,0,Re.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}class n4e extends Fn{getListMoves(e){const t=[],n=b2.getVerticalCoords(e),s=b2.getHorizontalCenterCoords(e).concat(n);for(const o of s){const a=b2.getPossibleDirections(o);for(const c of a){const l=new l3(o.x,o.y,c);t.push(l)}}return t}}class Xmt extends tr{getMetrics(e){const n=b2.getLinesSums(e.gameState);return[b2.getFullestLine(n[k.ZERO.value]),b2.getFullestLine(n[k.ONE.value])]}}function Qmt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",4),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onBoardClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ve("id","click_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function Jmt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Qmt,2,6,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function e_t(r,e){if(1&r){const t=pe();A(),S(0,"use",6),W("click",function(){const s=ne(t).$implicit;return re(p(2).chooseDirection(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);Dn("id","chooseDirection_",t,""),I("transform",n.getArrowTransform(t))}}function t_t(r,e){if(1&r&&(A(),S(0,"g"),O(1,e_t,1,2,"use",5),P()),2&r){const t=p();_(1),y("ngForOf",t.getPossiblesDirections())}}let n_t=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"QuixoState",K1),u(this,"state",void 0),u(this,"lastMoveCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenDirection",void 0),u(this,"victoriousCoords",[]),this.rules=b2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,this.rules,new Xmt,new n4e),new On($localize`MCTS`,new n4e,this.rules)],this.encoder=l3.encoder,this.tutorial=(new t4e).tutorial}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board,i.lastMoveCoord=i.node.previousMove.map(s=>s.coord),i.victoriousCoords=b2.getVictoriousCoords(i.state)})()}cancelMoveAttempt(){this.chosenCoord=g.empty()}getPieceClasses(n,i){const s=new v(n,i),a=[];return a.push(this.getPlayerClass(this.board[i][n])),this.chosenCoord.equalsValue(s)?a.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&a.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),a}onBoardClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i),c=l3.isValidCoord(a);return c.isFailure()?s.cancelMove(c.getReason()):s.board[i][n]===s.state.getCurrentOpponent()?s.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(s.chosenCoord.equalsValue(a)?s.cancelMoveAttempt():s.chosenCoord=g.of(a),b.SUCCESS)})()}getPossiblesDirections(){const n=[],i=this.chosenCoord.get();return i.x!==K1.SIZE-1&&n.push(Re.RIGHT),0!==i.x&&n.push(Re.LEFT),i.y!==K1.SIZE&&n.push(Re.DOWN),0!==i.y&&n.push(Re.UP),n}chooseDirection(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#chooseDirection_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):(i.chosenDirection=n,yield i.tryMove())})()}tryMove(){var n=this;return M(function*(){const i=n.chosenCoord.get(),s=new l3(i.x,i.y,n.chosenDirection);return n.chooseMove(s)})()}getArrowTransform(n){return kft.getArrowTransform(K1.SIZE*this.SPACE_SIZE,n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-quixo"]],features:[Ke],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs"),V(2,"polygon",1),P(),O(3,Jmt,2,1,"g",2),O(4,t_t,2,1,"g",3),P()),2&n&&(I("viewBox","0 0 "+i.QuixoState.SIZE*i.SPACE_SIZE+" "+i.QuixoState.SIZE*i.SPACE_SIZE),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Oi=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.BOARD_WIDTH,r.BOARD_HEIGHT)}static getNeighboringPawnLike(t,n,i,s){let o;const a=[];for(let c=-1;c<2;c++)for(let l=-1;l<2;l++)o=new v(i+l,s+c),r.isOnBoard(o)&&t[o.y][o.x]===n&&a.push(o);return a}countScore(){const t=[0,0];for(let n=0;n<r.BOARD_HEIGHT;n++)for(let i=0;i<r.BOARD_WIDTH;i++){const s=this.board[n][i];s.isPlayer()&&(t[s.value]+=1)}return t}}return u(r,"BOARD_WIDTH",8),u(r,"BOARD_HEIGHT",8),r})();var vR;class es extends Ar{static of(e){return new es(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}u(es,"encoder",Ar.getEncoder((vR=es).of)),u(es,"PASS",new vR(-1,-1));let r_t=(()=>{class r{}return u(r,"NO_ELEMENT_SWITCHED",()=>$localize`Your move should switch at least one piece.`),r})();var ry,ga;class r4e{constructor(e,t){u(this,"move",void 0),u(this,"switched",void 0),this.move=e,this.switched=t}}let Gl=(ry=class extends jn{static get(){return ga.singleton.isAbsent()&&(ga.singleton=g.of(new ga)),ga.singleton.get()}getInitialState(){const e=xt.create(Oi.BOARD_WIDTH,Oi.BOARD_HEIGHT,q.NONE);return e[3][3]=k.ZERO,e[4][4]=k.ZERO,e[3][4]=k.ONE,e[4][3]=k.ONE,new Oi(e,0)}static getGameStatus(e){const t=e.gameState;if(!1===ga.isGameEnded(t))return _e.ONGOING;const i=t.countScore(),s=i[1]-i[0];return s<0?_e.ZERO_WON:s>0?_e.ONE_WON:_e.DRAW}applyLegalMove(e,t,n){const i=t.turn,s=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(es.PASS))return new Oi(o,i+1);for(const c of n)o[c.y][c.x]=s;return o[e.coord.y][e.coord.x]=s,new Oi(o,i+1)}static getAllSwitcheds(e,t,n){const i=[],s=t.getOpponent();for(const o of ye.DIRECTIONS){const a=e.coord.getNext(o);if(Oi.isOnBoard(a)&&n[a.y][a.x]===s){const c=ga.getSandwicheds(t,o,a,n);for(const l of c)i.push(l)}}return i}static getSandwicheds(e,t,n,i){const s=[n];let o=n.getNext(t);for(;Oi.isOnBoard(o);){const a=i[o.y][o.x];if(a===e)return s;if(a===q.NONE)return[];s.push(o),o=o.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return ga.getGameStatus(e)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(es.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),i=new Oi(t,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const t=[];let n;const i=e.getCurrentPlayer(),s=e.getCurrentOpponent();for(let o=0;o<8;o++)for(let a=0;a<8;a++)if(e.getPieceAtXY(a,o)===q.NONE&&(n=e.getCopiedBoard(),Oi.getNeighboringPawnLike(n,s,a,o).length>0)){const l=new es(a,o),f=ga.getAllSwitcheds(l,i,n);if(f.length>0){for(const d of f)B.assert(i!==e.getPieceAt(d),d+"was already switched!"),n[d.y][d.x]=i;n[o][a]=i,t.push(new r4e(l,f.length))}}return 0===t.length&&t.push(new r4e(es.PASS,0)),t}isLegal(e,t){if(e.equals(es.PASS))return ga.playerCanOnlyPass(t)?Q.success([]):Q.failure(Ee.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return Q.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const n=t.getCopiedBoard(),i=ga.getAllSwitcheds(e,t.getCurrentPlayer(),n);return 0===i.length?Q.failure(r_t.NO_ELEMENT_SWITCHED()):Q.success(i)}},ga=ry,u(ry,"singleton",g.empty()),ry);Gl=ga=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],Gl);const Mt=q.NONE,Pt=q.ZERO,Ze=q.ONE;class i4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new Oi([[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt]],60)),j.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,Gl.get().getInitialState(),new es(2,4),$localize`Congratulations!`),j.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new Oi([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Ze,Mt,Mt,Mt],[Mt,Mt,Mt,Pt,Mt,Mt,Mt,Mt],[Mt,Mt,Pt,Mt,Mt,Mt,Mt,Mt],[Pt,Pt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Pt,Ze,Pt,Ze,Pt,Mt,Mt]],1),[new es(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),j.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new Oi([[Ze,Pt,Pt,Pt,Pt,Pt,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Ze,Ze,Ze,Ze,Ze,Ze,Mt,Mt],[Pt,Pt,Pt,Pt,Pt,Pt,Mt,Mt]],60))])}}class s4e extends Fn{getListMoves(e){return Gl.getListMoves(e.gameState).map(n=>n.move)}}class s_t extends tr{getMetrics(e){const n=e.gameState.getCopiedBoard();let i=0,s=0;for(let o=0;o<Oi.BOARD_HEIGHT;o++)for(let a=0;a<Oi.BOARD_WIDTH;a++){const f=(0===a||a===Oi.BOARD_WIDTH-1?4:1)*(0===o||o===Oi.BOARD_HEIGHT-1?4:1);n[o][a]===k.ZERO&&(i+=f),n[o][a]===k.ONE&&(s+=f)}return[i,s]}}class o_t extends cn{constructor(){super($localize`Minimax`,Gl.get(),new s_t,new s4e)}}function a_t(r,e){if(1&r&&(A(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClass(t,n)),I("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function c_t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",2),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P(),O(2,a_t,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ve("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function l_t(r,e){if(1&r&&(A(),S(0,"g"),O(1,c_t,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let u_t=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"EMPTY",q.NONE),u(this,"lastMove",new v(-2,-2)),u(this,"capturedCoords",[]),this.scores=g.of([2,2]),this.rules=Gl.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new o_t,new On($localize`MCTS`,new s4e,this.rules)],this.encoder=es.encoder,this.tutorial=(new i4e).tutorial,this.canPass=!1}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new es(n,i);return yield s.chooseMove(a)})()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.capturedCoords=[],i.lastMove=new v(-2,-2),i.scores=g.of(s.countScore()),i.canPass=Gl.playerCanOnlyPass(s)})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=n.coord;const s=i.getState().getCurrentPlayer(),o=i.getState().getCurrentOpponent();for(const a of ye.DIRECTIONS){let c=i.lastMove.getNext(a,1);for(;Oi.isOnBoard(c)&&i.getState().getPieceAt(c)===o&&i.getPreviousState().getPieceAt(c)===s;)i.capturedCoords.push(c),c=c.getNext(a,1)}})()}getRectClasses(n,i){const s=new v(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(n,i){return this.getPlayerClass(this.board[i][n])}pass(){var n=this;return M(function*(){return B.assert(n.canPass,"ReversiComponent: pass() can only be called if canPass is true"),n.onClick(es.PASS.coord.x,es.PASS.coord.y)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-reversi"]],features:[Ke],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,l_t,2,1,"g",1),P()),2&n&&(I("viewBox","0 -4 "+8*i.SPACE_SIZE+" "+(10+8*i.SPACE_SIZE)),_(1),y("ngForOf",i.board))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ul=(()=>{class r extends R0{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"HEIGHT",6),u(r,"WIDTH",11),r})(),Du=(()=>{class r{}return u(r,"CAN_ONLY_REBOUND_ON_BLACK",()=>$localize`You can only rebound on dark spaces.`),u(r,"CAN_ONLY_REBOUND_ON_EMPTY_SPACE",()=>$localize`You can only rebound on empty spaces.`),u(r,"MUST_CHOOSE_PYRAMID_FIRST",()=>$localize`You must pick one of your pyramids first.`),u(r,"MUST_CHOOSE_OWN_PYRAMID",()=>$localize`You must pick one of your pyramids.`),u(r,"THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS",()=>$localize`Those two spaces are not neighbors.`),u(r,"THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR",()=>$localize`Those two spaces have no intermediary neighbor.`),r})();class nc extends Qs{static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return b.failure(Ee.MOVE_CANNOT_BE_STATIC());if(1===n){const i=na.getFakeNeighbors(e);if(t.equals(i))return b.failure(Du.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return b.failure($localize`You can move one or two spaces, not ${n}.`);if(na.isSpaceDark(e))return b.failure(Du.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return b.failure(Du.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return b.SUCCESS}static from(e,t){B.assert(Ul.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),B.assert(Ul.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=nc.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new nc(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var iy,u3;u(nc,"encoder",qi.getFallibleEncoder(nc.from));let f3=(iy=class extends jn{static get(){return u3.singleton.isAbsent()&&(u3.singleton=g.of(new u3)),u3.singleton.get()}getInitialState(){const e=Me.UNREACHABLE,t=Me.ZERO,n=Me.ONE,i=Me.EMPTY;return new Ul([[e,e,t,n,i,i,i,t,n,e,e],[e,i,i,i,i,i,i,i,i,i,e],[n,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,n],[e,i,i,i,i,i,i,i,i,i,e],[e,e,n,t,i,i,i,n,t,e,e]],0)}static getStartingCoords(e,t){const n=[];for(let i=0;i<Ul.HEIGHT;i++)for(let s=0;s<Ul.WIDTH;s++)e[i][s].is(t)&&n.push(new v(s,i));return n}static getBoardValuesFor(e,t){const n=u3.getStartingCoords(e,t),i=[];for(const s of n){const o=R0.getEmptyNeighbors(e,s,Me.EMPTY).length;if(0===o)return[0];i.push(o)}return i.sort((s,o)=>s-o)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Me.EMPTY,new Ul(i,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(t.getPieceAt(e.getEnd())!==Me.EMPTY)return b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const s=na.getCommonNeighbor(e.getStart(),e.getEnd());return s.isPresent()?t.getPieceAt(s.get())===Me.EMPTY?b.SUCCESS:b.failure(Du.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):b.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=u3.getBoardValuesFor(t,k.ZERO),i=u3.getBoardValuesFor(t,k.ONE);return u3.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=s=>Ul.isOnBoard(s)&&e[s.y][s.x]===Me.EMPTY,i=new st(na.getNeighbors(t).filter(n));if(!0===na.isSpaceDark(t))return i.toList();{const s=new st(i.toList());for(const o of i){const a=na.getNeighbors(o).filter(n);for(const c of a)s.add(c)}return s.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?_e.ONE_WON:0===t[0]?_e.ZERO_WON:_e.ONGOING}},u3=iy,u(iy,"singleton",g.empty()),iy);f3=u3=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],f3);const ma=Me.UNREACHABLE,Hu=Me.ZERO,Vu=Me.ONE,an=Me.EMPTY;class a4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,f3.get().getInitialState()),j.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new Ul([[ma,ma,an,an,Vu,an,an,Hu,Vu,ma,ma],[ma,an,an,an,an,an,an,an,an,an,ma],[Vu,Hu,an,an,an,an,an,an,an,an,Hu],[Hu,an,an,an,an,an,an,an,an,an,Vu],[ma,an,an,an,an,an,an,an,an,an,ma],[ma,ma,Vu,Hu,an,an,an,Vu,Hu,ma,ma]],3)),j.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,f3.get().getInitialState(),nc.from(new v(2,0),new v(2,1)).get(),(t,n,i)=>t.isSimpleStep()?b.SUCCESS:b.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),j.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,f3.get().getInitialState(),nc.from(new v(7,0),new v(5,0)).get(),(t,n,i)=>t.isSimpleStep()?b.failure($localize`Failed! You have made a single step.`):b.SUCCESS,$localize`Congratulations!`)])}}class d_t extends tr{getMetrics(e){const t=e.gameState.board,n=f3.getBoardValuesFor(t,k.ZERO),i=f3.getBoardValuesFor(t,k.ONE);let s=0;for(;s<6&&n[s]===i[s];)s++;return[n[s%6],i[s%6]]}}class c4e extends Fn{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),s=f3.getStartingCoords(n,i);for(const o of s){const a=R0.getEmptyNeighbors(n,o,Me.EMPTY);for(const c of a){const l=nc.from(o,c).get();if(n[c.y][c.x]=n[o.y][o.x],n[o.y][o.x]=Me.EMPTY,t.push(l),(c.y+c.x)%2==0){const d=R0.getEmptyNeighbors(n,c,Me.EMPTY);for(const m of d)if(!1===m.equals(o)){const E=nc.from(o,m).get();n[m.y][m.x]=n[c.y][c.x],n[c.y][c.x]=Me.EMPTY,t.push(E),n[c.y][c.x]=n[m.y][m.x],n[m.y][m.x]=Me.EMPTY}}n[o.y][o.x]=n[c.y][c.x],n[c.y][c.x]=Me.EMPTY}}return t}}function h_t(r,e){if(1&r&&(A(),S(0,"g"),V(1,"polygon",7),P()),2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getPlayerClassFor(t,n)),I("points",i.getPyramidPoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function p_t(r,e){if(1&r&&(A(),V(0,"polygon",10)),2&r){const t=p(2).index,n=p().index,i=p();I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function g_t(r,e){if(1&r&&(A(),V(0,"polygon",11)),2&r){const t=p(2).index,n=p().index,i=p();I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function m_t(r,e){if(1&r&&(A(),S(0,"g"),O(1,p_t,1,2,"polygon",8),O(2,g_t,1,2,"polygon",9),P()),2&r){const t=p().index,n=p().index;_(1),y("ngIf",(t+n)%2==1),_(1),y("ngIf",(t+n)%2==0)}}function __t(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),O(1,h_t,2,3,"g",6),O(2,m_t,3,2,"g",6),P()}if(2&r){const t=e.$implicit;ve("id","click_",e.index,"_",p().index,""),_(1),y("ngIf",t.isPlayer()),_(1),y("ngIf",2===t.value)}}function v_t(r,e){if(1&r&&(A(),S(0,"g"),O(1,__t,3,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function C_t(r,e){if(1&r&&(A(),V(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);ve("id","possible_landing_",t.x,"_",t.y,""),I("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslate(t.x,t.y))}}function y_t(r,e){if(1&r&&(A(),V(0,"polygon",14)),2&r){const t=p(2);ve("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function M_t(r,e){if(1&r&&(A(),Gt(0),O(1,C_t,1,4,"polygon",12),O(2,y_t,1,4,"polygon",13),Ut()),2&r){const t=p();_(1),y("ngForOf",t.possibleLandings),_(1),y("ngIf",t.chosenCoord.isPresent())}}function E_t(r,e){if(1&r&&(A(),Gt(0),V(1,"polygon",15)(2,"polygon",15),Ut()),2&r){const t=p(2);_(1),I("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslate(t.lastCoord.get().x,t.lastCoord.get().y)),_(1),I("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslate(t.lastMoved.get().x,t.lastMoved.get().y))}}function S_t(r,e){1&r&&(A(),O(0,E_t,3,4,"ng-container",6)),2&r&&y("ngIf",p().lastMoved.isPresent())}let P_t=(()=>{var r;class e extends mce{constructor(n){super(n),u(this,"lastCoord",g.empty()),u(this,"lastMoved",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"possibleLandings",[]),this.rules=f3.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,this.rules,new d_t,new c4e),new On($localize`MCTS`,new c4e,this.rules)],this.encoder=nc.encoder,this.tutorial=(new a4e).tutorial}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=g.empty()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentPlayer(),c=Me.ofPlayer(a);return s.chosenCoord.equalsValue(new v(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.board[i][n]===c?s.choosePiece(n,i):s.chooseLandingCoord(n,i)})()}choosePiece(n,i){var s=this;return M(function*(){if(s.board[i][n]===Me.EMPTY)return s.cancelMove(Du.MUST_CHOOSE_PYRAMID_FIRST());if(s.board[i][n].is(k.ofTurn(s.getTurn()))){const o=new v(n,i);return s.selectPiece(o),b.SUCCESS}return s.cancelMove(Du.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(n){this.chosenCoord=g.of(n),this.possibleLandings=this.rules.getLandingCoords(this.board,n)}chooseLandingCoord(n,i){var s=this;return M(function*(){const o=new v(n,i),a=nc.from(s.chosenCoord.get(),o);return a.isFailure()?s.cancelMove(a.getReason()):yield s.chooseMove(a.get())})()}updateBoard(n){var i=this;return M(function*(){const s=i.node.previousMove;i.lastCoord=s.map(o=>o.getStart()),i.lastMoved=s.map(o=>o.getEnd()),i.board=i.getState().board})()}getPlayerClassFor(n,i){return this.getPlayerClass(k.of(this.board[i][n].value))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-sahara"]],features:[Ke],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-55 -55 610 610","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["class","base mid-stroke",4,"ngIf"],["class","base mid-stroke background2",4,"ngIf"],[1,"base","mid-stroke"],[1,"base","mid-stroke","background2"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(A(),S(0,"svg",0),O(1,v_t,2,1,"g",1),O(2,M_t,3,2,"ng-container",2),O(3,S_t,1,1,"ng-template",null,3,dn),P()),2&n){const s=un(4);_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var rc;class ft{static decode(e){switch(e){case 0:return ft.EMPTY;case 1:return ft.LIGHT_UP;case 2:return ft.LIGHT_RIGHT;case 3:return ft.LIGHT_DOWN;case 4:return ft.LIGHT_LEFT;case 5:return ft.DARK_UP;case 6:return ft.DARK_RIGHT;case 7:return ft.DARK_DOWN;case 8:return ft.DARK_LEFT;case 9:return ft.MOUNTAIN}}belongsTo(e){return e===k.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?k.ZERO:5<=this.value&&this.value<=8?k.ONE:q.NONE}getOptionalDirection(){switch(this.value){case 0:return g.empty();case 1:case 5:return g.of(Re.UP);case 2:case 6:return g.of(Re.RIGHT);case 3:case 7:return g.of(Re.DOWN);case 4:case 8:return g.of(Re.LEFT);default:return B.expectToBe(this.value,9),g.empty()}}static of(e,t){return t===k.ZERO?e===Re.UP?ft.LIGHT_UP:e===Re.RIGHT?ft.LIGHT_RIGHT:e===Re.DOWN?ft.LIGHT_DOWN:ft.LIGHT_LEFT:e===Re.UP?ft.DARK_UP:e===Re.RIGHT?ft.DARK_RIGHT:e===Re.DOWN?ft.DARK_DOWN:ft.DARK_LEFT}constructor(e){u(this,"value",void 0),this.value=e}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return B.expectToBe(this.value,9),"MOUNTAIN"}}}u(ft,"EMPTY",new(rc=ft)(0)),u(ft,"LIGHT_UP",new rc(1)),u(ft,"LIGHT_RIGHT",new rc(2)),u(ft,"LIGHT_DOWN",new rc(3)),u(ft,"LIGHT_LEFT",new rc(4)),u(ft,"DARK_UP",new rc(5)),u(ft,"DARK_RIGHT",new rc(6)),u(ft,"DARK_DOWN",new rc(7)),u(ft,"DARK_LEFT",new rc(8)),u(ft,"MOUNTAIN",new rc(9));let O1=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(const n of this.getCoordsAndContents())n.content!==ft.EMPTY&&t[n.content.getOwner().value]++;return t}}return u(r,"SIZE",5),r})();var l4e;class ro extends Ar{constructor(e,t,n,i){super(e,t),u(this,"x",void 0),u(this,"y",void 0),u(this,"direction",void 0),u(this,"landingOrientation",void 0),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static from(e,t,n,i){const s=new ro(e,t,n,i),o=!1===O1.isOnBoard(s.coord);if(s.isRotation()){if(o)return Q.failure("Cannot rotate piece outside the board: "+s.toString())}else if(!1===O1.isOnBoard(s.coord.getNext(s.direction.get()))){if(o)return Q.failure("SiamMove should end or start on the board: "+s.toString());if(s.direction.get()!==s.landingOrientation)return Q.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+s.toString())}return Q.success(s)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||this.coord.x===+O1.SIZE||-1===this.coord.y||this.coord.y===+O1.SIZE}}l4e=ro,u(ro,"encoder",we.tuple([we.identity(),we.identity(),g.getEncoder(Re.encoder),Re.encoder],r=>[r.x,r.y,r.direction,r.landingOrientation],r=>l4e.from(r[0],r[1],r[2],r[3]).get()));let Fu=(()=>{class r{}return u(r,"NO_REMAINING_PIECE_TO_INSERT",()=>$localize`You cannot insert a piece, all your pieces are already on the board.`),u(r,"NOT_ENOUGH_FORCE_TO_PUSH",()=>$localize`You do not have enough strength to push.`),u(r,"MUST_MOVE_OR_ROTATE",()=>$localize`You must move or rotate your piece.`),u(r,"ILLEGAL_PUSH",()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`),u(r,"MUST_SELECT_VALID_DESTINATION",()=>$localize`You must select a valid destination (highlighted on the board) for your piece`),u(r,"MUST_SELECT_ORIENTATION",()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`),r})();var sy,$u;class u4e{constructor(e,t){u(this,"resultingBoard",void 0),u(this,"moved",void 0),this.resultingBoard=e,this.moved=t}}let ts=(sy=class extends jn{static get(){return $u.singleton.isAbsent()&&($u.singleton=g.of(new $u)),$u.singleton.get()}getInitialState(){const e=xt.create(O1.SIZE,O1.SIZE,ft.EMPTY);return e[2][1]=ft.MOUNTAIN,e[2][2]=ft.MOUNTAIN,e[2][3]=ft.MOUNTAIN,new O1(e,0)}isLegal(e,t){if(!1===e.isInsertion()){const n=t.getPieceAt(e.coord);if(n===ft.EMPTY)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n.belongsTo(t.getCurrentOpponent()))return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}if(e.isRotation())return this.isLegalRotation(e,t);{let n;if(e.isInsertion()){const i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return Q.failure(i.legal.getReason());n=i.insertedPiece}else n=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,n)}}isLegalInsertion(e,t){const n=t.countCurrentPlayerPawn(),i=t.getCurrentPlayer(),s=n<5?b.SUCCESS:b.failure(Fu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,i),legal:s}}getInsertedPiece(e,t){return ft.of(-1===e.x?Re.RIGHT:-1===e.y?Re.DOWN:e.x===O1.SIZE?Re.LEFT:Re.UP,t)}isLegalForwarding(e,t,n){B.assert(n!==ft.MOUNTAIN&&n!==ft.EMPTY,"forwarding must be done with player piece");const i=[];let s=ft.of(e.landingOrientation,t.getCurrentPlayer());const o=e.direction.get();let a=e.coord.getNext(o);if(O1.isOnBoard(a)&&t.getPieceAt(a)!==ft.EMPTY&&!1===this.isStraight(n,e))return Q.failure(Fu.ILLEGAL_PUSH());let c=g.of(o);const l=o.getOpposite();let f=0;const d=t.getCopiedBoard();O1.isOnBoard(e.coord)&&(d[e.coord.y][e.coord.x]=ft.EMPTY,i.push(e.coord));let m=O1.isOnBoard(a)&&s!==ft.EMPTY;for(;m;){c.equalsValue(o)?f++:c.equalsValue(l)&&f--;const E=d[a.y][a.x];E===ft.MOUNTAIN&&(f-=.9),d[a.y][a.x]=s,i.push(a),s=E,a=a.getNext(o),c=s.getOptionalDirection(),m=O1.isOnBoard(a)&&s!==ft.EMPTY&&f>0}return!1===O1.isOnBoard(a)&&(c.equalsValue(o)?f++:c.equalsValue(l)&&f--),f<=0?Q.failure(Fu.NOT_ENOUGH_FORCE_TO_PUSH()):Q.success(new u4e(d,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),s=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return Q.failure(Fu.MUST_MOVE_OR_ROTATE());const o=t.getCopiedBoard();return o[n.y][n.x]=ft.of(e.landingOrientation,s),Q.success(new u4e(o,[n]))}applyLegalMove(e,t,n){const i=xt.copy(n.resultingBoard);return new O1(i,t.turn+1)}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,s=6-t;return i===s?n.getScoreModifier():i>s?-10*(i+1)+(s+1):10*(s+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const s of e.getCoordsAndContents())s.content===ft.MOUNTAIN&&(!1===t.includes(s.coord.y)&&t.push(s.coord.y),!1===n.includes(s.coord.x)&&n.push(s.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n){return 2===n?this.getPusher(e,t.get()):q.NONE}getPusher(e,t){const n=t.coord;let i;i=O1.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent());const s=i.getDirection(),o=this.getPusherCoord(e,s,n),a=e.getPieceAt(o).getOwner();return Ae.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().value+", "+o.toString()+" belong to "+a.value+", "+a.value+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),s=n;for(;O1.isOnBoard(i);){n=i,i=i.getNext(t);const o=e.getPieceAt(n);o!==ft.MOUNTAIN&&o.getDirection()===t&&(s=n)}return s}getPushers(e,t,n){let i=[];const s=[];for(const o of t){let a=Re.DOWN,c=new v(o,4);s.push({direction:a,fallingCoord:c}),a=Re.UP,c=new v(o,0),s.push({direction:a,fallingCoord:c})}for(const o of n){let a=Re.LEFT,c=new v(0,o);s.push({direction:a,fallingCoord:c}),a=Re.RIGHT,c=new v(4,o),s.push({direction:a,fallingCoord:c})}for(const o of s)i=this.addPotentialDirectionPusher(e,o.fallingCoord,o.direction,i);return i}addPotentialDirectionPusher(e,t,n,i){const s=this.getLineClosestPusher(e,t,n);if(s.isAbsent())return i;const o=s.get();return i.push({coord:o.coord,distance:o.distance}),i}getLineClosestPusher(e,t,n){const i=n.getOpposite();let s=1,o=e.getPieceAt(t),a=t,c=g.empty(),l=!1,f=!1,d=0;for(;O1.isOnBoard(a)&&!1===l;){const m=e.getPieceAt(a);if(m.isEmptyOrMountain())m===ft.MOUNTAIN?(d+=.9,f=!0):s++;else{const E=m.getDirection();E===n?f&&(d-=1,d<=0&&(l=!0,a=a.getNext(n))):E===i?(d+=1,!1===f&&s++):f?(c=g.of(a),o!==ft.EMPTY&&s++):s++}o=m,a=a.getPrevious(n)}if(!1===l&&c.isPresent())for(s++,d-=1;!1===a.equals(c.get());)a=a.getNext(n),s--;return!1===O1.isOnBoard(a)&&(d-=1,5===e.countCurrentPlayerPawn())||d>0?g.empty():g.of({distance:s,coord:a})}getInsertions(e){let t=[];for(let n=1;n<4;n++)t=t.concat(this.getInsertionsAt(e,0,n)),t=t.concat(this.getInsertionsAt(e,4,n)),t=t.concat(this.getInsertionsAt(e,n,0)),t=t.concat(this.getInsertionsAt(e,n,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,n){const i=[];for(const s of Re.ORTHOGONALS){const o=new v(t,n).getPrevious(s);if(!1===O1.isOnBoard(o))for(const a of Re.ORTHOGONALS){const c=ro.from(o.x,o.y,g.of(s),a);B.assert(c.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(c.get(),e).isSuccess()&&i.push(c.get())}}return i}getMovesFrom(e,t,n,i){const s=new v(n,i);let o=this.getRotationMovesAt(s,t);for(const a of Re.ORTHOGONALS){const c=s.getNext(a);o=o.concat(this.getForwardMovesBetween(e,s,c))}return o}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):Re.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const s of Re.ORTHOGONALS)if(s!==i){const o=ro.from(e.x,e.y,g.empty(),s).get();n.push(o)}return n}getForwardMovesBetween(e,t,n){const i=[];let s;const o=Re.factory.fromMove(t,n).get(),a=e.getPieceAt(t);s=O1.isOnBoard(n)?Re.ORTHOGONALS:[o];for(const c of s){const l=ro.from(t.x,t.y,g.of(o),c).get();this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.previousMove,t.nbMountain);return n.isPlayer()?_e.getVictory(n):_e.ONGOING}},$u=sy,u(sy,"singleton",g.empty()),sy);ts=$u=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ts);const ke=ft.EMPTY,Lo=ft.MOUNTAIN,CR=ft.LIGHT_UP,yR=ft.LIGHT_LEFT,Bu=ft.LIGHT_RIGHT,T_t=ft.LIGHT_DOWN,b_t=ft.DARK_UP,f4e=ft.DARK_LEFT,d4e=ft.DARK_RIGHT,w_t=ft.DARK_DOWN;class h4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,ts.get().getInitialState()),j.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,ts.get().getInitialState(),ro.from(2,-1,g.of(Re.DOWN),Re.DOWN).get(),$localize`Congratulations!`),j.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new O1([[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke],[ke,Lo,Lo,Lo,ke],[ke,ke,ke,ke,ke],[ke,ke,CR,ke,ke]],0),[ro.from(2,4,g.of(Re.UP),Re.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),j.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new O1([[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke],[ke,Lo,Lo,Lo,ke],[ke,ke,ke,ke,ke],[ke,ke,CR,ke,ke]],0),[ro.from(2,4,g.of(Re.DOWN),Re.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),j.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new O1([[ke,Bu,f4e,ke,ke],[Bu,d4e,yR,ke,ke],[ke,ke,CR,ke,ke],[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke]],0),[ro.from(2,2,g.of(Re.UP),Re.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new O1([[ke,ke,Bu,Lo,ke],[ke,ke,Bu,Lo,yR],[ke,Bu,Lo,Lo,ke],[ke,Bu,d4e,f4e,Lo],[ke,ke,ke,ke,ke]],0),[ro.from(1,3,g.of(Re.RIGHT),Re.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),j.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new O1([[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke],[Lo,b_t,yR,ke,T_t],[ke,ke,ke,ke,w_t],[ke,ke,ke,ke,Lo]],0),[ro.from(2,2,g.of(Re.LEFT),Re.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)])}}class p4e extends Fn{getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(const i of e.gameState.getCoordsAndContents()){const s=i.content;s.belongsTo(n)&&(t=t.concat(ts.get().getMovesFrom(e.gameState,s,i.coord.x,i.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const i of ts.get().getInsertions(e.gameState))if(i.direction.get().getOpposite()!==i.landingOrientation){if(this.isOnBorder(i)&&i.direction.get()!==i.landingOrientation)continue;t.push(i)}return t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}}class N_t extends Fa{getBoardValue(e){const t=this.getBoardValueInfo(e.gameState);return new Jn(t.boardValue)}getBoardValueInfo(e){const t=ts.get().getMountainsRowsAndColumns(e),n=t.rows,i=t.columns,s=ts.get().getPushers(e,i,n);let o=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER;const c=e.getCurrentPlayer();for(const f of s)O1.isOnBoard(f.coord)?e.getPieceAt(f.coord).belongsTo(k.ZERO)?o=Math.min(o,f.distance):a=Math.min(a,f.distance):c===k.ZERO?o=Math.min(o,f.distance):a=Math.min(a,f.distance);return{shortestZero:o,shortestOne:a,boardValue:ts.get().getScoreFromShortestDistances(o,a,c)}}}class A_t extends cn{constructor(){super($localize`Minimax`,ts.get(),new N_t,new p4e)}}var Gu;function k_t(r,e){if(1&r){const t=pe();A(),S(0,"use",11),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().clickSquare(i,s))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","piece_",n,"_",s,""),y("ngClass",o.getPieceClasses(n,s,i)),I("transform",o.getPieceTransform(n,s))}}function x_t(r,e){if(1&r){const t=pe();A(),S(0,"use",12),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p().clickSquare(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p();I("transform","translate("+(t+1)*i.SPACE_SIZE+" "+(n+1)*i.SPACE_SIZE+")")}}function L_t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",8),W("click",function(){const s=ne(t).index,o=p().index;return re(p().clickSquare(s,o))}),P(),O(2,k_t,1,4,"use",9),O(3,x_t,1,1,"use",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ve("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",s.SPACE_SIZE*(n+1))("y",s.SPACE_SIZE*(i+1))("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isPiece()),_(1),y("ngIf",s.isMountain(t))}}function R_t(r,e){if(1&r&&(A(),S(0,"g"),O(1,L_t,4,9,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function z_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",15),W("click",function(){ne(t);const i=p().$implicit;return re(p().clickSquare(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ve("id","square_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),I("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function D_t(r,e){if(1&r){const t=pe();A(),S(0,"g"),O(1,z_t,1,7,"rect",13),S(2,"rect",14),W("click",function(){const s=ne(t).$implicit;return re(p().clickSquare(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngIf",!1===n.SiamState.isOnBoard(t)),_(1),I("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function H_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",16),W("click",function(){ne(t);const i=p();return re(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),P()}if(2&r){const t=p();I("x",t.SPACE_SIZE*(t.selectedLanding.get().x+1))("y",t.SPACE_SIZE*(t.selectedLanding.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function V_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",16),W("click",function(){ne(t);const i=p();return re(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),P()}if(2&r){const t=p();I("x",t.SPACE_SIZE*(t.selectedPiece.get().x+1))("y",t.SPACE_SIZE*(t.selectedPiece.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function F_t(r,e){if(1&r&&(A(),V(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ve("id","remainingPieces_",n.value,"_",t,""),y("ngClass",i.getRemainingPieceClasses(n,t)),I("transform",i.getRemainingPieceTransform(t,n))}}function $_t(r,e){if(1&r){const t=pe();A(),S(0,"g",17),W("click",function(){const s=ne(t).$implicit;return re(p().selectPieceForInsertion(s))}),O(1,F_t,1,4,"use",18),P()}if(2&r){const t=e.$implicit,n=p();Dn("id","remainingPieces_",t.value,""),_(1),y("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function B_t(r,e){if(1&r){const t=pe();A(),S(0,"use",22),W("click",function(){ne(t);const i=p().$implicit;return re(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),P()}if(2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),I("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function G_t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"use",20),W("click",function(){const s=ne(t).$implicit;return re(p().clickArrow(s))}),P(),O(2,B_t,1,2,"use",21),P()}if(2&r){const t=e.$implicit,n=p();_(1),zi("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),I("transform",n.getIndicatorTransform(t)),_(1),y("ngIf",t.source.isPresent())}}function U_t(r,e){if(1&r){const t=pe();A(),S(0,"use",23),W("click",function(){const s=ne(t).$implicit;return re(p().selectOrientation(s))}),P()}if(2&r){const t=e.$implicit,n=p();Dn("id","orientation_",t.landingOrientation,""),y("ngClass",n.getCurrentPlayerClass()),I("transform",n.getOrientationTransform(t.landingOrientation))}}let MR=(Gu=class extends Ci{constructor(e){super(e),u(this,"SiamState",O1),u(this,"lastMove",g.empty()),u(this,"movedPieces",[]),u(this,"selectedPiece",g.empty()),u(this,"selectedLanding",g.empty()),u(this,"orientations",[]),u(this,"clickableCoords",new st),u(this,"indicatorArrows",[]),u(this,"insertingPiece",!1),this.rules=ts.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new A_t,new On($localize`MCTS`,new p4e,this.rules)],this.encoder=ro.encoder,this.tutorial=(new h4e).tutorial}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.board,t.movedPieces=[]})()}showLastMove(e){var t=this;return M(function*(){t.lastMove=g.of(e);const n=t.getPreviousState();t.movedPieces=t.rules.isLegal(t.lastMove.get(),n).get().moved})()}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=g.empty(),this.selectedLanding=g.empty(),this.orientations=[],this.clickableCoords=new st,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e===t.getCurrentOpponent())return t.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(t.insertingPiece)return t.cancelMoveAttempt(),b.SUCCESS;t.cancelMoveAttempt();for(const i of ts.get().getInsertions(t.getState())){const s=i.coord.getNext(i.direction.get());if(t.board[s.y][s.x]!==ft.EMPTY){const o={source:g.empty(),target:s,direction:i.direction.get(),move:i};t.indicatorArrows.push(o)}t.clickableCoords.add(s)}return t.insertingPiece=!0,b.SUCCESS})()}selectOrientation(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!1){var i=this;return M(function*(){if(!1===n){const o=yield i.canUserPlay("#square_"+e+"_"+t);if(o.isFailure())return i.cancelMove(o.getReason())}const s=new v(e,t);if(i.insertingPiece)return i.insertPiece(s);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),b.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=g.of(s);const o=ts.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s);return 0===o.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(o)}{B.assert(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible");const o=i.board[t][e];return o.getOwner()===q.NONE?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):o.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i.selectPiece(s,o)}})()}insertPiece(e){var t=this;return M(function*(){if(t.selectedLanding.isPresent())return yield t.cancelMove(Fu.MUST_SELECT_ORIENTATION()),b.SUCCESS;t.selectedLanding=g.of(e);const n=ts.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===n.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(n)})()}changeMoveDestinationClick(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(Fu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return M(function*(){return B.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?t.chooseMove(e[0]):(t.clickableCoords=new st,t.indicatorArrows=[],t.orientations=e,b.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=g.of(e);const i=ts.get().getMovesFrom(n,t,e.x,e.y);for(const s of i)if(s.direction.isPresent()){const o=s.coord.getNext(s.direction.get());if(this.clickableCoords.add(o),n.isOnBoard(o)&&n.getPieceAt(o)!==ft.EMPTY){const a={source:g.of({coord:e,piece:t}),target:o,direction:s.direction.get(),move:s};this.indicatorArrows.push(a)}}else this.clickableCoords.add(s.coord);return b.SUCCESS}clickArrow(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===ft.MOUNTAIN}getArrowTransform(e,t,n){const s=`rotate(${90*(n.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",s].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const n=this.playerPieces(t);let a,c,o=2;return t===this.getPointOfView()?(o+=(e+1+(5-n)/2)/3,a=7,c=Re.LEFT):(o+=(n-e+(5-n)/2)/3,a=-1,c=Re.RIGHT),this.getArrowTransform(o,a,c)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,t].join(" ")}getPieceClasses(e,t,n){const i=new v(e,t),s=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&s.push("selected-stroke"),s}getSquareClasses(e,t){const n=new v(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}},u(Gu,"\u0275fac",function(e){return new(e||Gu)(U($t))}),u(Gu,"\u0275cmp",Be({type:Gu,selectors:[["app-siam"]],features:[Ke],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0)(1,"defs"),V(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(),O(5,R_t,2,1,"g",4),O(6,D_t,3,5,"g",4),O(7,H_t,1,4,"rect",5),O(8,V_t,1,4,"rect",5),O(9,$_t,2,2,"g",6),O(10,G_t,3,5,"g",4),O(11,U_t,1,3,"use",7),P()),2&e&&(_(5),y("ngForOf",t.board),_(1),y("ngForOf",t.clickableCoords),_(1),y("ngIf",t.selectedLanding.isPresent()),_(1),y("ngIf",t.selectedPiece.isPresent()),_(1),y("ngForOf",t.Player.PLAYERS),_(1),y("ngForOf",t.indicatorArrows),_(1),y("ngForOf",t.orientations))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),Gu);var g4e;MR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],MR);class Cr extends vi{static of(e,t,n){return new Cr(e,t,n)}static ofDrop(e){return new Cr(g.empty(),e,g.empty())}static ofMovement(e,t){return new Cr(g.of(e),t,g.empty())}static ofCut(e,t,n){return new Cr(g.of(e),t,g.of(n))}constructor(e,t,n){super(),u(this,"start",void 0),u(this,"landing",void 0),u(this,"keep",void 0),this.start=e,this.landing=t,this.keep=n,B.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),B.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}g4e=Cr,u(Cr,"encoder",we.tuple([g.getEncoder(v.encoder),v.encoder,g.getEncoder(v.encoder)],r=>[r.start,r.landing,r.keep],r=>g4e.of(r[0],r[1],r[2])));let ic=(()=>{class r{}return u(r,"NO_MOVEMENT_BEFORE_TURN_40",()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`),u(r,"MUST_CUT",()=>$localize`Several groups are of the same size, you must pick the one to keep.`),u(r,"CANNOT_CHOOSE_TO_KEEP",()=>$localize`You cannot choose which part to keep when one is smaller than the other.`),u(r,"CAN_NO_LONGER_DROP",()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`),u(r,"MUST_CAPTURE_BIGGEST_GROUPS",()=>$localize`You must choose one of the biggest groups to keep it.`),u(r,"CANNOT_KEEP_EMPTY_COORD",()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`),u(r,"MUST_DROP_NEXT_TO_OTHER_PIECE",()=>$localize`You must put this piece next to another piece.`),r})();class io extends s3e{static ofRepresentation(e,t,n=new St(0,0)){const i=new du;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)if(e[s][o]!==q.NONE){const a=new v(o,s).getNext(n);i.set(a,e[s][o])}return new io(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new io(t,this.turn)}toRepresentation(){const e=xt.create(this.width,this.height,q.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?b.SUCCESS:b.failure(ic.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of M2.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():q.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new io(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new du;for(const s of t)i.set(s,n.getPieceAt(s));return new io(i,this.turn+1)}return new io(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(k.ZERO).getOrElse(new W1),n=e.get(k.ONE).getOrElse(new W1);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new io(t,this.turn);m2.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var oy,Wl;let sc=(oy=class extends jn{constructor(...e){super(...e),u(this,"currentVictorySource",void 0)}static get(){return Wl.singleton.isAbsent()&&(Wl.singleton=g.of(new Wl)),Wl.singleton.get()}getInitialState(){return io.ofRepresentation([[k.ZERO],[k.ONE]],0)}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):Wl.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new W1;for(const n of e.getPieceCoords())for(const i of Ne.factory.all){const s=n.getNext(i,1);e.getPieceAt(s)===q.NONE&&t.add(s)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?Q.failure(ic.NO_MOVEMENT_BEFORE_TURN_40()):Q.success(new st(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return Q.failure(ic.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===q.NONE)return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return Q.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const i=t.movePiece(e),s=i.getGroups();if(Wl.isSplit(s)){const o=this.getLargestGroups(s);return 1===o.size()?e.keep.isPresent()?Q.failure(ic.CANNOT_CHOOSE_TO_KEEP()):Q.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,o,i)}return Q.success(new W1)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new st;for(const i of e){const s=i.size();s>t?(t=s,n=new st([i])):s===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return Q.failure(ic.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return Q.failure(ic.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const s of t)if(s.contains(i))return Q.success(s);return Q.failure(ic.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.previousMove.isPresent()&&(i=this.getShapeVictory(e.previousMove.get(),t)),6===i.length)return _e.getVictory(n);if(t.turn>39){const s=t.countPieces(),o=s[0],a=s[1];return o<6&&a<6?o<a?_e.ONE_WON:a<o?_e.ZERO_WON:_e.DRAW:o<6?_e.getDefeat(k.ZERO):a<6?_e.getDefeat(k.ONE):_e.ONGOING}return _e.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(Ne.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+o.length)%6;o.push(a),a=a.getNext(Ne.factory.all[l],1)}return o}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=Ne.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return[];c=!0,s=s.getOpposite(),o=o.getNext(s,a.length)}o=o.getNext(s,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=Ne.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.length%2==0&&(s=Ne.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return o}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=Ne.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.push(a),o.length%2==0&&(s=Ne.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return o}},Wl=oy,u(oy,"singleton",g.empty()),oy);sc=Wl=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],sc);const ue=q.NONE,Ot=k.ZERO,It=k.ONE;let ER=(()=>{class r{}return u(r,"MOVEMENT_NOT_DISCONNECTING",()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`),u(r,"MOVEMENT_SELF_DISCONNECTING",()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`),r})();class m4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,sc.get().getInitialState()),j.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,io.ofRepresentation([[Ot,It,It,It,It,Ot],[ue,Ot,It,ue,Ot,ue],[It,It,Ot,ue,ue,ue],[ue,ue,Ot,ue,ue,ue],[ue,Ot,ue,ue,ue,ue],[Ot,ue,ue,ue,ue,ue]],0),[Cr.ofDrop(new v(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,io.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,ue,It,It,Ot,Ot],[ue,It,ue,Ot,It,ue],[It,Ot,Ot,Ot,Ot,It]],0),[Cr.ofDrop(new v(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),j.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,io.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,Ot,It,Ot,Ot,Ot],[ue,Ot,ue,Ot,Ot,ue],[It,It,It,ue,It,ue]],0),[Cr.ofDrop(new v(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),j.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,io.ofRepresentation([[ue,ue,ue,ue,ue,ue,ue,It,ue],[ue,ue,ue,ue,ue,ue,Ot,ue,ue],[ue,ue,ue,ue,Ot,Ot,Ot,ue,ue],[ue,ue,ue,ue,It,It,ue,It,Ot],[ue,Ot,It,It,Ot,Ot,It,ue,ue],[Ot,Ot,Ot,Ot,It,It,It,Ot,ue],[It,It,Ot,ue,It,It,Ot,ue,ue],[ue,Ot,ue,Ot,Ot,ue,ue,ue,ue],[It,It,It,It,ue,ue,ue,ue,ue],[ue,Ot,ue,It,ue,ue,ue,ue,ue]],40),Cr.ofMovement(new v(6,1),new v(5,1)),(t,n,i)=>{const s=i.countPieces();return 19===s[0]?18===s[1]?b.SUCCESS:b.failure(ER.MOVEMENT_NOT_DISCONNECTING()):b.failure(ER.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),j.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,io.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Ot,It],[ue,ue,ue,It,Ot,Ot],[ue,ue,Ot,ue,It,Ot],[It,It,ue,ue,ue,Ot],[Ot,It,ue,ue,ue,ue],[Ot,ue,ue,ue,ue,ue]],40),Cr.ofMovement(new v(2,3),new v(3,3)),(t,n,i)=>t.start.equalsValue(new v(2,3))?b.SUCCESS:b.failure(ER.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),j.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,io.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Ot,It],[ue,ue,ue,It,Ot,Ot],[Ot,ue,Ot,ue,ue,It],[It,It,ue,ue,ue,ue],[Ot,Ot,ue,ue,ue,ue],[Ot,ue,ue,ue,ue,ue]],40),Cr.ofCut(new v(2,3),new v(2,5),new v(2,5)),(t,n,i)=>t.keep.isAbsent()?b.failure($localize`This move has not cut the board in two equal halves.`):i.getPieceAt(t.landing)===q.NONE?b.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):b.SUCCESS,$localize`Congratulations, you won!`)])}}class q_t extends Fa{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:c1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let s;if(s=n.status===c1.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),s.status===c1.VICTORY)return s;n.status=s.status,n.sum=n.sum+s.sum,n.preVictory.isAbsent()&&(n.preVictory=s.preVictory)}return n}}class _4e extends q_t{constructor(...e){super(...e),u(this,"VERBOSE",!1),u(this,"currentVictorySource",void 0)}getBoardValue(e){const t=e.previousMove,n=e.gameState,i=n.getCurrentOpponent(),s=i.getVictoryValue();let o={status:c1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};if(t.isPresent()&&(o=this.calculateBoardValue(t.get(),n)),o.status===c1.VICTORY)return new Jn(s);if(n.turn>39){const a=n.countPieces();return new Jn(a[0]-a[1])}return new Jn(o.status===c1.PRE_VICTORY?i.getPreVictory():o.sum*i.getScoreModifier())}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(Ne.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};const l=(e+o.length)%6;o.push(a),a=a.getNext(Ne.factory.all[l],1)}return{status:c1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=Ne.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};c=!0,s=s.getOpposite(),o=o.getNext(s,a.length-1)}o=o.getNext(s,1)}return{status:c1.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=Ne.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.length%2==0&&(s=Ne.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return{status:c1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=Ne.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.push(a),o.length%2==0&&(s=Ne.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return{status:c1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}getBoardInfo(e,t,n,i){const s=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,s,n,i);case"LINE":return this.getBoardInfoForLine(e.index,s,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,s,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,s,n,i)}}getBoardInfoForCircle(e,t,n,i){const s=n.getCurrentPlayer(),a=[t];let c=t.getNext(Ne.factory.all[e],1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;const m=(e+a.length)%6;a.push(c);const E=Ne.factory.all[m];d===q.NONE?(l+=.16,f=g.of(c)):l++,c=c.getNext(E,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoResult(e,t,n,i){let s=i.preVictory;if(4.16===e){if(s.isPresent()&&!1===s.equals(t))return{status:c1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s=t}else if(5===e)return{status:c1.VICTORY,victory:g.of(n),preVictory:g.empty(),sum:0};return{status:i.status,victory:g.empty(),preVictory:s,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const s=Ne.factory.all[e];let o=t.getPrevious(s,5),a=[],c=[],l=g.empty();for(let R=0;R<6;R++){const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),a.push(o),o=o.getNext(s,1)}let f=i.status,d=i.preVictory,m=0,E=0;for(;m<6;){const R=c.reduce(($,G)=>$+G);5.16===R&&f===c1.DEFAULT&&(d.isPresent()?(B.assert(!1===d.equals(l),"Impossible to have point aligned with different line to a same point"),f=c1.PRE_VICTORY):d=l),E=Math.max(E,R),a=a.slice(1,6),a.push(o),c=c.slice(1,6);const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),m++,o=o.getNext(s,1)}const w={status:f,victory:g.of(a),preVictory:d,sum:E};return this.getBoardInfoResult(E,l,a,w)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),g.empty();case q.NONE:return n.push(.16),g.of(t);default:return n.push(1),g.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const s=n.getCurrentPlayer();let o=Ne.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===q.NONE?(l+=.16,f=g.of(c)):l++,a.length%2==0&&(o=Ne.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const s=n.getCurrentPlayer();let o=Ne.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===q.NONE?(l+=.16,f=g.of(c)):l++,a.push(c),a.length%2==0&&(o=Ne.factory.all[(e+a.length)%6]),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}}let ay=class extends Fn{getListMoves(e){const t=sc.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrops(t):this.getMovements(e.gameState,t)}getMovements(e,t){const n=e.getPieces().reverse(),i=e.getCurrentPlayer(),s=n.get(i).get();return this.getMovementsFrom(e,s,t)}getMovementsFrom(e,t,n){const i=[];for(const s of t)for(const o of n){const a=Cr.ofMovement(s,o);if(e.isCoordConnected(o,g.of(s))){const l=e.movePiece(a).getGroups();if(sc.isSplit(l)){const f=sc.getLargestGroups(l);if(1===f.size())i.push(Cr.ofMovement(s,o));else for(const d of f){const m=d.getAnyElement().get(),E=Cr.ofCut(s,o,m);i.push(E)}}else i.push(a)}}return i}getListDrops(e){const t=[];for(const n of e){const i=Cr.ofDrop(n);t.push(i)}return t}};ay=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],ay);class Z_t extends ay{constructor(...e){super(...e),u(this,"heuristic",new _4e)}getMovements(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementsFrom(e,n,t)}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),s=i.getAnyElement().get(),o=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&o.push(a);return new W1(0===o.length?[s]:o)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=Cr.ofDrop(t);for(this.heuristic.startSearchingVictorySources();this.heuristic.hasNextVictorySource();)if(this.heuristic.currentVictorySource=this.heuristic.getNextVictorySource(),this.heuristic.searchVictoryOnly(this.heuristic.currentVictorySource,i,n).status===c1.VICTORY)return!0;return!1}}function Y_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",10),W("click",function(){const s=ne(t).$implicit;return re(p().onPieceClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","piece_",t.x,"_",t.y,""),y("ngClass",n.getPieceClass(t)),I("points",n.getHexaPointsAt(t))}}function K_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",11),W("click",function(){const s=ne(t).$implicit;return re(p().onNeighborClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","neighbor_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function X_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",10),W("click",function(){ne(t);const i=p();return re(i.onPieceClick(i.chosenLanding.get()))}),P()}if(2&r){const t=p();ve("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),y("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),I("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function Q_t(r,e){if(1&r&&(A(),V(0,"polygon",12)),2&r){const t=e.$implicit,n=p();ve("id","disconnected_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function J_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",13),W("click",function(){ne(t);const i=p();return re(i.onNeighborClick(i.leftCoord.get()))}),P()}if(2&r){const t=p();ve("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),I("points",t.getHexaPointsAt(t.leftCoord.get()))}}function evt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",14),W("click",function(){ne(t);const i=p();return re(i.onPieceClick(i.lastDrop.get()))}),P()}if(2&r){const t=p();ve("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),I("points",t.getHexaPointsAt(t.lastDrop.get()))}}function tvt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",15),W("click",function(){ne(t);const i=p();return re(i.onPieceClick(i.selectedPiece.get()))}),P()}if(2&r){const t=p();ve("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),y("ngClass",t.getSelectedPieceClass()),I("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function nvt(r,e){if(1&r&&(A(),V(0,"polygon",16)),2&r){const t=e.$implicit,n=p();ve("id","victoryCoord_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function rvt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",19),W("click",function(){const s=ne(t).$implicit;return re(p(2).onPieceClick(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);ve("id","cuttable_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function ivt(r,e){if(1&r&&(A(),S(0,"g",17),O(1,rvt,1,3,"polygon",18),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let svt=(()=>{var r;class e extends mu{constructor(n){super(n),u(this,"state",void 0),u(this,"pieces",void 0),u(this,"disconnecteds",[]),u(this,"cuttableGroups",[]),u(this,"victoryCoords",void 0),u(this,"neighbors",void 0),u(this,"leftCoord",g.empty()),u(this,"lastDrop",g.empty()),u(this,"selectedPiece",g.empty()),u(this,"chosenLanding",g.empty()),u(this,"nextClickShouldSelectGroup",!1),this.rules=sc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Minimax`,this.rules,new _4e,new Z_t),new On($localize`MCTS`,new ay,this.rules)],this.encoder=Cr.encoder,this.tutorial=(new m4e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new _u(1.5*this.SPACE_SIZE,new v(2*this.SPACE_SIZE,0),qr.INSTANCE)}cancelMoveAttempt(){var n=this;return M(function*(){n.selectedPiece=g.empty(),n.chosenLanding=g.empty(),n.cuttableGroups=[],n.nextClickShouldSelectGroup=!1,yield n.updateBoard(!1)})()}updateBoard(n){var i=this;return M(function*(){i.state=i.node.gameState,i.node.previousMove.isAbsent()&&i.hideLastMove(),i.pieces=i.state.getPieceCoords(),i.neighbors=i.getEmptyNeighbors()})()}hideLastMove(){this.leftCoord=g.empty(),this.lastDrop=g.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const n=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return $a.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH)}showLastMove(n){var i=this;return M(function*(){i.lastDrop=g.of(n.landing),i.leftCoord=!1===n.isDrop()?g.of(n.start.get()):g.empty();const s=i.getState();i.rules.getGameStatus(i.node).isEndGame&&(i.victoryCoords=i.rules.getShapeVictory(n,s)),i.disconnecteds=i.getDisconnected()})()}getDisconnected(){const n=this.getPreviousState().getPieceCoords(),i=this.getState().getPieceCoords(),s=[];for(const a of n)!1===this.node.previousMove.get().start.equalsValue(a)&&!1===i.some(l=>l.equals(a))&&s.push(a);const o=this.lastDrop.get();return!1===this.pieces.some(a=>a.equals(o))&&!1===i.some(a=>a.equals(o))&&s.push(o),s}getEmptyNeighbors(){let n=sc.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const i=this.chosenLanding.get();n=n.filter(s=>!1===s.equals(i))}return n}getPieceClass(n){const i=this.getState().getPieceAt(n);return this.getPlayerClass(i)}onPieceClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#piece_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.state.turn<40)return i.cancelMove(ic.NO_MOVEMENT_BEFORE_TURN_40());if(i.chosenLanding.isAbsent())return i.state.getPieceAt(n)===i.state.getCurrentOpponent()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.selectedPiece=i.selectedPiece.equalsValue(n)?g.empty():g.of(n),b.SUCCESS);{const o=Cr.ofCut(i.selectedPiece.get(),i.chosenLanding.get(),n);return i.chooseMove(o)}})()}onNeighborClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#neighbor_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.nextClickShouldSelectGroup)return i.cancelMove(ic.MUST_CUT());if(i.state.turn<40)return i.chooseMove(Cr.ofDrop(n));if(i.selectedPiece.isAbsent())return i.cancelMove(ic.CAN_NO_LONGER_DROP());{const o=Cr.ofMovement(i.selectedPiece.get(),n),a=sc.isLegalPhaseTwoMove(o,i.state);return i.neededCutting(a)?(i.chosenLanding=g.of(n),i.moveVirtuallyPiece(),i.showCuttable(),i.nextClickShouldSelectGroup=!0,b.SUCCESS):i.chooseMove(o)}})()}neededCutting(n){return n.isFailure()&&n.getReason()===ic.MUST_CUT()}moveVirtuallyPiece(){const n=this.selectedPiece.get();this.pieces=this.pieces.filter(i=>!1===i.equals(n)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const n=Cr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(n).getGroups(),o=sc.getLargestGroups(s);this.cuttableGroups=[];for(const a of o)this.cuttableGroups.push(a.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-six"]],features:[Ke],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Y_t,1,4,"polygon",1),O(2,K_t,1,3,"polygon",2),O(3,X_t,1,4,"polygon",3),O(4,Q_t,1,3,"polygon",4),O(5,J_t,1,3,"polygon",5),O(6,evt,1,3,"polygon",6),O(7,tvt,1,4,"polygon",7),O(8,nvt,1,3,"polygon",8),O(9,ivt,2,1,"g",9),P()),2&n&&(I("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.pieces),_(1),y("ngForOf",i.neighbors),_(1),y("ngIf",i.chosenLanding.isPresent()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.leftCoord.isPresent()),_(1),y("ngIf",i.lastDrop.isPresent()),_(1),y("ngIf",i.selectedPiece.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngForOf",i.cuttableGroups))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Ro extends yu{static from(e,t){const n=yu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():Q.success(new Ro(e,t))}getMaximalDistance(){return 9}}u(Ro,"encoder",qi.getFallibleEncoder(Ro.from));const ovt={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:k.ZERO};class d3 extends $L{static get(){return d3.singleton.isAbsent()&&(d3.singleton=g.of(new d3)),d3.singleton.get()}constructor(){super(ovt,Ro.from)}getInitialState(){const e=on.UNOCCUPIED,t=on.INVADERS,n=on.DEFENDERS;return new W2([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,on.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}u(d3,"singleton",g.empty());const H=on.UNOCCUPIED,wn=on.INVADERS,ns=on.DEFENDERS,cy=on.PLAYER_ONE_KING;class C4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,d3.get().getInitialState()),j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,d3.get().getInitialState(),Ro.from(new v(4,1),new v(1,1)).get(),$localize`Congratulations!`),j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new W2([[H,H,H,wn,wn,wn,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,H,ns,H,H,H,H],[H,H,H,wn,ns,H,H,H,wn],[wn,wn,ns,ns,cy,ns,ns,wn,wn],[H,H,H,H,ns,H,H,H,wn],[H,H,H,H,ns,H,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,wn,wn,wn,H,H,H]],1),[Ro.from(new v(2,4),new v(2,3)).get(),Ro.from(new v(4,2),new v(3,2)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new W2([[H,H,H,wn,wn,wn,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,H,ns,H,H,H,H],[H,H,ns,H,cy,H,ns,H,wn],[wn,wn,H,ns,H,ns,ns,wn,wn],[H,H,H,H,ns,H,H,H,wn],[H,H,H,H,ns,H,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,wn,wn,wn,H,H,H]],12),[Ro.from(new v(1,4),new v(2,4)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),j.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new W2([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,wn,H,H,H,H,H,H,H],[wn,cy,H,wn,H,H,H,H,H],[H,wn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Ro.from(new v(3,4),new v(2,4)).get()],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),j.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new W2([[H,H,wn,cy,wn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,wn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Ro.from(new v(3,3),new v(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function avt(r,e){1&r&&(A(),V(0,"polygon",8))}function cvt(r,e){1&r&&(A(),V(0,"rect",9))}function lvt(r,e){if(1&r&&(A(),S(0,"g"),O(1,avt,1,0,"polygon",6),O(2,cvt,1,0,"ng-template",null,7,dn),P()),2&r){const t=un(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function uvt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function fvt(r,e){if(1&r&&(A(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function dvt(r,e){if(1&r&&(A(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function hvt(r,e){if(1&r&&(A(),O(0,fvt,1,1,"polyline",14),O(1,dvt,4,20,"ng-template",null,15,dn)),2&r){const t=un(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function pvt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"circle",10),O(2,uvt,6,25,"g",11),O(3,hvt,3,2,"ng-template",null,12,dn),P()),2&r){const t=un(4),n=p().index,i=p().index,s=p();_(1),ve("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function gvt(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(1,"rect",4),O(2,lvt,4,2,"g",5),O(3,pvt,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ve("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ve("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function mvt(r,e){if(1&r&&(A(),S(0,"g"),O(1,gvt,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function _vt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ve("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let vvt=(()=>{var r;class e extends BL{constructor(n){super(n,Ro.from),this.rules=d3.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=Ro.encoder,this.tutorial=(new C4e).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-tablut"]],features:[Ke],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,mvt,2,1,"g",1),O(2,_vt,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox().toSVGString()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),so=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}isInDropPhase(){return this.turn<8}}return u(r,"WIDTH",5),r})();var SR;class zo extends Ar{static from(e){return so.isOnBoard(e)?Q.success(new zo(e.x,e.y)):Q.failure(m4.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof zo&&super.equals(e)}}u(zo,"encoder",Ar.getFallibleEncoder(zo.from));class Do extends Qs{static from(e,t){return!1===so.isOnBoard(e)?Q.failure(m4.OUT_OF_RANGE(e)):!1===so.isOnBoard(t)?Q.failure(m4.OUT_OF_RANGE(t)):e.equals(t)?Q.failure(Ee.MOVE_CANNOT_BE_STATIC()):Q.success(new Do(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof Do&&super.equals(e)}}u(Do,"encoder",Qs.getFallibleEncoder(Do.from)),function(r){r.encoder=we.disjunction([e=>e instanceof zo,e=>e instanceof Do],[zo.encoder,Do.encoder])}(SR||(SR={}));class Ti extends jn{static get(){return Ti.singleton.isAbsent()&&(Ti.singleton=g.of(new Ti)),Ti.singleton.get()}getInitialState(){const e=xt.create(so.WIDTH,so.WIDTH,q.NONE);return new so(e,0)}isLegal(e,t){return t.isInDropPhase()?(B.assert(e instanceof zo,"Cannot translate in dropping phase !"),this.isLegalDrop(e,t)):(B.assert(e instanceof Do,"Cannot drop in translation phase !"),this.isLegalTranslation(e,t))}isLegalDrop(e,t){return t.getPieceAt(e.coord).isPlayer()?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}isLegalTranslation(e,t){const n=t.getPieceAt(e.getStart());return n===t.getCurrentOpponent()?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):n===q.NONE?b.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(e.getEnd()).isPlayer()?b.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):!1===Ti.CAN_TELEPORT&&!1===e.getStart().isNeighborWith(e.getEnd())?b.failure(Ee.MUST_MOVE_ON_NEIGHBOR()):b.SUCCESS}applyLegalMove(e,t){return e instanceof zo?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new so(n,t.turn+1)}applyLegalTranslate(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=q.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new so(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):_e.ONGOING}getLastCoord(e){return e instanceof zo?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=[0,0];for(let i=0;i<so.WIDTH-1;i++)for(let s=0;s<so.WIDTH-1;s++){const o=new v(i,s),a=new v(i+1,s),c=new v(i,s+1),l=new v(i+1,s+1),f=[e.getPieceAt(o),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],d=qt.count(f,q.NONE),m=qt.count(f,q.ZERO),E=qt.count(f,q.ONE);d<4&&(4===m||4===E?t.push(o,a,c,l):m>0?n[0]=n[0]+1:n[1]=n[1]+1)}return{score:n[1]-n[0],victoriousCoords:t}}getVictoryCoord(e){const t=Ti.TEEKO_HELPER.getVictoriousCoord(e),n=this.getSquareInfo(e).victoriousCoords;return t.concat(n)}}u(Ti,"singleton",g.empty()),u(Ti,"CAN_TELEPORT",!1),u(Ti,"TEEKO_HELPER",new Mu(so.isOnBoard,B.identity,4));const $n=q.NONE,ql=q.ZERO,jl=q.ONE;class E4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,Ti.get().getInitialState()),j.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Ti.get().getInitialState(),zo.from(new v(2,2)).get(),$localize`Congratulations!`),j.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to an empty neighboring space, orthogonally or diagonally. The goal remains to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new so([[ql,jl,$n,$n,$n],[ql,ql,$n,$n,$n],[jl,jl,$n,$n,$n],[jl,ql,$n,$n,$n],[$n,$n,$n,$n,$n]],8),Do.from(new v(1,3),new v(2,2)).get(),$localize`Congratulations!`),j.fromMove($localize`Victory`,$localize`In this board, you can win by creating a square.<br/><br/>You are playing Dark, win.`,new so([[jl,$n,$n,$n,$n],[jl,ql,$n,ql,$n],[$n,ql,ql,jl,$n],[$n,jl,$n,$n,$n],[$n,$n,$n,$n,$n]],8),[Do.from(new v(3,1),new v(2,1)).get()],$localize`Congratulations, you won! Remember that you can also win by creating a line.`,$localize`Failed. Try again.`)])}}class Cvt extends Fa{getBoardValue(e){const t=Ti.TEEKO_HELPER.getBoardValue(e.gameState).value,n=Ti.get().getSquareInfo(e.gameState);return new Jn(n.score+t)}}class S4e extends Fn{getListMoves(e){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState)}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===n.content.isPlayer()){const s=zo.from(i).get();t.push(s)}}return t}getListTranslations(e){const t=[],n=e.getCurrentPlayer(),i=this.getCoordsContaining(e,n);for(const s of i)for(const o of this.getPossibleTargets(e,s)){const a=Do.from(s,o).get();t.push(a)}return t}getPossibleTargets(e,t){if(Ti.CAN_TELEPORT)return this.getCoordsContaining(e,q.NONE);{const n=[];for(const i of ye.factory.all){const s=t.getNext(i);so.isOnBoard(s)&&e.getPieceAt(s)===q.NONE&&n.push(s)}return n}}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}}function yvt(r,e){if(1&r&&(A(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ve("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function Mvt(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),V(1,"rect",4),O(2,yvt,1,6,"circle",5),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ve("id","click_",n,"_",i,""),_(1),ve("id","space_",n,"_",i,""),y("ngClass",s.getSpaceClasses(n,i)),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isPlayer())}}function Evt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Mvt,3,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Svt=(()=>{var r;class e extends Ci{constructor(n){super(n),u(this,"selected",g.empty()),u(this,"last",g.empty()),u(this,"moved",[]),u(this,"victory",[]),this.rules=Ti.get(),this.node=this.rules.getInitialNode(),this.encoder=SR.encoder,this.tutorial=(new E4e).tutorial,this.availableAIs=[new cn($localize`Minimax`,this.rules,new Cvt,new S4e),new On($localize`MCTS`,new S4e,this.rules)]}updateBoard(n){var i=this;return M(function*(){i.board=i.node.gameState.board})()}showLastMove(n){var i=this;return M(function*(){i.last=g.of(i.rules.getLastCoord(n)),i.moved=n instanceof Do?[n.getStart(),n.getEnd()]:[],i.victory=i.rules.getVictoryCoord(i.getState())})()}hideLastMove(){var n=this;return M(function*(){n.last=g.empty(),n.moved=[],n.victory=[]})()}cancelMoveAttempt(){this.selected=g.empty()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new v(n,i);if(s.getState().isInDropPhase()){const c=zo.from(a).get();return s.chooseMove(c)}if(s.selected.isPresent()){if(s.selected.equalsValue(a))return s.selected=g.empty(),b.SUCCESS;{const c=Do.from(s.selected.get(),a).get();return s.chooseMove(c)}}{const c=s.getState().getCurrentPlayer(),l=s.getState().getPieceAt(a);return l===c?(s.selected=g.of(a),b.SUCCESS):s.cancelMove(l===q.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}})()}getPieceClasses(n,i){const s=new v(n,i),a=[this.getPlayerClass(this.getState().getPieceAt(s))];return this.victory.some(c=>c.equals(s))?a.push("victory-stroke"):this.last.equalsValue(s)?a.push("last-move-stroke"):this.selected.equalsValue(s)&&a.push("selected-stroke"),a}getSpaceClasses(n,i){const s=new v(n,i);return this.moved.some(o=>o.equals(s))?["moved-fill"]:[]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-teeko"]],features:[Ke],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),O(1,Evt,2,1,"g",1),P()),2&n&&(_(1),y("ngForOf",i.board))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class bi{constructor(e,t){u(this,"owner",void 0),u(this,"tileId",void 0),this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Qr{static of(e){let t=-1;for(const n of e)B.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new Qr(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?q.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return Qr.of(this.pieces.concat(e))}getPieceAt(e){return B.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}u(Qr,"EMPTY",Qr.of([]));let w2=(()=>{class r extends L1{static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){B.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)B.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),s=new bi(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(s),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return u(r,"SIZE",10),r})(),ly=(()=>{class r{}return u(r,"NON_NEIGHBORING_SPACES",()=>$localize`Those two spaces are not neighbors!`),u(r,"NO_WAY_TO_DROP_IT_HERE",()=>$localize`There is no way to put a piece there!`),u(r,"CANNOT_DROP_ON_ONLY_ONE_PIECE",()=>$localize`You cannot drop on only one piece!`),u(r,"CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS",()=>$localize`You cannot drop a piece on uneven grounds!`),r})();var T4e;class oo extends qi{static from(e,t){return B.assert(w2.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),B.assert(w2.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?Q.success(new oo(e,t)):Q.failure(ly.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}u(oo,"encoder",qi.getFallibleEncoder(oo.from));class N2 extends jn{static get(){return N2.instance.isAbsent()&&(N2.instance=g.of(new N2)),N2.instance.get()}static getOwner(e){return e.getOwner()}getInitialState(){const e=xt.create(w2.SIZE,w2.SIZE,Qr.EMPTY);return new w2(e,0)}applyLegalMove(e,t,n){return t.drop(e.getZero(),k.ZERO).drop(e.getOne(),k.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?b.failure(ly.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?b.failure(ly.CANNOT_DROP_ON_ONLY_ONE_PIECE()):b.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}static getSquareScore(e,t){return N2.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const s of e.toMap()){const o=s.key,a=e.getPieceAt(o).getOwner();if(a.isPlayer()){const c=N2.getSquareScore(e,o);Jn.isVictory(c)&&(a===i?t.push(o):n.push(o))}}return n.length>0?n:t}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const s of t.toMap()){const o=s.key,a=t.getPieceAt(o).getOwner();if(a.isPlayer()){const c=N2.getSquareScore(t,o);if(Jn.isVictory(c)){if(a!==n)return _e.getDefeat(n);i=!0}}}return i?_e.getVictory(n):_e.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<w2.SIZE){const s=new v(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,s))}if(i.y+1<w2.SIZE){const s=new v(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,s))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),s=e.getPieceAt(n);let o;o=!i.isGround()&&i.getUpperTileId()===s.getUpperTileId();const a=i.getHeight()!==s.getHeight();return o||a?[]:[oo.from(t,n).get(),oo.from(n,t).get()]}}T4e=N2,u(N2,"instance",g.empty()),u(N2,"TREXO_HELPER",new Mu(w2.isOnBoard,T4e.getOwner,5));const J=Qr.EMPTY,b4e=Qr.of([new bi(k.ONE,0)]),Pvt=Qr.of([new bi(k.ZERO,0)]),Ovt=Qr.of([new bi(k.ONE,1)]),w4e=Qr.of([new bi(k.ZERO,1)]),Tvt=Qr.of([new bi(k.ZERO,2)]),bvt=Qr.of([new bi(k.ONE,2)]),wvt=Qr.of([new bi(k.ZERO,0),new bi(k.ZERO,3)]),Nvt=Qr.of([new bi(k.ONE,1),new bi(k.ONE,3)]),Avt=Qr.of([new bi(k.ZERO,4)]),Ivt=Qr.of([new bi(k.ONE,4)]),kvt=Qr.of([new bi(k.ZERO,5)]),xvt=Qr.of([new bi(k.ONE,5)]),Lvt=Qr.of([new bi(k.ONE,6)]),Rvt=Qr.of([new bi(k.ZERO,6)]);class N4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,N2.get().getInitialState()),j.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,N2.get().getInitialState(),oo.from(new v(4,4),new v(3,4)).get(),$localize`Congratulations!`),j.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new w2([[J,J,J,b4e,Pvt,w4e,Ovt,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J]],7),[oo.from(new v(4,0),new v(5,0)).get(),oo.from(new v(5,0),new v(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),j.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new w2([[J,J,J,J,J,J,J,J,J,J],[J,J,J,kvt,J,J,J,J,J,J],[J,J,J,xvt,J,J,J,J,J,J],[J,J,J,J,b4e,J,J,Avt,Ivt,J],[J,J,J,J,wvt,Nvt,w4e,J,J,J],[J,J,J,J,J,Tvt,Lvt,Rvt,J,J],[J,J,J,J,J,bvt,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J,J,J]],7),oo.from(new v(2,0),new v(2,1)).get(),(t,n,i)=>N2.TREXO_HELPER.getSquareScore(i,t.getOne())===Number.MAX_SAFE_INTEGER?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)])}}class zvt extends Fa{getBoardValue(e){let t=0;const n=e.gameState;for(const i of n.toMap())n.getPieceAt(i.key).getOwner().isPlayer()&&(t+=N2.getSquareScore(n,i.key));return new Jn(t)}}class A4e extends Fn{constructor(...e){super(...e),u(this,"rules",N2.get())}getListMoves(e){return this.rules.getLegalMoves(e.gameState)}}var PR;function Dvt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",5),W("click",function(){const s=ne(t).index,o=p().index;return re(p().onClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ve("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClasses(t,n)),I("points",i.getParallelogramPoints())("transform",i.getTranslate(t,n,0))}}function Hvt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Dvt,2,5,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Vvt(r,e){if(1&r){const t=pe();A(),S(0,"g",8),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p(2).onClick(i,s))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p().index,a=p();zi("id","half_tile_",n,"_",s,"_",o,""),y("mode",a.mode)("coord",a.Coord3D.of(n,s,o))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,s,o)),I("transform",a.getTranslate(n,s,o+1))}}const I4e=function(r){return[r]};function Fvt(r,e){if(1&r){const t=pe();A(),S(0,"g",9),W("click",function(){ne(t);const i=p().index,s=p().index;return re(p(2).onClick(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p().index,s=p();zi("id","dropped_piece_",t,"_",n,"_",i,""),y("mode",s.mode)("coord",s.Coord3D.of(t,n,i))("pieceClasses",wa(7,I4e,s.currentOpponentClass)),I("transform",s.getTranslate(t,n,i+1))}}function $vt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Vvt,1,9,"g",6),O(2,Fvt,1,9,"g",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.move.isPresent()),_(1),y("ngIf",t.isDroppedPiece)}}function Bvt(r,e){if(1&r&&(A(),S(0,"g"),O(1,$vt,3,2,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Gvt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Bvt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}const Uvt=function(){return["player0-fill"]};function Wvt(r,e){if(1&r){const t=pe();A(),S(0,"g",10),W("click",function(){return ne(t),re(p().switchToMode("3D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",D1(4,Uvt)),I("transform",t.get3DSwitcherTransform())}}function qvt(r,e){if(1&r){const t=pe();A(),S(0,"g",11),W("click",function(){return ne(t),re(p().switchToMode("2D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",wa(4,I4e,t.currentPlayerClass)),I("transform",t.getTranslate(12,9,0))}}class Bn extends _3e{constructor(e){super(e),u(this,"TrexoComponent",Bn),u(this,"left",-this.STROKE_WIDTH/2),u(this,"Coord3D",ch),u(this,"up",0),u(this,"width",void 0),u(this,"height",void 0),u(this,"mode",void 0),u(this,"chosenMode","3D"),u(this,"victoryCoords",[]),u(this,"droppedPiece",g.empty()),u(this,"possibleNextClicks",[]),u(this,"possibleMoves",[]),u(this,"pieceOnBoard",[]),u(this,"currentOpponentClass","player1"),u(this,"currentPlayerClass","player0"),this.rules=N2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Alignment`,this.rules,new zvt,new A4e),new On($localize`MCTS`,new A4e,this.rules)],this.encoder=oo.encoder,this.tutorial=(new N4e).tutorial,Bn.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=Bn.modeMap[e]}getViewBoxWidth(){const e=Bn.modeMap["3D"],t=w2.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=w2.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*Bn.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.getCopiedBoard(),t.currentOpponentClass=t.getPlayerClass(n.getCurrentOpponent()),t.currentPlayerClass=t.getPlayerClass(n.getCurrentPlayer()),t.possibleMoves=t.rules.getLegalMoves(n),t.victoryCoords=N2.getVictoriousCoords(n),t.pieceOnBoard=t.get3DBoard(),t.height=t.getViewBoxHeight(),t.up=t.getViewBoxUp()})()}get3DBoard(){const e=sft.create(1,w2.SIZE,w2.SIZE,Bn.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const s=i.key,o=i.value.getHeight();if(t=Math.max(t,o),n<o){const a=this.extractMoveFromState(s.x,s.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),s=new v(e,t);let o=new v(-2,-2);for(const a of ye.ORTHOGONALS){const c=s.getNext(a);if(w2.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(o=c)}}return i.owner===k.ZERO?oo.from(s,o).get():oo.from(o,s).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(xt.create(w2.SIZE,w2.SIZE,Bn.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new v(e,t);if(n.droppedPiece.isPresent()){const o=n.droppedPiece.get();if(n.droppedPiece.equalsValue(s))return yield n.cancelMoveAttempt(),b.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(s))){const a=n.getState().getCurrentPlayer()===k.ZERO,f=oo.from(a?s:o,a?o:s).get();return n.chooseMove(f)}n.deselectPiece()}return n.selectPiece(s)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=Bn.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){var t=this;return M(function*(){if(t.possibleMoves.some(n=>n.getZero().equals(e))){const n=t.getState().getPieceAt(e).getHeight();return n>=t.pieceOnBoard.length&&t.pieceOnBoard.push(xt.create(w2.SIZE,w2.SIZE,Bn.INITIAL_PIECE_ON_BOARD)),t.showDroppedPieceAndIndicators(e,n),b.SUCCESS}return t.cancelMove(ly.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(e,t){this.droppedPiece=g.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:g.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:g.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){var e=this;return M(function*(){e.droppedPiece=g.empty(),e.possibleNextClicks=[],yield e.updateBoard(!1)})()}getPieceClasses(e,t,n){const i=new v(e,t),s=this.getState().getPieceAtXYZ(e,t,n).owner;let o=[this.getPlayerClass(s)];o=o.concat(this.getSpaceClasses(e,t));for(const a of this.victoryCoords)if(a.equals(i)){o.push("victory-stroke");break}if(this.node.previousMove.isPresent()){const a=this.node.previousMove.get();(a.getZero().equals(i)||a.getOne().equals(i))&&o.push("last-move-stroke")}return o}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,n){const s=this.getCoordTranslate(e,t,n,Bn.modeMap[this.chosenMode]);return"translate("+s.x+" "+s.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(Bn.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=Bn.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}PR=Bn,u(Bn,"STROKE_WIDTH",void 0),u(Bn,"INITIAL_PIECE_ON_BOARD",{isDroppedPiece:!1,isPossibleClick:!1,move:g.empty()}),u(Bn,"modeMap",{"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}}),u(Bn,"\u0275fac",function(e){return new(e||PR)(U($t))}),u(Bn,"\u0275cmp",Be({type:PR,selectors:[["app-trexo"]],features:[Ke],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(A(),S(0,"svg",0),O(1,Hvt,2,1,"g",1),O(2,Gvt,2,1,"g",1),S(3,"g",null,2),O(5,Wvt,1,5,"g",3),O(6,qvt,1,6,"ng-template",null,4,dn),P()()),2&e){const n=un(7);I("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),_(1),y("ngForOf",t.board),_(1),y("ngForOf",t.pieceOnBoard),_(3),y("ngIf","2D"===t.chosenMode)("ngIfElse",n)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class X1{}var _a;u(X1,"PLACEMENT_AFTER_INITIAL_PHASE",()=>$localize`You cannot put a new ring after the tenth turn.`),u(X1,"NO_MARKERS_IN_INITIAL_PHASE",()=>$localize`You cannot put a marker in a ring before placing all of your rings.`),u(X1,"MISSING_CAPTURES",la.MISSING_CAPTURES),u(X1,"MOVE_DIRECTION_INVALID",()=>$localize`The direction of your move is invalid: a move is made along a straight line.`),u(X1,"CAN_ONLY_CAPTURE_YOUR_MARKERS",()=>$localize`You can only capture your own markers.`),u(X1,"SHOULD_SELECT_PLAYER_RING",()=>$localize`You must pick one of your own rings to move.`),u(X1,"SHOULD_END_MOVE_ON_EMPTY_SPACE",()=>$localize`Your ring must land on an empty space.`),u(X1,"MOVE_SHOULD_NOT_PASS_ABOVE_RING",()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`),u(X1,"MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS",()=>$localize`Your ring must land on the first empty space after a group of markers.`),u(X1,"AMBIGUOUS_CAPTURE_COORD",la.AMBIGUOUS_CAPTURE_COORD),u(X1,"CAPTURE_SHOULD_TAKE_RING",()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`);class Lt{static of(e,t){return e===q.NONE?Lt.EMPTY:t?Lt.RINGS[e.value]:Lt.MARKERS[e.value]}constructor(e,t){u(this,"player",void 0),u(this,"isRing",void 0),this.player=e,this.isRing=t}equals(e){return this===e}flip(){return je(!1===this.isRing,"cannot flip a ring (it should never happen)"),je(this.player.isPlayer(),"cannot flip a non-player piece"),Lt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case Lt.UNREACHABLE:return"NONE";case Lt.EMPTY:return"EMPTY";case Lt.MARKER_ZERO:return"MARKER_ZERO";case Lt.MARKER_ONE:return"MARKER_ONE";case Lt.RING_ZERO:return"RING_ZERO";default:return B.expectToBe(this,Lt.RING_ONE),"RING_ONE"}}}_a=Lt,u(Lt,"encoder",we.tuple([q.encoder,we.identity()],r=>[r.player,r.isRing],r=>_a.of(r[0],r[1]))),u(Lt,"UNREACHABLE",new _a(q.NONE,!1)),u(Lt,"EMPTY",new _a(q.NONE,!1)),u(Lt,"MARKER_ZERO",new _a(k.ZERO,!1)),u(Lt,"MARKER_ONE",new _a(k.ONE,!1)),u(Lt,"MARKERS",[_a.MARKER_ZERO,_a.MARKER_ONE]),u(Lt,"RING_ZERO",new _a(k.ZERO,!0)),u(Lt,"RING_ONE",new _a(k.ONE,!0)),u(Lt,"RINGS",[_a.RING_ZERO,_a.RING_ONE]);let oc=(()=>{class r extends XL{constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],Lt.EMPTY),u(this,"sideRings",void 0),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&xt.compare(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,s)=>{s.isRing&&s.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Lt.UNREACHABLE}setAtUnsafe(t,n){const i=xt.copy(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return u(r,"SIZE",11),r})();var k4e,x4e;class va extends X2{static of(e,t,n){const i=[],s=Ne.factory.fromMove(e,t).get();for(let o=e;!1===o.equals(t);o=o.getNext(s))i.push(o);return i.push(t),new va(i,n)}constructor(e,t=g.empty()){if(super(e),u(this,"ringTaken",void 0),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new va(this.capturedSpaces,g.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}k4e=va,u(va,"encoder",we.tuple([we.list(v.encoder),g.getEncoder(v.encoder)],r=>[r.capturedSpaces,r.ringTaken],r=>new k4e(r[0],r[1])));class h3 extends vi{constructor(e,t,n,i){super(),u(this,"initialCaptures",void 0),u(this,"start",void 0),u(this,"end",void 0),u(this,"finalCaptures",void 0),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===qt.compare(this.initialCaptures,e.initialCaptures)||!1===qt.compare(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}x4e=h3,u(h3,"encoder",we.tuple([we.list(va.encoder),v.encoder,g.getEncoder(v.encoder),we.list(va.encoder)],r=>[r.initialCaptures,r.start,r.end,r.finalCaptures],r=>new x4e(r[0],r[1],r[2],r[3])));class Ca extends jn{static get(){return Ca.singleton.isAbsent()&&(Ca.singleton=g.of(new Ca)),Ca.singleton.get()}getInitialState(){const e=Lt.EMPTY,t=Lt.UNREACHABLE;return new oc([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}applyLegalMove(e,t,n){return new oc(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new oc(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,i=e.setAt(t,Lt.EMPTY).board,s=[e.sideRings[0],e.sideRings[1]];return s[n]+=1,new oc(i,s,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,Lt.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===Lt.RINGS[n]?b.SUCCESS:b.failure(X1.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer().value;let s=n.setAt(e,Lt.MARKERS[i]);s=s.setAt(t,Lt.RINGS[i]);const o=Ne.factory.fromMove(e,t).get();for(let a=e.getNext(o);!1===a.equals(t);a=a.getNext(o)){const c=s.getPieceAt(a);c!==Lt.EMPTY&&(s=s.setAt(a,c.flip()))}return s}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return Q.failure(X1.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),s=this.moveValidity(i,e.start,e.end.get());if(s.isFailure())return s.toOtherFallible();const o=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,o),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():Q.success(c)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return Q.failure(X1.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==Lt.EMPTY)return Q.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=[e.sideRings[0],e.sideRings[1]];i[n.value]-=1;const s=e.setAt(t,Lt.of(n,!0)).board,o=new oc(s,i,e.turn);return Q.success(o)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==Lt.RINGS[n]?b.failure(X1.SHOULD_SELECT_PLAYER_RING()):b.SUCCESS}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==Lt.EMPTY)return b.failure(X1.SHOULD_END_MOVE_ON_EMPTY_SPACE());const s=Ne.factory.fromMove(t,n);if(s.isFailure())return b.failure(X1.MOVE_DIRECTION_INVALID());const o=s.get();let a=!1;for(let c=t.getNext(o);!1===c.equals(n);c=c.getNext(o)){const l=e.getPieceAt(c);if(l===Lt.EMPTY){if(a)return b.failure(X1.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return b.failure(X1.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return b.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=this.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==Lt.MARKERS[n])return b.failure(X1.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==Lt.RINGS[n]?b.failure(X1.CAPTURE_SHOULD_TAKE_RING()):b.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(X1.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let c,a=s;for(c=s;e.isOnBoard(c);c=c.getNext(o)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(i>=5)break;i=0}}return i>=5?g.of({start:a,end:c,dir:o}):g.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let s=i.start;s.getDistance(i.end)>=5;s=s.getNext(i.dir))n.push(va.of(s,s.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of Ne.factory.all){let s=!1;for(let o=t.getNext(i);e.isOnBoard(o);o=o.getNext(i)){const a=e.getPieceAt(o);if(a===Lt.EMPTY){if(n.push(o),s)break}else{if(a.isRing)break;s=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?_e.ONGOING:e.gameState.sideRings[0]>=3?_e.ZERO_WON:e.gameState.sideRings[1]>=3?_e.ONE_WON:_e.ONGOING}}u(Ca,"singleton",g.empty());const D=Lt.EMPTY,he=Lt.UNREACHABLE,ei=Lt.MARKER_ZERO,rs=Lt.RING_ZERO,p3=Lt.MARKER_ONE,A2=Lt.RING_ONE;let L4e=(()=>{class r{}return u(r,"MUST_ALIGN_FIVE",()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`),u(r,"MUST_CAPTURE_TWO",()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`),r})();class R4e extends qn{constructor(...e){super(...e),u(this,"tutorial",[j.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new oc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,ei,A2,D,D,D,D,D,D],[he,he,D,ei,D,A2,D,p3,D,D,D],[he,D,rs,p3,D,D,A2,ei,D,D,D],[he,D,D,ei,p3,D,D,D,D,D,he],[D,D,D,ei,D,D,D,A2,D,D,he],[D,D,D,p3,ei,rs,D,D,D,he,he],[D,D,D,D,D,D,D,D,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[3,1],20)),j.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new oc(Ca.get().getInitialState().board,[5,5],0),new h3([],new v(5,5),g.empty(),[]),$localize`Congratulations!`),j.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new oc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,A2,D,D,D,D,D,D,D],[he,he,A2,D,D,A2,D,D,D,D,D],[he,D,rs,p3,D,D,A2,D,D,D,D],[he,D,D,p3,D,D,D,D,D,D,he],[D,D,D,D,rs,D,D,A2,D,D,he],[D,D,D,D,D,rs,D,D,D,he,he],[D,D,D,rs,D,D,D,he,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new h3([],new v(2,4),g.of(new v(4,4)),[]),$localize`Congratulations!`),j.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new oc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,A2,D,D,D,D,D,D,D],[he,he,A2,D,D,A2,D,D,D,D,D],[he,D,ei,ei,rs,p3,p3,D,D,D,D],[he,D,D,A2,D,D,D,D,D,D,he],[D,D,D,D,rs,D,D,A2,D,D,he],[D,D,D,D,D,rs,D,D,D,he,he],[D,D,D,rs,D,D,D,rs,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new h3([],new v(4,4),g.of(new v(7,4)),[va.of(new v(2,4),new v(6,4),g.of(new v(7,4)))]),(t,n,i)=>1===i.sideRings[k.ZERO.value]?b.SUCCESS:b.failure(L4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),j.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new oc([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,rs,D,D,A2,A2,rs,D],[he,he,he,rs,D,D,p3,A2,D,rs,D],[he,he,D,rs,D,D,D,D,D,A2,D],[he,D,D,D,D,ei,D,D,A2,D,D],[he,D,D,D,ei,ei,D,p3,D,D,he],[D,D,D,ei,D,ei,D,D,D,D,he],[D,D,ei,D,D,ei,D,D,D,he,he],[D,ei,D,D,D,ei,D,D,he,he,he],[D,D,D,D,D,ei,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],10),new h3([va.of(new v(5,4),new v(1,8),g.of(new v(3,2))),va.of(new v(5,9),new v(5,5),g.of(new v(3,3)))],new v(4,1),g.of(new v(4,2)),[]),(t,n,i)=>2===i.sideRings[k.ZERO.value]?b.SUCCESS:b.failure(L4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)])}}class jvt extends tr{getMetrics(e){return e.gameState.sideRings}}class Zvt{static getCombinations(e,t){return je(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let s=1;for(;s<t;)if(i[s]<s){const o=s%2&&i[s],a=e[s];e[s]=e[o],e[o]=a,++i[s],s=1,n.push(e.slice())}else i[s]=0,++s;return n}static getSubsetsOfSize(e,t){return function n(i,s){if(s>=e.length||i<1)return[[]];{const o=[];for(;s<=e.length-i;){const a=e[s];for(const c of n(i-1,s+1))c.push(a),o.push(c);++s}return o}}(t,0)}}class z4e extends Fn{getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const{coord:i,content:s}of n.getCoordsAndContents())s===Lt.EMPTY&&t.push(new h3([],i,g.empty(),[]));else{const i=Ca.get();this.getPossibleCaptureCombinations(n).forEach(s=>{const o=i.applyCaptures(s,n);this.getRingMoves(o).forEach(a=>{const c=i.applyRingMoveAndFlip(a.start,a.end,o);this.getPossibleCaptureCombinations(c).forEach(l=>{const f=new h3(s,a.start,g.of(a.end),l);t.push(f)})})})}return t}getPossibleCaptureCombinations(e){const n=Ca.get().getPossibleCaptures(e),i=this.getRingCoords(e);return TC.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(s=>Zvt.getCombinations(i,s.length).map(o=>s.map((a,c)=>new va(a.capturedSpaces,g.of(o[c]))))).reduce((s,o)=>s.concat(o),[])}getRingMoves(e){const t=Ca.get(),n=[];for(const i of this.getRingCoords(e))for(const s of t.getRingTargets(e,i))n.push({start:i,end:s});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((i,s)=>{s===Lt.RINGS[t]&&n.push(i)}),n}}var uy;function Yvt(r,e){if(1&r&&(A(),V(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);I("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function Kvt(r,e){if(1&r&&(A(),V(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","ring_",n,"_",s,""),y("ngClass",i.ringClasses),I("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function Xvt(r,e){if(1&r&&(A(),V(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);I("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function Qvt(r,e){if(1&r&&(A(),V(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ve("id","marker_",n,"_",s,""),y("ngClass",i.markerClasses),I("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Jvt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){ne(t);const i=p().$implicit;return re(p(2).onClick(i.coord))}),V(1,"polygon",7),S(2,"g",8),O(3,Yvt,1,3,"circle",9),O(4,Kvt,1,6,"circle",10),O(5,Xvt,1,3,"circle",9),O(6,Qvt,1,6,"circle",11),P()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index;ve("id","click_",n,"_",s,""),_(1),ve("id","space_",n,"_",s,""),y("ngClass",i.spaceClasses),I("points",i.coordinates),_(1),ve("id","pieceGroup_",n,"_",s,""),y("ngClass",i.removedClass),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isMarker)}}function eCt(r,e){if(1&r&&(A(),S(0,"g"),O(1,Jvt,7,13,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",null!=t)}}function tCt(r,e){if(1&r&&(A(),S(0,"g"),O(1,eCt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function nCt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",15),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","selected_",t.x,"_",t.y,""),I("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function rCt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",17),W("click",function(){const s=ne(t).$implicit;return re(p(2).onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);ve("id","selectable_",t.x,"_",t.y,""),I("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function iCt(r,e){if(1&r&&(A(),S(0,"g"),O(1,rCt,1,3,"polygon",16),P()),2&r){const t=p();_(1),y("ngForOf",t.viewInfo.selectableCoords)}}function sCt(r,e){if(1&r){const t=pe();A(),S(0,"rect",18),W("click",function(){const s=ne(t).$implicit;return re(p().onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ve("id","indicator_",t.x,"_",t.y,""),I("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function oCt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"circle",19)(2,"circle",12)(3,"circle",20),P()),2&r){const t=e.index,n=p().$implicit,i=p();_(1),ve("id","player_",n.value,"_sideRing_",t+1,""),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringOuterSize),_(1),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringInnerSize),_(1),y("ngClass",i.viewInfo.sideRingClass[n.value]),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringMidSize)}}const aCt=function(){return[]};function cCt(r,e){if(1&r&&(A(),S(0,"g"),O(1,oCt,4,12,"g",1),P()),2&r){const t=e.$implicit,n=p();I("transform","rotate("+180*(n.getPointOfView().value+1)+" 532.5 780)"),_(1),y("ngForOf",D1(2,aCt).constructor(n.viewInfo.sideRings[t.value]))}}class wi extends mu{constructor(e){super(e),u(this,"constructedState",void 0),u(this,"movePhase","MOVE_START"),u(this,"moveStart",g.empty()),u(this,"moveEnd",g.empty()),u(this,"currentlyMoved",[]),u(this,"currentCapture",g.empty()),u(this,"initialCaptures",[]),u(this,"finalCaptures",[]),u(this,"possibleCaptures",[]),u(this,"viewInfo",{spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:wi.MARKER_SIZE,ringOuterSize:wi.RING_OUTER_SIZE,ringMidSize:wi.RING_MID_SIZE,ringInnerSize:wi.RING_INNER_SIZE,indicatorSize:wi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]}),this.scores=g.of([0,0]),this.rules=Ca.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new cn($localize`Score`,this.rules,new jvt,new z4e),new On($localize`MCTS`,new z4e,this.rules)],this.encoder=h3.encoder,this.tutorial=(new R4e).tutorial,this.hexaLayout=new _u(1.5*wi.RING_OUTER_SIZE,new v(2*wi.RING_OUTER_SIZE,0),qr.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt();const n=t.getState();t.scores=g.of(n.countScores())})()}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of k.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==Lt.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=g.empty(),this.moveStart=g.empty(),this.moveEnd=g.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){var t=this;return M(function*(){if(e.isInitialPlacement())t.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const i of t.coordsBetween(e.start,e.end.get()))t.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["moved-fill"];const n=t.currentCapture.isAbsent()&&0===t.initialCaptures.length&&t.moveStart.isAbsent();e.initialCaptures.forEach(i=>t.showLastMoveCapture(i,n)),e.finalCaptures.forEach(i=>t.showLastMoveCapture(i,n))}})()}coordsBetween(e,t){return e.getAllCoordsToward(t)}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),b.SUCCESS}onClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return M(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(X1.MISSING_CAPTURES());t.selectCapture(n[0])}return b.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(B.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return M(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(X1.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(X1.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=g.of(e),this.constructedState=new oc(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(je("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),b.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,Lt.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,Lt.RINGS[t.value])}selectRing(e){var t=this;return M(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=g.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS)):(B.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),b.SUCCESS}tryMove(){var e=this;return M(function*(){const t=new h3(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return M(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=g.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=g.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return b.SUCCESS})()}selectMoveEnd(e){var t=this;return M(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),b.SUCCESS;const n=Lt.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=g.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return M(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),b.SUCCESS)})()}}function lCt(r,e){if(1&r&&(S(0,"option",5),ct(1),P()),2&r){const t=e.$implicit;y("value",t.urlName),_(1),mn(t.name)}}uy=wi,u(wi,"RING_OUTER_SIZE",40),u(wi,"RING_MID_SIZE",34),u(wi,"RING_INNER_SIZE",28),u(wi,"MARKER_SIZE",uy.RING_INNER_SIZE),u(wi,"INDICATOR_SIZE",10),u(wi,"\u0275fac",function(e){return new(e||uy)(U($t))}),u(wi,"\u0275cmp",Be({type:uy,selectors:[["app-yinsh"]],features:[Ke],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),O(1,tCt,2,1,"g",1),O(2,nCt,1,3,"polygon",2),O(3,iCt,2,1,"g",3),O(4,sCt,1,6,"rect",4),O(5,cCt,2,3,"g",1),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.spaceInfo),_(1),y("ngForOf",t.viewInfo.selectedCoords),_(1),y("ngIf",t.isPlayerTurn()),_(1),y("ngForOf",t.viewInfo.targets),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Dt,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));let Nn=(()=>{class r{}return u(r,"ABALONE",()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`),u(r,"APAGOS",()=>$localize`Very simple game, but, will you be able to win everytime?`),u(r,"AWALE",()=>$localize`The most widespread of the Mancalas.`),u(r,"BRANDHUB",()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"COERCEO",()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`),u(r,"CONNECT_SIX",()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`),u(r,"CONSPIRATEURS",()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`),u(r,"DIABALLIK",()=>$localize`Pass the ball up to the side of the opponent to win the game!`),u(r,"DIAM",()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`),u(r,"DVONN",()=>$localize`Stack your pieces and control as many stacks as you can to win!`),u(r,"ENCAPSULE",()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`),u(r,"EPAMINONDAS",()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`),u(r,"GIPF",()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`),u(r,"GO",()=>$localize`The oldest strategy game still practiced widely. A territory control game.`),u(r,"HIVE",()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`),u(r,"HNEFATAFL",()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`),u(r,"KALAH",()=>$localize`A modern version of the famous African strategy game!`),u(r,"KAMISADO",()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`),u(r,"LASCA",()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`),u(r,"LINES_OF_ACTION",()=>$localize`Regroup your pieces to win. But your possible moves will often change!`),u(r,"LODESTONE",()=>$localize`Push and crush your opponent's pieces using magnetic forces!`),u(r,"MARTIAN_CHESS",()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`),u(r,"P4",()=>$localize`The classical 4 in a row game!`),u(r,"PENTAGO",()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`),u(r,"PENTE",()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`),u(r,"PYLOS",()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`),u(r,"QUARTO",()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`),u(r,"QUIXO",()=>$localize`Align 5 of your pieces on a board where pieces slide!`),u(r,"REVERSI",()=>$localize`Sandwich your opponent's pieces to dominate the board!`),u(r,"SAHARA",()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`),u(r,"SIAM",()=>$localize`Be the first to push a mountain out of the board!`),u(r,"SIX",()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`),u(r,"TABLUT",()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"TEEKO",()=>$localize`Align your 4 pieces or form a square with them to win!`),u(r,"TREXO",()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`),u(r,"YINSH",()=>$localize`Align your pieces to score points, but beware, pieces can flip!`),r})(),Uu=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=!0){u(this,"name",void 0),u(this,"urlName",void 0),u(this,"component",void 0),u(this,"tutorial",void 0),u(this,"rules",void 0),u(this,"creationDate",void 0),u(this,"description",void 0),u(this,"display",void 0),this.name=n,this.urlName=i,this.component=s,this.tutorial=o,this.rules=a,this.creationDate=c,this.description=l,this.display=f}}return r=e,u(e,"ALL_GAMES",()=>[new r($localize`Four in a Row`,"P4",Dgt,new L3e,r3.get(),new Date("2018-08-28"),Nn.P4()),new r($localize`Awalé`,"Awale",$ft,new Wae,ea.get(),new Date("2018-11-29"),Nn.AWALE()),new r($localize`Quarto`,"Quarto",Ymt,new Q3e,Rr.get(),new Date("2018-12-09"),Nn.QUARTO()),new r($localize`Tablut`,"Tablut",vvt,new C4e,d3.get(),new Date("2018-12-27"),Nn.TABLUT()),new r($localize`Reversi`,"Reversi",u_t,new i4e,Gl.get(),new Date("2019-01-16"),Nn.REVERSI()),new r($localize`Go`,"Go",iR,new Qce,Za.get(),new Date("2019-12-21"),Nn.GO()),new r($localize`Encapsule`,"Encapsule",Fdt,new Vce,F0.get(),new Date("2019-12-30"),Nn.ENCAPSULE()),new r($localize`Siam`,"Siam",MR,new h4e,ts.get(),new Date("2020-01-11"),Nn.SIAM()),new r($localize`Sahara`,"Sahara",P_t,new a4e,f3.get(),new Date("2020-02-29"),Nn.SAHARA()),new r($localize`Pylos`,"Pylos",_mt,new q3e,Xr.get(),new Date("2020-10-02"),Nn.PYLOS()),new r($localize`Kamisado`,"Kamisado",bpt,new g3e,T2.get(),new Date("2020-10-03"),Nn.KAMISADO()),new r($localize`Quixo`,"Quixo",n_t,new t4e,b2.get(),new Date("2020-10-15"),Nn.QUIXO()),new r($localize`Dvonn`,"Dvonn",wdt,new kce,hr.get(),new Date("2020-10-21"),Nn.DVONN()),new r($localize`Epaminondas`,"Epaminondas",Kdt,new Bce,S2.get(),new Date("2021-01-16"),Nn.EPAMINONDAS()),new r($localize`Gipf`,"Gipf",oht,new Zce,Yt.get(),new Date("2021-02-22"),Nn.GIPF()),new r($localize`Coerceo`,"Coerceo",D9t,new Cce,Su.get(),new Date("2021-03-21"),Nn.COERCEO()),new r($localize`Six`,"Six",svt,new m4e,sc.get(),new Date("2021-04-08"),Nn.SIX()),new r($localize`Lines of Action`,"LinesOfAction",Gpt,new P3e,Yr.get(),new Date("2021-04-28"),Nn.LINES_OF_ACTION()),new r($localize`Pentago`,"Pentago",jgt,new D3e,Qa.get(),new Date("2021-05-23"),Nn.PENTAGO()),new r($localize`Abalone`,"Abalone",Sft,new Vae,Es.get(),new Date("2021-07-13"),Nn.ABALONE()),new r($localize`Yinsh`,"Yinsh",wi,new R4e,Ca.get(),new Date("2021-07-31"),Nn.YINSH()),new r($localize`Apagos`,"Apagos",Ift,new kae,Xs.get(),new Date("2021-11-04"),Nn.APAGOS()),new r($localize`Diam`,"Diam",Kc,new gce,Wa.get(),new Date("2021-11-30"),Nn.DIAM()),new r($localize`Brandhub`,"Brandhub",a9t,new nce,Zc.get(),new Date("2021-12-07"),Nn.BRANDHUB()),new r($localize`Conspirateurs`,"Conspirateurs",Y9t,new uce,Zi.get(),new Date("2021-12-30"),Nn.CONSPIRATEURS()),new r($localize`Lodestone`,"Lodestone",Vl,new b3e,_r.get(),new Date("2022-06-24"),Nn.LODESTONE()),new r($localize`Martian Chess`,"MartianChess",xs,new k3e,Ji.get(),new Date("2022-07-01"),Nn.MARTIAN_CHESS()),new r($localize`Hnefatafl`,"Hnefatafl",hpt,new u3e,e3.get(),new Date("2022-09-21"),Nn.HNEFATAFL()),new r($localize`Hive`,"Hive",ept,new a3e,c2.get(),new Date("2023-04-02"),Nn.HIVE()),new r($localize`Trexo`,"Trexo",Bn,new N4e,N2.get(),new Date("2023-04-23"),Nn.TREXO()),new r($localize`Lasca`,"Lasca",Dpt,new M3e,Is.get(),new Date("2023-05-11"),Nn.LASCA()),new r($localize`Connect Six`,"ConnectSix",m9t,new sce,ji.get(),new Date("2023-05-13"),Nn.CONNECT_SIX()),new r($localize`Pente`,"Pente",tmt,new $3e,Ls.get(),new Date("2023-05-20"),Nn.PENTE()),new r($localize`Teeko`,"Teeko",Svt,new E4e,Ti.get(),new Date("2023-07-30"),Nn.TEEKO()),new r($localize`Kalah`,"Kalah",vpt,new d3e,no.get(),new Date("2023-09-07"),Nn.KALAH()),new r($localize`Diaballik`,"Diaballik",odt,new bce,bs.get(),new Date("2023-11-18"),Nn.DIABALLIK())].sort((t,n)=>t.name.localeCompare(n.name))),e})(),OR=(()=>{var r;class e{constructor(){u(this,"games",Uu.ALL_GAMES()),u(this,"pickGame",new A1)}onChange(n){this.pickGame.emit(n.target.value)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"select",1),W("change",function(o){return i.onChange(o)}),S(2,"option",2),oe(3,3),P(),O(4,lCt,2,2,"option",4),P()()),2&n&&(_(4),y("ngForOf",i.games))},dependencies:[Wt,mf,_f],encapsulation:2})),e})();function uCt(r,e){if(1&r){const t=pe();S(0,"div",26)(1,"div",27),W("click",function(){return ne(t),re(p().closeInfo())}),P(),S(2,"div",28)(3,"header",29)(4,"p",30),ct(5),P(),S(6,"button",31),W("click",function(){return ne(t),re(p().closeInfo())}),P()(),S(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),V(11,"img",35),P()(),S(12,"div",7)(13,"div",13),ct(14),P()()(),S(15,"div",6)(16,"div",33)(17,"a",36),W("click",function(){ne(t);const i=p();return re(i.createGame(i.gameInfoDetails.get().urlName))}),V(18,"fa-icon",37),ct(19,"\xa0"),S(20,"span"),oe(21,38),P()()(),S(22,"div",33)(23,"a",36),W("click",function(){ne(t);const i=p();return re(i.createLocalGame(i.gameInfoDetails.get().urlName))}),V(24,"fa-icon",37),ct(25,"\xa0"),S(26,"span"),oe(27,39),P()()(),S(28,"div",33)(29,"a",36),W("click",function(){ne(t);const i=p();return re(i.createTutorial(i.gameInfoDetails.get().urlName))}),V(30,"fa-icon",37),ct(31,"\xa0"),S(32,"span"),oe(33,40),P()()()()()()()}if(2&r){const t=p();_(5),mn(t.gameInfoDetails.get().name),_(6),ve("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",_p),_(3),x2(" ",t.gameInfoDetails.get().description," "),_(4),y("icon",t.iconOnlineGame),_(6),y("icon",t.iconLocalGame),_(6),y("icon",t.iconTutorial)}}function fCt(r,e){if(1&r){const t=pe();S(0,"div",8)(1,"div",9)(2,"p",10),ct(3),P()(),S(4,"div",42)(5,"figure",34)(6,"img",43),W("click",function(){const s=ne(t).$implicit;return re(p(2).openInfo(s))}),P(),S(7,"figcaption",44),W("click",function(){const s=ne(t).$implicit;return re(p(2).openInfo(s))}),S(8,"div",45),ct(9,"?"),P()(),S(10,"figcaption",46)(11,"a",47),W("click",function(){const s=ne(t).$implicit;return re(p(2).createGame(s.urlName))}),V(12,"fa-icon",37),P(),S(13,"a",48),W("click",function(){const s=ne(t).$implicit;return re(p(2).createLocalGame(s.urlName))}),V(14,"fa-icon",37),P(),S(15,"a",49),W("click",function(){const s=ne(t).$implicit;return re(p(2).createTutorial(s.urlName))}),V(16,"fa-icon",37),P()()()(),S(17,"div",50),ct(18),P()()}if(2&r){const t=e.$implicit,n=p(2);_(3),mn(t.name),_(3),Dn("id","image_",t.urlName,""),ve("src","assets/images/",n.theme,"/",t.urlName,".png",_p),_(5),Dn("id","playOnline_",t.urlName,""),_(1),y("icon",n.iconOnlineGame),_(1),Dn("id","playLocally_",t.urlName,""),_(1),y("icon",n.iconLocalGame),_(1),Dn("id","startTutorial_",t.urlName,""),_(1),y("icon",n.iconTutorial),_(2),x2(" ",t.description," ")}}function dCt(r,e){if(1&r&&(S(0,"div",7),O(1,fCt,19,11,"div",41),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let hCt=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"currentGameService",void 0),u(this,"numberOfColumns",5),u(this,"games",[]),u(this,"theme",void 0),u(this,"iconOnlineGame",Kie),u(this,"iconLocalGame",TL),u(this,"iconTutorial",Qoe),u(this,"gameInfoDetails",g.empty()),this.router=n,this.messageDisplayer=i,this.currentGameService=s,this.theme=o.getTheme();const a=Uu.ALL_GAMES();let c=0;for(let l=0;l<a.length;l++)l<this.numberOfColumns&&this.games.push([]),this.games[c].push(a[l]),c=(c+1)%this.numberOfColumns}createGame(n){var i=this;return M(function*(){const s=i.currentGameService.canUserCreate();return s.isSuccess()?i.router.navigate(null==n?["/play"]:["/play",n]):(i.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(n){var i=this;return M(function*(){return i.router.navigate(["/local",n])})()}createTutorial(n){return this.router.navigate(["/tutorial",n])}openInfo(n){this.gameInfoDetails=g.of(n)}closeInfo(){this.gameInfoDetails=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U($t),U(ys),U(Av))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,s=$localize`Create an online game`,o=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,f=$localize`Play online`,d=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,w=$localize`Play offline`,R=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],o,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],f,d,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",R,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(S(0,"section",0)(1,"div",1)(2,"p",2),oe(3,3),P(),S(4,"p",4),Gs(5,5),V(6,"br"),Us(),P()(),S(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),oe(12,11),P()(),S(13,"div",12)(14,"div",13)(15,"button",14),W("click",function(){return i.createGame()}),oe(16,15),P(),S(17,"button",16),oe(18,17),P()()()()(),S(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),oe(23,18),P()(),S(24,"div",12)(25,"div",19)(26,"button",20),oe(27,21),P(),S(28,"button",22),oe(29,23),P()()()()()(),O(30,uCt,34,7,"div",24),S(31,"div",6),O(32,dCt,2,1,"div",25),P()()),2&n&&(_(30),y("ngIf",i.gameInfoDetails.isPresent()),_(2),y("ngForOf",i.games))},dependencies:[Wt,wt,Ic,x0],encapsulation:2})),e})();const pCt=["board"];let j0=(()=>{class r{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return u(r,"NOT_YOUR_TURN",()=>$localize`It is not your turn!`),u(r,"GAME_HAS_ENDED",()=>$localize`This game has ended.`),u(r,"CANNOT_PLAY_AS_OBSERVER",()=>$localize`You are an observer in this game, you cannot play.`),u(r,"MUST_ANSWER_REQUEST",()=>$localize`You must answer your opponent's request.`),r})(),fy=(()=>{var r;class e{constructor(n,i,s,o){u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"boardRef",null),u(this,"gameComponent",void 0),u(this,"players",[g.empty(),g.empty()]),u(this,"role",q.NONE),u(this,"endGame",!1),u(this,"Player",k),this.actRoute=n,this.connectedUserService=i,this.router=s,this.messageDisplayer=o}getMatchingComponent(n){return g.ofNullable(Uu.ALL_GAMES().find(s=>s.urlName===n)).map(s=>s.component)}afterViewInit(){var n=this;return M(function*(){const i=yield n.createGameComponent();return i&&(n.gameComponent.node=n.gameComponent.rules.getInitialNode(),yield n.gameComponent.updateBoard(!1)),i})()}getGameName(){return B.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var n=this;return M(function*(){const i=n.getGameName(),s=n.getMatchingComponent(i);if(s.isAbsent())return yield n.router.navigate(["/notFound",j0.NO_MATCHING_GAME(i)],{skipLocationChange:!0}),!1;je(null!=n.boardRef,"Board element should be present");const o=B.getNonNullable(n.boardRef).createComponent(s.get());return n.gameComponent=o.instance,n.gameComponent.chooseMove=a=>n.receiveValidMove(a),n.gameComponent.canUserPlay=a=>n.canUserPlay(a),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=a=>n.onCancelMove(a),yield n.setRole(n.role),!0})()}setRole(n){var i=this;return M(function*(){i.role=n,i.gameComponent.setPointOfView(n===q.NONE?k.ZERO:n),yield i.updateBoardAndShowLastMove(!1)})()}receiveValidMove(n){var i=this;return M(function*(){const s=i.gameComponent.rules.isLegal(n,i.gameComponent.getState());return s.isFailure()?(yield i.gameComponent.cancelMove(s.getReason()),b.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(n),b.SUCCESS)})()}canUserPlay(n){var i=this;return M(function*(){if(i.role===q.NONE){const s=j0.CANNOT_PLAY_AS_OBSERVER();return b.failure(s)}return!1===i.isPlayerTurn()?b.failure(j0.NOT_YOUR_TURN()):i.endGame?b.failure(j0.GAME_HAS_ENDED()):b.SUCCESS})()}isPlayerTurn(){if(this.role===q.NONE||null==this.gameComponent)return!1;const i=this.gameComponent.getTurn()%2,s=this.getPlayer();return!this.players[i].isPresent()||this.players[i].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(n){var i=this;return M(function*(){if(i.gameComponent.cancelMoveAttempt(),i.gameComponent.hideLastMove(),yield i.gameComponent.updateBoard(n),i.gameComponent.node.previousMove.isPresent()){const s=i.gameComponent.node.previousMove.get();yield i.gameComponent.showLastMove(s)}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(qs),U(ur),U(Un),U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&G4(pCt,5,vo),2&n){let s;x3(s=L3())&&(i.boardRef=s.first)}},decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();const gCt=["board"];let mCt=(()=>{var r;class e extends fy{constructor(n,i,s,o,a){super(n,i,s,o),u(this,"cdr",void 0),u(this,"demoNodeInfo",void 0),u(this,"boardRef",null),this.cdr=a}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var n=this;return M(function*(){window.setTimeout(M(function*(){yield n.afterViewInit(),n.gameComponent.node=n.demoNodeInfo.node,n.gameComponent.setInteractive(!0),yield n.setRole(n.gameComponent.getCurrentPlayer()),n.cdr.detectChanges(),n.demoNodeInfo.click.isPresent()&&(B.getNonNullable(document.querySelector(n.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),n.cdr.detectChanges())}),1)})()}onLegalUserMove(n,i){return M(function*(){})()}getPlayer(){return"no-player"}onCancelMove(n){return M(function*(){})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(qs),U(ur),U(Un),U($t),U(R3))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&G4(gCt,5,vo),2&n){let s;x3(s=L3())&&(i.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[Ke],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&V(0,"div",null,0)},encapsulation:2})),e})();function _Ct(r,e){if(1&r&&(S(0,"div",17)(1,"figure",18),V(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function vCt(r,e){if(1&r&&(S(0,"div",20)(1,"figure",21),V(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function CCt(r,e){if(1&r&&(S(0,"div",12)(1,"div",13)(2,"p",14),ct(3),P()(),O(4,_Ct,3,1,"div",15),O(5,vCt,3,1,"ng-template",null,16,dn),P()),2&r){const t=e.$implicit,n=un(6),i=p(2);_(3),mn(t.name),_(1),y("ngIf",i.squared.value)("ngIfElse",n)}}function yCt(r,e){if(1&r&&(S(0,"div",10),O(1,CCt,7,3,"div",11),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let MCt=(()=>{var r;class e{constructor(){u(this,"numberOfColumns",new yo(5)),u(this,"squared",new yo(!0)),u(this,"columns",[]),this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(n=>{this.fillColumns(n)})}fillColumns(n){const i=Uu.ALL_GAMES();let s=0,o=0;this.columns=[];for(const a of i){const c=[],l=a.rules,f=a.tutorial.tutorial;for(const d of f){const m=this.getNodeFromStep(d,l);c.push(m)}for(const d of c)o<n&&this.columns.push([]),this.columns[s].push({name:a.urlName,node:d.node,click:d.click}),o++,s=(s+1)%n}}getNodeFromStep(n,i){if(n.hasSolution()){const s=n.getSolution();if("string"==typeof s)return{node:new Qo(n.state),click:g.of(s)};{const o=s,a=i.isLegal(o,n.state).get(),c=i.applyLegalMove(o,n.state,a),l=g.of(new Qo(n.state));return{node:new Qo(c,l,g.of(o)),click:g.empty()}}}return{node:new Qo(n.state),click:g.empty()}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(S(0,"form")(1,"div",0)(2,"label",1),Gt(3),oe(4,2),Ut(),S(5,"output"),ct(6),P()(),S(7,"div",3),V(8,"input",4),P()(),S(9,"div",0)(10,"label",5),V(11,"input",6),ct(12," \xa0"),Gt(13),oe(14,7),Ut(),P()()(),S(15,"div",8),O(16,yCt,2,1,"div",9),P()),2&n&&(_(6),mn(i.numberOfColumns.value),_(2),y("formControl",i.numberOfColumns),_(3),y("formControl",i.squared),_(5),y("ngForOf",i.columns))},dependencies:[Wt,wt,T6,bc,wg,$S,V3,P6,eP,pf,mCt],encapsulation:2})),e})(),TR=(()=>{var r;class e{constructor(n){u(this,"element",void 0),this.element=n}ngAfterViewInit(){this.element.nativeElement.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Li))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","autofocus",""]]})),e})(),D4e=(()=>{var r;class e{constructor(n){u(this,"shown",!1),u(this,"input",void 0),this.input=n.nativeElement.parentNode.previousSibling,n.nativeElement.addEventListener("click",i=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Li))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","toggleVisibility",""]]})),e})();function ECt(r,e){if(1&r&&(S(0,"div",29)(1,"div",30),oe(2,31),P(),S(3,"div",32),ct(4),P()()),2&r){const t=p();_(4),mn(t.errorMessage)}}const SCt=function(){return["/register"]},PCt=function(){return["/reset-password"]};let OCt=(()=>{var r;class e{constructor(n,i){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"faEye",nL),u(this,"errorMessage",void 0),u(this,"loginForm",new K4({email:new yo,password:new yo})),u(this,"userSubscription",void 0),this.router=n,this.connectedUserService=i}ngOnInit(){var n=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var i=M(function*(s){s!==O0.NOT_CONNECTED&&(yield n.redirect())});return function(s){return i.apply(this,arguments)}}())}loginWithEmail(n){var i=this;return M(function*(){const s=yield i.connectedUserService.doEmailLogin(n.email,n.password);s.isFailure()&&(i.errorMessage=s.getReason())})()}loginWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isFailure()&&(n.errorMessage=i.getReason())})()}redirect(){var n=this;return M(function*(){return n.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(ur))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,s=$localize`Password`,o=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,f=$localize`Register`,d=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",o,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],f,d,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),P()()()(),S(12,"div",4)(13,"div",5)(14,"label",12),oe(15,13),P()(),S(16,"div",8)(17,"div",9)(18,"div",14),V(19,"input",15),S(20,"span",16),V(21,"fa-icon",17),P()()()()(),S(22,"div",4),V(23,"div",5),S(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),W("click",function(){return i.loginWithEmail(i.loginForm.value)}),oe(28,19),P()()()()(),S(29,"div",4),V(30,"div",5),S(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),W("click",function(){return i.loginWithGoogle()}),oe(35,21),P()()()()(),O(36,ECt,5,1,"div",22),S(37,"p",23),Gt(38),oe(39,24),Ut(),ct(40,"\xa0 "),S(41,"a",25),oe(42,26),P()(),S(43,"p",23),Gt(44),oe(45,27),Ut(),ct(46,"\xa0 "),S(47,"a",25),oe(48,28),P()()()()),2&n&&(_(3),y("formGroup",i.loginForm),_(18),y("icon",i.faEye),_(6),y("disabled",!i.canLogin()),_(9),y("ngIf",i.errorMessage),_(5),y("routerLink",D1(6,SCt)),_(6),y("routerLink",D1(7,PCt)))},dependencies:[wt,Ic,T6,bc,V3,P6,N6,b6,Y8,x0,TR,D4e],encapsulation:2})),e})(),TCt=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}subscribeToActiveParts(n){let i=[];const c=new Nv(l=>{i=i.concat(...l),n(i)},l=>{const f=i;for(const d of l)f.forEach(m=>{m.id===d.id&&(m.data=d.data)});i=f,n(i)},l=>{const f=[];for(const d of i)l.every(m=>m.id!==d.id)&&f.push(d);i=f,n(i)});return this.partDAO.observingWhere([["result","==",x1.UNACHIEVED.value]],c)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(yd))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),bCt=(()=>{var r;class e{transform(n){return zB(1e3*n.seconds,"HH:mm:ss","en-US")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Ii({name:"firestoreTime",type:r,pure:!0})),e})();var Wu;const NCt=["chatDiv"];function ACt(r,e){1&r&&(Gt(0),oe(1,5),Ut())}function ICt(r,e){1&r&&oe(0,6),2&r&&(Gn(p().unreadMessagesText),Kn(0))}function kCt(r,e){if(1&r){const t=pe();S(0,"button",11),W("click",function(){return ne(t),re(p(2).scrollToBottom())}),ct(1),P()}if(2&r){const t=p(2);_(1),x2("",t.unreadMessagesText," \u2193")}}function xCt(r,e){if(1&r&&(S(0,"p"),ct(1),Na(2,"firestoreTime"),S(3,"b",12),ct(4),P(),S(5,"span",13),ct(6),P()()),2&r){const t=e.$implicit;_(1),x2(" [",Pc(2,3,t.postedTime),"] "),_(3),x2("",t.sender.name," : "),_(2),mn(t.content)}}function LCt(r,e){if(1&r){const t=pe();S(0,"div"),O(1,kCt,2,1,"button",7),S(2,"div",8,9),W("scroll",function(){return ne(t),re(p().updateCurrentScrollPosition())}),O(4,xCt,7,5,"p",10),P()()}if(2&r){const t=p();_(1),y("ngIf",t.showUnreadMessagesButton),_(3),y("ngForOf",t.chat)}}const RCt=function(){return{standalone:!0}};function zCt(r,e){if(1&r){const t=pe();S(0,"form",14),W("onSubmit",function(){return ne(t),re(p().sendMessage())}),S(1,"div",15)(2,"div",16)(3,"input",17,18),W("ngModelChange",function(i){return ne(t),re(p().userMessage=i)}),P(),S(5,"p",19),ct(6),P()(),S(7,"div",20)(8,"button",21),W("click",function(){return ne(t),re(p().sendMessage())}),V(9,"fa-icon",22),P()()(),S(10,"div",23)(11,"p")(12,"strong"),oe(13,24),P()()()()}if(2&r){const t=un(4),n=p();_(3),y("ngModel",n.userMessage)("ngModelOptions",D1(4,RCt)),_(3),x2("",t.value.length,"/128"),_(3),y("icon",n.faReply)}}let dy=(Wu=class{constructor(e,t){u(this,"chatService",void 0),u(this,"connectedUserService",void 0),u(this,"chatId",void 0),u(this,"turn",void 0),u(this,"userMessage",""),u(this,"connected",!1),u(this,"chat",[]),u(this,"readMessages",0),u(this,"unreadMessagesText",""),u(this,"showUnreadMessagesButton",!1),u(this,"visible",!0),u(this,"faReply",$x),u(this,"isNearBottom",!0),u(this,"notYetScrolled",!0),u(this,"chatSubscription",void 0),u(this,"chatDiv",void 0),this.chatService=e,this.connectedUserService=t}ngOnInit(){je(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new Nv(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return M(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}},u(Wu,"\u0275fac",function(e){return new(e||Wu)(U(ru),U(ur))}),u(Wu,"\u0275cmp",Be({type:Wu,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&G4(NCt,5),2&e){let n;x3(n=L3())&&(t.chatDiv=n.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let r,e,t,n;return r=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,n=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],r,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],n]},template:function(e,t){if(1&e&&(S(0,"div")(1,"button",0),W("click",function(){return t.switchChatVisibility()}),O(2,ACt,2,0,"ng-container",1),O(3,ICt,1,1,"ng-template",null,2,dn),P(),O(5,LCt,5,2,"div",3),O(6,zCt,14,5,"form",4),P()),2&e){const n=un(4);_(2),y("ngIf",t.visible)("ngIfElse",n),_(3),y("ngIf",t.visible),_(1),y("ngIf",t.visible)}},dependencies:[Wt,wt,T6,bc,V3,P6,iP,gf,pf,x0,bCt],encapsulation:2})),Wu);dy=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],dy);let H4e=(()=>{var r;class e{constructor(n,i,s){u(this,"router",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"selectedGame",void 0),this.router=n,this.currentGameService=i,this.messageDisplayer=s}pickGame(n){this.selectedGame=n}navigateToOnlineGameCreation(){var n=this;return M(function*(){const i=n.currentGameService.canUserCreate();i.isSuccess()?yield n.router.navigate(["/play",n.selectedGame]):n.messageDisplayer.criticalMessage(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un),U(ys),U($t))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.navigateToOnlineGameCreation()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[OR],encapsulation:2})),e})();var qu;function HCt(r,e){if(1&r&&(Gt(0),ct(1),Ut()),2&r){const t=p().$implicit;_(1),mn(t.data.playerOne.name)}}function VCt(r,e){1&r&&(Gt(0),oe(1,27),Ut())}function FCt(r,e){if(1&r){const t=pe();S(0,"tr",22),W("click",function(){const s=ne(t).$implicit;return re(p(2).joinGame(s))}),S(1,"td",23),ct(2),P(),S(3,"td",23),ct(4),P(),S(5,"td",23),O(6,HCt,2,1,"ng-container",24),O(7,VCt,2,0,"ng-template",null,25,dn),P(),S(9,"td",26),ct(10),P()()}if(2&r){const t=e.$implicit,n=e.index,i=un(8);Dn("id","part_",n,""),_(2),mn(t.data.typeGame),_(2),mn(t.data.playerZero.name),_(2),y("ngIf",t.data.playerOne)("ngIfElse",i),_(4),mn(t.data.turn+1)}}function $Ct(r,e){if(1&r&&(S(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),oe(6,17),P(),S(7,"th",16),oe(8,18),P(),S(9,"th",16),oe(10,19),P(),S(11,"th",16),oe(12,20),P()()(),S(13,"tbody"),O(14,FCt,11,6,"tr",21),P()()()()),2&r){const t=p();_(14),y("ngForOf",t.activeParts)}}function BCt(r,e){1&r&&(S(0,"div",28),V(1,"app-online-game-selection",29),P())}function GCt(r,e){1&r&&(S(0,"div",30)(1,"div",31)(2,"div",32),V(3,"app-chat",33),P()()()),2&r&&(_(3),y("turn",-1))}let bR=(qu=class{constructor(e,t,n,i){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"activePartsService",void 0),u(this,"currentGameService",void 0),u(this,"activeParts",[]),u(this,"activePartsSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"currentTab","games"),u(this,"createTabClasses",[]),this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return M(function*(){const n=e.id,i=e.data.typeGame,o=t.currentGameService.canUserJoin(n,null!=e.data.beginning);o.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(o.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}},u(qu,"\u0275fac",function(e){return new(e||qu)(U(Un),U($t),U(TCt),U(ys))}),u(qu,"\u0275cmp",Be({type:qu,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let r,e,t,n,i,s,o,a;return r=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,n=$localize`Game`,i=$localize`First player`,s=$localize`Second player`,o=$localize`Turn`,a=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],r,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],n,i,s,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),W("click",function(){return t.selectTab("games")}),oe(4,3),P()(),S(5,"li",4)(6,"a",5),W("click",function(){return t.selectTab("create")}),oe(7,6),P()(),S(8,"li",7)(9,"a",8),W("click",function(){return t.selectTab("chat")}),oe(10,9),P()()()(),O(11,$Ct,15,1,"div",10),O(12,BCt,2,0,"div",11),O(13,GCt,4,1,"div",12)),2&e&&(_(6),y("ngClass",t.createTabClasses),_(5),y("ngIf","games"===t.currentTab),_(1),y("ngIf","create"===t.currentTab),_(1),y("ngIf","chat"===t.currentTab))},dependencies:[Dt,Wt,wt,dy,H4e],encapsulation:2})),qu);bR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],bR);let UCt=(()=>{var r;class e{constructor(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P()(),S(3,"div",3)(4,"p",1),ct(5,"Resetting password"),P(),S(6,"div",4)(7,"p",5),oe(8,6),P(),S(9,"button",7),oe(10,8),P()()())},dependencies:[Ic],encapsulation:2})),e})(),V4e=(()=>{var r;class e{constructor(n){u(this,"route",void 0),u(this,"message",void 0),this.route=n,this.message=n.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(qs))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),oe(2,2),P(),S(3,"div",3),ct(4),P()()),2&n&&(_(4),mn(i.message))},encapsulation:2})),e})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const jCt=new Error("request for lock canceled");class YCt{constructor(e,t=jCt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,s=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(s)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class XCt{constructor(e){this._semaphore=new YCt(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let $4e=(()=>{var r;class e{constructor(){u(this,"requestAwaitingReply",g.empty()),u(this,"lastDeniedRequest",g.empty()),u(this,"forbiddenRequests",new st)}onGameStart(){this.requestAwaitingReply=g.empty(),this.lastDeniedRequest=g.empty(),this.forbiddenRequests=new st}onReceivedMove(){this.forbiddenRequests=new st,this.lastDeniedRequest=g.empty()}onReceivedRequest(n){B.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=g.of(n)}onReceivedReply(n,i){var s=this;return M(function*(){switch(s.requestAwaitingReply=g.empty(),n.reply){case"Accept":return!0;case"Reject":return n.player===i.getOpponent().value&&(s.lastDeniedRequest=g.of(n.requestType),s.forbiddenRequests.add(n.requestType)),!1}})()}canMakeRequest(n){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(n))}getRequestAwaitingReplyFrom(n){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===n.getOpponent().value?g.of(this.requestAwaitingReply.get().requestType):g.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return r=e,u(e,"requestInfos",{TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:uL},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Jne},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:L1e}}),u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),JCt=(()=>{var r;class e{constructor(){u(this,"turnClocks",void 0),u(this,"globalClocks",void 0),u(this,"allClocks",void 0),u(this,"configRoom",g.empty()),u(this,"takenGlobalTime",[0,0]),u(this,"extraGlobalTime",[0,0]),u(this,"availableTurnTime",[0,0]),u(this,"lastMoveStartTimestamp",g.empty())}setClocks(n,i){this.turnClocks=n,this.globalClocks=i,this.allClocks=n.concat(i)}onGameStart(n){this.configRoom=g.of(n);for(const i of k.PLAYERS)this.takenGlobalTime[i.value]=0,this.extraGlobalTime[i.value]=0,this.availableTurnTime[i.value]=this.getMoveDurationInMs(),this.globalClocks[i.value].setDuration(this.getPartDurationInMs()),this.turnClocks[i.value].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(n){switch(n.action){case"AddTurnTime":this.addTurnTime(k.of(n.player));break;case"AddGlobalTime":this.addGlobalTime(k.of(n.player));break;case"StartGame":this.lastMoveStartTimestamp=g.of(n.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(n){const i=k.of(n.player),s=n.time,o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=g.of(s),this.takenGlobalTime[i.value]+=o,this.availableTurnTime[i.value]-=o;const a=i.getOpponent();this.availableTurnTime[a.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[a.value];this.globalClocks[a.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(n){return jae(this.lastMoveStartTimestamp.get(),n)}onGameEnd(){for(const n of this.allClocks)n.isStarted()&&n.stop();this.updateClocks()}beforeEventsBatch(n){!1===n&&this.pauseAllClocks()}afterEventsBatch(n,i,s){if(this.updateClocks(),!1===n){const o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[i.value].subtract(o),this.globalClocks[i.value].subtract(o),this.resumeClocks(i)}}resumeClocks(n){this.turnClocks[n.value].resume(),this.globalClocks[n.value].resume()}addTurnTime(n){this.availableTurnTime[n.getOpponent().value]+=3e4}addGlobalTime(n){this.extraGlobalTime[n.getOpponent().value]+=3e5}updateClocks(){for(const n of k.PLAYERS){this.turnClocks[n.value].changeDuration(this.availableTurnTime[n.value]);const i=this.getPartDurationInMs()+this.extraGlobalTime[n.value]-this.takenGlobalTime[n.value];this.globalClocks[n.value].changeDuration(i)}}pauseAllClocks(){for(const n of this.allClocks)!1===n.isIdle()&&n.pause()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function uh(r){return Jr((e,t)=>{lo(r).subscribe(Mr(t,()=>t.complete(),Rs)),!t.closed&&e.subscribe(t)})}let eyt=(()=>{var r;class e{transform(n){const i=n%60,s=(n-i)%3600/60,o=(n-60*s-i)/3600,a=[];if(o>1?a.push($localize`${o} hours`):1===o&&a.push($localize`1 hour`),s>1?a.push($localize`${s} minutes`):1===s&&a.push($localize`1 minute`),i>1?a.push($localize`${i} seconds`):1===i&&a.push($localize`1 second`),0===a.length)return $localize`0 seconds`;if(1===a.length)return a[0];{const c=a.slice(0,-1).join(", "),l=a.slice(-1)[0];return $localize`${c} and ${l}`}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Ii({name:"humanDuration",type:r,pure:!0})),e})();var x4,fh;function nyt(r,e){if(1&r&&(Gt(0),ct(1),Ut()),2&r){const t=p(3);_(1),mn(t.viewInfo.chosenOpponent)}}function ryt(r,e){1&r&&oe(0,44)}function iyt(r,e){if(1&r&&(S(0,"div",45)(1,"div",8)(2,"label",46),Gt(3),oe(4,47),Ut(),S(5,"output"),ct(6),Na(7,"humanDuration"),P()(),S(8,"div",37),V(9,"input",48),P()(),S(10,"div",8)(11,"label",49),Gs(12,50),V(13,"output"),Na(14,"humanDuration"),Us(),P(),S(15,"div",37),V(16,"input",51),P()()()),2&r){const t=p(3);_(6),mn(Pc(7,2,t.viewInfo.maximalMoveDuration||0)),_(8),Gn(Pc(14,4,t.viewInfo.totalPartDuration||0)),Kn(12)}}function syt(r,e){1&r&&(S(0,"div"),Gs(1,52),V(2,"br"),Us(),P())}function oyt(r,e){1&r&&(S(0,"button",64),oe(1,65),P())}function ayt(r,e){if(1&r){const t=pe();S(0,"tr",60),W("click",function(){const s=ne(t).$implicit;return re(p(4).selectOpponent(s))}),S(1,"td",61),ct(2),P(),S(3,"td",62),O(4,oyt,2,0,"button",63),P()()}if(2&r){const t=e.$implicit,n=p(4);Dn("id","presenceOf_",t,""),y("ngClass",n.viewInfo.candidateClasses[t]),_(1),y("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),_(1),mn(t),_(2),y("ngIf",n.viewInfo.chosenOpponent!==t)}}function cyt(r,e){if(1&r&&(Gt(0),oe(1,53),Ut(),S(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),oe(7,57),P(),S(8,"th",56),oe(9,58),P()()(),S(10,"tbody"),O(11,ayt,5,5,"tr",59),P()()()),2&r){const t=p(3);_(11),y("ngForOf",t.viewInfo.candidates)}}function lyt(r,e){if(1&r){const t=pe();S(0,"button",66),W("click",function(){return ne(t),re(p(3).changeConfig())}),oe(1,67),P()}}function uyt(r,e){if(1&r){const t=pe();S(0,"div")(1,"h1",4),oe(2,5),P(),S(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),oe(7,10),P(),S(8,"div",11)(9,"button",12),W("click",function(){return ne(t),re(p(2).selectFirstPlayer("RANDOM"))}),oe(10,13),P(),S(11,"button",14),W("click",function(){return ne(t),re(p(2).selectFirstPlayer("CREATOR"))}),oe(12,15),P(),S(13,"button",16),W("click",function(){return ne(t),re(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),O(14,nyt,2,1,"ng-container",17),O(15,ryt,1,0,"ng-template",null,18,dn),P()()(),S(17,"div",8)(18,"label",9),oe(19,19),P(),S(20,"div",11)(21,"div",20),W("click",function(){return ne(t),re(p(2).selectPartType("STANDARD"))}),S(22,"div",21)(23,"span"),oe(24,22),P()(),S(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),Gt(29),oe(30,26),Ut(),S(31,"strong"),ct(32),Na(33,"humanDuration"),P(),V(34,"br"),Gt(35),Gs(36,27),V(37,"strong"),Na(38,"humanDuration"),Us(),Ut(),P()()()()(),S(39,"div",28),W("click",function(){return ne(t),re(p(2).selectPartType("BLITZ"))}),S(40,"div",21)(41,"span"),oe(42,29),P()(),S(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),Gt(47),oe(48,30),Ut(),S(49,"strong"),ct(50),Na(51,"humanDuration"),P(),V(52,"br"),Gt(53),Gs(54,31),V(55,"strong"),Na(56,"humanDuration"),Us(),Ut(),P()()()()(),S(57,"button",32),W("click",function(){return ne(t),re(p(2).selectPartType("CUSTOM"))}),oe(58,33),P()()(),O(59,iyt,17,6,"div",34),S(60,"div",8)(61,"label",35),oe(62,36),P(),S(63,"div",37),O(64,syt,3,0,"div",17),O(65,cyt,12,1,"ng-template",null,38,dn),P()()(),S(67,"div",8)(68,"div",11)(69,"button",39),W("click",function(){return ne(t),re(p(2).proposeConfig())}),oe(70,40),P(),O(71,lyt,2,0,"button",41),S(72,"button",42),W("click",function(){return ne(t),re(p(2).cancelGameCreation())}),oe(73,43),P()()()()()}if(2&r){const t=un(16),n=un(66),i=p(2);_(3),y("formGroup",i.configFormGroup),_(1),y("disabled",!i.viewInfo.canEditConfig),_(5),y("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),_(1),y("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),_(7),y("ngClass",i.viewInfo.partTypeClasses.STANDARD),_(11),mn(Pc(33,19,i.partType.NORMAL_MOVE_DURATION)),_(6),Gn(Pc(38,21,i.partType.NORMAL_PART_DURATION)),Kn(36),_(1),y("ngClass",i.viewInfo.partTypeClasses.BLITZ),_(11),mn(Pc(51,23,i.partType.BLITZ_MOVE_DURATION)),_(6),Gn(Pc(56,25,i.partType.BLITZ_PART_DURATION)),Kn(54),_(1),y("ngClass",i.viewInfo.partTypeClasses.CUSTOM),_(2),y("ngIf",i.viewInfo.showCustomTime),_(5),y("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),_(5),y("disabled",!i.viewInfo.canProposeConfig),_(2),y("ngIf",i.viewInfo.canReviewConfig)}}function fyt(r,e){if(1&r&&(S(0,"div",74)(1,"p"),Gs(2,75),V(3,"br"),Us(),P()()),2&r){const t=p(3);_(3),Gn(t.viewInfo.creator),Kn(2)}}function dyt(r,e){if(1&r&&(S(0,"span"),oe(1,81),P()),2&r){const t=p(4);_(1),Gn(t.viewInfo.creator),Kn(1)}}function hyt(r,e){1&r&&(S(0,"span"),oe(1,82),P())}function pyt(r,e){1&r&&(S(0,"span"),oe(1,83),P())}function gyt(r,e){if(1&r){const t=pe();S(0,"div",74)(1,"p"),oe(2,76),P(),S(3,"ul")(4,"li"),O(5,dyt,2,1,"span",2),O(6,hyt,2,0,"span",2),O(7,pyt,2,0,"span",2),P(),S(8,"li"),Gs(9,77),V(10,"strong"),Na(11,"humanDuration"),Us(),P(),S(12,"li"),Gs(13,78),V(14,"strong"),Na(15,"humanDuration"),Us(),P()(),S(16,"button",79),W("click",function(){return ne(t),re(p(3).acceptConfig())}),oe(17,80),P()()}if(2&r){const t=p(3);_(2),Gn(t.viewInfo.creator)(t.viewInfo.partTypeName),Kn(2),_(3),y("ngIf","CREATOR"===t.viewInfo.firstPlayer),_(1),y("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),_(1),y("ngIf","RANDOM"===t.viewInfo.firstPlayer),_(4),Gn(Pc(11,7,t.viewInfo.maximalMoveDuration||0)),Kn(9),_(4),Gn(Pc(15,9,t.viewInfo.totalPartDuration||0)),Kn(13)}}function myt(r,e){if(1&r&&(S(0,"div")(1,"div",68)(2,"div",69)(3,"p"),oe(4,70),P()(),S(5,"div",71),O(6,fyt,4,1,"div",72),O(7,gyt,18,11,"ng-template",null,73,dn),P()()()),2&r){const t=un(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function _yt(r,e){if(1&r&&(Gt(0),oe(1,86),Ut()),2&r){const t=p(3);_(1),Gn(t.viewInfo.creator),Kn(1)}}function vyt(r,e){if(1&r&&oe(0,87),2&r){const t=p(3);Gn(t.viewInfo.creator)(t.viewInfo.chosenOpponent),Kn(0)}}function Cyt(r,e){if(1&r&&(S(0,"div",68)(1,"div",69)(2,"p"),oe(3,84),P()(),S(4,"div",71)(5,"p"),O(6,_yt,2,1,"ng-container",17),O(7,vyt,1,2,"ng-template",null,85,dn),P()()()),2&r){const t=un(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function yyt(r,e){if(1&r&&(S(0,"div",1),O(1,uyt,74,27,"div",2),O(2,myt,9,2,"div",2),O(3,Cyt,9,2,"div",3),P()),2&r){const t=p();_(1),y("ngIf",t.viewInfo.userIsCreator),_(1),y("ngIf",t.viewInfo.userIsChosenOpponent),_(1),y("ngIf",t.viewInfo.userIsObserver)}}let wR=(fh=x4=class{constructor(e,t,n,i,s,o,a,c,l,f){u(this,"router",void 0),u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"gameService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),u(this,"userService",void 0),u(this,"formBuilder",void 0),u(this,"messageDisplayer",void 0),u(this,"partType",fr),u(this,"partId",void 0),u(this,"gameStartNotification",new A1),u(this,"gameStarted",!1),u(this,"viewInfo",{userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]}),u(this,"currentConfigRoom",null),u(this,"candidates",[]),u(this,"ngUnsubscribe",new zs),u(this,"allUserInterval",g.empty()),u(this,"ownTokenInterval",g.empty()),u(this,"lastToken",void 0),u(this,"selfSubscription",new En),u(this,"configRoomSubscription",new En),u(this,"candidatesSubscription",new En),u(this,"configFormGroup",void 0),u(this,"allDocDeleted",!1),this.router=e,this.actRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=s,this.configRoomService=o,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=f}ngOnInit(){var e=this;return M(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;je(e.isPresent(),"PartCreationComponent should not be called without connected user"),je(e.get()!==O0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),je(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[G2.RANDOM.value,cf.required],maximalMoveDuration:[fr.NORMAL_MOVE_DURATION,cf.required],partType:["STANDARD",cf.required],totalPartDuration:[fr.NORMAL_PART_DURATION,cf.required],chosenOpponent:["",cf.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(),typeGame:B.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:B.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=M(function*(s){yield e.onCurrentConfigRoomUpdate(s)});return function(o){return i.apply(this,arguments)}}(),n=function(){var i=M(function*(s){yield e.onCandidatesUpdate(s)});return function(o){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return B.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(uh(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=B.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==_i.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(uh(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(uh(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(uh(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(uh(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=B.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===_i.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==_i.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==_i.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(fr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(fr.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(fr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(fr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return M(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return B.getNonNullable(t)}changeConfig(){var e=this;return M(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return M(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,s=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,fr.of(n),i,G2.of(s),o)})()}cancelGameCreation(){var e=this;return M(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),Ae.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),Ae.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),Ae.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Ae.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return M(function*(){if(e.isAbsent())return Ae.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=e.get();if(t.chosenOpponentJustLeft(n)&&t.userIsCreator(n)){const s=B.getNonNullable(t.currentConfigRoom),o=B.getNonNullable(s.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let i=!1;t.userJustChosenAsOpponent(n)&&(yield t.updateUserDocWithCurrentGame(n),i=!0),t.currentConfigRoom=n,t.allUserInterval.isAbsent()&&(je(!1===i,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(Ae.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return M(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return M(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return je(null!=e,"configRoom should not be null (isGameStarted)"),B.getNonNullable(e).partStatus===_i.PART_STARTED.value}onGameStarted(){const e=B.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return M(function*(){const t=B.getNonNullable(e.currentConfigRoom);je(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=g.of(window.setInterval(M(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),fh.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return M(function*(){const n=B.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return M(function*(){je(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),je(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return M(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return M(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(m2.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):jae(i.get(),t)>fh.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return M(function*(){const n=B.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return M(function*(){yield e.connectedUserService.sendPresenceToken(),je(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=g.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},fh.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{je(n.isPresent(),"connected user should exist"),e.lastToken=B.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=g.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,B.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return M(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Ae.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?Ae.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Ae.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Ae.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}},u(x4,"TOKEN_INTERVAL",5e3),u(x4,"TOKEN_TIMEOUT",1e4),u(x4,"\u0275fac",function(e){return new(e||x4)(U(Un),U(qs),U(ur),U(ys),U(ou),U(Md),U(ru),U(iu),U(Pme),U($t))}),u(x4,"\u0275cmp",Be({type:x4,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,E,w,R,z,$,G,de,Ce,Le,tt,gt,yn,Et,ti,Y0,Xl,g3,gh,mh,dt,Tt,kt,An;return r=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,n=$localize`You`,i=$localize`Game type`,s=$localize`Standard`,o=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,d=$localize`Custom`,m=$localize`Opponents`,E=$localize`Propose configuration`,w=$localize`Cancel game`,R=$localize`The opponent`,z=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,G=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,de=$localize`Click on the opponent against which you would like to play.`,Ce=$localize`Name`,Le=$localize`Actions`,tt=$localize`Pick`,gt=$localize`Change configuration`,yn=$localize`Configuration proposal`,Et=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,ti=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,Y0=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Xl=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,g3=$localize`Accept and start`,gh=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,mh=$localize`you play first`,dt=$localize`the first player is selected randomly`,Tt=$localize`One moment...`,kt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,An=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],r,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],n,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],d,["id","customTime",4,"ngIf"],[1,"label"],m,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],E,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],w,R,["id","customTime"],["for","maximalMoveDuration",1,"label"],z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],G,de,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],Ce,Le,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],tt,["id","reviewConfig",1,"button",3,"click"],gt,[1,"message","is-primary"],[1,"message-header"],yn,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],Et,ti,Y0,Xl,["id","acceptConfig",1,"button","is-primary",3,"click"],g3,gh,mh,dt,Tt,["proposalSent",""],kt,An]},template:function(e,t){1&e&&O(0,yyt,4,3,"div",0),2&e&&y("ngIf",t.viewInfo)},dependencies:[Dt,Wt,wt,T6,bc,wg,V3,P6,b6,Y8,eyt],encapsulation:2})),x4);var ac,Z0;function Eyt(r,e){if(1&r){const t=pe();S(0,"button",3),W("click",function(){return ne(t),re(p().addTime())}),oe(1,4),P()}if(2&r){const t=p();_(1),Gn(t.timeToAdd),Kn(1)}}wR=fh=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],wR);let NR=(Z0=ac=class{constructor(){u(this,"debugName",void 0),u(this,"timeToAdd",void 0),u(this,"dangerTimeLimit",void 0),u(this,"active",void 0),u(this,"canAddTime",void 0),u(this,"remainingMs",void 0),u(this,"displayedSec",void 0),u(this,"displayedMinute",void 0),u(this,"timeoutHandleGlobal",null),u(this,"timeoutHandleSec",null),u(this,"isPaused",!0),u(this,"isSet",!1),u(this,"started",!1),u(this,"startTime",void 0),u(this,"outOfTimeAction",new A1),u(this,"addTimeToOpponent",new A1),u(this,"cssClasses",Z0.SAFE_TIME)}setDuration(e){B.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){B.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){B.assert(this.isSet,"Should not start a chrono that has not been set!"),B.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){B.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){B.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),B.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){B.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?Z0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?Z0.DANGER_TIME_ODD:Z0.DANGER_TIME_EVEN:Z0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}},u(ac,"DANGER_TIME_EVEN","has-background-danger has-text-white"),u(ac,"DANGER_TIME_ODD","has-background-warning has-text-white"),u(ac,"PASSIVE_STYLE","has-text-passive is-italic"),u(ac,"SAFE_TIME",""),u(ac,"\u0275fac",function(e){return new(e||ac)}),u(ac,"\u0275cmp",Be({type:ac,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let r;return r=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],r]},template:function(e,t){1&e&&(S(0,"div",0)(1,"p",1),ct(2),Na(3,"number"),P(),O(4,Eyt,2,1,"button",2),P()),2&e&&(y("ngClass",t.getTimeClass()),_(2),SE("",t.displayedMinute,":",d$(3,4,t.displayedSec,"2.0-0"),""),_(2),y("ngIf",t.canAddTime))},dependencies:[Dt,wt,KB],encapsulation:2})),ac);var ju;NR=Z0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],NR);const Pyt=["chronoZeroGlobal"],Oyt=["chronoOneGlobal"],Tyt=["chronoZeroTurn"],byt=["chronoOneTurn"];function wyt(r,e){if(1&r){const t=pe();S(0,"app-part-creation",5,6),W("gameStartNotification",function(i){return ne(t),re(p().startGame(i))}),P()}2&r&&y("partId",p().currentPartId)}function Nyt(r,e){1&r&&(Gt(0),S(1,"span",39),oe(2,40),P(),Ut())}function Ayt(r,e){if(1&r&&(S(0,"span",41),oe(1,42),P()),2&r){const t=p(4);_(1),Gn(null==t.currentPlayer?null:t.currentPlayer.name),Kn(1)}}function Iyt(r,e){if(1&r&&(S(0,"p",36),O(1,Nyt,3,0,"ng-container",37),O(2,Ayt,2,1,"ng-template",null,38,dn),P()),2&r){const t=un(3),n=p(3);_(1),y("ngIf",(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name)("ngIfElse",t)}}function kyt(r,e){if(1&r&&(S(0,"div",32)(1,"p",33),oe(2,34),P(),O(3,Iyt,4,2,"p",35),P()),2&r){const t=p(2);_(2),Gn(t.currentPart.getTurn()+1),Kn(2),_(1),y("ngIf",!1===t.endGame)}}function xyt(r,e){if(1&r&&(S(0,"p",43),ct(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ZERO)),_(1),mn(t.players[0].get().name)}}function Lyt(r,e){if(1&r&&(S(0,"p",44),oe(1,45),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[0]),Kn(1)}}function Ryt(r,e){if(1&r&&(S(0,"p",46),ct(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ONE)),_(1),mn(t.players[1].get().name)}}function zyt(r,e){if(1&r&&(S(0,"p",47),oe(1,48),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[1]),Kn(1)}}function Dyt(r,e){1&r&&(S(0,"div")(1,"p",50),oe(2,51),P()())}function Hyt(r,e){1&r&&(S(0,"p",55),oe(1,56),P())}function Vyt(r,e){1&r&&(S(0,"p",57),oe(1,58),P())}function Fyt(r,e){1&r&&(S(0,"p",59),oe(1,60),P())}function $yt(r,e){if(1&r&&(S(0,"div"),O(1,Hyt,2,0,"p",52),O(2,Vyt,2,0,"p",53),O(3,Fyt,2,0,"p",54),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function Byt(r,e){1&r&&(S(0,"p",64),oe(1,65),P())}function Gyt(r,e){1&r&&(S(0,"p",66),oe(1,67),P())}function Uyt(r,e){if(1&r&&(S(0,"p",68),oe(1,69),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getWinner().get().name),Kn(1)}}function Wyt(r,e){if(1&r&&(S(0,"div"),O(1,Byt,2,0,"p",61),O(2,Gyt,2,0,"p",62),O(3,Uyt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function qyt(r,e){if(1&r&&(S(0,"p",64),oe(1,70),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getLoser().get().name),Kn(1)}}function jyt(r,e){1&r&&(S(0,"p",68),oe(1,71),P())}function Zyt(r,e){if(1&r&&(S(0,"p",68),oe(1,72),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getLoser().get().name),Kn(1)}}function Yyt(r,e){if(1&r&&(S(0,"div"),O(1,qyt,2,1,"p",61),O(2,jyt,2,0,"p",63),O(3,Zyt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function Kyt(r,e){1&r&&(S(0,"p",74),oe(1,75),P())}function Xyt(r,e){if(1&r&&(S(0,"p",74),oe(1,76),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getLoser().get().name),Kn(1)}}function Qyt(r,e){if(1&r&&(S(0,"div"),O(1,Kyt,2,0,"p",73),O(2,Xyt,2,1,"p",73),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function Jyt(r,e){if(1&r&&(S(0,"div",49),V(1,"hr"),O(2,Dyt,3,0,"div",27),O(3,$yt,4,3,"div",27),O(4,Wyt,4,3,"div",27),O(5,Yyt,4,3,"div",27),O(6,Qyt,3,2,"div",27),P()),2&r){const t=p(2);_(2),y("ngIf",t.currentPart.isHardDraw()),_(1),y("ngIf",t.currentPart.isAgreedDraw()),_(1),y("ngIf",t.currentPart.isWin()),_(1),y("ngIf",t.currentPart.isTimeout()),_(1),y("ngIf",t.currentPart.isResign())}}function eMt(r,e){if(1&r){const t=pe();Gt(0),S(1,"button",85),W("click",function(){const s=ne(t).$implicit;return re(p(4).propose(s))}),ct(2),V(3,"fa-icon",86),P(),Ut()}if(2&r){const t=e.$implicit,n=p(4);_(1),Dn("id","propose",t,""),y("disabled",!1===n.requestAvailable(t)),_(1),x2("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),_(1),y("icon",n.requestInfos[t].icon)}}function tMt(r,e){if(1&r){const t=pe();Gt(0),S(1,"button",80),W("click",function(){return ne(t),re(p(3).resign())}),oe(2,81),P(),S(3,"button",82),W("click",function(){return ne(t),re(p(3).gameComponent.pass())}),oe(4,83),P(),O(5,eMt,4,4,"ng-container",84),Ut()}if(2&r){const t=p(3);_(1),y("disabled",!1===t.canResign()),_(2),y("disabled",!1===t.canPass()),_(2),y("ngForOf",t.allRequests)}}function nMt(r,e){if(1&r){const t=pe();S(0,"div",87)(1,"p"),ct(2),V(3,"fa-icon",86),P(),S(4,"button",88),W("click",function(){return ne(t),re(p(3).accept())}),oe(5,89),P(),S(6,"button",90),W("click",function(){return ne(t),re(p(3).reject())}),oe(7,91),P()()}if(2&r){const t=p(3);_(2),x2(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),_(1),y("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function rMt(r,e){if(1&r&&(S(0,"div",92)(1,"p")(2,"span"),Gs(3,93),V(4,"fa-icon",86),Us(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.deniedRequest().get()].icon),Gn(t.requestInfos[t.deniedRequest().get()].name()),Kn(3)}}function iMt(r,e){if(1&r&&(S(0,"div",94)(1,"p")(2,"span"),Gs(3,95),V(4,"fa-icon",86),Us(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),Gn(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),Kn(3)}}function sMt(r,e){if(1&r&&(Gt(0),O(1,tMt,6,3,"ng-container",37),O(2,nMt,8,2,"ng-template",null,77,dn),O(4,rMt,5,2,"div",78),O(5,iMt,5,2,"div",79),Ut()),2&r){const t=un(3),n=p(2);_(1),y("ngIf",!1===n.mustReply())("ngIfElse",t),_(3),y("ngIf",n.deniedRequest().isPresent()),_(1),y("ngIf",n.requestAwaitingReplyFromOpponent().isPresent())}}function oMt(r,e){1&r&&(S(0,"button",96),oe(1,97),P())}function aMt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"div",9),O(3,kyt,4,2,"div",10),S(4,"div",11),O(5,xyt,2,2,"p",12),O(6,Lyt,2,1,"p",13),S(7,"app-count-down",14,15),W("outOfTimeAction",function(){ne(t);const i=p();return re(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return ne(t),re(p().addGlobalTime())}),P(),S(9,"app-count-down",16,17),W("outOfTimeAction",function(){ne(t);const i=p();return re(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return ne(t),re(p().addTurnTime())}),P()(),S(11,"p",18),oe(12,19),P(),S(13,"div",11),O(14,Ryt,2,2,"p",20),O(15,zyt,2,1,"p",21),S(16,"app-count-down",22,23),W("outOfTimeAction",function(){ne(t);const i=p();return re(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return ne(t),re(p().addGlobalTime())}),P(),S(18,"app-count-down",24,25),W("outOfTimeAction",function(){ne(t);const i=p();return re(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return ne(t),re(p().addTurnTime())}),P()(),V(20,"hr"),O(21,Jyt,7,5,"div",26),O(22,sMt,6,4,"ng-container",27),O(23,oMt,2,0,"button",28),P()(),S(24,"div",29)(25,"div",30),V(26,"div",null,31),P()()()}if(2&r){const t=p();_(3),y("ngIf",null!==t.currentPart),_(2),y("ngIf",t.players[0].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(5),y("ngIf",t.players[1].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(3),y("ngIf",t.endGame&&null!==t.currentPart),_(1),y("ngIf",t.isPlaying()),_(1),y("ngIf",t.endGame),_(1),y("ngClass",t.getBoardHighlight())}}let cMt=(()=>{class r{}return u(r,"NO_MATCHING_PART",()=>$localize`The game you tried to join does not exist.`),r})(),AR=(ju=class extends fy{constructor(e,t,n,i,s,o,a,c,l,f){super(e,t,n,i),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"gameService",void 0),u(this,"gameEventService",void 0),u(this,"timeManager",void 0),u(this,"requestManager",void 0),u(this,"chronoZeroGlobal",void 0),u(this,"chronoOneGlobal",void 0),u(this,"chronoZeroTurn",void 0),u(this,"chronoOneTurn",void 0),u(this,"currentPart",null),u(this,"currentPartId",void 0),u(this,"gameStarted",!1),u(this,"opponent",null),u(this,"authUser",void 0),u(this,"currentPlayer",null),u(this,"configRoom",void 0),u(this,"currentGame",g.empty()),u(this,"userLinkedToThisPart",!0),u(this,"routerEventsSubscription",void 0),u(this,"userSubscription",void 0),u(this,"opponentSubscription",new En),u(this,"partSubscription",new En),u(this,"gameEventsSubscription",new En),u(this,"currentGameSubscription",new En),u(this,"OFFLINE_FONT_COLOR",{color:"lightgrey"}),u(this,"globalTimeMessage",$localize`5 minutes`),u(this,"turnTimeMessage",$localize`30 seconds`),u(this,"requestInfos",$4e.requestInfos),u(this,"allRequests",["TakeBack","Draw","Rematch"]),this.currentGameService=s,this.userService=o,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=f}extractPartIdFromURL(){return B.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return B.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return M(function*(){const t=e.extractGameNameFromURL();if(Uu.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const s=cMt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",s],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=j0.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return M(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=M(function*(n){n instanceof el&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=M(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return M(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=g.empty()})()}startGame(e){var t=this;return M(function*(){B.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(M(function*(){const n=yield t.afterViewInit();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),B.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),yield t.startPart()}),2)})()}startPart(){var e=this;return M(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new Tv(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=M(function*(i){B.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new Tv(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return M(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();B.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new XCt,n=function(){var i=M(function*(s){yield t.runExclusive(M(function*(){const o=s.filter(c=>"Move"===c.eventType).length;let a=0;e.beforeEventsBatch();for(const c of s)switch(c.eventType){case"Move":const l=a+1===o;yield e.onReceivedMove(c,l),a+=1;break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":(yield e.requestManager.onReceivedReply(c,e.role))&&(yield e.handleReply(c));break;default:B.expectToBe(c.eventType,"Action","Event should be an action"),e.timeManager.onReceivedAction(c),"EndGame"===c.action?yield e.onGameEnd():"StartGame"===c.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(o){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return M(function*(){switch(e.requestType){case"TakeBack":const n=k.of(e.player);yield t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.extractGameNameFromURL();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return M(function*(){yield e.currentGameService.removeCurrentGame(),e.gameComponent.setInteractive(!1),e.endGame=!0})()}onReceivedMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules,s=n.gameComponent.getTurn(),o=n.gameComponent.encoder.decode(e.move),a=i.isLegal(o,n.gameComponent.getState()),c="We received an incorrect db move: "+o.toString()+" at turn "+s+'because "'+a.getReasonOr("")+'"';B.assert(a.isSuccess(),c);const l=i.choose(n.gameComponent.node,o);if(B.assert(l.isSuccess(),"Chosen move should be legal after all checks, but it is not! Reason: "+l.getReasonOr("")),n.gameComponent.node=l.get(),n.role===q.NONE)yield n.updateBoardAndShowLastMove(t);else{const f=s%2!==n.role.value;yield n.updateBoardAndShowLastMove(f&&t)}n.setCurrentPlayerAccordingToCurrentTurn(),n.timeManager.onReceivedMove(e),n.requestManager.onReceivedMove()})()}setCurrentPlayerAccordingToCurrentTurn(){this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.setInteractive(this.currentPlayer.name===this.getPlayer().name)}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return M(function*(){const t=k.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.node.parent.get(),t.gameComponent.getCurrentPlayer()!==e&&(B.assert(t.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),t.gameComponent.node=t.gameComponent.node.parent.get()),t.setCurrentPlayerAccordingToCurrentTurn();const n=0===t.gameComponent.getTurn();yield t.updateBoardAndShowLastMove(n)})()}canResign(){return B.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return B.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return B.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return B.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return B.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return B.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),B.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||B.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return B.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return M(function*(){t.players=[g.of(e.data.playerZero),g.ofNullable(e.data.playerOne)],B.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.setCurrentPlayerAccordingToCurrentTurn();const n=yield t.setRealObserverRole();if(n.isPresent()){const i=s=>{B.assert(s.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=n.get()};t.opponentSubscription=t.userService.observeUserOnServer(n.get().id,i)}})()}setRealObserverRole(){var e=this;return M(function*(){let t=g.empty();return e.players[0].equalsValue(e.getPlayer())?(yield e.setRole(k.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(yield e.setRole(k.ONE),t=e.players[0]):yield e.setRole(q.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===q.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return M(function*(){if(!t.mustReply()){const n=t.gameComponent.rules.isLegal(e,t.gameComponent.node.gameState);B.assert(n.isSuccess(),"onLegalUserMove called with an illegal move");const i=t.gameComponent.rules.applyLegalMove(e,t.gameComponent.node.gameState,n.get()),s=new Qo(i,g.of(t.gameComponent.node),g.of(e)),o=t.gameComponent.rules.getGameStatus(s),a=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,a),t.updatePartWithStatusAndScores(o,t.gameComponent.scores)}t.gameComponent.message(j0.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var n=this;return M(function*(){return e.isEndGame?e===_e.DRAW?yield n.gameService.drawPart(n.currentPartId,n.role,t):(B.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePart(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return M(function*(){const i=n.role;yield n.gameService.notifyTimeout(n.currentPartId,i,e,t)})()}notifyVictory(e,t){var n=this;return M(function*(){const i=B.getNonNullable(n.currentPart),s=n.players[0].get(),o=n.players[1].get();n.currentPart=e===k.ONE?i.setWinnerAndLoser(o,s):i.setWinnerAndLoser(s,o);const a=n.role;yield n.gameService.endPartWithVictory(n.currentPartId,a,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return M(function*(){const t=e.role,n=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,i,n)})()}reachedOutOfTime(e){var t=this;return M(function*(){if(!1===t.isPlaying())return;const n=B.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return M(function*(){B.assert(t.role.isPlayer(),"cannot propose request if not player");const n=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,n);case"Draw":return t.gameService.proposeDraw(t.currentPartId,n);default:return B.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,n)}})()}accept(){var e=this;return M(function*(){B.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=B.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n,t);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return B.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return M(function*(){B.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,n=e.requestManager.getCurrentRequest().get().requestType;switch(n){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return B.expectToBe(n,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===k.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}ngOnDestroy(){var e=this;return M(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}},u(ju,"\u0275fac",function(e){return new(e||ju)(U(qs),U(ur),U(Un),U($t),U(ys),U(iu),U(ou),U(ox),U(JCt),U($4e))}),u(ju,"\u0275cmp",Be({type:ju,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(G4(Pyt,5),G4(Oyt,5),G4(Tyt,5),G4(byt,5)),2&e){let n;x3(n=L3())&&(t.chronoZeroGlobal=n.first),x3(n=L3())&&(t.chronoOneGlobal=n.first),x3(n=L3())&&(t.chronoZeroTurn=n.first),x3(n=L3())&&(t.chronoOneTurn=n.first)}},features:[Ke],decls:5,vars:4,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,E,w,R,z,$,G,de,Ce,Le,tt,gt,yn;return r=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,n=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Draw`,a=$localize`You agreed to draw.`,c=$localize`Your draw proposal has been accepted.`,l=$localize`Players agreed to draw.`,f=$localize`You won.`,d=$localize`You lost.`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,R=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,z=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,G=$localize`Resign`,de=$localize`Pass a turn`,Ce=$localize`Accept`,Le=$localize`Reject`,tt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,gt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,yn=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],r,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],n,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],o,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],a,["id","yourOpponentAgreedToDrawIndicator",1,"title"],c,["id","playersAgreedToDraw",1,"title"],l,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],d,[1,"title"],m,E,w,R,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],z,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],G,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],de,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],Ce,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],Le,["id","requestRejected",1,"notification","is-danger"],tt,["id","requestAwaitingReply",1,"notification"],gt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],yn]},template:function(e,t){1&e&&(O(0,wyt,2,1,"app-part-creation",0),O(1,aMt,28,25,"div",1),S(2,"div",2)(3,"div",3),V(4,"app-chat",4),P()()),2&e&&(y("ngIf",!1===t.gameStarted),_(1),y("ngIf",t.gameStarted),_(3),y("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[Dt,Wt,wt,Ic,x0,dy,wR,NR],encapsulation:2})),ju);var Zl,IR;function uMt(r,e){if(1&r&&(S(0,"option",26),ct(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),mn(t.name)}}function fMt(r,e){if(1&r&&(S(0,"option",26),oe(1,30),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),Gn(t.name),Kn(1)}}function dMt(r,e){if(1&r){const t=pe();S(0,"select",27),W("ngModelChange",function(i){return ne(t),re(p(2).aiOptions[0]=i)})("change",function(){ne(t);const i=p(2);return re(i.updatePlayer(i.Player.ZERO))}),S(1,"option",28),oe(2,29),P(),O(3,fMt,2,2,"option",17),P()}if(2&r){const t=p(2);y("ngModel",t.aiOptions[0]),_(3),y("ngForOf",t.availableAIOptions(0))}}function hMt(r,e){if(1&r&&(S(0,"p",31),oe(1,32),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[0]),Kn(1)}}function pMt(r,e){if(1&r&&(S(0,"option",26),ct(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),mn(t.name)}}function gMt(r,e){if(1&r&&(S(0,"option",26),oe(1,35),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),Gn(t.name),Kn(1)}}function mMt(r,e){if(1&r){const t=pe();S(0,"select",33),W("ngModelChange",function(i){return ne(t),re(p(2).aiOptions[1]=i)})("change",function(){ne(t);const i=p(2);return re(i.updatePlayer(i.Player.ONE))}),S(1,"option",28),oe(2,34),P(),O(3,gMt,2,2,"option",17),P()}if(2&r){const t=p(2);y("ngModel",t.aiOptions[1]),_(3),y("ngForOf",t.availableAIOptions(1))}}function _Mt(r,e){if(1&r&&(S(0,"p",36),oe(1,37),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[1]),Kn(1)}}function vMt(r,e){if(1&r&&(S(0,"h4",41),ct(1),P()),2&r){const t=p(3);_(1),mn(t.winnerMessage.get())}}function CMt(r,e){1&r&&(S(0,"h4",42),oe(1,43),P())}function yMt(r,e){if(1&r&&(S(0,"div",38),O(1,vMt,2,1,"h4",39),O(2,CMt,2,0,"h4",40),P()),2&r){const t=p(2);_(1),y("ngIf",t.winnerMessage.isPresent()),_(1),y("ngIf",t.winnerMessage.isAbsent())}}function MMt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"p",9),oe(3,10),P()(),S(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),W("change",function(){ne(t);const i=p();return re(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return ne(t),re(p().playerSelection[0]=i)}),S(8,"option",15),oe(9,16),P(),O(10,uMt,2,2,"option",17),P()(),S(11,"div",13),O(12,dMt,4,2,"select",18),P(),O(13,hMt,2,1,"p",19),P(),S(14,"div",20)(15,"div",13)(16,"select",21),W("change",function(){ne(t);const i=p();return re(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return ne(t),re(p().playerSelection[1]=i)}),S(17,"option",15),oe(18,22),P(),O(19,pMt,2,2,"option",17),P()(),S(20,"div",13),O(21,mMt,4,2,"select",23),P(),O(22,_Mt,2,1,"p",24),P()(),O(23,yMt,3,2,"div",25),P()}if(2&r){const t=p();_(3),Gn(t.gameComponent.getTurn()+1),Kn(3),_(4),y("ngModel",t.playerSelection[0]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[0].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(3),y("ngModel",t.playerSelection[1]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[1].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(1),y("ngIf",t.endGame)}}function EMt(r,e){if(1&r){const t=pe();S(0,"button",50),W("click",function(){return ne(t),re(p(2).gameComponent.pass())}),oe(1,51),P()}}function SMt(r,e){if(1&r){const t=pe();S(0,"button",52),W("click",function(){return ne(t),re(p(2).takeBack())}),oe(1,53),P()}}function PMt(r,e){if(1&r&&(Gt(0),ct(1),V(2,"br"),Ut()),2&r){const t=e.$implicit,n=p(3);_(1),x2(" ",t.name+": "+t.getInfo(n.gameComponent.node)," ")}}function OMt(r,e){if(1&r&&(S(0,"div",54),O(1,PMt,3,1,"ng-container",55),ct(2),V(3,"br"),ct(4),V(5,"br"),P()),2&r){const t=p(2);_(1),y("ngForOf",t.gameComponent.availableAIs),_(1),x2(" Created ",t.getCreatedNodes()," nodes."),_(2),x2(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function TMt(r,e){if(1&r){const t=pe();S(0,"div",44),O(1,EMt,2,0,"button",45),O(2,SMt,2,0,"button",46),S(3,"button",47),W("click",function(){return ne(t),re(p().restartGame())}),oe(4,48),P(),O(5,OMt,6,3,"div",49),P()}if(2&r){const t=p();_(1),y("ngIf",!1===t.endGame&&t.gameComponent.canPass),_(1),y("ngIf",t.canTakeBack()),_(3),y("ngIf",t.gameComponent.node.previousMove.isPresent()&&t.displayAIInfo())}}AR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],AR);let kR=(IR=Zl=class extends fy{constructor(e,t,n,i,s){super(e,t,n,i),u(this,"cdr",void 0),u(this,"aiOptions",["none","none"]),u(this,"playerSelection",["human","human"]),u(this,"winnerMessage",g.empty()),u(this,"displayAIMetrics",!1),this.cdr=s,this.players=[g.of(this.playerSelection[0]),g.of(this.playerSelection[1])],this.role=k.ZERO}getCreatedNodes(){return Iae.createdNodes}getMinimaxTime(){return gft.aiTime}ngAfterViewInit(){var e=this;window.setTimeout(M(function*(){(yield e.afterViewInit())&&(yield e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){var t=this;return M(function*(){t.players[e.value]=g.of(t.playerSelection[e.value]),"human"===t.playerSelection[1]&&"human"!==t.playerSelection[0]?(t.gameComponent.setInteractive(!1),yield t.setRole(k.ONE)):(t.gameComponent.setInteractive(!0),yield t.setRole(k.ZERO)),yield t.proposeAIToPlay()})()}onLegalUserMove(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e).get(),yield t.proposeAIToPlay()})()}updateBoard(e){var t=this;return M(function*(){yield t.updateBoardAndShowLastMove(e);const n=t.gameComponent.rules.getGameStatus(t.gameComponent.node);if(!0===n.isEndGame&&(t.endGame=!0,n.winner.isPlayer())){const i=$localize`Player ${n.winner.value+1}`,o=n.winner.getOpponent().value;t.winnerMessage=t.players[n.winner.value].equalsValue("human")?t.players[o].equalsValue("human")?g.of($localize`${i} won`):g.of($localize`You won`):t.players[o].equalsValue("human")?g.of($localize`You lost`):g.of($localize`${t.players[n.winner.value].get()} (Player ${n.winner.value+1}) won`)}})()}proposeAIToPlay(){var e=this;return M(function*(){if(e.hasSelectedAI()){e.gameComponent.setInteractive(!1),yield e.updateBoard(!1);const t=e.getPlayingAI();t.isPresent()&&window.setTimeout(M(function*(){yield e.doAIMove(t.get().ai,t.get().options)}),IR.AI_TIMEOUT)}else e.gameComponent.setInteractive(!0),yield e.updateBoard(!1),e.cdr.detectChanges()})()}hasSelectedAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return!1;const e=this.gameComponent.getTurn()%2;return"human"!==this.playerSelection[e]}getPlayingAI(){const e=this.gameComponent.getTurn()%2,t=this.findAI(e);if(t.isPresent()){const n=t.get(),i=this.aiOptions[e];return g.ofNullable(n.availableOptions.find(o=>o.name===i)).map(o=>({ai:n,options:o}))}return g.empty()}findAI(e){return g.ofNullable(this.gameComponent.availableAIs.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules;je(i.getGameStatus(n.gameComponent.node)===_e.ONGOING,"AI should not try to play when game is over!");const o=e.chooseNextMove(n.gameComponent.node,t),a=i.choose(n.gameComponent.node,o);return a.isSuccess()?(n.gameComponent.node=a.get(),yield n.updateBoard(!0),n.cdr.detectChanges(),yield n.proposeAIToPlay(),b.SUCCESS):(n.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),m2.logError("LocalGameWrapper","AI chose illegal move",{game:n.getGameName(),name:e.name,move:o.toString(),reason:a.getReason()}))})()}availableAIOptions(e){return this.findAI(e).get().availableOptions}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.node.parent.get(),e.isAITurn()&&(B.assert(e.gameComponent.node.parent.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),e.gameComponent.node=e.gameComponent.node.parent.get()),yield e.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.rules.getInitialNode(),e.endGame=!1,e.winnerMessage=g.empty(),yield e.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}displayAIInfo(){return"true"===localStorage.getItem("displayAIInfo")}},u(Zl,"AI_TIMEOUT",1),u(Zl,"\u0275fac",function(e){return new(e||Zl)(U(qs),U(ur),U(Un),U($t),U(R3))}),u(Zl,"\u0275cmp",Be({type:Zl,selectors:[["app-local-game-wrapper"]],features:[Ke],decls:8,vars:3,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m;return r=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,n=$localize`Pick the options`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the options`,a=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`Draw`,f=$localize`Start a new game`,d=$localize`Pass a turn`,m=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],r,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change"],["selected","","value","none"],n,i,["id","scoreOne",1,"block"],s,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change"],o,a,["id","scoreZero",1,"block"],c,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],l,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIInfo",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","AIInfo"],[4,"ngFor","ngForOf"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1),O(2,MMt,24,10,"div",2),O(3,TMt,6,3,"div",3),P(),S(4,"div",4)(5,"div",5),V(6,"div",null,6),P()()()),2&e&&(_(2),y("ngIf",t.gameComponent),_(1),y("ngIf",t.gameComponent),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Dt,Wt,wt,mf,_f,Ng,V3,gf],encapsulation:2,changeDetection:0})),Zl);kR=IR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],kR);let B4e=(()=>{class r{}return u(r,"STEP_FINISHED",()=>$localize`Step finished!`),u(r,"INFORMATIONAL_STEP",()=>$localize`This step is not expecting any move from your part.`),r})();var Zu;function wMt(r,e){if(1&r&&(S(0,"div",21)(1,"div",22),oe(2,23),P(),V(3,"div",24),P()),2&r){const t=p();_(3),y("innerHTML",t.currentReason.get(),b7)}}function NMt(r,e){if(1&r){const t=pe();S(0,"button",25),W("click",function(){return ne(t),re(p().retry())}),oe(1,26),P()}}function AMt(r,e){1&r&&(Gt(0),oe(1,31),Ut())}function IMt(r,e){1&r&&(Gt(0),oe(1,32),Ut())}function kMt(r,e){if(1&r&&O(0,IMt,2,0,"ng-container",28),2&r){p();const t=un(5),n=p();y("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function xMt(r,e){1&r&&(Gt(0),oe(1,33),Ut())}function LMt(r,e){if(1&r){const t=pe();S(0,"button",27),W("click",function(){return ne(t),re(p().next())}),O(1,AMt,2,0,"ng-container",28),O(2,kMt,1,2,"ng-template",null,29,dn),O(4,xMt,2,0,"ng-template",null,30,dn),P()}if(2&r){const t=un(3),n=p();_(1),y("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function RMt(r,e){if(1&r){const t=pe();S(0,"button",34),W("click",function(){return ne(t),re(p().start())}),oe(1,35),P()}}function zMt(r,e){if(1&r){const t=pe();S(0,"button",36),W("click",function(){return ne(t),re(p().playLocally())}),oe(1,37),P()}}function DMt(r,e){if(1&r){const t=pe();S(0,"button",38),W("click",function(){return ne(t),re(p().createGame())}),oe(1,39),P()}}function HMt(r,e){if(1&r){const t=pe();S(0,"button",40),W("click",function(){return ne(t),re(p().showSolution())}),oe(1,41),P()}}function VMt(r,e){if(1&r&&(Gt(0),S(1,"option",43),ct(2),P(),Ut()),2&r){const t=p(),n=t.index,i=t.$implicit;_(1),Dn("id","step_",n,""),y("value",n),_(1),mn(i.title)}}function FMt(r,e){1&r&&(Gt(0),ct(1,"v "),Ut())}function $Mt(r,e){1&r&&ct(0,"x ")}function BMt(r,e){if(1&r&&(S(0,"option",44),O(1,FMt,2,0,"ng-container",28),O(2,$Mt,1,0,"ng-template",null,45,dn),S(4,"span",46),ct(5),P()()),2&r){const t=un(3),n=p(),i=n.index,s=n.$implicit,o=p();y("value",i),_(1),y("ngIf",o.stepFinished[i])("ngIfElse",t),_(3),Dn("id","step_",i,""),_(1),mn(s.title)}}function GMt(r,e){if(1&r&&(Gt(0),O(1,VMt,3,3,"ng-container",28),O(2,BMt,6,5,"ng-template",null,42,dn),Ut()),2&r){const t=e.index,n=un(3),i=p();_(1),y("ngIf",t===i.stepIndex)("ngIfElse",n)}}let xR=(Zu=class extends fy{constructor(e,t,n,i,s){super(e,s,t,n),u(this,"cdr",void 0),u(this,"COMPLETED_TUTORIAL_MESSAGE",$localize`Congratulations, you completed the tutorial.`),u(this,"steps",[]),u(this,"successfulSteps",0),u(this,"stepIndex",-1),u(this,"currentMessage",""),u(this,"currentReason",g.empty()),u(this,"moveAttemptMade",!1),u(this,"stepFinished",[]),u(this,"tutorialOver",!1),this.cdr=i,this.role=k.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return M(function*(){(yield e.afterViewInit())&&(yield e.start())})()}start(){var e=this;return M(function*(){const t=e.gameComponent.tutorial;yield e.startTutorial(t)})()}startTutorial(e){var t=this;return M(function*(){t.steps=e,t.tutorialOver=!1,t.stepFinished=t.getCompletionArray(),t.successfulSteps=0,yield t.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){var t=this;return M(function*(){const n=e.target;yield t.showStep(Number.parseInt(n.value,10))})()}showStep(e){var t=this;return M(function*(){t.moveAttemptMade=!1,t.stepFinished[e]=!1,t.updateSuccessCount(),t.stepIndex=e;const n=t.steps[t.stepIndex];t.currentMessage=n.instruction,t.currentReason=g.empty(),t.gameComponent.node=new Qo(n.state,g.empty(),n.previousMove),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.gameComponent.setInteractive(!1===n.isInformation()),t.cdr.detectChanges()})()}onLegalUserMove(e){var t=this;return M(function*(){const n=t.steps[t.stepIndex],i=t.gameComponent.rules.choose(t.gameComponent.node,e);if(B.assert(i.isSuccess(),"It should be impossible to call onLegalUserMove with an illegal move, but got "+i.getReasonOr("")),t.gameComponent.node=i.get(),yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,n.isPredicate()){const s=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),a=B.getNonNullable(n.predicate)(e,s,o);a.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=g.of(a.getReason())}else if(n.isAnyMove())Ae.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const s=n;s.acceptedMoves.some(o=>o.equals(e))?(Ae.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(Ae.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=g.of(s.getFailureMessage()))}else B.assert(n.isClick(),"Here, we should have a click");t.cdr.detectChanges()})()}retry(){var e=this;return M(function*(){e.moveAttemptMade=!1,yield e.showStep(e.stepIndex)})()}canUserPlay(e){var t=this;return M(function*(){if(t.currentReason=g.empty(),t.stepFinished[t.stepIndex]||t.moveAttemptMade)return b.failure(B4e.STEP_FINISHED());const n=t.steps[t.stepIndex];return n.isClick()?(yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,B.getNonNullable(n.acceptedClicks).some(i=>i===e)?t.showStepSuccess(n.getSuccessMessage()):t.currentMessage=n.getFailureMessage(),b.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?b.SUCCESS:b.failure(B4e.INFORMATIONAL_STEP())})()}onCancelMove(e){var t=this;return M(function*(){void 0!==e&&(t.currentReason=g.of(e)),t.cdr.detectChanges()})()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){var e=this;return M(function*(){if(e.steps[e.stepIndex].isInformation()&&(e.stepFinished[e.stepIndex]=!0,e.updateSuccessCount()),e.stepFinished.length===e.successfulSteps)e.currentMessage=e.COMPLETED_TUTORIAL_MESSAGE,e.tutorialOver=!0;else{let t=(e.stepIndex+1)%e.steps.length;for(;!0===e.stepFinished[t];)t=(t+1)%e.steps.length;yield e.showStep(t)}})()}showSolution(){var e=this;return M(function*(){const t=e.steps[e.stepIndex];B.assert(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution();i instanceof vi?(yield e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),yield e.updateBoardAndShowLastMove(!0)):(yield e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return M(function*(){const t=B.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return M(function*(){const t=B.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}},u(Zu,"\u0275fac",function(e){return new(e||Zu)(U(qs),U(Un),U($t),U(R3),U(ur))}),u(Zu,"\u0275cmp",Be({type:Zu,selectors:[["app-tutorial-game-wrapper"]],features:[Ke],decls:23,vars:15,consts:function(){let r,e,t,n,i,s,o,a,c;return r=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,n=$localize`Continue`,i=$localize`Skip`,s=$localize`Try again`,o=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],r,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,n,i,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1)(2,"div",2),V(3,"progress",3),S(4,"div",4)(5,"p",5),ct(6),P(),V(7,"p",6),P(),O(8,wMt,4,1,"div",7),S(9,"div",8),O(10,NMt,2,0,"button",9),O(11,LMt,6,2,"button",10),O(12,RMt,2,0,"button",11),O(13,zMt,2,0,"button",12),O(14,DMt,2,0,"button",13),O(15,HMt,2,0,"button",14),S(16,"div",15)(17,"select",16),W("change",function(i){return t.changeStep(i)}),O(18,GMt,4,2,"ng-container",17),P()()()()(),S(19,"div",18)(20,"div",19),V(21,"div",null,20),P()()()),2&e&&(_(3),I("value",t.successfulSteps)("max",t.getNumberOfSteps()),_(3),PE("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),_(1),y("innerHTML",t.currentMessage,b7),_(1),y("ngIf",t.currentReason.isPresent()),_(2),y("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),_(1),y("ngIf",!1===t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),_(3),y("ngForOf",t.steps),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Dt,Wt,wt,mf,_f],encapsulation:2,changeDetection:0})),Zu);function UMt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),oe(2,37),P(),S(3,"div",38),ct(4),P()()),2&r){const t=p();_(4),mn(t.errorMessage)}}xR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ae.log],xR);const WMt=function(){return["/login"]};let qMt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"faEye",nL),u(this,"errorMessage",void 0),u(this,"registrationForm",new K4({email:new yo,username:new yo,password:new yo})),this.connectedUserService=n,this.router=i}registerWithEmail(){var n=this;return M(function*(){const i=n.registrationForm.value.username,s=n.registrationForm.value.email,o=n.registrationForm.value.password;if(null==i||null==s||null==o)n.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const a=yield n.connectedUserService.doRegister(i,s,o);if(a.isSuccess()){const c=yield n.connectedUserService.sendEmailVerification();c.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=c.getReason()}else n.errorMessage=a.getReason()}})()}registerWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=i.getReason()})()}getPasswordHelpClass(){const n=this.registrationForm.value.password;return null==n||""===n?"":n.length<6?"is-danger":"is-success"}canRegister(){const n=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===n||n.length<6)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(ur),U(Un))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,o=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,f=$localize`The password should be at least 6 characters long`,d=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,w=$localize`Log in`,R=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],o,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],f,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],d,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],R,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),S(12,"p",12),oe(13,13),P()()()()(),S(14,"div",4)(15,"div",5)(16,"label",14),oe(17,15),P()(),S(18,"div",8)(19,"div",9)(20,"div",10),V(21,"input",16),P()()()(),S(22,"div",4)(23,"div",5)(24,"label",17),oe(25,18),P()(),S(26,"div",8)(27,"div",9)(28,"div",19),V(29,"input",20),S(30,"span",21),V(31,"fa-icon",22),P(),S(32,"p",23),oe(33,24),P()()()()(),S(34,"div",4),V(35,"div",5),S(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),W("click",function(){return i.registerWithEmail()}),oe(40,26),P()()()()(),S(41,"div",4),V(42,"div",5),S(43,"div",27),O(44,UMt,5,1,"div",28),P()(),S(45,"div",4),V(46,"div",5),S(47,"div",8)(48,"button",29),W("click",function(){return i.registerWithGoogle()}),oe(49,30),P()()(),S(50,"p",31),Gt(51),oe(52,32),Ut(),ct(53,"\xa0 "),S(54,"a",33),oe(55,34),P()()()()),2&n&&(_(3),y("formGroup",i.registrationForm),_(28),y("icon",i.faEye),_(1),y("ngClass",i.getPasswordHelpClass()),_(7),y("disabled",!i.canRegister()),_(5),y("ngIf",i.errorMessage),_(10),y("routerLink",D1(6,WMt)))},dependencies:[Dt,wt,Ic,T6,bc,V3,P6,N6,b6,Y8,x0,TR,D4e],encapsulation:2})),e})(),jMt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}playLocally(){var n=this;return M(function*(){yield n.router.navigate(["local/"+n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.playLocally()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[OR],encapsulation:2})),e})(),ZMt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}launchTutorial(){var n=this;return M(function*(){yield n.router.navigate(["/tutorial/",n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Un))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.launchTutorial()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[OR],encapsulation:2})),e})(),YMt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),oe(1,0),P())},encapsulation:2})),e})();var LR,RR,dh,zR;function XMt(r,e){if(1&r&&(A(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessQueenComponent.HEPTAGON)}}function QMt(r,e){if(1&r&&(A(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function JMt(r,e){if(1&r&&(A(),V(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function eEt(r,e){if(1&r&&(Gt(0),A(),V(1,"circle",6)(2,"circle",6)(3,"circle",6),Ut()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function tEt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"circle",7)(2,"circle",7)(3,"circle",7),P()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function nEt(r,e){if(1&r&&(A(),S(0,"g",8),V(1,"circle",9)(2,"circle",9)(3,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class Yl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessQueenComponent",Yl),u(this,"MartianChessComponent",xs),u(this,"horizontalDotsRadius",xs.SPACE_SIZE/15)}}function iEt(r,e){if(1&r&&(A(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessDroneComponent.PENTAGON)}}function sEt(r,e){if(1&r&&(A(),V(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function oEt(r,e){if(1&r&&(A(),V(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function aEt(r,e){if(1&r&&(Gt(0),A(),V(1,"circle",6)(2,"circle",6),Ut()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function cEt(r,e){if(1&r&&(A(),S(0,"g",7),V(1,"circle",8)(2,"circle",8),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function lEt(r,e){if(1&r&&(A(),S(0,"g",7),V(1,"circle",9)(2,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}LR=Yl,u(Yl,"HEPTAGON",xs.getRegularPolygon(7)),u(Yl,"EIGHT_POINTED_STAR",xs.getNPointedStar(8,0)),u(Yl,"\u0275fac",function(e){return new(e||LR)}),u(Yl,"\u0275cmp",Be({type:LR,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(O(0,XMt,1,3,"polygon",0),O(1,QMt,1,3,"polygon",0),O(2,JMt,1,5,"circle",1),O(3,eEt,4,9,"ng-container",2),O(4,tEt,4,9,"g",2),O(5,nEt,4,10,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Dt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Kl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",xs),u(this,"MartianChessDroneComponent",Kl),u(this,"horizontalDotsRadius",xs.SPACE_SIZE/15)}}function fEt(r,e){if(1&r&&(A(),V(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessPawnComponent.TRIANGLE)}}function dEt(r,e){if(1&r&&(A(),V(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function hEt(r,e){if(1&r&&(A(),V(0,"circle",6)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function pEt(r,e){if(1&r&&(A(),V(0,"circle",7)),2&r){const t=p();I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function gEt(r,e){if(1&r&&(A(),V(0,"circle",8)),2&r){const t=p();I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function mEt(r,e){if(1&r&&(A(),S(0,"g",9),V(1,"circle",10),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}RR=Kl,u(Kl,"FOUR_POINTED_STAR_VERTICAL",xs.getNPointedStar(4,0)),u(Kl,"PENTAGON",xs.getRegularPolygon(5)),u(Kl,"\u0275fac",function(e){return new(e||RR)}),u(Kl,"\u0275cmp",Be({type:RR,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(O(0,iEt,1,3,"polygon",0),O(1,sEt,1,3,"polygon",0),O(2,oEt,1,5,"circle",1),O(3,aEt,3,6,"ng-container",2),O(4,cEt,3,7,"g",3),O(5,lEt,3,7,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Dt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class cc{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",xs),u(this,"MartianChessPawnComponent",cc),u(this,"horizontalDotsRadius",xs.SPACE_SIZE/15)}static getTriangle(){return xs.getRegularPolygon(3,cc.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=xs.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?cc.TRIANGLE_Y_OFFSET:0}}function vEt(r,e){if(1&r&&(A(),V(0,"text",8)),2&r){const t=p();zi("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("innerHTML",t.coord.z,b7)}}function CEt(r,e){if(1&r&&(A(),V(0,"polyline",9)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getUpperHorizontalLine())}}function yEt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"polyline",10)(2,"polyline",11),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),I("points",t.getMiddleHorizontalLine()),_(1),y("ngClass",t.pieceClasses),I("points",t.getLowerHorizontalLine())}}function MEt(r,e){if(1&r&&(A(),V(0,"polyline",12)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getLeftDiagonalLine())}}function EEt(r,e){if(1&r&&(A(),S(0,"g"),V(1,"polyline",13)(2,"polyline",14),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),I("points",t.getMiddleDiagonalLine()),_(1),y("ngClass",t.pieceClasses),I("points",t.getRighterDiagonalLine())}}function SEt(r,e){if(1&r&&(A(),V(0,"polyline",15)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getLeftVerticalLine())}}function PEt(r,e){if(1&r&&(A(),V(0,"polyline",16)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getMiddleVerticalLine())}}function OEt(r,e){if(1&r&&(A(),V(0,"polyline",17)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getRighterVerticalLine())}}dh=cc,u(cc,"FOUR_POINTED_STAR_DIAGONAL",xs.getNPointedStar(4,45)),u(cc,"TRIANGLE_Y_OFFSET",dh.yOffsetForVerticalCentering()),u(cc,"TRIANGLE",dh.getTriangle()),u(cc,"\u0275fac",function(e){return new(e||dh)}),u(cc,"\u0275cmp",Be({type:dh,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(O(0,fEt,1,3,"polygon",0),O(1,dEt,1,3,"polygon",0),O(2,hEt,1,5,"circle",1),O(3,pEt,1,3,"circle",2),O(4,gEt,1,3,"circle",3),O(5,mEt,2,4,"g",4)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Dt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class hh{constructor(){u(this,"coord",void 0),u(this,"move",void 0),u(this,"pieceClasses",void 0),u(this,"mode",void 0),u(this,"mustDisplayHeight",void 0)}mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,s=e,a=e-n,c=t,l=-n,f=t;return[new v(0,0),new v(s,0),new v(l,f),new v(a,c),new v(s,0+i),new v(l,f+i),new v(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],s=new St(-1*this.mode.offsetRatio*Bn.STROKE_WIDTH,Bn.STROKE_WIDTH),o=t.getNext(s),a=n.getNext(s);return[t,n,a,o]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],s=new St(-1*this.mode.offsetRatio*Bn.STROKE_WIDTH,Bn.STROKE_WIDTH);return[t.getNext(s,-1),n.getNext(s,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new St(0,Bn.STROKE_WIDTH),s=t.getNext(i,-1),o=n.getNext(i,-1);return this.mapCoordToPoints([s,o,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],s=new St(Bn.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],s=new St(Bn.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],s=new St(0,Bn.STROKE_WIDTH),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],s=new St(Bn.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],s=new St(Bn.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],o=new St(Bn.STROKE_WIDTH,-Bn.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(o,-1),c=n.getNext(o,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){je(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}zR=hh,u(hh,"STROKE_OFFSET",Bn.STROKE_WIDTH/2),u(hh,"\u0275fac",function(e){return new(e||zR)}),u(hh,"\u0275cmp",Be({type:zR,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(A(),V(0,"polyline",0),O(1,vEt,1,4,"text",1),O(2,CEt,1,2,"polyline",2),O(3,yEt,3,4,"g",3),O(4,MEt,1,2,"polyline",4),O(5,EEt,3,4,"g",3),O(6,SEt,1,2,"polyline",5),O(7,PEt,1,2,"polyline",6),O(8,OEt,1,2,"polyline",7)),2&e&&(zi("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("ngClass",t.pieceClasses),I("points",t.get3DIsoSquarePoints()),_(1),y("ngIf",t.mustDisplayHeight),_(1),y("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[Dt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const ph_firebaseConfig={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let DR=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"userSubscription",void 0),this.connectedUserService=n}canActivate(){var n=this;return M(function*(){const i=yield new Promise(s=>{n.userSubscription=n.connectedUserService.subscribeToUser(function(){var o=M(function*(a){return s(yield n.evaluateUserPermission(a))});return function(a){return o.apply(this,arguments)}}())});return n.userSubscription.unsubscribe(),i})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ur))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Yu=(()=>{var r;class e extends DR{static evaluateUserPermission(n,i){return M(function*(){return!1===i.isConnected()?n.parseUrl("/login"):!1!==i.verified||n.parseUrl("/verify-account")})()}constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return e.evaluateUserPermission(i.router,n)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ur),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),HR=(()=>{var r;class e{constructor(n,i){u(this,"currentGameService",void 0),u(this,"router",void 0),u(this,"currentGameSubscription",g.empty()),this.currentGameService=n,this.router=i}canActivate(n){var i=this;return M(function*(){const s=yield i.currentGameService.getCurrentGame();if(s.isAbsent())return!0;const o=s.get();return n.params.id===o.id||i.router.parseUrl("/play/"+o.typeGame+"/"+o.id)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ys),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),TEt=(()=>{var r;class e extends DR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()?i.router.parseUrl("/login"):!n.verified||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ur),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),bEt=(()=>{var r;class e extends DR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Oe(ur),Oe(Un))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function wEt(r,e){1&r&&(S(0,"p",20),oe(1,21),P())}function NEt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"p",8),oe(2,9),P(),S(3,"div",10)(4,"p",11),oe(5,12),P(),S(6,"button",13),W("click",function(){return ne(t),re(p().finalizeEmailVerification())}),oe(7,14),P()(),S(8,"div",15)(9,"p",11),oe(10,16),P(),S(11,"button",17),W("click",function(){return ne(t),re(p().sendEmailVerification())}),oe(12,18),P()(),O(13,wEt,2,0,"p",19),P()}if(2&r){const t=p();_(2),Gn(t.emailAddress),Kn(2),_(11),y("ngIf",t.success)}}function AEt(r,e){if(1&r){const t=pe();S(0,"div",24)(1,"div",8),oe(2,25),P(),S(3,"form",26)(4,"div",27)(5,"div",28),V(6,"input",29),P(),S(7,"div",28)(8,"button",30),W("click",function(){ne(t);const i=p(2);return re(i.pickUsername(i.usernameForm.value))}),oe(9,31),P()()()()()}if(2&r){const t=p(2);_(3),y("formGroup",t.usernameForm)}}const IEt=function(){return["/lobby"]};function kEt(r,e){1&r&&(S(0,"div",32),Gs(1,33),V(2,"a",34),Us(),P()),2&r&&(_(2),y("routerLink",D1(1,IEt)))}function xEt(r,e){if(1&r&&(Gt(0),O(1,AEt,10,1,"div",22),O(2,kEt,3,2,"div",23),Ut()),2&r){const t=p();_(1),y("ngIf",!t.success),_(1),y("ngIf",t.success)}}function LEt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),ct(2),P()()),2&r){const t=p();_(2),mn(t.errorMessage)}}let REt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"verificationType",null),u(this,"success",!1),u(this,"triedToFinalize",!1),u(this,"errorMessage",void 0),u(this,"emailAddress",void 0),u(this,"userSubscription",void 0),u(this,"usernameForm",new K4({username:new yo})),this.connectedUserService=n,this.router=i}ngOnInit(){var n=this;return M(function*(){n.userSubscription=n.connectedUserService.subscribeToUser(function(){var i=M(function*(s){n.emailAddress=s.email.get(),s.username.isAbsent()?n.verificationType="enter-username":(n.verificationType="send-email",!0===n.triedToFinalize&&!1===s.verified&&(n.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield n.router.navigate(["/lobby"])))});return function(s){return i.apply(this,arguments)}}())})()}pickUsername(n){var i=this;return M(function*(){const s=yield i.connectedUserService.setUsername(n.username);s.isSuccess()?i.success=!0:i.errorMessage=s.getReason()})()}sendEmailVerification(){var n=this;return M(function*(){const i=yield n.connectedUserService.sendEmailVerification();i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}finalizeEmailVerification(){var n=this;return M(function*(){n.triedToFinalize=!0,yield n.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(ur),U(Un))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,n,i,s,o,a,c,l,f,d,m;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,o=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,f=$localize`Username`,d=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],o,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",f,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],d,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2),oe(3,3),P(),O(4,NEt,14,2,"div",4),O(5,xEt,3,2,"ng-container",5),P(),O(6,LEt,3,1,"div",6),P()),2&n&&(_(4),y("ngIf","send-email"===i.verificationType),_(1),y("ngIf","enter-username"===i.verificationType),_(1),y("ngIf",i.errorMessage))},dependencies:[wt,Ic,T6,bc,V3,P6,N6,b6,Y8],encapsulation:2})),e})();function zEt(r,e){1&r&&(S(0,"p",17),oe(1,18),P())}function DEt(r,e){if(1&r&&(S(0,"div",19)(1,"div",20),oe(2,21),P(),S(3,"div",22),ct(4),P()()),2&r){const t=p();_(4),mn(t.errorMessage.get())}}const HEt=function(){return{standalone:!0}};let VEt=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"success",!1),u(this,"errorMessage",g.empty()),u(this,"email",""),this.connectedUserService=n}resetPassword(){var n=this;return M(function*(){je(""!==n.email,"No email was entered, but it should not be possible to submit the form then!"),n.errorMessage=g.empty(),n.success=!1;const i=yield n.connectedUserService.sendPasswordResetEmail(n.email);i.isSuccess()?n.success=!0:n.errorMessage=g.of(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(ur))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,n,i,s,o,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,o=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],o,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"div",3)(4,"div",4)(5,"label",5),oe(6,6),P()(),S(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),W("ngModelChange",function(o){return i.email=o}),P(),S(11,"p",11),oe(12,12),P(),O(13,zEt,2,0,"p",13),P()()()(),S(14,"button",14),W("click",function(){return i.resetPassword()}),oe(15,15),P(),O(16,DEt,5,1,"div",16),P()),2&n&&(_(10),y("ngModel",i.email)("ngModelOptions",D1(5,HEt)),_(3),y("ngIf",i.success),_(1),y("disabled",""===i.email),_(2),y("ngIf",i.errorMessage.isPresent()))},dependencies:[wt,bc,V3,N6,gf,TR],encapsulation:2})),e})();function FEt(r,e){if(1&r&&(S(0,"option",13),ct(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentTheme),_(1),x2(" ",t.name," ")}}function $Et(r,e){if(1&r&&(S(0,"option",13),ct(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentLanguage),_(1),x2(" ",t.name," ")}}let BEt=(()=>{var r;class e{constructor(n,i){u(this,"userSettingsService",void 0),u(this,"availableLanguages",[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}]),u(this,"availableThemes",[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}]),u(this,"currentTheme",void 0),u(this,"currentLanguage",void 0),this.userSettingsService=n,this.currentTheme=i.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(n){this.userSettingsService.changeLanguage(n.target.value),this.reload()}changeTheme(n){this.userSettingsService.changeTheme(n.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(Qee),U(Av))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"div",3)(4,"label",4),oe(5,5),P(),S(6,"div",6)(7,"div",7)(8,"select",8),W("change",function(o){return i.changeTheme(o)}),O(9,FEt,2,3,"option",9),P()()()(),S(10,"div",3)(11,"label",10),oe(12,11),P(),S(13,"div",6)(14,"div",7)(15,"select",12),W("change",function(o){return i.changeLanguage(o)}),O(16,$Et,2,3,"option",9),P()()()()()),2&n&&(_(9),y("ngForOf",i.availableThemes),_(7),y("ngForOf",i.availableLanguages))},dependencies:[Wt,mf,_f],encapsulation:2})),e})(),GEt=(()=>{var r;class e{constructor(n,i,s,o,a,c){u(this,"route",void 0),u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"gameService",void 0),this.route=n,this.router=i,this.connectedUserService=s,this.currentGameService=o,this.messageDisplayer=a,this.gameService=c}ngOnInit(){var n=this;return M(function*(){yield n.createGameAndRedirectOrShowError(n.extractGameFromURL())})()}extractGameFromURL(){return B.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(n){var i=this;return M(function*(){if(je(i.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===i.gameExists(n))return yield i.router.navigate(["/notFound",j0.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;const o=i.currentGameService.canUserCreate();if(o.isSuccess()){const a=yield i.gameService.createPartConfigRoomAndChat(n);return yield i.router.navigate(["/play",n,a]),!0}return i.messageDisplayer.infoMessage(o.getReason()),yield i.router.navigate(["/lobby"]),!1})()}gameExists(n){return g.ofNullable(Uu.ALL_GAMES().find(s=>s.urlName===n)).isPresent()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(U(qs),U(Un),U(ur),U(ys),U($t),U(ou))}),u(e,"\u0275cmp",Be({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),oe(1,0),P())},encapsulation:2})),e})();!function Zhe(r,e,t){(function z7e(r,e,t){"string"!=typeof e&&(t=e,e=r[N1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),B8[e]=r,t&&(B8[e][N1.ExtraData]=t)})(r,e,t)}(PMe);const UEt=[{path:"login",component:OCt},{path:"lobby",component:bR,canActivate:[Yu]},{path:"account",component:UCt,canActivate:[Yu]},{path:"settings",component:BEt},{path:"register",component:qMt,canActivate:[bEt]},{path:"reset-password",component:VEt},{path:"notFound/:message",component:V4e},{path:"nextGameLoading",component:YMt,canActivate:[Yu]},{path:"verify-account",component:REt,canActivate:[TEt]},{path:"play",component:H4e,canActivate:[Yu,HR]},{path:"play/:compo",component:GEt,canActivate:[Yu,HR]},{path:"play/:compo/:id",component:AR,canActivate:[Yu,HR]},{path:"local",component:jMt},{path:"local/:compo",component:kR},{path:"tutorial",component:ZMt},{path:"tutorial/:compo",component:xR},{path:"",component:hCt},{path:"demo",component:MCt},{path:"**",component:V4e}];class VR{static app(){return function CIe(r,...e){return{ngModule:vIe,providers:[{provide:wA,useFactory:_Ie(r),multi:!0,deps:[u1,ci,TA,...e]}]}}(()=>yIe(ph_firebaseConfig))}static firestore(){return function MRe(r,...e){return{ngModule:yRe,providers:[{provide:nx,useFactory:_Re(r),multi:!0,deps:[u1,ci,TA,bA,[new fs,uee],[new fs,YA],...e]}]}}(()=>{const e=wRe();e.toJSON();return e})}static auth(){return function sRe(r,...e){return{ngModule:iRe,providers:[{provide:tx,useFactory:tRe(r),multi:!0,deps:[u1,ci,TA,bA,[new fs,YA],...e]}]}}(()=>{const e=cRe();return e})}}let WEt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275mod",Ai({type:r,bootstrap:[ift]})),u(e,"\u0275inj",ii({providers:[ur,ou,ox,Md,iu,ru,Av,{provide:Oc,useValue:Ed.getLocale()}],imports:[VR.app(),VR.firestore(),VR.auth(),mG,Xme,yCe.forRoot(UEt,{useHash:!1}),Tme,Ome,EMe,yqe]})),e})();Fy(xs,function(){return[Dt,Wt,wt,Yl,Kl,cc]},[]),Fy(Bn,function(){return[Dt,Wt,wt,hh]},[]);var qEt=Vo(522);function G4e(){mge().bootstrapModule(WEt).catch(r=>console.error(r))}const U4e=Ed.getLocale();"en"!==U4e?fetch("/assets/"+U4e+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,qEt.XJ)(r.translations),$localize.locale=r.locale,G4e()}).catch(function(r){console.log(r)}):G4e()},1:function(Ku,X0){!function(Vo){"use strict";function Mn(ht,ot){var zt=Object.keys(ht);if(Object.getOwnPropertySymbols){var Ln=Object.getOwnPropertySymbols(ht);ot&&(Ln=Ln.filter(function(zr){return Object.getOwnPropertyDescriptor(ht,zr).enumerable})),zt.push.apply(zt,Ln)}return zt}function Fo(ht){for(var ot,zt=1;zt<arguments.length;zt++)ot=null==arguments[zt]?{}:arguments[zt],zt%2?Mn(Object(ot),!0).forEach(function(Ln){Jl(ht,Ln,ot[Ln])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ht,Object.getOwnPropertyDescriptors(ot)):Mn(Object(ot)).forEach(function(Ln){Object.defineProperty(ht,Ln,Object.getOwnPropertyDescriptor(ot,Ln))});return ht}function _3(ht,ot){if(!(ht instanceof ot))throw new TypeError("Cannot call a class as a function")}function v3(ht,ot){for(var zt,Ln=0;Ln<ot.length;Ln++)(zt=ot[Ln]).enumerable=zt.enumerable||!1,zt.configurable=!0,"value"in zt&&(zt.writable=!0),Object.defineProperty(ht,zt.key,zt)}function En(ht,ot,zt){return ot&&v3(ht.prototype,ot),zt&&v3(ht,zt),ht}function Jl(ht,ot,zt){return ot in ht?Object.defineProperty(ht,ot,{value:zt,enumerable:!0,configurable:!0,writable:!0}):ht[ot]=zt,ht}function C3(){var ht;return null!==(ht=Q0)&&void 0!==ht?ht:document}var e6={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Rs=Fo({},e6),$o={},Q0=null,Xu=function(ht,ot,zt,Ln,zr){return"top-left"===ht?"left:".concat(Ln,";top:").concat(ot,";text-align:left;align-items:flex-start;"):"top-right"===ht?"right:".concat(zr,";top:").concat(ot,";text-align:right;align-items:flex-end;"):"top-center"===ht?"top:".concat(ot,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ht?"left:".concat(Ln,";bottom:").concat(zt,";text-align:left;align-items:flex-start;"):"bottom-right"===ht?"right:".concat(zr,";bottom:").concat(zt,";text-align:right;align-items:flex-end;"):"bottom-center"===ht?"bottom:".concat(zt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ht?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},t6=function(){function ht(ot){var zt=this;_3(this,ht),this.element=C3().createElement("div"),this.opacity=ot.opacity,this.type=ot.type,this.animate=ot.animate,this.dismissible=ot.dismissible,this.closeOnClick=ot.closeOnClick,this.message=ot.message,this.duration=ot.duration,this.pauseOnHover=ot.pauseOnHover,this.offsetTop=ot.offsetTop,this.offsetBottom=ot.offsetBottom,this.offsetLeft=ot.offsetLeft,this.offsetRight=ot.offsetRight,this.extraClasses=ot.extraClasses;var Ln="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),zr=["notification",this.extraClasses];if(this.type&&zr.push(this.type),this.animate&&this.animate.in){var M3="animate__".concat(this.animate.in),Ni=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";zr.push("animate__animated ".concat(M3," ").concat(Ni)),this.onAnimationEnd(function(){return zt.element.classList.remove(M3)})}if(this.element.className=zr.join(" "),this.dismissible){var ni=C3().createElement("button");ni.className="delete",ni.addEventListener("click",function(){zt.destroy()}),this.element.insertAdjacentElement("afterbegin",ni)}else Ln+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){zt.destroy()}),this.element.setAttribute("style",Ln),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var n6=new Ma(function(){zt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){n6.pause()}),this.element.addEventListener("mouseout",function(){n6.resume()}))}return En(ht,[{key:"destroy",value:function(){var ot=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ot.removeParent(ot.element.parentNode),ot.element.remove(),delete $o.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete $o.position)}},{key:"removeParent",value:function(ot){ot&&1>=ot.children.length&&ot.remove()}},{key:"onAnimationEnd",value:function(){var ot=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},zt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var Ln in zt)if(void 0!==this.element.style[Ln]){this.element.addEventListener(zt[Ln],function(){return ot()});break}}}]),ht}(),Ma=function(){function ht(ot,zt){_3(this,ht),this.remaining=zt,this.callback=ot,this.resume()}return En(ht,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ht}();Vo.resetDefaults=function(){Rs=Fo({},e6)},Vo.setDefaults=function(ht){Rs=Fo(Fo({},e6),ht)},Vo.setDoc=function lc(ht){for(var ot in $o)$o[ot].remove();$o={},Q0=ht},Vo.toast=function L4(ht){if(!ht.message)throw new Error("message is required");var ot=Fo(Fo({},Rs),ht),zt=new t6(ot),Ln=function y3(ht,ot,zt,Ln,zr,M3){if($o.position)return $o.position;var Ni=C3().createElement("div");return Ni.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+Xu(ot,zt,Ln,zr,M3)),ht.appendChild(Ni),$o.position=Ni,Ni}(ot.appendTo||C3().body,ot.position||Rs.position,ot.offsetTop||Rs.offsetTop,ot.offsetBottom||Rs.offsetBottom,ot.offsetLeft||Rs.offsetLeft,ot.offsetRight||Rs.offsetRight);if(ot.single)for(var zr=Ln.lastElementChild;zr;)Ln.removeChild(zr),zr=Ln.lastElementChild;Ln.appendChild(zt.element)},Object.defineProperty(Vo,"__esModule",{value:!0})}(X0)},522:(Ku,X0,Vo)=>{"use strict";Vo.d(X0,{XJ:()=>t7,pQ:()=>r7});const Mn=":",Fo="|",_3="@@",v3="\u241f";class En{static zero(){return new En([0])}static one(){return new En([1])}constructor(ie){this.digits=ie}clone(){return new En(this.digits.slice())}add(ie){const me=this.clone();return me.addToSelf(ie),me}addToSelf(ie){const me=Math.max(this.digits.length,ie.digits.length);let Pe=0;for(let Ye=0;Ye<me;Ye++){let at=Pe;Ye<this.digits.length&&(at+=this.digits[Ye]),Ye<ie.digits.length&&(at+=ie.digits[Ye]),at>=10?(this.digits[Ye]=at-10,Pe=1):(this.digits[Ye]=at,Pe=0)}Pe>0&&(this.digits[me]=1)}toString(){let ie="";for(let me=this.digits.length-1;me>=0;me--)ie+=this.digits[me];return ie}}class Jl{constructor(ie){this.powerOfTwos=[ie]}getValue(){return this.powerOfTwos[0]}multiplyBy(ie){const me=En.zero();return this.multiplyByAndAddTo(ie,me),me}multiplyByAndAddTo(ie,me){for(let Pe=0;0!==ie;ie>>>=1,Pe++)if(1&ie){const Ye=this.getMultipliedByPowerOfTwo(Pe);me.addToSelf(Ye)}}getMultipliedByPowerOfTwo(ie){for(let me=this.powerOfTwos.length;me<=ie;me++){const Pe=this.powerOfTwos[me-1];this.powerOfTwos[me]=Pe.add(Pe)}return this.powerOfTwos[ie]}}class C3{constructor(ie){this.base=ie,this.exponents=[new Jl(En.one())]}toThePowerOf(ie){for(let me=this.exponents.length;me<=ie;me++){const Pe=this.exponents[me-1].multiplyBy(this.base);this.exponents[me]=new Jl(Pe)}return this.exponents[ie]}}let y3;function zt(ae){y3??=new TextEncoder;const ie=y3.encode(ae),me=new DataView(ie.buffer,ie.byteOffset,ie.byteLength);let Pe=zr(me,ie.length,0),Ye=zr(me,ie.length,102072);return 0==Pe&&(0==Ye||1==Ye)&&(Pe^=319790063,Ye^=-1801410264),[Pe,Ye]}function zr(ae,ie,me){let Pe=2654435769,Ye=2654435769,at=0;const l2=ie-12;for(;at<=l2;at+=12){Pe+=ae.getUint32(at,!0),Ye+=ae.getUint32(at+4,!0);const n1=M3(Pe,Ye,me+=ae.getUint32(at+8,!0));Pe=n1[0],Ye=n1[1],me=n1[2]}const t1=ie-at;return me+=ie,t1>=4?(Pe+=ae.getUint32(at,!0),at+=4,t1>=8?(Ye+=ae.getUint32(at,!0),at+=4,t1>=9&&(me+=ae.getUint8(at++)<<8),t1>=10&&(me+=ae.getUint8(at++)<<16),11===t1&&(me+=ae.getUint8(at++)<<24)):(t1>=5&&(Ye+=ae.getUint8(at++)),t1>=6&&(Ye+=ae.getUint8(at++)<<8),7===t1&&(Ye+=ae.getUint8(at++)<<16))):(t1>=1&&(Pe+=ae.getUint8(at++)),t1>=2&&(Pe+=ae.getUint8(at++)<<8),3===t1&&(Pe+=ae.getUint8(at++)<<16)),M3(Pe,Ye,me)[2]}function M3(ae,ie,me){return ae-=ie,ae-=me,ie-=me,ie-=ae^=me>>>13,me-=ae,me-=ie^=ae<<8,ae-=ie,ae-=me^=ie>>>13,ie-=me,ie-=ae^=me>>>12,me-=ae,me-=ie^=ae<<16,ae-=ie,ae-=me^=ie>>>5,ie-=me,ie-=ae^=me>>>3,me-=ae,me-=ie^=ae<<10,[ae,ie,me^=ie>>>15]}function ni(ae,ie){return n6(ae,ie)[1]}function n6(ae,ie){const me=(65535&ae)+(65535&ie),Pe=(ae>>>16)+(ie>>>16)+(me>>>16);return[Pe>>>16,Pe<<16|65535&me]}const T1=new C3(256);function py(ae,ie,me,Pe,Ye=[]){const at={},l2={},t1={},n1=function gy(ae,ie){const{text:me,block:Pe}=zs(ae,ie);if(void 0===Pe)return{text:me};{const[Ye,...at]=Pe.split(v3),[l2,t1]=Ye.split(_3,2);let[n1,I2]=l2.split(Fo,2);return void 0===I2&&(I2=n1,n1=void 0),""===I2&&(I2=void 0),{text:me,meaning:n1,description:I2,customId:t1,legacyIds:at}}}(ae[0],ae.raw[0]),I2=[n1.text],R4=[];let r6=n1.text;for(let co=1;co<ae.length;co++){const{messagePart:i6,placeholderName:e2=yh(co),associatedMessageId:s6}=my(ae[co],ae.raw[co]);r6+=`{$${e2}}${i6}`,void 0!==ie&&(at[e2]=ie[co-1],l2[e2]=Ye[co-1]),R4.push(e2),void 0!==s6&&(t1[e2]=s6),I2.push(i6)}const ao=n1.customId||function Ln(ae,ie=""){let me=zt(ae);if(ie){const at=zt(ie);me=function Qu(ae,ie){const me=ae[0],Ye=ie[0],l2=n6(ae[1],ie[1]),t1=l2[0],n1=l2[1];return[ni(ni(me,Ye),t1),n1]}(function e7(ae,ie){const me=ae[0],Pe=ae[1];return[me<<ie|Pe>>>32-ie,Pe<<ie|me>>>32-ie]}(me,1),at)}return function Ch(ae,ie){const me=T1.toThePowerOf(0).multiplyBy(ie);return T1.toThePowerOf(4).multiplyByAndAddTo(ae,me),me.toString()}(2147483647&me[0],me[1])}(r6,n1.meaning||""),e8=n1.legacyIds?n1.legacyIds.filter(co=>co!==ao):[];return{id:ao,legacyIds:e8,substitutions:at,substitutionLocations:l2,text:r6,customId:n1.customId,meaning:n1.meaning||"",description:n1.description||"",messageParts:I2,messagePartLocations:Pe,placeholderNames:R4,associatedMessageIds:t1,location:me}}function my(ae,ie){const{text:me,block:Pe}=zs(ae,ie);if(void 0===Pe)return{messagePart:me};{const[Ye,at]=Pe.split(_3);return{messagePart:me,placeholderName:Ye,associatedMessageId:at}}}function zs(ae,ie){if(ie.charAt(0)!==Mn)return{text:ae};{const me=ss(ae,ie);return{block:ae.substring(1,me),text:ae.substring(me+1)}}}function yh(ae){return 1===ae?"PH":"PH_"+(ae-1)}function ss(ae,ie){for(let me=1,Pe=1;me<ae.length;me++,Pe++)if("\\"===ie[Pe])Pe++;else if(ae[me]===Mn)return me;throw new Error(`Unterminated $localize metadata block in "${ie}".`)}class Mh extends Error{constructor(ie){super(`No translation found for ${Eh(ie)}.`),this.parsedMessage=ie,this.type="MissingTranslationError"}}function J0(ae,ie){return Object.defineProperty(ae,"raw",{value:ie}),ae}function Eh(ae){const ie=ae.meaning&&` - "${ae.meaning}"`,me=ae.legacyIds&&ae.legacyIds.length>0?` [${ae.legacyIds.map(Pe=>`"${Pe}"`).join(", ")}]`:"";return`"${ae.id}"${me} ("${ae.text}"${ie})`}function t7(ae){$localize.translate||($localize.translate=vy),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ae).forEach(ie=>{$localize.TRANSLATIONS[ie]=function _y(ae){const ie=ae.split(/{\$([^}]*)}/),me=[ie[0]],Pe=[];for(let at=1;at<ie.length-1;at+=2)Pe.push(ie[at]),me.push(`${ie[at+1]}`);const Ye=me.map(at=>at.charAt(0)===Mn?"\\"+at:at);return{text:ae,messageParts:J0(me,Ye),placeholderNames:Pe}}(ae[ie])})}function vy(ae,ie){try{return function Mr(ae,ie,me){const Pe=py(ie,me);let Ye=ae[Pe.id];if(void 0!==Pe.legacyIds)for(let at=0;at<Pe.legacyIds.length&&void 0===Ye;at++)Ye=ae[Pe.legacyIds[at]];if(void 0===Ye)throw new Mh(Pe);return[Ye.messageParts,Ye.placeholderNames.map(at=>{if(Pe.substitutions.hasOwnProperty(at))return Pe.substitutions[at];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${Eh(Pe)}.\nThe translation contains a placeholder with name ${at}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ae,ie)}catch(me){return console.warn(me.message),[ae,ie]}}const r7=function(ae,...ie){if(r7.translate){const Pe=r7.translate(ae,ie);ae=Pe[0],ie=Pe[1]}let me=Cy(ae[0],ae.raw[0]);for(let Pe=1;Pe<ae.length;Pe++)me+=ie[Pe-1]+Cy(ae[Pe],ae.raw[Pe]);return me},$R=":";function Cy(ae,ie){return ie.charAt(0)===$R?ae.substring(ss(ae,ie)+1):ae}}},Ku=>{Ku(Ku.s=3606)}]);