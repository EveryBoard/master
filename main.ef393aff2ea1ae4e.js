(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{992:(A9,g5,ja)=>{"use strict";function nn(n){return"function"==typeof n}function ns(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const k3=ns(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Dc(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class G1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(nn(r))try{r()}catch(i){t=i instanceof k3?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{hn(i)}catch(o){t=t??[],o instanceof k3?t=[...t,...o.errors]:t.push(o)}}if(t)throw new k3(t)}}add(t){var e;if(t&&t!==this)if(this.closed)hn(t);else{if(t instanceof G1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Dc(e,t)}remove(t){const{_finalizers:e}=this;e&&Dc(e,t),t instanceof G1&&t._removeParent(this)}}G1.EMPTY=(()=>{const n=new G1;return n.closed=!0,n})();const e8=G1.EMPTY;function zc(n){return n instanceof G1||n&&"closed"in n&&nn(n.remove)&&nn(n.add)&&nn(n.unsubscribe)}function hn(n){nn(n)?n():n.unsubscribe()}const Za={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Vc={setTimeout(n,t,...e){const{delegate:r}=Vc;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=Vc;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function L3(n){Vc.setTimeout(()=>{const{onUnhandledError:t}=Za;if(!t)throw n;t(n)})}function Qi(){}const Ys=t8("C",void 0,void 0);function t8(n,t,e){return{kind:n,value:t,error:e}}let Hc=null;function ft(n){if(Za.useDeprecatedSynchronousErrorHandling){const t=!Hc;if(t&&(Hc={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=Hc;if(Hc=null,e)throw r}}else n()}class Xt extends G1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,zc(t)&&t.add(this)):this.destination=_5}static create(t,e,r){return new or(t,e,r)}next(t){this.isStopped?x9(function I9(n){return t8("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?x9(function z4(n){return t8("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?x9(Ys,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const i1=Function.prototype.bind;function xs(n,t){return i1.call(n,t)}class bn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){R3(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){R3(r)}else R3(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){R3(e)}}}class or extends Xt{constructor(t,e,r){let s;if(super(),nn(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&Za.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&xs(t.next,i),error:t.error&&xs(t.error,i),complete:t.complete&&xs(t.complete,i)}):s=t}this.destination=new bn(s)}}function R3(n){Za.useDeprecatedSynchronousErrorHandling?function ot(n){Za.useDeprecatedSynchronousErrorHandling&&Hc&&(Hc.errorThrown=!0,Hc.error=n)}(n):L3(n)}function x9(n,t){const{onStoppedNotification:e}=Za;e&&Vc.setTimeout(()=>e(n,t))}const _5={closed:!0,next:Qi,error:function m5(n){throw n},complete:Qi},$m="function"==typeof Symbol&&Symbol.observable||"@@observable";function V4(n){return n}function Um(n){return 0===n.length?V4:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let vr=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function v5(n){return n&&n instanceof Xt||function HP(n){return n&&nn(n.next)&&nn(n.error)&&nn(n.complete)}(n)&&zc(n)}(e)?e:new or(e,r,s);return ft(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=k9(r))((s,i)=>{const o=new or({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[$m](){return this}pipe(...e){return Um(e)(this)}toPromise(e){return new(e=k9(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function k9(n){var t;return null!==(t=n??Za.Promise)&&void 0!==t?t:Promise}const kH=ns(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ai=(()=>{class n extends vr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new L9(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new kH}next(e){ft(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){ft(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){ft(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?e8:(this.currentObservers=null,i.push(e),new G1(()=>{this.currentObservers=null,Dc(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new vr;return e.source=this,e}}return n.create=(t,e)=>new L9(t,e),n})();class L9 extends Ai{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:e8}}function Gm(n){return nn(n?.lift)}function hr(n){return t=>{if(Gm(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function rs(n,t,e,r,s){return new FP(n,t,e,r,s)}class FP extends Xt{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function dn(n,t){return hr((e,r)=>{let s=0;e.subscribe(rs(r,i=>{r.next(n.call(t,i,s++))}))})}function y5(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function $r(n){return this instanceof $r?(this.v=n,this):new $r(n)}function U2(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(C){r[C]&&(s[C]=function(w){return new Promise(function(I,H){i.push([C,w,I,H])>1||c(C,w)})})}function c(C,w){try{!function u(C){C.value instanceof $r?Promise.resolve(C.value.v).then(h,g):m(i[0][2],C)}(r[C](w))}catch(I){m(i[0][3],I)}}function h(C){c("next",C)}function g(C){c("throw",C)}function m(C,w){C(w),i.shift(),i.length&&c(i[0][0],i[0][1])}}function jP(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function jm(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const Xm=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Qm(n){return nn(n?.then)}function z9(n){return nn(n[$m])}function Jm(n){return Symbol.asyncIterator&&nn(n?.[Symbol.asyncIterator])}function Ya(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const b1=function n8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ka(n){return nn(n?.[b1])}function fa(n){return U2(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield $r(e.read());if(s)return yield $r(void 0);yield yield $r(r)}}finally{e.releaseLock()}})}function e_(n){return nn(n?.getReader)}function xo(n){if(n instanceof vr)return n;if(null!=n){if(z9(n))return function H4(n){return new vr(t=>{const e=n[$m]();if(nn(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Xm(n))return function G2(n){return new vr(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Qm(n))return function t_(n){return new vr(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,L3)})}(n);if(Jm(n))return F4(n);if(Ka(n))return function ZP(n){return new vr(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(e_(n))return function V9(n){return F4(fa(n))}(n)}throw Ya(n)}function F4(n){return new vr(t=>{(function YP(n,t){var e,r,s,i;return function UP(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=jP(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function ks(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function Re(n,t,e=1/0){return nn(t)?Re((r,s)=>dn((i,o)=>t(r,i,s,o))(xo(n(r,s))),e):("number"==typeof t&&(e=t),hr((r,s)=>function ko(n,t,e,r,s,i,o,c){const u=[];let h=0,g=0,m=!1;const C=()=>{m&&!u.length&&!h&&t.complete()},w=H=>h<r?I(H):u.push(H),I=H=>{i&&t.next(H),h++;let Y=!1;xo(e(H,g++)).subscribe(rs(t,ee=>{s?.(ee),i?w(ee):t.next(ee)},()=>{Y=!0},void 0,()=>{if(Y)try{for(h--;u.length&&h<r;){const ee=u.shift();o?ks(t,o,()=>I(ee)):I(ee)}C()}catch(ee){t.error(ee)}}))};return n.subscribe(rs(t,w,()=>{m=!0,C()})),()=>{c?.()}}(r,s,n,e)))}function B4(n=1/0){return Re(V4,n)}const Xa=new vr(n=>n.complete());function $4(n){return n[n.length-1]}function Yt(n){return nn($4(n))?n.pop():void 0}function D3(n){return function c6(n){return n&&nn(n.schedule)}($4(n))?n.pop():void 0}function U4(n,t=0){return hr((e,r)=>{e.subscribe(rs(r,s=>ks(r,n,()=>r.next(s),t),()=>ks(r,n,()=>r.complete(),t),s=>ks(r,n,()=>r.error(s),t)))})}function Qa(n,t=0){return hr((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function S5(n,t){if(!n)throw new Error("Iterable cannot be null");return new vr(e=>{ks(e,t,()=>{const r=n[Symbol.asyncIterator]();ks(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function ss(n,t){return t?function r8(n,t){if(null!=n){if(z9(n))return function M5(n,t){return xo(n).pipe(Qa(t),U4(t))}(n,t);if(Xm(n))return function Ro(n,t){return new vr(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(Qm(n))return function l6(n,t){return xo(n).pipe(Qa(t),U4(t))}(n,t);if(Jm(n))return S5(n,t);if(Ka(n))return function H9(n,t){return new vr(e=>{let r;return ks(e,t,()=>{r=n[b1](),ks(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>nn(r?.return)&&r.return()})}(n,t);if(e_(n))return function u6(n,t){return S5(fa(n),t)}(n,t)}throw Ya(n)}(n,t):xo(n)}function P5(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new or({next:()=>{r.unsubscribe(),n()}});return t(...e).subscribe(r)}function v1(n){for(let t in n)if(n[t]===v1)return t;throw Error("Could not find renamed property on target object.")}function F9(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function W1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(W1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function s8(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const r_=v1({__forward_ref__:v1});function C1(n){return n.__forward_ref__=C1,n.toString=function(){return W1(this())},n}function Qt(n){return f6(n)?n():n}function f6(n){return"function"==typeof n&&n.hasOwnProperty(r_)&&n.__forward_ref__===C1}class Oe extends Error{constructor(t,e){super(function Fc(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function Jt(n){return"string"==typeof n?n:null==n?"":String(n)}function d6(n,t){throw new Oe(-201,!1)}function y1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function Je(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ur(n){return{providers:n.providers||[],imports:n.imports||[]}}function In(n){return a_(n,p6)||a_(n,G9)}function a_(n,t){return n.hasOwnProperty(t)?n[t]:null}function a8(n){return n&&(n.hasOwnProperty(ve)||n.hasOwnProperty(W9))?n[ve]:null}const p6=v1({\u0275prov:v1}),ve=v1({\u0275inj:v1}),G9=v1({ngInjectableDef:v1}),W9=v1({ngInjectorDef:v1});var Gt=(()=>((Gt=Gt||{})[Gt.Default=0]="Default",Gt[Gt.Host=1]="Host",Gt[Gt.Self=2]="Self",Gt[Gt.SkipSelf=4]="SkipSelf",Gt[Gt.Optional=8]="Optional",Gt))();let q9;function Do(n){const t=q9;return q9=n,t}function j9(n,t,e){const r=In(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Gt.Optional?null:void 0!==t?t:void d6(W1(n))}function H3(n){return{toString:n}.toString()}var ki=(()=>((ki=ki||{})[ki.OnPush=0]="OnPush",ki[ki.Default=1]="Default",ki))(),L1=(()=>{return(n=L1||(L1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",L1;var n})();const K1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Z={},_1=[],O5=v1({\u0275cmp:v1}),Z9=v1({\u0275dir:v1}),Y9=v1({\u0275pipe:v1}),c8=v1({\u0275mod:v1}),Bc=v1({\u0275fac:v1}),$c=v1({__NG_ELEMENT_ID__:v1});let tT=0;function mt(n){return H3(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===ki.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||_1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||L1.Emulated,id:"c"+tT++,styles:n.styles||_1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=X9(n.inputs,r),s.outputs=X9(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(K9).filter(N5):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(q2).filter(N5):null,s})}function l8(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(K9),r.pipeDefs=()=>("function"==typeof e?e():e).map(q2)}function K9(n){return E1(n)||W2(n)}function N5(n){return null!==n}function Js(n){return H3(()=>({type:n.type,bootstrap:n.bootstrap||_1,declarations:n.declarations||_1,imports:n.imports||_1,exports:n.exports||_1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function X9(n,t){if(null==n)return Z;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const Ft=mt;function e2(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function E1(n){return n[O5]||null}function W2(n){return n[Z9]||null}function q2(n){return n[Y9]||null}function eo(n,t){const e=n[c8]||null;if(!e&&!0===t)throw new Error(`Type ${W1(n)} does not have '\u0275mod' property.`);return e}function to(n){return Array.isArray(n)&&"object"==typeof n[1]}function Cr(n){return Array.isArray(n)&&!0===n[1]}function Ri(n){return 0!=(8&n.flags)}function Fo(n){return 2==(2&n.flags)}function Bo(n){return 1==(1&n.flags)}function ms(n){return null!==n.template}function C6(n){return 0!=(256&n[2])}function da(n,t){return n.hasOwnProperty(Bc)?n[Bc]:null}class sT{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function Y2(){return d_}function d_(n){return n.type.prototype.ngOnChanges&&(n.setInput=p_),iT}function iT(){const n=R5(this),t=n?.current;if(t){const e=n.previous;if(e===Z)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function p_(n,t,e,r){const s=R5(n)||function oT(n,t){return n[g_]=t}(n,{previous:Z,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new sT(u&&u.currentValue,t,o===Z),n[r]=t}Y2.ngInherit=!0;const g_="__ngSimpleChanges__";function R5(n){return n[g_]||null}function yr(n){for(;Array.isArray(n);)n=n[0];return n}function h8(n,t){return yr(t[n])}function K2(n,t){return yr(t[n.index])}function nh(n,t){return n.data[t]}function q4(n,t){return n[t]}function P2(n,t){const e=t[n];return to(e)?e:e[0]}function M6(n){return 64==(64&n[2])}function Gc(n,t){return null==t?null:n[t]}function C_(n){n[18]=0}function rh(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const rn={lFrame:uh(null),bindingsEnabled:!0};function sh(){return rn.bindingsEnabled}function ke(){return rn.lFrame.lView}function Kn(){return rn.lFrame.tView}function ue(n){return rn.lFrame.contextLView=n,n[8]}function oe(n){return rn.lFrame.contextLView=null,n}function xr(){let n=y_();for(;null!==n&&64===n.type;)n=n.parent;return n}function y_(){return rn.lFrame.currentTNode}function j4(){const n=rn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function Ja(n,t){const e=rn.lFrame;e.currentTNode=n,e.isParent=t}function Gr(){return rn.lFrame.isParent}function ih(){rn.lFrame.isParent=!1}function T2(){const n=rn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function ec(){return rn.lFrame.bindingIndex}function P6(){return rn.lFrame.bindingIndex++}function Uo(n){const t=rn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function X2(n){rn.lFrame.inI18n=n}function mT(n,t){const e=rn.lFrame;e.bindingIndex=e.bindingRootIndex=n,Wc(t)}function Wc(n){rn.lFrame.currentDirectiveIndex=n}function ch(){return rn.lFrame.currentQueryIndex}function p8(n){rn.lFrame.currentQueryIndex=n}function M_(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function B5(n,t,e){if(e&Gt.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&Gt.Host||(s=M_(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=rn.lFrame=lh();return r.currentTNode=t,r.lView=n,!0}function Z4(n){const t=lh(),e=n[1];rn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function lh(){const n=rn.lFrame,t=null===n?null:n.child;return null===t?uh(n):t}function uh(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function S_(){const n=rn.lFrame;return rn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const g8=S_;function Y4(){const n=S_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Q2(){return rn.lFrame.selectedIndex}function qc(n){rn.lFrame.selectedIndex=n}function M1(){const n=rn.lFrame;return nh(n.tView,n.selectedIndex)}function B(){rn.lFrame.currentNamespace="svg"}function Yc(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:g}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),h&&((n.viewHooks||(n.viewHooks=[])).push(e,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,h)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(e,g)}}function pa(n,t,e){P_(n,t,3,e)}function _8(n,t,e,r){(3&n[2])===e&&P_(n,t,e,r)}function v8(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function P_(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(T_(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function T_(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class C8{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function tc(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];O_(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function b_(n){return 3===n||4===n||6===n}function O_(n){return 64===n.charCodeAt(0)}function b6(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||hh(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function hh(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function dh(n){return-1!==n}function X4(n){return 32767&n}function Q4(n,t){let e=function N_(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let U5=!0;function W3(n){const t=U5;return U5=n,t}let A_=0;const Kc={};function G5(n,t){const e=E8(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,gh(r.data,n),gh(t,null),gh(r.blueprint,null));const s=ma(n,t),i=n.injectorIndex;if(dh(s)){const o=X4(s),c=Q4(s,t),u=c[1].data;for(let h=0;h<8;h++)t[i+h]=c[o+h]|u[o+h]}return t[i+8]=s,i}function gh(n,t){n.push(0,0,0,0,0,0,0,0,t)}function E8(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function ma(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=k_(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function O6(n,t,e){!function XH(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty($c)&&(r=e[$c]),null==r&&(r=e[$c]=A_++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function mh(n,t,e){if(e&Gt.Optional||void 0!==n)return n;d6()}function _h(n,t,e,r){if(e&Gt.Optional&&void 0===r&&(r=null),0==(e&(Gt.Self|Gt.Host))){const s=n[9],i=Do(void 0);try{return s?s.get(t,r,e&Gt.Optional):j9(t,r,e&Gt.Optional)}finally{Do(i)}}return mh(r,0,e)}function W5(n,t,e,r=Gt.Default,s){if(null!==n){if(1024&t[2]){const o=function q5(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=q3(i,o,e,r|Gt.Self,Kc);if(c!==Kc)return c;let u=i.parent;if(!u){const h=o[21];if(h){const g=h.get(e,Kc,r);if(g!==Kc)return g}u=k_(o),o=o[15]}i=u}return s}(n,t,e,r,Kc);if(o!==Kc)return o}const i=q3(n,t,e,r,Kc);if(i!==Kc)return i}return _h(t,e,r,s)}function q3(n,t,e,r,s){const i=function M8(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty($c)?n[$c]:void 0;return"number"==typeof t?t>=0?255&t:A6:t}(e);if("function"==typeof i){if(!B5(t,n,r))return r&Gt.Host?mh(s,0,r):_h(t,e,r,s);try{const o=i(r);if(null!=o||r&Gt.Optional)return o;d6()}finally{g8()}}else if("number"==typeof i){let o=null,c=E8(n,t),u=-1,h=r&Gt.Host?t[16][6]:null;for((-1===c||r&Gt.SkipSelf)&&(u=-1===c?ma(n,t):t[c+8],-1!==u&&x_(r,!1)?(o=t[1],c=X4(u),t=Q4(u,t)):c=-1);-1!==c;){const g=t[1];if(I_(i,c,g.data)){const m=vh(c,t,e,o,r,h);if(m!==Kc)return m}u=t[c+8],-1!==u&&x_(r,t[1].data[c+8]===h)&&I_(i,c,t)?(o=g,c=X4(u),t=Q4(u,t)):c=-1}}return s}function vh(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],g=Wr(c,o,e,null==r?Fo(c)&&U5:r!=o&&0!=(3&c.type),s&Gt.Host&&i===c);return null!==g?Ls(t,o,g,c):Kc}function Wr(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,g=i>>20,C=s?c+g:n.directiveEnd;for(let w=r?c:c+g;w<C;w++){const I=o[w];if(w<u&&e===I||w>=u&&I.type===e)return w}if(s){const w=o[u];if(w&&ms(w)&&w.type===e)return u}return null}function Ls(n,t,e,r){let s=n[e];const i=t.data;if(function _T(n){return n instanceof C8}(s)){const o=s;o.resolving&&function i8(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Oe(-200,`Circular dependency in DI detected for ${n}${e}`)}(function kt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Jt(n)}(i[e]));const c=W3(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Do(o.injectImpl):null;B5(n,r,Gt.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function w6(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=d_(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&Do(u),W3(c),o.resolving=!1,g8()}}return s}function I_(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function x_(n,t){return!(n&Gt.Self||n&Gt.Host&&t)}class N6{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return W5(this._tNode,this._lView,t,r,e)}}function A6(){return new N6(xr(),ke())}function qr(n){return H3(()=>{const t=n.prototype.constructor,e=t[Bc]||Ch(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[Bc]||Ch(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function Ch(n){return f6(n)?()=>{const t=Ch(Qt(n));return t&&t()}:da(n)}function k_(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function S8(n){return function CT(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if(b_(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(xr(),n)}const I6="__parameters__";function tl(n,t,e){return H3(()=>{const r=function j5(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,g){const m=u.hasOwnProperty(I6)?u[I6]:Object.defineProperty(u,I6,{value:[]})[I6];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class It{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Je({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function J2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),J2(r,t)):t!==n&&t.push(r)}return t}function _a(n,t){n.forEach(e=>Array.isArray(e)?_a(e,t):t(e))}function Xc(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function L6(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function nl(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function ei(n,t,e){let r=ti(n,t);return r>=0?n[1|r]=e:(r=~r,function Eh(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function t2(n,t){const e=ti(n,t);if(e>=0)return n[1|e]}function ti(n,t){return function K5(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const b8={},O8="__NG_DI_FLAG__",n2="ngTempTokenPath",ST=/\n/gm,J5="__source";let N8;function D6(n){const t=N8;return N8=n,t}function PT(n,t=Gt.Default){if(void 0===N8)throw new Oe(-203,!1);return null===N8?j9(n,void 0,t):N8.get(n,t&Gt.Optional?null:void 0,t)}function Le(n,t=Gt.Default){return(function FH(){return q9}()||PT)(Qt(n),t)}function kr(n,t=Gt.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),Le(n,t)}function wh(n){const t=[];for(let e=0;e<n.length;e++){const r=Qt(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Oe(900,!1);let s,i=Gt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=F_(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(Le(s,i))}else t.push(Le(r))}return t}function rl(n,t){return n[O8]=t,n.prototype[O8]=t,n}function F_(n){return n[O8]}const r2=rl(tl("Optional"),8),A8=rl(tl("SkipSelf"),4);let Lh,t7,n7;function $_(){return void 0!==Lh?Lh:typeof document<"u"?document:void 0}function Y3(n){return function Rh(){if(void 0===t7&&(t7=null,K1.trustedTypes))try{t7=K1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return t7}()?.createHTML(n)||n}function r7(n){return function Dh(){if(void 0===n7&&(n7=null,K1.trustedTypes))try{n7=K1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return n7}()?.createHTML(n)||n}class K3{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class DT extends K3{getTypeName(){return"HTML"}}class zT extends K3{getTypeName(){return"Style"}}class VT extends K3{getTypeName(){return"Script"}}class G_ extends K3{getTypeName(){return"URL"}}class W_ extends K3{getTypeName(){return"ResourceURL"}}function ro(n){return n instanceof K3?n.changingThisBreaksApplicationSecurity:n}function so(n,t){const e=function q_(n){return n instanceof K3&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function Y_(n){const t=new xt(n);return function $T(){try{return!!(new window.DOMParser).parseFromString(Y3(""),"text/html")}catch{return!1}}()?new K_(t):t}class K_{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Y3(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class xt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Y3(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=Y3(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const X_=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function jo(n){return(n=String(n)).match(X_)?n:"unsafe:"+n}function rc(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function k8(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const Q_=rc("area,br,col,hr,img,wbr"),J_=rc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),s7=rc("rp,rt"),L8=k8(Q_,k8(J_,rc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),k8(s7,rc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),k8(s7,J_)),i7=rc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),o7=k8(i7,rc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),rc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),UT=rc("script,style,template");class GT{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!L8.hasOwnProperty(e))return this.sanitizedSomething=!0,!UT.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!o7.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;i7[c]&&(u=jo(u)),this.buf.push(" ",o,'="',tv(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();L8.hasOwnProperty(e)&&!Q_.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(tv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const WT=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,qT=/([^\#-~ |!])/g;function tv(n){return n.replace(/&/g,"&amp;").replace(WT,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(qT,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let a7;function Vh(n,t){let e=null;try{a7=a7||Y_(n);let r=t?String(t):"";e=a7.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=a7.getInertBodyElement(r)}while(r!==i);return Y3((new GT).sanitizeChildren(io(e)||e))}finally{if(e){const r=io(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function io(n){return"content"in n&&function R8(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var X1=(()=>((X1=X1||{})[X1.NONE=0]="NONE",X1[X1.HTML=1]="HTML",X1[X1.STYLE=2]="STYLE",X1[X1.SCRIPT=3]="SCRIPT",X1[X1.URL=4]="URL",X1[X1.RESOURCE_URL=5]="RESOURCE_URL",X1))();function D8(n){const t=F6();return t?r7(t.sanitize(X1.HTML,n)||""):so(n,"HTML")?r7(ro(n)):Vh($_(),Jt(n))}function Qc(n){const t=F6();return t?t.sanitize(X1.URL,n)||"":so(n,"URL")?ro(n):jo(Jt(n))}function F6(){const n=ke();return n&&n[12]}const F8=new It("ENVIRONMENT_INITIALIZER"),rv=new It("INJECTOR",-1),sv=new It("INJECTOR_DEF_TYPES");class iv{get(t,e=b8){if(e===b8){const r=new Error(`NullInjectorError: No provider for ${W1(t)}!`);throw r.name="NullInjectorError",r}return e}}function B8(...n){return{\u0275providers:Fh(0,n)}}function Fh(n,...t){const e=[],r=new Set;let s;return _a(t,i=>{const o=i;Jc(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&ov(s,e),e}function ov(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];_a(s,i=>{t.push(i)})}}function Jc(n,t,e,r){if(!(n=Qt(n)))return!1;let s=null,i=a8(n);const o=!i&&E1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=a8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)Jc(h,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{_a(i.imports,g=>{Jc(g,t,e,r)&&(h||(h=[]),h.push(g))})}finally{}void 0!==h&&ov(h,t)}if(!c){const h=da(s)||(()=>new s);t.push({provide:s,useFactory:h,deps:_1},{provide:sv,useValue:s,multi:!0},{provide:F8,useValue:()=>Le(s),multi:!0})}const u=i.providers;null==u||c||_a(u,g=>{t.push(g)})}}return s!==n&&void 0!==n.providers}const jT=v1({provide:String,useValue:v1});function ni(n){return null!==n&&"object"==typeof n&&jT in n}function ol(n){return"function"==typeof n}const $h=new It("Set Injector scope."),l7={},lv={};let Uh;function X3(){return void 0===Uh&&(Uh=new iv),Uh}class Ca{}class u7 extends Ca{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,h7(t,o=>this.processProvider(o)),this.records.set(rv,al(void 0,this)),s.has("environment")&&this.records.set(Ca,al(void 0,this));const i=this.records.get($h);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(sv.multi,_1,Gt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=D6(this),r=Do(void 0);try{return t()}finally{D6(e),Do(r)}}get(t,e=b8,r=Gt.Default){this.assertNotDestroyed();const s=D6(this),i=Do(void 0);try{if(!(r&Gt.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function hv(n){return"function"==typeof n||"object"==typeof n&&n instanceof It}(t)&&In(t);c=u&&this.injectableDefInScope(u)?al(oo(t),l7):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&Gt.Self?X3():this.parent).get(t,e=r&Gt.Optional&&e===b8?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[n2]=o[n2]||[]).unshift(W1(t)),s)throw o;return function TT(n,t,e,r){const s=n[n2];throw t[J5]&&s.unshift(t[J5]),n.message=function Wn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=W1(t);if(Array.isArray(t))s=t.map(W1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):W1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace(ST,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[n2]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{Do(i),D6(s)}}resolveInjectorInitializers(){const t=D6(this),e=Do(void 0);try{const r=this.get(F8.multi,_1,Gt.Self);for(const s of r)s()}finally{D6(t),Do(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(W1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Oe(205,!1)}processProvider(t){let e=ol(t=Qt(t))?t:Qt(t&&t.provide);const r=function YT(n){return ni(n)?al(void 0,n.useValue):al(f7(n),l7)}(t);if(ol(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=al(void 0,l7,!0),s.factory=()=>wh(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===l7&&(e.value=lv,e.value=e.factory()),"object"==typeof e.value&&e.value&&function fv(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Qt(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function oo(n){const t=In(n),e=null!==t?t.factory:da(n);if(null!==e)return e;if(n instanceof It)throw new Oe(204,!1);if(n instanceof Function)return function $8(n){const t=n.length;if(t>0)throw nl(t,"?"),new Oe(204,!1);const e=function c_(n){const t=n&&(n[p6]||n[G9]);if(t){const e=function Qs(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Oe(204,!1)}function f7(n,t,e){let r;if(ol(n)){const s=Qt(n);return da(s)||oo(s)}if(ni(n))r=()=>Qt(n.useValue);else if(function cv(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...wh(n.deps||[]));else if(function Bh(n){return!(!n||!n.useExisting)}(n))r=()=>Le(Qt(n.useExisting));else{const s=Qt(n&&(n.useClass||n.provide));if(!function uv(n){return!!n.deps}(n))return da(s)||oo(s);r=()=>new s(...wh(n.deps))}return r}function al(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function KT(n){return!!n.\u0275providers}function h7(n,t){for(const e of n)Array.isArray(e)?h7(e,t):KT(e)?h7(e.\u0275providers,t):t(e)}class dv{}class ew{resolveComponentFactory(t){throw function QT(n){const t=Error(`No component factory found for ${W1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let ya=(()=>{class n{}return n.NULL=new ew,n})();function lF(){return B6(xr(),ke())}function B6(n,t){return new ri(K2(n,t))}let ri=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=lF,n})();function d7(n){return n instanceof ri?n.nativeElement:n}class $6{}let ao=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function tw(){const n=ke(),e=P2(xr().index,n);return(to(e)?e:n)[11]}(),n})(),uF=(()=>{class n{}return n.\u0275prov=Je({token:n,providedIn:"root",factory:()=>null}),n})();class U6{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const pv=new U6("14.2.10"),qh={};function Zh(n){return n.ngOriginalError}class G6{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Zh(t);for(;e&&Zh(e);)e=Zh(e);return e||null}}const uw=/^>|^->|<!--|-->|--!>|<!-$/g,fw=/(<|>)/;const Yh=new Map;let vv=0;const _7="__ngContext__";function N2(n,t){to(t)?(n[_7]=t[20],function _w(n){Yh.set(n[20],n)}(t)):n[_7]=t}function Ea(n){return n instanceof Function?n():n}var ii=(()=>((ii=ii||{})[ii.Important=1]="Important",ii[ii.DashCase=2]="DashCase",ii))();let Qh;function Jh(n,t){return Qh(n,t)}function W8(n){const t=n[3];return Cr(t)?t[3]:t}function ed(n){return sc(n[13])}function td(n){return sc(n[4])}function sc(n){for(;null!==n&&!Cr(n);)n=n[4];return n}function cl(n,t,e,r,s){if(null!=r){let i,o=!1;Cr(r)?i=r:to(r)&&(o=!0,r=r[0]);const c=yr(r);0===n&&null!==e?null==s?kv(t,e,c):n3(t,e,c,s||null,!0):1===n&&null!==e?n3(t,e,c,s||null,!0):2===n?Hv(t,c,o):3===n&&t.destroyNode(c),null!=i&&function Vw(n,t,e,r,s){const i=e[7];i!==yr(e)&&cl(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];j6(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function nd(n,t){return n.createText(t)}function Nv(n,t,e){n.setValue(t,e)}function Nw(n,t){return n.createComment(function _v(n){return n.replace(uw,t=>t.replace(fw,"\u200b$1\u200b"))}(t))}function rd(n,t,e){return n.createElement(t,e)}function Av(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,rh(s,-1)),e.splice(r,1)}function sd(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&Av(s,r),t>0&&(n[e-1][4]=r[4]);const i=L6(n,10+t);!function Aw(n,t){j6(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function Iv(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&j6(n,t,e,3,null,null),function kw(n){let t=n[13];if(!t)return id(n[1],n);for(;t;){let e=null;if(to(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)to(t)&&id(t[1],t),t=t[3];null===t&&(t=n),to(t)&&id(t[1],t),e=t&&t[4]}t=e}}(t)}}function id(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function Dw(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof C8)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function od(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):yr(t[o]),u=r[s=e[i+2]],h=e[i+3];"boolean"==typeof h?c.removeEventListener(e[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Cr(t[3])){e!==t[3]&&Av(e,t);const r=t[19];null!==r&&r.detachView(n)}!function vw(n){Yh.delete(n[20])}(t)}}function xv(n,t,e){return ad(n,t.parent,e)}function ad(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===L1.None||s===L1.Emulated)return null}return K2(r,e)}function n3(n,t,e,r,s){n.insertBefore(t,e,r,s)}function kv(n,t,e){n.appendChild(t,e)}function r3(n,t,e,r,s){null!==r?n3(n,t,e,r,s):kv(n,t,e)}function W6(n,t){return n.parentNode(t)}function Dv(n,t,e){return Vv(n,t,e)}function zv(n,t,e){return 40&n.type?K2(n,e):null}let cd,Vv=zv;function C7(n,t){Vv=n,cd=t}function q8(n,t,e,r){const s=xv(n,r,t),i=t[11],c=Dv(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)r3(i,s,e[u],c,!1);else r3(i,s,e,c,!1);void 0!==cd&&cd(i,r,t,e,s)}function j8(n,t){if(null!==t){const e=t.type;if(3&e)return K2(t,n);if(4&e)return q6(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return j8(n,r);{const s=n[t.index];return Cr(s)?q6(-1,s):yr(s)}}if(32&e)return Jh(t,n)()||yr(n[t.index]);{const r=ll(n,t);return null!==r?Array.isArray(r)?r[0]:j8(W8(n[16]),r):j8(n,t.next)}}return null}function ll(n,t){return null!==t?n[16][6].projection[t.projection]:null}function q6(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return j8(r,s)}return t[7]}function Hv(n,t,e){const r=W6(n,t);r&&function Lv(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function ld(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&N2(yr(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)ld(n,t,e.child,r,s,i,!1),cl(t,n,s,c,i);else if(32&u){const h=Jh(e,r);let g;for(;g=h();)cl(t,n,s,g,i);cl(t,n,s,c,i)}else 16&u?Fv(n,t,r,e,s,i):cl(t,n,s,c,i);e=o?e.projectionNext:e.next}}function j6(n,t,e,r,s,i){ld(e,r,n.firstChild,t,s,i,!1)}function Fv(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)cl(t,n,s,u[h],i);else ld(n,t,u,o[3],s,i,!0)}function Z8(n,t,e){n.setAttribute(t,"style",e)}function y7(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function $v(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const Uv="ng-template";function ud(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==$v(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function Y8(n){return 4===n.type&&n.value!==Uv}function Gv(n,t,e){return t===(4!==n.type||e?n.value:Uv)}function Hw(n,t,e){let r=4;const s=n.attrs||[],i=function Fw(n){for(let t=0;t<n.length;t++)if(b_(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!Gv(n,u,e)||""===u&&1===t.length){if(Ma(r))return!1;o=!0}}else{const h=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!ud(n.attrs,h,e)){if(Ma(r))return!1;o=!0}continue}const m=Wv(8&r?"class":u,s,Y8(n),e);if(-1===m){if(Ma(r))return!1;o=!0;continue}if(""!==h){let C;C=m>i?"":s[m+1].toLowerCase();const w=8&r?C:null;if(w&&-1!==$v(w,h,0)||2&r&&h!==C){if(Ma(r))return!1;o=!0}}}}else{if(!o&&!Ma(r)&&!Ma(u))return!1;if(o&&Ma(u))continue;o=!1,r=u|1&r}}return Ma(r)||o}function Ma(n){return 0==(1&n)}function Wv(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function Bw(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function qv(n,t,e=!1){for(let r=0;r<t.length;r++)if(Hw(n,t[r],e))return!0;return!1}function Zv(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function fd(n,t){return n?":not("+t.trim()+")":t}function $w(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!Ma(o)&&(t+=fd(i,s),s=""),r=o,i=i||!Ma(r);e++}return""!==s&&(t+=fd(i,s)),t}const un={};function S(n){Kv(Kn(),ke(),Q2()+n,!1)}function Kv(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&pa(t,i,e)}else{const i=n.preOrderHooks;null!==i&&_8(t,i,0,e)}qc(e)}function gd(n,t=null,e=null,r){const s=Jv(n,t,e,r);return s.resolveInjectorInitializers(),s}function Jv(n,t=null,e=null,r,s=new Set){const i=[e||_1,B8(n)];return r=r||("object"==typeof n?void 0:W1(n)),new u7(i,t||X3(),r||null,s)}let s2=(()=>{class n{static create(e,r){if(Array.isArray(e))return gd({name:""},r,e,"");{const s=e.name??"";return gd({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=b8,n.NULL=new iv,n.\u0275prov=Je({token:n,providedIn:"any",factory:()=>Le(rv)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,t=Gt.Default){const e=ke();return null===e?Le(n,t):W5(xr(),e,Qt(n),t)}function P7(){throw new Error("invalid")}function T7(n,t){return n<<17|t<<2}function Sa(n){return n>>17&32767}function Sd(n){return 2|n}function ic(n){return(131068&n)>>2}function fl(n,t){return-131069&n|t<<2}function Pd(n){return 1|n}function hC(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];p8(s),o.contentQueries(2,t[i],i)}}}function A7(n,t,e,r,s,i,o,c,u,h,g){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==g||n&&1024&n[2])&&(m[2]|=1024),C_(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function cr(){return vv++}(),m[21]=g,m[16]=2==t.type?n[16]:m,m}function Y6(n,t,e,r,s){let i=n.data[t];if(null===i)i=I7(n,t,e,r,s),function Go(){return rn.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=j4();i.injectorIndex=null===o?-1:o.injectorIndex}return Ja(i,!0),i}function I7(n,t,e,r,s){const i=y_(),o=Gr(),u=n.data[t]=function zF(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function hl(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function x7(n,t,e){Z4(t);try{const r=n.viewQuery;null!==r&&Dd(1,r,e);const s=n.template;null!==s&&dC(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&hC(n,t),n.staticViewQueries&&Dd(2,n.viewQuery,e);const i=n.components;null!==i&&function pb(n,t){for(let e=0;e<t.length;e++)GF(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,Y4()}}function k7(n,t,e,r){const s=t[2];if(128!=(128&s)){Z4(t);try{C_(t),function E_(n){return rn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&dC(n,t,e,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&pa(t,h,null)}else{const h=n.preOrderHooks;null!==h&&_8(t,h,0,null),v8(t,0)}if(function UF(n){for(let t=ed(n);null!==t;t=td(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&rh(i,1),s[2]|=512}}}(t),function Pb(n){for(let t=ed(n);null!==t;t=td(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];M6(r)&&k7(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&hC(n,t),o){const h=n.contentCheckHooks;null!==h&&pa(t,h)}else{const h=n.contentHooks;null!==h&&_8(t,h,1),v8(t,1)}!function Id(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)qc(~s);else{const i=s,o=e[++r],c=e[++r];mT(o,i),c(2,t[i])}}}finally{qc(-1)}}(n,t);const c=n.components;null!==c&&function db(n,t){for(let e=0;e<t.length;e++)Tb(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&Dd(2,u,r),o){const h=n.viewCheckHooks;null!==h&&pa(t,h)}else{const h=n.viewHooks;null!==h&&_8(t,h,2),v8(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,rh(t[3],-1))}finally{Y4()}}}function dC(n,t,e,r,s){const i=Q2(),o=2&r;try{qc(-1),o&&t.length>22&&Kv(n,t,22,!1),e(r,s)}finally{qc(i)}}function pC(n,t,e){if(Ri(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function xd(n,t,e){!sh()||(function vC(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||G5(e,t),N2(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=ms(u);h&&Mb(t,e,u);const g=Ls(t,n,c,e);N2(g,t),null!==o&&$F(0,c-s,g,u,0,o),h&&(P2(e.index,t)[8]=g)}}(n,t,e,K2(e,t)),128==(128&e.flags)&&function Cb(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function ah(){return rn.lFrame.currentDirectiveIndex}();try{qc(i);for(let c=r;c<s;c++){const u=n.data[c],h=t[c];Wc(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&yb(u,h)}}finally{qc(-1),Wc(o)}}(n,t,e))}function K6(n,t,e=K2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function gC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=mC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function mC(n,t,e,r,s,i,o,c,u,h){const g=22+r,m=g+s,C=function gb(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:un);return e}(g,m),w="function"==typeof h?h():h;return C[1]={type:n,blueprint:C,template:e,queries:null,viewQuery:c,declTNode:t,data:C.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:w,incompleteFirstPass:!1}}function _b(n,t,e,r){const s=TC(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&wC(n).push(r,s.length-1))}function X6(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function L7(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let h=t.directiveStart;h<r;h++){const g=s[h],m=g.inputs,C=null===i||Y8(t)?null:Sb(m,i);o.push(C),c=X6(m,h,c),u=X6(g.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function co(n,t,e,r,s,i,o,c){const u=K2(t,e);let g,h=t.inputs;!c&&null!=h&&(g=h[r])?(H7(n,e,g,r,s),Fo(t)&&_C(e,t.index)):3&t.type&&(r=function R7(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function _C(n,t){const e=P2(t,n);16&e[2]||(e[2]|=32)}function dl(n,t,e,r){let s=!1;if(sh()){const i=function CC(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];qv(e,o.selectors,!1)&&(s||(s=[]),O6(G5(e,t),n,o.type),ms(o)?(kd(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,yC(e,n.data.length,i.length);for(let g=0;g<i.length;g++){const m=i[g];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=hl(n,t,i.length,null);for(let g=0;g<i.length;g++){const m=i[g];e.mergedAttrs=b6(e.mergedAttrs,m.hostAttrs),EC(n,e,t,h,m),BF(h,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const C=m.type.prototype;!c&&(C.ngOnChanges||C.ngOnInit||C.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(C.ngOnChanges||C.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),h++}L7(n,e)}o&&function Eb(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Oe(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=b6(e.mergedAttrs,e.attrs),s}function D7(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function vb(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function yb(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function kd(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function BF(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;ms(t)&&(e[""]=n)}}function yC(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function EC(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=da(s.type)),o=new C8(i,ms(s),Q);n.blueprint[r]=o,e[r]=o,D7(n,t,0,r,hl(n,e,s.hostVars,un),s)}function Mb(n,t,e){const r=K2(t,n),s=gC(e),i=n[10],o=z7(n,A7(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function oc(n,t,e,r,s,i){const o=K2(n,t);Ld(t[11],o,i,n.value,e,r,s)}function Ld(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?Jt(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function $F(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],g=o[u++],m=o[u++];null!==c?r.setInput(e,m,h,g):e[g]=m}}}function Sb(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function MC(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function Tb(n,t){const e=P2(t,n);if(M6(e)){const r=e[1];48&e[2]?k7(r,e,r.template,e[8]):e[5]>0&&Rd(e)}}function Rd(n){for(let r=ed(n);null!==r;r=td(r))for(let s=10;s<r.length;s++){const i=r[s];if(M6(i))if(512&i[2]){const o=i[1];k7(o,i,o.template,i[8])}else i[5]>0&&Rd(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=P2(e[r],n);M6(s)&&s[5]>0&&Rd(s)}}function GF(n,t){const e=P2(t,n),r=e[1];(function wb(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),x7(r,e,e[8])}function z7(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function SC(n){for(;n;){n[2]|=32;const t=W8(n);if(C6(n)&&!t)return n;n=t}return null}function V7(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{k7(n,t,n.template,e)}catch(o){throw r&&OC(t,o),o}finally{s.end&&s.end()}}function Dd(n,t,e){p8(0),t(n,e)}function TC(n){return n[7]||(n[7]=[])}function wC(n){return n.cleanup||(n.cleanup=[])}function OC(n,t){const e=n[9],r=e?e.get(G6,null):null;r&&r.handleError(t)}function H7(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function i3(n,t,e){const r=h8(t,n);Nv(n[11],r,e)}function X8(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=s8(s,c):2==i&&(r=s8(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function F7(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(yr(i)),Cr(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&F7(u[1],u,h,r)}const o=e.type;if(8&o)F7(n,t,e.child,r);else if(32&o){const c=Jh(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=ll(t,e);if(Array.isArray(c))r.push(...c);else{const u=W8(t[16]);F7(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class B7{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return F7(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Cr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(sd(t,r),L6(e,r))}this._attachedToViewContainer=!1}Iv(this._lView[1],this._lView)}onDestroy(t){_b(this._lView[1],this._lView,null,t)}markForCheck(){SC(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){V7(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Oe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function xw(n,t){j6(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Oe(902,!1);this._appRef=t}}class Ob extends B7{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;V7(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class zd extends ya{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=E1(t);return new Q8(e,this.ngModule)}}function Nb(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class AC{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,qh,r);return s!==qh||e===qh?s:this.parentInjector.get(t,e,r)}}class Q8 extends dv{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function Uw(n){return n.map($w).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Nb(this.componentDef.inputs)}get outputs(){return Nb(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof Ca?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new AC(t,i):t,c=o.get($6,null);if(null===c)throw new Oe(407,!1);const u=o.get(uF,null),h=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function mb(n,t,e){return n.selectRootElement(t,e===L1.ShadowDom)}(h,r,this.componentDef.encapsulation):rd(h,g,function NC(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(g)),C=this.componentDef.onPush?288:272,w=mC(0,null,null,1,0,null,null,null,null,null),I=A7(null,w,null,C,null,null,c,h,u,o,null);let H,Y;Z4(I);try{const ee=function Ib(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=Y6(o,22,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(X8(u,h,!0),null!==n&&(tc(s,n,h),null!==u.classes&&y7(s,n,u.classes),null!==u.styles&&Z8(s,n,u.styles)));const g=r.createRenderer(n,t),m=A7(e,gC(t),null,t.onPush?32:16,e[22],u,r,g,i||null,null,null);return o.firstCreatePass&&(O6(G5(u,e),o,t.type),kd(o,u),yC(u,e.length,1)),z7(e,m),e[22]=m}(m,this.componentDef,I,c,h);if(m)if(r)tc(h,m,["ng-version",pv.full]);else{const{attrs:_e,classes:te}=function Yv(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!Ma(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);_e&&tc(h,m,_e),te&&te.length>0&&y7(h,m,te.join(" "))}if(Y=nh(w,22),void 0!==e){const _e=Y.projection=[];for(let te=0;te<this.ngContentSelectors.length;te++){const Ae=e[te];_e.push(null!=Ae?Array.from(Ae):null)}}H=function xC(n,t,e,r){const s=e[1],i=function FF(n,t,e){const r=xr();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),EC(n,r,t,hl(n,t,1,null),e),L7(n,r));const s=Ls(t,n,r.directiveStart,r);N2(s,t);const i=K2(r,t);return i&&N2(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=xr();t.contentQueries(1,i,c.directiveStart)}const o=xr();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(qc(o.index),D7(e[1],o,0,o.directiveStart,o.directiveEnd,t),yb(t,i)),i}(ee,this.componentDef,I,[d]),x7(w,I,null)}finally{Y4()}return new Ab(this.componentType,H,B6(Y,I),I,Y)}}class Ab extends class XT{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new Ob(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;H7(i[1],i,s,t,e),_C(i,this._tNode.index)}}get injector(){return new N6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function d(){const n=xr();Yc(ke()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(ms(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Oe(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=p(n.inputs),o.declaredInputs=p(n.declaredInputs),o.outputs=p(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&y(n,h),F9(n.inputs,s.inputs),F9(n.declaredInputs,s.declaredInputs),F9(n.outputs,s.outputs),ms(s)&&s.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=b6(s.hostAttrs,e=b6(e,s.hostAttrs))}}(r)}function p(n){return n===Z?{}:n===_1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function y(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function N(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let re=null;function Se(){if(!re){const n=K1.Symbol;if(n&&n.iterator)re=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(re=r)}}}return re}function De(n){return!!_t(n)&&(Array.isArray(n)||!(n instanceof Map)&&Se()in n)}function _t(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function pn(n,t,e){return n[t]=e}function N1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function oi(n,t,e,r){const s=N1(n,t,e);return N1(n,t+1,r)||s}function D(n,t,e,r){const s=ke();return N1(s,P6(),t)&&(Kn(),oc(M1(),s,n,t,e,r)),D}function h1(n,t,e,r){return N1(n,P6(),e)?t+Jt(e)+r:un}function Rs(n,t,e,r,s,i){const c=oi(n,ec(),e,s);return Uo(2),c?t+Jt(e)+r+Jt(s)+i:un}function Zo(n,t,e,r,s,i,o,c){const h=function Ta(n,t,e,r,s){const i=oi(n,t,e,r);return N1(n,t+2,s)||i}(n,ec(),e,s,o);return Uo(3),h?t+Jt(e)+r+Jt(s)+i+Jt(o)+c:un}function J8(n,t,e,r,s,i){const o=ke(),c=h1(o,t,e,r);return c!==un&&oc(M1(),o,n,c,s,i),J8}function k(n,t,e,r,s,i,o,c){const u=ke(),h=Kn(),g=n+22,m=h.firstCreatePass?function X3e(n,t,e,r,s,i,o,c,u){const h=t.consts,g=Y6(t,n,4,o||null,Gc(h,c));dl(t,e,g,Gc(h,u)),Yc(t,g);const m=g.tViews=mC(2,g,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,g),m.queries=t.queries.embeddedTView(g)),g}(g,h,u,t,e,r,s,i,o):h.data[g];Ja(m,!1);const C=u[11].createComment("");q8(h,u,C,m),N2(C,u),z7(u,u[g]=MC(C,u,C,m)),Bo(m)&&xd(h,u,m),null!=o&&K6(u,m,c)}function t1(n){return q4(function H5(){return rn.lFrame.contextLView}(),22+n)}function T(n,t,e){const r=ke();return N1(r,P6(),t)&&co(Kn(),M1(),r,n,t,r[11],e,!1),T}function xb(n,t,e,r,s){const o=s?"class":"style";H7(n,e,t.inputs[o],o,r)}function b(n,t,e,r){const s=ke(),i=Kn(),o=22+n,c=s[11],u=s[o]=rd(c,t,function Zc(){return rn.lFrame.currentNamespace}()),h=i.firstCreatePass?function J3e(n,t,e,r,s,i,o){const c=t.consts,h=Y6(t,n,2,s,Gc(c,i));return dl(t,e,h,Gc(c,o)),null!==h.attrs&&X8(h,h.attrs,!1),null!==h.mergedAttrs&&X8(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(o,i,s,0,t,e,r):i.data[o];Ja(h,!0);const g=h.mergedAttrs;null!==g&&tc(c,u,g);const m=h.classes;null!==m&&y7(c,u,m);const C=h.styles;return null!==C&&Z8(c,u,C),64!=(64&h.flags)&&q8(i,s,u,h),0===function uT(){return rn.lFrame.elementDepthCount}()&&N2(u,s),function fT(){rn.lFrame.elementDepthCount++}(),Bo(h)&&(xd(i,s,h),pC(i,h,s)),null!==r&&K6(s,h),b}function O(){let n=xr();Gr()?ih():(n=n.parent,Ja(n,!1));const t=n;!function hT(){rn.lFrame.elementDepthCount--}();const e=Kn();return e.firstCreatePass&&(Yc(e,n),Ri(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function fh(n){return 0!=(16&n.flags)}(t)&&xb(e,t,ke(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function y8(n){return 0!=(32&n.flags)}(t)&&xb(e,t,ke(),t.stylesWithoutHost,!1),O}function X(n,t,e,r){return b(n,t,e,r),O(),X}function an(n,t,e){const r=ke(),s=Kn(),i=n+22,o=s.firstCreatePass?function e4e(n,t,e,r,s){const i=t.consts,o=Gc(i,r),c=Y6(t,n,8,"ng-container",o);return null!==o&&X8(c,o,!0),dl(t,e,c,Gc(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];Ja(o,!0);const c=r[i]=r[11].createComment("");return q8(s,r,c,o),N2(c,r),Bo(o)&&(xd(s,r,o),pC(s,o,r)),null!=e&&K6(r,o),an}function cn(){let n=xr();const t=Kn();return Gr()?ih():(n=n.parent,Ja(n,!1)),t.firstCreatePass&&(Yc(t,n),Ri(n)&&t.queries.elementEnd(n)),cn}function Te(){return ke()}function Vd(n){return!!n&&"function"==typeof n.then}const kb=function nB(n){return!!n&&"function"==typeof n.subscribe};function J(n,t,e,r){const s=ke(),i=Kn(),o=xr();return function sB(n,t,e,r,s,i,o,c){const u=Bo(r),g=n.firstCreatePass&&wC(n),m=t[8],C=TC(t);let w=!0;if(3&r.type||c){const Y=K2(r,t),ee=c?c(Y):Y,_e=C.length,te=c?Fe=>c(yr(Fe[r.index])):r.index;let Ae=null;if(!c&&u&&(Ae=function t4e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==Ae)(Ae.__ngLastListenerFn__||Ae).__ngNextListenerFn__=i,Ae.__ngLastListenerFn__=i,w=!1;else{i=oB(r,t,m,i,!1);const Fe=e.listen(ee,s,i);C.push(i,Fe),g&&g.push(s,te,_e,_e+1)}}else i=oB(r,t,m,i,!1);const I=r.outputs;let H;if(w&&null!==I&&(H=I[s])){const Y=H.length;if(Y)for(let ee=0;ee<Y;ee+=2){const Ze=t[H[ee]][H[ee+1]].subscribe(i),zt=C.length;C.push(i,Ze),g&&g.push(s,r.index,zt,-(zt+1))}}}(i,s,s[11],o,n,t,0,r),J}function iB(n,t,e,r){try{return!1!==e(r)}catch(s){return OC(n,s),!1}}function oB(n,t,e,r,s){return function i(o){if(o===Function)return r;SC(2&n.flags?P2(n.index,t):t);let u=iB(t,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=iB(t,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function v(n=1){return function $5(n){return(rn.lFrame.contextLView=function m8(n,t){for(;n>0;)t=t[15],n--;return t}(n,rn.lFrame.contextLView))[8]}(n)}function n4e(n,t){let e=null;const r=function jv(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?qv(n,i,!0):Zv(r,i))return s}else e=s}return e}function Lb(n,t,e){return S1(n,"",t,"",e),Lb}function S1(n,t,e,r,s){const i=ke(),o=h1(i,t,e,r);return o!==un&&co(Kn(),M1(),i,n,o,i[11],s,!1),S1}function We(n,t,e,r,s,i,o){const c=ke(),u=Rs(c,t,e,r,s,i);return u!==un&&co(Kn(),M1(),c,n,u,c[11],o,!1),We}function Ko(n,t,e,r,s,i,o,c,u){const h=ke(),g=Zo(h,t,e,r,s,i,o,c);return g!==un&&co(Kn(),M1(),h,n,g,h[11],u,!1),Ko}function gB(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?Sa(i):ic(i),u=!1;for(;0!==c&&(!1===u||o);){const g=n[c+1];i4e(n[c],t)&&(u=!0,n[c+1]=r?Pd(g):Sd(g)),c=r?Sa(g):ic(g)}u&&(n[e+1]=r?Sd(i):Pd(i))}function i4e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&ti(n,t)>=0}const o2={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function mB(n){return n.substring(o2.key,o2.keyEnd)}function o4e(n){return n.substring(o2.value,o2.valueEnd)}function vB(n,t){const e=o2.textEnd;let r=o2.key=$7(n,t,e);return e===r?-1:(r=o2.keyEnd=function u4e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=yB(n,r,e),r=o2.value=$7(n,r,e),r=o2.valueEnd=function f4e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=EB(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=EB(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),yB(n,r,e))}function $7(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function yB(n,t,e,r){return(t=$7(n,t,e))<e&&t++,t}function EB(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function kC(n,t){return function o3(n,t,e,r){const s=ke(),i=Kn(),o=Uo(2);i.firstUpdatePass&&PB(i,n,o,r),t!==un&&N1(s,o,t)&&wB(i,i.data[Q2()],s,s[11],n,s[o+1]=function y4e(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=W1(ro(n)))),n}(t,e),r,o)}(n,t,null,!0),kC}function ci(n){!function a3(n,t,e,r){const s=Kn(),i=Uo(2);s.firstUpdatePass&&PB(s,null,i,r);const o=ke();if(e!==un&&N1(o,i,e)){const c=s.data[Q2()];if(OB(c,r)&&!SB(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=s8(u,e||"")),xb(s,c,o,e,r)}else!function C4e(n,t,e,r,s,i,o,c){s===un&&(s=_1);let u=0,h=0,g=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==g||null!==m;){const C=u<s.length?s[u+1]:void 0,w=h<i.length?i[h+1]:void 0;let H,I=null;g===m?(u+=2,h+=2,C!==w&&(I=m,H=w)):null===m||null!==g&&g<m?(u+=2,I=g):(h+=2,I=m,H=w),null!==I&&wB(n,t,e,r,I,H,o,c),g=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function v4e(n,t,e){if(null==e||""===e)return _1;const r=[],s=ro(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(TB,h4e,n,!1)}function h4e(n,t){for(let e=function c4e(n){return function CB(n){o2.key=0,o2.keyEnd=0,o2.value=0,o2.valueEnd=0,o2.textEnd=n.length}(n),vB(n,$7(n,0,o2.textEnd))}(t);e>=0;e=vB(t,e))TB(n,mB(t),o4e(t))}function SB(n,t){return t>=n.expandoStartIndex}function PB(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[Q2()],o=SB(n,e);OB(i,r)&&null===t&&!o&&(t=!1),t=function p4e(n,t,e,r){const s=function F5(n){const t=rn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=Hd(e=Rb(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=Rb(s,n,t,e,r),null===i){let u=function g4e(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==ic(r))return n[Sa(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=Rb(null,n,t,u[1],r),u=Hd(u,t.attrs,r),function m4e(n,t,e,r){n[Sa(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function _4e(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=Hd(r,n[i].hostAttrs,e);return Hd(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function r4e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=Sa(o),u=ic(o);n[r]=e;let g,h=!1;if(Array.isArray(e)){const m=e;g=m[1],(null===g||ti(m,g)>0)&&(h=!0)}else g=e;if(s)if(0!==u){const C=Sa(n[c+1]);n[r+1]=T7(C,c),0!==C&&(n[C+1]=fl(n[C+1],r)),n[c+1]=function TF(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=T7(c,0),0!==c&&(n[c+1]=fl(n[c+1],r)),c=r;else n[r+1]=T7(u,0),0===c?c=r:n[u+1]=fl(n[u+1],r),u=r;h&&(n[r+1]=Sd(n[r+1])),gB(n,g,r,!0),gB(n,g,r,!1),function s4e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&ti(i,t)>=0&&(e[r+1]=Pd(e[r+1]))}(t,g,n,r,i),o=T7(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function Rb(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=Hd(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function Hd(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ei(n,o,!!e||t[++i]))}return void 0===n?null:n}function TB(n,t,e){ei(n,t,ro(e))}function wB(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,h=u[c+1];LC(function oC(n){return 1==(1&n)}(h)?bB(u,t,e,s,ic(h),o):void 0)||(LC(i)||function nb(n){return 2==(2&n)}(h)&&(i=bB(u,null,e,s,c,o)),function Bv(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:ii.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=ii.Important),n.setStyle(e,r,s,i))}}(r,o,h8(Q2(),e),s,i))}function bB(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),g=h?u[1]:u,m=null===g;let C=e[s+1];C===un&&(C=m?_1:void 0);let w=m?t2(C,r):g===r?C:void 0;if(h&&!LC(w)&&(w=t2(u,r)),LC(w)&&(c=w,o))return c;const I=n[s+1];s=o?Sa(I):ic(I)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=t2(u,r))}return c}function LC(n){return void 0!==n}function OB(n,t){return 0!=(n.flags&(t?16:32))}function St(n,t=""){const e=ke(),r=Kn(),s=n+22,i=r.firstCreatePass?Y6(r,s,1,t,null):r.data[s],o=e[s]=nd(e[11],t);q8(r,e,o,i),Ja(i,!1)}function a1(n){return zi("",n,""),a1}function zi(n,t,e){const r=ke(),s=h1(r,n,t,e);return s!==un&&i3(r,Q2(),s),zi}function RC(n,t,e,r,s){const i=ke(),o=Rs(i,n,t,e,r,s);return o!==un&&i3(i,Q2(),o),RC}function Db(n,t,e,r,s,i,o){const c=ke(),u=Zo(c,n,t,e,r,s,i,o);return u!==un&&i3(c,Q2(),u),Db}function zb(n,t,e){const r=ke();return N1(r,P6(),t)&&co(Kn(),M1(),r,n,t,r[11],e,!0),zb}const eu=void 0;var F4e=["en",[["a","p"],["AM","PM"],eu],[["AM","PM"],eu,eu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],eu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],eu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",eu,"{1} 'at' {0}",eu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function H4e(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let U7={};function fo(n){const t=function $4e(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=qB(t);if(e)return e;const r=t.split("-")[0];if(e=qB(r),e)return e;if("en"===r)return F4e;throw new Oe(701,!1)}function qB(n){return n in U7||(U7[n]=K1.ng&&K1.ng.common&&K1.ng.common.locales&&K1.ng.common.locales[n]),U7[n]}var pt=(()=>((pt=pt||{})[pt.LocaleId=0]="LocaleId",pt[pt.DayPeriodsFormat=1]="DayPeriodsFormat",pt[pt.DayPeriodsStandalone=2]="DayPeriodsStandalone",pt[pt.DaysFormat=3]="DaysFormat",pt[pt.DaysStandalone=4]="DaysStandalone",pt[pt.MonthsFormat=5]="MonthsFormat",pt[pt.MonthsStandalone=6]="MonthsStandalone",pt[pt.Eras=7]="Eras",pt[pt.FirstDayOfWeek=8]="FirstDayOfWeek",pt[pt.WeekendRange=9]="WeekendRange",pt[pt.DateFormat=10]="DateFormat",pt[pt.TimeFormat=11]="TimeFormat",pt[pt.DateTimeFormat=12]="DateTimeFormat",pt[pt.NumberSymbols=13]="NumberSymbols",pt[pt.NumberFormats=14]="NumberFormats",pt[pt.CurrencyCode=15]="CurrencyCode",pt[pt.CurrencySymbol=16]="CurrencySymbol",pt[pt.CurrencyName=17]="CurrencyName",pt[pt.Currencies=18]="Currencies",pt[pt.Directionality=19]="Directionality",pt[pt.PluralCase=20]="PluralCase",pt[pt.ExtraData=21]="ExtraData",pt))();const U4e=["zero","one","two","few","many"],G7="en-US",DC={marker:"element"},zC={marker:"ICU"};var is=(()=>((is=is||{})[is.SHIFT=2]="SHIFT",is[is.APPEND_EAGERLY=1]="APPEND_EAGERLY",is[is.COMMENT=2]="COMMENT",is))();let jB=G7;function ZB(n){(function Ji(n,t){null==n&&y1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(jB=n.toLowerCase().replace(/_/g,"-"))}function YB(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?zv(n,0,e):yr(e[s])}function KB(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)n3(n,o,e[i[u]],c,!1)}}function XB(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];QB(r)||j4e(r,t)&&null===Z4e(r)&&Y4e(r,t.index)}}function QB(n){return!(64&n.type)}function j4e(n,t){return QB(t)||n.index>t.index}function Z4e(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Y4e(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(C7(YB,KB),n.insertBeforeIndex=t)}function Fd(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function Q4e(n,t,e){const r=I7(n,e,64,null,null);return XB(t,r),r}function VC(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function JB(n){return n>>>17}function e$(n){return(131070&n)>>>1}let Bd=0,$d=0;function n$(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const h=t[++c];null===e[h]&&(e[h]=nd(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=JB(u);let g,m;if(null===i&&(i=h,o=W6(s,r)),h===i?(g=r,m=o):(g=null,m=yr(e[h])),null!==m){const H=e$(u);n3(s,m,e[H],g,!1);const ee=Fd(n,H);if(null!==ee&&"object"==typeof ee){const _e=VC(ee,e);null!==_e&&n$(n,ee.create[_e],e,e[ee.anchorIdx])}}break;case 1:const w=t[++c],I=t[++c];Ld(s,h8(u>>>1,e),null,null,w,I,null)}else switch(u){case zC:const h=t[++c],g=t[++c];null===e[g]&&N2(e[g]=Nw(s,h),e);break;case DC:const m=t[++c],C=t[++c];null===e[C]&&N2(e[C]=rd(s,m,null),e)}}}function r$(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const g=e[h];if("string"==typeof g)u+=g;else if("number"==typeof g)if(g<0)u+=Jt(t[r-g]);else{const m=g>>>2;switch(3&g){case 1:const C=e[++h],w=e[++h],I=n.data[m];"string"==typeof I?Ld(t[11],t[m],null,I,C,u,w):co(n,I,t,C,u,t[11],w,!1);break;case 0:const H=t[m];null!==H&&Nv(t[11],H,u);break;case 2:rle(n,Fd(n,m),t,u);break;case 3:s$(n,Fd(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const g=Fd(n,u>>>2);t[g.currentCaseLViewIndex]<0&&s$(n,g,r,t)}}i+=c}}function s$(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=Bd;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),r$(n,r,t.update[s],e,i)}}function rle(n,t,e,r){const s=function sle(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function G4e(n,t){const e=function WB(n){return fo(n)[pt.PluralCase]}(t)(parseInt(n,10)),r=U4e[e];return void 0!==r?r:"other"}(t,function q4e(){return jB}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(VC(t,e)!==s&&(i$(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&n$(n,t.create[s],e,o)}}function i$(n,t,e){let r=VC(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=h8(o,e);null!==c&&Hv(e[11],c)}else i$(n,Fd(n,~o),e)}}}function ile(){const n=[];let e,r,t=-1;function i(c,u){t=0;const h=VC(c,u);r=null!==h?c.remove[h]:_1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const HC=/\ufffd(\d+):?\d*\ufffd/gi,ale=/\ufffd(\d+)\ufffd/,a$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,cle=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,lle=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,ule=/\uE500/g;function c$(n,t,e,r,s,i,o){const c=hl(n,r,1,null);let u=c<<is.SHIFT,h=j4();t===h&&(h=null),null===h&&(u|=is.APPEND_EAGERLY),o&&(u|=is.COMMENT,function bv(n){void 0===Qh&&(Qh=n())}(ile)),s.push(u,null===i?"":i);const g=I7(n,c,o?32:1,null===i?"":i,null);XB(e,g);const m=g.index;return Ja(g,!1),null!==h&&t!==h&&function X4e(n,t){let e=n.insertBeforeIndex;null===e?(C7(YB,KB),e=n.insertBeforeIndex=[null,t]):(function f1(n,t,e){n!=t&&y1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(h,m),g}function dle(n,t,e,r,s,i,o){const c=o.match(HC),u=c$(n,t,e,i,r,c?null:o,!1);c&&Gd(s,o,u.index,null,0,null)}function Gd(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=t.split(HC);let g=0;for(let m=0;m<h.length;m++){const C=h[m];if(1&m){const w=s+parseInt(C,10);n.push(-1-w),g|=l$(w)}else""!==C&&n.push(C)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=g,n[c]=n.length-u,g}function l$(n){return 1<<Math.min(n,31)}function u$(n){let t,i,e="",r=0,s=!1;for(;null!==(t=cle.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function f$(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:hl(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function Ele(n,t,e){n.push(l$(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function K4e(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const g=u[h],m=[];for(let C=0;C<g.length;C++){const w=g[C];if("string"!=typeof w){const I=m.push(w)-1;g[C]=`\x3c!--\ufffd${I}\ufffd--\x3e`}}o=Cle(n,c,t,e,r,s.cases[h],g.join(""),m)|o}o&&function Mle(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function vle(n){const t=[],e=[];let r=1,s=0;const i=Vb(n=n.replace(a$,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=Vb(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function Vb(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);a$.test(u)?r.push(vle(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function Cle(n,t,e,r,s,i,o,c){const u=[],h=[],g=[];t.cases.push(i),t.create.push(u),t.remove.push(h),t.update.push(g);const C=Y_($_()).getInertBodyElement(o),w=io(C)||C;return w?h$(n,t,e,r,u,h,g,w,s,c,0):0}function h$(n,t,e,r,s,i,o,c,u,h,g){let m=0,C=c.firstChild;for(;C;){const w=hl(n,e,1,null);switch(C.nodeType){case Node.ELEMENT_NODE:const I=C,H=I.tagName.toLowerCase();if(L8.hasOwnProperty(H)){Hb(s,DC,H,u,w),n.data[w]=H;const te=I.attributes;for(let Ae=0;Ae<te.length;Ae++){const Fe=te.item(Ae),Ze=Fe.name.toLowerCase();Fe.value.match(HC)?o7.hasOwnProperty(Ze)&&Gd(o,Fe.value,w,Fe.name,0,i7[Ze]?jo:null):Sle(s,w,Fe)}m=h$(n,t,e,r,s,i,o,C,w,h,g+1)|m,d$(i,w,g)}break;case Node.TEXT_NODE:const Y=C.textContent||"",ee=Y.match(HC);Hb(s,null,ee?"":Y,u,w),d$(i,w,g),ee&&(m=Gd(o,Y,w,null,0,null)|m);break;case Node.COMMENT_NODE:const _e=ale.exec(C.textContent||"");if(_e){const Ae=h[parseInt(_e[1],10)];Hb(s,zC,"",u,w),f$(n,e,r,u,Ae,w),yle(i,w,g)}}C=C.nextSibling}return m}function d$(n,t,e){0===e&&n.push(t)}function yle(n,t,e){0===e&&(n.push(~t),n.push(t))}function Hb(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function J4e(n,t,e){return n|t<<17|e<<1}(0,r,s))}function Sle(n,t,e){n.push(t<<1|1,e.name,e.value)}function ac(n,t,e=-1){const r=Kn(),s=ke(),i=22+n,o=Gc(r.consts,t),c=j4();r.firstCreatePass&&function hle(n,t,e,r,s,i){const o=j4(),c=[],u=[],h=[[]];s=function _le(n,t){if(function mle(n){return-1===n}(t))return u$(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return u$(n.substring(e,r))}}(s,i);const g=function fle(n){return n.replace(ule," ")}(s).split(lle);for(let m=0;m<g.length;m++){let C=g[m];if(0==(1&m)){const w=Vb(C);for(let I=0;I<w.length;I++){let H=w[I];if(0==(1&I)){const Y=H;""!==Y&&dle(n,o,h[0],c,u,e,Y)}else{const Y=H;if("object"!=typeof Y)throw new Error(`Unable to parse ICU expression in "${s}" message.`);f$(n,e,u,t,Y,c$(n,o,h[0],e,c,"",!0).index)}}}else{const w=47===C.charCodeAt(0),H=(C.charCodeAt(w?1:0),22+Number.parseInt(C.substring(w?2:1)));if(w)h.shift(),Ja(j4(),!1);else{const Y=Q4e(n,h[0],H);h.unshift([]),Ja(Y,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],g=ad(r,c===s[6]?null:c,s);(function nle(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&is.COMMENT)===is.COMMENT,h=(o&is.APPEND_EAGERLY)===is.APPEND_EAGERLY,g=o>>>is.SHIFT;let m=n[g];null===m&&(m=n[g]=u?s.createComment(c):nd(s,c)),h&&null!==e&&n3(s,e,m,r,!1)}})(s,u.create,g,c&&8&c.type?s[c.index]:null),X2(!0)}function cc(){X2(!1)}function ge(n,t,e){ac(n,t,e),cc()}function A1(n){return function ele(n){n&&(Bd|=1<<Math.min($d,31)),$d++}(N1(ke(),P6(),n)),A1}function z1(n){!function tle(n,t,e){if($d>0){const r=n.data[e];r$(n,t,Array.isArray(r)?r:r.update,ec()-$d-1,Bd)}Bd=0,$d=0}(Kn(),ke(),n+22)}function Fb(n,t,e,r,s){if(n=Qt(n),Array.isArray(n))for(let i=0;i<n.length;i++)Fb(n[i],t,e,r,s);else{const i=Kn(),o=ke();let c=ol(n)?n:Qt(n.provide),u=f7(n);const h=xr(),g=1048575&h.providerIndexes,m=h.directiveStart,C=h.providerIndexes>>20;if(ol(n)||!n.multi){const w=new C8(u,s,Q),I=$b(c,t,s?g:g+C,m);-1===I?(O6(G5(h,o),i,c),Bb(i,n,t.length),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(w),o.push(w)):(e[I]=w,o[I]=w)}else{const w=$b(c,t,g+C,m),I=$b(c,t,g,g+C),H=w>=0&&e[w],Y=I>=0&&e[I];if(s&&!Y||!s&&!H){O6(G5(h,o),i,c);const ee=function zle(n,t,e,r,s){const i=new C8(n,e,Q);return i.multi=[],i.index=t,i.componentProviders=0,g$(i,s,r&&!e),i}(s?Dle:Rle,e.length,s,r,u);!s&&Y&&(e[I].providerFactory=ee),Bb(i,n,t.length,0),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(ee),o.push(ee)}else Bb(i,n,w>-1?w:I,g$(e[s?I:w],u,!s&&r));!s&&r&&Y&&e[I].componentProviders++}}}function Bb(n,t,e,r){const s=ol(t),i=function ZT(n){return!!n.useClass}(t);if(s||i){const u=(i?Qt(t.useClass):t).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const g=h.indexOf(e);-1===g?h.push(e,[r,u]):h[g+1].push(r,u)}else h.push(e,u)}}}function g$(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function $b(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function Rle(n,t,e,r){return Ub(this.multi,[])}function Dle(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Ls(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),Ub(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],Ub(s,i);return i}function Ub(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Lr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function Lle(n,t,e){const r=Kn();if(r.firstCreatePass){const s=ms(n);Fb(e,r.data,r.blueprint,s,!0),Fb(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class tu{}class m${}class _$ extends tu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new zd(this);const r=eo(t);this._bootstrapComponents=Ea(r.bootstrap),this._r3Injector=Jv(t,e,[{provide:tu,useValue:this},{provide:ya,useValue:this.componentFactoryResolver}],W1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Gb extends m${constructor(t){super(),this.moduleType=t}create(t){return new _$(this.moduleType,t)}}class Hle extends tu{constructor(t,e,r){super(),this.componentFactoryResolver=new zd(this),this.instance=null;const s=new u7([...t,{provide:tu,useValue:this},{provide:ya,useValue:this.componentFactoryResolver}],e||X3(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function FC(n,t,e=null){return new Hle(n,t,e).injector}let Fle=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=Fh(0,e.type),s=r.length>0?FC([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Je({token:n,providedIn:"environment",factory:()=>new n(Le(Ca))}),n})();function v$(n){n.getStandaloneInjector=t=>t.get(Fle).getOrCreateStandaloneInjector(n)}function J1(n,t,e){const r=T2()+n,s=ke();return s[r]===un?pn(s,r,e?t.call(e):t()):function Q1(n,t){return n[t]}(s,r)}function c3(n,t,e,r){return T$(ke(),T2(),n,t,e,r)}function Wd(n,t){const e=n[t];return e===un?void 0:e}function T$(n,t,e,r,s,i){const o=t+e;return N1(n,o,s)?pn(n,o+1,i?r.call(i,s):r(s)):Wd(n,o+1)}function lc(n,t){const e=Kn();let r;const s=n+22;e.firstCreatePass?(r=function r6e(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=da(r.type)),o=Do(Q);try{const c=W3(!1),u=i();return W3(c),function Q3e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,ke(),s,u),u}finally{Do(o)}}function l3(n,t,e){const r=n+22,s=ke(),i=q4(s,r);return qd(s,r)?T$(s,T2(),t,i.transform,e,i):i.transform(e)}function A$(n,t,e,r){const s=n+22,i=ke(),o=q4(i,s);return qd(i,s)?function w$(n,t,e,r,s,i,o){const c=t+e;return oi(n,c,s,i)?pn(n,c+2,o?r.call(o,s,i):r(s,i)):Wd(n,c+2)}(i,T2(),t,o.transform,e,r,o):o.transform(e,r)}function qd(n,t){return n[1].data[t].pure}function qb(n){return t=>{setTimeout(n,void 0,t)}}const dr=class a6e extends Ai{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=qb(i),s&&(s=qb(s)),o&&(o=qb(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof G1&&t.add(c),c}};function c6e(){return this._results[Se()]()}class jb{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Se(),r=jb.prototype;r[e]||(r[e]=c6e)}get changes(){return this._changes||(this._changes=new dr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=J2(t);(this._changesDetected=!function yh(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let pl=(()=>{class n{}return n.__NG_ELEMENT_ID__=f6e,n})();const l6e=pl,u6e=class extends l6e{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=A7(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),x7(r,s,t),new B7(s)}};function f6e(){return BC(xr(),ke())}function BC(n,t){return 4&n.type?new u6e(t,n,B6(n,t)):null}let wa=(()=>{class n{}return n.__NG_ELEMENT_ID__=h6e,n})();function h6e(){return k$(xr(),ke())}const d6e=wa,I$=class extends d6e{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return B6(this._hostTNode,this._hostLView)}get injector(){return new N6(this._hostTNode,this._hostLView)}get parentInjector(){const t=ma(this._hostTNode,this._hostLView);if(dh(t)){const e=Q4(t,this._hostLView),r=X4(t);return new N6(e[1].data[r+8],e)}return new N6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=x$(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function w2(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new Q8(E1(t)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const C=(o?h:this.parentInjector).get(Ca,null);C&&(i=C)}const g=u.create(h,s,void 0,i);return this.insert(g.hostView,c),g}insert(t,e){const r=t._lView,s=r[1];if(function d8(n){return Cr(n[3])}(r)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const m=r[3],C=new I$(m,m[6],m[3]);C.detach(C.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function Lw(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],Xc(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function Rw(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=q6(i,o),u=r[11],h=W6(u,o[7]);return null!==h&&function Iw(n,t,e,r,s,i){r[0]=s,r[6]=t,j6(n,r,e,1,s,i)}(s,o[6],u,r,h,c),t.attachToViewContainerRef(),Xc(Zb(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=x$(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=sd(this._lContainer,e);r&&(L6(Zb(this._lContainer),e),Iv(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=sd(this._lContainer,e);return r&&null!=L6(Zb(this._lContainer),e)?new B7(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function x$(n){return n[8]}function Zb(n){return n[8]||(n[8]=[])}function k$(n,t){let e;const r=t[n.index];if(Cr(r))e=r;else{let s;if(8&n.type)s=yr(r);else{const i=t[11];s=i.createComment("");const o=K2(n,t);n3(i,W6(i,o),s,function Rv(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=MC(r,t,s,n),z7(t,e)}return new I$(e,n,t)}class Yb{constructor(t){this.queryList=t,this.matches=null}clone(){return new Yb(this.queryList)}setDirty(){this.queryList.setDirty()}}class Kb{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new Kb(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==V$(t,e).matches&&this.queries[e].setDirty()}}class L${constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class Xb{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new Xb(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Qb{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Qb(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,m6e(e,i)),this.matchTNodeWithReadOption(t,e,Wr(e,t,i,!1,!1))}else r===pl?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Wr(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===ri||s===wa||s===pl&&4&e.type)this.addMatch(e.index,-2);else{const i=Wr(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function m6e(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function v6e(n,t,e,r){return-1===e?function _6e(n,t){return 11&n.type?B6(n,t):4&n.type?BC(n,t):null}(t,n):-2===e?function C6e(n,t,e){return e===ri?B6(t,n):e===pl?BC(t,n):e===wa?k$(t,n):void 0}(n,t,r):Ls(n,n[1],e,t)}function R$(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:v6e(t,i[h],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function Jb(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=R$(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],g=t[-u];for(let m=10;m<g.length;m++){const C=g[m];C[17]===C[3]&&Jb(C[1],C,h,r)}if(null!==g[9]){const m=g[9];for(let C=0;C<m.length;C++){const w=m[C];Jb(w[1],w,h,r)}}}}}return r}function uc(n){const t=ke(),e=Kn(),r=ch();p8(r+1);const s=V$(e,r);if(n.dirty&&function v_(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?Jb(e,t,r,[]):R$(e,t,s,r);n.reset(i,d7),n.notifyOnChanges()}return!0}return!1}function s4(n,t,e){const r=Kn();r.firstCreatePass&&(function z$(n,t,e){null===n.queries&&(n.queries=new Xb),n.queries.track(new Qb(t,e))}(r,new L$(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function D$(n,t,e){const r=new jb(4==(4&e));_b(n,t,r,r.destroy),null===t[19]&&(t[19]=new Kb),t[19].queries.push(new Yb(r))}(r,ke(),t)}function fc(){return function y6e(n,t){return n[19].queries[t].queryList}(ke(),ch())}function V$(n,t){return n.queries.getByIndex(t)}function c1(n,t){return BC(n,t)}function UC(...n){}const GC=new It("Application Initializer");let WC=(()=>{class n{constructor(e){this.appInits=e,this.resolve=UC,this.reject=UC,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(Vd(i))e.push(i);else if(kb(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(Le(GC,8))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Zd=new It("AppId",{providedIn:"root",factory:function rU(){return`${iO()}${iO()}${iO()}`}});function iO(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const sU=new It("Platform Initializer"),Yd=new It("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),iU=new It("appBootstrapListener"),oU=new It("AnimationModuleType");let B6e=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const i4=new It("LocaleId",{providedIn:"root",factory:()=>kr(i4,Gt.Optional|Gt.SkipSelf)||function $6e(){return typeof $localize<"u"&&$localize.locale||G7}()});class G6e{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let oO=(()=>{class n{compileModuleSync(e){return new Gb(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=Ea(eo(e).declarations).reduce((o,c)=>{const u=E1(c);return u&&o.push(new Q8(u)),o},[]);return new G6e(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const j6e=(()=>Promise.resolve(0))();function aO(n){typeof Zone>"u"?j6e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Er{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dr(!1),this.onMicrotaskEmpty=new dr(!1),this.onStable=new dr(!1),this.onError=new dr(!1),typeof Zone>"u")throw new Oe(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function Z6e(){let n=K1.requestAnimationFrame,t=K1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function X6e(n){const t=()=>{!function K6e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(K1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,lO(n),n.isCheckStableRunning=!0,cO(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),lO(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return lU(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),uU(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return lU(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),uU(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,lO(n),cO(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Er.isInAngularZone())throw new Oe(909,!1)}static assertNotInAngularZone(){if(Er.isInAngularZone())throw new Oe(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,Y6e,UC,UC);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const Y6e={};function cO(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function lO(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function lU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function uU(n){n._nesting--,cO(n)}class Q6e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dr,this.onMicrotaskEmpty=new dr,this.onStable=new dr,this.onError=new dr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const fU=new It(""),qC=new It("");let hO,uO=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,hO||(function J6e(n){hO=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Er.assertNotInAngularZone(),aO(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())aO(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(Le(Er),Le(fO),Le(qC))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),fO=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return hO?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),J6=null;const hU=new It("AllowMultipleToken"),dO=new It("PlatformDestroyListeners");class dU{constructor(t,e){this.name=t,this.token=e}}function gU(n,t,e=[]){const r=`Platform: ${t}`,s=new It(r);return(i=[])=>{let o=pO();if(!o||o.injector.get(hU,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function n0e(n){if(J6&&!J6.get(hU,!1))throw new Oe(400,!1);J6=n;const t=n.get(_U);(function pU(n){const t=n.get(sU,null);t&&t.forEach(e=>e())})(n)}(function mU(n=[],t){return s2.create({name:t,providers:[{provide:$h,useValue:"platform"},{provide:dO,useValue:new Set([()=>J6=null])},...n]})}(c,r))}return function s0e(n){const t=pO();if(!t)throw new Oe(401,!1);return t}()}}function pO(){return J6?.get(_U)??null}let _U=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function CU(n,t){let e;return e="noop"===n?new Q6e:("zone.js"===n?void 0:n)||new Er(t),e}(r?.ngZone,function vU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:Er,useValue:s}];return s.run(()=>{const o=s2.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(G6,null);if(!u)throw new Oe(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:g=>{u.handleError(g)}});c.onDestroy(()=>{jC(this._modules,c),h.unsubscribe()})}),function yU(n,t,e){try{const r=e();return Vd(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(WC);return h.runInitializers(),h.donePromise.then(()=>(ZB(c.injector.get(i4,G7)||G7),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=EU({},r);return function e0e(n,t,e){const r=new Gb(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(Kd);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Oe(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Oe(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(dO,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(Le(s2))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function EU(n,t){return Array.isArray(t)?t.reduce(EU,n):{...n,...t}}let Kd=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new vr(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new vr(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Er.assertNotInAngularZone(),aO(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{Er.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function n_(...n){const t=D3(n),e=function E5(n,t){return"number"==typeof $4(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?xo(r[0]):B4(e)(ss(r,t)):Xa}(i,o.pipe(function KP(n={}){const{connector:t=(()=>new Ai),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,g=!1,m=!1;const C=()=>{c?.unsubscribe(),c=void 0},w=()=>{C(),o=u=void 0,g=m=!1},I=()=>{const H=o;w(),H?.unsubscribe()};return hr((H,Y)=>{h++,!m&&!g&&C();const ee=u=u??t();Y.add(()=>{h--,0===h&&!m&&!g&&(c=P5(I,s))}),ee.subscribe(Y),!o&&h>0&&(o=new or({next:_e=>ee.next(_e),error:_e=>{m=!0,C(),c=P5(w,e,_e),ee.error(_e)},complete:()=>{g=!0,C(),c=P5(w,r),ee.complete()}}),xo(H).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof dv;if(!this._injector.get(WC).done)throw!s&&function W4(n){const t=E1(n)||W2(n)||q2(n);return null!==t&&t.standalone}(e),new Oe(405,false);let o;o=s?e:this._injector.get(ya).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function t0e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(tu),h=o.create(s2.NULL,[],r||o.selector,c),g=h.location.nativeElement,m=h.injector.get(fU,null);return m?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),jC(this.components,h),m?.unregisterApplication(g)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Oe(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;jC(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(iU,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>jC(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Oe(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(Le(Er),Le(Ca),Le(G6))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function jC(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let SU=!0,nu=(()=>{class n{}return n.__NG_ELEMENT_ID__=a0e,n})();function a0e(n){return function c0e(n,t,e){if(Fo(n)&&!e){const r=P2(n.index,t);return new B7(r,r)}return 47&n.type?new B7(t[16],t):null}(xr(),ke(),16==(16&n))}class OU{constructor(){}supports(t){return De(t)}create(t){return new p0e(t)}}const d0e=(n,t)=>t;class p0e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||d0e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<AU(r,s,i)?e:r,c=AU(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,g=u-s;if(h!=g){for(let C=0;C<h;C++){const w=C<i.length?i[C]:i[C]=0,I=w+C;g<=I&&I<h&&(i[C]=w+1)}i[o.previousIndex]=g-h}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!De(t))throw new Oe(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function tt(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Se()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new g0e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new NU),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new NU),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class g0e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class m0e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class NU{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new m0e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function AU(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class IU{constructor(){}supports(t){return t instanceof Map||_t(t)}create(){return new _0e}}class _0e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||_t(t)))throw new Oe(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new v0e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class v0e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function xU(){return new KC([new OU])}let KC=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||xU()),deps:[[n,new A8,new r2]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Oe(901,!1)}}return n.\u0275prov=Je({token:n,providedIn:"root",factory:xU}),n})();function kU(){return new Xd([new IU])}let Xd=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||kU()),deps:[[n,new A8,new r2]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Oe(901,!1)}}return n.\u0275prov=Je({token:n,providedIn:"root",factory:kU}),n})();const E0e=gU(null,"core",[]);let M0e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(Le(Kd))},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({}),n})();function ml(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let XC=null;function o4(){return XC}const Ds=new It("DocumentToken");let CO=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:function(){return function w0e(){return Le(LU)}()},providedIn:"platform"}),n})();const b0e=new It("Location Initialized");let LU=(()=>{class n extends CO{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return o4().getBaseHref(this._doc)}onPopState(e){const r=o4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=o4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){RU()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){RU()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds))},n.\u0275prov=Je({token:n,factory:function(){return function O0e(){return new LU(Le(Ds))}()},providedIn:"platform"}),n})();function RU(){return!!window.history.pushState}function yO(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function DU(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function _l(n){return n&&"?"!==n[0]?"?"+n:n}let su=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:function(){return kr(VU)},providedIn:"root"}),n})();const zU=new It("appBaseHref");let VU=(()=>{class n extends su{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??kr(Ds).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return yO(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+_l(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+_l(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+_l(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(CO),Le(zU,8))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),N0e=(()=>{class n extends su{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=yO(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+_l(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+_l(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(CO),Le(zU,8))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),EO=(()=>{class n{constructor(e){this._subject=new dr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=DU(HU(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+_l(r))}normalize(e){return n.stripTrailingSlash(function I0e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,HU(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+_l(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+_l(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=_l,n.joinWithSlash=yO,n.stripTrailingSlash=DU,n.\u0275fac=function(e){return new(e||n)(Le(su))},n.\u0275prov=Je({token:n,factory:function(){return function A0e(){return new EO(Le(su))}()},providedIn:"root"}),n})();function HU(n){return n.replace(/\/index.html$/,"")}var Xo=(()=>((Xo=Xo||{})[Xo.Decimal=0]="Decimal",Xo[Xo.Percent=1]="Percent",Xo[Xo.Currency=2]="Currency",Xo[Xo.Scientific=3]="Scientific",Xo))(),vs=(()=>((vs=vs||{})[vs.Format=0]="Format",vs[vs.Standalone=1]="Standalone",vs))(),Xn=(()=>((Xn=Xn||{})[Xn.Narrow=0]="Narrow",Xn[Xn.Abbreviated=1]="Abbreviated",Xn[Xn.Wide=2]="Wide",Xn[Xn.Short=3]="Short",Xn))(),Zr=(()=>((Zr=Zr||{})[Zr.Short=0]="Short",Zr[Zr.Medium=1]="Medium",Zr[Zr.Long=2]="Long",Zr[Zr.Full=3]="Full",Zr))(),Kt=(()=>((Kt=Kt||{})[Kt.Decimal=0]="Decimal",Kt[Kt.Group=1]="Group",Kt[Kt.List=2]="List",Kt[Kt.PercentSign=3]="PercentSign",Kt[Kt.PlusSign=4]="PlusSign",Kt[Kt.MinusSign=5]="MinusSign",Kt[Kt.Exponential=6]="Exponential",Kt[Kt.SuperscriptingExponent=7]="SuperscriptingExponent",Kt[Kt.PerMille=8]="PerMille",Kt[Kt.Infinity=9]="Infinity",Kt[Kt.NaN=10]="NaN",Kt[Kt.TimeSeparator=11]="TimeSeparator",Kt[Kt.CurrencyDecimal=12]="CurrencyDecimal",Kt[Kt.CurrencyGroup=13]="CurrencyGroup",Kt))();function QC(n,t){return dc(fo(n)[pt.DateFormat],t)}function JC(n,t){return dc(fo(n)[pt.TimeFormat],t)}function ey(n,t){return dc(fo(n)[pt.DateTimeFormat],t)}function hc(n,t){const e=fo(n),r=e[pt.NumberSymbols][t];if(typeof r>"u"){if(t===Kt.CurrencyDecimal)return e[pt.NumberSymbols][Kt.Decimal];if(t===Kt.CurrencyGroup)return e[pt.NumberSymbols][Kt.Group]}return r}function BU(n){if(!n[pt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[pt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function dc(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function SO(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const G0e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Qd={},W0e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var a2=(()=>((a2=a2||{})[a2.Short=0]="Short",a2[a2.ShortGMT=1]="ShortGMT",a2[a2.Long=2]="Long",a2[a2.Extended=3]="Extended",a2))(),sn=(()=>((sn=sn||{})[sn.FullYear=0]="FullYear",sn[sn.Month=1]="Month",sn[sn.Date=2]="Date",sn[sn.Hours=3]="Hours",sn[sn.Minutes=4]="Minutes",sn[sn.Seconds=5]="Seconds",sn[sn.FractionalSeconds=6]="FractionalSeconds",sn[sn.Day=7]="Day",sn))(),kn=(()=>((kn=kn||{})[kn.DayPeriods=0]="DayPeriods",kn[kn.Days=1]="Days",kn[kn.Months=2]="Months",kn[kn.Eras=3]="Eras",kn))();function $U(n,t,e,r){let s=function e8e(n){if(WU(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return ty(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(G0e))return function t8e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,h),t}(r)}const t=new Date(n);if(!WU(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=vl(e,t)||t;let c,o=[];for(;t;){if(c=W0e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;t=g}}let u=s.getTimezoneOffset();r&&(u=GU(r,u),s=function J0e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function Q0e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(GU(t,s)-s))}(s,r,!0));let h="";return o.forEach(g=>{const m=function X0e(n){if(TO[n])return TO[n];let t;switch(n){case"G":case"GG":case"GGG":t=pr(kn.Eras,Xn.Abbreviated);break;case"GGGG":t=pr(kn.Eras,Xn.Wide);break;case"GGGGG":t=pr(kn.Eras,Xn.Narrow);break;case"y":t=Vs(sn.FullYear,1,0,!1,!0);break;case"yy":t=Vs(sn.FullYear,2,0,!0,!0);break;case"yyy":t=Vs(sn.FullYear,3,0,!1,!0);break;case"yyyy":t=Vs(sn.FullYear,4,0,!1,!0);break;case"Y":t=iy(1);break;case"YY":t=iy(2,!0);break;case"YYY":t=iy(3);break;case"YYYY":t=iy(4);break;case"M":case"L":t=Vs(sn.Month,1,1);break;case"MM":case"LL":t=Vs(sn.Month,2,1);break;case"MMM":t=pr(kn.Months,Xn.Abbreviated);break;case"MMMM":t=pr(kn.Months,Xn.Wide);break;case"MMMMM":t=pr(kn.Months,Xn.Narrow);break;case"LLL":t=pr(kn.Months,Xn.Abbreviated,vs.Standalone);break;case"LLLL":t=pr(kn.Months,Xn.Wide,vs.Standalone);break;case"LLLLL":t=pr(kn.Months,Xn.Narrow,vs.Standalone);break;case"w":t=PO(1);break;case"ww":t=PO(2);break;case"W":t=PO(1,!0);break;case"d":t=Vs(sn.Date,1);break;case"dd":t=Vs(sn.Date,2);break;case"c":case"cc":t=Vs(sn.Day,1);break;case"ccc":t=pr(kn.Days,Xn.Abbreviated,vs.Standalone);break;case"cccc":t=pr(kn.Days,Xn.Wide,vs.Standalone);break;case"ccccc":t=pr(kn.Days,Xn.Narrow,vs.Standalone);break;case"cccccc":t=pr(kn.Days,Xn.Short,vs.Standalone);break;case"E":case"EE":case"EEE":t=pr(kn.Days,Xn.Abbreviated);break;case"EEEE":t=pr(kn.Days,Xn.Wide);break;case"EEEEE":t=pr(kn.Days,Xn.Narrow);break;case"EEEEEE":t=pr(kn.Days,Xn.Short);break;case"a":case"aa":case"aaa":t=pr(kn.DayPeriods,Xn.Abbreviated);break;case"aaaa":t=pr(kn.DayPeriods,Xn.Wide);break;case"aaaaa":t=pr(kn.DayPeriods,Xn.Narrow);break;case"b":case"bb":case"bbb":t=pr(kn.DayPeriods,Xn.Abbreviated,vs.Standalone,!0);break;case"bbbb":t=pr(kn.DayPeriods,Xn.Wide,vs.Standalone,!0);break;case"bbbbb":t=pr(kn.DayPeriods,Xn.Narrow,vs.Standalone,!0);break;case"B":case"BB":case"BBB":t=pr(kn.DayPeriods,Xn.Abbreviated,vs.Format,!0);break;case"BBBB":t=pr(kn.DayPeriods,Xn.Wide,vs.Format,!0);break;case"BBBBB":t=pr(kn.DayPeriods,Xn.Narrow,vs.Format,!0);break;case"h":t=Vs(sn.Hours,1,-12);break;case"hh":t=Vs(sn.Hours,2,-12);break;case"H":t=Vs(sn.Hours,1);break;case"HH":t=Vs(sn.Hours,2);break;case"m":t=Vs(sn.Minutes,1);break;case"mm":t=Vs(sn.Minutes,2);break;case"s":t=Vs(sn.Seconds,1);break;case"ss":t=Vs(sn.Seconds,2);break;case"S":t=Vs(sn.FractionalSeconds,1);break;case"SS":t=Vs(sn.FractionalSeconds,2);break;case"SSS":t=Vs(sn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=ry(a2.Short);break;case"ZZZZZ":t=ry(a2.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=ry(a2.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=ry(a2.Long);break;default:return null}return TO[n]=t,t}(g);h+=m?m(s,e,u):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function ty(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function vl(n,t){const e=function x0e(n){return fo(n)[pt.LocaleId]}(n);if(Qd[e]=Qd[e]||{},Qd[e][t])return Qd[e][t];let r="";switch(t){case"shortDate":r=QC(n,Zr.Short);break;case"mediumDate":r=QC(n,Zr.Medium);break;case"longDate":r=QC(n,Zr.Long);break;case"fullDate":r=QC(n,Zr.Full);break;case"shortTime":r=JC(n,Zr.Short);break;case"mediumTime":r=JC(n,Zr.Medium);break;case"longTime":r=JC(n,Zr.Long);break;case"fullTime":r=JC(n,Zr.Full);break;case"short":const s=vl(n,"shortTime"),i=vl(n,"shortDate");r=ny(ey(n,Zr.Short),[s,i]);break;case"medium":const o=vl(n,"mediumTime"),c=vl(n,"mediumDate");r=ny(ey(n,Zr.Medium),[o,c]);break;case"long":const u=vl(n,"longTime"),h=vl(n,"longDate");r=ny(ey(n,Zr.Long),[u,h]);break;case"full":const g=vl(n,"fullTime"),m=vl(n,"fullDate");r=ny(ey(n,Zr.Full),[g,m])}return r&&(Qd[e][t]=r),r}function ny(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function f3(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function Vs(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function j0e(n,t){switch(n){case sn.FullYear:return t.getFullYear();case sn.Month:return t.getMonth();case sn.Date:return t.getDate();case sn.Hours:return t.getHours();case sn.Minutes:return t.getMinutes();case sn.Seconds:return t.getSeconds();case sn.FractionalSeconds:return t.getMilliseconds();case sn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===sn.Hours)0===c&&-12===e&&(c=12);else if(n===sn.FractionalSeconds)return function q0e(n,t){return f3(n,3).substring(0,t)}(c,t);const u=hc(o,Kt.MinusSign);return f3(c,t,u,r,s)}}function pr(n,t,e=vs.Format,r=!1){return function(s,i){return function Z0e(n,t,e,r,s,i){switch(e){case kn.Months:return function R0e(n,t,e){const r=fo(n),i=dc([r[pt.MonthsFormat],r[pt.MonthsStandalone]],t);return dc(i,e)}(t,s,r)[n.getMonth()];case kn.Days:return function L0e(n,t,e){const r=fo(n),i=dc([r[pt.DaysFormat],r[pt.DaysStandalone]],t);return dc(i,e)}(t,s,r)[n.getDay()];case kn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function H0e(n){const t=fo(n);return BU(t),(t[pt.ExtraData][2]||[]).map(r=>"string"==typeof r?SO(r):[SO(r[0]),SO(r[1])])}(t),g=function F0e(n,t,e){const r=fo(n);BU(r);const i=dc([r[pt.ExtraData][0],r[pt.ExtraData][1]],t)||[];return dc(i,e)||[]}(t,s,r),m=h.findIndex(C=>{if(Array.isArray(C)){const[w,I]=C,H=o>=w.hours&&c>=w.minutes,Y=o<I.hours||o===I.hours&&c<I.minutes;if(w.hours<I.hours){if(H&&Y)return!0}else if(H||Y)return!0}else if(C.hours===o&&C.minutes===c)return!0;return!1});if(-1!==m)return g[m]}return function k0e(n,t,e){const r=fo(n),i=dc([r[pt.DayPeriodsFormat],r[pt.DayPeriodsStandalone]],t);return dc(i,e)}(t,s,r)[o<12?0:1];case kn.Eras:return function D0e(n,t){return dc(fo(n)[pt.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function ry(n){return function(t,e,r){const s=-1*r,i=hc(e,Kt.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case a2.Short:return(s>=0?"+":"")+f3(o,2,i)+f3(Math.abs(s%60),2,i);case a2.ShortGMT:return"GMT"+(s>=0?"+":"")+f3(o,1,i);case a2.Long:return"GMT"+(s>=0?"+":"")+f3(o,2,i)+":"+f3(Math.abs(s%60),2,i);case a2.Extended:return 0===r?"Z":(s>=0?"+":"")+f3(o,2,i)+":"+f3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function UU(n){return ty(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function PO(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=UU(e),o=function K0e(n){const t=ty(n,0,1).getDay();return ty(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return f3(s,n,hc(r,Kt.MinusSign))}}function iy(n,t=!1){return function(e,r){return f3(UU(e).getFullYear(),n,hc(r,Kt.MinusSign),t)}}const TO={};function GU(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function WU(n){return n instanceof Date&&!isNaN(n.valueOf())}const n8e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function NO(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function YU(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let En=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(De(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${W1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(Q(KC),Q(Xd),Q(ri),Q(ao))},n.\u0275dir=Ft({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class g8e{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Dn=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new g8e(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),QU(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{QU(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(wa),Q(pl),Q(KC))},n.\u0275dir=Ft({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function QU(n,t){n.context.$implicit=t.item}let on=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new _8e,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){JU("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){JU("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(wa),Q(pl))},n.\u0275dir=Ft({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class _8e{constructor(){this.$implicit=null,this.ngIf=null}}function JU(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${W1(t)}'.`)}let nG=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function kO(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function c8e(n,t,e){return function bO(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function u8e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(h=function l8e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(h));let g=t.minInt,m=t.minFrac,C=t.maxFrac;if(i){const _e=i.match(n8e);if(null===_e)throw new Error(`${i} is not a valid digit info`);const te=_e[1],Ae=_e[3],Fe=_e[5];null!=te&&(g=NO(te)),null!=Ae&&(m=NO(Ae)),null!=Fe?C=NO(Fe):null!=Ae&&m>C&&(C=m)}!function f8e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=t+n.integerLen,g=r.reduceRight(function(m,C,w,I){return I[w]=(C+=m)<10?C:C-10,u&&(0===I[w]&&w>=h?I.pop():u=!1),C>=10?1:0},0);g&&(r.unshift(g),n.integerLen++)}(h,m,C);let w=h.digits,I=h.integerLen;const H=h.exponent;let Y=[];for(u=w.every(_e=>!_e);I<g;I++)w.unshift(0);for(;I<0;I++)w.unshift(0);I>0?Y=w.splice(I,w.length):(Y=w,w=[0]);const ee=[];for(w.length>=t.lgSize&&ee.unshift(w.splice(-t.lgSize,w.length).join(""));w.length>t.gSize;)ee.unshift(w.splice(-t.gSize,w.length).join(""));w.length&&ee.unshift(w.join("")),c=ee.join(hc(e,r)),Y.length&&(c+=hc(e,s)+Y.join("")),H&&(c+=hc(e,Kt.Exponential)+"+"+H)}else c=hc(e,Kt.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function OO(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let g=0;g<u.length;g++){const m=u.charAt(g);"0"===m?e.minFrac=e.maxFrac=g+1:"#"===m?e.maxFrac=g+1:e.posSuf+=m}const h=c.split(",");if(e.gSize=h[1]?h[1].length:0,e.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const g=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+g).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function MO(n,t){return fo(n)[pt.NumberFormats][t]}(t,Xo.Decimal),hc(t,Kt.MinusSign)),t,Kt.Group,Kt.Decimal,e)}(function LO(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function h3(n,t){return new Oe(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(Q(i4,16))},n.\u0275pipe=e2({name:"number",type:n,pure:!0,standalone:!0}),n})();let U8e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({}),n})();let j8e=(()=>{class n{}return n.\u0275prov=Je({token:n,providedIn:"root",factory:()=>new Z8e(Le(Ds),window)}),n})();class Z8e{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Y8e(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=sG(this.window.history)||sG(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function sG(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class iG{}class zO extends class due extends class T0e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function P0e(n){XC||(XC=n)}(new zO)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function pue(){return tp=tp||document.querySelector("base"),tp?tp.getAttribute("href"):null}();return null==e?null:function gue(n){cy=cy||document.createElement("a"),cy.setAttribute("href",n);const t=cy.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){tp=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return YU(document.cookie,t)}}let cy,tp=null;const lG=new It("TRANSITION_ID"),_ue=[{provide:GC,useFactory:function mue(n,t,e){return()=>{e.get(WC).donePromise.then(()=>{const r=o4(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[lG,Ds,s2],multi:!0}];let Cue=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();const ly=new It("EventManagerPlugins");let uy=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(Le(ly),Le(Er))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();class uG{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=o4().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let fG=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),np=(()=>{class n extends fG{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(hG),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(hG))}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();function hG(n){o4().remove(n)}const VO={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},HO=/%COMP%/g;function fy(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?fy(n,s,e):(s=s.replace(HO,n),e.push(s))}return e}function gG(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let hy=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new FO(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case L1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new Tue(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case L1.ShadowDom:return new wue(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=fy(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(Le(uy),Le(np),Le(Zd))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();class FO{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(VO[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(_G(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(_G(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=VO[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=VO[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(ii.DashCase|ii.Important)?t.style.setProperty(e,r,s&ii.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&ii.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,gG(r)):this.eventManager.addEventListener(t,e,gG(r))}}function _G(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Tue extends FO{constructor(t,e,r,s){super(t),this.component=r;const i=fy(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function Mue(n){return"_ngcontent-%COMP%".replace(HO,n)}(s+"-"+r.id),this.hostAttr=function Sue(n){return"_nghost-%COMP%".replace(HO,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class wue extends FO{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=fy(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let bue=(()=>{class n extends uG{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();const vG=["alt","control","meta","shift"],Oue={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Nue={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Aue=(()=>{class n extends uG{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>o4().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),vG.forEach(h=>{const g=r.indexOf(h);g>-1&&(r.splice(g,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=Oue[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),vG.forEach(o=>{o!==s&&(0,Nue[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();const yG=[{provide:Yd,useValue:"browser"},{provide:sU,useValue:function Iue(){zO.makeCurrent()},multi:!0},{provide:Ds,useFactory:function kue(){return function kT(n){Lh=n}(document),document},deps:[]}],Lue=gU(E0e,"browser",yG),EG=new It(""),MG=[{provide:qC,useClass:class vue{addToWindow(t){K1.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},K1.getAllAngularTestabilities=()=>t.getAllTestabilities(),K1.getAllAngularRootElements=()=>t.getAllRootElements(),K1.frameworkStabilizers||(K1.frameworkStabilizers=[]),K1.frameworkStabilizers.push(r=>{const s=K1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?o4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:fU,useClass:uO,deps:[Er,fO,qC]},{provide:uO,useClass:uO,deps:[Er,fO,qC]}],SG=[{provide:$h,useValue:"root"},{provide:G6,useFactory:function xue(){return new G6},deps:[]},{provide:ly,useClass:bue,multi:!0,deps:[Ds,Er,Yd]},{provide:ly,useClass:Aue,multi:!0,deps:[Ds]},{provide:hy,useClass:hy,deps:[uy,np,Zd]},{provide:$6,useExisting:hy},{provide:fG,useExisting:np},{provide:np,useClass:np,deps:[Ds]},{provide:uy,useClass:uy,deps:[ly,Er]},{provide:iG,useClass:Cue,deps:[]},[]];let PG=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:Zd,useValue:e.appId},{provide:lG,useExisting:Zd},_ue]}}}return n.\u0275fac=function(e){return new(e||n)(Le(EG,12))},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:[...SG,...MG],imports:[U8e,M0e]}),n})(),TG=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds))},n.\u0275prov=Je({token:n,factory:function(e){let r=null;return r=e?new e:function Due(){return new TG(Le(Ds))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let OG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:function(e){let r=null;return r=e?new(e||n):Le(NG),r},providedIn:"root"}),n})(),NG=(()=>{class n extends OG{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case X1.NONE:return r;case X1.HTML:return so(r,"HTML")?ro(r):Vh(this._doc,String(r)).toString();case X1.STYLE:return so(r,"Style")?ro(r):r;case X1.SCRIPT:if(so(r,"Script"))return ro(r);throw new Error("unsafe value used in a script context");case X1.URL:return so(r,"URL")?ro(r):jo(String(r));case X1.RESOURCE_URL:if(so(r,"ResourceURL"))return ro(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function j_(n){return new DT(n)}(e)}bypassSecurityTrustStyle(e){return function Z_(n){return new zT(n)}(e)}bypassSecurityTrustScript(e){return function HT(n){return new VT(n)}(e)}bypassSecurityTrustUrl(e){return function FT(n){return new G_(n)}(e)}bypassSecurityTrustResourceUrl(e){return function BT(n){return new W_(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds))},n.\u0275prov=Je({token:n,factory:function(e){let r=null;return r=e?new e:function Uue(n){return new NG(n.get(Ds))}(Le(s2)),r},providedIn:"root"}),n})();const{isArray:Gue}=Array,{getPrototypeOf:Wue,prototype:que,keys:jue}=Object;function AG(n){if(1===n.length){const t=n[0];if(Gue(t))return{args:t,keys:null};if(function Zue(n){return n&&"object"==typeof n&&Wue(n)===que}(t)){const e=jue(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:Yue}=Array;function IG(n){return dn(t=>function Kue(n,t){return Yue(t)?n(...t):n(t)}(n,t))}function xG(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let kG=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Q(ao),Q(ri))},n.\u0275dir=Ft({type:n}),n})(),iu=(()=>{class n extends kG{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,features:[l]}),n})();const a4=new It("NgValueAccessor"),Que={provide:a4,useExisting:C1(()=>UO),multi:!0};let UO=(()=>{class n extends iu{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[Lr([Que]),l]}),n})();const Jue={provide:a4,useExisting:C1(()=>c4),multi:!0},t5e=new It("CompositionEventMode");let c4=(()=>{class n extends kG{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function e5e(){const n=o4()?o4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(ao),Q(ri),Q(t5e,8))},n.\u0275dir=Ft({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&J("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Lr([Jue]),l]}),n})();function t0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function LG(n){return null!=n&&"number"==typeof n.length}const Hi=new It("NgValidators"),n0=new It("NgAsyncValidators"),r5e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class rp{static min(t){return function RG(n){return t=>{if(t0(t.value)||t0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function DG(n){return t=>{if(t0(t.value)||t0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return zG(t)}static requiredTrue(t){return function VG(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function HG(n){return t0(n.value)||r5e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function FG(n){return t=>t0(t.value)||!LG(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return BG(t)}static pattern(t){return function $G(n){if(!n)return dy;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(t0(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return ZG(t)}static composeAsync(t){return YG(t)}}function zG(n){return t0(n.value)?{required:!0}:null}function BG(n){return t=>LG(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function dy(n){return null}function UG(n){return null!=n}function GG(n){return Vd(n)?ss(n):n}function WG(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function qG(n,t){return t.map(e=>e(n))}function jG(n){return n.map(t=>function s5e(n){return!n.validate}(t)?t:e=>t.validate(e))}function ZG(n){if(!n)return null;const t=n.filter(UG);return 0==t.length?null:function(e){return WG(qG(e,t))}}function GO(n){return null!=n?ZG(jG(n)):null}function YG(n){if(!n)return null;const t=n.filter(UG);return 0==t.length?null:function(e){return function Xue(...n){const t=Yt(n),{args:e,keys:r}=AG(n),s=new vr(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let g=0;g<o;g++){let m=!1;xo(e[g]).subscribe(rs(i,C=>{m||(m=!0,h--),c[g]=C},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?xG(r,c):c),i.complete())}))}});return t?s.pipe(IG(t)):s}(qG(e,t).map(GG)).pipe(dn(WG))}}function WO(n){return null!=n?YG(jG(n)):null}function KG(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function XG(n){return n._rawValidators}function QG(n){return n._rawAsyncValidators}function qO(n){return n?Array.isArray(n)?n:[n]:[]}function py(n,t){return Array.isArray(n)?n.includes(t):n===t}function JG(n,t){const e=qO(t);return qO(n).forEach(s=>{py(e,s)||e.push(s)}),e}function eW(n,t){return qO(t).filter(e=>!py(n,e))}class tW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=GO(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=WO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class po extends tW{get formDirective(){return null}get path(){return null}}class r0 extends tW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class nW{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Cl=(()=>{class n extends nW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(r0,2))},n.\u0275dir=Ft({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&kC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),ou=(()=>{class n extends nW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(po,10))},n.\u0275dir=Ft({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&kC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const sp="VALID",my="INVALID",j7="PENDING",ip="DISABLED";function KO(n){return(_y(n)?n.validators:n)||null}function sW(n){return Array.isArray(n)?GO(n):n||null}function XO(n,t){return(_y(t)?t.asyncValidators:n)||null}function iW(n){return Array.isArray(n)?WO(n):n||null}function _y(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function oW(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Oe(1e3,"");if(!r[e])throw new Oe(1001,"")}function aW(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Oe(1002,"")})}class vy{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=sW(this._rawValidators),this._composedAsyncValidatorFn=iW(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===sp}get invalid(){return this.status===my}get pending(){return this.status==j7}get disabled(){return this.status===ip}get enabled(){return this.status!==ip}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=sW(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=iW(t)}addValidators(t){this.setValidators(JG(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(JG(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(eW(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(eW(t,this._rawAsyncValidators))}hasValidator(t){return py(this._rawValidators,t)}hasAsyncValidator(t){return py(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=j7,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=ip,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=sp,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===sp||this.status===j7)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ip:sp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=j7,this._hasOwnPendingAsyncValidator=!0;const e=GG(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new dr,this.statusChanges=new dr}_calculateStatus(){return this._allControlsDisabled()?ip:this.errors?my:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(j7)?j7:this._anyControlsHaveStatus(my)?my:sp}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){_y(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class s0 extends vy{constructor(t,e,r){super(KO(e),XO(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){aW(this,0,t),Object.keys(t).forEach(r=>{oW(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class cW extends s0{}function Cy(n,t){return[...t.path,n]}function op(n,t){QO(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function h5e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&lW(n,t)})}(n,t),function p5e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function d5e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&lW(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function f5e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function yy(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),My(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Ey(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function QO(n,t){const e=XG(n);null!==t.validator?n.setValidators(KG(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=QG(n);null!==t.asyncValidator?n.setAsyncValidators(KG(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();Ey(t._rawValidators,s),Ey(t._rawAsyncValidators,s)}function My(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=XG(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=QG(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return Ey(t._rawValidators,r),Ey(t._rawAsyncValidators,r),e}function lW(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function uW(n,t){QO(n,t)}function JO(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function hW(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function eN(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===c4?e=i:function _5e(n){return Object.getPrototypeOf(n.constructor)===iu}(i)?r=i:s=i}),s||r||e||null}const C5e={provide:po,useExisting:C1(()=>cp)},ap=(()=>Promise.resolve())();let cp=(()=>{class n extends po{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new dr,this.form=new s0({},GO(e),WO(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){ap.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),op(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){ap.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){ap.then(()=>{const r=this._findContainer(e.path),s=new s0({});uW(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){ap.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){ap.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,hW(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Q(Hi,10),Q(n0,10))},n.\u0275dir=Ft({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&J("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Lr([C5e]),l]}),n})();function dW(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function pW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const ba=class extends vy{constructor(t=null,e,r){super(KO(e),XO(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),_y(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=pW(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){dW(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){dW(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){pW(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},M5e={provide:r0,useExisting:C1(()=>lp)},_W=(()=>Promise.resolve())();let lp=(()=>{class n extends r0{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new ba,this._registered=!1,this.update=new dr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=eN(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),JO(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){op(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){_W.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&ml(r);_W.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Cy(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(po,9),Q(Hi,10),Q(n0,10),Q(a4,10),Q(nu,8))},n.\u0275dir=Ft({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Lr([M5e]),l,Y2]}),n})(),au=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ft({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),CW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({}),n})();const w5e={provide:a4,useExisting:C1(()=>Sy),multi:!0};let Sy=(()=>{class n extends iu{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Lr([w5e]),l]}),n})();const tN=new It("NgModelWithFormControlWarning"),b5e={provide:r0,useExisting:C1(()=>nN)};let nN=(()=>{class n extends r0{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new dr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=eN(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&yy(r,this,!1),op(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}JO(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&yy(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(Hi,10),Q(n0,10),Q(a4,10),Q(tN,8))},n.\u0275dir=Ft({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Lr([b5e]),l,Y2]}),n})();const O5e={provide:po,useExisting:C1(()=>cu)};let cu=(()=>{class n extends po{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new dr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(My(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return op(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){yy(e.control||null,e,!1),function v5e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,hW(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(yy(r||null,e),(n=>n instanceof ba)(s)&&(op(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);uW(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function g5e(n,t){return My(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){QO(this.form,this),this._oldForm&&My(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(Q(Hi,10),Q(n0,10))},n.\u0275dir=Ft({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&J("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Lr([O5e]),l,Y2]}),n})();const I5e={provide:r0,useExisting:C1(()=>Z7)};let Z7=(()=>{class n extends r0{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new dr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=eN(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),JO(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Cy(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(po,13),Q(Hi,10),Q(n0,10),Q(a4,10),Q(tN,8))},n.\u0275dir=Ft({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Lr([I5e]),l,Y2]}),n})();const x5e={provide:a4,useExisting:C1(()=>Py),multi:!0};function MW(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let Py=(()=>{class n extends iu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=MW(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function k5e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Lr([x5e]),l]}),n})(),up=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(MW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(ri),Q(ao),Q(Py,9))},n.\u0275dir=Ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const L5e={provide:a4,useExisting:C1(()=>iN),multi:!0};function SW(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let iN=(()=>{class n extends iu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function R5e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Lr([L5e]),l]}),n})(),fp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(SW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(SW(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(ri),Q(ao),Q(iN,9))},n.\u0275dir=Ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let lu=(()=>{class n{constructor(){this._validator=dy}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):dy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ft({type:n,features:[Y2]}),n})();const V5e={provide:Hi,useExisting:C1(()=>uu),multi:!0};let uu=(()=>{class n extends lu{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=ml,this.createValidator=e=>zG}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&D("required",r._enabled?"":null)},inputs:{required:"required"},features:[Lr([V5e]),l]}),n})();const $5e={provide:Hi,useExisting:C1(()=>oN),multi:!0};let oN=(()=>{class n extends lu{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function PW(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>BG(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275dir=Ft({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&D("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Lr([$5e]),l]}),n})(),xW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({imports:[CW]}),n})(),G5e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({imports:[xW]}),n})(),kW=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:tN,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({imports:[xW]}),n})();class LW extends vy{constructor(t,e,r){super(KO(e),XO(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){aW(this,0,t),t.forEach((r,s)=>{oW(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function RW(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let W5e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return RW(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new s0(s,i)}record(e,r=null){const s=this._reduceControls(e);return new cW(s,r)}control(e,r,s){let i={};return this.useNonNullable?(RW(r)?i=r:(i.validators=r,i.asyncValidators=s),new ba(e,{...i,nonNullable:!0})):new ba(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new LW(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof ba||e instanceof vy?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:kW}),n})();function Wt(...n){return ss(n,D3(n))}function o0(n,t){return nn(t)?Re(n,t,1):Re(n,1)}function yl(n,t){return hr((e,r)=>{let s=0;e.subscribe(rs(r,i=>n.call(t,i,s++)&&r.next(i)))})}class DW{}class zW{}class El{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof El?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new El;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof El?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class q5e{encodeKey(t){return VW(t)}encodeValue(t){return VW(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Z5e=/%(\d[a-f0-9])/gi,Y5e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function VW(n){return encodeURIComponent(n).replace(Z5e,(t,e)=>Y5e[e]??t)}function Ty(n){return`${n}`}class a0{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new q5e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function j5e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(Ty):[Ty(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new a0({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Ty(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(Ty(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class K5e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function HW(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function FW(n){return typeof Blob<"u"&&n instanceof Blob}function BW(n){return typeof FormData<"u"&&n instanceof FormData}class hp{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function X5e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new El),this.context||(this.context=new K5e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new a0,this.urlWithParams=e}serializeBody(){return null===this.body?null:HW(this.body)||FW(this.body)||BW(this.body)||function Q5e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof a0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||BW(this.body)?null:FW(this.body)?this.body.type||null:HW(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof a0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,h=t.params||this.params;const g=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,C)=>m.set(C,t.setHeaders[C]),u)),t.setParams&&(h=Object.keys(t.setParams).reduce((m,C)=>m.set(C,t.setParams[C]),h)),new hp(e,r,i,{params:h,headers:u,context:g,reportProgress:c,responseType:s,withCredentials:o})}}var Hs=(()=>((Hs=Hs||{})[Hs.Sent=0]="Sent",Hs[Hs.UploadProgress=1]="UploadProgress",Hs[Hs.ResponseHeader=2]="ResponseHeader",Hs[Hs.DownloadProgress=3]="DownloadProgress",Hs[Hs.Response=4]="Response",Hs[Hs.User=5]="User",Hs))();class aN{constructor(t,e=200,r="OK"){this.headers=t.headers||new El,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class cN extends aN{constructor(t={}){super(t),this.type=Hs.ResponseHeader}clone(t={}){return new cN({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class wy extends aN{constructor(t={}){super(t),this.type=Hs.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new wy({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class $W extends aN{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function lN(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let J5e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof hp)i=e;else{let u,h;u=s.headers instanceof El?s.headers:new El(s.headers),s.params&&(h=s.params instanceof a0?s.params:new a0({fromObject:s.params})),i=new hp(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Wt(i).pipe(o0(u=>this.handler.handle(u)));if(e instanceof hp||"events"===s.observe)return o;const c=o.pipe(yl(u=>u instanceof wy));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(dn(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(dn(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(dn(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(dn(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new a0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,lN(s,r))}post(e,r,s={}){return this.request("POST",e,lN(s,r))}put(e,r,s={}){return this.request("PUT",e,lN(s,r))}}return n.\u0275fac=function(e){return new(e||n)(Le(DW))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();class UW{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const GW=new It("HTTP_INTERCEPTORS");let e7e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();const t7e=/^\)\]\}',?\n/;let WW=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new vr(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((w,I)=>s.setRequestHeader(w,I.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const w=e.detectContentTypeHeader();null!==w&&s.setRequestHeader("Content-Type",w)}if(e.responseType){const w=e.responseType.toLowerCase();s.responseType="json"!==w?w:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const w=s.statusText||"OK",I=new El(s.getAllResponseHeaders()),H=function n7e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new cN({headers:I,status:s.status,statusText:w,url:H}),o},u=()=>{let{headers:w,status:I,statusText:H,url:Y}=c(),ee=null;204!==I&&(ee=typeof s.response>"u"?s.responseText:s.response),0===I&&(I=ee?200:0);let _e=I>=200&&I<300;if("json"===e.responseType&&"string"==typeof ee){const te=ee;ee=ee.replace(t7e,"");try{ee=""!==ee?JSON.parse(ee):null}catch(Ae){ee=te,_e&&(_e=!1,ee={error:Ae,text:ee})}}_e?(r.next(new wy({body:ee,headers:w,status:I,statusText:H,url:Y||void 0})),r.complete()):r.error(new $W({error:ee,headers:w,status:I,statusText:H,url:Y||void 0}))},h=w=>{const{url:I}=c(),H=new $W({error:w,status:s.status||0,statusText:s.statusText||"Unknown Error",url:I||void 0});r.error(H)};let g=!1;const m=w=>{g||(r.next(c()),g=!0);let I={type:Hs.DownloadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),"text"===e.responseType&&!!s.responseText&&(I.partialText=s.responseText),r.next(I)},C=w=>{let I={type:Hs.UploadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),r.next(I)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",C)),s.send(i),r.next({type:Hs.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",C)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(Le(iG))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();const uN=new It("XSRF_COOKIE_NAME"),fN=new It("XSRF_HEADER_NAME");class qW{}let r7e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=YU(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds),Le(Yd),Le(uN))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),hN=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(qW),Le(fN))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),s7e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(GW,[]);this.chain=r.reduceRight((s,i)=>new UW(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(zW),Le(s2))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),i7e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:hN,useClass:e7e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:uN,useValue:e.cookieName}:[],e.headerName?{provide:fN,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:[hN,{provide:GW,useExisting:hN,multi:!0},{provide:qW,useClass:r7e},{provide:uN,useValue:"XSRF-TOKEN"},{provide:fN,useValue:"X-XSRF-TOKEN"}]}),n})(),o7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:[J5e,{provide:DW,useClass:s7e},WW,{provide:zW,useExisting:WW}],imports:[i7e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class d3 extends Ai{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const by=ns(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function jW(...n){const t=D3(n),e=Yt(n),{args:r,keys:s}=AG(n);if(0===r.length)return ss([],t);const i=new vr(function a7e(n,t,e=V4){return r=>{ZW(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)ZW(t,()=>{const h=ss(n[u],t);let g=!1;h.subscribe(rs(r,m=>{i[u]=m,g||(g=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>xG(s,o):V4));return e?i.pipe(IG(e)):i}function ZW(n,t,e){n?ks(e,n,t):t()}function dN(...n){return function c7e(){return B4(1)}()(ss(n,D3(n)))}function YW(n){return new vr(t=>{xo(n()).subscribe(t)})}function dp(n,t){const e=nn(n)?n:()=>n,r=s=>s.error(e());return new vr(t?s=>t.schedule(r,0,s):r)}function pN(){return hr((n,t)=>{let e=null;n._refCount++;const r=rs(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class KW extends vr{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Gm(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new G1;const e=this.getSubject();t.add(this.source.subscribe(rs(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=G1.EMPTY)}return t}refCount(){return pN()(this)}}function l4(n,t){return hr((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(rs(r,u=>{s?.unsubscribe();let h=0;const g=i++;xo(n(u,g)).subscribe(s=rs(r,m=>r.next(t?t(u,m,g,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function pp(n){return n<=0?()=>Xa:hr((t,e)=>{let r=0;t.subscribe(rs(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function Oy(n){return hr((t,e)=>{let r=!1;t.subscribe(rs(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function XW(n=u7e){return hr((t,e)=>{let r=!1;t.subscribe(rs(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function u7e(){return new by}function c0(n,t){const e=arguments.length>=2;return r=>r.pipe(n?yl((s,i)=>n(s,i,r)):V4,pp(1),e?Oy(t):XW(()=>new by))}function li(n,t,e){const r=nn(n)||t||e?{next:n,error:t,complete:e}:n;return r?hr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(rs(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):V4}function l0(n){return hr((t,e)=>{let i,r=null,s=!1;r=t.subscribe(rs(e,void 0,void 0,o=>{i=xo(n(o,l0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function f7e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,h=0;i.subscribe(rs(o,g=>{const m=h++;u=c?n(u,g,m):(c=!0,g),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function QW(n,t){return hr(f7e(n,t,arguments.length>=2,!0))}function gN(n){return n<=0?()=>Xa:hr((t,e)=>{let r=[];t.subscribe(rs(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function JW(n,t){const e=arguments.length>=2;return r=>r.pipe(n?yl((s,i)=>n(s,i,r)):V4,gN(1),e?Oy(t):XW(()=>new by))}function mN(n){return hr((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Bn="primary",gp=Symbol("RouteTitle");class p7e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Y7(n){return new p7e(n)}function g7e(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function u4(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!eq(n[s],t[s]))return!1;return!0}function eq(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function tq(n){return Array.prototype.concat.apply([],n)}function nq(n){return n.length>0?n[n.length-1]:null}function ui(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function u0(n){return kb(n)?n:Vd(n)?ss(Promise.resolve(n)):Wt(n)}const v7e={exact:function iq(n,t,e){if(!hu(n.segments,t.segments)||!Ny(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!iq(n.children[r],t.children[r],e))return!1;return!0},subset:oq},rq={exact:function C7e(n,t){return u4(n,t)},subset:function y7e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>eq(n[e],t[e]))},ignored:()=>!0};function sq(n,t,e){return v7e[e.paths](n.root,t.root,e.matrixParams)&&rq[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function oq(n,t,e){return aq(n,t,t.segments,e)}function aq(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!hu(s,e)||t.hasChildren()||!Ny(s,e,r))}if(n.segments.length===e.length){if(!hu(n.segments,e)||!Ny(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!oq(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(hu(n.segments,s)&&Ny(n.segments,s,r)&&n.children[Bn])&&aq(n.children[Bn],t,i,r)}}function Ny(n,t,e){return t.every((r,s)=>rq[e](n[s].parameters,r.parameters))}class fu{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Y7(this.queryParams)),this._queryParamMap}toString(){return S7e.serialize(this)}}class qn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ui(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ay(this)}}class mp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Y7(this.parameters)),this._parameterMap}toString(){return fq(this)}}function hu(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let cq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:function(){return new vN},providedIn:"root"}),n})();class vN{parse(t){const e=new x7e(t);return new fu(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${_p(t.root,!0)}`,r=function w7e(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${Iy(e)}=${Iy(s)}`).join("&"):`${Iy(e)}=${Iy(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function P7e(n){return encodeURI(n)}(t.fragment)}`:""}`}}const S7e=new vN;function Ay(n){return n.segments.map(t=>fq(t)).join("/")}function _p(n,t){if(!n.hasChildren())return Ay(n);if(t){const e=n.children[Bn]?_p(n.children[Bn],!1):"",r=[];return ui(n.children,(s,i)=>{i!==Bn&&r.push(`${i}:${_p(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function M7e(n,t){let e=[];return ui(n.children,(r,s)=>{s===Bn&&(e=e.concat(t(r,s)))}),ui(n.children,(r,s)=>{s!==Bn&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===Bn?[_p(n.children[Bn],!1)]:[`${s}:${_p(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Bn]?`${Ay(n)}/${e[0]}`:`${Ay(n)}/(${e.join("//")})`}}function lq(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Iy(n){return lq(n).replace(/%3B/gi,";")}function CN(n){return lq(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xy(n){return decodeURIComponent(n)}function uq(n){return xy(n.replace(/\+/g,"%20"))}function fq(n){return`${CN(n.path)}${function T7e(n){return Object.keys(n).map(t=>`;${CN(t)}=${CN(n[t])}`).join("")}(n.parameters)}`}const b7e=/^[^\/()?;=#]+/;function ky(n){const t=n.match(b7e);return t?t[0]:""}const O7e=/^[^=?&#]+/,A7e=/^[^&#]+/;class x7e{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qn([],{}):new qn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[Bn]=new qn(t,e)),r}parseSegment(){const t=ky(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Oe(4009,!1);return this.capture(t),new mp(xy(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=ky(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=ky(this.remaining);s&&(r=s,this.capture(r))}t[xy(e)]=xy(r)}parseQueryParam(t){const e=function N7e(n){const t=n.match(O7e);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function I7e(n){const t=n.match(A7e);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=uq(e),i=uq(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=ky(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Oe(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Bn);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[Bn]:new qn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Oe(4011,!1)}}function yN(n){return n.segments.length>0?new qn([],{[Bn]:n}):n}function Ly(n){const t={};for(const r of Object.keys(n.children)){const i=Ly(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function k7e(n){if(1===n.numberOfChildren&&n.children[Bn]){const t=n.children[Bn];return new qn(n.segments.concat(t.segments),t.children)}return n}(new qn(n.segments,t))}function du(n){return n instanceof fu}function D7e(n,t,e,r,s){if(0===e.length)return K7(t.root,t.root,t.root,r,s);const i=function pq(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new dq(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return ui(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new dq(e,t,r)}(e);return i.toRoot()?K7(t.root,t.root,new qn([],{}),r,s):function o(u){const h=function V7e(n,t,e,r){if(n.isAbsolute)return new X7(t.root,!0,0);if(-1===r)return new X7(e,e===t.root,0);return function gq(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Oe(4005,!1);s=r.segments.length}return new X7(r,!1,s-i)}(e,r+(vp(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),g=h.processChildren?yp(h.segmentGroup,h.index,i.commands):MN(h.segmentGroup,h.index,i.commands);return K7(t.root,h.segmentGroup,g,r,s)}(n.snapshot?._lastPathIndex)}function vp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Cp(n){return"object"==typeof n&&null!=n&&n.outlets}function K7(n,t,e,r,s){let o,i={};r&&ui(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),o=n===t?e:hq(n,t,e);const c=yN(Ly(o));return new fu(c,i,s)}function hq(n,t,e){const r={};return ui(n.children,(s,i)=>{r[i]=s===t?e:hq(s,t,e)}),new qn(n.segments,r)}class dq{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&vp(r[0]))throw new Oe(4003,!1);const s=r.find(Cp);if(s&&s!==nq(r))throw new Oe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class X7{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function MN(n,t,e){if(n||(n=new qn([],{})),0===n.segments.length&&n.hasChildren())return yp(n,t,e);const r=function F7e(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(Cp(c))break;const u=`${c}`,h=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!_q(u,h,o))return i;r+=2}else{if(!_q(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new qn(n.segments.slice(0,r.pathIndex),{});return i.children[Bn]=new qn(n.segments.slice(r.pathIndex),n.children),yp(i,0,s)}return r.match&&0===s.length?new qn(n.segments,{}):r.match&&!n.hasChildren()?SN(n,t,e):r.match?yp(n,0,s):SN(n,t,e)}function yp(n,t,e){if(0===e.length)return new qn(n.segments,{});{const r=function H7e(n){return Cp(n[0])?n[0].outlets:{[Bn]:n}}(e),s={};return ui(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=MN(n.children[o],t,i))}),ui(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new qn(n.segments,s)}}function SN(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(Cp(i)){const u=B7e(i.outlets);return new qn(r,u)}if(0===s&&vp(e[0])){r.push(new mp(n.segments[t].path,mq(e[0]))),s++;continue}const o=Cp(i)?i.outlets[Bn]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&vp(c)?(r.push(new mp(o,mq(c))),s+=2):(r.push(new mp(o,{})),s++)}return new qn(r,{})}function B7e(n){const t={};return ui(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=SN(new qn([],{}),0,e))}),t}function mq(n){const t={};return ui(n,(e,r)=>t[r]=`${e}`),t}function _q(n,t,e){return n==e.path&&u4(t,e.parameters)}class Ml{constructor(t,e){this.id=t,this.url=e}}class PN extends Ml{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class f0 extends Ml{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ry extends Ml{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class vq extends Ml{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class $7e extends Ml{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class U7e extends Ml{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class G7e extends Ml{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class W7e extends Ml{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class q7e extends Ml{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class j7e{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Z7e{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Y7e{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class K7e{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class X7e{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Q7e{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Cq{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class yq{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=TN(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=TN(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=wN(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return wN(t,this._root).map(e=>e.value)}}function TN(n,t){if(n===t.value)return t;for(const e of t.children){const r=TN(n,e);if(r)return r}return null}function wN(n,t){if(n===t.value)return[t];for(const e of t.children){const r=wN(n,e);if(r.length)return r.unshift(t),r}return[]}class Sl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Q7(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class Eq extends yq{constructor(t,e){super(t),this.snapshot=e,bN(this,t)}toString(){return this.snapshot.toString()}}function Mq(n,t){const e=function efe(n,t){const o=new Dy([],{},{},"",{},Bn,t,null,n.root,-1,{});return new Pq("",new Sl(o,[]))}(n,t),r=new d3([new mp("",{})]),s=new d3({}),i=new d3({}),o=new d3({}),c=new d3(""),u=new go(r,s,o,c,i,Bn,t,e.root);return u.snapshot=e.root,new Eq(new Sl(u,[]),e)}class go{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(dn(h=>h[gp]))??Wt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(dn(t=>Y7(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(dn(t=>Y7(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Sq(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function tfe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class Dy{constructor(t,e,r,s,i,o,c,u,h,g,m,C){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[gp],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=g,this._correctedLastPathIndex=C??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Y7(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Y7(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Pq extends yq{constructor(t,e){super(e),this.url=t,bN(this,e)}toString(){return Tq(this._root)}}function bN(n,t){t.value._routerState=n,t.children.forEach(e=>bN(n,e))}function Tq(n){const t=n.children.length>0?` { ${n.children.map(Tq).join(", ")} } `:"";return`${n.value}${t}`}function ON(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,u4(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),u4(t.params,e.params)||n.params.next(e.params),function m7e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!u4(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),u4(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function NN(n,t){const e=u4(n.params,t.params)&&function E7e(n,t){return hu(n,t)&&n.every((e,r)=>u4(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||NN(n.parent,t.parent))}function Ep(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function rfe(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return Ep(n,r,s);return Ep(n,r)})}(n,t,e);return new Sl(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>Ep(n,c)),o}}const r=function sfe(n){return new go(new d3(n.url),new d3(n.params),new d3(n.queryParams),new d3(n.fragment),new d3(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>Ep(n,i));return new Sl(r,s)}}const AN="ngNavigationCancelingError";function wq(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=du(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=bq(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function bq(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[AN]=!0,r.cancellationCode=t,e&&(r.url=e),r}function Oq(n){return Nq(n)&&du(n.url)}function Nq(n){return n&&n[AN]}class ife{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Mp,this.attachRef=null}}let Mp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new ife,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const zy=!1;let IN=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new dr,this.deactivateEvents=new dr,this.attachEvents=new dr,this.detachEvents=new dr,this.name=s||Bn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Oe(4012,zy);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Oe(4012,zy);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Oe(4012,zy);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Oe(4013,zy);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new ofe(e,c,s.injector);if(r&&function afe(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(Q(Mp),Q(wa),S8("name"),Q(nu),Q(Ca))},n.\u0275dir=Ft({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class ofe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===go?this.route:t===Mp?this.childContexts:this.parent.get(t,e)}}let xN=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mt({type:n,selectors:[["ng-component"]],standalone:!0,features:[v$],decls:1,vars:0,template:function(e,r){1&e&&X(0,"router-outlet")},dependencies:[IN],encapsulation:2}),n})();function Aq(n,t){return n.providers&&!n._injector&&(n._injector=FC(n.providers,t,`Route: ${n.path}`)),n._injector??t}function LN(n){const t=n.children&&n.children.map(LN),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Bn&&(e.component=xN),e}function pc(n){return n.outlet||Bn}function Iq(n,t){const e=n.filter(r=>pc(r)===t);return e.push(...n.filter(r=>pc(r)!==t)),e}function Sp(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class hfe{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),ON(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=Q7(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),ui(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=Q7(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=Q7(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=Q7(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new Q7e(i.value.snapshot))}),t.children.length&&this.forwardEvent(new K7e(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(ON(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),ON(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=Sp(s.snapshot),u=c?.get(ya)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class xq{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Vy{constructor(t,e){this.component=t,this.route=e}}function dfe(n,t,e){const r=n._root;return Pp(r,t?t._root:null,e,[r.value])}function J7(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function xi(n){return null!==In(n)}(n)?t.get(n):n:r}function Pp(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=Q7(t);return n.children.forEach(o=>{(function gfe(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function mfe(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!hu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!hu(n.url,t.url)||!u4(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!NN(n,t)||!u4(n.queryParams,t.queryParams);default:return!NN(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new xq(r)):(i.data=o.data,i._resolvedData=o._resolvedData),Pp(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new Vy(c.outlet.component,o))}else o&&Tp(t,c,s),s.canActivateChecks.push(new xq(r)),Pp(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),ui(i,(o,c)=>Tp(o,e.getContext(c),s)),s}function Tp(n,t,e){const r=Q7(n),s=n.value;ui(r,(i,o)=>{Tp(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new Vy(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function wp(n){return"function"==typeof n}function RN(n){return n instanceof by||"EmptyError"===n?.name}const Hy=Symbol("INITIAL_VALUE");function ef(){return l4(n=>jW(n.map(t=>t.pipe(pp(1),function l7e(...n){const t=D3(n);return hr((e,r)=>{(t?dN(n,e,t):dN(n,e)).subscribe(r)})}(Hy)))).pipe(dn(t=>{for(const e of t)if(!0!==e){if(e===Hy)return Hy;if(!1===e||e instanceof fu)return e}return!0}),yl(t=>t!==Hy),pp(1)))}function kq(n){return function VP(...n){return Um(n)}(li(t=>{if(du(t))throw wq(0,t)}),dn(t=>!0===t))}const DN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Lq(n,t,e,r,s){const i=zN(n,t,e);return i.matched?function kfe(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?Wt(s.map(o=>{const c=J7(o,n);return u0(function Mfe(n){return n&&wp(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(ef(),kq()):Wt(!0)}(r=Aq(t,r),t,e).pipe(dn(o=>!0===o?i:{...DN})):Wt(i)}function zN(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...DN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||g7e)(e,n,t);if(!s)return{...DN};const i={};ui(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function Fy(n,t,e,r,s="corrected"){if(e.length>0&&function Dfe(n,t,e){return e.some(r=>By(n,t,r)&&pc(r)!==Bn)}(n,e,r)){const o=new qn(t,function Rfe(n,t,e,r){const s={};s[Bn]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&pc(i)!==Bn){const o=new qn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[pc(i)]=o}return s}(n,t,r,new qn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function zfe(n,t,e){return e.some(r=>By(n,t,r))}(n,e,r)){const o=new qn(n.segments,function Lfe(n,t,e,r,s,i){const o={};for(const c of r)if(By(n,e,c)&&!s[pc(c)]){const u=new qn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[pc(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new qn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function By(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function Rq(n,t,e,r){return!!(pc(n)===r||r!==Bn&&By(t,e,n))&&("**"===n.path||zN(t,n,e).matched)}function Dq(n,t,e){return 0===t.length&&!n.children[e]}const $y=!1;class Uy{constructor(t){this.segmentGroup=t||null}}class zq{constructor(t){this.urlTree=t}}function bp(n){return dp(new Uy(n))}function Vq(n){return dp(new zq(n))}class Bfe{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=Fy(this.urlTree.root,[],[],this.config).segmentGroup,e=new qn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Bn).pipe(dn(i=>this.createUrlTree(Ly(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(l0(i=>{if(i instanceof zq)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof Uy?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Bn).pipe(dn(s=>this.createUrlTree(Ly(s),t.queryParams,t.fragment))).pipe(l0(s=>{throw s instanceof Uy?this.noMatchError(s):s}))}noMatchError(t){return new Oe(4002,$y)}createUrlTree(t,e,r){const s=yN(t);return new fu(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(dn(i=>new qn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return ss(s).pipe(o0(i=>{const o=r.children[i],c=Iq(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(dn(u=>({segment:u,outlet:i})))}),QW((i,o)=>(i[o.outlet]=o.segment,i),{}),JW())}expandSegment(t,e,r,s,i,o){return ss(r).pipe(o0(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(l0(h=>{if(h instanceof Uy)return Wt(null);throw h}))),c0(c=>!!c),l0((c,u)=>{if(RN(c))return Dq(e,s,i)?Wt(new qn([],{})):bp(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return Rq(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):bp(e):bp(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Vq(i):this.lineralizeSegments(r,i).pipe(Re(o=>{const c=new qn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:g}=zN(e,s,i);if(!c)return bp(e);const m=this.applyRedirectCommands(u,s.redirectTo,g);return s.redirectTo.startsWith("/")?Vq(m):this.lineralizeSegments(s,m).pipe(Re(C=>this.expandSegment(t,e,r,C.concat(h),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=Aq(r,t),r.loadChildren?(r._loadedRoutes?Wt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(dn(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new qn(s,{})))):Wt(new qn(s,{}))):Lq(e,r,s,t).pipe(l4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(Re(g=>{const m=g.injector??t,C=g.routes,{segmentGroup:w,slicedSegments:I}=Fy(e,c,u,C),H=new qn(w.segments,w.children);if(0===I.length&&H.hasChildren())return this.expandChildren(m,C,H).pipe(dn(te=>new qn(c,te)));if(0===C.length&&0===I.length)return Wt(new qn(c,{}));const Y=pc(r)===i;return this.expandSegment(m,H,C,I,Y?Bn:i,!0).pipe(dn(_e=>new qn(c.concat(_e.segments),_e.children)))})):bp(e)))}getChildConfig(t,e,r){return e.children?Wt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Wt({routes:e._loadedRoutes,injector:e._loadedInjector}):function xfe(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?Wt(!0):Wt(s.map(o=>{const c=J7(o,n);return u0(function vfe(n){return n&&wp(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(ef(),kq())}(t,e,r).pipe(Re(s=>s?this.configLoader.loadChildren(t,e).pipe(li(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function Hfe(n){return dp(bq($y,3))}())):Wt({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Wt(r);if(s.numberOfChildren>1||!s.children[Bn])return dp(new Oe(4e3,$y));s=s.children[Bn]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new fu(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return ui(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return ui(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new qn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Oe(4001,$y);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class Ufe{}class qfe{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=Fy(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Bn).pipe(dn(e=>{if(null===e)return null;const r=new Dy([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Bn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Sl(r,e),i=new Pq(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=Sq(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return ss(Object.keys(r.children)).pipe(o0(s=>{const i=r.children[s],o=Iq(e,s);return this.processSegmentGroup(t,o,i,s)}),QW((s,i)=>s&&i?(s.push(...i),s):null),function h7e(n,t=!1){return hr((e,r)=>{let s=0;e.subscribe(rs(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),Oy(null),JW(),dn(s=>{if(null===s)return null;const i=Hq(s);return function jfe(n){n.sort((t,e)=>t.value.outlet===Bn?-1:e.value.outlet===Bn?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return ss(e).pipe(o0(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),c0(o=>!!o),l0(o=>{if(RN(o))return Dq(r,s,i)?Wt([]):Wt(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!Rq(e,r,s,i))return Wt(null);let o;if("**"===e.path){const c=s.length>0?nq(s).parameters:{},u=Bq(r)+s.length;o=Wt({snapshot:new Dy(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Uq(e),pc(e),e.component??e._loadedComponent??null,e,Fq(r),u,Gq(e),u),consumedSegments:[],remainingSegments:[]})}else o=Lq(r,e,s,t).pipe(dn(({matched:c,consumedSegments:u,remainingSegments:h,parameters:g})=>{if(!c)return null;const m=Bq(r)+u.length;return{snapshot:new Dy(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Uq(e),pc(e),e.component??e._loadedComponent??null,e,Fq(r),m,Gq(e),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(l4(c=>{if(null===c)return Wt(null);const{snapshot:u,consumedSegments:h,remainingSegments:g}=c;t=e._injector??t;const m=e._loadedInjector??t,C=function Zfe(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:w,slicedSegments:I}=Fy(r,h,g,C.filter(Y=>void 0===Y.redirectTo),this.relativeLinkResolution);if(0===I.length&&w.hasChildren())return this.processChildren(m,C,w).pipe(dn(Y=>null===Y?null:[new Sl(u,Y)]));if(0===C.length&&0===I.length)return Wt([new Sl(u,[])]);const H=pc(e)===i;return this.processSegment(m,C,w,I,H?Bn:i).pipe(dn(Y=>null===Y?null:[new Sl(u,Y)]))}))}}function Yfe(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Hq(n){const t=[],e=new Set;for(const r of n){if(!Yfe(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=Hq(r.children);t.push(new Sl(r.value,s))}return t.filter(r=>!e.has(r))}function Fq(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Bq(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function Uq(n){return n.data||{}}function Gq(n){return n.resolve||{}}function Wq(n){return"string"==typeof n.title||null===n.title}function VN(n){return l4(t=>{const e=n(t);return e?ss(e).pipe(dn(()=>t)):Wt(t)})}let qq=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===Bn);return r}getResolvedTitleForRoute(e){return e.data[gp]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:function(){return kr(jq)},providedIn:"root"}),n})(),jq=(()=>{class n extends qq{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(Le(TG))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class r9e{}class i9e extends class s9e{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const Wy=new It("",{providedIn:"root",factory:()=>({})}),HN=new It("ROUTES");let FN=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Wt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=u0(e.loadComponent()).pipe(li(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),mN(()=>{this.componentLoaders.delete(e)})),s=new KW(r,()=>new Ai).pipe(pN());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Wt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(dn(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,g=!1;Array.isArray(c)?h=c:(u=c.create(e).injector,h=tq(u.get(HN,[],Gt.Self|Gt.Optional)));return{routes:h.map(LN),injector:u}}),mN(()=>{this.childrenLoaders.delete(r)})),o=new KW(i,()=>new Ai).pipe(pN());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return u0(e()).pipe(Re(r=>r instanceof m$||Array.isArray(r)?Wt(r):ss(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(Le(s2),Le(oO))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class a9e{}class c9e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function l9e(n){throw n}function u9e(n,t,e){return t.parse("/")}const f9e={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},h9e={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function Yq(){const n=kr(cq),t=kr(Mp),e=kr(EO),r=kr(s2),s=kr(oO),i=kr(HN,{optional:!0})??[],o=kr(Wy,{optional:!0})??{},c=kr(jq),u=kr(qq,{optional:!0}),h=kr(a9e,{optional:!0}),g=kr(r9e,{optional:!0}),m=new jn(null,n,t,e,r,s,tq(i));return h&&(m.urlHandlingStrategy=h),g&&(m.routeReuseStrategy=g),m.titleStrategy=u??c,function d9e(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let jn=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ai,this.errorHandler=l9e,this.malformedUriErrorHandler=u9e,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Wt(void 0),this.urlHandlingStrategy=new c9e,this.routeReuseStrategy=new i9e,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(FN),this.configLoader.onLoadEndListener=C=>this.triggerEvent(new Z7e(C)),this.configLoader.onLoadStartListener=C=>this.triggerEvent(new j7e(C)),this.ngModule=o.get(tu),this.console=o.get(B6e);const m=o.get(Er);this.isNgZoneEnabled=m instanceof Er&&Er.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function _7e(){return new fu(new qn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Mq(this.currentUrlTree,this.rootComponentType),this.transitions=new d3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(yl(s=>0!==s.id),dn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),l4(s=>{let i=!1,o=!1;return Wt(s).pipe(li(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),l4(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Kq(c.source)&&(this.browserUrlTree=c.extractedUrl),Wt(c).pipe(l4(m=>{const C=this.transitions.getValue();return r.next(new PN(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),C!==this.transitions.getValue()?Xa:Promise.resolve(m)}),function $fe(n,t,e,r){return l4(s=>function Ffe(n,t,e,r,s){return new Bfe(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(dn(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),li(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function Xfe(n,t,e,r,s,i){return Re(o=>function Wfe(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new qfe(n,t,e,r,s,o,c,i).recognize().pipe(l4(u=>null===u?function Gfe(n){return new vr(t=>t.error(n))}(new Ufe):Wt(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(dn(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),li(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const w=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(w,m)}this.browserUrlTree=m.urlAfterRedirects}const C=new $7e(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(C)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:C,extractedUrl:w,source:I,restoredState:H,extras:Y}=c,ee=new PN(C,this.serializeUrl(w),I,H);r.next(ee);const _e=Mq(w,this.rootComponentType).snapshot;return Wt(s={...c,targetSnapshot:_e,urlAfterRedirects:w,extras:{...Y,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),Xa}),li(c=>{const u=new U7e(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),dn(c=>s={...c,guards:dfe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function Pfe(n,t){return Re(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?Wt({...e,guardsResult:!0}):function Tfe(n,t,e,r){return ss(n).pipe(Re(s=>function Ife(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Wt(i.map(c=>{const u=Sp(t)??s,h=J7(c,u);return u0(function Efe(n){return n&&wp(n.canDeactivate)}(h)?h.canDeactivate(n,t,e,r):u.runInContext(()=>h(n,t,e,r))).pipe(c0())})).pipe(ef()):Wt(!0)}(s.component,s.route,e,t,r)),c0(s=>!0!==s,!0))}(o,r,s,n).pipe(Re(c=>c&&function _fe(n){return"boolean"==typeof n}(c)?function wfe(n,t,e,r){return ss(t).pipe(o0(s=>dN(function Ofe(n,t){return null!==n&&t&&t(new Y7e(n)),Wt(!0)}(s.route.parent,r),function bfe(n,t){return null!==n&&t&&t(new X7e(n)),Wt(!0)}(s.route,r),function Afe(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function pfe(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>YW(()=>Wt(o.guards.map(u=>{const h=Sp(o.node)??e,g=J7(u,h);return u0(function yfe(n){return n&&wp(n.canActivateChild)}(g)?g.canActivateChild(r,n):h.runInContext(()=>g(r,n))).pipe(c0())})).pipe(ef())));return Wt(i).pipe(ef())}(n,s.path,e),function Nfe(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Wt(!0);const s=r.map(i=>YW(()=>{const o=Sp(t)??e,c=J7(i,o);return u0(function Cfe(n){return n&&wp(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(c0())}));return Wt(s).pipe(ef())}(n,s.route,e))),c0(s=>!0!==s,!0))}(r,i,n,t):Wt(c)),dn(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),li(c=>{if(s.guardsResult=c.guardsResult,du(c.guardsResult))throw wq(0,c.guardsResult);const u=new G7e(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),yl(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),VN(c=>{if(c.guards.canActivateChecks.length)return Wt(c).pipe(li(u=>{const h=new W7e(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),l4(u=>{let h=!1;return Wt(u).pipe(function Qfe(n,t){return Re(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return Wt(e);let i=0;return ss(s).pipe(o0(o=>function Jfe(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!Wq(s)&&(i[gp]=s.title),function e9e(n,t,e,r){const s=function t9e(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Wt({});const i={};return ss(s).pipe(Re(o=>function n9e(n,t,e,r){const s=Sp(t)??r,i=J7(n,s);return u0(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(c0(),li(c=>{i[o]=c}))),gN(1),function d7e(n){return dn(()=>n)}(i),l0(o=>RN(o)?Xa:dp(o)))}(i,n,t,r).pipe(dn(o=>(n._resolvedData=o,n.data=Sq(n,e).resolve,s&&Wq(s)&&(n.data[gp]=s.title),null)))}(o.route,r,n,t)),li(()=>i++),gN(1),Re(o=>i===s.length?Wt(e):Xa))})}(this.paramsInheritanceStrategy,this.ngModule.injector),li({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),li(u=>{const h=new q7e(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),VN(c=>{const u=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(li(m=>{h.component=m}),dn(()=>{})));for(const m of h.children)g.push(...u(m));return g};return jW(u(c.targetSnapshot.root)).pipe(Oy(),pp(1))}),VN(()=>this.afterPreactivation()),dn(c=>{const u=function nfe(n,t,e){const r=Ep(n,t._root,e?e._root:void 0);return new Eq(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),li(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>dn(r=>(new hfe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),li({next(){i=!0},complete(){i=!0}}),mN(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),l0(c=>{if(o=!0,Nq(c)){Oq(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new Ry(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),Oq(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),g={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Kq(s.source)};this.scheduleNavigation(h,"imperative",null,g,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new vq(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return Xa}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(LN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,g=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),D7e(h,this.currentUrlTree,e,m,g??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=du(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function p9e(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Oe(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...f9e}:!1===r?{...h9e}:r,du(e))return sq(this.currentUrlTree,e,s);const i=this.parseUrl(e);return sq(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new f0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((C,w)=>{c=C,u=w});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(C=>Promise.reject(C))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new Ry(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){P7()},n.\u0275prov=Je({token:n,factory:function(){return Yq()},providedIn:"root"}),n})();function Kq(n){return"imperative"!==n}let Op=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new Ai,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=ml(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=ml(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=ml(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(go),S8("tabindex"),Q(ao),Q(ri))},n.\u0275dir=Ft({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&J("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Y2]}),n})(),pu=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new Ai,this.subscription=e.events.subscribe(i=>{i instanceof f0&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=ml(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=ml(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=ml(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(go),Q(su))},n.\u0275dir=Ft({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&J("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&D("target",r.target)("href",r.href,Qc)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Y2]}),n})();class Xq{}let _9e=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(yl(e=>e instanceof f0),o0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=FC(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return ss(s).pipe(B4())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Wt(null);const i=s.pipe(Re(o=>null===o?Wt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?ss([i,this.loader.loadComponent(r)]).pipe(B4()):i})}}return n.\u0275fac=function(e){return new(e||n)(Le(jn),Le(oO),Le(Ca),Le(Xq),Le(FN))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const BN=new It("");let Qq=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof PN?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof f0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Cq&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new Cq(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){P7()},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();function tf(n,t){return{\u0275kind:n,\u0275providers:t}}function $N(n){return[{provide:HN,multi:!0,useValue:n}]}function ej(){const n=kr(s2);return t=>{const e=n.get(Kd);if(t!==e.components[0])return;const r=n.get(jn),s=n.get(tj);1===n.get(UN)&&r.initialNavigation(),n.get(nj,null,Gt.Optional)?.setUpPreloading(),n.get(BN,null,Gt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const tj=new It("",{factory:()=>new Ai}),UN=new It("",{providedIn:"root",factory:()=>1});const nj=new It("");function E9e(n){return tf(0,[{provide:nj,useExisting:_9e},{provide:Xq,useExisting:n}])}const rj=new It("ROUTER_FORROOT_GUARD"),M9e=[EO,{provide:cq,useClass:vN},{provide:jn,useFactory:Yq},Mp,{provide:go,useFactory:function Jq(n){return n.routerState.root},deps:[jn]},FN];function S9e(){return new dU("Router",jn)}let P9e=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[M9e,[],$N(e),{provide:rj,useFactory:O9e,deps:[[jn,new r2,new A8]]},{provide:Wy,useValue:r||{}},r?.useHash?{provide:su,useClass:N0e}:{provide:su,useClass:VU},{provide:BN,useFactory:()=>{const n=kr(jn),t=kr(j8e),e=kr(Wy);return e.scrollOffset&&t.setOffset(e.scrollOffset),new Qq(n,t,e)}},r?.preloadingStrategy?E9e(r.preloadingStrategy).\u0275providers:[],{provide:dU,multi:!0,useFactory:S9e},r?.initialNavigation?N9e(r):[],[{provide:sj,useFactory:ej},{provide:iU,multi:!0,useExisting:sj}]]}}static forChild(e){return{ngModule:n,providers:[$N(e)]}}}return n.\u0275fac=function(e){return new(e||n)(Le(rj,8))},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({imports:[xN]}),n})();function O9e(n){return"guarded"}function N9e(n){return["disabled"===n.initialNavigation?tf(3,[{provide:GC,multi:!0,useFactory:()=>{const t=kr(jn);return()=>{t.setUpLocationChangeListener()}}},{provide:UN,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?tf(2,[{provide:UN,useValue:0},{provide:GC,multi:!0,deps:[s2],useFactory:t=>{const e=t.get(b0e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get(jn),c=t.get(tj);(function s(i){t.get(jn).events.pipe(yl(c=>c instanceof f0||c instanceof Ry||c instanceof vq),dn(c=>c instanceof f0||c instanceof Ry&&(0===c.code||1===c.code)&&null),yl(c=>null!==c),pp(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Wt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const sj=new It("");class ij{}const Pl="*";function oj(n,t=null){return{type:2,steps:n,options:t}}function aj(n){return{type:6,styles:n,offset:null}}function cj(n){Promise.resolve().then(n)}class Np{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){cj(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class lj{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?cj(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function uj(n){return new Oe(3e3,!1)}function hhe(){return typeof window<"u"&&typeof window.document<"u"}function WN(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function h0(n){switch(n.length){case 0:return new Np;case 1:return n[0];default:return new lj(n)}}function fj(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(g=>{const m=g.get("offset"),C=m==u,w=C&&h||new Map;g.forEach((I,H)=>{let Y=H,ee=I;if("offset"!==H)switch(Y=t.normalizePropertyName(Y,o),ee){case"!":ee=s.get(H);break;case Pl:ee=i.get(H);break;default:ee=t.normalizeStyleValue(H,Y,ee,o)}w.set(Y,ee)}),C||c.push(w),h=w,u=m}),o.length)throw function ehe(n){return new Oe(3502,!1)}();return c}function qN(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&jN(e,"start",n)));break;case"done":n.onDone(()=>r(e&&jN(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&jN(e,"destroy",n)))}}function jN(n,t,e){const i=ZN(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function ZN(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Oa(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function hj(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let YN=(n,t)=>!1,dj=(n,t,e)=>[],pj=null;function KN(n){const t=n.parentNode||n.host;return t===pj?null:t}(WN()||typeof Element<"u")&&(hhe()?(pj=(()=>document.documentElement)(),YN=(n,t)=>{for(;t;){if(t===n)return!0;t=KN(t)}return!1}):YN=(n,t)=>n.contains(t),dj=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let gu=null,gj=!1;const mj=YN,_j=dj;let vj=(()=>{class n{validateStyleProperty(e){return function phe(n){gu||(gu=function ghe(){return typeof document<"u"?document.body:null}()||{},gj=!!gu.style&&"WebkitAppearance"in gu.style);let t=!0;return gu.style&&!function dhe(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in gu.style,!t&&gj&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in gu.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return mj(e,r)}getParentElement(e){return KN(e)}query(e,r,s){return _j(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new Np(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})(),XN=(()=>{class n{}return n.NOOP=new vj,n})();const QN="ng-enter",Yy="ng-leave",Ky="ng-trigger",Xy=".ng-trigger",yj="ng-animating",JN=".ng-animating";function Tl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:eA(parseFloat(t[1]),t[2])}function eA(n,t){return"s"===t?1e3*n:n}function Qy(n,t,e){return n.hasOwnProperty("duration")?n:function vhe(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(uj()),{duration:0,delay:0,easing:""};s=eA(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=eA(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function x9e(){return new Oe(3100,!1)}()),c=!0),i<0&&(t.push(function k9e(){return new Oe(3101,!1)}()),c=!0),c&&t.splice(u,0,uj())}return{duration:s,delay:i,easing:o}}(n,t,e)}function Ap(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Ej(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function d0(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function Sj(n,t,e){return e?t+":"+e+";":""}function Pj(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=Sj(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Sj(0,Mhe(e),n.style[e]));n.setAttribute("style",t)}function f4(n,t,e){n.style&&(t.forEach((r,s)=>{const i=nA(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),WN()&&Pj(n))}function mu(n,t){n.style&&(t.forEach((e,r)=>{const s=nA(r);n.style[s]=""}),WN()&&Pj(n))}function Ip(n){return Array.isArray(n)?1==n.length?n[0]:oj(n):n}const tA=new RegExp("{{\\s*(.+?)\\s*}}","g");function Tj(n){let t=[];if("string"==typeof n){let e;for(;e=tA.exec(n);)t.push(e[1]);tA.lastIndex=0}return t}function xp(n,t,e){const r=n.toString(),s=r.replace(tA,(i,o)=>{let c=t[o];return null==c&&(e.push(function R9e(n){return new Oe(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function Jy(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const Ehe=/-+([a-z0-9])/g;function nA(n){return n.replace(Ehe,(...t)=>t[1].toUpperCase())}function Mhe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Na(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function D9e(n){return new Oe(3004,!1)}()}}function wj(n,t){return window.getComputedStyle(n)[t]}function Ohe(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function Nhe(n,t,e){if(":"==n[0]){const u=function Ahe(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function K9e(n){return new Oe(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function Y9e(n){return new Oe(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(bj(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(bj(o,s))}(r,e,t)):e.push(n),e}const rE=new Set(["true","1"]),sE=new Set(["false","0"]);function bj(n,t){const e=rE.has(n)||sE.has(n),r=rE.has(t)||sE.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?rE.has(n):sE.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?rE.has(t):sE.has(t)),o&&c}}const Ihe=new RegExp("s*:selfs*,?","g");function rA(n,t,e,r){return new xhe(n).build(t,e,r)}class xhe{constructor(t){this._driver=t}build(t,e,r){const s=new Rhe(e);return this._resetContextStyleTimingState(s),Na(this,Ip(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function V9e(){return new Oe(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(g=>{u.name=g,i.push(this.visitState(u,e))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function H9e(){return new Oe(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{Tj(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(Jy(i.values()),e.errors.push(function F9e(n,t){return new Oe(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Na(this,Ip(t.animation),e);return{type:1,matchers:Ohe(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:_u(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Na(this,r,e)),options:_u(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=Na(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:_u(t.options)}}visitAnimate(t,e){const r=function zhe(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return sA(Qy(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=sA(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=Qy(e,t);return sA(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:aj({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=aj(h)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===Pl?r.push(c):e.errors.push(new Oe(3002,!1)):r.push(Ej(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=e.collectedStyles.get(e.currentQuerySelector),g=h.get(u);let m=!0;g&&(i!=s&&i>=g.startTime&&s<=g.endTime&&(e.errors.push(function $9e(n,t,e,r,s){return new Oe(3010,!1)}()),m=!1),i=g.startTime),m&&h.set(u,{startTime:i,endTime:s}),e.options&&function yhe(n,t,e){const r=t.params||{},s=Tj(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function L9e(n){return new Oe(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function U9e(){return new Oe(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const g=t.steps.map(ee=>{const _e=this._makeStyleAst(ee,e);let te=null!=_e.offset?_e.offset:function Dhe(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(_e.styles),Ae=0;return null!=te&&(i++,Ae=_e.offset=te),u=u||Ae<0||Ae>1,c=c||Ae<h,h=Ae,o.push(Ae),_e});u&&e.errors.push(function G9e(){return new Oe(3012,!1)}()),c&&e.errors.push(function W9e(){return new Oe(3200,!1)}());const m=t.steps.length;let C=0;i>0&&i<m?e.errors.push(function q9e(){return new Oe(3202,!1)}()):0==i&&(C=1/(m-1));const w=m-1,I=e.currentTime,H=e.currentAnimateTimings,Y=H.duration;return g.forEach((ee,_e)=>{const te=C>0?_e==w?1:C*_e:o[_e],Ae=te*Y;e.currentTime=I+H.delay+Ae,H.duration=Ae,this._validateStyleAst(ee,e),ee.offset=te,r.styles.push(ee)}),r}visitReference(t,e){return{type:8,animation:Na(this,Ip(t.animation),e),options:_u(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:_u(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:_u(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function khe(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(Ihe,"")),n=n.replace(/@\*/g,Xy).replace(/@\w+/g,e=>Xy+"-"+e.slice(1)).replace(/:animating/g,JN),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Oa(e.collectedStyles,e.currentQuerySelector,new Map);const c=Na(this,Ip(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:_u(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function j9e(){return new Oe(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:Qy(t.timings,e.errors,!0);return{type:12,animation:Na(this,Ip(t.animation),e),timings:r,options:null}}}class Rhe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function _u(n){return n?(n=Ap(n)).params&&(n.params=function Lhe(n){return n?Ap(n):null}(n.params)):n={},n}function sA(n,t,e){return{duration:n,delay:t,easing:e}}function iA(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class iE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Fhe=new RegExp(":enter","g"),$he=new RegExp(":leave","g");function oA(n,t,e,r,s,i=new Map,o=new Map,c,u,h=[]){return(new Uhe).buildKeyframes(n,t,e,r,s,i,o,c,u,h)}class Uhe{buildKeyframes(t,e,r,s,i,o,c,u,h,g=[]){h=h||new iE;const m=new aA(t,e,h,s,i,g,[]);m.options=u;const C=u.delay?Tl(u.delay):0;m.currentTimeline.delayNextStep(C),m.currentTimeline.setStyles([o],null,m.errors,u),Na(this,r,m);const w=m.timelines.filter(I=>I.containsAnimation());if(w.length&&c.size){let I;for(let H=w.length-1;H>=0;H--){const Y=w[H];if(Y.element===e){I=Y;break}}I&&!I.allowOnlyTimelineStyles()&&I.setStyles([c],null,m.errors,u)}return w.length?w.map(I=>I.buildKeyframes()):[iA(e,[],[],[],0,C,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:Tl(xp(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?Tl(r.duration):null,c=null!=r.delay?Tl(r.delay):null;return 0!==o&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Na(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=oE);const o=Tl(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Na(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Tl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),Na(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return Qy(e.params?xp(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?Tl(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=oE);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((h,g)=>{e.currentQueryIndex=g;const m=e.createSubContext(t.options,h);i&&m.delayNextStep(i),h===e.element&&(u=m.currentTimeline),Na(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const g=e.currentTimeline;u&&g.delayNextStep(u);const m=g.currentTime;Na(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const oE={};class aA{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=oE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new aE(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=Tl(r.duration)),null!=r.delay&&(s.delay=Tl(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=xp(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new aA(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=oE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new Ghe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(Fhe,"."+this._enterClassName)).replace($he,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function Z9e(n){return new Oe(3014,!1)}()),c}}class aE{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new aE(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Pl),this._currentKeyframe.set(e,Pl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function Whe(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,Pl)}else d0(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const h=xp(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Pl),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=d0(c,new Map,this._backFill);h.forEach((g,m)=>{"!"===g?t.add(m):g===Pl&&e.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=t.size?Jy(t.values()):[],o=e.size?Jy(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return iA(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class Ghe extends aE{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=d0(t[0]);u.set("offset",0),i.push(u);const h=d0(t[0]);h.set("offset",Aj(c)),i.push(h);const g=t.length-1;for(let m=1;m<=g;m++){let C=d0(t[m]);const w=C.get("offset");C.set("offset",Aj((e+w*r)/o)),i.push(C)}r=o,e=0,s="",t=i}return iA(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function Aj(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class cA{}const qhe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class jhe extends cA{normalizePropertyName(t,e){return nA(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(qhe.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function z9e(n,t){return new Oe(3005,!1)}())}return o+i}}function Ij(n,t,e,r,s,i,o,c,u,h,g,m,C){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:g,totalTime:m,errors:C}}const lA={};class xj{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function Zhe(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,h,g){const m=[],C=this.ast.options&&this.ast.options.params||lA,I=this.buildStyles(r,c&&c.params||lA,m),H=u&&u.params||lA,Y=this.buildStyles(s,H,m),ee=new Set,_e=new Map,te=new Map,Ae="void"===s,Fe={params:Yhe(H,C),delay:this.ast.options?.delay},Ze=g?[]:oA(t,e,this.ast.animation,i,o,I,Y,Fe,h,m);let zt=0;if(Ze.forEach(w1=>{zt=Math.max(w1.duration+w1.delay,zt)}),m.length)return Ij(e,this._triggerName,r,s,Ae,I,Y,[],[],_e,te,zt,m);Ze.forEach(w1=>{const es=w1.element,Lc=Oa(_e,es,new Set);w1.preStyleProps.forEach(Ni=>Lc.add(Ni));const Io=Oa(te,es,new Set);w1.postStyleProps.forEach(Ni=>Io.add(Ni)),es!==e&&ee.add(es)});const k1=Jy(ee.values());return Ij(e,this._triggerName,r,s,Ae,I,Y,Ze,k1,_e,te,zt)}}function Yhe(n,t){const e=Ap(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class Khe{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=Ap(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=xp(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class Qhe{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new Khe(s.style,s.options&&s.options.params||{},r))}),kj(this.states,"true","1"),kj(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new xj(t,s,this.states))}),this.fallbackTransition=function Jhe(n,t,e){return new xj(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function kj(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const ede=new iE;class tde{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=rA(this._driver,e,r,[]);if(r.length)throw function the(n){return new Oe(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=fj(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=oA(this._driver,e,i,QN,Yy,new Map,new Map,r,ede,s),o.forEach(g=>{const m=Oa(c,g.element,new Map);g.postStyleProps.forEach(C=>m.set(C,null))})):(s.push(function nhe(){return new Oe(3300,!1)}()),o=[]),s.length)throw function rhe(n){return new Oe(3504,!1)}();c.forEach((g,m)=>{g.forEach((C,w)=>{g.set(w,this._driver.computeStyle(m,w,Pl))})});const h=h0(o.map(g=>{const m=c.get(g.element);return this._buildPlayer(g,new Map,m)}));return this._playersById.set(t,h),h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function she(n){return new Oe(3301,!1)}();return e}listen(t,e,r,s){const i=ZN(e,"","","");return qN(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const Lj="ng-animate-queued",uA="ng-animate-disabled",ode=[],Rj={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ade={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},gc="__ng_removed";class fA{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function fde(n){return n??null}(r?t.value:t),r){const i=Ap(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const kp="void",hA=new fA(kp);class cde{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,mc(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function ihe(n,t){return new Oe(3302,!1)}();if(null==r||0==r.length)throw function ohe(n){return new Oe(3303,!1)}();if(!function hde(n){return"start"==n||"done"==n}(r))throw function ahe(n,t){return new Oe(3400,!1)}();const i=Oa(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=Oa(this._engine.statesByElement,t,new Map);return c.has(e)||(mc(t,Ky),mc(t,Ky+"-"+e),c.set(e,hA)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function che(n){return new Oe(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new dA(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(mc(t,Ky),mc(t,Ky+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const h=new fA(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(e,h),u||(u=hA),h.value!==kp&&u.value===h.value){if(!function gde(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,h.params)){const H=[],Y=i.matchStyles(u.value,u.params,H),ee=i.matchStyles(h.value,h.params,H);H.length?this._engine.reportError(H):this._engine.afterFlush(()=>{mu(t,Y),f4(t,ee)})}return}const C=Oa(this._engine.playersByElement,t,[]);C.forEach(H=>{H.namespaceId==this.id&&H.triggerName==e&&H.queued&&H.destroy()});let w=i.matchTransition(u.value,h.value,t,h.params),I=!1;if(!w){if(!s)return;w=i.fallbackTransition,I=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:w,fromState:u,toState:h,player:o,isFallbackTransition:I}),I||(mc(t,Lj),o.onStart(()=>{nf(t,Lj)})),o.onDone(()=>{let H=this.players.indexOf(o);H>=0&&this.players.splice(H,1);const Y=this._engine.playersByElement.get(t);if(Y){let ee=Y.indexOf(o);ee>=0&&Y.splice(ee,1)}}),this.players.push(o),C.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,Xy,!0);r.forEach(s=>{if(s[gc])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const g=this.trigger(t,h,kp,s);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&h0(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||hA,g=new fA(kp),m=new dA(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:h,toState:g,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[gc];(!i||i===Rj)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){mc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=ZN(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,qN(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class lde{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new cde(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(cE(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!cE(e))return;const i=e[gc];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),mc(t,uA)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),nf(t,uA))}removeNode(t,e,r,s){if(cE(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[gc]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return cE(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,Xy,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,JN,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return h0(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[gc];if(e&&e.setForRemoval){if(t[gc]=Rj,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(uA)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)mc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?h0(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function lhe(n){return new Oe(3402,!1)}()}_flushAnimations(t,e){const r=new iE,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,g=new Set;this.disabledNodes.forEach(yt=>{g.add(yt);const Bt=this.driver.query(yt,".ng-animate-queued",!0);for(let Zt=0;Zt<Bt.length;Zt++)g.add(Bt[Zt])});const m=this.bodyNode,C=Array.from(this.statesByElement.keys()),w=Vj(C,this.collectedEnterElements),I=new Map;let H=0;w.forEach((yt,Bt)=>{const Zt=QN+H++;I.set(Bt,Zt),yt.forEach(s1=>mc(s1,Zt))});const Y=[],ee=new Set,_e=new Set;for(let yt=0;yt<this.collectedLeaveElements.length;yt++){const Bt=this.collectedLeaveElements[yt],Zt=Bt[gc];Zt&&Zt.setForRemoval&&(Y.push(Bt),ee.add(Bt),Zt.hasAnimation?this.driver.query(Bt,".ng-star-inserted",!0).forEach(s1=>ee.add(s1)):_e.add(Bt))}const te=new Map,Ae=Vj(C,Array.from(ee));Ae.forEach((yt,Bt)=>{const Zt=Yy+H++;te.set(Bt,Zt),yt.forEach(s1=>mc(s1,Zt))}),t.push(()=>{w.forEach((yt,Bt)=>{const Zt=I.get(Bt);yt.forEach(s1=>nf(s1,Zt))}),Ae.forEach((yt,Bt)=>{const Zt=te.get(Bt);yt.forEach(s1=>nf(s1,Zt))}),Y.forEach(yt=>{this.processLeaveNode(yt)})});const Fe=[],Ze=[];for(let yt=this._namespaceList.length-1;yt>=0;yt--)this._namespaceList[yt].drainQueuedTransitions(e).forEach(Zt=>{const s1=Zt.player,Ut=Zt.element;if(Fe.push(s1),this.collectedEnterElements.length){const Xi=Ut[gc];if(Xi&&Xi.setForMove){if(Xi.previousTriggersValues&&Xi.previousTriggersValues.has(Zt.triggerName)){const p5=Xi.previousTriggersValues.get(Zt.triggerName),Rc=this.statesByElement.get(Zt.element);if(Rc&&Rc.has(Zt.triggerName)){const zP=Rc.get(Zt.triggerName);zP.value=p5,Rc.set(Zt.triggerName,zP)}}return void s1.destroy()}}const D4=!m||!this.driver.containsElement(m,Ut),qa=te.get(Ut),J0=I.get(Ut),ts=this._buildInstruction(Zt,r,J0,qa,D4);if(ts.errors&&ts.errors.length)return void Ze.push(ts);if(D4)return s1.onStart(()=>mu(Ut,ts.fromStyles)),s1.onDestroy(()=>f4(Ut,ts.toStyles)),void s.push(s1);if(Zt.isFallbackTransition)return s1.onStart(()=>mu(Ut,ts.fromStyles)),s1.onDestroy(()=>f4(Ut,ts.toStyles)),void s.push(s1);const $3e=[];ts.timelines.forEach(Xi=>{Xi.stretchStartingKeyframe=!0,this.disabledNodes.has(Xi.element)||$3e.push(Xi)}),ts.timelines=$3e,r.append(Ut,ts.timelines),o.push({instruction:ts,player:s1,element:Ut}),ts.queriedElements.forEach(Xi=>Oa(c,Xi,[]).push(s1)),ts.preStyleProps.forEach((Xi,p5)=>{if(Xi.size){let Rc=u.get(p5);Rc||u.set(p5,Rc=new Set),Xi.forEach((zP,xH)=>Rc.add(xH))}}),ts.postStyleProps.forEach((Xi,p5)=>{let Rc=h.get(p5);Rc||h.set(p5,Rc=new Set),Xi.forEach((zP,xH)=>Rc.add(xH))})});if(Ze.length){const yt=[];Ze.forEach(Bt=>{yt.push(function uhe(n,t){return new Oe(3505,!1)}())}),Fe.forEach(Bt=>Bt.destroy()),this.reportError(yt)}const zt=new Map,k1=new Map;o.forEach(yt=>{const Bt=yt.element;r.has(Bt)&&(k1.set(Bt,Bt),this._beforeAnimationBuild(yt.player.namespaceId,yt.instruction,zt))}),s.forEach(yt=>{const Bt=yt.element;this._getPreviousPlayers(Bt,!1,yt.namespaceId,yt.triggerName,null).forEach(s1=>{Oa(zt,Bt,[]).push(s1),s1.destroy()})});const w1=Y.filter(yt=>Fj(yt,u,h)),es=new Map;zj(es,this.driver,_e,h,Pl).forEach(yt=>{Fj(yt,u,h)&&w1.push(yt)});const Io=new Map;w.forEach((yt,Bt)=>{zj(Io,this.driver,new Set(yt),u,"!")}),w1.forEach(yt=>{const Bt=es.get(yt),Zt=Io.get(yt);es.set(yt,new Map([...Array.from(Bt?.entries()??[]),...Array.from(Zt?.entries()??[])]))});const Ni=[],Zn=[],o6={};o.forEach(yt=>{const{element:Bt,player:Zt,instruction:s1}=yt;if(r.has(Bt)){if(g.has(Bt))return Zt.onDestroy(()=>f4(Bt,s1.toStyles)),Zt.disabled=!0,Zt.overrideTotalTime(s1.totalTime),void s.push(Zt);let Ut=o6;if(k1.size>1){let qa=Bt;const J0=[];for(;qa=qa.parentNode;){const ts=k1.get(qa);if(ts){Ut=ts;break}J0.push(qa)}J0.forEach(ts=>k1.set(ts,Ut))}const D4=this._buildAnimation(Zt.namespaceId,s1,zt,i,Io,es);if(Zt.setRealPlayer(D4),Ut===o6)Ni.push(Zt);else{const qa=this.playersByElement.get(Ut);qa&&qa.length&&(Zt.parentPlayer=h0(qa)),s.push(Zt)}}else mu(Bt,s1.fromStyles),Zt.onDestroy(()=>f4(Bt,s1.toStyles)),Zn.push(Zt),g.has(Bt)&&s.push(Zt)}),Zn.forEach(yt=>{const Bt=i.get(yt.element);if(Bt&&Bt.length){const Zt=h0(Bt);yt.setRealPlayer(Zt)}}),s.forEach(yt=>{yt.parentPlayer?yt.syncPlayerEvents(yt.parentPlayer):yt.destroy()});for(let yt=0;yt<Y.length;yt++){const Bt=Y[yt],Zt=Bt[gc];if(nf(Bt,Yy),Zt&&Zt.hasAnimation)continue;let s1=[];if(c.size){let D4=c.get(Bt);D4&&D4.length&&s1.push(...D4);let qa=this.driver.query(Bt,JN,!0);for(let J0=0;J0<qa.length;J0++){let ts=c.get(qa[J0]);ts&&ts.length&&s1.push(...ts)}}const Ut=s1.filter(D4=>!D4.destroyed);Ut.length?dde(this,Bt,Ut):this.processLeaveNode(Bt)}return Y.length=0,Ni.forEach(yt=>{this.players.push(yt),yt.onDone(()=>{yt.destroy();const Bt=this.players.indexOf(yt);this.players.splice(Bt,1)}),yt.play()}),Ni}elementContainsData(t,e){let r=!1;const s=e[gc];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==kp;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,g=h!==i,m=Oa(r,h,[]);this._getPreviousPlayers(h,g,o,c,e.toState).forEach(w=>{const I=w.getRealPlayer();I.beforeDestroy&&I.beforeDestroy(),w.destroy(),m.push(w)})}mu(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,h=[],g=new Set,m=new Set,C=e.timelines.map(I=>{const H=I.element;g.add(H);const Y=H[gc];if(Y&&Y.removedBeforeQueried)return new Np(I.duration,I.delay);const ee=H!==u,_e=function pde(n){const t=[];return Hj(n,t),t}((r.get(H)||ode).map(zt=>zt.getRealPlayer())).filter(zt=>!!zt.element&&zt.element===H),te=i.get(H),Ae=o.get(H),Fe=fj(0,this._normalizer,0,I.keyframes,te,Ae),Ze=this._buildPlayer(I,Fe,_e);if(I.subTimeline&&s&&m.add(H),ee){const zt=new dA(t,c,H);zt.setRealPlayer(Ze),h.push(zt)}return Ze});h.forEach(I=>{Oa(this.playersByQueriedElement,I.element,[]).push(I),I.onDone(()=>function ude(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,I.element,I))}),g.forEach(I=>mc(I,yj));const w=h0(C);return w.onDestroy(()=>{g.forEach(I=>nf(I,yj)),f4(u,e.toStyles)}),m.forEach(I=>{Oa(s,I,[]).push(w)}),w}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new Np(t.duration,t.delay)}}class dA{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new Np,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>qN(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Oa(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function cE(n){return n&&1===n.nodeType}function Dj(n,t){const e=n.style.display;return n.style.display=t??"none",e}function zj(n,t,e,r,s){const i=[];e.forEach(u=>i.push(Dj(u)));const o=[];r.forEach((u,h)=>{const g=new Map;u.forEach(m=>{const C=t.computeStyle(h,m,s);g.set(m,C),(!C||0==C.length)&&(h[gc]=ade,o.push(h))}),n.set(h,g)});let c=0;return e.forEach(u=>Dj(u,i[c++])),o}function Vj(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=e.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function mc(n,t){n.classList?.add(t)}function nf(n,t){n.classList?.remove(t)}function dde(n,t,e){h0(e).onDone(()=>n.processLeaveNode(t))}function Hj(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof lj?Hj(r.players,t):t.push(r)}}function Fj(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class lE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new lde(t,e,r),this._timelineEngine=new tde(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],g=rA(this._driver,i,u,[]);if(u.length)throw function J9e(n,t){return new Oe(3404,!1)}();c=function Xhe(n,t,e){return new Qhe(n,t,e)}(s,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=hj(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=hj(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let _de=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&f4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(f4(this._element,this._initialStyles),this._endStyles&&(f4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(mu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(mu(this._element,this._endStyles),this._endStyles=null),f4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function pA(n){let t=null;return n.forEach((e,r)=>{(function vde(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class Bj{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:wj(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Cde{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return mj(t,e)}getParentElement(t){return KN(t)}query(t,e,r){return _j(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,g=o.filter(w=>w instanceof Bj);(function She(n,t){return 0===n||0===t})(r,s)&&g.forEach(w=>{w.currentSnapshot.forEach((I,H)=>h.set(H,I))});let m=function Che(n){return n.length?n[0]instanceof Map?n:n.map(t=>Ej(t)):[]}(e).map(w=>d0(w));m=function Phe(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,wj(n,c)))}}return t}(t,m,h);const C=function mde(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=pA(t[0]),t.length>1&&(r=pA(t[t.length-1]))):t instanceof Map&&(e=pA(t)),e||r?new _de(n,e,r):null}(t,m);return new Bj(t,m,u,C)}}let yde=(()=>{class n extends ij{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:L1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?oj(e):e;return $j(this._renderer,null,r,"register",[s]),new Ede(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(Le($6),Le(Ds))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();class Ede extends class I9e{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Mde(this._id,t,e||{},this._renderer)}}class Mde{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return $j(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function $j(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const Uj="@.disabled";let Sde=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let g=this._rendererCache.get(i);return g||(g=new Gj("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,g)),g}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=g=>{Array.isArray(g)?g.forEach(u):this.engine.registerTrigger(o,c,e,g.name,g)};return r.data.animation.forEach(u),new Pde(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(Le($6),Le(lE),Le(Er))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();class Gj{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==Uj?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class Pde extends Gj{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==Uj?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function Tde(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function wde(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let bde=(()=>{class n extends lE{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds),Le(XN),Le(cA),Le(Kd))},n.\u0275prov=Je({token:n,factory:n.\u0275fac}),n})();const Wj=[{provide:ij,useClass:yde},{provide:cA,useFactory:function Ode(){return new jhe}},{provide:lE,useClass:bde},{provide:$6,useFactory:function Nde(n,t,e){return new Sde(n,t,e)},deps:[hy,lE,Er]}],gA=[{provide:XN,useFactory:()=>new Cde},{provide:oU,useValue:"BrowserAnimations"},...Wj],qj=[{provide:XN,useClass:vj},{provide:oU,useValue:"NoopAnimations"},...Wj];let Ade=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?qj:gA}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:gA,imports:[PG]}),n})();const Cs=void 0,xde=["fr",[["AM","PM"],Cs,Cs],Cs,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Cs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Cs,[["av. J.-C.","ap. J.-C."],Cs,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Cs],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Cs,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Cs,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Cs,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Cs,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Cs,"\xa5"],KMF:[Cs,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Cs,"$C"],NZD:["$NZ","$"],PHP:[Cs,"\u20b1"],RHD:["$RH"],RON:[Cs,"L"],RWF:[Cs,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Cs,"$T"],TTD:["$TT","$"],TWD:[Cs,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Cs,"$"],XPF:["FCFP"],ZMW:[Cs,"Kw"]},"ltr",function Ide(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function jj(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void e(h)}c.done?t(u):Promise.resolve(u).then(r,s)}function A(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){jj(i,r,s,o,c,"next",u)}function c(u){jj(i,r,s,o,c,"throw",u)}o(void 0)})}}const Zj=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},_A={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let C=(15&c)<<2|h>>6,w=63&h;u||(w=64,o||(C=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[C],e[w])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Zj(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},fE=function(n){return function(n){const t=Zj(n);return _A.encodeByteArray(t,!0)}(n).replace(/\./g,"")},hE=function(n){try{return _A.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function A2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function vA(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function vu(){return"object"==typeof indexedDB}function Lp(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function CA(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const yA=()=>{try{return function $de(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&hE(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},Kj=n=>{var t,e;return null===(e=null===(t=yA())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},Xj=n=>{var t;return null===(t=yA())||void 0===t?void 0:t[`_${n}`]};class dE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class _c extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,_c.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h4.prototype.create)}}class h4{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function Kde(n,t){return n.replace(Xde,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new _c(s,`${this.serviceName}: ${o} (${s}).`,r)}}const Xde=/\{\$([^}]+)}/g;function gE(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(Jj(i)&&Jj(o)){if(!gE(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function Jj(n){return null!==n&&"object"==typeof n}function Rp(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Dp(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function zp(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class epe{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function tpe(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=EA),void 0===s.error&&(s.error=EA),void 0===s.complete&&(s.complete=EA);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EA(){}function SA(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function Yr(n){return n&&n._delegate?n._delegate:n}class Fi{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Cu="[DEFAULT]";class ape{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new dE;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function lpe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Cu})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Cu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return A(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Cu){return this.instances.has(t)}getOptions(t=Cu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Cu?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=Cu){return this.component?this.component.multipleInstances?t:Cu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class upe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new ape(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const PA=[];var d1=(()=>{return(n=d1||(d1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",d1;var n})();const eZ={debug:d1.DEBUG,verbose:d1.VERBOSE,info:d1.INFO,warn:d1.WARN,error:d1.ERROR,silent:d1.SILENT},fpe=d1.INFO,hpe={[d1.DEBUG]:"log",[d1.VERBOSE]:"log",[d1.INFO]:"info",[d1.WARN]:"warn",[d1.ERROR]:"error"},dpe=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=hpe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class rf{constructor(t){this.name=t,this._logLevel=fpe,this._logHandler=dpe,this._userLogHandler=null,PA.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in d1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?eZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,d1.DEBUG,...t),this._logHandler(this,d1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,d1.VERBOSE,...t),this._logHandler(this,d1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,d1.INFO,...t),this._logHandler(this,d1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,d1.WARN,...t),this._logHandler(this,d1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,d1.ERROR,...t),this._logHandler(this,d1.ERROR,...t)}}let tZ,nZ;const rZ=new WeakMap,TA=new WeakMap,sZ=new WeakMap,wA=new WeakMap,bA=new WeakMap;let OA={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return TA.get(n);if("objectStoreNames"===t)return n.objectStoreNames||sZ.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return wl(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function Epe(n){return"function"==typeof n?function ype(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function mpe(){return nZ||(nZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(NA(this),t),wl(rZ.get(this))}:function(...t){return wl(n.apply(NA(this),t))}:function(t,...e){const r=n.call(NA(this),t,...e);return sZ.set(r,t.sort?t.sort():[t]),wl(r)}}(n):(n instanceof IDBTransaction&&function vpe(n){if(TA.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});TA.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function gpe(){return tZ||(tZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,OA):n)}function wl(n){if(n instanceof IDBRequest)return function _pe(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(wl(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&rZ.set(e,n)}).catch(()=>{}),bA.set(t,n),t}(n);if(wA.has(n))return wA.get(n);const t=Epe(n);return t!==n&&(wA.set(n,t),bA.set(t,n)),t}const NA=n=>bA.get(n);function mE(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=wl(o);return r&&o.addEventListener("upgradeneeded",u=>{r(wl(o.result),u.oldVersion,u.newVersion,wl(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function AA(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),wl(e).then(()=>{})}const Mpe=["get","getKey","getAll","getAllKeys","count"],Spe=["put","add","delete","clear"],IA=new Map;function iZ(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(IA.get(t))return IA.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=Spe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!Mpe.includes(e))return;const i=function(){var o=A(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(yield Promise.all([g[e](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return IA.set(t,i),i}!function Cpe(n){OA=n(OA)}(n=>({...n,get:(t,e,r)=>iZ(t,e)||n.get(t,e,r),has:(t,e)=>!!iZ(t,e)||n.has(t,e)}));class Ppe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Tpe(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const xA="@firebase/app",yu=new rf("@firebase/app"),_E="[DEFAULT]",Xpe={[xA]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Eu=new Map,vE=new Map;function Qpe(n,t){try{n.container.addComponent(t)}catch(e){yu.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function mo(n){const t=n.name;if(vE.has(t))return yu.debug(`There were multiple attempts to register component ${t}.`),!1;vE.set(t,n);for(const e of Eu.values())Qpe(e,n);return!0}function sf(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const bl=new h4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ege{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw bl.create("app-deleted",{appName:this._name})}}const af="9.14.0";function aZ(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:_E,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw bl.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=yA())||void 0===n?void 0:n.config})()),!e)throw bl.create("no-options");const i=Eu.get(s);if(i){if(gE(e,i.options)&&gE(r,i.config))return i;throw bl.create("duplicate-app",{appName:s})}const o=new upe(s);for(const u of vE.values())o.addComponent(u);const c=new ege(e,r,o);return Eu.set(s,c),c}function kA(n=_E){const t=Eu.get(n);if(!t&&n===_E)return aZ();if(!t)throw bl.create("no-app",{appName:n});return t}function cZ(){return Array.from(Eu.values())}function os(n,t,e){var r;let s=null!==(r=Xpe[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void yu.warn(c.join(" "))}mo(new Fi(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const Vp="firebase-heartbeat-store";let RA=null;function lZ(){return RA||(RA=mE("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(Vp)}}).catch(n=>{throw bl.create("idb-open",{originalErrorMessage:n.message})})),RA}function DA(){return(DA=A(function*(n){var t;try{return(yield lZ()).transaction(Vp).objectStore(Vp).get(fZ(n))}catch(e){if(e instanceof _c)yu.warn(e.message);else{const r=bl.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});yu.warn(r.message)}}})).apply(this,arguments)}function uZ(n,t){return zA.apply(this,arguments)}function zA(){return(zA=A(function*(n,t){var e;try{const s=(yield lZ()).transaction(Vp,"readwrite");return yield s.objectStore(Vp).put(t,fZ(n)),s.done}catch(r){if(r instanceof _c)yu.warn(r.message);else{const s=bl.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});yu.warn(s.message)}}})).apply(this,arguments)}function fZ(n){return`${n.name}!${n.options.appId}`}class oge{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new cge(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return A(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=hZ();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return A(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=hZ(),{heartbeatsToSend:r,unsentEntries:s}=function age(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),dZ(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),dZ(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=fE(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function hZ(){return(new Date).toISOString().substring(0,10)}class cge{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(function*(){return!!vu()&&Lp().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return A(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function rge(n){return DA.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return A(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return uZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return A(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return uZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function dZ(n){return fE(JSON.stringify({version:2,heartbeats:n})).length}!function lge(n){mo(new Fi("platform-logger",t=>new Ppe(t),"PRIVATE")),mo(new Fi("heartbeat",t=>new oge(t),"PRIVATE")),os(xA,"0.8.4",n),os(xA,"0.8.4","esm2017"),os("fire-js","")}("");var bt,uge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ol={},VA=VA||{},gn=uge||self;function CE(){}function yE(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function Hp(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var HA="closure_uid_"+(1e9*Math.random()>>>0),hge=0;function dge(n,t,e){return n.call.apply(n.bind,arguments)}function pge(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function Bi(n,t,e){return(Bi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?dge:pge).apply(null,arguments)}function EE(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function fi(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function p0(){this.s=this.s,this.o=this.o}p0.prototype.s=!1,p0.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function fge(n){Object.prototype.hasOwnProperty.call(n,HA)&&n[HA]||(n[HA]=++hge)}(this)},p0.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const pZ=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function FA(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function gZ(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(yE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function $i(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}$i.prototype.h=function(){this.defaultPrevented=!0};var mge=function(){if(!gn.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{gn.addEventListener("test",CE,t),gn.removeEventListener("test",CE,t)}catch{}return n}();function ME(n){return/^[\s\xa0]*$/.test(n)}var mZ=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function BA(n,t){return n<t?-1:n>t?1:0}function SE(){var n=gn.navigator;return n&&(n=n.userAgent)?n:""}function d4(n){return-1!=SE().indexOf(n)}function $A(n){return $A[" "](n),n}$A[" "]=CE;var PE,n,vge=d4("Opera"),cf=d4("Trident")||d4("MSIE"),_Z=d4("Edge"),UA=_Z||cf,vZ=d4("Gecko")&&!(-1!=SE().toLowerCase().indexOf("webkit")&&!d4("Edge"))&&!(d4("Trident")||d4("MSIE"))&&!d4("Edge"),Cge=-1!=SE().toLowerCase().indexOf("webkit")&&!d4("Edge");function CZ(){var n=gn.document;return n?n.documentMode:void 0}e:{var GA="",WA=(n=SE(),vZ?/rv:([^\);]+)(\)|;)/.exec(n):_Z?/Edge\/([\d\.]+)/.exec(n):cf?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Cge?/WebKit\/(\S+)/.exec(n):vge?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(WA&&(GA=WA?WA[1]:""),cf){var qA=CZ();if(null!=qA&&qA>parseFloat(GA)){PE=String(qA);break e}}PE=GA}var yge={};var Mge=gn.document&&cf&&(CZ()||parseInt(PE,10))||void 0;function Fp(n,t){if($i.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(vZ){e:{try{$A(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Sge[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Fp.X.h.call(this)}}fi(Fp,$i);var Sge={2:"touch",3:"pen",4:"mouse"};Fp.prototype.h=function(){Fp.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Bp="closure_listenable_"+(1e6*Math.random()|0),Pge=0;function Tge(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++Pge,this.ba=this.ea=!1}function TE(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function ZA(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function EZ(n){const t={};for(const e in n)t[e]=n[e];return t}const MZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function SZ(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<MZ.length;i++)e=MZ[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function wE(n){this.src=n,this.g={},this.h=0}function YA(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=pZ(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(TE(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function KA(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}wE.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=KA(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new Tge(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var XA="closure_lm_"+(1e6*Math.random()|0),QA={};function PZ(n,t,e,r,s){if(r&&r.once)return wZ(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)PZ(n,t[i],e,r,s);return null}return e=nI(e),n&&n[Bp]?n.N(t,e,Hp(r)?!!r.capture:!!r,s):TZ(n,t,e,!1,r,s)}function TZ(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=Hp(s)?!!s.capture:!!s,c=eI(n);if(c||(n[XA]=c=new wE(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function wge(){const t=bge;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)mge||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(OZ(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function wZ(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)wZ(n,t[i],e,r,s);return null}return e=nI(e),n&&n[Bp]?n.O(t,e,Hp(r)?!!r.capture:!!r,s):TZ(n,t,e,!0,r,s)}function bZ(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)bZ(n,t[i],e,r,s);else r=Hp(r)?!!r.capture:!!r,e=nI(e),n&&n[Bp]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=KA(i=n.g[t],e,r,s))&&(TE(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=eI(n))&&(t=n.g[t.toString()],n=-1,t&&(n=KA(t,e,r,s)),(e=-1<n?t[n]:null)&&JA(e))}function JA(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[Bp])YA(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(OZ(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=eI(t))?(YA(e,n),0==e.h&&(e.src=null,t[XA]=null)):TE(n)}}}function OZ(n){return n in QA?QA[n]:QA[n]="on"+n}function bge(n,t){if(n.ba)n=!0;else{t=new Fp(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&JA(n),n=e.call(r,t)}return n}function eI(n){return(n=n[XA])instanceof wE?n:null}var tI="__closure_events_fn_"+(1e9*Math.random()>>>0);function nI(n){return"function"==typeof n?n:(n[tI]||(n[tI]=function(t){return n.handleEvent(t)}),n[tI])}function I2(){p0.call(this),this.i=new wE(this),this.P=this,this.I=null}function hi(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new $i(t,n);else if(t instanceof $i)t.target=t.target||n;else{var s=t;SZ(t=new $i(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=bE(o,r,!0,t)&&s}if(s=bE(o=t.g=n,r,!0,t)&&s,s=bE(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=bE(o=t.g=e[i],r,!1,t)&&s}function bE(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&YA(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}fi(I2,p0),I2.prototype[Bp]=!0,I2.prototype.removeEventListener=function(n,t,e,r){bZ(this,n,t,e,r)},I2.prototype.M=function(){if(I2.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)TE(e[r]);delete n.g[t],n.h--}}this.I=null},I2.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},I2.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var rI=gn.JSON.stringify;function Oge(){var n=IZ;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var sI,NZ=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Age,n=>n.reset());class Age{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Ige(n){gn.setTimeout(()=>{throw n},0)}function AZ(n,t){sI||function xge(){var n=gn.Promise.resolve(void 0);sI=function(){n.then(kge)}}(),iI||(sI(),iI=!0),IZ.add(n,t)}var iI=!1,IZ=new class Nge{constructor(){this.h=this.g=null}add(t,e){const r=NZ.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function kge(){for(var n;n=Oge();){try{n.h.call(n.g)}catch(e){Ige(e)}var t=NZ;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}iI=!1}function OE(n,t){I2.call(this),this.h=n||1,this.g=t||gn,this.j=Bi(this.lb,this),this.l=Date.now()}function oI(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function aI(n,t,e){if("function"==typeof n)e&&(n=Bi(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Bi(n.handleEvent,n)}return 2147483647<Number(t)?-1:gn.setTimeout(n,t||0)}function xZ(n){n.g=aI(()=>{n.g=null,n.i&&(n.i=!1,xZ(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}fi(OE,I2),(bt=OE.prototype).ca=!1,bt.R=null,bt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),hi(this,"tick"),this.ca&&(oI(this),this.start()))}},bt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},bt.M=function(){OE.X.M.call(this),oI(this),delete this.g};class Lge extends p0{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:xZ(this)}M(){super.M(),this.g&&(gn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $p(n){p0.call(this),this.h=n,this.g={}}fi($p,p0);var kZ=[];function LZ(n,t,e,r){Array.isArray(e)||(e&&(kZ[0]=e.toString()),e=kZ);for(var s=0;s<e.length;s++){var i=PZ(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function RZ(n){ZA(n.g,function(t,e){this.g.hasOwnProperty(e)&&JA(t)},n),n.g={}}function NE(){this.g=!0}function lf(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function Vge(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return rI(e)}catch{return t}}(n,e)+(r?" "+r:"")})}$p.prototype.M=function(){$p.X.M.call(this),RZ(this)},$p.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},NE.prototype.Aa=function(){this.g=!1},NE.prototype.info=function(){};var Mu={},DZ=null;function AE(){return DZ=DZ||new I2}function zZ(n){$i.call(this,Mu.Pa,n)}function Up(n){const t=AE();hi(t,new zZ(t))}function VZ(n,t){$i.call(this,Mu.STAT_EVENT,n),this.stat=t}function _o(n){const t=AE();hi(t,new VZ(t,n))}function HZ(n,t){$i.call(this,Mu.Qa,n),this.size=t}function Gp(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return gn.setTimeout(function(){n()},t)}Mu.Pa="serverreachability",fi(zZ,$i),Mu.STAT_EVENT="statevent",fi(VZ,$i),Mu.Qa="timingevent",fi(HZ,$i);var IE={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},FZ={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function cI(){}function $Z(){}cI.prototype.h=null;var fI,Wp={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function lI(){$i.call(this,"d")}function uI(){$i.call(this,"c")}function xE(){}function qp(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new $p(this),this.O=Hge,this.T=new OE(n=UA?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new UZ}function UZ(){this.i=null,this.g="",this.h=!1}fi(lI,$i),fi(uI,$i),fi(xE,cI),xE.prototype.g=function(){return new XMLHttpRequest},xE.prototype.i=function(){return{}},fI=new xE;var Hge=45e3,hI={},kE={};function dI(n,t,e){n.K=1,n.v=zE(Nl(t)),n.s=e,n.P=!0,GZ(n,null)}function GZ(n,t){n.F=Date.now(),jp(n),n.A=Nl(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),eY(e.i,"t",r),n.C=0,e=n.l.H,n.h=new UZ,n.g=PY(n.l,e?t:null,!n.s),0<n.N&&(n.L=new Lge(Bi(n.La,n,n.g),n.N)),LZ(n.S,n.g,"readystatechange",n.ib),t=n.H?EZ(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),Up(),function Rge(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var g=h[0];h=h[1];var m=g.split("_");o=2<=m.length&&"type"==m[1]?o+(g+"=")+h+"&":o+(g+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function WZ(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function qZ(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=Fge(n,e),s==kE){4==t&&(n.o=4,_o(14),r=!1),lf(n.j,n.m,null,"[Incomplete Response]");break}if(s==hI){n.o=4,_o(15),lf(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}lf(n.j,n.m,s,null),pI(n,s)}WZ(n)&&s!=kE&&s!=hI&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,_o(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),MI(t),t.K=!0,_o(11))):(lf(n.j,n.m,e,"[Invalid Chunked Response]"),Su(n),Zp(n))}function Fge(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?kE:(e=Number(t.substring(e,r)),isNaN(e)?hI:(r+=1)+e>t.length?kE:(t=t.substr(r,e),n.C=r+e,t))}function jp(n){n.V=Date.now()+n.O,jZ(n,n.O)}function jZ(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Gp(Bi(n.gb,n),t)}function LE(n){n.B&&(gn.clearTimeout(n.B),n.B=null)}function Zp(n){0==n.l.G||n.I||yY(n.l,n)}function Su(n){LE(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,oI(n.T),RZ(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function pI(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||gI(e.h,n)))if(!n.J&&gI(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;UE(e),BE(e)}EI(e),_o(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=Gp(Bi(e.cb,e),6e3));if(1>=rY(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else Tu(e,11)}else if((n.J||e.g==n)&&UE(e),!ME(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let h=s[t];if(e.T=h[0],h=h[1],2==e.G)if("c"==h[0]){e.I=h[1],e.ka=h[2];const g=h[3];null!=g&&(e.ma=g,e.j.info("VER="+e.ma));const m=h[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const C=h[5];null!=C&&"number"==typeof C&&0<C&&(e.J=r=1.5*C,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const w=n.g;if(w){const I=w.g?w.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(I){var i=r.h;i.g||-1==I.indexOf("spdy")&&-1==I.indexOf("quic")&&-1==I.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(mI(i,i.h),i.h=null))}if(r.D){const H=w.g?w.g.getResponseHeader("X-HTTP-Session-Id"):null;H&&(r.za=H,Rr(r.F,r.D,H))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=SY(r,r.H?r.ka:null,r.V),o.J){sY(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(LE(c),jp(c)),r.g=o}else vY(r);0<e.i.length&&$E(e)}else"stop"!=h[0]&&"close"!=h[0]||Tu(e,7);else 3==e.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Tu(e,7):yI(e):"noop"!=h[0]&&e.l&&e.l.wa(h),e.A=0)}Up()}catch{}}function ZZ(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(yE(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function $ge(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(yE(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function Bge(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(yE(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(bt=qp.prototype).setTimeout=function(n){this.O=n},bt.ib=function(n){n=n.target;const t=this.L;t&&3==Al(n)?t.l():this.La(n)},bt.La=function(n){try{if(n==this.g)e:{const g=Al(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>g)&&(3!=g||UA||this.g&&(this.h.h||this.g.fa()||hY(this.g)))){this.I||4!=g||7==t||Up(),LE(this);var e=this.g.aa();this.Y=e;t:if(WZ(this)){var r=hY(this.g);n="";var s=r.length,i=4==Al(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Su(this),Zp(this);var o="";break t}this.h.i=new gn.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function Dge(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,g,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ME(c)){var h=c;break t}}h=null}if(!(e=h)){this.i=!1,this.o=3,_o(12),Su(this),Zp(this);break e}lf(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,pI(this,e)}this.P?(qZ(this,g,o),UA&&this.i&&3==g&&(LZ(this.S,this.T,"tick",this.hb),this.T.start())):(lf(this.j,this.m,o,null),pI(this,o)),4==g&&Su(this),this.i&&!this.I&&(4==g?yY(this.l,this):(this.i=!1,jp(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,_o(12)):(this.o=0,_o(13)),Su(this),Zp(this)}}}catch{}},bt.hb=function(){if(this.g){var n=Al(this.g),t=this.g.fa();this.C<t.length&&(LE(this),qZ(this,n,t),this.i&&4!=n&&jp(this))}},bt.cancel=function(){this.I=!0,Su(this)},bt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function zge(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(Up(),_o(17)),Su(this),this.o=2,Zp(this)):jZ(this,this.V-n)};var YZ=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pu(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Pu){this.h=void 0!==t?t:n.h,RE(this,n.j),this.s=n.s,this.g=n.g,DE(this,n.m),this.l=n.l,t=n.i;var e=new Xp;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),KZ(this,e),this.o=n.o}else n&&(e=String(n).match(YZ))?(this.h=!!t,RE(this,e[1]||"",!0),this.s=Yp(e[2]||""),this.g=Yp(e[3]||"",!0),DE(this,e[4]),this.l=Yp(e[5]||"",!0),KZ(this,e[6]||"",!0),this.o=Yp(e[7]||"")):(this.h=!!t,this.i=new Xp(null,this.h))}function Nl(n){return new Pu(n)}function RE(n,t,e){n.j=e?Yp(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function DE(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function KZ(n,t,e){t instanceof Xp?(n.i=t,function Yge(n,t){t&&!n.j&&(g0(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(QZ(this,r),eY(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=Kp(t,jge)),n.i=new Xp(t,n.h))}function Rr(n,t,e){n.i.set(t,e)}function zE(n){return Rr(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Yp(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Kp(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,Gge),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Gge(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Pu.prototype.toString=function(){var n=[],t=this.j;t&&n.push(Kp(t,XZ,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(Kp(t,XZ,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(Kp(e,"/"==e.charAt(0)?qge:Wge,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",Kp(e,Zge)),n.join("")};var XZ=/[#\/\?@]/g,Wge=/[#\?:]/g,qge=/[#\?]/g,jge=/[#\?@]/g,Zge=/#/g;function Xp(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function g0(n){n.g||(n.g=new Map,n.h=0,n.i&&function Uge(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function QZ(n,t){g0(n),t=uf(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function JZ(n,t){return g0(n),t=uf(n,t),n.g.has(t)}function eY(n,t,e){QZ(n,t),0<e.length&&(n.i=null,n.g.set(uf(n,t),FA(e)),n.h+=e.length)}function uf(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function tY(n){this.l=n||Xge,n=gn.PerformanceNavigationTiming?0<(n=gn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(gn.g&&gn.g.Ga&&gn.g.Ga()&&gn.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(bt=Xp.prototype).add=function(n,t){g0(this),this.i=null,n=uf(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},bt.forEach=function(n,t){g0(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},bt.oa=function(){g0(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},bt.W=function(n){g0(this);let t=[];if("string"==typeof n)JZ(this,n)&&(t=t.concat(this.g.get(uf(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},bt.set=function(n,t){return g0(this),this.i=null,JZ(this,n=uf(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},bt.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},bt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var Xge=10;function nY(n){return!!n.h||!!n.g&&n.g.size>=n.j}function rY(n){return n.h?1:n.g?n.g.size:0}function gI(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function mI(n,t){n.g?n.g.add(t):n.h=t}function sY(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function iY(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return FA(n.i)}function _I(){}function Qge(){this.g=new _I}function Jge(n,t,e){const r=e||"";try{ZZ(n,function(s,i){let o=s;Hp(s)&&(o=rI(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function VE(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function Qp(n){this.l=n.ac||null,this.j=n.jb||!1}function HE(n,t){I2.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=vI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tY.prototype.cancel=function(){if(this.i=iY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},_I.prototype.stringify=function(n){return gn.JSON.stringify(n,void 0)},_I.prototype.parse=function(n){return gn.JSON.parse(n,void 0)},fi(Qp,cI),Qp.prototype.g=function(){return new HE(this.l,this.j)},Qp.prototype.i=function(n){return function(){return n}}({}),fi(HE,I2);var vI=0;function oY(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Jp(n){n.readyState=4,n.l=null,n.j=null,n.A=null,eg(n)}function eg(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(bt=HE.prototype).open=function(n,t){if(this.readyState!=vI)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,eg(this)},bt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||gn).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},bt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Jp(this)),this.readyState=vI},bt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,eg(this)),this.g&&(this.readyState=3,eg(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof gn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;oY(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},bt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?Jp(this):eg(this),3==this.readyState&&oY(this)}},bt.Va=function(n){this.g&&(this.response=this.responseText=n,Jp(this))},bt.Ua=function(n){this.g&&(this.response=n,Jp(this))},bt.ga=function(){this.g&&Jp(this)},bt.setRequestHeader=function(n,t){this.v.append(n,t)},bt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},bt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(HE.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var tme=gn.JSON.parse;function as(n){I2.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=aY,this.K=this.L=!1}fi(as,I2);var aY="",nme=/^https?$/i,rme=["POST","PUT"];function cY(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,lY(n),FE(n)}function lY(n){n.D||(n.D=!0,hi(n,"complete"),hi(n,"error"))}function uY(n){if(n.h&&typeof VA<"u"&&(!n.C[1]||4!=Al(n)||2!=n.aa()))if(n.v&&4==Al(n))aI(n.Ha,0,n);else if(hi(n,"readystatechange"),4==Al(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(YZ)[1]||null;if(!s&&gn.self&&gn.self.location){var i=gn.self.location.protocol;s=i.substr(0,i.length-1)}r=!nme.test(s?s.toLowerCase():"")}e=r}if(e)hi(n,"complete"),hi(n,"success");else{n.m=6;try{var o=2<Al(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",lY(n)}}finally{FE(n)}}}function FE(n,t){if(n.g){fY(n);const e=n.g,r=n.C[0]?CE:null;n.g=null,n.C=null,t||hi(n,"ready");try{e.onreadystatechange=r}catch{}}}function fY(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(gn.clearTimeout(n.A),n.A=null)}function Al(n){return n.g?n.g.readyState:0}function hY(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case aY:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function dY(n){let t="";return ZA(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function CI(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=dY(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Rr(n,t,e))}function tg(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function pY(n){this.Ca=0,this.i=[],this.j=new NE,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=tg("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=tg("baseRetryDelayMs",5e3,n),this.bb=tg("retryDelaySeedMs",1e4,n),this.$a=tg("forwardChannelMaxRetries",2,n),this.ta=tg("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new tY(n&&n.concurrentRequestLimit),this.Fa=new Qge,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function yI(n){if(gY(n),3==n.G){var t=n.U++,e=Nl(n.F);Rr(e,"SID",n.I),Rr(e,"RID",t),Rr(e,"TYPE","terminate"),ng(n,e),(t=new qp(n,n.j,t,void 0)).K=2,t.v=zE(Nl(e)),e=!1,gn.navigator&&gn.navigator.sendBeacon&&(e=gn.navigator.sendBeacon(t.v.toString(),"")),!e&&gn.Image&&((new Image).src=t.v,e=!0),e||(t.g=PY(t.l,null),t.g.da(t.v)),t.F=Date.now(),jp(t)}MY(n)}function BE(n){n.g&&(MI(n),n.g.cancel(),n.g=null)}function gY(n){BE(n),n.u&&(gn.clearTimeout(n.u),n.u=null),UE(n),n.h.cancel(),n.m&&("number"==typeof n.m&&gn.clearTimeout(n.m),n.m=null)}function $E(n){nY(n.h)||n.m||(n.m=!0,AZ(n.Ja,n),n.C=0)}function mY(n,t){var e;e=t?t.m:n.U++;const r=Nl(n.F);Rr(r,"SID",n.I),Rr(r,"RID",e),Rr(r,"AID",n.T),ng(n,r),n.o&&n.s&&CI(r,n.o,n.s),e=new qp(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=_Y(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),mI(n.h,e),dI(e,r,t)}function ng(n,t){n.ia&&ZA(n.ia,function(e,r){Rr(t,r,e)}),n.l&&ZZ({},function(e,r){Rr(t,r,e)})}function _Y(n,t,e){e=Math.min(n.i.length,e);var r=n.l?Bi(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let h=s[u].h;const g=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{Jge(g,o,"req"+h+"_")}catch{r&&r(g)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function vY(n){n.g||n.u||(n.Z=1,AZ(n.Ia,n),n.A=0)}function EI(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Gp(Bi(n.Ia,n),EY(n,n.A)),n.A++,0))}function MI(n){null!=n.B&&(gn.clearTimeout(n.B),n.B=null)}function CY(n){n.g=new qp(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=Nl(n.sa);Rr(t,"RID","rpc"),Rr(t,"SID",n.I),Rr(t,"CI",n.L?"0":"1"),Rr(t,"AID",n.T),Rr(t,"TYPE","xmlhttp"),ng(n,t),n.o&&n.s&&CI(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=zE(Nl(t)),e.s=null,e.P=!0,GZ(e,n)}function UE(n){null!=n.v&&(gn.clearTimeout(n.v),n.v=null)}function yY(n,t){var e=null;if(n.g==t){UE(n),MI(n),n.g=null;var r=2}else{if(!gI(n.h,t))return;e=t.D,sY(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;hi(r=AE(),new HZ(r,e)),$E(n)}else vY(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function ime(n,t){return!(rY(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Gp(Bi(n.Ja,n,t),EY(n,n.C)),n.C++,0)))}(n,t)||2==r&&EI(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:Tu(n,5);break;case 4:Tu(n,10);break;case 3:Tu(n,6);break;default:Tu(n,2)}}function EY(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function Tu(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=Bi(n.kb,n);e||(e=new Pu("//www.google.com/images/cleardot.gif"),gn.location&&"http"==gn.location.protocol||RE(e,"https"),zE(e)),function eme(n,t){const e=new NE;if(gn.Image){const r=new Image;r.onload=EE(VE,e,r,"TestLoadImage: loaded",!0,t),r.onerror=EE(VE,e,r,"TestLoadImage: error",!1,t),r.onabort=EE(VE,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=EE(VE,e,r,"TestLoadImage: timeout",!1,t),gn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else _o(2);n.G=0,n.l&&n.l.va(t),MY(n),gY(n)}function MY(n){if(n.G=0,n.la=[],n.l){const t=iY(n.h);(0!=t.length||0!=n.i.length)&&(gZ(n.la,t),gZ(n.la,n.i),n.h.i.length=0,FA(n.i),n.i.length=0),n.l.ua()}}function SY(n,t,e){var r=e instanceof Pu?Nl(e):new Pu(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),DE(r,r.m);else{var s=gn.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Pu(null,void 0);r&&RE(i,r),t&&(i.g=t),s&&DE(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Rr(r,e,t),Rr(r,"VER",n.ma),ng(n,r),r}function PY(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new as(e&&n.Da&&!n.ra?new Qp({jb:!0}):n.ra)).Ka(n.H),t}function TY(){}function GE(){if(cf&&!(10<=Number(Mge)))throw Error("Environmental error: no available transport.")}function Aa(n,t){I2.call(this),this.g=new pY(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!ME(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!ME(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new ff(this)}function wY(n){lI.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function bY(){uI.call(this),this.status=1}function ff(n){this.g=n}(bt=as.prototype).Ka=function(n){this.L=n},bt.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():fI.g(),this.C=function BZ(n){return n.h||(n.h=n.i())}(this.u?this.u:fI),this.g.onreadystatechange=Bi(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void cY(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=gn.FormData&&n instanceof gn.FormData,!(0<=pZ(rme,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{fY(this),0<this.B&&((this.K=function sme(n){return cf&&function Ege(){return function _ge(n){var t=yge;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=mZ(String(PE)).split("."),e=mZ("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=BA(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||BA(0==s[2].length,0==i[2].length)||BA(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Bi(this.qa,this)):this.A=aI(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){cY(this,i)}},bt.qa=function(){typeof VA<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,hi(this,"timeout"),this.abort(8))},bt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,hi(this,"complete"),hi(this,"abort"),FE(this))},bt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),FE(this,!0)),as.X.M.call(this)},bt.Ha=function(){this.s||(this.F||this.v||this.l?uY(this):this.fb())},bt.fb=function(){uY(this)},bt.aa=function(){try{return 2<Al(this)?this.g.status:-1}catch{return-1}},bt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},bt.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),tme(t)}},bt.Ea=function(){return this.m},bt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(bt=pY.prototype).ma=8,bt.G=1,bt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new qp(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=EZ(i),SZ(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=_Y(this,s,t),Rr(e=Nl(this.F),"RID",n),Rr(e,"CVER",22),this.D&&Rr(e,"X-HTTP-Session-Id",this.D),ng(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(dY(i)))+"&"+t:this.o&&CI(e,this.o,i)),mI(this.h,s),this.Ya&&Rr(e,"TYPE","init"),this.O?(Rr(e,"$req",t),Rr(e,"SID","null"),s.Z=!0,dI(s,e,null)):dI(s,e,t),this.G=2}}else 3==this.G&&(n?mY(this,n):0==this.i.length||nY(this.h)||mY(this))},bt.Ia=function(){if(this.u=null,CY(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Gp(Bi(this.eb,this),n)}},bt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,_o(10),BE(this),CY(this))},bt.cb=function(){null!=this.v&&(this.v=null,BE(this),EI(this),_o(19))},bt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),_o(2)):(this.j.info("Failed to ping google.com"),_o(1))},(bt=TY.prototype).xa=function(){},bt.wa=function(){},bt.va=function(){},bt.ua=function(){},bt.Ra=function(){},GE.prototype.g=function(n,t){return new Aa(n,t)},fi(Aa,I2),Aa.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;_o(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=SY(n,null,n.V),$E(n)},Aa.prototype.close=function(){yI(this.g)},Aa.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=rI(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&$E(t)},Aa.prototype.M=function(){this.g.l=null,delete this.j,yI(this.g),delete this.g,Aa.X.M.call(this)},fi(wY,lI),fi(bY,uI),fi(ff,TY),ff.prototype.xa=function(){hi(this.g,"a")},ff.prototype.wa=function(n){hi(this.g,new wY(n))},ff.prototype.va=function(n){hi(this.g,new bY)},ff.prototype.ua=function(){hi(this.g,"b")},GE.prototype.createWebChannel=GE.prototype.g,Aa.prototype.send=Aa.prototype.u,Aa.prototype.open=Aa.prototype.m,Aa.prototype.close=Aa.prototype.close,IE.NO_ERROR=0,IE.TIMEOUT=8,IE.HTTP_ERROR=6,FZ.COMPLETE="complete",$Z.EventType=Wp,Wp.OPEN="a",Wp.CLOSE="b",Wp.ERROR="c",Wp.MESSAGE="d",I2.prototype.listen=I2.prototype.N,as.prototype.listenOnce=as.prototype.O,as.prototype.getLastError=as.prototype.Oa,as.prototype.getLastErrorCode=as.prototype.Ea,as.prototype.getStatus=as.prototype.aa,as.prototype.getResponseJson=as.prototype.Sa,as.prototype.getResponseText=as.prototype.fa,as.prototype.send=as.prototype.da,as.prototype.setWithCredentials=as.prototype.Ka;var ome=Ol.createWebChannelTransport=function(){return new GE},ame=Ol.getStatEventTarget=function(){return AE()},SI=Ol.ErrorCode=IE,cme=Ol.EventType=FZ,lme=Ol.Event=Mu,OY=Ol.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},ume=Ol.FetchXmlHttpFactory=Qp,WE=Ol.WebChannel=$Z,fme=Ol.XhrIo=as;const NY="@firebase/firestore";class x2{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}x2.UNAUTHENTICATED=new x2(null),x2.GOOGLE_CREDENTIALS=new x2("google-credentials-uid"),x2.FIRST_PARTY=new x2("first-party-uid"),x2.MOCK_USER=new x2("mock-user");let hf="9.14.0";const m0=new rf("@firebase/firestore");function PI(){return m0.logLevel}function $e(n,...t){if(m0.logLevel<=d1.DEBUG){const e=t.map(TI);m0.debug(`Firestore (${hf}): ${n}`,...e)}}function ys(n,...t){if(m0.logLevel<=d1.ERROR){const e=t.map(TI);m0.error(`Firestore (${hf}): ${n}`,...e)}}function df(n,...t){if(m0.logLevel<=d1.WARN){const e=t.map(TI);m0.warn(`Firestore (${hf}): ${n}`,...e)}}function TI(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Pt(n="Unexpected state"){const t=`FIRESTORE (${hf}) INTERNAL ASSERTION FAILED: `+n;throw ys(t),new Error(t)}function en(n,t){n||Pt()}function at(n,t){return n}const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends _c{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class c2{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class AY{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class hme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(x2.UNAUTHENTICATED))}shutdown(){}}class dme{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class pme{constructor(t){this.t=t,this.currentUser=x2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let o=new c2;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new c2,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;t.enqueueRetryable(A(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{$e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):($e("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new c2)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?($e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(en("string"==typeof r.accessToken),new AY(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return en(null===t||"string"==typeof t),new x2(t)}}class gme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=x2.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(en(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class mme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new gme(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(x2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class IY{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _me{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&$e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,$e("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{$e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):$e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(en("string"==typeof e.token),this.A=e.token,new IY(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function vme(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class xY{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=vme(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function mn(n,t){return n<t?-1:n>t?1:0}function pf(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class Kr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new He(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new He(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new He(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new He(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Kr.fromMillis(Date.now())}static fromDate(t){return Kr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new Kr(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?mn(this.nanoseconds,t.nanoseconds):mn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class tn{constructor(t){this.timestamp=t}static fromTimestamp(t){return new tn(t)}static min(){return new tn(new Kr(0,0))}static max(){return new tn(new Kr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class rg{constructor(t,e,r){void 0===e?e=0:e>t.length&&Pt(),void 0===r?r=t.length-e:r>t.length-e&&Pt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===rg.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof rg?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class p1 extends rg{construct(t,e,r){return new p1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new He(Pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new p1(e)}static emptyPath(){return new p1([])}}const Cme=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Es extends rg{construct(t,e,r){return new Es(t,e,r)}static isValidIdentifier(t){return Cme.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Es.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Es(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new He(Pe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new He(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new He(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new He(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Es(e)}static emptyPath(){return new Es([])}}class rt{constructor(t){this.path=t}static fromPath(t){return new rt(p1.fromString(t))}static fromName(t){return new rt(p1.fromString(t).popFirst(5))}static empty(){return new rt(p1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===p1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return p1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new rt(new p1(t.slice()))}}function RY(n){return new Ia(n.readTime,n.key,-1)}class Ia{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Ia(tn.min(),rt.empty(),-1)}static max(){return new Ia(tn.max(),rt.empty(),-1)}}function bI(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=rt.comparator(n.documentKey,t.documentKey),0!==e?e:mn(n.largestBatchId,t.largestBatchId))}const DY="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function _0(n){return OI.apply(this,arguments)}function OI(){return OI=A(function*(n){if(n.code!==Pe.FAILED_PRECONDITION||n.message!==DY)throw n;$e("LocalStore","Unexpectedly lost primary lease")}),OI.apply(this,arguments)}class Ce{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Pt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Ce((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Ce?e:Ce.resolve(e)}catch(e){return Ce.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Ce.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Ce.reject(e)}static resolve(t){return new Ce((e,r)=>{e(t)})}static reject(t){return new Ce((e,r)=>{r(t)})}static waitFor(t){return new Ce((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=Ce.resolve(!1);for(const r of t)e=e.next(s=>s?Ce.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new Ce((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;e(t[h]).next(g=>{o[h]=g,++c,c===i&&r(o)},g=>s(g))}})}static doWhile(t,e){return new Ce((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function v0(n){return"IndexedDbTransactionError"===n.name}class Qo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function VY(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Ou(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function HY(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}Qo.at=-1;class cs{constructor(t,e){this.comparator=t,this.root=e||di.EMPTY}insert(t,e){return new cs(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,di.BLACK,null,null))}remove(t){return new cs(this.comparator,this.root.remove(t,this.comparator).copy(null,null,di.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new YE(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new YE(this.root,t,this.comparator,!1)}getReverseIterator(){return new YE(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new YE(this.root,t,this.comparator,!0)}}class YE{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class di{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??di.RED,this.left=s??di.EMPTY,this.right=i??di.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new di(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return di.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return di.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,di.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,di.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Pt();const t=this.left.check();if(t!==this.right.check())throw Pt();return t+(this.isRed()?0:1)}}di.EMPTY=null,di.RED=!0,di.BLACK=!1,di.EMPTY=new class{constructor(){this.size=0}get key(){throw Pt()}get value(){throw Pt()}get color(){throw Pt()}get left(){throw Pt()}get right(){throw Pt()}copy(n,t,e,r,s){return this}insert(n,t,e){return new di(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class er{constructor(t){this.comparator=t,this.data=new cs(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new FY(this.data.getIterator())}getIteratorFrom(t){return new FY(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof er)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new er(this.comparator);return e.data=t,e}}class FY{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class xa{constructor(t){this.fields=t,t.sort(Es.comparator)}static empty(){return new xa([])}unionWith(t){let e=new er(Es.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new xa(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return pf(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class l2{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new l2(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new l2(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return mn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}l2.EMPTY_BYTE_STRING=new l2("");const bme=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function C0(n){if(en(!!n),"string"==typeof n){let t=0;const e=bme.exec(n);if(en(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ls(n.seconds),nanos:ls(n.nanos)}}function ls(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Nu(n){return"string"==typeof n?l2.fromBase64String(n):l2.fromUint8Array(n)}function AI(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function BY(n){const t=n.mapValue.fields.__previous_value__;return AI(t)?BY(t):t}function og(n){const t=C0(n.mapValue.fields.__local_write_time__.timestampValue);return new Kr(t.seconds,t.nanos)}class Ome{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class Au{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Au("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Au&&t.projectId===this.projectId&&t.database===this.database}}function ag(n){return null==n}function cg(n){return 0===n&&1/n==-1/0}const y0_mapValue={fields:{__type__:{stringValue:"__max__"}}};function Iu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?AI(n)?4:qY(n)?9007199254740991:10:Pt()}function p4(n,t){if(n===t)return!0;const e=Iu(n);if(e!==Iu(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return og(n).isEqual(og(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=C0(r.timestampValue),o=C0(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,Nu(n.bytesValue).isEqual(Nu(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return ls(r.geoPointValue.latitude)===ls(s.geoPointValue.latitude)&&ls(r.geoPointValue.longitude)===ls(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ls(r.integerValue)===ls(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=ls(r.doubleValue),o=ls(s.doubleValue);return i===o?cg(i)===cg(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return pf(n.arrayValue.values||[],t.arrayValue.values||[],p4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(VY(i)!==VY(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!p4(i[c],o[c])))return!1;return!0}(n,t);default:return Pt()}var s}function lg(n,t){return void 0!==(n.values||[]).find(e=>p4(e,t))}function E0(n,t){if(n===t)return 0;const e=Iu(n),r=Iu(t);if(e!==r)return mn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return mn(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=ls(s.integerValue||s.doubleValue),c=ls(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return UY(n.timestampValue,t.timestampValue);case 4:return UY(og(n),og(t));case 5:return mn(n.stringValue,t.stringValue);case 6:return function(s,i){const o=Nu(s),c=Nu(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=mn(o[u],c[u]);if(0!==h)return h}return mn(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=mn(ls(s.latitude),ls(i.latitude));return 0!==o?o:mn(ls(s.longitude),ls(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=E0(o[u],c[u]);if(h)return h}return mn(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===y0_mapValue&&i===y0_mapValue)return 0;if(s===y0_mapValue)return 1;if(i===y0_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let g=0;g<c.length&&g<h.length;++g){const m=mn(c[g],h[g]);if(0!==m)return m;const C=E0(o[c[g]],u[h[g]]);if(0!==C)return C}return mn(c.length,h.length)}(n.mapValue,t.mapValue);default:throw Pt()}}function UY(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return mn(n,t);const e=C0(n),r=C0(t),s=mn(e.seconds,r.seconds);return 0!==s?s:mn(e.nanos,r.nanos)}function mf(n){return II(n)}function II(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=C0(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Nu(n.bytesValue).toBase64():"referenceValue"in n?rt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=II(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${II(r.fields[c])}`;return i+"}"}(n.mapValue):Pt();var t}function xu(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function xI(n){return!!n&&"integerValue"in n}function ug(n){return!!n&&"arrayValue"in n}function GY(n){return!!n&&"nullValue"in n}function WY(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function XE(n){return!!n&&"mapValue"in n}function fg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Ou(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=fg(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=fg(n.arrayValue.values[e]);return t}return Object.assign({},n)}function qY(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class pi{constructor(t){this.value=t}static empty(){return new pi({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!XE(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=fg(e)}setAll(t){let e=Es.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=fg(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());XE(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return p4(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];XE(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){Ou(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new pi(fg(this.value))}}function YY(n){const t=[];return Ou(n.fields,(e,r)=>{const s=new Es([e]);if(XE(r)){const i=YY(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new xa(t)}class gr{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new gr(t,0,tn.min(),tn.min(),pi.empty(),0)}static newFoundDocument(t,e,r){return new gr(t,1,e,tn.min(),r,0)}static newNoDocument(t,e){return new gr(t,2,e,tn.min(),pi.empty(),0)}static newUnknownDocument(t,e){return new gr(t,3,e,tn.min(),pi.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=pi.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=pi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tn.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof gr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new gr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ime{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function KY(n,t=null,e=[],r=[],s=null,i=null,o=null){return new Ime(n,t,e,r,s,i,o)}function ku(n){const t=at(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+mf(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),ag(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>mf(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>mf(r)).join(",")),t.ht=e}return t.ht}function hg(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!Fme(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!p4(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!tK(n.startAt,t.startAt)&&tK(n.endAt,t.endAt)}function QE(n){return rt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class gi extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new kme(t,e,r):"array-contains"===e?new Dme(t,r):"in"===e?new zme(t,r):"not-in"===e?new Vme(t,r):"array-contains-any"===e?new Hme(t,r):new gi(t,e,r)}static lt(t,e,r){return"in"===e?new Lme(t,r):new Rme(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(E0(e,this.value)):null!==e&&Iu(this.value)===Iu(e)&&this.ft(E0(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Pt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class kme extends gi{constructor(t,e,r){super(t,e,r),this.key=rt.fromName(r.referenceValue)}matches(t){const e=rt.comparator(t.key,this.key);return this.ft(e)}}class Lme extends gi{constructor(t,e){super(t,"in",e),this.keys=JY(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Rme extends gi{constructor(t,e){super(t,"not-in",e),this.keys=JY(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function JY(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>rt.fromName(r.referenceValue))}class Dme extends gi{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ug(e)&&lg(e.arrayValue,this.value)}}class zme extends gi{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&lg(this.value.arrayValue,e)}}class Vme extends gi{constructor(t,e){super(t,"not-in",e)}matches(t){if(lg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!lg(this.value.arrayValue,e)}}class Hme extends gi{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ug(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>lg(this.value.arrayValue,r))}}class M0{constructor(t,e){this.position=t,this.inclusive=e}}class _f{constructor(t,e="asc"){this.field=t,this.dir=e}}function Fme(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function eK(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?rt.comparator(rt.fromName(o.referenceValue),e.key):E0(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function tK(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!p4(n.position[e],t.position[e]))return!1;return!0}class Il{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function vf(n){return new Il(n)}function rK(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function kI(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function LI(n){for(const t of n.filters)if(t.dt())return t.field;return null}function RI(n){return null!==n.collectionGroup}function Cf(n){const t=at(n);if(null===t._t){t._t=[];const e=LI(t),r=kI(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new _f(e)),t._t.push(new _f(Es.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new _f(Es.keyField(),i))}}}return t._t}function vo(n){const t=at(n);if(!t.wt)if("F"===t.limitType)t.wt=KY(t.path,t.collectionGroup,Cf(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of Cf(t))e.push(new _f(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new M0(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new M0(t.startAt.position,t.startAt.inclusive):null;t.wt=KY(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function eM(n,t,e){return new Il(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function dg(n,t){return hg(vo(n),vo(t))&&n.limitType===t.limitType}function sK(n){return`${ku(vo(n))}|lt:${n.limitType}`}function DI(n){return`Query(target=${function xme(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${mf(r.value)}`;var r}).join(", ")}]`),ag(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>mf(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>mf(e)).join(",")),`Target(${t})`}(vo(n))}; limitType=${n.limitType})`}function zI(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):rt.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=eK(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,Cf(e),r)||e.endAt&&!function(s,i,o){const c=eK(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,Cf(e),r)));var e,r}function oK(n){return(t,e)=>{let r=!1;for(const s of Cf(n)){const i=Bme(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function Bme(n,t,e){const r=n.field.isKeyField()?rt.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?E0(c,u):Pt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Pt()}}function aK(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cg(t)?"-0":t}}function cK(n){return{integerValue:""+n}}function lK(n,t){return function $Y(n){return"number"==typeof n&&Number.isInteger(n)&&!cg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?cK(t):aK(n,t)}class tM{constructor(){this._=void 0}}function $me(n,t,e){return n instanceof yf?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof Lu?fK(n,t):n instanceof Ru?hK(n,t):function(r,s){const i=uK(r,s),o=dK(i)+dK(r.yt);return xI(i)&&xI(r.yt)?cK(o):aK(r.It,o)}(n,t)}function Ume(n,t,e){return n instanceof Lu?fK(n,t):n instanceof Ru?hK(n,t):e}function uK(n,t){return n instanceof Ef?xI(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class yf extends tM{}class Lu extends tM{constructor(t){super(),this.elements=t}}function fK(n,t){const e=pK(t);for(const r of n.elements)e.some(s=>p4(s,r))||e.push(r);return{arrayValue:{values:e}}}class Ru extends tM{constructor(t){super(),this.elements=t}}function hK(n,t){let e=pK(t);for(const r of n.elements)e=e.filter(s=>!p4(s,r));return{arrayValue:{values:e}}}class Ef extends tM{constructor(t,e){super(),this.It=t,this.yt=e}}function dK(n){return ls(n.integerValue||n.doubleValue)}function pK(n){return ug(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class pg{constructor(t,e){this.field=t,this.transform=e}}class Wme{constructor(t,e){this.version=t,this.transformResults=e}}class Dr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Dr}static exists(t){return new Dr(void 0,t)}static updateTime(t){return new Dr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function nM(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class rM{}function gK(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new Sf(n.key,Dr.none()):new Mf(n.key,n.data,Dr.none());{const e=n.data,r=pi.empty();let s=new er(Es.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new xl(n.key,r,new xa(s.toArray()),Dr.none())}}function qme(n,t,e){n instanceof Mf?function(r,s,i){const o=r.value.clone(),c=vK(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof xl?function(r,s,i){if(!nM(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=vK(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(_K(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function gg(n,t,e,r){return n instanceof Mf?function(s,i,o,c){if(!nM(s.precondition,i))return o;const u=s.value.clone(),h=CK(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof xl?function(s,i,o,c){if(!nM(s.precondition,i))return o;const u=CK(s.fieldTransforms,c,i),h=i.data;return h.setAll(_K(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,t,e,r):(o=e,nM(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function jme(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=uK(r.transform,s||null);null!=i&&(null===e&&(e=pi.empty()),e.set(r.field,i))}return e||null}function mK(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&pf(e,r,(s,i)=>function Gme(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof Lu&&r instanceof Lu||e instanceof Ru&&r instanceof Ru?pf(e.elements,r.elements,p4):e instanceof Ef&&r instanceof Ef?p4(e.yt,r.yt):e instanceof yf&&r instanceof yf);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class Mf extends rM{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class xl extends rM{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _K(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function vK(n,t,e){const r=new Map;en(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,Ume(o,c,e[s]))}return r}function CK(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,$me(i,o,t))}return r}class Sf extends rM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class VI extends rM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Zme{constructor(t){this.count=t}}var Fs,g1;function yK(n){switch(n){default:return Pt();case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0}}function EK(n){if(void 0===n)return ys("GRPC error has no .code"),Pe.UNKNOWN;switch(n){case Fs.OK:return Pe.OK;case Fs.CANCELLED:return Pe.CANCELLED;case Fs.UNKNOWN:return Pe.UNKNOWN;case Fs.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case Fs.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case Fs.INTERNAL:return Pe.INTERNAL;case Fs.UNAVAILABLE:return Pe.UNAVAILABLE;case Fs.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case Fs.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case Fs.NOT_FOUND:return Pe.NOT_FOUND;case Fs.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case Fs.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case Fs.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case Fs.ABORTED:return Pe.ABORTED;case Fs.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case Fs.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case Fs.DATA_LOSS:return Pe.DATA_LOSS;default:return Pt()}}(g1=Fs||(Fs={}))[g1.OK=0]="OK",g1[g1.CANCELLED=1]="CANCELLED",g1[g1.UNKNOWN=2]="UNKNOWN",g1[g1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",g1[g1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",g1[g1.NOT_FOUND=5]="NOT_FOUND",g1[g1.ALREADY_EXISTS=6]="ALREADY_EXISTS",g1[g1.PERMISSION_DENIED=7]="PERMISSION_DENIED",g1[g1.UNAUTHENTICATED=16]="UNAUTHENTICATED",g1[g1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",g1[g1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",g1[g1.ABORTED=10]="ABORTED",g1[g1.OUT_OF_RANGE=11]="OUT_OF_RANGE",g1[g1.UNIMPLEMENTED=12]="UNIMPLEMENTED",g1[g1.INTERNAL=13]="INTERNAL",g1[g1.UNAVAILABLE=14]="UNAVAILABLE",g1[g1.DATA_LOSS=15]="DATA_LOSS";class S0{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Ou(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return HY(this.inner)}size(){return this.innerSize}}const Yme=new cs(rt.comparator);function Jo(){return Yme}const MK=new cs(rt.comparator);function mg(...n){let t=MK;for(const e of n)t=t.insert(e.key,e);return t}function SK(n){let t=MK;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function g4(){return _g()}function PK(){return _g()}function _g(){return new S0(n=>n.toString(),(n,t)=>n.isEqual(t))}const Kme=new cs(rt.comparator),Xme=new er(rt.comparator);function On(...n){let t=Xme;for(const e of n)t=t.add(e);return t}const Qme=new er(mn);function sM(){return Qme}class vg{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Cg.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new vg(tn.min(),s,sM(),Jo(),On())}}class Cg{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Cg(r,e,On(),On(),On())}}class iM{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class TK{constructor(t,e){this.targetId=t,this.At=e}}class wK{constructor(t,e,r=l2.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class bK{constructor(){this.Rt=0,this.bt=NK(),this.Pt=l2.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=On(),e=On(),r=On();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:Pt()}}),new Cg(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=NK()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class Jme{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=Jo(),this.qt=OK(),this.Kt=new er(mn)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:Pt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(QE(i))if(0===r){const o=new rt(i.path);this.jt(e,o,gr.newNoDocument(o,tn.min()))}else en(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&QE(c.target)){const u=new rt(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,gr.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=On();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new vg(t,e,this.Kt,this.Ut,r);return this.Ut=Jo(),this.qt=OK(),this.Kt=new er(mn),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new bK,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new er(mn),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||$e("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new bK),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function OK(){return new cs(rt.comparator)}function NK(){return new cs(rt.comparator)}const e_e={asc:"ASCENDING",desc:"DESCENDING"},t_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class n_e{constructor(t,e){this.databaseId=t,this.gt=e}}function yg(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function AK(n,t){return n.gt?t.toBase64():t.toUint8Array()}function r_e(n,t){return yg(n,t.toTimestamp())}function k2(n){return en(!!n),tn.fromTimestamp(function(t){const e=C0(t);return new Kr(e.seconds,e.nanos)}(n))}function HI(n,t){return(e=n,new p1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function IK(n){const t=p1.fromString(n);return en(HK(t)),t}function Eg(n,t){return HI(n.databaseId,t.path)}function m4(n,t){const e=IK(t);if(e.get(1)!==n.databaseId.projectId)throw new He(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new He(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new rt(kK(e))}function FI(n,t){return HI(n.databaseId,t)}function Mg(n){return new p1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function kK(n){return en(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function LK(n,t,e){return{name:Eg(n,t),fields:e.value.mapValue.fields}}function DK(n,t){return{documents:[FI(n,t.path)]}}function $I(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=FI(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=FI(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(g=>function(m){if("=="===m.op){if(WY(m.value))return{unaryFilter:{field:Pf(m.field),op:"IS_NAN"}};if(GY(m.value))return{unaryFilter:{field:Pf(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(WY(m.value))return{unaryFilter:{field:Pf(m.field),op:"IS_NOT_NAN"}};if(GY(m.value))return{unaryFilter:{field:Pf(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pf(m.field),op:l_e(m.op),value:m.value}}}(g));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:Pf((g=h).field),direction:c_e(g.dir)};var g})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(h=t.limit,n.gt||ag(h)?h:{value:h});var h,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function zK(n){let t=function xK(n){const t=IK(n);return 4===t.length?p1.emptyPath():kK(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){en(1===r);const g=e.from[0];g.allDescendants?s=g.collectionId:t=t.child(g.collectionId)}let i=[];e.where&&(i=VK(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(g=>{return new _f(Tf((m=g).field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(g){let m;return m="object"==typeof g?g.value:g,ag(m)?null:m}(e.limit));let u=null;var g;e.startAt&&(u=new M0((g=e.startAt).values||[],!!g.before));let h=null;return e.endAt&&(h=function(g){return new M0(g.values||[],!g.before)}(e.endAt)),function nK(n,t,e,r,s,i,o,c){return new Il(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,h)}function VK(n){return n?void 0!==n.unaryFilter?[f_e(n)]:void 0!==n.fieldFilter?[u_e(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>VK(t)).reduce((t,e)=>t.concat(e)):Pt():[]}function c_e(n){return e_e[n]}function l_e(n){return t_e[n]}function Pf(n){return{fieldPath:n.canonicalString()}}function Tf(n){return Es.fromServerFormat(n.fieldPath)}function u_e(n){return gi.create(Tf(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Pt()}}(n.fieldFilter.op),n.fieldFilter.value)}function f_e(n){switch(n.unaryFilter.op){case"IS_NAN":const t=Tf(n.unaryFilter.field);return gi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=Tf(n.unaryFilter.field);return gi.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Tf(n.unaryFilter.field);return gi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Tf(n.unaryFilter.field);return gi.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Pt()}}function h_e(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function HK(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class GI{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&qme(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=gg(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=gg(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=PK();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=gK(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(tn.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),On())}isEqual(t){return this.batchId===t.batchId&&pf(this.mutations,t.mutations,(e,r)=>mK(e,r))&&pf(this.baseMutations,t.baseMutations,(e,r)=>mK(e,r))}}class WI{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){en(t.mutations.length===r.length);let s=Kme;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new WI(t,e,r,s)}}class qI{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class P0{constructor(t,e,r,s,i=tn.min(),o=tn.min(),c=l2.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new P0(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new P0(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new P0(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class qK{constructor(t){this.re=t}}function jI(n){const t=zK({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?eM(t,t.limit,"L"):t}class Hu{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(ls(t.integerValue));else if("doubleValue"in t){const r=ls(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),cg(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(Nu(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?qY(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):Pt()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),rt.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}Hu.Te=new Hu;class V_e{constructor(){this.Ye=new YI}addToCollectionParentIndex(t,e){return this.Ye.add(e),Ce.resolve()}getCollectionParents(t,e){return Ce.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Ce.resolve()}deleteFieldIndex(t,e){return Ce.resolve()}getDocumentsMatchingTarget(t,e){return Ce.resolve(null)}getIndexType(t,e){return Ce.resolve(0)}getFieldIndexes(t,e){return Ce.resolve([])}getNextCollectionGroupToUpdate(t){return Ce.resolve(null)}getMinOffset(t,e){return Ce.resolve(Ia.min())}getMinOffsetFromCollectionGroup(t,e){return Ce.resolve(Ia.min())}updateCollectionGroup(t,e,r){return Ce.resolve()}updateIndexEntries(t,e){return Ce.resolve()}}class YI{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new er(p1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new er(p1.comparator)).toArray()}}new Uint8Array(0);class ea{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new ea(t,ea.DEFAULT_COLLECTION_PERCENTILE,ea.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ea.DEFAULT_COLLECTION_PERCENTILE=10,ea.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ea.DEFAULT=new ea(41943040,ea.DEFAULT_COLLECTION_PERCENTILE,ea.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ea.DISABLED=new ea(-1,0,0);class $u{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new $u(0)}static vn(){return new $u(-1)}}class Z_e{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class dX{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&gg(r.mutation,s,xa.empty(),Kr.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,On()).next(()=>r))}getLocalViewOfDocuments(t,e,r=On()){const s=g4();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=mg();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=g4();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,On()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=Jo();const o=_g(),c=_g();return e.forEach((u,h)=>{const g=r.get(h.key);s.has(h.key)&&(void 0===g||g.mutation instanceof xl)?i=i.insert(h.key,h):void 0!==g&&(o.set(h.key,g.mutation.getFieldMask()),gg(g.mutation,h,g.mutation.getFieldMask(),Kr.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((h,g)=>o.set(h,g)),e.forEach((h,g)=>{var m;return c.set(h,new Z_e(g,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=_g();let s=new cs((o,c)=>o-c),i=On();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=e.get(u);if(null===h)return;let g=r.get(u)||xa.empty();g=c.applyToLocalView(h,g),r.set(u,g);const m=(s.get(c.batchId)||On()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,g=u.value,m=PK();g.forEach(C=>{if(!i.has(C)){const w=gK(e.get(C),r.get(C));null!==w&&m.set(C,w),i=i.add(C)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return Ce.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return rt.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):RI(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):Ce.resolve(g4());let c=-1,u=i;return o.next(h=>Ce.forEach(h,(g,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(g)?Ce.resolve():this.getBaseDocument(t,g,m).next(C=>{u=u.insert(g,C)}))).next(()=>this.populateOverlays(t,h,i)).next(()=>this.computeViews(t,u,h,On())).next(g=>({batchId:c,changes:SK(g)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new rt(e)).next(r=>{let s=mg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=mg();return this.indexManager.getCollectionParents(t,s).next(o=>Ce.forEach(o,c=>{const u=(h=e,g=c.child(s),new Il(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,g;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(h=>{h.forEach((g,m)=>{i=i.insert(g,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,gr.newInvalidDocument(h)))});let o=mg();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&gg(h.mutation,u,xa.empty(),Kr.now()),zI(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):Ce.resolve(gr.newInvalidDocument(e))}}class Y_e{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Ce.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:k2(r.createTime)}),Ce.resolve()}getNamedQuery(t,e){return Ce.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:jI(r.bundledQuery),readTime:k2(r.readTime)}),Ce.resolve();var r}}class K_e{constructor(){this.overlays=new cs(rt.comparator),this.es=new Map}getOverlay(t,e){return Ce.resolve(this.overlays.get(e))}getOverlays(t,e){const r=g4();return Ce.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),Ce.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Ce.resolve()}getOverlaysForCollection(t,e,r){const s=g4(),i=e.length+1,o=new rt(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Ce.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new cs((h,g)=>h-g);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let g=i.get(h.largestBatchId);null===g&&(g=g4(),i=i.insert(h.largestBatchId,g)),g.set(h.getKey(),h)}}const c=g4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,g)=>c.set(h,g)),!(c.size()>=s)););return Ce.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new qI(e,r));let i=this.es.get(e);void 0===i&&(i=On(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class KI{constructor(){this.ns=new er(R2.ss),this.rs=new er(R2.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new R2(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new R2(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new rt(new p1([])),r=new R2(e,t),s=new R2(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new rt(new p1([])),r=new R2(e,t),s=new R2(e,t+1);let i=On();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new R2(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class R2{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return rt.comparator(t.key,e.key)||mn(t._s,e._s)}static os(t,e){return mn(t._s,e._s)||rt.comparator(t.key,e.key)}}class X_e{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new er(R2.ss)}checkEmpty(t){return Ce.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new GI(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new R2(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return Ce.resolve(o)}lookupMutationBatch(t,e){return Ce.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return Ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ce.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new R2(e,0),s=new R2(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new er(mn);return e.forEach(s=>{const i=new R2(s,0),o=new R2(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Ce.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;rt.isDocumentKey(i)||(i=i.child(""));const o=new R2(new rt(i),0);let c=new er(mn);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),Ce.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){en(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Ce.forEach(e.mutations,s=>{const i=new R2(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new R2(e,0),s=this.gs.firstAfterOrEqual(r);return Ce.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return Ce.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Q_e{constructor(t){this.Es=t,this.docs=new cs(rt.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Ce.resolve(r?r.document.mutableCopy():gr.newInvalidDocument(e))}getEntries(t,e){let r=Jo();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():gr.newInvalidDocument(s))}),Ce.resolve(r)}getAllFromCollection(t,e,r){let s=Jo();const i=new rt(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||bI(RY(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Ce.resolve(s)}getAllFromCollectionGroup(t,e,r,s){Pt()}As(t,e){return Ce.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new J_e(this)}getSize(t){return Ce.resolve(this.size)}}class J_e extends class W_e{constructor(){this.changes=new S0(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,gr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Ce.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),Ce.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class eve{constructor(t){this.persistence=t,this.Rs=new S0(e=>ku(e),hg),this.lastRemoteSnapshotVersion=tn.min(),this.highestTargetId=0,this.bs=0,this.Ps=new KI,this.targetCount=0,this.vs=$u.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),Ce.resolve()}getLastRemoteSnapshotVersion(t){return Ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Ce.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Ce.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),Ce.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new $u(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Ce.resolve()}updateTargetData(t,e){return this.Dn(e),Ce.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Ce.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),Ce.waitFor(i).next(()=>s)}getTargetCount(t){return Ce.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return Ce.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),Ce.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),Ce.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Ce.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return Ce.resolve(r)}containsKey(t,e){return Ce.resolve(this.Ps.containsKey(e))}}class pX{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new Qo(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new eve(this),this.indexManager=new V_e,this.remoteDocumentCache=new Q_e(r=>this.referenceDelegate.xs(r)),this.It=new qK(e),this.Ns=new Y_e(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new K_e,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new X_e(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){$e("MemoryPersistence","Starting transaction:",t);const s=new tve(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return Ce.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class tve extends class Mme{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class pM{constructor(t){this.persistence=t,this.Fs=new KI,this.$s=null}static Bs(t){return new pM(t)}get Ls(){if(this.$s)return this.$s;throw Pt()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),Ce.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),Ce.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Ce.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ce.forEach(this.Ls,r=>{const s=rt.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,tn.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return Ce.or([()=>Ce.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class ex{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=On(),s=On();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ex(t,e.fromCache,r,s)}}class mX{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(rK(e))return Ce.resolve(null);let r=vo(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=eM(e,null,"F"),r=vo(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=On(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const h=this.Fi(e,c);return this.$i(e,h,o,u.readTime)?this.ki(t,eM(e,null,"F")):this.Bi(t,h,e,u)}))})))}Oi(t,e,r,s){return rK(e)||s.isEqual(tn.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(PI()<=d1.DEBUG&&$e("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),DI(e)),this.Bi(t,o,e,function LY(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=tn.fromTimestamp(1e9===r?new Kr(e+1,0):new Kr(e,r));return new Ia(s,rt.empty(),t)}(s,-1)))})}Fi(t,e){let r=new er(oK(t));return e.forEach((s,i)=>{zI(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return PI()<=d1.DEBUG&&$e("QueryEngine","Using full collection scan to execute query:",DI(e)),this.Ni.getDocumentsMatchingQuery(t,e,Ia.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class rve{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new cs(mn),this.qi=new S0(i=>ku(i),hg),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new dX(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function vX(n,t){return tx.apply(this,arguments)}function tx(){return tx=A(function*(n,t){const e=at(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=On();for(const h of s){o.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}for(const h of i){c.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}return e.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),tx.apply(this,arguments)}function sve(n,t){const e=at(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const g=u.batch,m=g.keys();let C=Ce.resolve();return m.forEach(w=>{C=C.next(()=>h.getEntry(c,w)).next(I=>{const H=u.docVersions.get(w);en(null!==H),I.version.compareTo(H)<0&&(g.applyToRemoteDocument(I,u),I.isValidDocument()&&(I.setReadTime(u.commitVersion),h.addEntry(I)))})}),C.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=On();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function CX(n){const t=at(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function ive(n,t){const e=at(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((g,m)=>{const C=s.get(m);if(!C)return;c.push(e.Cs.removeMatchingKeys(i,g.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,g.addedDocuments,m)));let w=C.withSequenceNumber(i.currentSequenceNumber);var I,H,Y;t.targetMismatches.has(m)?w=w.withResumeToken(l2.EMPTY_BYTE_STRING,tn.min()).withLastLimboFreeSnapshotVersion(tn.min()):g.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(g.resumeToken,r)),s=s.insert(m,w),H=w,Y=g,(0===(I=C).resumeToken.approximateByteSize()||H.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,w))});let u=Jo(),h=On();if(t.documentUpdates.forEach(g=>{t.resolvedLimboDocuments.has(g)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,g))}),c.push(function yX(n,t,e){let r=On(),s=On();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=Jo();return e.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(tn.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):$e("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(g=>{u=g.Wi,h=g.zi})),!r.isEqual(tn.min())){const g=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(g)}return Ce.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(e.Ui=s,i))}function ove(n,t){const e=at(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function Of(n,t){const e=at(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,Ce.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new P0(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function Nf(n,t,e){return nx.apply(this,arguments)}function nx(){return nx=A(function*(n,t,e){const r=at(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!v0(o))throw o;$e("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),nx.apply(this,arguments)}function mM(n,t,e){const r=at(n);let s=tn.min(),i=On();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const g=at(c),m=g.qi.get(h);return void 0!==m?Ce.resolve(g.Ui.get(m)):g.Cs.getTargetData(u,h)}(r,o,vo(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:tn.min(),e?i:On())).next(c=>(function SX(n,t,e){let r=n.Ki.get(t)||tn.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function iK(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class ax{constructor(){this.activeTargetIds=sM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class wX{constructor(){this.Lr=new ax,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new ax,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class lve{qr(t){}shutdown(){}}class bX{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){$e("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){$e("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const uve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fve{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class hve extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);$e("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>($e("RestConnection","Received: ",u),u),u=>{throw df("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+hf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${uve[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new fme;c.setWithCredentials(!0),c.listenOnce(cme.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case SI.NO_ERROR:const g=c.getResponseJson();$e("Connection","XHR received:",JSON.stringify(g)),i(g);break;case SI.TIMEOUT:$e("Connection",'RPC "'+t+'" timed out'),o(new He(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case SI.HTTP_ERROR:const m=c.getStatus();if($e("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let C=c.getResponseJson();Array.isArray(C)&&(C=C[0]);const w=null===(h=C)||void 0===h?void 0:h.error;if(w&&w.status&&w.message){const I=function(H){const Y=H.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(Y)>=0?Y:Pe.UNKNOWN}(w.status);o(new He(I,w.message))}else o(new He(Pe.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new He(Pe.UNAVAILABLE,"Connection failed."));break;default:Pt()}}finally{$e("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=ome(),o=ame(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new ume({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");$e("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let g=!1,m=!1;const C=new fve({Hr:I=>{m?$e("Connection","Not sending because WebChannel is closed:",I):(g||($e("Connection","Opening WebChannel transport."),h.open(),g=!0),$e("Connection","WebChannel sending:",I),h.send(I))},Jr:()=>h.close()}),w=(I,H,Y)=>{I.listen(H,ee=>{try{Y(ee)}catch(_e){setTimeout(()=>{throw _e},0)}})};return w(h,WE.EventType.OPEN,()=>{m||$e("Connection","WebChannel transport opened.")}),w(h,WE.EventType.CLOSE,()=>{m||(m=!0,$e("Connection","WebChannel transport closed"),C.io())}),w(h,WE.EventType.ERROR,I=>{m||(m=!0,df("Connection","WebChannel transport errored:",I),C.io(new He(Pe.UNAVAILABLE,"The operation could not be completed")))}),w(h,WE.EventType.MESSAGE,I=>{var H;if(!m){const Y=I.data[0];en(!!Y);const ee=Y,_e=ee.error||(null===(H=ee[0])||void 0===H?void 0:H.error);if(_e){$e("Connection","WebChannel received error:",_e);const te=_e.status;let Ae=function(Ze){const zt=Fs[Ze];if(void 0!==zt)return EK(zt)}(te),Fe=_e.message;void 0===Ae&&(Ae=Pe.INTERNAL,Fe="Unknown error status: "+te+" with message "+_e.message),m=!0,C.io(new He(Ae,Fe)),h.close()}else $e("Connection","WebChannel received:",Y),C.ro(Y)}}),w(o,lme.STAT_EVENT,I=>{I.stat===OY.PROXY?$e("Connection","Detected buffering proxy"):I.stat===OY.NOPROXY&&$e("Connection","Detected no buffering proxy")}),setTimeout(()=>{C.so()},0),C}}function CM(){return typeof document<"u"?document:null}function xg(n){return new n_e(n,!0)}class lx{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&$e("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class NX{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new lx(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return A(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return A(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return A(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===Pe.RESOURCE_EXHAUSTED?(ys(e.toString()),ys("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===Pe.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new He(Pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(A(function*(){t.state=0,t.start()}))}Qo(t){return $e("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():($e("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dve extends NX{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function i_e(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Pt(),s=t.targetChange.targetIds||[],i=function(u,h){return u.gt?(en(void 0===h||"string"==typeof h),l2.fromBase64String(h||"")):(en(void 0===h||h instanceof Uint8Array),l2.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const h=void 0===u.code?Pe.UNKNOWN:EK(u.code);return new He(h,u.message||"")}(o);e=new wK(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=m4(n,r.document.name),i=k2(r.document.updateTime),o=new pi({mapValue:{fields:r.document.fields}}),c=gr.newFoundDocument(s,i,o);e=new iM(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=m4(n,r.document),i=r.readTime?k2(r.readTime):tn.min(),o=gr.newNoDocument(s,i);e=new iM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=m4(n,r.document);e=new iM([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return Pt();{const r=t.filter,i=new Zme(r.count||0);e=new TK(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return tn.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?tn.min():i.readTime?k2(i.readTime):tn.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=Mg(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=QE(c)?{documents:DK(s,c)}:{query:$I(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=AK(s,i.resumeToken):i.snapshotVersion.compareTo(tn.min())>0&&(o.readTime=yg(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function a_e(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pt()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=Mg(this.It),e.removeTarget=t,this.Bo(e)}}class pve extends NX{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(en(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function o_e(n,t){return n&&n.length>0?(en(void 0!==t),n.map(e=>function(r,s){let i=k2(r.updateTime?r.updateTime:s);return i.isEqual(tn.min())&&(i=k2(s)),new Wme(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=k2(t.commitTime);return this.listener.Zo(r,e)}return en(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Mg(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function Sg(n,t){let e;if(t instanceof Mf)e={update:LK(n,t.key,t.value)};else if(t instanceof Sf)e={delete:Eg(n,t.key)};else if(t instanceof xl)e={update:LK(n,t.key,t.data),updateMask:h_e(t.fieldMask)};else{if(!(t instanceof VI))return Pt();e={verify:Eg(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof yf)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Lu)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ru)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ef)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw Pt()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:r_e(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Pt()),e;var s}(this.It,r))};this.Bo(e)}}class gve extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new He(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new He(Pe.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new He(Pe.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class _ve{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(ys(e),this.ou=!1):$e("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class vve{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(A(function*(){var u;kl(o)&&($e("RemoteStore","Restarting streams for network reachability change."),yield(u=A(function*(h){const g=at(h);g._u.add(4),yield Af(g),g.gu.set("Unknown"),g._u.delete(4),yield kg(g)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new _ve(r,s)}}function kg(n){return fx.apply(this,arguments)}function fx(){return fx=A(function*(n){if(kl(n))for(const t of n.wu)yield t(!0)}),fx.apply(this,arguments)}function Af(n){return hx.apply(this,arguments)}function hx(){return hx=A(function*(n){for(const t of n.wu)yield t(!1)}),hx.apply(this,arguments)}function yM(n,t){const e=at(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),gx(e)?px(e):xf(e).ko()&&dx(e,t))}function Lg(n,t){const e=at(n),r=xf(e);e.du.delete(t),r.ko()&&AX(e,t),0===e.du.size&&(r.ko()?r.Fo():kl(e)&&e.gu.set("Unknown"))}function dx(n,t){n.yu.Mt(t.targetId),xf(n).zo(t)}function AX(n,t){n.yu.Mt(t),xf(n).Ho(t)}function px(n){n.yu=new Jme({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),xf(n).start(),n.gu.uu()}function gx(n){return kl(n)&&!xf(n).No()&&n.du.size>0}function kl(n){return 0===at(n)._u.size}function IX(n){n.yu=void 0}function Cve(n){return mx.apply(this,arguments)}function mx(){return mx=A(function*(n){n.du.forEach((t,e)=>{dx(n,t)})}),mx.apply(this,arguments)}function yve(n,t){return _x.apply(this,arguments)}function _x(){return _x=A(function*(n,t){IX(n),gx(n)?(n.gu.hu(t),px(n)):n.gu.set("Unknown")}),_x.apply(this,arguments)}function Eve(n,t,e){return vx.apply(this,arguments)}function vx(){return vx=A(function*(n,t,e){if(n.gu.set("Online"),t instanceof wK&&2===t.state&&t.cause)try{yield(r=A(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){$e("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield EM(n,r)}else if(t instanceof iM?n.yu.Gt(t):t instanceof TK?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(tn.min()))try{const r=yield CX(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(l2.EMPTY_BYTE_STRING,u.snapshotVersion)),AX(s,c);const h=new P0(u.target,c,1,u.sequenceNumber);dx(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){$e("RemoteStore","Failed to raise snapshot:",r),yield EM(n,r)}var r}),vx.apply(this,arguments)}function EM(n,t,e){return Cx.apply(this,arguments)}function Cx(){return Cx=A(function*(n,t,e){if(!v0(t))throw t;n._u.add(1),yield Af(n),n.gu.set("Offline"),e||(e=()=>CX(n.localStore)),n.asyncQueue.enqueueRetryable(A(function*(){$e("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield kg(n)}))}),Cx.apply(this,arguments)}function xX(n,t){return t().catch(e=>EM(n,e,t))}function If(n){return yx.apply(this,arguments)}function yx(){return yx=A(function*(n){const t=at(n),e=b0(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;Mve(t);)try{const s=yield ove(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,Sve(t,s)}catch(s){yield EM(t,s)}kX(t)&&LX(t)}),yx.apply(this,arguments)}function Mve(n){return kl(n)&&n.fu.length<10}function Sve(n,t){n.fu.push(t);const e=b0(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function kX(n){return kl(n)&&!b0(n).No()&&n.fu.length>0}function LX(n){b0(n).start()}function Pve(n){return Ex.apply(this,arguments)}function Ex(){return Ex=A(function*(n){b0(n).eu()}),Ex.apply(this,arguments)}function Tve(n){return Mx.apply(this,arguments)}function Mx(){return Mx=A(function*(n){const t=b0(n);for(const e of n.fu)t.Xo(e.mutations)}),Mx.apply(this,arguments)}function wve(n,t,e){return Sx.apply(this,arguments)}function Sx(){return Sx=A(function*(n,t,e){const r=n.fu.shift(),s=WI.from(r,t,e);yield xX(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield If(n)}),Sx.apply(this,arguments)}function bve(n,t){return Px.apply(this,arguments)}function Px(){return Px=A(function*(n,t){var e;t&&b0(n).Yo&&(yield(e=A(function*(r,s){if(yK(i=s.code)&&i!==Pe.ABORTED){const o=r.fu.shift();b0(r).Mo(),yield xX(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield If(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),kX(n)&&LX(n)}),Px.apply(this,arguments)}function RX(n,t){return Tx.apply(this,arguments)}function Tx(){return Tx=A(function*(n,t){const e=at(n);e.asyncQueue.verifyOperationInProgress(),$e("RemoteStore","RemoteStore received new credentials");const r=kl(e);e._u.add(3),yield Af(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield kg(e)}),Tx.apply(this,arguments)}function bx(){return bx=A(function*(n,t){const e=at(n);t?(e._u.delete(2),yield kg(e)):t||(e._u.add(2),yield Af(e),e.gu.set("Unknown"))}),bx.apply(this,arguments)}function xf(n){return n.pu||(n.pu=function(t,e,r){const s=at(t);return s.su(),new dve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Cve.bind(null,n),Zr:yve.bind(null,n),Wo:Eve.bind(null,n)}),n.wu.push(function(){var t=A(function*(e){e?(n.pu.Mo(),gx(n)?px(n):n.gu.set("Unknown")):(yield n.pu.stop(),IX(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function b0(n){return n.Iu||(n.Iu=function(t,e,r){const s=at(t);return s.su(),new pve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Pve.bind(null,n),Zr:bve.bind(null,n),tu:Tve.bind(null,n),Zo:wve.bind(null,n)}),n.wu.push(function(){var t=A(function*(e){e?(n.Iu.Mo(),yield If(n)):(yield n.Iu.stop(),n.fu.length>0&&($e("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class Ox{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new c2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new Ox(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new He(Pe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kf(n,t){if(ys("AsyncQueue",`${t}: ${n}`),v0(n))return new He(Pe.UNAVAILABLE,`${t}: ${n}`);throw n}class Lf{constructor(t){this.comparator=t?(e,r)=>t(e,r)||rt.comparator(e.key,r.key):(e,r)=>rt.comparator(e.key,r.key),this.keyedMap=mg(),this.sortedSet=new cs(this.comparator)}static emptySet(t){return new Lf(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Lf)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new Lf;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class DX{constructor(){this.Tu=new cs(rt.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):Pt():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class Rf{constructor(t,e,r,s,i,o,c,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new Rf(t,e,Lf.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&dg(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class Ove{constructor(){this.Au=void 0,this.listeners=[]}}class Nve{constructor(){this.queries=new S0(t=>sK(t),dg),this.onlineState="Unknown",this.Ru=new Set}}function Nx(n,t){return Ax.apply(this,arguments)}function Ax(){return Ax=A(function*(n,t){const e=at(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new Ove),s)try{i.Au=yield e.onListen(r)}catch(o){const c=kf(o,`Initialization of query '${DI(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&kx(e)}),Ax.apply(this,arguments)}function Ix(n,t){return xx.apply(this,arguments)}function xx(){return xx=A(function*(n,t){const e=at(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),xx.apply(this,arguments)}function Ave(n,t){const e=at(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&kx(e)}function Ive(n,t,e){const r=at(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function kx(n){n.Ru.forEach(t=>{t.next()})}class Lx{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new Rf(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=Rf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class HX{constructor(t){this.key=t}}class FX{constructor(t){this.key=t}}class BX{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=On(),this.mutatedKeys=On(),this.Gu=oK(t),this.Qu=new Lf(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new DX,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((g,m)=>{const C=s.get(g),w=zI(this.query,m)?m:null,I=!!C&&this.mutatedKeys.has(C.key),H=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let Y=!1;C&&w?C.data.isEqual(w.data)?I!==H&&(r.track({type:3,doc:w}),Y=!0):this.Hu(C,w)||(r.track({type:2,doc:w}),Y=!0,(u&&this.Gu(w,u)>0||h&&this.Gu(w,h)<0)&&(c=!0)):!C&&w?(r.track({type:0,doc:w}),Y=!0):C&&!w&&(r.track({type:1,doc:C}),Y=!0,(u||h)&&(c=!0)),Y&&(w?(o=o.add(w),i=H?i.add(g):i.delete(g)):(o=o.delete(g),i=i.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((h,g)=>function(m,C){const w=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pt()}};return w(m)-w(C)}(h.type,g.type)||this.Gu(h.doc,g.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new Rf(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new DX,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=On(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new FX(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new HX(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=On();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Rf.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class Lve{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class Rve{constructor(t){this.key=t,this.nc=!1}}class Dve{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new S0(c=>sK(c),dg),this.rc=new Map,this.oc=new Set,this.uc=new cs(rt.comparator),this.cc=new Map,this.ac=new KI,this.hc={},this.lc=new Map,this.fc=$u.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function zve(n,t){return Rx.apply(this,arguments)}function Rx(){return Rx=A(function*(n,t){const e=sk(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield Of(e.localStore,vo(t));e.isPrimaryClient&&yM(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield Dx(e,t,r,"current"===c,o.resumeToken)}return s}),Rx.apply(this,arguments)}function Dx(n,t,e,r,s){return zx.apply(this,arguments)}function zx(){return zx=A(function*(n,t,e,r,s){n._c=(m,C,w)=>{return(I=A(function*(H,Y,ee,_e){let te=Y.view.Wu(ee);te.$i&&(te=yield mM(H.localStore,Y.query,!1).then(({documents:Ze})=>Y.view.Wu(Ze,te)));const Ae=_e&&_e.targetChanges.get(Y.targetId),Fe=Y.view.applyChanges(te,H.isPrimaryClient,Ae);return jx(H,Y.targetId,Fe.Xu),Fe.snapshot}),function(H,Y,ee,_e){return I.apply(this,arguments)})(n,m,C,w);var I};const i=yield mM(n.localStore,t,!0),o=new BX(t,i.Hi),c=o.Wu(i.documents),u=Cg.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);jx(n,e,h.Xu);const g=new Lve(t,e,o);return n.ic.set(t,g),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),h.snapshot}),zx.apply(this,arguments)}function Vve(n,t){return Vx.apply(this,arguments)}function Vx(){return Vx=A(function*(n,t){const e=at(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!dg(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Nf(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),Lg(e.remoteStore,r.targetId),Df(e,r.targetId)}).catch(_0))):(Df(e,r.targetId),yield Nf(e.localStore,r.targetId,!0))}),Vx.apply(this,arguments)}function Hx(){return Hx=A(function*(n,t,e){const r=ik(n);try{const s=yield function(i,o){const c=at(i),u=Kr.now(),h=o.reduce((C,w)=>C.add(w.key),On());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",C=>{let w=Jo(),I=On();return c.Gi.getEntries(C,h).next(H=>{w=H,w.forEach((Y,ee)=>{ee.isValidDocument()||(I=I.add(Y))})}).next(()=>c.localDocuments.getOverlayedDocuments(C,w)).next(H=>{g=H;const Y=[];for(const ee of o){const _e=jme(ee,g.get(ee.key).overlayedDocument);null!=_e&&Y.push(new xl(ee.key,_e,YY(_e.value.mapValue),Dr.exists(!0)))}return c.mutationQueue.addMutationBatch(C,u,Y,o)}).next(H=>{m=H;const Y=H.applyToLocalDocumentSet(g,I);return c.documentOverlayCache.saveOverlays(C,H.batchId,Y)})}).then(()=>({batchId:m.batchId,changes:SK(g)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new cs(mn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield Ll(r,s.changes),yield If(r.remoteStore)}catch(s){const i=kf(s,"Failed to persist write");e.reject(i)}}),Hx.apply(this,arguments)}function $X(n,t){return Fx.apply(this,arguments)}function Fx(){return Fx=A(function*(n,t){const e=at(n);try{const r=yield ive(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(en(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?en(o.nc):s.removedDocuments.size>0&&(en(o.nc),o.nc=!1))}),yield Ll(e,r,t)}catch(r){yield _0(r)}}),Fx.apply(this,arguments)}function UX(n,t,e){const r=at(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=at(i);c.onlineState=o;let u=!1;c.queries.forEach((h,g)=>{for(const m of g.listeners)m.bu(o)&&(u=!0)}),u&&kx(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Fve(n,t,e){return Bx.apply(this,arguments)}function Bx(){return Bx=A(function*(n,t,e){const r=at(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new cs(rt.comparator);o=o.insert(i,gr.newNoDocument(i,tn.min()));const c=On().add(i),u=new vg(tn.min(),new Map,new er(mn),o,c);yield $X(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),Zx(r)}else yield Nf(r.localStore,t,!1).then(()=>Df(r,t,e)).catch(_0)}),Bx.apply(this,arguments)}function Bve(n,t){return $x.apply(this,arguments)}function $x(){return $x=A(function*(n,t){const e=at(n),r=t.batch.batchId;try{const s=yield sve(e.localStore,t);qx(e,r,null),Wx(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield Ll(e,s)}catch(s){yield _0(s)}}),$x.apply(this,arguments)}function $ve(n,t,e){return Ux.apply(this,arguments)}function Ux(){return Ux=A(function*(n,t,e){const r=at(n);try{const s=yield function(i,o){const c=at(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(g=>(en(null!==g),h=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,t);qx(r,t,e),Wx(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield Ll(r,s)}catch(s){yield _0(s)}}),Ux.apply(this,arguments)}function Wx(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function qx(n,t,e){const r=at(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function Df(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||GX(n,r)})}function GX(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(Lg(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),Zx(n))}function jx(n,t,e){for(const r of e)r instanceof HX?(n.ac.addReference(r.key,t),Gve(n,r)):r instanceof FX?($e("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||GX(n,r.key)):Pt()}function Gve(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||($e("SyncEngine","New document in limbo: "+e),n.oc.add(r),Zx(n))}function Zx(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new rt(p1.fromString(t)),r=n.fc.next();n.cc.set(r,new Rve(e)),n.uc=n.uc.insert(e,r),yM(n.remoteStore,new P0(vo(vf(e.path)),r,2,Qo.at))}}function Ll(n,t,e){return Yx.apply(this,arguments)}function Yx(){return Yx=A(function*(n,t,e){const r=at(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(h=>{if((h||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const g=ex.Ci(u.targetId,h);i.push(g)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=A(function*(u,h){const g=at(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Ce.forEach(h,C=>Ce.forEach(C.Si,w=>g.persistence.referenceDelegate.addReference(m,C.targetId,w)).next(()=>Ce.forEach(C.Di,w=>g.persistence.referenceDelegate.removeReference(m,C.targetId,w)))))}catch(m){if(!v0(m))throw m;$e("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const C=m.targetId;if(!m.fromCache){const w=g.Ui.get(C),H=w.withLastLimboFreeSnapshotVersion(w.snapshotVersion);g.Ui=g.Ui.insert(C,H)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),Yx.apply(this,arguments)}function Wve(n,t){return Kx.apply(this,arguments)}function Kx(){return Kx=A(function*(n,t){const e=at(n);if(!e.currentUser.isEqual(t)){$e("SyncEngine","User change. New user:",t.toKey());const r=yield vX(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new He(Pe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield Ll(e,r.ji)}var s}),Kx.apply(this,arguments)}function qve(n,t){const e=at(n),r=e.cc.get(t);if(r&&r.nc)return On().add(r.key);{let s=On();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function sk(n){const t=at(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=$X.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=qve.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Fve.bind(null,t),t.sc.Wo=Ave.bind(null,t.eventManager),t.sc.wc=Ive.bind(null,t.eventManager),t}function ik(n){const t=at(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Bve.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=$ve.bind(null,t),t}class tCe{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return A(function*(){e.It=xg(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function _X(n,t,e,r){return new rve(n,t,e,r)}(this.persistence,new mX,t.initialUser,this.It)}yc(t){return new pX(pM.Bs,this.It)}gc(t){return new wX}terminate(){var t=this;return A(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class ok{initialize(t,e){var r=this;return A(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>UX(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=Wve.bind(null,r.syncEngine),yield function wx(n,t){return bx.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new Nve}createDatastore(t){const e=xg(t.databaseInfo.databaseId),r=new hve(t.databaseInfo);return new gve(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>UX(this.syncEngine,c,0),o=bX.C()?new bX:new lve,new vve(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,h){const g=new Dve(r,s,i,o,c,u);return h&&(g.dc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=A(function*(e){const r=at(e);$e("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield Af(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function ak(n,t,e){if(!e)throw new He(Pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function jX(n){if(!rt.isDocumentKey(n))throw new He(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ZX(n){if(rt.isDocumentKey(n))throw new He(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function MM(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":Pt()}function l1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new He(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=MM(n);throw new He(Pe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const KX=new Map;class XX{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new He(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new He(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function sCe(n,t,e,r){if(!0===t&&!0===r)throw new He(Pe.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Rg{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new XX({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new He(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new He(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new XX(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new hme;switch(e.type){case"gapi":return new mme(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new He(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=KX.get(t);e&&($e("ComponentProvider","Removing Datastore"),KX.delete(t),e.terminate())}(this),Promise.resolve()}}function QX(n,t,e,r={}){var s;const i=(n=l1(n,Rg))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&df("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=x2.MOCK_USER;else{o=function Zde(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[fE(JSON.stringify({alg:"none",type:"JWT"})),fE(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new He(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new x2(u)}n._authCredentials=new dme(new AY(o,c))}}class Ms{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new v4(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ms(this.firestore,t,this._key)}}class Ui{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Ui(this.firestore,t,this._query)}}class v4 extends Ui{constructor(t,e,r){super(t,e,vf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ms(this.firestore,null,new rt(t))}withConverter(t){return new v4(this.firestore,t,this._path)}}function iCe(n,t,...e){if(n=Yr(n),ak("collection","path",t),n instanceof Rg){const r=p1.fromString(t,...e);return ZX(r),new v4(n,null,r)}{if(!(n instanceof Ms||n instanceof v4))throw new He(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(p1.fromString(t,...e));return ZX(r),new v4(n.firestore,null,r)}}function JX(n,t,...e){if(n=Yr(n),1===arguments.length&&(t=xY.R()),ak("doc","path",t),n instanceof Rg){const r=p1.fromString(t,...e);return jX(r),new Ms(n,null,new rt(r))}{if(!(n instanceof Ms||n instanceof v4))throw new He(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(p1.fromString(t,...e));return jX(r),new Ms(n.firestore,n instanceof v4?n.converter:null,new rt(r))}}class SM{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):ys("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class fCe{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=x2.UNAUTHENTICATED,this.clientId=xY.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=A(function*(c){$e("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>($e("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return A(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new He(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new c2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(A(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=kf(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function nQ(n,t){return ck.apply(this,arguments)}function ck(){return ck=A(function*(n,t){n.asyncQueue.verifyOperationInProgress(),$e("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=A(function*(i){r.isEqual(i)||(yield vX(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),ck.apply(this,arguments)}function rQ(n,t){return lk.apply(this,arguments)}function lk(){return lk=A(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield uk(n);$e("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>RX(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>RX(t.remoteStore,i)),n.onlineComponents=t}),lk.apply(this,arguments)}function uk(n){return fk.apply(this,arguments)}function fk(){return fk=A(function*(n){return n.offlineComponents||($e("FirestoreClient","Using default OfflineComponentProvider"),yield nQ(n,new tCe)),n.offlineComponents}),fk.apply(this,arguments)}function PM(n){return hk.apply(this,arguments)}function hk(){return hk=A(function*(n){return n.onlineComponents||($e("FirestoreClient","Using default OnlineComponentProvider"),yield rQ(n,new ok)),n.onlineComponents}),hk.apply(this,arguments)}function zf(n){return gk.apply(this,arguments)}function gk(){return gk=A(function*(n){const t=yield PM(n),e=t.eventManager;return e.onListen=zve.bind(null,t.syncEngine),e.onUnlisten=Vve.bind(null,t.syncEngine),e}),gk.apply(this,arguments)}class CCe{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new lx(this,"async_queue_retry"),this.Wc=()=>{const e=CM();e&&$e("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=CM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=CM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new c2;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return A(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!v0(e))throw e;$e("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,ys("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=Ox.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&Pt()}verifyOperationInProgress(){}Xc(){var t=this;return A(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function mk(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Mr extends Rg{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new CCe,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||cQ(this),this._firestoreClient.terminate()}}function ECe(n,t){const r="string"==typeof n?n:t||"(default)",s=sf("object"==typeof n?n:kA(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=Kj("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&QX(s,...i)}return s}function Bs(n){return n._firestoreClient||cQ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function cQ(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new Ome(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new fCe(n._authCredentials,n._appCheckCredentials,n._queue,r)}class Gu{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Gu(l2.fromBase64String(t))}catch(e){throw new He(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Gu(l2.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Vf{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new He(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Es(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class wM{constructor(t){this._methodName=t}}class _k{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new He(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new He(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return mn(this._lat,t._lat)||mn(this._long,t._long)}}const MCe=/^__.*__$/;class SCe{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new xl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Mf(t,this.data,e,this.fieldTransforms)}}class fQ{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new xl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function hQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pt()}}class bM{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new bM(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return NM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(hQ(this.sa)&&MCe.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class PCe{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||xg(t)}da(t,e,r,s=!1){return new bM({sa:t,methodName:e,fa:r,path:Es.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Hf(n){const t=n._freezeSettings(),e=xg(n._databaseId);return new PCe(n._databaseId,!!t.ignoreUndefinedProperties,e)}function vk(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);yk("Data must be an object, but it was:",o,r);const c=_Q(r,o);let u,h;if(i.merge)u=new xa(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const g=[];for(const m of i.mergeFields){const C=Ek(t,m,e);if(!o.contains(C))throw new He(Pe.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);CQ(g,C)||g.push(C)}u=new xa(g),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new SCe(new pi(c),u,h)}class Dg extends wM{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Dg}}class Ck extends wM{_toFieldTransform(t){return new pg(t.path,new yf)}isEqual(t){return t instanceof Ck}}function Wu(n,t){if(vQ(n=Yr(n)))return yk("Unsupported field value:",t,n),_Q(n,t);if(n instanceof wM)return function(e,r){if(!hQ(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=Wu(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=Yr(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return lK(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=Kr.fromDate(e);return{timestampValue:yg(r.It,s)}}if(e instanceof Kr){const s=new Kr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:yg(r.It,s)}}if(e instanceof _k)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Gu)return{bytesValue:AK(r.It,e._byteString)};if(e instanceof Ms){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:HI(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${MM(e)}`)}(n,t)}function _Q(n,t){const e={};return HY(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ou(n,(r,s)=>{const i=Wu(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function vQ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Kr||n instanceof _k||n instanceof Gu||n instanceof Ms||n instanceof wM)}function yk(n,t,e){if(!vQ(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=MM(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Ek(n,t,e){if((t=Yr(t))instanceof Vf)return t._internalPath;if("string"==typeof t)return OM(n,t);throw NM("Field path arguments must be of type string or ",n,!1,void 0,e)}const OCe=new RegExp("[~\\*/\\[\\]]");function OM(n,t,e){if(t.search(OCe)>=0)throw NM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Vf(...t.split("."))._internalPath}catch{throw NM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function NM(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new He(Pe.INVALID_ARGUMENT,c+n+u)}function CQ(n,t){return n.some(e=>e.isEqual(t))}class Mk{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ms(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new NCe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(AM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class NCe extends Mk{data(){return super.data()}}function AM(n,t){return"string"==typeof t?OM(n,t):t instanceof Vf?t._internalPath:t._delegate._internalPath}function yQ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new He(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sk{}function ACe(n,...t){for(const e of t)n=e._apply(n);return n}class ICe extends Sk{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=Hf(t.firestore),r=function(s,i,o,c,u,h,g){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new He(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){wQ(g,h);const w=[];for(const I of g)w.push(TQ(c,s,I));m={arrayValue:{values:w}}}else m=TQ(c,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||wQ(g,h),m=function mQ(n,t,e,r=!1){return Wu(e,n.da(r?4:3,t))}(o,"where",g,"in"===h||"not-in"===h);const C=gi.create(u,h,m);return function(w,I){if(I.dt()){const Y=LI(w);if(null!==Y&&!Y.isEqual(I.field))throw new He(Pe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Y.toString()}' and '${I.field.toString()}'`);const ee=kI(w);null!==ee&&bQ(0,I.field,ee)}const H=function(Y,ee){for(const _e of Y.filters)if(ee.indexOf(_e.op)>=0)return _e.op;return null}(w,function(Y){switch(Y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(I.op));if(null!==H)throw new He(Pe.INVALID_ARGUMENT,H===I.op?`Invalid query. You cannot use more than one '${I.op.toString()}' filter.`:`Invalid query. You cannot use '${I.op.toString()}' filters with '${H.toString()}' filters.`)}(s,C),C}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new Ui(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new Il(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function xCe(n,t,e){const r=t,s=AM("where",n);return new ICe(s,r,e)}class kCe extends Sk{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new He(Pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new He(Pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new _f(s,i);return function(c,u){if(null===kI(c)){const h=LI(c);null!==h&&bQ(0,h,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new Ui(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new Il(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function LCe(n,t="asc"){const e=t,r=AM("orderBy",n);return new kCe(r,e)}class EQ extends Sk{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new Ui(t.firestore,t.converter,eM(t._query,this.Ia,this.Ta))}}function RCe(n){return function YX(n,t){if(t<=0)throw new He(Pe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new EQ("limit",n,"F")}function TQ(n,t,e){if("string"==typeof(e=Yr(e))){if(""===e)throw new He(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!RI(t)&&-1!==e.indexOf("/"))throw new He(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(p1.fromString(e));if(!rt.isDocumentKey(r))throw new He(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xu(n,new rt(r))}if(e instanceof Ms)return xu(n,e._key);throw new He(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${MM(e)}.`)}function wQ(n,t){if(!Array.isArray(n)||0===n.length)throw new He(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new He(Pe.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function bQ(n,t,e){if(!e.isEqual(t))throw new He(Pe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function Pk(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class qu{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ff extends Mk{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new IM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(AM("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class IM extends Ff{data(t={}){return super.data(t)}}class Bf{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new qu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new IM(this._firestore,this._userDataWriter,r.key,r,new qu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new He(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new IM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new qu(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new IM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new qu(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:zCe(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function zCe(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pt()}}function VCe(n){n=l1(n,Ms);const t=l1(n.firestore,Mr);return function oQ(n,t,e={}){const r=new c2;return n.asyncQueue.enqueueAndForget(A(function*(){return function(s,i,o,c,u){const h=new SM({next:m=>{i.enqueueAndForget(()=>Ix(s,g));const C=m.docs.has(o);!C&&m.fromCache?u.reject(new He(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&m.fromCache&&c&&"server"===c.source?u.reject(new He(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new Lx(vf(o.path),h,{includeMetadataChanges:!0,Nu:!0});return Nx(s,g)}(yield zf(n),n.asyncQueue,t,e,r)})),r.promise}(Bs(t),n._key).then(e=>Tk(t,n,e))}class O0 extends class DCe{convertValue(t,e="none"){switch(Iu(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ls(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Nu(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Pt()}}convertObject(t,e){const r={};return Ou(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new _k(ls(t.latitude),ls(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=BY(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(og(t));default:return null}}convertTimestamp(t){const e=C0(t);return new Kr(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=p1.fromString(t);en(HK(r));const s=new Au(r.get(1),r.get(3)),i=new rt(r.popFirst(5));return s.isEqual(e)||ys(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new Gu(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ms(this.firestore,null,e)}}function HCe(n){n=l1(n,Ui);const t=l1(n.firestore,Mr),e=Bs(t),r=new O0(t);return yQ(n._query),function aQ(n,t,e={}){const r=new c2;return n.asyncQueue.enqueueAndForget(A(function*(){return function(s,i,o,c,u){const h=new SM({next:m=>{i.enqueueAndForget(()=>Ix(s,g)),m.fromCache&&"server"===c.source?u.reject(new He(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new Lx(o,h,{includeMetadataChanges:!0,Nu:!0});return Nx(s,g)}(yield zf(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new Bf(t,r,n,s))}function FCe(n,t,e){n=l1(n,Ms);const r=l1(n.firestore,Mr),s=Pk(n.converter,t,e);return zg(r,[vk(Hf(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,Dr.none())])}function BCe(n,t,e,...r){n=l1(n,Ms);const s=l1(n.firestore,Mr),i=Hf(s);let o;return o="string"==typeof(t=Yr(t))||t instanceof Vf?function gQ(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Ek(t,r,e)],u=[s];if(i.length%2!=0)throw new He(Pe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<i.length;C+=2)c.push(Ek(t,i[C])),u.push(i[C+1]);const h=[],g=pi.empty();for(let C=c.length-1;C>=0;--C)if(!CQ(h,c[C])){const w=c[C];let I=u[C];I=Yr(I);const H=o.ca(w);if(I instanceof Dg)h.push(w);else{const Y=Wu(I,H);null!=Y&&(h.push(w),g.set(w,Y))}}const m=new xa(h);return new fQ(g,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function pQ(n,t,e,r){const s=n.da(1,t,e);yk("Data must be an object, but it was:",s,r);const i=[],o=pi.empty();Ou(r,(u,h)=>{const g=OM(t,u,e);h=Yr(h);const m=s.ca(g);if(h instanceof Dg)i.push(g);else{const C=Wu(h,m);null!=C&&(i.push(g),o.set(g,C))}});const c=new xa(i);return new fQ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),zg(s,[o.toMutation(n._key,Dr.exists(!0))])}function $Ce(n){return zg(l1(n.firestore,Mr),[new Sf(n._key,Dr.none())])}function UCe(n,t){const e=l1(n.firestore,Mr),r=JX(n),s=Pk(n.converter,t);return zg(e,[vk(Hf(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,Dr.exists(!1))]).then(()=>r)}function GCe(n,...t){var e,r,s;n=Yr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||mk(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(mk(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,g;if(n instanceof Ms)h=l1(n.firestore,Mr),g=vf(n._key.path),u={next:m=>{t[o]&&t[o](Tk(h,n,m))},error:t[o+1],complete:t[o+2]};else{const m=l1(n,Ui);h=l1(m.firestore,Mr),g=m._query;const C=new O0(h);u={next:w=>{t[o]&&t[o](new Bf(h,C,m,w))},error:t[o+1],complete:t[o+2]},yQ(n._query)}return function(m,C,w,I){const H=new SM(I),Y=new Lx(C,H,w);return m.asyncQueue.enqueueAndForget(A(function*(){return Nx(yield zf(m),Y)})),()=>{H.bc(),m.asyncQueue.enqueueAndForget(A(function*(){return Ix(yield zf(m),Y)}))}}(Bs(h),g,c,u)}function zg(n,t){return function(e,r){const s=new c2;return e.asyncQueue.enqueueAndForget(A(function*(){return function Hve(n,t,e){return Hx.apply(this,arguments)}(yield function pk(n){return PM(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(Bs(n),t)}function Tk(n,t,e){const r=e.docs.get(t._key),s=new O0(n);return new Ff(n,s,t._key,r,new qu(e.hasPendingWrites,e.fromCache),t.converter)}function N0(){return new Ck("serverTimestamp")}function NQ(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===NQ(e[s],r[s]))return!1}return!0}}return n===t}function wk(n){return null==n||function ZCe(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function ibe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function YCe(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===wk(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function vc(n,t){if(wk(n)&&wk(t))return NQ(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}function ye(n,t){if(!1===n)throw Ss.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}!function(n,t=!0){hf="9.14.0",mo(new Fi("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Mr(new pme(e.getProvider("auth-internal")),new _me(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new He(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Au(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),os(NY,"3.7.3",n),os(NY,"3.7.3","esm2017")}();class C4{}class Gi extends C4{static tuple(t,e,r){return new class extends Gi{encodeMove(s){const i=e(s),o={};return Object.keys(i).forEach(c=>{o[c]=t[c].encode(i[c])}),o}decodeMove(s){const i={};return Object.keys(t).reverse().forEach(o=>{ye(null!=s[o],"Invalid encoded value"),i[o]=t[o].decode(s[o])}),r(Object.values(i))}}}static disjunction3(t,e,r,s,i){return new class extends Gi{encodeMove(o){return s(o)?{type:"T",encoded:t.encode(o)}:i(o)?{type:"U",encoded:e.encode(o)}:{type:"V",encoded:r.encode(o)}}decodeMove(o){const c=we.getNonNullable(o).type,u=we.getNonNullable(o).encoded;return"T"===c?t.decode(u):"U"===c?e.decode(u):r.decode(u)}}}encode(t){return this.encodeMove(t)}decode(t){return ye(!1===Array.isArray(t),"MoveEncoder.decode called with an array"),this.decodeMove(t)}}class _n extends Gi{static ofN(t,e,r){return new class extends _n{maxValue(){return t}encodeNumber(s){return e(s)}decodeNumber(s){return r(s)}}}static tuple(t,e,r){return new class extends _n{maxValue(){let s=0;return Object.keys(t).forEach(i=>{s=s*t[i].shift()+t[i].maxValue()}),s}encodeNumber(s){const i=e(s);let o=0;return Object.keys(i).forEach(c=>{o=o*t[c].shift()+t[c].encode(i[c])}),o}decodeNumber(s){const i={};let o=s;return Object.keys(t).reverse().forEach(c=>{const u=o%t[c].shift();o=(o-u)/t[c].shift(),i[c]=t[c].decode(u)}),r(Object.values(i))}}}static disjunction(t,e,r){return new class extends _n{maxValue(){return Math.max(2*t.maxValue(),2*e.maxValue()+1)}encodeNumber(s){return r(s)?2*t.encodeNumber(s):2*e.encodeNumber(s)+1}decodeNumber(s){return s%2==0?t.decodeNumber(s/2):e.decodeNumber((s-1)/2)}}}static numberEncoder(t){return new class extends _n{maxValue(){return t}encodeNumber(e){if(e>t)throw new Error("Cannot encode number bigger than the max with numberEncoder");return e}decodeNumber(e){if(e>t)throw new Error("Cannot decode number bigger than the max with numberEncoder");return e}}}shift(){return this.maxValue()+1}encodeMove(t){return this.encodeNumber(t)}decodeMove(t){return ye("number"==typeof t,"Invalid encoded number"),this.decodeNumber(t)}}_n.booleanEncoder=new class extends _n{maxValue(){return 1}encodeNumber(n){return n?1:0}decodeNumber(n){if(0===n)return!1;if(1===n)return!0;throw new Error("Invalid encoded boolean")}};class P{constructor(t){this.value=t}static of(t){return new P(t)}static ofNullable(t){return null==t?P.empty():P.of(t)}static empty(){return new P(null)}static getEncoder(t){return new class extends C4{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?P.empty():P.of(t.decode(e))}}}static getNumberEncoder(t){return new class extends _n{maxValue(){return t.maxValue()+1}encodeNumber(e){return e.isPresent()?t.encodeNumber(e.get()):t.maxValue()+1}decodeNumber(e){return e===this.maxValue()?P.empty():P.of(t.decodeNumber(e))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&vc(this.value,t.value)}equalsValue(t){return this.equals(P.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?P.of(t(this.get())):P.empty()}}class G{static success(t){return new KCe(t)}static failure(t){return new XCe(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&vc(this.get(),t.get())}}class KCe extends G{constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return P.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class XCe extends G{constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return P.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}class U{constructor(t){this.reason=t}static ofFallible(t){return t.isSuccess()?U.SUCCESS:U.failure(t.getReason())}static failure(t){return new U(t)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(t){return this.isSuccess()?G.success(t):G.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return G.failure(this.getReason())}}U.SUCCESS=new U(null),os("firebase","9.14.0","app");const AQ="@firebase/installations",bk="0.5.16",xQ=`w:${bk}`,kQ="FIS_v2",Rl=new h4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function LQ(n){return n instanceof _c&&n.code.includes("request-failed")}function Ok({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function RQ(n){return{token:n.token,requestStatus:2,expiresIn:iye(n.expiresIn),creationTime:Date.now()}}function Nk(n,t){return Ak.apply(this,arguments)}function Ak(){return Ak=A(function*(n,t){const r=(yield t.json()).error;return Rl.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),Ak.apply(this,arguments)}function DQ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function zQ(n,{refreshToken:t}){const e=DQ(n);return e.append("Authorization",function oye(n){return`${kQ} ${n}`}(t)),e}function Ik(n){return xk.apply(this,arguments)}function xk(){return xk=A(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),xk.apply(this,arguments)}function iye(n){return Number(n.replace("s","000"))}function aye(n,t){return kk.apply(this,arguments)}function kk(){return kk=A(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=Ok(n),s=DQ(n),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:kQ,appId:n.appId,sdkVersion:xQ})},u=yield Ik(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:RQ(h.authToken)}}throw yield Nk("Create Installation",u)}),kk.apply(this,arguments)}function VQ(n){return new Promise(t=>{setTimeout(t,n)})}const lye=/^[cdef][\w-]{21}$/;function uye(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function fye(n){return function cye(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return lye.test(e)?e:""}catch{return""}}function $f(n){return`${n.appName}!${n.appId}`}const Uf=new Map;function HQ(n,t){const e=$f(n);FQ(e,t),function pye(n,t){const e=function BQ(){return!ju&&"BroadcastChannel"in self&&(ju=new BroadcastChannel("[Firebase] FID Change"),ju.onmessage=n=>{FQ(n.data.key,n.data.fid)}),ju}();e&&e.postMessage({key:n,fid:t}),function $Q(){0===Uf.size&&ju&&(ju.close(),ju=null)}()}(e,t)}function FQ(n,t){const e=Uf.get(n);if(e)for(const r of e)r(t)}let ju=null;const Zu="firebase-installations-store";let Rk=null;function Dk(){return Rk||(Rk=mE("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(Zu)}})),Rk}function kM(n,t){return zk.apply(this,arguments)}function zk(){return zk=A(function*(n,t){const e=$f(n),s=(yield Dk()).transaction(Zu,"readwrite"),i=s.objectStore(Zu),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&HQ(n,t.fid),t}),zk.apply(this,arguments)}function Vk(n){return Hk.apply(this,arguments)}function Hk(){return Hk=A(function*(n){const t=$f(n),r=(yield Dk()).transaction(Zu,"readwrite");yield r.objectStore(Zu).delete(t),yield r.done}),Hk.apply(this,arguments)}function Vg(n,t){return Fk.apply(this,arguments)}function Fk(){return Fk=A(function*(n,t){const e=$f(n),s=(yield Dk()).transaction(Zu,"readwrite"),i=s.objectStore(Zu),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&HQ(n,c.fid),c}),Fk.apply(this,arguments)}function Bk(n){return $k.apply(this,arguments)}function $k(){return $k=A(function*(n){let t;const e=yield Vg(n.appConfig,r=>{const s=_ye(r),i=vye(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),$k.apply(this,arguments)}function _ye(n){return GQ(n||{fid:uye(),registrationStatus:0})}function vye(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Rl.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function Cye(n,t){return Uk.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:yye(n)}:{installationEntry:t}}function Uk(){return Uk=A(function*(n,t){try{const e=yield aye(n,t);return kM(n.appConfig,e)}catch(e){throw LQ(e)&&409===e.customData.serverCode?yield Vk(n.appConfig):yield kM(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),Uk.apply(this,arguments)}function yye(n){return Gk.apply(this,arguments)}function Gk(){return Gk=A(function*(n){let t=yield UQ(n.appConfig);for(;1===t.registrationStatus;)yield VQ(100),t=yield UQ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield Bk(n);return r||e}return t}),Gk.apply(this,arguments)}function UQ(n){return Vg(n,t=>{if(!t)throw Rl.create("installation-not-found");return GQ(t)})}function GQ(n){return function Eye(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function Mye(n,t){return Wk.apply(this,arguments)}function Wk(){return Wk=A(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=Sye(n,e),s=zQ(n,e),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:xQ,appId:n.appId}})},u=yield Ik(()=>fetch(r,c));if(u.ok)return RQ(yield u.json());throw yield Nk("Generate Auth Token",u)}),Wk.apply(this,arguments)}function Sye(n,{fid:t}){return`${Ok(n)}/${t}/authTokens:generate`}function qk(n){return jk.apply(this,arguments)}function jk(){return jk=A(function*(n,t=!1){let e;const r=yield Vg(n.appConfig,i=>{if(!qQ(i))throw Rl.create("not-registered");const o=i.authToken;if(!t&&wye(o))return i;if(1===o.requestStatus)return e=Pye(n,t),i;{if(!navigator.onLine)throw Rl.create("app-offline");const c=Oye(i);return e=Tye(n,c),c}});return e?yield e:r.authToken}),jk.apply(this,arguments)}function Pye(n,t){return Zk.apply(this,arguments)}function Zk(){return Zk=A(function*(n,t){let e=yield WQ(n.appConfig);for(;1===e.authToken.requestStatus;)yield VQ(100),e=yield WQ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?qk(n,t):r}),Zk.apply(this,arguments)}function WQ(n){return Vg(n,t=>{if(!qQ(t))throw Rl.create("not-registered");return function Nye(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function Tye(n,t){return Yk.apply(this,arguments)}function Yk(){return Yk=A(function*(n,t){try{const e=yield Mye(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield kM(n.appConfig,r),e}catch(e){if(!LQ(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield kM(n.appConfig,r)}else yield Vk(n.appConfig);throw e}}),Yk.apply(this,arguments)}function qQ(n){return void 0!==n&&2===n.registrationStatus}function wye(n){return 2===n.requestStatus&&!function bye(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function Oye(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function Kk(){return Kk=A(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield Bk(t);return r?r.catch(console.error):qk(t).catch(console.error),e.fid}),Kk.apply(this,arguments)}function Xk(){return Xk=A(function*(n,t=!1){const e=n;return yield xye(e),(yield qk(e,t)).token}),Xk.apply(this,arguments)}function xye(n){return Qk.apply(this,arguments)}function Qk(){return Qk=A(function*(n){const{registrationPromise:t}=yield Bk(n);t&&(yield t)}),Qk.apply(this,arguments)}function tL(n){return Rl.create("missing-app-config-values",{valueName:n})}const jQ="installations",zye=n=>{const t=n.getProvider("app").getImmediate(),e=function Rye(n){if(!n||!n.options)throw tL("App Configuration");if(!n.name)throw tL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw tL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:sf(t,"heartbeat"),_delete:()=>Promise.resolve()}},Vye=n=>{const e=sf(n.getProvider("app").getImmediate(),jQ).getImmediate();return{getId:()=>function Aye(n){return Kk.apply(this,arguments)}(e),getToken:s=>function Iye(n){return Xk.apply(this,arguments)}(e,s)}};(function Hye(){mo(new Fi(jQ,zye,"PUBLIC")),mo(new Fi("installations-internal",Vye,"PRIVATE"))})(),os(AQ,bk),os(AQ,bk,"esm2017");const nL="@firebase/remote-config",ta=new h4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Kye{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return A(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function Xye(n=navigator){return n.languages&&n.languages[0]||n.language}class Qye{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return A(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,g={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:Xye()},C={method:"POST",headers:g,body:JSON.stringify(m)},w=fetch(h,C),I=new Promise((Ae,Fe)=>{t.signal.addEventListener(()=>{const Ze=new Error("The operation was aborted.");Ze.name="AbortError",Fe(Ze)})});let H;try{yield Promise.race([w,I]),H=yield w}catch(Ae){let Fe="fetch-client-network";throw"AbortError"===(null===(r=Ae)||void 0===r?void 0:r.name)&&(Fe="fetch-timeout"),ta.create(Fe,{originalErrorMessage:null===(s=Ae)||void 0===s?void 0:s.message})}let Y=H.status;const ee=H.headers.get("ETag")||void 0;let _e,te;if(200===H.status){let Ae;try{Ae=yield H.json()}catch(Fe){throw ta.create("fetch-client-parse",{originalErrorMessage:null===(i=Fe)||void 0===i?void 0:i.message})}_e=Ae.entries,te=Ae.state}if("INSTANCE_STATE_UNSPECIFIED"===te?Y=500:"NO_CHANGE"===te?Y=304:("NO_TEMPLATE"===te||"EMPTY_CONFIG"===te)&&(_e={}),304!==Y&&200!==Y)throw ta.create("fetch-status",{httpStatus:Y});return{status:Y,eTag:ee,config:_e}})()}}class tEe{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return A(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return A(function*(){yield function Jye(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(ta.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function eEe(n){if(!(n instanceof _c&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+SA(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class sEe{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function RM(n,t){var e;const r=n.target.error||void 0;return ta.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const Yu="app_namespace_store";class cEe{constructor(t,e,r,s=function aEe(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(RM(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(Yu,{keyPath:"compositeKey"})}}catch(r){t(ta.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return A(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([Yu],"readonly").objectStore(Yu),h=e.createCompositeKey(t);try{const g=u.get(h);g.onerror=m=>{i(RM(m,"storage-get"))},g.onsuccess=m=>{const C=m.target.result;s(C?C.value:void 0)}}catch(g){i(ta.create("storage-get",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return A(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([Yu],"readwrite").objectStore(Yu),g=r.createCompositeKey(t);try{const m=h.put({compositeKey:g,value:e});m.onerror=C=>{o(RM(C,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(ta.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return A(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([Yu],"readwrite").objectStore(Yu),h=e.createCompositeKey(t);try{const g=u.delete(h);g.onerror=m=>{i(RM(m,"storage-delete"))},g.onsuccess=()=>{s()}}catch(g){i(ta.create("storage-delete",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class lEe{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return A(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function fEe(){return aL.apply(this,arguments)}function aL(){return(aL=A(function*(){if(!vu())return!1;try{return yield Lp()}catch{return!1}})).apply(this,arguments)}!function uEe(){mo(new Fi("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw ta.create("registration-window");if(!vu())throw ta.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw ta.create("registration-project-id");if(!o)throw ta.create("registration-api-key");if(!c)throw ta.create("registration-app-id");const u=new cEe(c,r.name,e=e||"firebase"),h=new lEe(u),g=new rf(nL);g.logLevel=d1.ERROR;const m=new Qye(s,af,e,i,o,c),C=new tEe(m,u),w=new Kye(C,u,h,g),I=new sEe(r,w,h,u,g);return function jye(n){const t=Yr(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(I),I},"PUBLIC").setMultipleInstances(!0)),os(nL,"0.3.15"),os(nL,"0.3.15","esm2017")}();const hEe="/firebase-messaging-sw.js",dEe="/firebase-cloud-messaging-push-scope",XQ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",QQ="google.c.a.c_id",gEe="google.c.a.c_l",mEe="google.c.a.ts",_Ee="google.c.a.e";var Gf=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(Gf||(Gf={})),Gf))();function Dl(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function vEe(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const cL="fcm_token_details_db",JQ="fcm_token_object_Store";function yEe(n){return lL.apply(this,arguments)}function lL(){return lL=A(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(cL))return null;let t=null;return(yield mE(cL,5,{upgrade:(r=A(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(JQ))return;const h=c.objectStore(JQ),g=yield h.index("fcmSenderId").get(n);if(yield h.clear(),g)if(2===i){const m=g;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:Dl(m.vapidKey)}}}else if(3===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Dl(m.auth),p256dh:Dl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Dl(m.vapidKey)}}}else if(4===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Dl(m.auth),p256dh:Dl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Dl(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield AA(cL),yield AA("fcm_vapid_details_db"),yield AA("undefined"),EEe(t)?t:null;var r}),lL.apply(this,arguments)}function EEe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const Ku="firebase-messaging-store";let uL=null;function fL(){return uL||(uL=mE("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(Ku)}})),uL}function eJ(n){return hL.apply(this,arguments)}function hL(){return hL=A(function*(n){const t=mL(n),r=yield(yield fL()).transaction(Ku).objectStore(Ku).get(t);if(r)return r;{const s=yield yEe(n.appConfig.senderId);if(s)return yield dL(n,s),s}}),hL.apply(this,arguments)}function dL(n,t){return pL.apply(this,arguments)}function pL(){return pL=A(function*(n,t){const e=mL(n),s=(yield fL()).transaction(Ku,"readwrite");return yield s.objectStore(Ku).put(t,e),yield s.done,t}),pL.apply(this,arguments)}function PEe(n){return gL.apply(this,arguments)}function gL(){return gL=A(function*(n){const t=mL(n),r=(yield fL()).transaction(Ku,"readwrite");yield r.objectStore(Ku).delete(t),yield r.done}),gL.apply(this,arguments)}function mL({appConfig:n}){return n.appId}const mi=new h4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function wEe(n,t){return _L.apply(this,arguments)}function _L(){return _L=A(function*(n,t){var e;const r=yield EL(n),s=nJ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(yL(n.appConfig),i)).json()}catch(c){throw mi.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw mi.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw mi.create("token-subscribe-no-token");return o.token}),_L.apply(this,arguments)}function bEe(n,t){return vL.apply(this,arguments)}function vL(){return vL=A(function*(n,t){var e;const r=yield EL(n),s=nJ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${yL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw mi.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw mi.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw mi.create("token-update-no-token");return o.token}),vL.apply(this,arguments)}function tJ(n,t){return CL.apply(this,arguments)}function CL(){return CL=A(function*(n,t){var e;const s={method:"DELETE",headers:yield EL(n)};try{const o=yield(yield fetch(`${yL(n.appConfig)}/${t}`,s)).json();if(o.error)throw mi.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw mi.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),CL.apply(this,arguments)}function yL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function EL(n){return ML.apply(this,arguments)}function ML(){return ML=A(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),ML.apply(this,arguments)}function nJ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==XQ&&(s.web.applicationPubKey=r),s}function NEe(n){return SL.apply(this,arguments)}function SL(){return SL=A(function*(n){const t=yield IEe(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:Dl(t.getKey("auth")),p256dh:Dl(t.getKey("p256dh"))},r=yield eJ(n.firebaseDependencies);if(r){if(xEe(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?AEe(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield tJ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return sJ(n.firebaseDependencies,e)}return sJ(n.firebaseDependencies,e)}),SL.apply(this,arguments)}function rJ(n){return PL.apply(this,arguments)}function PL(){return PL=A(function*(n){const t=yield eJ(n.firebaseDependencies);t&&(yield tJ(n.firebaseDependencies,t.token),yield PEe(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),PL.apply(this,arguments)}function AEe(n,t){return TL.apply(this,arguments)}function TL(){return TL=A(function*(n,t){try{const e=yield bEe(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield dL(n.firebaseDependencies,r),e}catch(e){throw yield rJ(n),e}}),TL.apply(this,arguments)}function sJ(n,t){return wL.apply(this,arguments)}function wL(){return wL=A(function*(n,t){const r={token:yield wEe(n,t),createTime:Date.now(),subscriptionOptions:t};return yield dL(n,r),r.token}),wL.apply(this,arguments)}function IEe(n,t){return bL.apply(this,arguments)}function bL(){return bL=A(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:vEe(t)})}),bL.apply(this,arguments)}function xEe(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function iJ(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function kEe(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function LEe(n,t){!t.data||(n.data=t.data)}(t,n),function REe(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function DEe(n){return"object"==typeof n&&!!n&&QQ in n}function oJ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function OL(n){return mi.create("missing-app-config-values",{valueName:n})}oJ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),oJ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class VEe{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function zEe(n){if(!n||!n.options)throw OL("App Configuration Object");if(!n.name)throw OL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw OL(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function aJ(n){return NL.apply(this,arguments)}function NL(){return NL=A(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(hEe,{scope:dEe}),n.swRegistration.update().catch(()=>{})}catch(e){throw mi.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),NL.apply(this,arguments)}function HEe(n,t){return AL.apply(this,arguments)}function AL(){return AL=A(function*(n,t){if(!t&&!n.swRegistration&&(yield aJ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw mi.create("invalid-sw-registration");n.swRegistration=t}}),AL.apply(this,arguments)}function FEe(n,t){return IL.apply(this,arguments)}function IL(){return IL=A(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=XQ)}),IL.apply(this,arguments)}function xL(){return xL=A(function*(n,t){if(!navigator)throw mi.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw mi.create("permission-blocked");return yield FEe(n,t?.vapidKey),yield HEe(n,t?.serviceWorkerRegistration),NEe(n)}),xL.apply(this,arguments)}function BEe(n,t,e){return kL.apply(this,arguments)}function kL(){return kL=A(function*(n,t,e){const r=$Ee(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[QQ],message_name:e[gEe],message_time:e[mEe],message_device_time:Math.floor(Date.now()/1e3)})}),kL.apply(this,arguments)}function $Ee(n){switch(n){case Gf.NOTIFICATION_CLICKED:return"notification_open";case Gf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function LL(){return LL=A(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===Gf.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(iJ(e)):n.onMessageHandler.next(iJ(e)));const r=e.data;DEe(r)&&"1"===r[_Ee]&&(yield BEe(n,e.messageType,r))}),LL.apply(this,arguments)}const lJ="@firebase/messaging",GEe=n=>{const t=new VEe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function UEe(n,t){return LL.apply(this,arguments)}(t,e)),t},WEe=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function cJ(n,t){return xL.apply(this,arguments)}(t,r)}};function fJ(){return RL.apply(this,arguments)}function RL(){return(RL=A(function*(){try{yield Lp()}catch{return!1}return typeof window<"u"&&vu()&&CA()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function qEe(){mo(new Fi("messaging",GEe,"PUBLIC")),mo(new Fi("messaging-internal",WEe,"PRIVATE")),os(lJ,"0.11.0"),os(lJ,"0.11.0","esm2017")}();const DM="analytics",YEe="firebase_id",QEe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",hJ="https://www.googletagmanager.com/gtag/js",_i=new rf("@firebase/analytics");function dJ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function JEe(n,t){const e=document.createElement("script");e.src=`${hJ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function tMe(n,t,e,r,s,i){return VL.apply(this,arguments)}function VL(){return VL=A(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield dJ(e)).find(h=>h.measurementId===s);u&&(yield t[u.appId])}}catch(c){_i.error(c)}n("config",s,i)}),VL.apply(this,arguments)}function nMe(n,t,e,r,s){return HL.apply(this,arguments)}function HL(){return HL=A(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield dJ(e);for(const u of o){const h=c.find(m=>m.measurementId===u),g=h&&t[h.appId];if(!g){i=[];break}i.push(g)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){_i.error(i)}}),HL.apply(this,arguments)}function iMe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(hJ)&&e.src.includes(n))return e;return null}const ka=new h4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),pJ=new class lMe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function uMe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function fMe(n){return FL.apply(this,arguments)}function FL(){return FL=A(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:uMe(r)},i=QEe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw ka.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),FL.apply(this,arguments)}function hMe(n){return BL.apply(this,arguments)}function BL(){return BL=A(function*(n,t=pJ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw ka.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ka.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new gMe;return setTimeout(A(function*(){c.abort()}),void 0!==e?e:6e4),gJ({appId:r,apiKey:s,measurementId:i},o,c,t)}),BL.apply(this,arguments)}function gJ(n,t,e){return $L.apply(this,arguments)}function $L(){return $L=A(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=pJ){var i,o;const{appId:c,measurementId:u}=n;try{yield dMe(r,t)}catch(h){if(u)return _i.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield fMe(n);return s.deleteThrottleMetadata(c),h}catch(h){const g=h;if(!pMe(g)){if(s.deleteThrottleMetadata(c),u)return _i.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=g?.customData)||void 0===o?void 0:o.httpStatus)?SA(e,s.intervalMillis,30):SA(e,s.intervalMillis),C={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,C),_i.debug(`Calling attemptFetch again in ${m} millis`),gJ(n,C,r,s)}}),$L.apply(this,arguments)}function dMe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(ka.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function pMe(n){if(!(n instanceof _c&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class gMe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let UL,YL;function GL(){return GL=A(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),GL.apply(this,arguments)}function mJ(n){YL=n}function _J(n){UL=n}function EMe(){return KL.apply(this,arguments)}function KL(){return KL=A(function*(){var n;if(!vu())return _i.warn(ka.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Lp()}catch(t){return _i.warn(ka.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),KL.apply(this,arguments)}function XL(){return XL=A(function*(n,t,e,r,s,i,o){var c;const u=hMe(n);u.then(w=>{e[w.measurementId]=w.appId,n.options.measurementId&&w.measurementId!==n.options.measurementId&&_i.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>_i.error(w)),t.push(u);const h=EMe().then(w=>{if(w)return r.getId()}),[g,m]=yield Promise.all([u,h]);iMe(i)||JEe(i,g.measurementId),YL&&(s("consent","default",YL),mJ(void 0)),s("js",new Date);const C=null!==(c=o?.config)&&void 0!==c?c:{};return C.origin="firebase",C.update=!0,null!=m&&(C[YEe]=m),s("config",g.measurementId,C),UL&&(s("set",UL),_J(void 0)),g.measurementId}),XL.apply(this,arguments)}class SMe{constructor(t){this.app=t}_delete(){return delete zl[this.app.options.appId],Promise.resolve()}}let zl={},vJ=[];const CJ={};let EJ,Vl,zM="dataLayer",QL=!1;function TMe(n,t,e){!function PMe(){const n=[];if(vA()&&n.push("This is a browser extension environment."),CA()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=ka.create("invalid-analytics-context",{errorInfo:t});_i.warn(e.message)}}();const r=n.options.appId;if(!r)throw ka.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw ka.create("no-api-key");_i.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=zl[r])throw ka.create("already-exists",{id:r});if(!QL){!function eMe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(zM);const{wrappedGtag:i,gtagCore:o}=function sMe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function rMe(n,t,e,r){function i(){return(i=A(function*(o,c,u){try{"event"===o?yield nMe(n,t,e,c,u):"config"===o?yield tMe(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){_i.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(zl,vJ,CJ,zM,"gtag");Vl=i,EJ=o,QL=!0}return zl[r]=function MMe(n,t,e,r,s,i,o){return XL.apply(this,arguments)}(n,vJ,CJ,t,EJ,zM,e),new SMe(n)}function bMe(){return JL.apply(this,arguments)}function JL(){return(JL=A(function*(){if(vA()||!CA()||!vu())return!1;try{return yield Lp()}catch{return!1}})).apply(this,arguments)}const MJ="@firebase/analytics";!function NMe(){mo(new Fi(DM,(t,{options:e})=>TMe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),mo(new Fi("analytics-internal",function n(t){try{const e=t.getProvider(DM).getImmediate();return{logEvent:(r,s,i)=>function OMe(n,t,e,r){n=Yr(n),function mMe(n,t,e,r,s){return GL.apply(this,arguments)}(Vl,zl[n.app.options.appId],t,e,r).catch(s=>_i.error(s))}(e,r,s,i)}}catch(e){throw ka.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),os(MJ,"0.8.4"),os(MJ,"0.8.4","esm2017")}();class AMe extends G1{constructor(t,e){super()}schedule(t,e=0){return this}}const VM={setInterval(n,t,...e){const{delegate:r}=VM;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=VM;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class PJ extends AMe{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return VM.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&VM.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Dc(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const eR={now:()=>(eR.delegate||Date).now(),delegate:void 0};class Hg{constructor(t,e=Hg.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}Hg.now=eR.now;class TJ extends Hg{constructor(t,e=Hg.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const kMe=new class xMe extends TJ{}(class IMe extends PJ{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),LMe=new TJ(PJ),HM=new U6("7.4.1"),tR="__angularfire_symbol__analyticsIsSupportedValue",nR="__angularfire_symbol__analyticsIsSupported",rR="__angularfire_symbol__remoteConfigIsSupportedValue",sR="__angularfire_symbol__remoteConfigIsSupported",iR="__angularfire_symbol__messagingIsSupportedValue",oR="__angularfire_symbol__messagingIsSupported";function cR(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[nR]||(globalThis[nR]=bMe().then(n=>globalThis[tR]=n).catch(()=>globalThis[tR]=!1)),globalThis[oR]||(globalThis[oR]=fJ().then(n=>globalThis[iR]=n).catch(()=>globalThis[iR]=!1)),globalThis[sR]||(globalThis[sR]=fEe().then(n=>globalThis[rR]=n).catch(()=>globalThis[rR]=!1));const lR=(n,t)=>{const e=t?[t]:cZ(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function Wf(){}class wJ{constructor(t,e=kMe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class RMe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Wf,{},Wf,Wf)),e.pipe(li({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let uR=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new wJ(Zone.current)),this.insideAngular=e.run(()=>new wJ(Zone.current,LMe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(Le(Er))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Xu(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function DMe(n){return Xu().ngZone.runOutsideAngular(()=>n())}function Qu(n){return Xu().ngZone.run(()=>n())}function zMe(n){return Xu(),function VMe(n){return function(e){return(e=e.lift(new RMe(n.ngZone))).pipe(Qa(n.outsideAngular),U4(n.insideAngular))}}(Xu())(n)}const HMe=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),Qu(()=>n.apply(void 0,r))},Sr=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=Qu(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Wf,{},Wf,Wf)))),r[i]=HMe(r[i],e));const s=DMe(()=>n.apply(this,r));if(!t){if(s instanceof vr){const i=Xu();return s.pipe(Qa(i.outsideAngular),U4(i.insideAngular))}return Qu(()=>s)}return s instanceof vr?s.pipe(zMe):s instanceof Promise?Qu(()=>new Promise((i,o)=>s.then(c=>Qu(()=>i(c)),c=>Qu(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:Qu(()=>s)};class qf{constructor(t){return t}}class fR{constructor(){return cZ()}}const hR=new It("angularfire2._apps"),BMe={provide:qf,useFactory:function FMe(n){return n&&1===n.length?n[0]:new qf(kA())},deps:[[new r2,hR]]},$Me={provide:fR,deps:[[new r2,hR]]};function UMe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new qf(r)}}let GMe=(()=>{class n{constructor(e){os("angularfire",HM.full,"core"),os("angularfire",HM.full,"app"),os("angular",pv.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(Le(Yd))},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:[BMe,$Me]}),n})();const qMe=Sr(aZ,!0),dR=new Map,bJ={activated:!1,tokenObservers:[]},jMe={initialized:!1,enabled:!1};function vi(n){return dR.get(n)||Object.assign({},bJ)}function FM(){return jMe}class JMe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return A(function*(){e.stop();try{e.pending=new dE,yield function eSe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new dE,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const yo=new h4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function NJ(n){if(!vi(n).activated)throw yo.create("use-before-activation",{appName:n.name})}function mR(n,t){return _R.apply(this,arguments)}function _R(){return _R=A(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const w=yield o.getHeartbeatsHeader();w&&(i["X-Firebase-Client"]=w)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,c)}catch(w){throw yo.create("fetch-network-error",{originalErrorMessage:null===(r=w)||void 0===r?void 0:r.message})}if(200!==u.status)throw yo.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(w){throw yo.create("fetch-parse-error",{originalErrorMessage:null===(s=w)||void 0===s?void 0:s.message})}const g=h.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw yo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(g[1]),C=Date.now();return{token:h.token,expireTimeMillis:C+m,issuedAtTimeMillis:C}}),_R.apply(this,arguments)}function sSe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const Fg="firebase-app-check-store";let UM=null;function IJ(){return UM||(UM=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t(yo.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(Fg,{keyPath:"compositeKey"})}}catch(r){t(yo.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),UM)}function vR(){return vR=A(function*(n,t){const r=(yield IJ()).transaction(Fg,"readwrite"),i=r.objectStore(Fg).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c(yo.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),vR.apply(this,arguments)}const Bg=new rf("@firebase/app-check");function ER(n,t){return vu()?function cSe(n,t){return function xJ(n,t){return vR.apply(this,arguments)}(function LJ(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{Bg.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function RJ(){return FM().enabled}function DJ(){return SR.apply(this,arguments)}function SR(){return SR=A(function*(){const n=FM();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),SR.apply(this,arguments)}const pSe={error:"UNKNOWN_ERROR"};function gSe(n){return _A.encodeString(JSON.stringify(n),!1)}function GM(n){return PR.apply(this,arguments)}function PR(){return PR=A(function*(n,t=!1){const e=n.app;NJ(e);const r=vi(e);let i,s=r.token;if(s&&!jf(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(jf(u)?s=u:yield ER(e,void 0))}if(!t&&s&&jf(s))return{token:s.token};let c,o=!1;if(RJ()){r.exchangeTokenPromise||(r.exchangeTokenPromise=mR(sSe(e,yield DJ()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield ER(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield vi(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?Bg.warn(u.message):Bg.error(u),i=u}return s?i?c=jf(s)?{token:s.token,internalError:i}:HJ(i):(c={token:s.token},r.token=s,yield ER(e,s)):c=HJ(i),o&&VJ(e,c),c}),PR.apply(this,arguments)}function wR(n,t){const e=vi(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function zJ(n){const{app:t}=n,e=vi(t);let r=e.tokenRefresher;r||(r=function mSe(n){const{app:t}=n;return new JMe(A(function*(){let r;if(r=vi(t).token?yield GM(n,!0):yield GM(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=vi(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function VJ(n,t){const e=vi(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function jf(n){return n.expireTimeMillis-Date.now()>0}function HJ(n){return{token:gSe(pSe),error:n}}class _Se{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=vi(this.app);for(const e of t)wR(this.app,e.next);return Promise.resolve()}}const jJ="app-check-internal";!function ISe(){mo(new Fi("app-check",n=>function vSe(n,t){return new _Se(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(jJ).initialize()})),mo(new Fi(jJ,n=>function CSe(n){return{getToken:t=>GM(n,t),addTokenListener:t=>function TR(n,t,e,r){const{app:s}=n,i=vi(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&jf(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),zJ(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>zJ(n))}(n,"INTERNAL",t),removeTokenListener:t=>wR(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),os("@firebase/app-check","0.5.17")}();class AR{constructor(){return lR("app-check")}}typeof window<"u"&&window;const DSe=function YJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},KJ=new h4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),XJ=new rf("@firebase/auth");function qM(n,...t){XJ.logLevel<=d1.ERROR&&XJ.error(`Auth (${af}): ${n}`,...t)}function na(n,...t){throw xR(n,...t)}function La(n,...t){return xR(n,...t)}function QJ(n,t,e){const r=Object.assign(Object.assign({},DSe()),{[t]:e});return new h4("auth","Firebase",r).create(t,{appName:n.name})}function Zf(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&na(n,"argument-error"),QJ(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xR(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return KJ.create(n,...t)}function Qe(n,t,...e){if(!n)throw xR(t,...e)}function y4(n){const t="INTERNAL ASSERTION FAILED: "+n;throw qM(t),new Error(t)}function Hl(n,t){n||y4(t)}const JJ=new Map;function Fl(n){Hl(n instanceof Function,"Expected a class definition");let t=JJ.get(n);return t?(Hl(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,JJ.set(n,t),t)}function $g(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function eee(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class Ug{constructor(t,e){this.shortDelay=t,this.longDelay=e,Hl(e>t,"Short delay should be less than long delay!"),this.isMobile=function Vde(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(A2())}()||function Fde(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function HSe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function kR(){return"http:"===eee()||"https:"===eee()}()||vA()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function LR(n,t){Hl(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class tee{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void y4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void y4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void y4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const BSe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},$Se=new Ug(3e4,6e4);function u2(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function D2(n,t,e,r){return RR.apply(this,arguments)}function RR(){return RR=A(function*(n,t,e,r,s={}){return nee(n,s,A(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=Rp(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),tee.fetch()(ree(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),RR.apply(this,arguments)}function nee(n,t,e){return DR.apply(this,arguments)}function DR(){return DR=A(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},BSe),t);try{const s=new USe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw Gg(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw Gg(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw Gg(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw Gg(n,"user-disabled",o);const g=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw QJ(n,g,h);na(n,g)}}catch(s){if(s instanceof _c)throw s;na(n,"network-request-failed")}}),DR.apply(this,arguments)}function Bl(n,t,e,r){return zR.apply(this,arguments)}function zR(){return zR=A(function*(n,t,e,r,s={}){const i=yield D2(n,t,e,r,s);return"mfaPendingCredential"in i&&na(n,"multi-factor-auth-required",{_serverResponse:i}),i}),zR.apply(this,arguments)}function ree(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?LR(n.config,s):`${n.config.apiScheme}://${s}`}class USe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(La(this.auth,"network-request-failed")),$Se.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Gg(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=La(n,t,r);return s.customData._tokenResponse=e,s}function VR(){return VR=A(function*(n,t){return D2(n,"POST","/v1/accounts:delete",t)}),VR.apply(this,arguments)}function qSe(n,t){return FR.apply(this,arguments)}function FR(){return FR=A(function*(n,t){return D2(n,"POST","/v1/accounts:lookup",t)}),FR.apply(this,arguments)}function Wg(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function BR(){return BR=A(function*(n,t=!1){const e=Yr(n),r=yield e.getIdToken(t),s=jM(r);Qe(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:Wg($R(s.auth_time)),issuedAtTime:Wg($R(s.iat)),expirationTime:Wg($R(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),BR.apply(this,arguments)}function $R(n){return 1e3*Number(n)}function jM(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return qM("JWT malformed, contained fewer than 3 sections"),null;try{const i=hE(r);return i?JSON.parse(i):(qM("Failed to decode base64 JWT payload"),null)}catch(i){return qM("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function $l(n,t){return UR.apply(this,arguments)}function UR(){return UR=A(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof _c&&YSe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),UR.apply(this,arguments)}function YSe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class KSe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(A(function*(){yield e.iteration()}),r)}iteration(){var t=this;return A(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class see{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wg(this.lastLoginAt),this.creationTime=Wg(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function qg(n){return GR.apply(this,arguments)}function GR(){return GR=A(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield $l(n,qSe(e,{idToken:r}));Qe(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?JSe(i.providerUserInfo):[],c=QSe(n.providerData,o),g=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new see(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,m)}),GR.apply(this,arguments)}function WR(){return WR=A(function*(n){const t=Yr(n);yield qg(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),WR.apply(this,arguments)}function QSe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function JSe(n){return n.map(t=>{var{providerId:e}=t,r=y5(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function qR(){return qR=A(function*(n,t){const e=yield nee(n,{},A(function*(){const r=Rp({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=ree(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",tee.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),qR.apply(this,arguments)}class jg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Qe(t.idToken,"internal-error"),Qe(typeof t.idToken<"u","internal-error"),Qe(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function ZSe(n){const t=jM(n);return Qe(t,"internal-error"),Qe(typeof t.exp<"u","internal-error"),Qe(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return A(function*(){return Qe(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return A(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function ePe(n,t){return qR.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new jg;return r&&(Qe("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(Qe("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(Qe("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new jg,this.toJSON())}_performRefresh(){return y4("not implemented")}}function A0(n,t){Qe("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class Ju{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=y5(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new KSe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new see(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return A(function*(){const r=yield $l(e,e.stsTokenManager.getToken(e.auth,t));return Qe(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function jSe(n){return BR.apply(this,arguments)}(this,t)}reload(){return function XSe(n){return WR.apply(this,arguments)}(this)}_assign(t){this!==t&&(Qe(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new Ju(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){Qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return A(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield qg(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return A(function*(){const e=yield t.getIdToken();return yield $l(t,function GSe(n,t){return VR.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,h,g;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,C=null!==(s=e.email)&&void 0!==s?s:void 0,w=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,I=null!==(o=e.photoURL)&&void 0!==o?o:void 0,H=null!==(c=e.tenantId)&&void 0!==c?c:void 0,Y=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,ee=null!==(h=e.createdAt)&&void 0!==h?h:void 0,_e=null!==(g=e.lastLoginAt)&&void 0!==g?g:void 0,{uid:te,emailVerified:Ae,isAnonymous:Fe,providerData:Ze,stsTokenManager:zt}=e;Qe(te&&zt,t,"internal-error");const k1=jg.fromJSON(this.name,zt);Qe("string"==typeof te,t,"internal-error"),A0(m,t.name),A0(C,t.name),Qe("boolean"==typeof Ae,t,"internal-error"),Qe("boolean"==typeof Fe,t,"internal-error"),A0(w,t.name),A0(I,t.name),A0(H,t.name),A0(Y,t.name),A0(ee,t.name),A0(_e,t.name);const w1=new Ju({uid:te,auth:t,email:C,emailVerified:Ae,displayName:m,isAnonymous:Fe,photoURL:I,phoneNumber:w,tenantId:H,stsTokenManager:k1,createdAt:ee,lastLoginAt:_e});return Ze&&Array.isArray(Ze)&&(w1.providerData=Ze.map(es=>Object.assign({},es))),Y&&(w1._redirectEventId=Y),w1}static _fromIdTokenResponse(t,e,r=!1){return A(function*(){const s=new jg;s.updateFromServerResponse(e);const i=new Ju({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield qg(i),i})()}}const iee=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(function*(){return!0})()}_set(e,r){var s=this;return A(function*(){s.storage[e]=r})()}_get(e){var r=this;return A(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return A(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function ZM(n,t,e){return`firebase:${n}:${t}:${e}`}class Yf{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ZM(this.userKey,s.apiKey,i),this.fullPersistenceKey=ZM("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return A(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?Ju._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return A(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return A(function*(){if(!e.length)return new Yf(Fl(iee),t,r);const s=(yield Promise.all(e.map(function(){var h=A(function*(g){if(yield g._isAvailable())return g});return function(g){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||Fl(iee);const o=ZM(r,t.config.apiKey,t.name);let c=null;for(const h of e)try{const g=yield h._get(o);if(g){const m=Ju._fromJSON(t,g);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var h=A(function*(g){if(g!==i)try{yield g._remove(o)}catch{}});return function(g){return h.apply(this,arguments)}}())),new Yf(i,t,r)):new Yf(i,t,r)})()}}function oee(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(lee(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(aee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(fee(t))return"Blackberry";if(hee(t))return"Webos";if(jR(t))return"Safari";if((t.includes("chrome/")||cee(t))&&!t.includes("edge/"))return"Chrome";if(uee(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function aee(n=A2()){return/firefox\//i.test(n)}function jR(n=A2()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function cee(n=A2()){return/crios\//i.test(n)}function lee(n=A2()){return/iemobile/i.test(n)}function uee(n=A2()){return/android/i.test(n)}function fee(n=A2()){return/blackberry/i.test(n)}function hee(n=A2()){return/webos/i.test(n)}function YM(n=A2()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function dee(n=A2()){return YM(n)||uee(n)||hee(n)||fee(n)||/windows phone/i.test(n)||lee(n)}function pee(n,t=[]){let e;switch(n){case"Browser":e=oee(A2());break;case"Worker":e=`${oee(A2())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${af}/${r}`}class sPe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return A(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class iPe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gee(this),this.idTokenSubscription=new gee(this),this.beforeStateQueue=new sPe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=KJ,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=Fl(e)),this._initializationPromise=this.queue(A(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield Yf.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return A(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return A(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield e.tryRedirectSignIn(t);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return Qe(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return A(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return A(function*(){var r;try{yield qg(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function FSe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return A(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return A(function*(){const r=t?Yr(t):null;return r&&Qe(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return A(function*(){if(!r._deleted)return t&&Qe(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(A(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return A(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(A(function*(){yield e.assertedPersistence.setPersistence(Fl(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new h4("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return A(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return A(function*(){if(!e.redirectPersistenceManager){const r=t&&Fl(t)||e._popupRedirectResolver;Qe(r,e,"argument-error"),e.redirectPersistenceManager=yield Yf.create(e,[Fl(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return A(function*(){var r,s;return e._isInitialized&&(yield e.queue(A(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return A(function*(){if(t===e.currentUser)return e.queue(A(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Qe(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return A(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=pee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return A(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function ra(n){return Yr(n)}class gee{constructor(t){this.auth=t,this.observer=null,this.addObserver=function Jde(n,t){const e=new epe(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return Qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function mee(n,t,e){const r=ra(n);Qe(r._canInitEmulator,r,"emulator-config-failed"),Qe(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=_ee(t),{host:o,port:c}=function oPe(n){const t=_ee(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:vee(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:vee(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function aPe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function _ee(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function vee(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class ZR{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return y4("not implemented")}_getIdTokenResponse(t){return y4("not implemented")}_linkToIdToken(t,e){return y4("not implemented")}_getReauthenticationResolver(t){return y4("not implemented")}}function KR(){return KR=A(function*(n,t){return D2(n,"POST","/v1/accounts:update",t)}),KR.apply(this,arguments)}function QR(){return QR=A(function*(n,t){return Bl(n,"POST","/v1/accounts:signInWithPassword",u2(n,t))}),QR.apply(this,arguments)}function KM(n,t){return JR.apply(this,arguments)}function JR(){return JR=A(function*(n,t){return D2(n,"POST","/v1/accounts:sendOobCode",u2(n,t))}),JR.apply(this,arguments)}function uPe(n,t){return eD.apply(this,arguments)}function eD(){return eD=A(function*(n,t){return KM(n,t)}),eD.apply(this,arguments)}function fPe(n,t){return tD.apply(this,arguments)}function tD(){return tD=A(function*(n,t){return KM(n,t)}),tD.apply(this,arguments)}function sD(){return sD=A(function*(n,t){return Bl(n,"POST","/v1/accounts:signInWithEmailLink",u2(n,t))}),sD.apply(this,arguments)}function iD(){return iD=A(function*(n,t){return Bl(n,"POST","/v1/accounts:signInWithEmailLink",u2(n,t))}),iD.apply(this,arguments)}class Zg extends ZR{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new Zg(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new Zg(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return A(function*(){switch(e.signInMethod){case"password":return function lPe(n,t){return QR.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function pPe(n,t){return sD.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:na(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return A(function*(){switch(r.signInMethod){case"password":return function yee(n,t){return KR.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function gPe(n,t){return iD.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:na(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function Ul(n,t){return oD.apply(this,arguments)}function oD(){return oD=A(function*(n,t){return Bl(n,"POST","/v1/accounts:signInWithIdp",u2(n,t))}),oD.apply(this,arguments)}class Kf extends ZR{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Kf(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):na("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=y5(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Kf(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return Ul(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,Ul(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Ul(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Rp(e)}return t}}class Kg{constructor(t){var e,r,s,i,o,c;const u=Dp(zp(t)),h=null!==(e=u.apiKey)&&void 0!==e?e:null,g=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function MPe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);Qe(h&&g&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=g,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function SPe(n){const t=Dp(zp(n)).link,e=t?Dp(zp(t)).deep_link_id:null,r=Dp(zp(n)).deep_link_id;return(r?Dp(zp(r)).link:null)||r||e||t||n}(t);try{return new Kg(e)}catch{return null}}}let Eee=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return Zg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=Kg.parseLink(r);return Qe(s,"argument-error"),Zg._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class I0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Mee extends I0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let PPe=(()=>{class n extends Mee{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Kf._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function See(n,t){return hD.apply(this,arguments)}function hD(){return hD=A(function*(n,t){return Bl(n,"POST","/v1/accounts:signUp",u2(n,t))}),hD.apply(this,arguments)}class Cc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return A(function*(){const i=yield Ju._fromIdTokenResponse(t,r,s),o=Pee(r);return new Cc({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return A(function*(){yield t._updateTokensIfNecessary(r,!0);const s=Pee(r);return new Cc({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function Pee(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class QM extends _c{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,QM.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new QM(t,e,r,s)}}function Tee(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?QM._fromErrorAndOperation(n,i,t,r):i})}function gD(n,t){return mD.apply(this,arguments)}function mD(){return mD=A(function*(n,t,e=!1){const r=yield $l(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return Cc._forOperation(n,"link",r)}),mD.apply(this,arguments)}function vD(){return vD=A(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield $l(n,Tee(s,i,t,n),e);Qe(o.idToken,s,"internal-error");const c=jM(o.idToken);Qe(c,s,"internal-error");const{sub:u}=c;return Qe(n.uid===u,s,"user-mismatch"),Cc._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&na(s,"user-mismatch"),o}}),vD.apply(this,arguments)}function Oee(n,t){return CD.apply(this,arguments)}function CD(){return CD=A(function*(n,t,e=!1){const r="signIn",s=yield Tee(n,r,t),i=yield Cc._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),CD.apply(this,arguments)}function ED(){return ED=A(function*(n,t){return Oee(ra(n),t)}),ED.apply(this,arguments)}function eS(n,t,e){var r;Qe((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),Qe(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(Qe(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(Qe(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function APe(n,t,e){return OD.apply(this,arguments)}function OD(){return OD=A(function*(n,t,e){const r=Yr(n),s={requestType:"PASSWORD_RESET",email:t};e&&eS(r,s,e),yield fPe(r,s)}),OD.apply(this,arguments)}function xPe(n,t,e){return kD.apply(this,arguments)}function kD(){return kD=A(function*(n,t,e){const r=ra(n),s=yield See(r,{returnSecureToken:!0,email:t,password:e}),i=yield Cc._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),kD.apply(this,arguments)}function kPe(n,t,e){return function yD(n,t){return ED.apply(this,arguments)}(Yr(n),Eee.credential(t,e))}function RPe(n,t){return VD.apply(this,arguments)}function VD(){return VD=A(function*(n,t){const e=Yr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&eS(e.auth,s,t);const{email:i}=yield uPe(e.auth,s);i!==n.email&&(yield n.reload())}),VD.apply(this,arguments)}function DPe(n,t){return FD.apply(this,arguments)}function FD(){return FD=A(function*(n,t){return D2(n,"POST","/v1/accounts:update",t)}),FD.apply(this,arguments)}function zPe(n,t){return BD.apply(this,arguments)}function BD(){return BD=A(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=Yr(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield $l(r,DPe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),BD.apply(this,arguments)}function WPe(n,t,e,r){return Yr(n).onAuthStateChanged(t,e,r)}const tS="__sak";class Aee{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(tS,"1"),this.storage.removeItem(tS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const QPe=(()=>{class n extends Aee{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function YPe(){const n=A2();return jR(n)||YM(n)}()&&function rPe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=dee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function nPe(){return function Bde(){const n=A2();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return A(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return A(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return A(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),Iee=(()=>{class n extends Aee{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let eTe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return A(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=A(function*(C){return C(s.origin,c)});return function(C){return m.apply(this,arguments)}}()),g=yield function JPe(n){return Promise.all(n.map(function(){var t=A(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function nS(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class tTe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return A(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const g=nS("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(C){const w=C;if(w.data.eventId===g)switch(w.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:g,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function f2(){return window}function ZD(){return typeof f2().WorkerGlobalScope<"u"&&"function"==typeof f2().importScripts}function YD(){return(YD=A(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const xee="firebaseLocalStorageDb",rS="firebaseLocalStorage",kee="fbase_key";class Qg{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function sS(n,t){return n.transaction([rS],t?"readwrite":"readonly").objectStore(rS)}function KD(){const n=indexedDB.open(xee,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(rS,{keyPath:kee})}catch(s){e(s)}}),n.addEventListener("success",A(function*(){const r=n.result;r.objectStoreNames.contains(rS)?t(r):(r.close(),yield function aTe(){const n=indexedDB.deleteDatabase(xee);return new Qg(n).toPromise()}(),t(yield KD()))}))})}function Lee(n,t,e){return XD.apply(this,arguments)}function XD(){return XD=A(function*(n,t,e){const r=sS(n,!0).put({[kee]:t,value:e});return new Qg(r).toPromise()}),XD.apply(this,arguments)}function QD(){return QD=A(function*(n,t){const e=sS(n,!1).get(t),r=yield new Qg(e).toPromise();return void 0===r?null:r.value}),QD.apply(this,arguments)}function Ree(n,t){const e=sS(n,!0).delete(t);return new Qg(e).toPromise()}const fTe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return A(function*(){return e.db||(e.db=yield KD()),e.db})()}_withRetries(e){var r=this;return A(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return A(function*(){return ZD()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return A(function*(){e.receiver=eTe._getInstance(function iTe(){return ZD()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=A(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=A(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return A(function*(){var r,s;if(e.activeServiceWorker=yield function rTe(){return YD.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new tTe(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return A(function*(){if(r.sender&&r.activeServiceWorker&&function sTe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return A(function*(){try{if(!indexedDB)return!1;const e=yield KD();return yield Lee(e,tS,"1"),yield Ree(e,tS),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return A(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return A(function*(){return s._withPendingWrite(A(function*(){return yield s._withRetries(i=>Lee(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return A(function*(){const s=yield r._withRetries(i=>function cTe(n,t){return QD.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return A(function*(){return r._withPendingWrite(A(function*(){return yield r._withRetries(s=>Ree(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return A(function*(){const r=yield e._withRetries(o=>{const c=sS(o,!1).getAll();return new Qg(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(A(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function zee(n){return`__${n}${Math.floor(1e6*Math.random())}`}function t5(n,t){return t?Fl(t):(Qe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}zee("rcb"),new Ug(3e4,6e4);class cz extends ZR{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ul(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Ul(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Ul(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function OTe(n){return Oee(n.auth,new cz(n),n.bypassAuthState)}function NTe(n){const{auth:t,user:e}=n;return Qe(e,t,"internal-error"),function bee(n,t){return vD.apply(this,arguments)}(e,new cz(n),n.bypassAuthState)}function ATe(n){return lz.apply(this,arguments)}function lz(){return lz=A(function*(n){const{auth:t,user:e}=n;return Qe(e,t,"internal-error"),gD(e,new cz(n),n.bypassAuthState)}),lz.apply(this,arguments)}class Hee{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=A(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return A(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const h={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(h))}catch(g){e.reject(g)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return OTe;case"linkViaPopup":case"linkViaRedirect":return ATe;case"reauthViaPopup":case"reauthViaRedirect":return NTe;default:na(this.auth,"internal-error")}}resolve(t){Hl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Hl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ITe=new Ug(2e3,1e4);function xTe(n,t,e){return uz.apply(this,arguments)}function uz(){return uz=A(function*(n,t,e){const r=ra(n);Zf(n,t,I0);const s=t5(r,e);return new dz(r,"signInViaPopup",t,s).executeNotNull()}),uz.apply(this,arguments)}let dz=(()=>{class n extends Hee{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return A(function*(){const r=yield e.execute();return Qe(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return A(function*(){Hl(1===e.filter.length,"Popup operations only handle one event");const r=nS();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject(La(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,ITe.get())};e()}}return n.currentPopupAction=null,n})();const Jg=new Map;class LTe extends Hee{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return A(function*(){let r=Jg.get(e.auth._key());if(!r){try{const i=(yield function RTe(n,t){return pz.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}Jg.set(e.auth._key(),r)}return e.bypassAuthState||Jg.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return A(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return A(function*(){})()}cleanUp(){}}function pz(){return pz=A(function*(n,t){const e=Bee(t),r=Fee(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),pz.apply(this,arguments)}function DTe(n,t){Jg.set(n._key(),t)}function Fee(n){return Fl(n._redirectPersistence)}function Bee(n){return ZM("pendingRedirect",n.config.apiKey,n.name)}function $ee(n,t){return Ez.apply(this,arguments)}function Ez(){return Ez=A(function*(n,t,e=!1){const r=ra(n),s=t5(r,t),o=yield new LTe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),Ez.apply(this,arguments)}class BTe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function $Te(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wee(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!Wee(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(La(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gee(t))}saveEventToCache(t){this.cachedEventUids.add(Gee(t)),this.lastProcessedEventTime=Date.now()}}function Gee(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function Wee({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function UTe(n){return Sz.apply(this,arguments)}function Sz(){return Sz=A(function*(n,t={}){return D2(n,"GET","/v1/projects",t)}),Sz.apply(this,arguments)}const GTe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,WTe=/^https?/;function Pz(){return Pz=A(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield UTe(n);for(const e of t)try{if(jTe(e))return}catch{}na(n,"unauthorized-domain")}),Pz.apply(this,arguments)}function jTe(n){const t=$g(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!WTe.test(e))return!1;if(GTe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const ZTe=new Ug(3e4,6e4);function qee(){const n=f2().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let oS=null;function KTe(n){return oS=oS||function YTe(n){return new Promise((t,e)=>{var r,s,i;function o(){qee(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{qee(),e(La(n,"network-request-failed"))},timeout:ZTe.get()})}if(null!==(s=null===(r=f2().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=f2().gapi)||void 0===i||!i.load){const c=zee("iframefcb");return f2()[c]=()=>{gapi.load?o():e(La(n,"network-request-failed"))},function Dee(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=La("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function gTe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw oS=null,t})}(n),oS}const XTe=new Ug(5e3,15e3),ewe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},twe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nwe(n){const t=n.config;Qe(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?LR(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:af},s=twe.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${Rp(r).slice(1)}`}function Tz(){return Tz=A(function*(n){const t=yield KTe(n),e=f2().gapi;return Qe(e,n,"internal-error"),t.open({where:document.body,url:nwe(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ewe,dontclear:!0},r=>new Promise(function(){var s=A(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=La(n,"network-request-failed"),u=f2().setTimeout(()=>{o(c)},XTe.get());function h(){f2().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),Tz.apply(this,arguments)}const swe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class jee{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Zee(n,t,e,r,s,i){Qe(n.config.authDomain,n,"auth-domain-config-required"),Qe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:af,eventId:s};if(t instanceof I0){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function Qde(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(t instanceof Mee){const u=t.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function dwe({config:n}){return n.emulator?LR(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${Rp(c).slice(1)}`}const wz="webStorageSupport",gwe=class pwe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Iee,this._completeRedirectFn=$ee,this._overrideRedirectResult=DTe}_openPopup(t,e,r,s){var i=this;return A(function*(){var o;Hl(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=Zee(t,e,r,$g(),s);return function lwe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},swe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=A2().toLowerCase();e&&(c=cee(h)?"_blank":e),aee(h)&&(t=t||"http://localhost",u.scrollbars="yes");const g=Object.entries(u).reduce((C,[w,I])=>`${C}${w}=${I},`,"");if(function tPe(n=A2()){var t;return YM(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(h)&&"_self"!==c)return function uwe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new jee(null);const m=window.open(t||"",c,g);Qe(m,n,"popup-blocked");try{m.focus()}catch{}return new jee(m)}(t,c,nS())})()}_openRedirect(t,e,r,s){var i=this;return A(function*(){return yield i._originValidation(t),function nTe(n){f2().location.href=n}(Zee(t,e,r,$g(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(Hl(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return A(function*(){const r=yield function rwe(n){return Tz.apply(this,arguments)}(t),s=new BTe(t);return r.register("authEvent",i=>(Qe(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(wz,{type:wz},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[wz];void 0!==o&&e(!!o),na(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function qTe(n){return Pz.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return dee()||jR()||YM()}};var Kee="@firebase/auth";class mwe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return A(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ywe=Xj("authIdTokenMaxAge")||300;let Qee=null;const Ewe=n=>function(){var t=A(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>ywe)return;const i=r?.token;Qee!==i&&(Qee=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function Mwe(n=kA()){const t=sf(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function zSe(n,t){const e=sf(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(gE(e.getOptions(),t??{}))return s;na(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:gwe,persistence:[fTe,QPe,Iee]}),r=Xj("authTokenSyncURL");if(r){const i=Ewe(r);(function GPe(n,t,e){Yr(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function UPe(n,t,e,r){Yr(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=Kj("auth");return s&&mee(e,`http://${s}`),e}!function vwe(n){mo(new Fi("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{Qe(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),Qe(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pee(n)},g=new iPe(c,u,h);return function VSe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(Fl);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(g,e),g})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),mo(new Fi("auth-internal",t=>{const e=ra(t.getProvider("auth").getImmediate());return new mwe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),os(Kee,"0.20.11",function _we(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),os(Kee,"0.20.11","esm2017")}("Browser");class aS{constructor(t){return t}}class ete{constructor(){return lR("auth")}}const bz=new It("angularfire2.auth-instances");function Pwe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new aS(r)}}const Twe={provide:ete,deps:[[new r2,bz]]},wwe={provide:aS,useFactory:function Swe(n,t){const e=cR("auth",n,t);return e&&new aS(e)},deps:[[new r2,bz],qf]};let bwe=(()=>{class n{constructor(){os("angularfire",HM.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:[wwe,Twe]}),n})();const Awe=Sr(xPe,!0),Iwe=Sr(Mwe,!0),xwe=Sr(WPe,!0),kwe=Sr(RPe,!0),Lwe=Sr(APe,!0),Rwe=Sr(kPe,!0),Dwe=Sr(xTe,!0),zwe=Sr(zPe,!0);class x0{constructor(t){return t}}const Oz=new It("angularfire2.firestore-instances");function Fwe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new x0(r)}}const Bwe={provide:class Vwe{constructor(){return lR("firestore")}},deps:[[new r2,Oz]]},$we={provide:x0,useFactory:function Hwe(n,t){const e=cR("firestore",n,t);return e&&new x0(e)},deps:[[new r2,Oz],qf]};let Uwe=(()=>{class n{constructor(){os("angularfire",HM.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({providers:[$we,Bwe]}),n})();const Wwe=Sr(UCe,!0),qwe=Sr(iCe,!0),Zwe=Sr($Ce,!0),em=Sr(JX,!0),Ywe=Sr(VCe,!0),Kwe=Sr(HCe,!0),Xwe=Sr(ECe,!0),Qwe=Sr(RCe,!0),nte=Sr(GCe,!0),Jwe=Sr(LCe,!0),cS=Sr(ACe,!0),ebe=Sr(FCe,!0),tbe=Sr(BCe,!0),nbe=Sr(xCe,!0);let tm=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=qwe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return A(function*(){return K(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield Wwe(r.collection,e)).id})()}read(e){var r=this;return A(function*(){K(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield Ywe(em(r.collection,e));return s.exists()?P.of(we.getNonNullable(s.data())):P.empty()})()}exists(e){var r=this;return A(function*(){return K(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return A(function*(){return K(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),tbe(em(s.collection,e),r)})()}delete(e){return K(n.VERBOSE,{called:this.collectionName+".delete",id:e}),Zwe(em(this.collection,e))}set(e,r){return K(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),ebe(em(this.collection,e),r)}subscribeToChanges(e,r){return new G1(nte(em(this.collection,e),s=>{r(P.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return A(function*(){const o=i.constructQuery(e,r,s);return(yield Kwe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){K(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new G1(nte(i,o=>{const c=[],u=[],h=[];o.docChanges().forEach(g=>{const m={id:g.doc.id,data:g.doc.data()};switch(g.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":h.push(m)}}),c.length>0&&(K(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(K(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),h.length>0&&(K(n.VERBOSE,"firebase gave us "+h.length+" DELETED "+this.collectionName),r.onDocumentDeleted(h))}))}constructQuery(e,r,s){let i=cS(this.collection);null!=r&&(i=cS(i,Jwe(r))),null!=s&&(i=cS(i,Qwe(s)));for(const o of e)i=cS(i,nbe(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),rbe=(()=>{class n extends tm{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(Le(x0))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var sbe=ja(2486);let Nn=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,sbe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ss{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,Ss.setSingletonInstance(this)}static setSingletonInstance(t){Ss.singleton=P.of(t)}static logErrorAndFail(t,e,r){throw Ss.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),U.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return A(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:N0(),lastEncounter:N0(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:N0(),occurences:u.occurences+1})}})()}}Ss.singleton=P.empty(),Ss.\u0275fac=function(t){return new(t||Ss)(Le(rbe),Le(jn),Le(Nn))},Ss.\u0275prov=Je({token:Ss,factory:Ss.\u0275fac,providedIn:"root"});class we{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw Ss.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}}function K(n,t){n&&console.log(t)}let obe=(()=>{class n extends tm{constructor(e){super("chats",e),K(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(x0))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rte=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),lS=(()=>{class n{constructor(e){this.chatDAO=e,K(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return A(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return A(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return A(function*(){return K(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return A(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return A(function*(){if(!1===o.userCanSendMessage(r.name,e))return U.failure(rte.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return U.failure(rte.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:N0(),currentTurn:i};return yield o.addMessage(e,c),U.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(obe))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),uS=(()=>{class n extends tm{constructor(e){super(n.COLLECTION_NAME,e),K(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(Le(x0))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nm=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return A(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return A(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return A(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUser(e,r){return this.userDAO.subscribeToChanges(e,r)}getUserLastUpdateTime(e){var r=this;return A(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return P.empty();{const i=s.get().lastUpdateTime;return ye(null!=i,"should not receive a lastUpdateTime equal to null"),P.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:N0()})}}return n.\u0275fac=function(e){return new(e||n)(Le(uS))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ste extends Ai{constructor(t=1/0,e=1/0,r=eR){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let rm=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class k0{static createUserWithEmailAndPassword(t,e,r){return Awe(t,e,r)}static sendEmailVerification(t){return kwe(t)}static sendPasswordResetEmail(t,e){return Lwe(t,e)}static signInWithEmailAndPassword(t,e,r){return A(function*(){return(yield Rwe(t,e,r)).user})()}static signInWithPopup(t,e){return A(function*(){return(yield Dwe(t,e)).user})()}static updateProfile(t,e){return zwe(t,e)}}class n5{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}n5.NOT_CONNECTED=new n5("",P.empty(),P.empty(),!1);let Ps=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=P.empty(),this.userSubscription=new G1,K(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new ste(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new G1(xwe(this.auth,function(){var o=A(function*(c){null==c?(K(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(n5.NOT_CONNECTED),i.user=P.empty()):(ye(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const h=u.get(),g=h.username;K(n.VERBOSE,`User ${g} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=g;if(!0===m&&!1===h.verified)return i.userService.markAsVerified(c.uid);const C=new n5(c.uid,P.ofNullable(c.email),P.ofNullable(g),m);!1===i.user.equalsValue(C)&&(i.user=P.of(C),i.userRS.next(C))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return A(function*(){try{return yield k0.sendPasswordResetEmail(r.auth,e),U.SUCCESS}catch(s){return U.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return A(function*(){return K(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):G.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return A(function*(){try{const o=yield k0.createUserWithEmailAndPassword(i.auth,r,s);yield k0.signInWithEmailAndPassword(i.auth,r,s);const c=we.getNonNullable(o.user);return yield i.createUser(c.uid,e),G.success(c)}catch(o){return G.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return Ss.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return A(function*(){K(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=P.ofNullable(e.auth.currentUser);if(!r.isPresent())return Ss.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return Ss.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield k0.sendEmailVerification(r.get()),U.SUCCESS}catch(s){return U.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return A(function*(){K(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield k0.signInWithEmailAndPassword(s.auth,e,r),U.SUCCESS}catch(i){return U.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return A(function*(){null==r?yield s.userDAO.set(e,{verified:!1}):yield s.userDAO.set(e,{username:r,verified:!1})})()}doGoogleLogin(){var e=this;return A(function*(){return U.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return A(function*(){try{const r=new PPe;r.addScope("profile"),r.addScope("email");const s=yield k0.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),G.success(s)}catch(r){return G.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return A(function*(){return P.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),U.SUCCESS):U.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return A(function*(){if(""===e)return U.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return U.failure($localize`This username is already in use, please select a different one.`);const i=we.getNonNullable(r.auth.currentUser);return yield k0.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),U.SUCCESS}catch(s){return U.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return A(function*(){try{const s=we.getNonNullable(r.auth.currentUser);return yield k0.updateProfile(s,{photoURL:e}),U.SUCCESS}catch(s){return U.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return A(function*(){const r=we.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return ye(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(uS),Le(nm),Le(aS))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ln{constructor(t){this.value=t}}Ln.HARD_DRAW=new Ln(0),Ln.RESIGN=new Ln(1),Ln.ESCAPE=new Ln(2),Ln.VICTORY=new Ln(3),Ln.TIMEOUT=new Ln(4),Ln.UNACHIEVED=new Ln(5),Ln.AGREED_DRAW_BY_ZERO=new Ln(6),Ln.AGREED_DRAW_BY_ONE=new Ln(7);class fS{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===Ln.HARD_DRAW.value}isAgreedDraw(){return this.data.result===Ln.AGREED_DRAW_BY_ZERO.value||this.data.result===Ln.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===Ln.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(ye(this.data.result===Ln.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),we.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===Ln.VICTORY.value}isTimeout(){return this.data.result===Ln.TIMEOUT.value}isResign(){return this.data.result===Ln.RESIGN.value}getWinner(){return P.ofNullable(this.data.winner)}getLoser(){return P.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new fS(this.id,{...this.data,winner:t,loser:e})}}class $s{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return $s.CREATOR;case"RANDOM":return $s.RANDOM;default:return ye("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),$s.CHOSEN_PLAYER}}}$s.CREATOR=new $s("CREATOR"),$s.RANDOM=new $s("RANDOM"),$s.CHOSEN_PLAYER=new $s("CHOSEN_PLAYER");class Pr{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return Pr.STANDARD;case"BLITZ":return Pr.BLITZ;case"CUSTOM":return Pr.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}Pr.STANDARD=new Pr("STANDARD"),Pr.BLITZ=new Pr("BLITZ"),Pr.CUSTOM=new Pr("CUSTOM"),Pr.NORMAL_MOVE_DURATION=120,Pr.NORMAL_PART_DURATION=1800,Pr.BLITZ_MOVE_DURATION=30,Pr.BLITZ_PART_DURATION=900;class Us{constructor(t){this.value=t}}Us.PART_CREATED=new Us(0),Us.CONFIG_PROPOSED=new Us(2),Us.PART_STARTED=new Us(3),Us.PART_FINISHED=new Us(4);class Nz{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}Nz.NONE=new Nz;class z{constructor(t){this.value=t}static of(t){return 0===t?z.ZERO:(we.expectToBe(t,1),z.ONE)}static fromTurn(t){return t%2==0?z.ZERO:z.ONE}isPlayer(){return!0}toString(){return this===z.ZERO?"PLAYER_ZERO":(we.expectToBe(this,z.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===z.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===z.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===z.ZERO?z.ONE:(we.expectToBe(this,z.ONE),z.ZERO)}}var de;z.numberEncoder=_n.ofN(2,n=>n.value,n=>2===n?de.NONE:z.of(n)),z.ZERO=new z(0),z.ONE=new z(1),z.PLAYERS=[z.ZERO,z.ONE],function(n){n.ZERO=z.ZERO,n.ONE=z.ONE,n.NONE=Nz.NONE}(de||(de={}));class zr{static rematchAccepted(t,e){return ite("RematchAccepted",{typeGame:t,partId:e})}static getPlayer(t){return z.of(we.getNonNullable(t.data).player)}static getTypeGame(t){return we.getNonNullable(t.data).typeGame}static getPartId(t){return we.getNonNullable(t.data).partId}}function ite(n,t){return{code:n,data:t}}function L0(n){return t=>ite(n,{player:t.value})}zr.drawProposed=L0("DrawProposed"),zr.drawRefused=L0("DrawRefused"),zr.takeBackAsked=L0("TakeBackAsked"),zr.takeBackRefused=L0("TakeBackRefused"),zr.takeBackAccepted=L0("TakeBackAccepted"),zr.rematchProposed=L0("RematchProposed"),zr.addTurnTime=L0("AddTurnTime"),zr.addGlobalTime=L0("AddGlobalTime");class ote{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>vc(s,r))||e.push(r)}),e}}class $t{constructor(t){this.values=void 0===t?[]:ote.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(vc(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new $t(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(vc(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?P.of(this.values[0]):P.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=new $t;for(const r of this)e.add(t(r));return e}flatMap(t){const e=new $t;for(const r of this)e.addAll(t(r));return e}filter(t){const e=new $t;for(const r of this)t(r)&&e.add(r);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return P.of(e);return P.empty()}intersection(t){const e=new $t;for(const r of t)this.contains(r)&&e.add(r);return e}[Symbol.iterator](){return this.values.values()}}class zn{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new zn;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(vc(e.key,t))return P.of(e.value);return P.empty()}forEach(t){for(let e=0;e<this.map.length;e++)t(this.getByIndex(e))}getByIndex(t){return this.map[t]}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(vc(r.key,t)){const s=r.value;return r.value=e,P.of(s)}return this.map.push({key:t,value:e}),P.empty()}containsKey(t){return this.map.some(e=>vc(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new $t(this.listKeys())}filter(t){const e=new zn;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(vc(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(ye(o.isPresent(),"value is absent in a map even though its key is present!"),!1===vc(i,o.get()))return!1}return!0}}class Xf extends zn{reverse(){const t=new Xf;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new $t;s.add(e),t.set(r,s)}}return t}}class Ye{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static create3DTable(t,e,r,s){const i=[];for(let o=0;o<t;o++)i.push(Ye.createTable(e,r,s));return i}static createTable(t,e,r){const s=[];for(let i=0;i<e;i++)s.push(Ye.createArray(t,r));return s}static createArray(t,e){const r=[];for(let s=0;s<t;s++)r.push(e);return r}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=Ye.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===vc(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Ye.compareArray(t[r],e[r]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&Ye.compareArray(t,e.slice(0,t.length))}static range(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}static smallerFirst(t,e){return t-e}}class ate{constructor(){this.content=new zn}get(t){const e=this.content.get(t.y);return e.isAbsent()?P.empty():e.get().get(t.x)}set(t,e){const r=this.content.get(t.y);let s;r.isPresent()?s=r.get():(s=new zn,this.content.set(t.y,s)),s.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(Ye.smallerFirst);for(const r of e){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Ye.smallerFirst);for(const o of i){const c=s.get(o).get();t.push({x:o,y:r,content:c})}}return t.values()}}let cte=(()=>{class n extends tm{constructor(e){super("parts",e),K(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(x0))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class hS{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let abe=(()=>{class n extends tm{constructor(e){super("config-room",e),K(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(x0))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Az=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,K(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new hS(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(h=>h.id===u.data.id?u.data:h);r(s)},c=>{for(const u of c)s=s.filter(h=>h.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return A(function*(){K(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:$s.RANDOM.value,partType:Pr.STANDARD.value,partStatus:Us.PART_CREATED.value,maximalMoveDuration:Pr.NORMAL_MOVE_DURATION,totalPartDuration:Pr.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return A(function*(){K(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?U.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),U.SUCCESS)})()}cancelJoining(e){var r=this;return A(function*(){K(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Us.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return A(function*(){K(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return A(function*(){return K(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:Us.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return K(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:Us.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:Us.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return K(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:Us.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(Le(abe),Le(Ps))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),dS=(()=>{class n{constructor(e,r,s,i){this.partDAO=e,this.connectedUserService=r,this.configRoomService=s,this.chatService=i,K(n.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,r,s,i){var o=this;return A(function*(){return i={...i,lastUpdate:{index:s+1,player:r.value}},o.partDAO.update(e,i)})()}getPartValidity(e,r){var s=this;return A(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?U.failure("NONEXISTENT_PART"):i.get().typeGame===r?U.SUCCESS:U.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){K(n.VERBOSE,"GameService.createPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:e,playerZero:r,turn:-1,result:Ln.UNACHIEVED.value,listMoves:[]})}createChat(e){return K(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return A(function*(){K(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}startGameWithConfig(e,r,s,i){K(n.VERBOSE,"GameService.startGameWithConfig("+e+", "+JSON.stringify(i));const o=this.getStartingConfig(i);return this.updateAndBumpIndex(e,r,s,o)}getStartingConfig(e){let s,i,r=$s.of(e.firstPlayer);return r===$s.RANDOM&&(r=Math.random()<.5?$s.CREATOR:$s.CHOSEN_PLAYER),r===$s.CREATOR?(s=e.creator,i=we.getNonNullable(e.chosenOpponent)):(s=we.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:N0(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(e){return K(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return A(function*(){return K(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e),s.startGameWithConfig(e,z.ONE,0,r)})()}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i,o){return this.updateAndBumpIndex(e,s,r,{winner:i,loser:o,result:Ln.RESIGN.value,request:null})}notifyTimeout(e,r,s,i,o){return this.updateAndBumpIndex(e,r,s,{winner:i,loser:o,result:Ln.TIMEOUT.value,request:null})}sendRequest(e,r,s,i){return this.updateAndBumpIndex(e,r,s,{request:i})}proposeDraw(e,r,s){return this.sendRequest(e,s,r,zr.drawProposed(s))}acceptDraw(e,r,s){return this.updateAndBumpIndex(e,s,r,{result:(s===z.ZERO?Ln.AGREED_DRAW_BY_ZERO:Ln.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,r,s){return this.sendRequest(e,s,r,zr.drawRefused(s))}proposeRematch(e,r,s){return this.sendRequest(e,s,r,zr.rematchProposed(s))}acceptRematch(e,r,s){var i=this;return A(function*(){K(n.VERBOSE,{called:"GameService.acceptRematch(",partDocument:e});const o=we.getNonNullable(e.data),c=yield i.configRoomService.readConfigRoomById(e.id);let u;const h=i.connectedUserService.user.get().toMinimalUser();let g;o.playerZero.id===h.id?(g=we.getNonNullable(o.playerOne),u=$s.CHOSEN_PLAYER):(g=o.playerZero,u=$s.CREATOR);const m={...c,firstPlayer:u.value,creator:h,chosenOpponent:g,partStatus:Us.PART_STARTED.value},C=i.getStartingConfig(m),w={lastUpdate:{index:0,player:s.value},typeGame:o.typeGame,result:Ln.UNACHIEVED.value,listMoves:[],...C},I=yield i.partDAO.create(w);return yield i.configRoomService.createConfigRoom(I,m),yield i.createChat(I),i.sendRequest(e.id,s,r,zr.rematchAccepted(o.typeGame,I))})()}askTakeBack(e,r,s){return this.sendRequest(e,s,r,zr.takeBackAsked(s))}acceptTakeBack(e,r,s,i){var o=this;return A(function*(){ye(zr.getPlayer(we.getNonNullable(r.data.request))!==s,"Illegal to accept your own request");const u=zr.takeBackAccepted(s);let h=r.data.listMoves.slice(0,r.data.listMoves.length-1);h.length%2===s.value&&(h=h.slice(0,h.length-1));const g={request:u,listMoves:h,turn:h.length,lastUpdateTime:N0(),remainingMsForZero:we.getNonNullable(r.data.remainingMsForZero)-i[0],remainingMsForOne:we.getNonNullable(r.data.remainingMsForOne)-i[1]},m=r.data.lastUpdate.index;return yield o.updateAndBumpIndex(e,s,m,g)})()}refuseTakeBack(e,r,s){const i=zr.takeBackRefused(s);return this.updateAndBumpIndex(e,s,r,{request:i})}addGlobalTime(e,r,s,i){var o=this;return A(function*(){let c={request:zr.addGlobalTime(i.getOpponent())};return c=i===z.ZERO?{...c,remainingMsForOne:we.getNonNullable(s.remainingMsForOne)+3e5}:{...c,remainingMsForZero:we.getNonNullable(s.remainingMsForZero)+3e5},yield o.updateAndBumpIndex(e,i,r,c)})()}addTurnTime(e,r,s){var i=this;return A(function*(){const o={request:zr.addTurnTime(e.getOpponent())};return yield i.updateAndBumpIndex(s,e,r,o)})()}updateDBBoard(e,r,s,i,o,c,u,h){var g=this;return A(function*(){K(n.VERBOSE,{gameService_updateDBBoard:{partId:e,encodedMove:s,scores:o,msToSubstract:i,notifyDraw:c,winner:u,loser:h}});const m=(yield g.partDAO.read(e)).get(),C=m.lastUpdate.index,w=m.turn+1,I=Ye.copyImmutableArray(m.listMoves);I[I.length]=s;let H={listMoves:I,turn:w,request:null,lastUpdateTime:N0()};return H=g.updateScore(H,o),H=g.substractMs(H,m,i),null!=u?H={...H,winner:u,loser:h,result:Ln.VICTORY.value}:!0===c&&(H={...H,result:Ln.HARD_DRAW.value}),yield g.updateAndBumpIndex(e,r,C,H)})()}updateScore(e,r){return void 0!==r?{...e,scorePlayerZero:r[0],scorePlayerOne:r[1]}:e}substractMs(e,r,s){return s[0]>0?{...e,remainingMsForZero:we.getNonNullable(r.remainingMsForZero)-s[0]}:s[1]>0?{...e,remainingMsForOne:we.getNonNullable(r.remainingMsForOne)-s[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(cte),Le(Ps),Le(Az),Le(lS))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var xte={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Vte={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Hte={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class sm{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??sm.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let Gte=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return P.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return sm.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pS=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return P.of(r)}return P.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(Le(Ds),Le(Gte))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Wte(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function Et(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?Wte(Object(e),!0).forEach(function(r){h2(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Wte(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function gS(n){return(gS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function qte(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function h2(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function xz(n,t){return function URe(n){if(Array.isArray(n))return n}(n)||function WRe(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||jte(n,t)||function jRe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function om(n){return function $Re(n){if(Array.isArray(n))return kz(n)}(n)||function GRe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||jte(n)||function qRe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jte(n,t){if(n){if("string"==typeof n)return kz(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return kz(n,t)}}function kz(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var Zte=function(){},Lz={},Yte={},Kte=null,Xte={mark:Zte,measure:Zte};try{typeof window<"u"&&(Lz=window),typeof document<"u"&&(Yte=document),typeof MutationObserver<"u"&&(Kte=MutationObserver),typeof performance<"u"&&(Xte=performance)}catch{}var vS,CS,yS,ES,MS,Qte=(Lz.navigator||{}).userAgent,Jte=void 0===Qte?"":Qte,R0=Lz,Tr=Yte,ene=Kte,_S=Xte,Gl=!!Tr.documentElement&&!!Tr.head&&"function"==typeof Tr.addEventListener&&"function"==typeof Tr.createElement,tne=~Jte.indexOf("MSIE")||~Jte.indexOf("Trident/"),Wl="___FONT_AWESOME___",rne="svg-inline--fa",r5="data-fa-i2svg",Dz="data-fa-pseudo-element",zz="data-prefix",Vz="data-icon",sne="fontawesome-i2svg",XRe=["HTML","HEAD","STYLE","SCRIPT"],ine=function(){try{return!0}catch{return!1}}(),wr="classic",us="sharp",Hz=[wr,us];function am(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[wr]}})}var cm=am((h2(vS={},wr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),h2(vS,us,{fa:"solid",fass:"solid","fa-solid":"solid"}),vS)),lm=am((h2(CS={},wr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),h2(CS,us,{solid:"fass"}),CS)),um=am((h2(yS={},wr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),h2(yS,us,{fass:"fa-solid"}),yS)),QRe=am((h2(ES={},wr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),h2(ES,us,{"fa-solid":"fass"}),ES)),JRe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,one="fa-layers-text",eDe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,tDe=am((h2(MS={},wr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),h2(MS,us,{900:"fass"}),MS)),ane=[1,2,3,4,5,6,7,8,9,10],nDe=ane.concat([11,12,13,14,15,16,17,18,19,20]),rDe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],fm=new Set;Object.keys(lm[wr]).map(fm.add.bind(fm)),Object.keys(lm[us]).map(fm.add.bind(fm));var sDe=[].concat(Hz,om(fm),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(ane.map(function(n){return"".concat(n,"x")})).concat(nDe.map(function(n){return"w-".concat(n)})),hm=R0.FontAwesomeConfig||{};Tr&&"function"==typeof Tr.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=xz(n,2),r=t[1],s=function oDe(n){return""===n||"false"!==n&&("true"===n||n)}(function iDe(n){var t=Tr.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(hm[r]=s)});var cne={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:rne,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};hm.familyPrefix&&(hm.cssPrefix=hm.familyPrefix);var Qf=Et(Et({},cne),hm);Qf.autoReplaceSvg||(Qf.observeMutations=!1);var Ot={};Object.keys(cne).forEach(function(n){Object.defineProperty(Ot,n,{enumerable:!0,set:function(e){Qf[n]=e,dm.forEach(function(r){return r(Ot)})},get:function(){return Qf[n]}})}),Object.defineProperty(Ot,"familyPrefix",{enumerable:!0,set:function(t){Qf.cssPrefix=t,dm.forEach(function(e){return e(Ot)})},get:function(){return Qf.cssPrefix}}),R0.FontAwesomeConfig=Ot;var dm=[],E4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function pm(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function Jf(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function Fz(n){return n.classList?Jf(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function lne(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function SS(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function Bz(n){return n.size!==E4.size||n.x!==E4.x||n.y!==E4.y||n.rotate!==E4.rotate||n.flipX||n.flipY}function une(){var n="fa",t=rne,e=Ot.cssPrefix,r=Ot.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var fne=!1;function $z(){Ot.autoAddCss&&!fne&&(function lDe(n){if(n&&Gl){var t=Tr.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=Tr.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Tr.head.insertBefore(t,r)}}(une()),fne=!0)}var gDe={mixout:function(){return{dom:{css:une,insertCss:$z}}},hooks:function(){return{beforeDOMElementCreation:function(){$z()},beforeI2svg:function(){$z()}}}},ql=R0||{};ql[Wl]||(ql[Wl]={}),ql[Wl].styles||(ql[Wl].styles={}),ql[Wl].hooks||(ql[Wl].hooks={}),ql[Wl].shims||(ql[Wl].shims=[]);var g3=ql[Wl],hne=[],PS=!1;function _De(n){!Gl||(PS?setTimeout(n,0):hne.push(n))}function gm(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?lne(n):"<".concat(t," ").concat(function fDe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(lne(n[e]),'" ')},"").trim()}(r),">").concat(i.map(gm).join(""),"</").concat(t,">")}function dne(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}Gl&&((PS=(Tr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Tr.readyState))||Tr.addEventListener("DOMContentLoaded",function n(){Tr.removeEventListener("DOMContentLoaded",n),PS=1,hne.map(function(t){return t()})}));var Uz=function(t,e,r,s){var u,h,g,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,g=t[i[0]]):(u=0,g=r);u<o;u++)g=c(g,t[h=i[u]],h,t);return g};function Gz(n){var t=function CDe(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function pne(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function Wz(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=pne(t);"function"!=typeof g3.hooks.addPack||s?g3.styles[n]=Et(Et({},g3.styles[n]||{}),i):g3.hooks.addPack(n,pne(t)),"fas"===n&&Wz("fa",t)}var TS,wS,bS,e9=g3.styles,EDe=g3.shims,MDe=(h2(TS={},wr,Object.values(um[wr])),h2(TS,us,Object.values(um[us])),TS),qz=null,gne={},mne={},_ne={},vne={},Cne={},SDe=(h2(wS={},wr,Object.keys(cm[wr])),h2(wS,us,Object.keys(cm[us])),wS);function TDe(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function PDe(n){return~sDe.indexOf(n)}(s)?null:s}var yne=function(){var t=function(i){return Uz(e9,function(o,c,u){return o[u]=Uz(c,i,{}),o},{})};gne=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),mne=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),Cne=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in e9||Ot.autoFetchSvg,r=Uz(EDe,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});_ne=r.names,vne=r.unicodes,qz=OS(Ot.styleDefault,{family:Ot.familyDefault})};function jz(n,t){return(gne[n]||{})[t]}function i5(n,t){return(Cne[n]||{})[t]}function Ene(n){return _ne[n]||{prefix:null,iconName:null}}function z0(){return qz}function OS(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?wr:e,s=cm[r][n],i=lm[r][n]||lm[r][s],o=n in g3.styles?n:null;return i||o||null}(function cDe(n){dm.push(n)})(function(n){qz=OS(n.styleDefault,{family:Ot.familyDefault})}),yne();var Mne=(h2(bS={},wr,Object.keys(um[wr])),h2(bS,us,Object.keys(um[us])),bS);function NS(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(h2(t={},wr,"".concat(Ot.cssPrefix,"-").concat(wr)),h2(t,us,"".concat(Ot.cssPrefix,"-").concat(us)),t),o=null,c=wr;(n.includes(i[wr])||n.some(function(h){return Mne[wr].includes(h)}))&&(c=wr),(n.includes(i[us])||n.some(function(h){return Mne[us].includes(h)}))&&(c=us);var u=n.reduce(function(h,g){var m=TDe(Ot.cssPrefix,g);if(e9[g]?(g=MDe[c].includes(g)?QRe[c][g]:g,o=g,h.prefix=g):SDe[c].indexOf(g)>-1?(o=g,h.prefix=OS(g,{family:c})):m?h.iconName=m:g!==Ot.replacementClass&&g!==i[wr]&&g!==i[us]&&h.rest.push(g),!s&&h.prefix&&h.iconName){var C="fa"===o?Ene(h.iconName):{},w=i5(h.prefix,h.iconName);C.prefix&&(o=null),h.iconName=C.iconName||w||h.iconName,h.prefix=C.prefix||h.prefix,"far"===h.prefix&&!e9.far&&e9.fas&&!Ot.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===us&&(e9.fass||Ot.autoFetchSvg)&&(u.prefix="fass",u.iconName=i5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=z0()||"fas"),u}var ODe=function(){function n(){(function HRe(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function FRe(n,t,e){t&&qte(n.prototype,t),e&&qte(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=Et(Et({},e.definitions[c]||{}),o[c]),Wz(c,o[c]);var u=um[wr][c];u&&Wz(u,o[c]),yne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,g=h[2];e[c]||(e[c]={}),g.length>0&&g.forEach(function(m){"string"==typeof m&&(e[c][m]=h)}),e[c][u]=h}),e}}]),n}(),Sne=[],t9={},n9={},NDe=Object.keys(n9);function Yz(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=t9[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function o5(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=t9[n]||[];s.forEach(function(i){i.apply(null,e)})}function jl(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return n9[n]?n9[n].apply(null,t):void 0}function Kz(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||z0();if(t)return t=i5(e,t)||t,dne(Pne.definitions,e,t)||dne(g3.styles,e,t)}var Pne=new ODe,xDe={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Gl?(o5("beforeI2svg",t),jl("pseudoElements2svg",t),jl("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===Ot.autoReplaceSvg&&(Ot.autoReplaceSvg=!0),Ot.observeMutations=!0,_De(function(){LDe({autoReplaceSvgRoot:e}),o5("watch",t)})}},Ra={noAuto:function(){Ot.autoReplaceSvg=!1,Ot.observeMutations=!1,o5("noAuto")},config:Ot,dom:xDe,parse:{icon:function(t){if(null===t)return null;if("object"===gS(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:i5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=OS(t[0]);return{prefix:r,iconName:i5(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(Ot.cssPrefix,"-"))>-1||t.match(JRe))){var s=NS(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||z0(),iconName:i5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=z0();return{prefix:i,iconName:i5(i,t)||t}}}},library:Pne,findIconDefinition:Kz,toHtml:gm},LDe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?Tr:e;(Object.keys(g3.styles).length>0||Ot.autoFetchSvg)&&Gl&&Ot.autoReplaceSvg&&Ra.dom.i2svg({node:r})};function AS(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return gm(r)})}}),Object.defineProperty(n,"node",{get:function(){if(Gl){var r=Tr.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function Xz(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,g=n.titleId,m=n.extra,C=n.watchable,w=void 0!==C&&C,I=r.found?r:e,H=I.width,Y=I.height,ee="fak"===s,_e=[Ot.replacementClass,i?"".concat(Ot.cssPrefix,"-").concat(i):""].filter(function(w1){return-1===m.classes.indexOf(w1)}).filter(function(w1){return""!==w1||!!w1}).concat(m.classes).join(" "),te={children:[],attributes:Et(Et({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:_e,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(H," ").concat(Y)})},Ae=ee&&!~m.classes.indexOf("fa-fw")?{width:"".concat(H/Y*16*.0625,"em")}:{};w&&(te.attributes[r5]=""),u&&(te.children.push({tag:"title",attributes:{id:te.attributes["aria-labelledby"]||"title-".concat(g||pm())},children:[u]}),delete te.attributes.title);var Fe=Et(Et({},te),{},{prefix:s,iconName:i,main:e,mask:r,maskId:h,transform:o,symbol:c,styles:Et(Et({},Ae),m.styles)}),Ze=r.found&&e.found?jl("generateAbstractMask",Fe)||{children:[],attributes:{}}:jl("generateAbstractIcon",Fe)||{children:[],attributes:{}},k1=Ze.attributes;return Fe.children=Ze.children,Fe.attributes=k1,c?function DDe(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(Ot.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Et(Et({},s),{},{id:o}),children:r}]}]}(Fe):function RDe(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(Bz(o)&&e.found&&!r.found){var h={x:e.width/e.height/2,y:.5};s.style=SS(Et(Et({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}(Fe)}function Tne(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=Et(Et(Et({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[r5]="");var g=Et({},o.styles);Bz(s)&&(g.transform=function dDe(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&tne?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),g["-webkit-transform"]=g.transform);var m=SS(g);m.length>0&&(h.style=m);var C=[];return C.push({tag:"span",attributes:h,children:[t]}),i&&C.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),C}function zDe(n){var t=n.content,e=n.title,r=n.extra,s=Et(Et(Et({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=SS(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var Qz=g3.styles;function Jz(n){var t=n[0],e=n[1],i=xz(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(Ot.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(Ot.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(Ot.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var VDe={found:!1,width:512,height:512};function eV(n,t){var e=t;return"fa"===t&&null!==Ot.styleDefault&&(t=z0()),new Promise(function(r,s){if(jl("missingIconAbstract"),"fa"===e){var o=Ene(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&Qz[t]&&Qz[t][n])return r(Jz(Qz[t][n]));(function HDe(n,t){!ine&&!Ot.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(Et(Et({},VDe),{},{icon:Ot.showMissingIcons&&n&&jl("missingIconAbstract")||{}}))})}var wne=function(){},tV=Ot.measurePerformance&&_S&&_S.mark&&_S.measure?_S:{mark:wne,measure:wne},mm='FA "6.2.1"',nV_begin=function(t){return tV.mark("".concat(mm," ").concat(t," begins")),function(){return function(t){tV.mark("".concat(mm," ").concat(t," ends")),tV.measure("".concat(mm," ").concat(t),"".concat(mm," ").concat(t," begins"),"".concat(mm," ").concat(t," ends"))}(t)}},IS=function(){};function One(n){return"string"==typeof(n.getAttribute?n.getAttribute(r5):null)}function GDe(n){return Tr.createElementNS("http://www.w3.org/2000/svg",n)}function WDe(n){return Tr.createElement(n)}function Nne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?GDe:WDe:e;if("string"==typeof n)return Tr.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(Nne(o,{ceFn:r}))}),s}var xS={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(Nne(s),e)}),null===e.getAttribute(r5)&&Ot.keepOriginalSource){var r=Tr.createComment(function qDe(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~Fz(e).indexOf(Ot.replacementClass))return xS.replace(t);var s=new RegExp("".concat(Ot.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===Ot.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return gm(c)}).join("\n");e.setAttribute(r5,""),e.innerHTML=o}};function Ane(n){n()}function Ine(n,t){var e="function"==typeof t?t:IS;if(0===n.length)e();else{var r=Ane;"async"===Ot.mutateApproach&&(r=R0.requestAnimationFrame||Ane),r(function(){var s=function UDe(){return!0===Ot.autoReplaceSvg?xS.replace:xS[Ot.autoReplaceSvg]||xS.replace}(),i=nV_begin("mutate");n.map(s),i(),e()})}}var rV=!1;function xne(){rV=!0}function sV(){rV=!1}var kS=null;function kne(n){if(ene&&Ot.observeMutations){var t=n.treeCallback,e=void 0===t?IS:t,r=n.nodeCallback,s=void 0===r?IS:r,i=n.pseudoElementsCallback,o=void 0===i?IS:i,c=n.observeMutationsRoot,u=void 0===c?Tr:c;kS=new ene(function(h){if(!rV){var g=z0();Jf(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!One(m.addedNodes[0])&&(Ot.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&Ot.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&One(m.target)&&~rDe.indexOf(m.attributeName))if("class"===m.attributeName&&function BDe(n){var t=n.getAttribute?n.getAttribute(zz):null,e=n.getAttribute?n.getAttribute(Vz):null;return t&&e}(m.target)){var C=NS(Fz(m.target)),I=C.iconName;m.target.setAttribute(zz,C.prefix||g),I&&m.target.setAttribute(Vz,I)}else(function $De(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(Ot.replacementClass)})(m.target)&&s(m.target)})}}),Gl&&kS.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function ZDe(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function YDe(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=NS(Fz(n));return s.prefix||(s.prefix=z0()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function wDe(n,t){return(mne[n]||{})[t]}(s.prefix,n.innerText)||jz(s.prefix,Gz(n.innerText))),!s.iconName&&Ot.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function KDe(n){var t=Jf(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return Ot.autoA11y&&(e?t["aria-labelledby"]="".concat(Ot.replacementClass,"-title-").concat(r||pm()):(t["aria-hidden"]="true",t.focusable="false")),t}function Lne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=YDe(n),r=e.iconName,s=e.prefix,i=e.rest,o=KDe(n),c=Yz("parseNodeAttributes",{},n),u=t.styleParser?ZDe(n):[];return Et({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:E4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var QDe=g3.styles;function Rne(n){var t="nest"===Ot.autoReplaceSvg?Lne(n,{styleParser:!1}):Lne(n);return~t.extra.classes.indexOf(one)?jl("generateLayersText",n,t):jl("generateSvgReplacementMutation",n,t)}var V0=new Set;function Dne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Gl)return Promise.resolve();var e=Tr.documentElement.classList,r=function(m){return e.add("".concat(sne,"-").concat(m))},s=function(m){return e.remove("".concat(sne,"-").concat(m))},i=Ot.autoFetchSvg?V0:Hz.map(function(g){return"fa-".concat(g)}).concat(Object.keys(QDe));i.includes("fa")||i.push("fa");var o=[".".concat(one,":not([").concat(r5,"])")].concat(i.map(function(g){return".".concat(g,":not([").concat(r5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=Jf(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=nV_begin("onTree"),h=c.reduce(function(g,m){try{var C=Rne(m);C&&g.push(C)}catch(w){ine||"MissingIcon"===w.name&&console.error(w)}return g},[]);return new Promise(function(g,m){Promise.all(h).then(function(C){Ine(C,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),g()})}).catch(function(C){u(),m(C)})})}function JDe(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Rne(n).then(function(e){e&&Ine([e],t)})}function eze(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Kz(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:Kz(s||{})),n(r,Et(Et({},e),{},{mask:s}))}}Hz.map(function(n){V0.add("fa-".concat(n))}),Object.keys(cm[wr]).map(V0.add.bind(V0)),Object.keys(cm[us]).map(V0.add.bind(V0)),V0=om(V0);var tze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?E4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,h=e.maskId,g=void 0===h?null:h,m=e.title,C=void 0===m?null:m,w=e.titleId,I=void 0===w?null:w,H=e.classes,Y=void 0===H?[]:H,ee=e.attributes,_e=void 0===ee?{}:ee,te=e.styles,Ae=void 0===te?{}:te;if(t){var Fe=t.prefix,Ze=t.iconName,zt=t.icon;return AS(Et({type:"icon"},t),function(){return o5("beforeDOMElementCreation",{iconDefinition:t,params:e}),Ot.autoA11y&&(C?_e["aria-labelledby"]="".concat(Ot.replacementClass,"-title-").concat(I||pm()):(_e["aria-hidden"]="true",_e.focusable="false")),Xz({icons:{main:Jz(zt),mask:u?Jz(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Fe,iconName:Ze,transform:Et(Et({},E4),s),symbol:o,title:C,maskId:g,titleId:I,extra:{attributes:_e,styles:Ae,classes:Y}})})}},nze={mixout:function(){return{icon:eze(tze)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=Dne,e.nodeCallback=JDe,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return Dne(void 0===r?Tr:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,g=r.mask,m=r.maskId,C=r.extra;return new Promise(function(w,I){Promise.all([eV(s,c),g.iconName?eV(g.iconName,g.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(H){var Y=xz(H,2);w([e,Xz({icons:{main:Y[0],mask:Y[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:C,watchable:!0})])}).catch(I)})},t.generateAbstractIcon=function(e){var h,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=SS(e.styles);return u.length>0&&(s.style=u),Bz(o)&&(h=jl("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},rze={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return AS({type:"layer"},function(){o5("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(Ot.cssPrefix,"-layers")].concat(om(i)).join(" ")},children:o}]})}}}},sze={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,g=r.styles,m=void 0===g?{}:g;return AS({type:"counter",content:e},function(){return o5("beforeDOMElementCreation",{content:e,params:r}),zDe({content:e.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(Ot.cssPrefix,"-layers-counter")].concat(om(c))}})})}}}},ize={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?E4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,g=r.attributes,m=void 0===g?{}:g,C=r.styles,w=void 0===C?{}:C;return AS({type:"text",content:e},function(){return o5("beforeDOMElementCreation",{content:e,params:r}),Tne({content:e,transform:Et(Et({},E4),i),title:c,extra:{attributes:m,styles:w,classes:["".concat(Ot.cssPrefix,"-layers-text")].concat(om(h))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(tne){var h=parseInt(getComputedStyle(e).fontSize,10),g=e.getBoundingClientRect();c=g.width/h,u=g.height/h}return Ot.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,Tne({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},oze=new RegExp('"',"ug"),zne=[1105920,1112319];function Vne(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=Jf(n.children).filter(function(zt){return zt.getAttribute(Dz)===t})[0],c=R0.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(eDe),h=c.getPropertyValue("font-weight"),g=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==g&&""!==g){var m=c.getPropertyValue("content"),C=~["Sharp"].indexOf(u[2])?us:wr,w=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?lm[C][u[2].toLowerCase()]:tDe[C][h],I=function aze(n){var t=n.replace(oze,""),e=function yDe(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=zne[0]&&e<=zne[1],s=2===t.length&&t[0]===t[1];return{value:Gz(s?t[0]:t),isSecondary:r||s}}(m),H=I.value,Y=I.isSecondary,ee=u[0].startsWith("FontAwesome"),_e=jz(w,H),te=_e;if(ee){var Ae=function bDe(n){var t=vne[n],e=jz("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(H);Ae.iconName&&Ae.prefix&&(_e=Ae.iconName,w=Ae.prefix)}if(!_e||Y||o&&o.getAttribute(zz)===w&&o.getAttribute(Vz)===te)r();else{n.setAttribute(e,te),o&&n.removeChild(o);var Fe=function XDe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:E4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Ze=Fe.extra;Ze.attributes[Dz]=t,eV(_e,w).then(function(zt){var k1=Xz(Et(Et({},Fe),{},{icons:{main:zt,mask:{prefix:null,iconName:null,rest:[]}},prefix:w,iconName:te,extra:Ze,watchable:!0})),w1=Tr.createElement("svg");"::before"===t?n.insertBefore(w1,n.firstChild):n.appendChild(w1),w1.outerHTML=k1.map(function(es){return gm(es)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function cze(n){return Promise.all([Vne(n,"::before"),Vne(n,"::after")])}function lze(n){return!(n.parentNode===document.head||~XRe.indexOf(n.tagName.toUpperCase())||n.getAttribute(Dz)||n.parentNode&&"svg"===n.parentNode.tagName)}function Hne(n){if(Gl)return new Promise(function(t,e){var r=Jf(n.querySelectorAll("*")).filter(lze).map(cze),s=nV_begin("searchPseudoElements");xne(),Promise.all(r).then(function(){s(),sV(),t()}).catch(function(){s(),sV(),e()})})}var Fne=!1,Bne=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},iV={x:0,y:0,width:"100%",height:"100%"};function $ne(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function dze(n){return"g"===n.tag?n.children:[n]}var pze={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?NS(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=z0()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,g=i.icon,C=o.icon,w=function hDe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),I={tag:"rect",attributes:Et(Et({},iV),{},{fill:"white"})},H=g.children?{children:g.children.map($ne)}:{},Y={tag:"g",attributes:Et({},w.inner),children:[$ne(Et({tag:g.tag,attributes:Et(Et({},g.attributes),w.path)},H))]},ee={tag:"g",attributes:Et({},w.outer),children:[Y]},_e="mask-".concat(c||pm()),te="clip-".concat(c||pm()),Ae={tag:"mask",attributes:Et(Et({},iV),{},{id:_e,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[I,ee]},Fe={tag:"defs",children:[{tag:"clipPath",attributes:{id:te},children:dze(C)},Ae]};return r.push(Fe,{tag:"rect",attributes:Et({fill:"currentColor","clip-path":"url(#".concat(te,")"),mask:"url(#".concat(_e,")")},iV)}),{children:r,attributes:s}}}};!function ADe(n,t){var e=t.mixoutsTo;Sne=n,t9={},Object.keys(n9).forEach(function(r){-1===NDe.indexOf(r)&&delete n9[r]}),Sne.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===gS(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){t9[o]||(t9[o]=[]),t9[o].push(i[o])})}r.provides&&r.provides(n9)})}([gDe,nze,rze,sze,ize,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=Hne,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;Ot.searchPseudoElements&&Hne(void 0===r?Tr:r)}}},{mixout:function(){return{dom:{unwatch:function(){xne(),Fne=!0}}}},hooks:function(){return{bootstrap:function(){kne(Yz("mutationObserverCallbacks",{}))},noAuto:function(){!function jDe(){!kS||kS.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;Fne?sV():kne(Yz("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return Bne(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=Bne(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),g="rotate(".concat(s.rotate," 0 0)"),w={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(g)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:Et({},w.outer),children:[{tag:"g",attributes:Et({},w.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Et(Et({},r.icon.attributes),w.path)}]}]}}}},pze,{provides:function(t){var e=!1;R0.matchMedia&&(e=R0.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:Et(Et({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Et(Et({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:Et(Et({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:Et(Et({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Et(Et({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:Et(Et({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Et(Et({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:Et(Et({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Et(Et({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:Ra});var vze=Ra.parse,Cze=Ra.icon;const yze=["*"],Sze=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let wze=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),bze=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Oze=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ft({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Y2]}),n})(),Nze=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(Q(ao),Q(ri))},n.\u0275cmp=mt({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Y2],ngContentSelectors:yze,decls:1,vars:0,template:function(e,r){1&e&&(function aB(n){const t=ke()[16][6];if(!t.projection){const r=t.projection=nl(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?n4e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function cB(n,t=0,e){const r=ke(),s=Kn(),i=Y6(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),ih(),64!=(64&i.flags)&&function zw(n,t,e){Fv(t[11],0,t,e,xv(n,e,t),Dv(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),r9=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?vze.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...Sze(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=Cze(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(Q(OG),Q(wze),Q(bze),Q(Oze,8),Q(Nze,8))},n.\u0275cmp=mt({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(zb("innerHTML",r.renderedIconHTML,D8),D("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Y2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Aze=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n}),n.\u0275inj=Ur({}),n})();var lV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},PV={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},Aie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},Bie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},aae={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},jV={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Uae={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class Ci{constructor(t,e){this.userDAO=t,this.connectedUserService=e,this.userSubscription=new G1,this.observedPartLoading=!0,this.observedPart=P.empty(),this.observedPartRS=new ste(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(r=>{this.onUserUpdate(r)})}onUserUpdate(t){t===n5.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(P.empty())):this.userSubscription=this.userDAO.subscribeToChanges(t.id,e=>{ye(e.isPresent(),"When observing part service, user was expected to already have a document!");const r=e.get();this.updateObservedPartWithDoc(r.observedPart)})}updateObservedPartWithDoc(t){const e=this.observedPart,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);(!1===r&&!1===s||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=P.ofNullable(t),this.observedPartRS.next(this.observedPart))}updateObservedPart(t){if(ye(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.observedPart.isPresent()){const r={...this.observedPart.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)ye(null!=t[s],"field "+s+" should be set before updating observedPart");return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}}removeObservedPart(){return ye(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}subscribeToObservedPart(t){return this.observedPartObs.subscribe(t)}canUserCreate(){if(this.observedPart.isAbsent())return U.SUCCESS;{const t=Ci.roleToMessage.get(this.observedPart.get().role).get()();return U.failure(t)}}canUserJoin(t,e){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return U.SUCCESS;if(e&&"Observer"===this.observedPart.get().role)return U.SUCCESS;{const r=Ci.roleToMessage.get(this.observedPart.get().role).get()();return U.failure(r)}}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function Jct(n,t){if(1&n&&(an(0),ge(1,31),cn()),2&n){const e=v(2);S(1),A1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),z1(1)}}function e3t(n,t){if(1&n&&(an(0),ge(1,33),cn()),2&n){const e=v(3);S(1),A1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),z1(1)}}function t3t(n,t){if(1&n&&(an(0),ge(1,34),cn()),2&n){const e=v(3);S(1),A1(e.observedPart.get().typeGame),z1(1)}}function n3t(n,t){if(1&n&&(k(0,e3t,2,2,"ng-container",27),k(1,t3t,2,1,"ng-template",null,32,c1)),2&n){const e=t1(2);T("ngIf",v(2).observedPart.get().opponent)("ngIfElse",e)}}function r3t(n,t){if(1&n){const e=Te();b(0,"a",29),J("click",function(){return ue(e),oe(v().navigateToPart())}),k(1,Jct,2,2,"ng-container",27),k(2,n3t,3,2,"ng-template",null,30,c1),O()}if(2&n){const e=t1(3),r=v();S(1),T("ngIf","Observer"===r.observedPart.get().role||"Candidate"===r.observedPart.get().role)("ngIfElse",e)}}function s3t(n,t){if(1&n&&(an(0),X(1,"fa-icon",35),cn()),2&n){const e=v();S(1),T("icon",e.faSpinner)}}function i3t(n,t){if(1&n){const e=Te();an(0),b(1,"div",10)(2,"a",37),St(3),O(),b(4,"div",13)(5,"a",38),J("click",function(){return ue(e),oe(v(2).logout())}),ge(6,39),O()()(),cn()}if(2&n){const e=v(2);S(3),a1(e.username.get())}}Ci.roleToMessage=new zn([{key:"Candidate",value:rm.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:rm.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:rm.YOU_ARE_ALREADY_CREATING},{key:"Player",value:rm.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:rm.YOU_ARE_ALREADY_OBSERVING}]),Ci.\u0275fac=function(t){return new(t||Ci)(Le(uS),Le(Ps))},Ci.\u0275prov=Je({token:Ci,factory:Ci.\u0275fac,providedIn:"root"});const o3t=function(){return["/register"]},a3t=function(){return["/login"]};function c3t(n,t){1&n&&(b(0,"div",40)(1,"a",41)(2,"strong"),ge(3,42),O()(),b(4,"a",43),ge(5,44),O()()),2&n&&(S(1),T("routerLink",J1(2,o3t)),S(3),T("routerLink",J1(3,a3t)))}function l3t(n,t){if(1&n&&(k(0,i3t,7,1,"ng-container",27),k(1,c3t,6,4,"ng-template",null,36,c1)),2&n){const e=t1(2);T("ngIf",v().username.isPresent())("ngIfElse",e)}}const _ce=function(){return["/"]},u3t=function(){return["/play"]},f3t=function(){return["/lobby"]},h3t=function(){return["/local"]},d3t=function(){return["/tutorial"]},p3t=function(){return["/settings"]};let g3t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.observedPartService=s,this.userService=i,this.loading=!0,this.username=P.empty(),this.faCog=Aie,this.faSpinner=aae,this.showMenu=!1,this.observedPart=P.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(e=>{this.observedPart=e})}logout(){var e=this;return A(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return A(function*(){return e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Ps),Q(Ci),Q(nm))},n.\u0275cmp=mt({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,C,w,I;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,C=$localize`Log out`,w=$localize`Register`,I=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],g,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","logout",1,"navbar-item",3,"click"],C,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],w,["id","login",1,"button","is-light",3,"routerLink"],I]},template:function(e,r){if(1&e&&(b(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),O(),b(4,"a",4),J("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),O()(),b(8,"div",6),J("click",function(){return r.showMenu=!r.showMenu}),b(9,"div",7)(10,"a",8),ge(11,9),O(),b(12,"div",10)(13,"a",11),ge(14,12),O(),b(15,"div",13)(16,"a",2),ge(17,14),O(),b(18,"a",2),ge(19,15),O()()(),b(20,"div",10)(21,"a",16),ge(22,17),O(),b(23,"div",13)(24,"a",18),ge(25,19),O(),b(26,"a",20),ge(27,21),O()()()(),b(28,"div",22),k(29,r3t,4,2,"a",23),b(30,"a",24),X(31,"fa-icon",25),O(),b(32,"div",26),k(33,s3t,2,1,"ng-container",27),k(34,l3t,3,2,"ng-template",null,28,c1),O()()()()),2&e){const s=t1(35);S(2),T("routerLink",J1(13,_ce)),S(2),T("ngClass",r.showMenu?"is-active":""),S(4),T("ngClass",r.showMenu?"is-active":""),S(2),T("routerLink",J1(14,_ce)),S(6),T("routerLink",J1(15,u3t)),S(2),T("routerLink",J1(16,f3t)),S(6),T("routerLink",J1(17,h3t)),S(2),T("routerLink",J1(18,d3t)),S(3),T("ngIf",r.observedPart.isPresent()),S(1),T("routerLink",J1(19,p3t)),S(1),T("icon",r.faCog),S(2),T("ngIf",r.loading)("ngIfElse",s)}},dependencies:[En,on,pu,r9],encapsulation:2}),n})(),m3t=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=Hte,this.faFacebook=xte,this.faGithub=Vte}}return n.\u0275fac=function(e){return new(e||n)(Q(pS),Q(Ss))},n.\u0275cmp=mt({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(X(0,"app-header"),b(1,"main",0),X(2,"router-outlet"),O(),b(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),ac(7,3),X(8,"strong"),cc(),O(),St(9," \xa0 "),b(10,"a",4),X(11,"fa-icon",5),O(),St(12,"\xa0 "),b(13,"a",6),X(14,"fa-icon",5),O(),St(15,"\xa0 "),b(16,"a",7),X(17,"fa-icon",5),O()()()()),2&e&&(S(11),T("icon",r.faGithub),S(3),T("icon",r.faTwitter),S(3),T("icon",r.faFacebook))},dependencies:[IN,r9,g3t],encapsulation:2}),n})();class ln{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}toString(){return"("+this.x+","+this.y+")"}}class tH extends ln{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class nH{of(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return G.success(r);return G.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?G.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.of(Math.sign(t),Math.sign(e)):G.failure(C3t.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return G.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return G.failure(`Invalid int direction: ${t}`)}}}class be extends tH{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return be.factory.of(-this.x,-this.y).get()}}be.UP=new be(0,-1),be.UP_RIGHT=new be(1,-1),be.RIGHT=new be(1,0),be.DOWN_RIGHT=new be(1,1),be.DOWN=new be(0,1),be.DOWN_LEFT=new be(-1,1),be.LEFT=new be(-1,0),be.UP_LEFT=new be(-1,-1),be.factory=new class extends nH{constructor(){super(...arguments),this.all=[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT,be.DOWN,be.DOWN_LEFT,be.LEFT,be.UP_LEFT]}},be.DIRECTIONS=be.factory.all,be.DIAGONALS=[be.UP_RIGHT,be.DOWN_RIGHT,be.DOWN_LEFT,be.UP_LEFT],be.ORTHOGONALS=[be.UP,be.RIGHT,be.DOWN,be.LEFT],be.encoder=new class _3t extends C4{encode(t){return t.toString()}decode(t){return ye("string"==typeof t,"Invalid encoded direction"),be.factory.fromString(t).get()}};class Ve extends tH{constructor(t,e){super(t,e)}getOpposite(){return Ve.factory.of(-this.x,-this.y).get()}rotateClockwise(){return Ve.factory.of(-this.y,this.x).get()}}Ve.UP=new Ve(0,-1),Ve.RIGHT=new Ve(1,0),Ve.DOWN=new Ve(0,1),Ve.LEFT=new Ve(-1,0),Ve.factory=new class extends nH{constructor(){super(...arguments),this.all=[Ve.UP,Ve.RIGHT,Ve.DOWN,Ve.LEFT]}of(n,t){return 0===n&&-1===t?G.success(Ve.UP):1===n&&0===t?G.success(Ve.RIGHT):0===n&&1===t?G.success(Ve.DOWN):-1===n&&0===t?G.success(Ve.LEFT):G.failure("Invalid orthogonal from x and y")}},Ve.ORTHOGONALS=Ve.factory.all,Ve.encoder=new class v3t extends C4{encode(t){return t.toString()}decode(t){return ye("string"==typeof t,"Invalid encoded orthogonal"),Ve.factory.fromString(t).get()}};class vce extends _n{maxValue(){return 3}encodeNumber(t){return t===Ve.UP?0:t===Ve.RIGHT?1:t===Ve.DOWN?2:3}decodeNumber(t){switch(t){case 0:return Ve.UP;case 1:return Ve.RIGHT;case 2:return Ve.DOWN;default:return we.expectToBe(t,3,`Encoded orthogonal should be 3 for LEFT but got ${t} instead`),Ve.LEFT}}}let C3t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})();class M extends ln{constructor(t,e){super(t,e),this.x=t,this.y=e}static numberEncoder(t,e){return _n.tuple([_n.numberEncoder(t),_n.numberEncoder(e)],r=>[r.x,r.y],r=>new M(r[0],r[1]))}getNext(t,e){return new M(this.x+(e=e??1)*t.x,this.y+e*t.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new M(this.x+t.y,this.y+-t.x)}getRight(t){return new M(this.x+-t.y,this.y+t.x)}getOpposite(){return new M(-this.x,-this.y)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return be.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new M(t.x-this.x,t.y-this.y)}getMinimalVectorToward(t){return this.getVectorToward(t).toVector()}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}toVector(){const t=Math.abs(this.x),e=Math.abs(this.y),r=Math.max(t,e);let s=this.x,i=this.y,o=2;for(;o<=r;)s%o==0&&i%o==0?(s/=o,i/=o):o++;return new M(s,i)}isBetween(t,e){const r=t.getMinimalVectorToward(this),s=e.getMinimalVectorToward(this);return r.equals(s.getOpposite())}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}toSVGPoint(){return this.x+","+this.y}}M.encoder=new class extends C4{encode(n){return{x:n.x,y:n.y}}decode(n){const t=n;return ye(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new M(t.x,t.y)}};class Cce{constructor(){this.ArrayUtils=Ye}getPlayerClass(t){switch(t){case z.ZERO:return"player0-fill";case z.ONE:return"player1-fill";default:return we.expectToBe(t,de.NONE),""}}}let H0=(()=>{class n extends Cce{constructor(e){super(),this.messageDisplayer=e,this.Player=z,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=P.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?U.SUCCESS:(this.messageDisplayer.gameMessage(e),U.failure(e))}cancelMoveAttempt(){}pass(){var e=this;return A(function*(){return Ss.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),s9=(()=>{class n extends H0{getHexaPointsAtXY(e,r){const s=new M(e,r);return this.getHexaPointsAt(s)}getHexaPointsAt(e){return this.hexaLayout.getHexaPointsAt(e)}getCenterAtXY(e,r){const s=new M(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275cmp=mt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Ne{constructor(t){this.value=t}static from(t){switch(t){case Ne.ZERO.value:return Ne.ZERO;case Ne.ONE.value:return Ne.ONE;case Ne.EMPTY.value:return Ne.EMPTY;case Ne.UNREACHABLE.value:return Ne.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===z.ZERO?Ne.ZERO:(we.expectToBe(t,z.ONE),Ne.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===Ne.ZERO||this===Ne.ONE}}Ne.ZERO=new Ne(z.ZERO.value),Ne.ONE=new Ne(z.ONE.value),Ne.EMPTY=new Ne(de.NONE.value),Ne.UNREACHABLE=new Ne(3);class xe extends tH{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case xe.UP:return 0;case xe.UP_RIGHT:return 60;case xe.RIGHT:return 120;case xe.DOWN:return 180;case xe.DOWN_LEFT:return 240;default:return we.expectToBe(t,xe.LEFT),300}}getOpposite(){return xe.factory.of(-this.x,-this.y).get()}}xe.UP=new xe(0,-1),xe.LEFT=new xe(-1,0),xe.UP_RIGHT=new xe(1,-1),xe.DOWN_LEFT=new xe(-1,1),xe.RIGHT=new xe(1,0),xe.DOWN=new xe(0,1),xe.factory=new class extends nH{constructor(){super(...arguments),this.all=[xe.UP,xe.UP_RIGHT,xe.RIGHT,xe.DOWN,xe.DOWN_LEFT,xe.LEFT]}},xe.encoder=new class y3t extends _n{maxValue(){return 5}encodeNumber(t){switch(t){case xe.UP:return 0;case xe.UP_RIGHT:return 1;case xe.RIGHT:return 2;case xe.DOWN:return 3;case xe.DOWN_LEFT:return 4;default:return 5}}decodeNumber(t){return ye(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),xe.factory.all[t]}};class yce{}class KS extends yce{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}KS.INSTANCE=new KS;class Ts extends yce{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}Ts.INSTANCE=new Ts;class i9{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new M(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new M(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsListAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new M(e.x+i.x,e.y+i.y))}return r}getHexaPointsAt(t){return this.getHexaPointsListAt(t).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(t,e){we.assert(this.orientation===Ts.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(t),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new M(r.x+c.x,r.y+c.y),new M(r.x+c.x,r.y+c.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+o.x,r.y+o.y)],[new M(r.x+s.x,r.y+s.y),new M(r.x+s.x,r.y+s.y+e),new M(r.x+i.x,r.y+i.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+o.x,r.y+o.y),new M(r.x+i.x,r.y+i.y)],[new M(r.x+c.x,r.y+c.y),new M(r.x+c.x,r.y+c.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+i.x,r.y+i.y+e),new M(r.x+s.x,r.y+s.y+e),new M(r.x+s.x,r.y+s.y),new M(r.x+i.x,r.y+i.y),new M(r.x+o.x,r.y+o.y)]]}}let gt=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.CANNOT_SELF_CAPTURE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class q1{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class st{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new st(t.getVictoryValue()):new st(0)}static from(t,e){return t*=z.ZERO.getScoreModifier(),e*=z.ONE.getScoreModifier(),new st(t+e)}toString(){return""+this.value}}class XS{constructor(t){this.turn=t}getCurrentPlayer(){return z.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?z.ZERO:z.ONE}}class ws extends XS{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?P.of(this.board[t.y][t.x]):P.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new M(t,e))}forEachCoord(t){for(const[e,r]of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new M(r,e);this.isOnBoard(s)&&t.push([s,this.getPieceAt(s)])}return t}getCopiedBoard(){return Ye.copyBiArray(this.board)}toMap(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[0].length;r++){const s=new M(r,e);t.push({key:s,value:this.getPieceAt(s)})}return t}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class Zl extends ws{static getInitialState(){const t=Ne.EMPTY,e=Ne.UNREACHABLE,r=Ne.ZERO,s=Ne.ONE;return new Zl([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==Ne.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===Ne.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===Ne.ONE&&(t[0]=t[0]-1);return t}}class yi{}class m3 extends yi{constructor(t,e){super(),this.coord=new M(t,e)}}class d2 extends m3{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return G.success(new d2(t,e,P.empty()))}catch(r){return G.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];Ye.sortByDescending(s,d2.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=xe.factory.fromDelta(i.x,i.y);if(o.isFailure())return G.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?G.failure("Distance between first coord and last coord is too great"):c.equals(r)?d2.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?d2.fromSingleCoord(s[0],r):G.success(new d2(s[1],r,P.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}d2.encoder=new class extends _n{maxValue(){return 104831}encodeNumber(n){const t=9*n.coord.x*8+8*n.coord.y+n.dir.toInt();if(n.isSingleCoord())return t;{const e=n.lastPiece.get();return 9*e.x*2*9*9*8+2*e.y*9*9*8+648+t}}decodeNumber(n){const t=n%8;n=(n-t)/8;const r=xe.factory.fromInt(t).get(),s=n%9,i=(n=(n-s)/9)%9;n=(n-i)/9;const o=new M(i,s);if(0===n)return d2.fromSingleCoord(o,r).get();{const c=(n=(n-1)/2)%9,u=(n=(n-c)/9)%9;n=(n-u)/9;const h=new M(u,c);return d2.fromDoubleCoord(o,h,r).get()}}};var vn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(vn||(vn={})),vn))();let QS=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class V1{constructor(t,e=P.empty(),r=P.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=P.empty(),this.hopedValue=new zn,this.ownValue=new zn,this.possibleMoves=new zn,this.ownValue=new zn,null!=s){const o=s.getBoardValue(this);this.ownValue.set(s.name,o),this.hopedValue.set(s.name,o.value)}QS.createdNodes++,K(V1.VERBOSE||!1,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(K(V1.VERBOSE||!1,"VICTORY"),vn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(K(V1.VERBOSE||!1,"PRE_VICTORY_MIN"),vn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(K(V1.VERBOSE||!1,"PRE_VICTORY_MAX"),vn.PRE_VICTORY):(K(V1.VERBOSE||!1,"DEFAULT"),vn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return QS.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return K(V1.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return K(V1.VERBOSE||!1,"isLeaf-EndGame("+V1.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);ye(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=P.of([]));const h=this.getBestChilds(u,t,e,r,s,i,o),g=this.getBestChildAmongst(h,i),m=g.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),g}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new $t(r)),new $t(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let g=h===z.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===z.ZERO?(C,w)=>C<w:(C,w)=>w<C;for(const C of t){const I=this.getOrCreateChild(C,i).alphaBeta(e-1,r,s,i,o,c),H=I.getHopedValue(i);if(m(H,g)||0===u.length?(g=H,u=[I]):H===g&&u.push(I),c&&m(g,h===z.ZERO?r:s))break;h===z.ZERO?s=Math.min(g,s):r=Math.max(g,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();ye(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=P.of(new V1(o,P.of(this),P.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){ye(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return P.of(e);return P.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}V1.VERBOSE=!1,V1.minimaxes=new zn;class Ie{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===z.ZERO?Ie.ZERO_WON:Ie.ONE_WON}static getDefeat(t){return t===z.ZERO?Ie.ONE_WON:Ie.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}Ie.ZERO_WON=new Ie(!0,z.ZERO),Ie.ONE_WON=new Ie(!0,z.ONE),Ie.DRAW=new Ie(!0,de.NONE),Ie.ONGOING=new Ie(!1,de.NONE);class tr{constructor(t){this.stateType=t,this.setInitialBoard()}choose(t){K(!1,"Rules.choose: "+t.toString()+" was proposed");const r=this.isLegal(t,this.node.gameState);if(this.node.hasMoves()){K(!1,"Rules.choose: current node has moves");const o=this.node.getSonByMove(t);if(o.isPresent())return ye(r.isSuccess(),"Rules.choose: Move is illegal: "+r.getReasonOr("")),K(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=o.get(),!0}if(K(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),r.isFailure())return K(!1,"Rules.choose: Move is illegal: "+r.getReason()),!1;K(!1,"Rules.choose: Move is legal, let's apply it");const s=this.applyLegalMove(t,this.node.gameState,r.get()),i=new V1(s,P.of(this.node),P.of(t));return this.node=i,!0}setInitialBoard(){const t=this.stateType.getInitialState();V1.ruler=this,this.node=new V1(t)}applyMoves(t,e,r){let s=0;for(const i of t){const o=r(i),c=this.isLegal(o,e);ye(c.isSuccess(),"Can't create state from invalid moves ("+s+"): "+c.toString()+"."),e=this.applyLegalMove(o,e,c.get()),s++}return e}}let F0=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class _3 extends tr{static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toFailedFallible():t.isSingleCoord()?_3.isLegalPush(t,e):_3.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?U.failure(gt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===Ne.ofPlayer(e.getCurrentOpponent())?U.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):U.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=Ne.ofPlayer(e.getCurrentPlayer()),o=Ne.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?G.failure(F0.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?G.success(c):_3.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=Ne.ofPlayer(r.getCurrentOpponent()),u=Ne.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?G.failure(F0.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===Ne.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?G.failure(F0.CANNOT_PUSH_YOUR_OWN_PIECES()):G.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=Ne.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return G.failure(F0.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=Ne.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return G.failure(F0.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===Ne.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return G.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?Ie.ZERO_WON:e[1]>5?Ie.ONE_WON:Ie.ONGOING}applyLegalMove(t,e,r){return new Zl(r,e.turn+1)}isLegal(t,e){return _3.isLegal(t,e)}getGameStatus(t){return _3.getGameStatus(t)}}class M3t extends q1{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new M(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of xe.factory.all){const h=d2.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){e.push(h);for(const g of xe.factory.all)for(let m=1;m<=2&&!g.equals(u);m++){const C=c.getNext(g,m);if(!C.isInRange(9,9))break;{const w=d2.fromDoubleCoord(c,C,u).get();_3.isLegal(w,r).isSuccess()&&e.push(w)}}}}}return new $t(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=_3.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new Zl(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getBoardValue(t){const e=_3.getGameStatus(t);if(e.isEndGame)return new st(e.toBoardValue());const r=t.gameState.getScores();return new st(r[1]-r[0])}}class fe{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=P.empty(),this.previousState=P.empty()}static fromMove(t,e,r,s,i,o){return new S3t(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new T3t(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new P3t(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new w3t(t,e,r,s,i,o)}static informational(t,e,r){return new b3t(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=P.of(t),this}withPreviousState(t){return this.previousState=P.of(t),this}}class JS extends fe{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class S3t extends JS{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,ye(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class P3t extends JS{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class T3t extends JS{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class w3t extends JS{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class b3t extends fe{isInformation(){return!0}}class lr{}const Tn=Ne.EMPTY,Gs=Ne.UNREACHABLE,yc=Ne.ZERO,o9=Ne.ONE;class Ece extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Initial board and goal of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Zl.getInitialState()),fe.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Zl.getInitialState(),d2.fromSingleCoord(new M(2,6),xe.UP).get(),$localize`Congratulations!`),fe.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Zl([[Gs,Gs,Gs,Gs,Tn,yc,yc,o9,o9],[Gs,Gs,Gs,Tn,Tn,Tn,Tn,Tn,Tn],[Gs,Gs,Tn,yc,yc,yc,o9,yc,Tn],[Gs,Tn,Tn,Tn,Tn,Tn,Tn,Tn,Tn],[Tn,Tn,Tn,Tn,yc,yc,yc,o9,o9],[Tn,Tn,Tn,Tn,Tn,Tn,Tn,Tn,Gs],[Tn,Tn,Tn,Tn,yc,o9,Tn,Gs,Gs],[Tn,Tn,Tn,yc,Tn,Tn,Gs,Gs,Gs],[Tn,Tn,yc,Tn,Tn,Gs,Gs,Gs,Gs]],0),[d2.fromSingleCoord(new M(4,4),xe.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function O3t(n,t){if(1&n){const e=Te();B(),b(0,"circle",6),J("click",function(){ue(e);const s=v(2).index,i=v().index;return oe(v().onPieceClick(s,i))}),O()}if(2&n){const e=v(2).index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("cx",s.getCenterAtXY(e,r).x)("cy",s.getCenterAtXY(e,r).y)("r",.5*s.SPACE_SIZE)}}function N3t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"polygon",4),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onSpaceClick(s,i))}),O(),k(2,O3t,1,6,"circle",5),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();S(1),We("id","space_",r,"_",i,""),T("ngClass",o.getSquareClasses(r,i)),D("points",o.getHexaPointsAtXY(r,i)),S(1),T("ngIf",o.isPiece(s))}}function A3t(n,t){if(1&n&&(B(),b(0,"g"),k(1,N3t,3,5,"g",3),O()),2&n){const e=t.$implicit,r=v(2);S(1),T("ngIf",r.isBoard(e))}}function I3t(n,t){if(1&n&&(B(),b(0,"g"),k(1,A3t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function x3t(n,t){1&n&&(B(),b(0,"marker",7),X(1,"polygon",8),O()),2&n&&S1("id","arrowhead_",t.$implicit.dir.toString(),"")}function k3t(n,t){if(1&n){const e=Te();B(),b(0,"g"),X(1,"line",9),b(2,"line",10),J("click",function(){const i=ue(e).$implicit;return oe(v().chooseDirection(i.dir))}),O(),b(3,"polygon",11),J("click",function(){const i=ue(e).$implicit;return oe(v().chooseDirection(i.dir))}),O()()}if(2&n){const e=t.$implicit;S(1),S1("id","line_start_",e.dir.toString(),""),D("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),S(1),S1("id","line_end_",e.dir.toString(),""),D("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),S(1),S1("id","direction_",e.dir.toString(),""),D("transform",e.transformation)}}class L3t{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let R3t=(()=>{class n extends s9{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new _3(Zl),this.availableMinimaxes=[new M3t(this.rules,"Dummy")],this.encoder=d2.encoder,this.tutorial=(new Ece).tutorial,this.scores=P.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new i9(this.SPACE_SIZE,new M(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),KS.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=P.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.rules.node.mother.get().gameState;let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return A(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?U.SUCCESS:s.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return A(function*(){return s.selecteds=[new M(e,r)],s.showPossibleDirections(),U.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=Ne.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of xe.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=e?d2.fromSingleCoord(i,c).get():d2.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),C=this.getCenterAt(u),w=this.getMiddleOfArrow(c,u,C),I=C.x+" "+C.y,H=xe.getAngle(c)+150,te=new L3t(m,w,C,u,c,"rotate("+H+" "+I+") translate("+I+")");this.directions.push(te)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new M(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==Ne.UNREACHABLE}isPiece(e){return e!==Ne.EMPTY}secondClick(e,r){var s=this;return A(function*(){const i=s.selecteds[0],o=new M(e,r);if(o.equals(i))return s.cancelMoveAttempt(),U.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(F0.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],g=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(g))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),U.SUCCESS})()}thirdClick(e,r){var s=this;return A(function*(){const i=new M(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),U.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return A(function*(){const o=be.factory.fromMove(r,e);if(o.isSuccess()){const u=be.factory.fromMove(s,e);if(o.equals(u)){const h=r.getDistance(e),g=s.getDistance(e);return 2===Math.max(h,g)?(i.selecteds.push(e),Ye.sortByDescending(i.selecteds,d2.sortCoord),i.showPossibleDirections(),U.SUCCESS):i.cancelMove(F0.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(F0.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return A(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),U.SUCCESS})()}chooseDirection(e){var r=this;return A(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return A(function*(){const s=r.getState();let i;const o=r.selecteds[0];return i=1===r.selecteds.length?d2.fromSingleCoord(o,e).get():d2.fromDoubleCoord(o,r.selecteds[r.selecteds.length-1],e).get(),r.chooseMove(i,s,r.scores.get())})()}onSpaceClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return A(function*(){const i=new M(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return U.failure("not a direction")})()}getSquareClasses(e,r){const s=new M(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new M(e,r),i=z.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,I3t,2,1,"g",1),b(2,"defs"),k(3,x3t,2,1,"marker",2),O(),k(4,k3t,4,12,"g",1),O()),2&e&&(S(1),T("ngForOf",r.hexaBoard),S(2),T("ngForOf",r.directions),S(1),T("ngForOf",r.directions))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class wn{constructor(t){this.x=t}static from(t){switch(t){case 0:return wn.ZERO;case 1:return wn.ONE;case 2:return wn.TWO;default:return ye(3===t,"Invalid Apagos Coord "+t),wn.THREE}}equals(t){return this.x===t.x}}wn.ZERO=new wn(0),wn.ONE=new wn(1),wn.TWO=new wn(2),wn.THREE=new wn(3);let a9=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class H1 extends yi{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return we.getNonNullable(H1.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(P.empty())))}static transfer(t,e){if(t.x<=e.x)return G.failure(a9.PIECE_SHOULD_MOVE_DOWNWARD());const r=we.getNonNullable(H1.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(P.empty())&&s.starting.equals(P.of(t))));return G.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}H1.ALL_MOVES=[new H1(wn.ZERO,P.of(z.ZERO),P.empty()),new H1(wn.ONE,P.of(z.ZERO),P.empty()),new H1(wn.TWO,P.of(z.ZERO),P.empty()),new H1(wn.THREE,P.of(z.ZERO),P.empty()),new H1(wn.ZERO,P.of(z.ONE),P.empty()),new H1(wn.ONE,P.of(z.ONE),P.empty()),new H1(wn.TWO,P.of(z.ONE),P.empty()),new H1(wn.THREE,P.of(z.ONE),P.empty()),new H1(wn.TWO,P.empty(),P.of(wn.THREE)),new H1(wn.ONE,P.empty(),P.of(wn.THREE)),new H1(wn.ZERO,P.empty(),P.of(wn.THREE)),new H1(wn.ONE,P.empty(),P.of(wn.TWO)),new H1(wn.ZERO,P.empty(),P.of(wn.TWO)),new H1(wn.ZERO,P.empty(),P.of(wn.ONE))],H1.encoder=new class extends _n{maxValue(){return H1.ALL_MOVES.length}encodeNumber(n){const t=H1.ALL_MOVES.findIndex(e=>e.equals(n));return ye(t>=0,n.toString()+" is not part of possibles moves of Apagos!"),t}decodeNumber(n){return ye(n<H1.ALL_MOVES.length,n+" is not a valid encoded number for ApagosMove decoder"),H1.ALL_MOVES[n]}};class Mm{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return G.failure("invalid starting space");const s=new zn([{key:z.ZERO,value:t},{key:z.ONE,value:e},{key:de.NONE,value:r}]);s.makeImmutable();const i=new Mm(s);return G.success(i)}isFull(){return this.count(z.ZERO)+this.count(z.ONE)>=this.count(de.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(z.ZERO),r=this.count(z.ONE);const s=this.count(de.NONE);return t===z.ZERO?e++:r++,Mm.from(e,r,s).get()}substractPiece(t){let e=this.count(z.ZERO),r=this.count(z.ONE);const s=this.count(de.NONE);return t===z.ZERO?e--:r--,Mm.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(z.ZERO),e=this.count(z.ONE);return t>e?z.ZERO:e>t?z.ONE:de.NONE}equals(t){return this.containing.equals(t.containing)}}let B0=(()=>{class n extends XS{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const C=Mm.from(r[0][u],r[1][u],r[2][u]).get();o.push(C)}const c=new zn;return c.set(z.ZERO,s),c.set(z.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Ye.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class M4 extends tr{constructor(){super(B0)}static get(){return M4.singleton.isAbsent()&&(M4.singleton=P.of(new M4)),M4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new B0(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===wn.THREE)return i.updateAt(t.landing,c);{const u=wn.from(t.landing.x+1),h=i.getPieceAt(u);return i.updateAt(t.landing,h).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new B0(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?G.failure(a9.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?G.failure(a9.NO_PIECE_REMAINING_TO_DROP()):G.success(void 0)}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?G.failure(a9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):G.success(void 0)}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(wn.from(s)).isFull())return Ie.ONGOING;const r=e.getPieceAt(wn.THREE).getDominatingPlayer();return ye(r.isPlayer(),"winner can only be a player if the game is finished"),Ie.getVictory(r)}}M4.singleton=P.empty();class D3t extends q1{getListMoves(t){const e=t.gameState;return H1.ALL_MOVES.filter(function r(s){return M4.get().isLegal(s,e).isSuccess()})}getBoardValue(t){const e=M4.get().getGameStatus(t);if(e.isEndGame)return st.fromWinner(e.winner);const r=t.gameState.board[3].getDominatingPlayer();return r.isPlayer()?new st(r.getScoreModifier()):new st(0)}}class Mce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Initial board and goal of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,B0.getInitialState()),fe.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,B0.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),H1.drop(wn.ZERO,z.ZERO),$localize`Congratulations!`),fe.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,B0.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),H1.transfer(wn.TWO,wn.ZERO).get(),(t,e,r)=>t.isDrop()?U.failure($localize`This move is a drop, please do a transfer!`):U.SUCCESS,$localize`Congratulations!`),fe.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,B0.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),H1.drop(wn.TWO,z.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(z.ONE)?U.SUCCESS:U.failure($localize`You actively made your opponent win!`):U.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}function z3t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=t.$implicit,r=v();D("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function V3t(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=t.$implicit,r=v();D("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function H3t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",9),J("click",function(){ue(e);const s=v().index,i=v();return oe(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),O()}if(2&n){const e=v().index,r=v();S1("id","dropArrow_zero_",e,""),T("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),D("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function F3t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",9),J("click",function(){ue(e);const s=v().index,i=v();return oe(i.onArrowClick(s,i.PlayerOrNone.ONE))}),O()}if(2&n){const e=v().index,r=v();S1("id","dropArrow_one_",e,""),T("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),D("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function B3t(n,t){if(1&n){const e=Te();B(),an(0),b(1,"circle",10),J("click",function(){ue(e);const s=v().index;return oe(v().onSquareClick(s))}),O(),cn()}if(2&n){const e=t.$implicit,r=v(),s=r.index,i=r.$implicit,o=v();S(1),Ko("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),T("ngClass",o.getPieceClasses(s,e,i)),D("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function $3t(n,t){if(1&n){const e=Te();B(),b(0,"g"),k(1,H3t,1,4,"polygon",7),k(2,F3t,1,4,"polygon",7),b(3,"rect",8),J("click",function(){const i=ue(e).index;return oe(v().onSquareClick(i))}),O(),k(4,B3t,2,6,"ng-container",4),O()}if(2&n){const e=t.$implicit,r=t.index,s=v();D("transform",s.getBlockTransform(r)),S(1),T("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),S(1),T("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),S(1),S1("id","square_",r,""),T("ngClass",s.getSquareClasses(r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngForOf",s.ArrayUtils.range(e.count(s.PlayerOrNone.NONE)))}}let U3t=(()=>{class n extends H0{constructor(e){super(e),this.PlayerOrNone=de,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=B0.PIECES_PER_PLAYER,this.selectedPiece=P.empty(),this.leftPiece=P.empty(),this.droppedPiece=P.empty(),this.displayableArrow=[],this.rules=M4.get(),this.hasAsymetricBoard=!0,this.availableMinimaxes=[new D3t(this.rules,"ApagosDummyMinimax")],this.encoder=H1.encoder,this.tutorial=(new Mce).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=P.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(z.ZERO).get(),this.remainingOne=e.remaining.get(z.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=P.empty(),this.leftPiece=P.empty(),this.selectedPiece=P.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=P.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===z.ZERO?s-1:e.count(de.NONE)-s}showLastTransfer(e){const r=this.rules.node.mother.get().gameState,s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=P.of({square:i,piece:c});const u=e.landing.x,g=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=P.of({square:u,piece:g})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(z.ZERO).get()>0&&this.displayableArrow.push({x:r,player:z.ZERO}),e.remaining.get(z.ONE).get()>0&&this.displayableArrow.push({x:r,player:z.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(de.NONE))return new M(i,o);const c=s.count(de.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,g=h*Math.cos(u),m=h*Math.sin(u);return new M(i+g,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return A(function*(){const o=s.canUserPlay("#dropArrow_"+(r===z.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=wn.from(e);let u;if(s.selectedPiece.isPresent()){const g=s.selectedPiece.get().square;u=H1.transfer(wn.from(g),c).get()}else u=H1.drop(c,r);const h=s.getState();return s.chooseMove(u,h)})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(z.ZERO),u=s.count(z.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===z.ZERO?c++:u++}const h=s.count(de.NONE)-(u+c),g=this.getPieceColor(r,c,h);return""!==g&&o.push(g),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),U.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(a9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=P.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(a9.NO_POSSIBLE_TRANSFER_REMAINS()):U.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g"),k(2,z3t,1,3,"circle",1),k(3,V3t,1,3,"circle",2),O(),b(4,"g",3),k(5,$3t,5,8,"g",4),O()()),2&e&&(D("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),S(1),D("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),S(1),T("ngForOf",r.ArrayUtils.range(r.remainingOne)),S(1),T("ngForOf",r.ArrayUtils.range(r.remainingZero)),S(2),T("ngForOf",r.board))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Eo=(()=>{class n extends H0{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275cmp=mt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Wi extends ws{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=Ye.createTable(6,2,4);return new Wi(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let rH=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})(),S4=(()=>{class n extends tr{applyLegalMove(e,r,s){K(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:r});const i=e.x,o=r.getCurrentPlayer(),u=r.getCurrentOpponent().value,h=r.getCopiedBoard(),g=n.distribute(i,u,h),m=g[g.length-1];return m.y===u?new Wi(h,r.turn+1,r.captured):this.applyPotentialCapture(o,m,h,r)}applyPotentialCapture(e,r,s,i){const o=i.getCurrentOpponent(),c=[i.captured[0],i.captured[1]],u=n.captureIfLegal(r.x,r.y,e,s);c[e.value]+=u.capturedSum;const h=u.resultingBoard;if(n.mustMansoon(e,h)){const g=n.mansoon(o,h);return c[o.value]+=g.capturedSum,new Wi(g.resultingBoard,i.turn+1,c)}return new Wi(h,i.turn+1,c)}static mustMansoon(e,r){return n.isStarving(e,r)&&!1===n.canDistribute(e.getOpponent(),r)}static mansoon(e,r){const s=Ye.copyBiArray(r);let i=0;const o=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let c=0;const u=e.getOpponent().value;do{i+=s[u][c],o[u][c]=s[u][c],s[u][c]=0,c++}while(c<6);return{capturedSum:i,captureMap:o,resultingBoard:s}}static isLegal(e,r){const s=r.getCurrentOpponent(),i=s.value,o=e.x;if(0===r.getPieceAtXY(o,i))return G.failure(rH.MUST_CHOOSE_NON_EMPTY_HOUSE());const c=n.isStarving(s,r.board),u=!1===n.doesDistribute(o,i,r.board);return c&&u?G.failure(rH.SHOULD_DISTRIBUTE()):G.success(void 0)}isLegal(e,r){return n.isLegal(e,r)}static doesDistribute(e,r,s){return 0===r?s[r][e]>5-e:s[r][e]>e}static canDistribute(e,r){for(let s=0;s<6;s++)if(n.doesDistribute(s,e.getOpponent().value,r))return!0;return!1}static isStarving(e,r){let s=0;const i=e.getOpponent().value;do{if(r[i][s++]>0)return!1}while(s<6);return!0}static distribute(e,r,s){const i=e,o=r;let c=s[r][e];const u=[];for(s[r][e]=0;c>0;)0===r?5===e?r=1:e++:0===e?r=0:e--,(e!==i||r!==o)&&(s[r][e]+=1,u.push(new M(e,r)),c--);return u}static capture(e,r,s,i){const o=Ye.copyBiArray(i);ye(r!==s.getOpponent().value,"AwaleRules.capture cannot capture the players house");let u=o[r][e],h=0;const g=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(u<2||u>3)return{capturedSum:0,captureMap:g,resultingBoard:o};let m=-1,C=-1;s===z.ONE&&(m=1,C=6);do{g[r][e]=u,h+=u,o[r][e]=0,u=o[r][e+=m]}while(e!==C&&(2===u||3===u));return{capturedSum:h,captureMap:g,resultingBoard:o}}static captureIfLegal(e,r,s,i){const o=Ye.copyBiArray(i),c=n.capture(e,r,s,i),u=n.isStarving(s.getOpponent(),c.resultingBoard);return c.capturedSum>0&&u?{capturedSum:0,resultingBoard:o,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:c}static getGameStatus(e){const r=e.gameState;return r.captured[0]>24?Ie.ZERO_WON:r.captured[1]>24?Ie.ONE_WON:24===r.captured[0]&&24===r.captured[1]?Ie.DRAW:Ie.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class m1 extends yi{constructor(t){super(),this.x=t}static from(t){switch(t){case 0:return m1.ZERO;case 1:return m1.ONE;case 2:return m1.TWO;case 3:return m1.THREE;case 4:return m1.FOUR;default:return ye(5===t,"Invalid x for AwaleMove: "+t),m1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}m1.ZERO=new m1(0),m1.ONE=new m1(1),m1.TWO=new m1(2),m1.THREE=new m1(3),m1.FOUR=new m1(4),m1.FIVE=new m1(5),m1.encoder=new class extends _n{maxValue(){return 5}encodeNumber(n){return n.x}decodeNumber(n){return m1.from(n)}};class G3t extends q1{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=m1.from(c),S4.isLegal(o,r).isSuccess()&&(o=m1.from(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return Ye.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],h=S4.distribute(o.x,s,c),g=h[h.length-1];let m,C=0;return g.y===s?(m=0,u<=6&&(C=10)):m=S4.captureIfLegal(g.x,i,r,c).capturedSum,100*m+C-u}),e}getBoardValue(t){const e=S4.getGameStatus(t);if(e.isEndGame)return st.fromWinner(e.winner);const s=t.gameState.getCapturedCopy();return new st(s[1]-s[0])}}class Sce extends lr{constructor(){super(...arguments),this.tutorial=[fe.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awal are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,Wi.getInitialState(),m1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),fe.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new Wi([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),m1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),fe.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new Wi([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),fe.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new Wi([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),fe.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new Wi([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),fe.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new Wi([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[m1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),fe.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new Wi([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[m1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),fe.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new Wi([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),m1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),fe.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new Wi([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),m1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function W3t(n,t){if(1&n){const e=Te();B(),b(0,"text",7),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onClick(s,i))}),St(1),O()}if(2&n){const e=v().index,r=v().index,s=v();We("id","captured_",e,"_",r,""),D("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),S(1),zi(" ",-s.captured[r][e]," ")}}function q3t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"circle",4),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),O(),b(2,"text",5),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),St(3),O(),k(4,W3t,2,6,"text",6),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",i.getSpaceClasses(r,s)),D("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),S(1),We("id","number_",r,"__",s,""),D("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),S(1),zi(" ",e," "),S(1),T("ngIf",i.captured[s][r]>0)}}function j3t(n,t){if(1&n&&(B(),b(0,"g"),k(1,q3t,5,12,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let Z3t=(()=>{class n extends Eo{constructor(e){super(e),this.last=P.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymetricBoard=!0,this.scores=P.of([0,0]),this.rules=new S4(Wi),this.availableMinimaxes=[new G3t(this.rules,"AwaleMinimax")],this.encoder=m1.encoder,this.tutorial=(new Sce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=P.of(e.getCapturedCopy()),this.hidePreviousMove();const r=this.rules.node.move;if(this.board=e.getCopiedBoard(),r.isPresent()){const s=e.getCurrentPlayer().value;this.last=P.of(new M(r.get().x,s)),this.showPreviousMove()}else this.last=P.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showPreviousMove(){const e=this.rules.node.move.get(),r=this.rules.node.mother.get().gameState,s=Ye.copyBiArray(r.board),i=r.getCurrentOpponent().value;this.filledCoords=S4.distribute(e.x,i,s);const o=this.filledCoords[this.filledCoords.length-1];if(o.y!==i){const c=S4.captureIfLegal(o.x,o.y,r.getCurrentPlayer(),s);this.captured=c.captureMap;const u=this.getState().getCurrentPlayer();S4.mustMansoon(u.getOpponent(),c.resultingBoard)&&(this.captured=S4.mansoon(u,c.resultingBoard).captureMap)}}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(rH.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=P.empty();const o=m1.from(e);return s.chooseMove(o,s.getState())})()}getSpaceClasses(e,r){const s=new M(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),X(1,"rect",1),k(2,j3t,2,1,"g",2),X(3,"line",3),O()),2&e&&(D("transform",r.rotation),S(2),T("ngForOf",r.board))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class P4 extends yi{constructor(t,e){super(),this.first=t,this.second=e}static getEncoder(t){return new class extends Gi{encodeMove(e){return{first:M.encoder.encode(e.first),second:M.encoder.encode(e.second)}}decodeMove(e){ye(null!=we.getNonNullable(e).first,"Encoded MoveWithTwoCoords should contain a first coord"),ye(null!=we.getNonNullable(e).second,"Encoded MoveWithTwoCoords should contain a second coord");const r=M.encoder.decode(we.getNonNullable(e).first),s=M.encoder.decode(we.getNonNullable(e).second);return t(r,s).get()}}}getFirst(){return this.first}getSecond(){return this.second}}class $0 extends P4{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(gt.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return be.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}}let eP=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class sH extends $0{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(eP.MOVE_MUST_BE_ORTHOGONAL())}equals(t){return t===this||!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Mo extends sH{static of(t,e){return new Mo(t,e)}static from(t,e){try{const r=new Mo(t,e);return G.success(r)}catch(r){return G.failure(r.message)}}getMaximalDistance(){return 7}}Mo.encoder=P4.getEncoder(Mo.from);const Y3t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:z.ZERO};class fn{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}fn.UNOCCUPIED=new fn(de.NONE,!1),fn.PLAYER_ONE_KING=new fn(de.ONE,!0),fn.INVADERS=new fn(de.ZERO,!1),fn.DEFENDERS=new fn(de.ONE,!1);class j1{constructor(t){this.value=t}}j1.NONE=new j1("NONE"),j1.OPPONENT=new j1("OPPONENT"),j1.PLAYER=new j1("PLAYER");class iH extends ws{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new M(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===de.NONE?j1.NONE:t===r?j1.PLAYER:j1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class v3 extends iH{static getInitialState(){const t=fn.UNOCCUPIED,e=fn.INVADERS,r=fn.DEFENDERS;return new v3([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,fn.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}from(t,e){return new v3(t,e)}}let oH=(()=>{class n extends tr{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){K(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?G.failure(i.getReason()):G.success(void 0)}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.getStart());if(i===j1.NONE)return U.failure(gt.MUST_CHOOSE_PLAYER_PIECE());if(i===j1.OPPONENT)return U.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.getEnd())!==j1.NONE)return U.failure(eP.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.getEnd())){if(!s.getPieceAt(r.getStart()).isKing())return U.failure(eP.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return U.failure(eP.THRONE_IS_LEFT_FOR_GOOD())}const c=r.getStart().getDirectionToward(r.getEnd()).get(),u=r.getStart().getOrthogonalDistance(r.getEnd());let h=r.getStart().getNext(c);for(let g=1;g<u;g++){if(s.getPieceAt(h)!==fn.UNOCCUPIED)return U.failure(gt.SOMETHING_IN_THE_WAY());h=h.getNext(c)}return U.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===j1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):P.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:h,left:g,leftCoord:m,right:C,rightCoord:w}=this.getSurroundings(o,s,e,i);return!1===h?this.captureKingAgainstTheWall(g,C,o):u===j1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,g,C):u===j1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,g,m,C,w):P.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):j1.NONE,h=e.getLeft(r),m=h.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,h):j1.NONE,C=e.getRight(r),I=C.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,C):j1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:h,left:m,rightCoord:C,right:I}}captureKingAgainstTheWall(e,r,s){let o=e===j1.PLAYER?1:0;return o+=r===j1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(K(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),P.of(s)):P.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return P.of(r)}else{const c=i===j1.PLAYER,u=s===j1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return P.of(r)}return P.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let h=j1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(h=i.getRelativeOwner(e,u)),h===j1.NONE?!1===this.isThrone(i,u)?(K(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),P.empty()):(K(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.of(c)):h===j1.PLAYER?(K(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.of(c)):(K(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return P.of(r);const h=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,g=this.isThrone(e,i),m=s===j1.PLAYER||g&&h,C=this.isThrone(e,c);return m&&(o===j1.PLAYER||C&&h)?(K(n.VERBOSE||!1,"king captured by 4 invaders"),P.of(r)):P.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r){K(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const s=r.turn,i=r.getCopiedBoard(),o=r.getCurrentPlayer(),c=e.getStart(),u=e.getEnd();i[u.y][u.x]=i[c.y][c.x],i[c.y][c.x]=fn.UNOCCUPIED;for(const h of Ve.ORTHOGONALS){const g=this.tryCapture(o,e.getEnd(),h,r);g.isPresent()&&(i[g.get().y][g.get().x]=fn.UNOCCUPIED)}return r.from(i,s+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?Ie.getVictory(s.get()):Ie.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return K(!1,"The king is dead, victory to invader"),P.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(K(!1,"The king escape, victory to defender"),P.of(this.getDefender())):this.isPlayerImmobilized(z.ZERO,e)?(K(!1,"Zero has no move, victory to one"),P.of(z.ONE)):this.isPlayerImmobilized(z.ONE,e)?(K(!1,"One has no move, victory to zero"),P.of(z.ZERO)):(K(!1,"no victory"),P.empty())}getKingCoord(e){K(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return P.of(new M(s,r));return P.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);K(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const h of u){const g=this.generateMove(c,h);i.push(g)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new M(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of Ve.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===de.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class a5 extends oH{constructor(){super(v3,Y3t,Mo.of)}static get(){return null==a5.singleton&&(a5.singleton=new a5),V1.ruler=this.singleton,a5.singleton}}class aH extends Eo{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=fn.UNOCCUPIED,this.captureds=[],this.chosen=P.empty(),this.lastMove=P.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){K(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}showPreviousMove(){const t=this.rules.node.mother.get().gameState,e=this.getState().getCurrentOpponent();for(const r of Ve.ORTHOGONALS){const s=this.lastMove.get().getEnd().getNext(r,1);if(s.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const o=t.getRelativeOwner(e,s)===j1.OPPONENT,u=this.getState().getPieceAt(s)===fn.UNOCCUPIED;o&&u&&this.captureds.push(s)}}}updateViewInfo(){const t=[];for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===de.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return A(function*(){K(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),U.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return A(function*(){K(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new M(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get(),r.getState()):r.cancelMove(o.getReason())})()}choosePiece(t){return K(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===fn.UNOCCUPIED?this.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=P.of(t),this.updateViewInfo(),K(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),U.SUCCESS):this.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===j1.PLAYER}cancelMoveAttempt(){this.chosen=P.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new M(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new M(t,e))}getPieceClasses(t,e){const r=[],s=new M(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new M(t,e);if(this.captureds.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new M(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===fn.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class tP extends q1{getListMoves(t){K(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?Ye.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(r)):Ye.sortByDescending(e,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),e}getBoardValue(t){const e=t.gameState,r=this.ruler.getWinner(e);if(r.isPresent())return new st(r.get().getVictoryValue());const s=this.ruler.getPlayerListPawns(z.ZERO,e).length,i=this.ruler.getPlayerListPawns(z.ONE,e).length;let o=[1,2][this.ruler.config.INVADER.value];o*=z.ZERO.getScoreModifier();let c=[2,1][this.ruler.config.INVADER.value];return c*=z.ONE.getScoreModifier(),new st(s*o+i*c)}}class nP{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class Pce extends nP{constructor(t,e){super(new $t([t]),e),this.directThreat=t,this.mover=e}}class K3t extends $t{constructor(t){if(super(),this.mapping=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.mapping;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.mapping;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class mr extends K3t{toFields(t){return[[t.y],t.x]}}class rP extends tP{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return new st(e.toBoardValue());const r=t.gameState,s=fn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of z.PLAYERS)for(const g of o.get(h).get())if(u.get(g).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const C of Ve.ORTHOGONALS){let w=g.getNext(C,1);for(;w.isInRange(this.width,this.width)&&r.getPieceAt(w)===s;)m++,w=w.getNext(C,1)}i+=m*h.getScoreModifier()}return new st(i)}getPiecesMap(t){const e=fn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new M(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===z.ZERO?r.push(u):s.push(u))}return new zn([{key:z.ZERO,value:new mr(r)},{key:z.ONE,value:new mr(s)}])}getThreatMap(t,e){const r=new zn;for(const s of z.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new $t(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);ye(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of Ve.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const h of Ve.ORTHOGONALS){if(h===o.getOpposite())continue;let g=t.getNext(o,1);for(;g.isInRange(this.width,this.width)&&e.getPieceAt(g)===fn.UNOCCUPIED;)g=g.getNext(h);g.isInRange(this.width,this.width)&&e.getAbsoluteOwner(g)===s&&!1===t.getNext(o,1).equals(g)&&u.push(g)}i.push(new Pce(c,new mr(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==z.ONE&&e.getPieceAt(t)!==fn.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new zn,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new mr(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),h=[];for(const g of u)if(!1===o.contains(g.directThreat)){const m=[];for(const C of g.mover)!1===o.contains(C)&&m.push(C);m.length>0&&h.push(new Pce(g.directThreat,new mr(m)))}h.length>0&&r.set(c,new $t(h))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class C3 extends rP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return new st(e.toBoardValue());const r=t.gameState,s=this.ruler.config.WIDTH,i=fn.UNOCCUPIED;let o=0;const c=this.getPiecesMap(r),u=this.getThreatMap(r,c),h=this.filterThreatMap(u,r);for(const g of z.PLAYERS){const m=new mr;for(const C of c.get(g).get())if(h.get(C).isPresent())o+=g.getScoreModifier()*C3.SCORE_BY_THREATENED_PIECE;else{o+=g.getScoreModifier()*C3.SCORE_BY_SAFE_PIECE;for(const w of Ve.ORTHOGONALS){let I=C.getNext(w,1);for(;I.isInRange(s,s)&&r.getPieceAt(I)===i;)m.add(I),I=I.getNext(w,1)}}for(const C of m){const w=this.getControlledPieceValue(C.x,C.y,s);o+=g.getScoreModifier()*w}}return new st(o)}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}}C3.SCORE_BY_THREATENED_PIECE=530,C3.SCORE_BY_SAFE_PIECE=16*C3.SCORE_BY_THREATENED_PIECE+1;class c9 extends C3{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return new st(e.toBoardValue());const r=t.gameState,s=this.ruler.config.WIDTH,i=fn.UNOCCUPIED;let o=0,c=0,u=0;const h=this.getPiecesMap(r),g=this.getThreatMap(r,h),m=this.filterThreatMap(g,r);for(const w of z.PLAYERS){const I=new mr;for(const H of h.get(w).get())if(m.get(H).isPresent())c+=w.getScoreModifier();else{o+=w.getScoreModifier();for(const Y of Ve.ORTHOGONALS){let ee=H.getNext(Y,1);for(;ee.isInRange(s,s)&&r.getPieceAt(ee)===i;)I.add(ee),ee=ee.getNext(Y,1)}}for(const H of I){const Y=this.getControlledPieceValue(H.x,H.y,s);u+=w.getScoreModifier()*Y}}const C=this.getStepForEscape(r);return new st(531*C*17*17+531*o*17+531*c+u)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(Number.MAX_SAFE_INTEGER)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?P.empty():i.some(o=>this.ruler.isExternalThrone(o))?P.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of Ve.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===fn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}c9.SCORE_BY_THREATENED_PIECE=530,c9.SCORE_BY_SAFE_PIECE=16*C3.SCORE_BY_THREATENED_PIECE+1,c9.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];const ne=fn.UNOCCUPIED,Z1=fn.INVADERS,sa=fn.DEFENDERS,Sm=fn.PLAYER_ONE_KING;class Tce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,v3.getInitialState()),fe.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,v3.getInitialState(),Mo.of(new M(3,1),new M(1,1)),$localize`Congratulations!`),fe.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new v3([[ne,ne,ne,Z1,ne,ne,ne],[ne,ne,ne,Z1,ne,ne,ne],[Z1,ne,ne,sa,ne,ne,ne],[ne,ne,sa,Sm,sa,Z1,Z1],[ne,ne,Z1,ne,ne,ne,ne],[ne,ne,ne,sa,ne,Z1,ne],[ne,ne,ne,Z1,ne,ne,ne]],1),[Mo.of(new M(3,5),new M(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),fe.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new v3([[ne,ne,ne,Z1,ne,ne,ne],[ne,ne,Z1,ne,ne,ne,ne],[ne,ne,ne,sa,ne,ne,ne],[Z1,sa,ne,ne,sa,Z1,Z1],[ne,sa,ne,ne,ne,ne,ne],[ne,Z1,ne,Sm,ne,Z1,ne],[ne,ne,ne,Z1,ne,ne,ne]],12),[Mo.of(new M(2,1),new M(3,1)),Mo.of(new M(3,0),new M(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),fe.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new v3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,sa,ne,ne,ne],[ne,ne,ne,Z1,ne,ne,ne],[ne,Z1,ne,Sm,Z1,ne,ne],[ne,ne,ne,Z1,ne,ne,ne],[ne,sa,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Mo.of(new M(1,3),new M(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),fe.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new v3([[ne,ne,Z1,ne,ne,ne,ne],[ne,ne,ne,Z1,ne,ne,ne],[ne,ne,ne,Sm,Z1,ne,ne],[ne,Z1,sa,ne,sa,ne,ne],[ne,ne,ne,Z1,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Mo.of(new M(2,0),new M(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),fe.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new v3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Z1,ne,Z1,ne,ne,ne],[Z1,ne,ne,ne,sa,ne,ne],[ne,ne,ne,sa,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Sm,ne,Z1,ne,ne,ne]],72),[Mo.of(new M(3,6),new M(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function X3t(n,t){1&n&&(B(),X(0,"polygon",8))}function Q3t(n,t){1&n&&(B(),X(0,"rect",9))}function J3t(n,t){if(1&n&&(B(),b(0,"g"),k(1,X3t,1,0,"polygon",6),k(2,Q3t,1,0,"ng-template",null,7,c1),O()),2&n){const e=t1(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function e4t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function t4t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function n4t(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function r4t(n,t){if(1&n&&(B(),k(0,t4t,1,1,"polyline",14),k(1,n4t,4,20,"ng-template",null,15,c1)),2&n){const e=t1(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function s4t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",10),k(2,e4t,6,25,"g",11),k(3,r4t,3,2,"ng-template",null,12,c1),O()),2&n){const e=t1(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function i4t(n,t){if(1&n){const e=Te();B(),b(0,"g",3),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),X(1,"rect",4),k(2,J3t,4,2,"g",5),k(3,s4t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function o4t(n,t){if(1&n&&(B(),b(0,"g"),k(1,i4t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function a4t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",17),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let c4t=(()=>{class n extends aH{constructor(e){super(e,!1,Mo.from),this.rules=a5.get(),this.availableMinimaxes=[new tP(this.rules,"DummyBot"),new rP(this.rules,"Piece > Influence"),new C3(this.rules,"Piece > Control"),new c9(this.rules,"Escape > Piece > Control")],this.encoder=Mo.encoder,this.tutorial=(new Tce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,o4t,2,1,"g",1),k(2,a4t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),wce=(()=>{class n extends H0{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new M(.5*this.SPACE_SIZE*e,c);return[h,new M(i,u),new M(o,c),h]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new M(.5*this.SPACE_SIZE*e,u);return[h,new M(i,c),new M(o,u),h]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275cmp=mt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),l9=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n.CANNOT_CAPTURE_OWN_PIECES=()=>$localize`You cannot capture your own pieces.`,n})();class nr{constructor(t,e){this.direction=t,this.str=e}static fromCoords(t,e){const r=t.getVectorToward(e),s=nr.STEPS.findIndex(i=>i.direction.equals(r));if(-1===s)throw new Error(l9.INVALID_DISTANCE());return nr.STEPS[s]}toInt(){return nr.STEPS.findIndex(t=>t.direction.equals(this.direction))}equals(t){return this===t}toString(){return this.str}}nr.LEFT=new nr(new ln(-2,0),"LEFT"),nr.UP_LEFT=new nr(be.UP_LEFT,"UP_LEFT"),nr.UP_RIGHT=new nr(be.UP_RIGHT,"UP_RIGHT"),nr.RIGHT=new nr(new ln(2,0),"RIGHT"),nr.DOWN_LEFT=new nr(be.DOWN_LEFT,"DOWN_LEFT"),nr.DOWN_RIGHT=new nr(be.DOWN_RIGHT,"DOWN_RIGHT"),nr.STEPS=[nr.LEFT,nr.UP_LEFT,nr.UP_RIGHT,nr.RIGHT,nr.DOWN_LEFT,nr.DOWN_RIGHT];class bs extends yi{constructor(t,e,r,s){super(),this.start=t,this.step=e,this.landingCoord=r,this.capture=s}static fromMovement(t,e){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new M(t.x+e.direction.x,t.y+e.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new bs(P.of(t),P.of(e),P.of(r),P.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new bs(P.empty(),P.empty(),P.empty(),P.of(t))}static fromCoordToCoord(t,e){const r=nr.fromCoords(t,e);return bs.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(t){return!(!this.capture.equals(t.capture)||!this.start.equals(t.start)||!this.step.equals(t.step))}}bs.encoder=new class extends _n{maxValue(){return 1035}encodeNumber(n){if(n.isTileExchange()){const t=n.capture.get().y;return 10*n.capture.get().x+t}{const t=n.start.get().y,e=n.start.get().x;return 150*(n.step.get().toInt()+1)+10*e+t}}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%10,e=(n=(n-t)/10)%15;return 0==(n=(n-e)/15)?bs.fromTilesExchange(new M(e,t)):bs.fromMovement(new M(e,t),nr.STEPS[n-1])}};class Ec{static getNeighbors(t){let e;const r=new M(t.x-1,t.y),s=new M(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new M(t.x,t.y-1)]:[r,s,new M(t.x,t.y+1)],e}static getFakeNeighbors(t){return new M(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=Ec.getNeighbors(t),s=Ec.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return P.of(o);c++}i++}return P.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class c5 extends ws{static getEmptyNeighbors(t,e,r){const s=[];for(const i of Ec.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return c5.getEmptyNeighbors(this.board,t,e)}}class P1 extends c5{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new M(e,r)}static getPresentNeighborEntrances(t){return[new M(t.x+1,t.y-1),new M(t.x+3,t.y+0),new M(t.x+3,t.y+1),new M(t.x+1,t.y+2),new M(t.x-1,t.y+1),new M(t.x-1,t.y+0)].filter(P1.isInRange)}static getInitialState(){const t=Ne.EMPTY,e=Ne.UNREACHABLE,r=Ne.ZERO,s=Ne.ONE;return new P1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){K(P1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.start.get(),r=t.landingCoord.get(),s=this.getCopiedBoard();return s[r.y][r.x]=Ne.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=Ne.EMPTY,new P1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){K(P1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return Ec.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,Ne.EMPTY).length}capture(t){K(P1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return K(P1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=Ne.EMPTY,r[this.getCurrentPlayer().value]+=1,new P1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){K(P1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=P1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=P1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===Ne.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){ye(this.getPieceAt(t)!==Ne.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new ln(r,e),1);if(this.getPieceAt(s)!==Ne.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=P.empty();for(let s=0;s<6;s++){const o=t.getNext(P1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==Ne.UNREACHABLE&&(r.isAbsent()&&(r=P.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){K(P1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=Ne.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new P1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of nr.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===Ne.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new M(r,e),Ne.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}P1.VERBOSE=!1,P1.NEIGHBORS_TILES_DIRECTIONS=[new ln(0,-2),new ln(3,-1),new ln(3,1),new ln(0,2),new ln(-3,1),new ln(-3,-1)],P1.isInRange=n=>n.isInRange(15,10);let sP=(()=>{class n extends tr{applyLegalMove(e,r,s){return e.isTileExchange()?this.applyLegalTileExchange(e,r):this.applyLegalMovement(e,r)}applyLegalTileExchange(e,r){const s=r.getCopiedBoard(),i=e.capture.get();s[i.y][i.x]=Ne.EMPTY;const o=[r.captures[0],r.captures[1]];o[r.getCurrentPlayer().value]+=1;const c=[r.tiles[0],r.tiles[1]];c[r.getCurrentPlayer().value]-=2;const u=new P1(s,r.turn,c,o),h=u.removeTilesIfNeeded(i,!1),g=new P1(h.getCopiedBoard(),h.turn+1,h.tiles,h.captures);return K(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:r,afterCapture:u,afterTileRemoval:h,resultingState:g}}),g}applyLegalMovement(e,r){const s=r.applyLegalMovement(e),i=s.removeTilesIfNeeded(e.start.get(),!0),o=i.doMovementCaptures(e),c=new P1(o.board,r.turn+1,o.tiles,o.captures);return K(n.VERBOSE,{ab_state:r,afterMovement:s,afterTilesRemoved:i,afterCaptures:o,resultingState:c}),c}isLegal(e,r){return e.isTileExchange()?this.isLegalTileExchange(e,r):this.isLegalMovement(e,r)}isLegalTileExchange(e,r){if(r.tiles[r.getCurrentPlayer().value]<2)return G.failure(l9.NOT_ENOUGH_TILES_TO_EXCHANGE());const s=r.getPieceAt(e.capture.get());return s===Ne.UNREACHABLE||s===Ne.EMPTY?G.failure(l9.CANNOT_CAPTURE_FROM_EMPTY()):s.is(r.getCurrentPlayer())?G.failure(l9.CANNOT_CAPTURE_OWN_PIECES()):G.success(void 0)}isLegalMovement(e,r){if(r.getPieceAt(e.start.get())===Ne.UNREACHABLE){const o="Cannot start with a coord outside the board "+e.start.get().toString()+".";return G.failure(o)}if(r.getPieceAt(e.landingCoord.get())===Ne.UNREACHABLE){const o="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return G.failure(o)}const s=r.getPieceAt(e.start.get());return s===Ne.EMPTY?G.failure(gt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.is(r.getCurrentOpponent())?G.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):r.getPieceAt(e.landingCoord.get()).is(r.getCurrentPlayer())?G.failure(gt.MUST_LAND_ON_EMPTY_SPACE()):G.success(void 0)}static getGameStatus(e){const r=e.gameState;return r.captures[0]>=18?Ie.ZERO_WON:r.captures[1]>=18?Ie.ONE_WON:Ie.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class bce extends q1{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=Ne.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new M(c,o);if(r.getPieceAt(u)===i){const h=bs.fromTilesExchange(u);e.push(h)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new M(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const h of u){const g=bs.fromCoordToCoord(c,h);e.push(g)}}}return e}getBoardValue(t){const e=sP.getGameStatus(t);if(e.isEndGame)return st.fromWinner(e.winner);const r=t.gameState,s=r.getPiecesByFreedom(),i=this.getPiecesScore(s);return new st(2*r.captures[1]+i[1]-(2*r.captures[0]+i[0]))}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return Ye.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return e.isTileExchange()?[e.capture.get()]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.start.get(),!0).getCapturedNeighbors(e.landingCoord.get())}}let l4t=(()=>{class n extends bce{getBoardValue(e){const r=sP.getGameStatus(e);if(r.isEndGame)return st.fromWinner(r.winner);const s=e.gameState,i=this.getPiecesMap(s),o=this.getThreatMap(s,i),c=this.filterThreatMap(o,s);let u=0;for(const h of z.PLAYERS)for(const g of i.get(h).get())c.get(g).isPresent()?u+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;return u+=s.tiles[1]-s.tiles[0],new st(u)}getPiecesMap(e){const r=new zn,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new M(c,o),h=e.getPieceAt(u);h===Ne.ZERO?s.push(u):h===Ne.ONE&&i.push(u)}return r.set(z.ZERO,new mr(s)),r.set(z.ONE,new mr(i)),r}getThreatMap(e,r){const s=new zn;for(const i of z.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=z.of(r.getPieceAt(e).value).getOpponent();let o=P.empty(),c=P.empty(),u=[];const h=Ec.getNeighbors(e).filter(g=>g.isInRange(15,10));for(const g of h){const m=r.getPieceAt(g);if(m.is(i))u.push(g),this.tileCouldBeRemovedThisTurn(g,r,i)&&(c=P.of(g));else if(m===Ne.EMPTY){if(o.isPresent())return P.empty();o=P.of(g)}}if(o.isPresent()){const g=[];for(const m of nr.STEPS){const C=o.get().getNext(m.direction,1);C.isInRange(15,10)&&r.getPieceAt(C).is(i)&&!1===u.some(w=>w.equals(C))&&g.push(C)}if(g.length>0)return P.of(new nP(new mr(u),new mr(g)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const g=new mr(u);return P.of(new nP(g,new mr([c.get()])))}return P.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=P.empty();const u=P1.getTilesUpperLeftCoord(e);for(let h=0;h<2;h++)for(let g=0;g<3;g++){const m=u.getNext(new ln(g,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=P.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=P1.getTilesUpperLeftCoord(e);for(const i of nr.STEPS){const o=e.getNext(i.direction,1),c=P1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===Ne.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new zn,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new mr(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=e.get(u).get();let g=P.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const C=[];for(const w of h.mover)!1===c.contains(w)&&C.push(w);C.length>0&&(g=P.of(new nP(h.directThreats,new mr(C))))}g.isPresent()&&s.set(u,g.get())}for(const u of c){const h=e.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const le=Ne.EMPTY,F=Ne.UNREACHABLE,F1=Ne.ZERO,Qn=Ne.ONE;class Oce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,P1.getInitialState()),fe.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,P1.getInitialState(),bs.fromCoordToCoord(new M(3,5),new M(5,5)),$localize`Congratulations! Let's see captures now.`),fe.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new P1([[F,F,F,F,F,F,F1,le,F1,F,F,F,F,F,F],[F,F,F,F1,le,le,le,le,le,F1,le,le,F,F,F],[le,Qn,le,Qn,F1,Qn,le,le,F1,le,le,Qn,le,Qn,le],[Qn,le,le,le,le,le,le,le,le,le,Qn,le,le,le,Qn],[le,Qn,le,Qn,le,le,le,le,le,le,le,Qn,le,Qn,le],[le,F1,le,F1,le,le,le,le,le,le,le,F1,le,F1,le],[F1,le,le,le,F1,le,le,le,le,le,F1,le,le,le,F1],[le,F1,le,F1,le,le,Qn,le,Qn,le,le,F1,le,F1,le],[F,F,F,le,le,Qn,le,le,le,Qn,le,le,F,F,F],[F,F,F,F,F,F,Qn,le,Qn,F,F,F,F,F,F]],3,[0,0],[0,0]),[bs.fromCoordToCoord(new M(5,2),new M(4,1)),bs.fromCoordToCoord(new M(3,4),new M(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),fe.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new P1([[F,F,F,F,F,F,le,le,le,F,F,F,F,F,F],[F,F,F,F,F,F,Qn,le,le,F,F,F,F,F,F],[le,le,le,F,F,F,le,le,le,F,F,F,F,F,F],[le,le,Qn,le,le,le,le,F1,le,F,F,F,F,F,F],[le,le,le,Qn,le,le,le,le,le,F,F,F,F,F,F],[le,le,le,le,le,le,le,le,le,le,le,F1,F,F,F],[le,le,F1,le,le,Qn,le,le,le,le,F1,le,le,le,F1],[le,le,le,le,le,le,Qn,le,Qn,le,le,F1,le,F1,le],[F,F,F,le,le,Qn,le,le,le,Qn,le,le,F,F,F],[F,F,F,F,F,F,Qn,le,Qn,F,F,F,F,F,F]],2,[0,0],[0,0]),[bs.fromCoordToCoord(new M(2,6),new M(4,6)),bs.fromCoordToCoord(new M(2,6),new M(3,5)),bs.fromCoordToCoord(new M(2,6),new M(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),fe.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new P1([[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,le,le,F1,F,F,F,F,F,F,F,F,F],[F,F,F,le,le,le,le,le,le,F,F,F,F,F,F],[F,F,F,le,le,le,Qn,le,Qn,F,F,F,F,F,F],[F,F,F,le,le,Qn,le,le,le,F,F,F,F,F,F],[F,F,F,F,F,F,Qn,le,Qn,F,F,F,F,F,F]],1,[0,2],[0,0]),[bs.fromTilesExchange(new M(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),fe.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new P1([[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,le,le,F1,F,F,F,F,F,F],[F,F,F,le,le,F1,le,le,le,F,F,F,F,F,F],[F,F,F,le,F1,Qn,le,Qn,le,F,F,F,F,F,F],[F,F,F,le,Qn,F1,le,le,le,F,F,F,F,F,F],[F,F,F,le,le,Qn,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F]],1,[0,0],[0,0]),[bs.fromCoordToCoord(new M(7,6),new M(6,5)),bs.fromCoordToCoord(new M(7,6),new M(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function u4t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPyramidClass(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function f4t(n,t){if(1&n&&(B(),X(0,"polygon",13)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getEmptyClass(e,r)),D("points",s.getTriangleCoordinate(e,r))}}function h4t(n,t){if(1&n&&(B(),k(0,f4t,1,2,"polygon",12)),2&n){const e=v().index,r=v().index;T("ngIf",v().isEmptySpace(e,r))}}function d4t(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=v().index,r=v().index,s=v();We("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function p4t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=v().index,r=v().index,s=v();We("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function g4t(n,t){if(1&n){const e=Te();B(),b(0,"g",6),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),k(1,u4t,1,2,"polygon",7),k(2,h4t,1,1,"ng-template",null,8,c1),k(4,d4t,1,3,"polygon",9),k(5,p4t,1,3,"polygon",10),O()}if(2&n){const e=t.$implicit,r=t.index,s=t1(3),i=v().index,o=v();We("id","click_",r,"_",i,""),S(1),T("ngIf",o.isPyramid(r,i))("ngIfElse",s),S(3),T("ngIf",e!==o.NONE),S(1),T("ngIf",e!==o.NONE)}}function m4t(n,t){if(1&n&&(B(),b(0,"g"),k(1,g4t,6,6,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function _4t(n,t){if(1&n&&(B(),X(0,"polygon",16)),2&n){const e=t.$implicit;D("points",v().getTriangleCoordinate(e.x,e.y))}}function v4t(n,t){if(1&n&&(B(),X(0,"polygon",17)),2&n){const e=v();D("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function C4t(n,t){if(1&n&&(B(),X(0,"polygon",17)),2&n){const e=v();D("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function y4t(n,t){if(1&n&&(B(),X(0,"polygon",18)),2&n){const e=v();We("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}const E4t=function(n){return["base",n]};function M4t(n,t){if(1&n&&(B(),b(0,"g",20),X(1,"polygon",21),b(2,"text",22),St(3),O()()),2&n){const e=v().$implicit,r=v();T("id","tilesCount"+e),S(1),T("ngClass",c3(8,E4t,"player"+e+"-fill")),D("points",r.getTilesCountCoordinate(0===e?0:4.5,0===e?0:6))("stroke",r.lastTurnWasTilesExchange(e)?"yellow":"black"),S(1),D("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0==e?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:8.5))("font-size",r.SPACE_SIZE/2),S(1),a1(r.tiles[e])}}function S4t(n,t){if(1&n&&(B(),b(0,"g"),k(1,M4t,4,10,"g",19),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngIf",r.mustShowTilesOf(e))}}const P4t=function(){return[0,1]};let T4t=(()=>{class n extends wce{constructor(e){super(e),this.tiles=[0,0],this.NONE=Ne.UNREACHABLE,this.chosenCoord=P.empty(),this.lastStart=P.empty(),this.lastEnd=P.empty(),this.possibleLandings=[],this.scores=P.of([0,0]),this.rules=new sP(P1),this.availableMinimaxes=[new bce(this.rules,"Normal"),new l4t(this.rules,"Piece > Threat > Tiles")],this.encoder=bs.encoder,this.tutorial=(new Oce).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=P.empty(),this.state=this.getState(),this.scores=P.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=P.empty(),this.lastEnd=P.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=P.empty(),this.possibleLandings=[]}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),U.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return A(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=bs.fromTilesExchange(e);return r.chooseMove(i,r.state,r.state.captures)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=P.of(e),r.showHighlight(),U.SUCCESS):r.cancelMove(l9.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return A(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=bs.fromCoordToCoord(r.chosenCoord.get(),e);return r.chooseMove(s,r.state,r.state.captures)}return r.cancelMove(l9.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.rules.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===Ne.ZERO?this.getPlayerClass(z.ZERO):s===Ne.ONE?this.getPlayerClass(z.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===Ne.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.rules.node.mother;if(this.board[r][e]===Ne.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===Ne.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===Ne.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-coerceo"]],features:[l],decls:7,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,m4t,2,1,"g",1),k(2,_4t,1,1,"polygon",2),k(3,v4t,1,1,"polygon",3),k(4,C4t,1,1,"polygon",3),k(5,y4t,1,3,"polygon",4),k(6,S4t,2,1,"g",1),O()),2&e&&(D("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.possibleLandings),S(1),T("ngIf",r.lastStart.isPresent()),S(1),T("ngIf",r.lastEnd.isPresent()),S(1),T("ngIf",r.chosenCoord.isPresent()),S(1),T("ngForOf",J1(7,P4t)))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Yl=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class Lt extends ws{static getInitialState(){const t=Ye.createTable(Lt.WIDTH,Lt.HEIGHT,de.NONE);return new Lt(t,0)}isShelter(t){return 0===t.x||t.x===Lt.WIDTH-1?Lt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===Lt.HEIGHT-1)&&Lt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=Lt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=Lt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}Lt.WIDTH=17,Lt.HEIGHT=17,Lt.CENTRAL_ZONE_TOP_LEFT=new M(4,6),Lt.CENTRAL_ZONE_BOTTOM_RIGHT=new M(12,10),Lt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Lt.ALL_SHELTERS=new $t(Lt.SHELTERS_INDICES.flatMap(n=>[new M(n,0),new M(n,Lt.HEIGHT-1),new M(0,n),new M(Lt.WIDTH-1,n)])).toList();class U0 extends m3{constructor(t){super(t.x,t.y)}static of(t){return t.isInRange(Lt.WIDTH,Lt.HEIGHT)?G.success(new U0(t)):G.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!t.isDrop()&&this.coord.equals(t.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}U0.encoder=class E3t{static getEncoder(t,e,r){return new class extends _n{constructor(){super(...arguments),this.shiftX=e}maxValue(){return(t-1)*this.shiftX+(e-1)}encodeNumber(s){return s.coord.x*this.shiftX+s.coord.y}decodeNumber(s){const i=s%e;s/=e;const c=new M((s-=s%1)%t,i);return r(c)}}}}.getEncoder(Lt.WIDTH,Lt.HEIGHT,n=>U0.of(n).get());class G0 extends $0{constructor(t,e){super(t,e)}static from(t,e){return t.isInRange(Lt.WIDTH,Lt.HEIGHT)&&e.isInRange(Lt.WIDTH,Lt.HEIGHT)?t.isAlignedWith(e)&&1===t.getDistance(e)?G.success(new G0(t,e)):G.failure(Yl.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):G.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(!t.isSimple()||t!==this&&(!1===t.getStart().equals(this.getStart())||!1===t.getEnd().equals(this.getEnd())))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}G0.encoder=P4.getEncoder(G0.from);class y3 extends yi{constructor(t){super(),this.coords=t}static of(t){if(t.length<2)return G.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(Lt.WIDTH,Lt.HEIGHT))return G.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return G.failure(Yl.INVALID_JUMP());return new mr(t).size()===t.length?G.success(new y3(t)):G.failure(Yl.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=Ye.copyImmutableArray(this.coords);return e.push(t),y3.of(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(t.isSimple()||t.isDrop()||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}y3.encoder=new class extends Gi{constructor(){super(...arguments),this.coordEncoder=M.numberEncoder(Lt.WIDTH,Lt.HEIGHT)}encodeMove(n){return{coords:n.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(n){ye(null!=we.getNonNullable(n).coords,"Encoded ConspirateursMoveJump should contain coords");const e=we.getNonNullable(n).coords.map(this.coordEncoder.decodeNumber);return y3.of(e).get()}};const w4t=Gi.disjunction3(U0.encoder,G0.encoder,y3.encoder,n=>n.isDrop(),n=>n.isSimple());class Da extends tr{constructor(){super(Lt)}static get(){return Da.singleton.isAbsent()&&(Da.singleton=P.of(new Da)),Da.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(t.isDrop())s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(t.isSimple())s[t.getStart().y][t.getStart().x]=de.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=de.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new Lt(s,e.turn+1)}isLegal(t,e){return t.isDrop()?this.dropLegality(t,e):t.isSimple()?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?G.failure(Yl.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?G.failure(gt.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?G.failure(Yl.MUST_DROP_IN_CENTRAL_ZONE()):G.success(void 0)}simpleMoveLegality(t,e){return e.turn<40?G.failure(Yl.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?G.failure(gt.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.getEnd()).isPlayer()?G.failure(gt.MUST_LAND_ON_EMPTY_SPACE()):G.success(void 0)}jumpLegality(t,e){if(e.turn<40)return G.failure(Yl.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===de.NONE)return G.failure(Yl.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return G.failure(gt.MUST_LAND_ON_EMPTY_SPACE());return G.success(void 0)}jumpTargetsFrom(t){const e=[new M(t.x+2,t.y),new M(t.x-2,t.y),new M(t.x,t.y+2),new M(t.x,t.y-2),new M(t.x+2,t.y+2),new M(t.x+2,t.y-2),new M(t.x-2,t.y+2),new M(t.x-2,t.y-2)],r=[];for(const s of e)y3.of([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of Lt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return Ie.getVictory(i)}return Ie.ONGOING}}Da.singleton=P.empty();class b4t extends q1{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(r.isDrop()?1:r.isSimple()?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=Lt.CENTRAL_ZONE_TOP_LEFT,s=Lt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===de.NONE&&e.push(U0.of(new M(o,i)).get());return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<Lt.HEIGHT;s++)for(let i=0;i<Lt.WIDTH;i++){const o=new M(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new M(e.x+1,e.y),new M(e.x-1,e.y),new M(e.x,e.y+1),new M(e.x,e.y-1),new M(e.x+1,e.y+1),new M(e.x+1,e.y-1),new M(e.x-1,e.y+1),new M(e.x-1,e.y-1)];for(const i of s){const o=G0.from(e,i);o.isSuccess()&&Da.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new $t;for(const s of Da.get().jumpTargetsFrom(e)){const i=y3.of([e,s]).get();Da.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=Da.get().nextJumps(e,t),s=new $t(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(t,i));return s}getBoardValue(t){const e=t.gameState;let r=0;const s=new zn([{key:z.ZERO,value:0},{key:z.ONE,value:0}]);for(let i=0;i<Lt.HEIGHT;i++)for(let o=0;o<Lt.WIDTH;o++){const c=new M(o,i),u=e.getPieceAt(c);if(u.isPlayer())if(e.isShelter(c)){if(r+=20*u.getScoreModifier(),s.replace(u,s.get(u).get()+1),20===s.get(u).get())return new st(u.getVictoryValue())}else{let h=100;for(const g of Lt.ALL_SHELTERS)if(e.getPieceAt(g)===de.NONE){const m=c.getOrthogonalDistance(g);h=Math.min(h,m)}r-=u.getScoreModifier()*h}}return new st(r)}}const E=de.NONE,Nt=de.ZERO,wt=de.ONE;class Nce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Lt.getInitialState()),fe.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Lt.getInitialState(),U0.of(new M(7,7)).get(),$localize`Congratulations!`),fe.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Lt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,Nt,Nt,wt,wt,Nt,Nt,wt,Nt,wt,E,E,E,E],[E,E,E,E,Nt,wt,Nt,wt,Nt,Nt,Nt,Nt,wt,E,E,E,E],[E,E,E,E,Nt,wt,E,E,E,E,E,wt,Nt,E,E,E,E],[E,E,E,E,wt,Nt,Nt,wt,wt,wt,Nt,Nt,Nt,E,E,E,E],[E,E,E,E,wt,Nt,wt,wt,wt,wt,wt,wt,Nt,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),G0.from(new M(4,6),new M(3,5)).get(),(t,e,r)=>t.isSimple()?U.SUCCESS:U.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),fe.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Lt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,Nt,Nt,wt,wt,Nt,Nt,wt,Nt,wt,E,E,E,E],[E,E,E,E,Nt,wt,Nt,wt,Nt,Nt,Nt,Nt,wt,E,E,E,E],[E,E,E,E,Nt,wt,E,E,E,E,E,wt,Nt,E,E,E,E],[E,E,E,E,wt,Nt,Nt,wt,wt,wt,Nt,Nt,Nt,E,E,E,E],[E,E,E,E,wt,Nt,wt,wt,wt,wt,wt,wt,Nt,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),y3.of([new M(6,7),new M(6,5)]).get(),(t,e,r)=>t.isJump()?U.SUCCESS:U.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),fe.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Lt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,wt,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,wt,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,wt,E,E,E,E,E,E,E,E,E],[E,E,E,E,Nt,Nt,E,wt,Nt,Nt,wt,Nt,wt,E,E,E,E],[E,E,E,E,Nt,E,Nt,wt,Nt,Nt,Nt,Nt,wt,E,E,E,E],[E,E,E,E,Nt,wt,E,E,E,E,E,wt,Nt,E,E,E,E],[E,E,E,E,wt,Nt,Nt,wt,wt,wt,Nt,Nt,Nt,E,E,E,E],[E,E,E,E,wt,Nt,wt,wt,wt,wt,wt,wt,Nt,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),[y3.of([new M(8,6),new M(6,4),new M(6,2),new M(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}function O4t(n,t){if(1&n){const e=Te();B(),b(0,"rect",9),J("click",function(){ue(e);const s=v().$implicit;return oe(v(2).onClick(s.coord))}),O()}if(2&n){const e=v().$implicit,r=v(2);D("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function N4t(n,t){if(1&n){const e=Te();B(),b(0,"circle",6),J("click",function(){ue(e);const s=v().$implicit;return oe(v(2).onClick(s.coord))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function A4t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",6),J("click",function(){const i=ue(e).$implicit;return oe(v(2).onClick(i.coord))}),O(),k(2,O4t,1,4,"rect",7),k(3,N4t,1,6,"circle",8),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.isShelter),S(1),T("ngIf",e.hasPiece)}}function I4t(n,t){if(1&n&&(B(),b(0,"g"),k(1,A4t,4,9,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function x4t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",10),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),T("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function k4t(n,t){if(1&n&&(B(),X(0,"circle",11)),2&n){const e=t.$implicit,r=v();S1("id","sidePiece_0_",e,""),D("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function L4t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=t.$implicit,r=v();S1("id","sidePiece_1_",e,""),D("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function R4t(n,t){if(1&n&&(B(),X(0,"rect",13)),2&n){const e=v();D("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let D4t=(()=>{class n extends H0{constructor(e){super(e),this.ALL_SHELTERS=Lt.ALL_SHELTERS,this.CENTRAL_ZONE_START=Lt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new ln(Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Lt.CENTRAL_ZONE_TOP_LEFT.x+1,Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Lt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=P.empty(),this.jumpInConstruction=P.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Da.get(),this.availableMinimaxes=[new b4t(this.rules,"ConspirateursMinimax")],this.encoder=w4t,this.tutorial=(new Nce).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<Lt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<Lt.WIDTH;s++){const i=new M(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of Lt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=Da.get().getGameStatus(this.rules.node);if(!0===r.isEndGame)for(const s of Lt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=P.empty(),this.selected=P.empty(),this.updateBoard()}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=P.of(e),r.jumpInConstruction=P.empty()),r.updateViewInfo(),U.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=U0.of(e);return ye(o.isSuccess(),"ConspirateursMove should be valid by construction"),r.chooseMove(o.get(),i)}return r.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return A(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s,i);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return A(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=P.of(e),r.updateViewInfo(),U.SUCCESS):r.chooseMove(e,s)})()}selectNextCoord(e){var r=this;return A(function*(){const s=r.selected.get(),i=G0.from(s,e);if(i.isSuccess())return r.chooseMove(i.get(),r.getState());{const o=y3.of([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,I4t,2,1,"g",1),k(2,x4t,2,5,"g",1),k(3,k4t,1,4,"circle",2),k(4,L4t,1,4,"circle",3),k(5,R4t,1,4,"rect",4),X(6,"polyline",5),O()),2&e&&(S(1),T("ngForOf",r.viewInfo.boardInfo),S(1),T("ngForOf",r.ALL_SHELTERS),S(1),T("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),S(1),T("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),S(1),T("ngIf",r.viewInfo.dropPhase),S(1),D("points",r.viewInfo.lastMoveArrow))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Cn{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===z.ZERO?e?Cn.ZERO_SECOND:Cn.ZERO_FIRST:t===z.ONE?e?Cn.ONE_SECOND:Cn.ONE_FIRST:Cn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}Cn.encoder=_n.tuple([z.numberEncoder,_n.booleanEncoder],n=>[n.owner,n.otherPieceType],n=>Cn.of(n[0],n[1])),Cn.EMPTY=new Cn(de.NONE,!1),Cn.ZERO_FIRST=new Cn(z.ZERO,!1),Cn.ZERO_SECOND=new Cn(z.ZERO,!0),Cn.ONE_FIRST=new Cn(z.ONE,!1),Cn.ONE_SECOND=new Cn(z.ONE,!0),Cn.PLAYER_PIECES=[Cn.ZERO_FIRST,Cn.ZERO_SECOND,Cn.ONE_FIRST,Cn.ONE_SECOND];class W0 extends yi{constructor(t,e){if(super(),this.target=t,this.piece=e,e===Cn.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(t){return t instanceof W0&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}W0.encoder=_n.tuple([_n.numberEncoder(7),Cn.encoder],n=>[n.target,n.piece],n=>new W0(n[0],n[1]));class Ei extends yi{constructor(t,e){super(),this.start=t,this.moveDirection=e}static fromRepresentation(t,e){return new Ei(new M(t.x,3-t.y),e)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof Ei&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Ei.encoder=_n.tuple([M.numberEncoder(8,4),_n.booleanEncoder],n=>[n.start,"clockwise"===n.moveDirection],n=>new Ei(n[0],n[1]?"clockwise":"counterclockwise"));const z4t=_n.disjunction(W0.encoder,Ei.encoder,n=>n.isDrop());let Pm=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})(),Vr=(()=>{class n extends ws{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=Cn.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static fromRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==Cn.EMPTY&&i[n.pieceIndex(u)]--}return ye(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case Cn.ZERO_FIRST:return 0;case Cn.ZERO_SECOND:return 1;case Cn.ONE_FIRST:return 2;default:return we.expectToBe(e,Cn.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==Cn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class E3 extends tr{constructor(){super(Vr)}static get(){return E3.singleton.isAbsent()&&(E3.singleton=P.of(new E3)),E3.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=Ye.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=Ye.copyImmutableArray(e.remainingPieces);return s[Vr.pieceIndex(t.piece)]-=1,new Vr(r,s,e.turn+1)}applyLegalShift(t,e){const r=Ye.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<Vr.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==Cn.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=Cn.EMPTY,i++,o++;return new Vr(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?G.failure(gt.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?G.failure(Pm.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===Vr.HEIGHT?G.failure(Pm.SPACE_IS_FULL()):G.success(void 0)}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?G.failure(gt.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>Vr.HEIGHT?G.failure(Pm.TARGET_STACK_TOO_HIGH()):G.success(void 0)}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return ye(r.owner.isPlayer(),"highest alignment is owned by a player"),Ie.getVictory(r.owner)}return Ie.ONGOING}findHighestAlignment(t){for(let e=0;e<Vr.WIDTH/2;e++)for(let r=Vr.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+Vr.WIDTH/2,r);if(s!==Cn.EMPTY&&s===i)return P.of(new M(e,r))}return P.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new Ei(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new Ei(e,"counterclockwise"),t).isSuccess()}}E3.singleton=P.empty();class V4t extends q1{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new Ei(s,"clockwise"),new Ei(s,"counterclockwise")])E3.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<Vr.WIDTH;s++)for(const i of e){const o=new W0(s,i);E3.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of Cn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<Vr.HEIGHT;s++)for(let i=0;i<Vr.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new M(i,s));return e}getBoardValue(t){const e=E3.get().getGameStatus(t);return new st(e.isEndGame?e.toBoardValue():0)}}const et=Cn.EMPTY,u9=Cn.ZERO_FIRST,Ace=Cn.ZERO_SECOND,iP=Cn.ONE_FIRST,cH=Cn.ONE_SECOND;class Ice{constructor(){this.tutorial=[fe.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Vr.getInitialState()),fe.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,Vr.fromRepresentation([[et,et,et,et,et,et,et,et],[et,et,et,et,et,et,et,et],[et,et,et,et,iP,et,et,et],[u9,et,et,et,u9,et,et,et]],3),[new W0(0,Cn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),fe.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,Vr.fromRepresentation([[et,et,et,et,et,et,et,et],[et,et,et,et,cH,et,et,et],[et,et,et,et,u9,et,et,et],[iP,et,et,et,Ace,et,et,et]],4),[Ei.fromRepresentation(new M(4,3),"counterclockwise"),Ei.fromRepresentation(new M(4,3),"clockwise"),Ei.fromRepresentation(new M(4,2),"counterclockwise"),Ei.fromRepresentation(new M(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),fe.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,Vr.fromRepresentation([[et,et,et,et,u9,et,et,et],[et,et,et,et,cH,et,et,u9],[et,et,et,et,u9,et,et,cH],[et,iP,et,et,Ace,et,et,iP]],8),[Ei.fromRepresentation(new M(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}function H4t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"path",5),J("click",function(){const i=ue(e).$implicit;return oe(v().onSpaceClick(i))}),O(),b(2,"path",6),J("click",function(){const i=ue(e).$implicit;return oe(v().onSpaceClick(i))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),S1("id","click_",e,""),T("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.BOARD_PATHS[e]),S(1),T("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.DECORATION_PATHS[e])}}function F4t(n,t){if(1&n){const e=Te();B(),b(0,"g",8),J("click",function(){const i=ue(e).$implicit,o=v().$implicit;return oe(v().onPieceInGameClick(o,i.y))}),X(1,"use",9)(2,"use",10),O()}if(2&n){const e=t.$implicit;We("id","click_",v().$implicit,"_",e.y,""),T("ngClass",e.foregroundClasses),S(1),T("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),S(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function B4t(n,t){if(1&n&&(B(),b(0,"g"),k(1,F4t,3,8,"g",7),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function $4t(n,t){if(1&n){const e=Te();B(),b(0,"g",12),J("click",function(){const s=ue(e),i=s.$implicit,o=s.index;return oe(v(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",9)(2,"use",10),O()}if(2&n){const e=t.$implicit,r=t.index;Ko("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),T("ngClass",e.foregroundClasses),S(1),T("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),S(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function U4t(n,t){if(1&n&&(B(),b(0,"g"),k(1,$4t,3,9,"g",11),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const G4t=function(){return[0,1,2,3,4,5,6,7]},W4t=function(){return[2,1,3,0,4,7,5,6]};class M3 extends H0{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=P.empty(),this.viewInfo={boardInfo:[],remainingPieces:new zn([{key:z.ZERO,value:[]},{key:z.ONE,value:[]}])},this.rules=E3.get(),this.availableMinimaxes=[new V4t(this.rules,"DiamDummyMinimax")],this.encoder=z4t,this.tutorial=(new Ice).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return A(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return A(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new W0(t,r.piece);else if((r.position.x+1)%Vr.WIDTH===t)s=new Ei(r.position,"clockwise");else{if((r.position.x+(Vr.WIDTH-1))%Vr.WIDTH!==t)return e.cancelMove(Pm.MUST_SHIFT_TO_NEIGHBOR());s=new Ei(r.position,"counterclockwise")}return e.chooseMove(s,e.getState())}return e.cancelMove(Pm.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=P.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),U.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?P.empty():P.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),U.SUCCESS):r.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new M(s,i);return[{start:P.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<Vr.HEIGHT&&e.getPieceAtXY(r,c)!==Cn.EMPTY;c++,i++)o.push({start:P.of(new M(r,c)),end:new M(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<Vr.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const t=this.rules.node.move;ye(t.isPresent(),"showLastMoveOnSpaces called without a last move");const e=t.get();for(let r=0;r<Vr.WIDTH;r++){const s=[];e.isDrop()?e.getTarget()===r&&s.push("moved-fill"):(e.getTarget()===r||e.start.x===r)&&s.push("moved-fill"),this.viewInfo.boardInfo[r].spaceClasses=s}}showLastMoveOnPieces(){const t=this.rules.node.move;ye(t.isPresent(),"showLastMoveOnPieces called without a last move");const e=t.get(),r=this.getPreviousState();let s=[];s=e.isDrop()?this.getLastMovedFromDrop(e,r):this.getLastMovedFromShift(e,r);for(const i of s)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new zn([{key:z.ZERO,value:[]},{key:z.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of Cn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===z.ZERO?-100:600,s=t.otherPieceType?100:450,new M(r,s).getNext(new ln(0,-e*M3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<Vr.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new M(t,i);if(o!==Cn.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return M3.CENTER[t].getNext(new ln(0,-e*M3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=P.empty(),this.updateBoard()}}M3.CENTER=[new M(40,160),new M(100,50),new M(255,2),new M(400,50),new M(460,160),new M(400,270),new M(255,320),new M(100,270)],M3.PIECE_HEIGHT=36,M3.\u0275fac=function(t){return new(t||M3)(Q(Nn))},M3.\u0275cmp=mt({type:M3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(B(),b(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),O()(),k(5,H4t,3,5,"g",4),k(6,B4t,2,1,"g",4),k(7,U4t,2,1,"g",4),O()),2&t&&(S(5),T("ngForOf",J1(3,G4t)),S(1),T("ngForOf",J1(4,W4t)),S(1),T("ngForOf",e.Player.PLAYERS))},dependencies:[En,Dn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class za{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?P.of(za.constantQ(r)):r!==s&&i===o&&c!==u?P.of(za.constantR(i)):r!==s&&i!==o&&c===u?P.of(za.constantS(c)):P.empty()}static constantQ(t){return new za(t,"q")}static constantR(t){return new za(t,"r")}static constantS(t){return new za(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=za.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return xe.DOWN;case"r":return xe.RIGHT;case"s":return xe.DOWN_LEFT}}}class lH extends ws{constructor(t,e,r,s,i,o){super(e,t),this.board=e,this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,ye(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(za.constantQ(e));for(let e=0;e<this.height;e++)t.push(za.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(za.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new M(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new M(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new M(t.offset,0):new M(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=Ss.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class Mi{static getNeighbors(t,e=1){const r=[];for(const s of xe.factory.all)r.push(t.getNext(s,e));return r}static areNeighbors(t,e){for(const r of xe.factory.all)if(t.getNext(r).equals(e))return!0;return!1}}class Jn{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new Jn(t.owner,t.size+e.size,t.source||e.source)}getValue(){return Jn.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}Jn.sizeEncoder=_n.numberEncoder(49),Jn.encoder=_n.tuple([_n.booleanEncoder,z.numberEncoder,Jn.sizeEncoder],n=>[n.source,n.owner,n.size],n=>new Jn(n[1],n[2],n[0])),Jn.MAX_SIZE=49,Jn.EMPTY=new Jn(de.NONE,0,!1),Jn.UNREACHABLE=new Jn(de.NONE,-1,!1),Jn.PLAYER_ZERO=new Jn(z.ZERO,1,!1),Jn.PLAYER_ONE=new Jn(z.ONE,1,!1),Jn.SOURCE=new Jn(de.NONE,1,!0);let Va=(()=>{class n extends lH{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Jn.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=Jn.UNREACHABLE,r=Jn.PLAYER_ZERO,s=Jn.PLAYER_ONE,i=Jn.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Jn.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new M(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&e.push(i)}return e}numberOfNeighbors(e){return Mi.getNeighbors(e,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(e,r){const s=Ye.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Jn.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})();class br extends $0{constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?G.success(br.PASS):Va.isOnBoard(t)?Va.isOnBoard(e)?t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?G.success(new br(t,e)):G.failure("Invalid move"):G.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):G.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString())}static of(t,e){const r=br.from(t,e);if(r.isSuccess())return r.get();throw new Error(r.getReason())}toString(){return this===br.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}}br.PASS=new br(new M(-1,-1),new M(-2,-2)),br.encoder=P4.getEncoder(br.from);let f9=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n})();class p2 extends tr{static getGameStatus(t){const e=t.gameState,r=p2.getScores(e);return 0===p2.getMovablePieces(e).length?r[0]>r[1]?Ie.ZERO_WON:r[0]<r[1]?Ie.ONE_WON:Ie.DRAW:Ie.ONGOING}static getMovablePieces(t){return p2.getFreePieces(t).filter(e=>p2.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==Mi.getNeighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return Mi.getNeighbors(e,r).filter(i=>t.isOnBoard(i)&&t.getPieceAt(i).hasPieces())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(z.ZERO)?e+=i.getSize():i.belongsTo(z.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){ye(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?U.failure(f9.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?U.failure(f9.TOO_MANY_NEIGHBORS()):p2.pieceHasTarget(t,e)?U.SUCCESS:U.failure(f9.CANT_REACH_TARGET()):U.failure(f9.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===p2.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){Mi.getNeighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=Ye.createTable(Va.WIDTH,Va.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,Jn.EMPTY))}),r}applyLegalMove(t,e,r){if(t===br.PASS)return new Va(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd()),o=e.setAt(t.getStart(),Jn.EMPTY).setAt(t.getEnd(),Jn.append(s,i));return this.removeDisconnectedPieces(new Va(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===p2.getMovablePieces(e).length)return t!==br.PASS||e.alreadyPassed?G.failure(gt.MUST_PASS()):G.success(void 0);if(t===br.PASS)return G.failure(gt.CANNOT_PASS());const r=this.isMovablePiece(e,t.getStart());if(r.isFailure())return r.toFailedFallible();const s=e.getPieceAt(t.getStart());return t.length()!==s.getSize()?G.failure(f9.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?G.failure(f9.EMPTY_TARGET_STACK()):G.success(void 0)}getGameStatus(t){return p2.getGameStatus(t)}}class xce extends q1{getListMoves(t){const e=t.move,r=t.gameState,s=[];return p2.getMovablePieces(r).forEach(i=>p2.pieceTargets(r,i).forEach(o=>{const c=br.of(i,o);s.push(c)})),0===s.length&&!1===e.equalsValue(br.PASS)&&s.push(br.PASS),s}getBoardValue(t){const e=t.gameState,r=p2.getScores(e);return 0===p2.getMovablePieces(e).length?new st(r[0]>r[1]?Number.MIN_SAFE_INTEGER:r[0]<r[1]?Number.MAX_SAFE_INTEGER:0):new st(r[0]-r[1])}}class q4t extends xce{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return Ye.sortByDescending(r,i=>{ye(i!==br.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getBoardValue(t){const e=p2.getGameStatus(t);if(e.isEndGame)return new st(e.toBoardValue());const r=t.gameState,s=p2.getScores(r),i=r.getAllPieces(),o=i.length,c=i.filter(m=>r.getPieceAt(m).belongsTo(z.ZERO)).length,u=i.filter(m=>r.getPieceAt(m).belongsTo(z.ONE)).length;return new st((u*s[1]-c*s[0])/o)}}const pe=Jn.EMPTY,Hr=Jn.UNREACHABLE,q0=Jn.SOURCE,h9=Jn.PLAYER_ZERO,d9=Jn.PLAYER_ONE,j4t=new Jn(z.ZERO,2,!1),uH=new Jn(z.ONE,2,!1),kce=new Jn(z.ZERO,4,!1),Z4t=new Jn(z.ONE,4,!1);class Lce extends lr{constructor(){super(...arguments),this.tutorial=[fe.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Va.getInitialState(),br.of(new M(2,0),new M(3,0)),$localize`Congratulations!`),fe.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Va([[Hr,Hr,d9,q0,pe,pe,pe,pe,pe,pe,pe],[Hr,pe,h9,pe,pe,pe,pe,pe,pe,pe,pe],[pe,pe,Z4t,pe,pe,pe,pe,d9,q0,pe,pe],[pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr],[pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr,Hr]],0,!1),br.of(new M(2,1),new M(2,0)),(t,e,r)=>t.getEnd().equals(new M(3,0))?U.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(ye(t.getEnd().equals(new M(2,0)),"player made an impossible move"),U.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),fe.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Va([[Hr,Hr,q0,d9,pe,pe,pe,pe,pe,pe,pe],[Hr,h9,h9,pe,pe,pe,pe,pe,pe,pe,pe],[pe,d9,h9,d9,pe,pe,h9,uH,q0,pe,pe],[pe,pe,d9,pe,pe,pe,pe,pe,pe,pe,Hr],[pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr,Hr]],0,!1),br.of(new M(2,1),new M(2,0)),(t,e,r)=>t.getEnd().equals(new M(2,0))?U.SUCCESS:U.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),fe.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Va([[Hr,Hr,q0,pe,pe,pe,pe,pe,pe,pe,pe],[Hr,pe,j4t,pe,pe,pe,pe,pe,pe,pe,pe],[pe,pe,uH,pe,pe,pe,pe,uH,q0,kce,pe],[pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr],[pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr,Hr]],0,!1)),fe.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Va([[Hr,Hr,q0,pe,pe,pe,pe,pe,pe,pe,pe],[Hr,pe,h9,pe,pe,pe,pe,pe,pe,pe,pe],[pe,pe,pe,pe,pe,pe,pe,pe,q0,kce,pe],[pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr],[pe,pe,pe,pe,pe,pe,pe,pe,pe,Hr,Hr]],0,!1),[br.of(new M(2,1),new M(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}function Y4t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v().$implicit,r=v().$implicit,s=v();T("ngClass",s.getPieceClasses(e)),D("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function K4t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v().$implicit,r=v().$implicit,s=v();D("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function X4t(n,t){if(1&n){const e=Te();B(),b(0,"text",12),J("click",function(){ue(e);const s=v(2).$implicit;return oe(v().onClick(s.x,s.y))}),St(1),O()}if(2&n){const e=v().$implicit,r=v().$implicit,s=v();D("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),S(1),a1(e.getSize())}}function Q4t(n,t){if(1&n){const e=Te();B(),b(0,"g",5),J("click",function(){ue(e);const s=v().$implicit;return oe(v().onClick(s.x,s.y))}),X(1,"polygon",6),k(2,Y4t,1,4,"circle",7),k(3,K4t,1,1,"polygon",8),k(4,X4t,2,3,"text",9),O()}if(2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","click_",r.x,"_",r.y,""),S(1),D("points",s.getHexaPointsAt(r)),S(1),T("ngIf",e.getSize()>0),S(1),T("ngIf",e.containsSource()),S(1),T("ngIf",e.getSize()>1)}}const J4t=function(n){return[n]};function elt(n,t){if(1&n&&(B(),b(0,"g"),k(1,Q4t,5,6,"g",4),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",c3(1,J4t,r.state.getPieceAt(e)))}}function tlt(n,t){if(1&n&&(B(),b(0,"text",16),St(1),O()),2&n){const e=v().$implicit,r=v();D("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),S(1),a1(e.spaceContent.getSize())}}function nlt(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polygon",13)(2,"circle",14),k(3,tlt,2,3,"text",15),O()),2&n){const e=t.$implicit,r=v();S(1),D("points",r.getHexaPointsAt(e.coord)),S(1),We("id","captured_",e.coord.x,"_",e.coord.y,""),T("ngClass",r.getPieceClasses(e.spaceContent)),D("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),S(1),T("ngIf",e.spaceContent.getSize()>1)}}function rlt(n,t){if(1&n&&(B(),an(0),X(1,"polygon",17)(2,"polygon",17),cn()),2&n){const e=v();S(1),D("points",e.getHexaPointsAt(e.lastMove.get().getStart())),S(1),D("points",e.getHexaPointsAt(e.lastMove.get().getEnd()))}}function slt(n,t){if(1&n&&(B(),X(0,"polygon",18)),2&n){const e=v();D("points",e.getHexaPointsAt(e.chosen.get()))}}let ilt=(()=>{class n extends s9{constructor(e){super(e),this.lastMove=P.empty(),this.chosen=P.empty(),this.disconnecteds=[],this.rules=new p2(Va),this.availableMinimaxes=[new xce(this.rules,"DvonnMinimax"),new q4t(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=br.encoder,this.tutorial=(new Lce).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=P.of(p2.getScores(this.getState())),this.hexaLayout=new i9(1.5*this.SPACE_SIZE,new M(-this.SPACE_SIZE,2*this.SPACE_SIZE),KS.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=P.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=P.of(p2.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,r=this.getState();for(let s=0;s<r.board.length;s++)for(let i=0;i<r.board[s].length;i++){const o=new M(i,s);if(!0===r.isOnBoard(o)&&!1===o.equals(this.lastMove.get().getStart())){const c=r.getPieceAt(o),u=e.getPieceAt(o);if(c.isEmpty()&&!u.isEmpty()){const g={coord:new M(i,s),spaceContent:u};this.disconnecteds.push(g)}}}}cancelMoveAttempt(){this.chosen=P.empty()}pass(){var e=this;return A(function*(){return ye(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(br.PASS,e.getState())})()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new M(e,r))?(s.cancelMoveAttempt(),U.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new M(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=P.of(s),U.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return A(function*(){const i=s.chosen.get(),o=new M(e,r),c=br.of(i,o);return s.chooseMove(c,s.getState())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,elt,2,3,"g",1),k(2,nlt,4,8,"g",1),k(3,rlt,3,2,"ng-container",2),k(4,slt,1,1,"polygon",3),O()),2&e&&(S(1),T("ngForOf",r.state.allCoords()),S(1),T("ngForOf",r.disconnecteds),S(1),T("ngIf",r.lastMove.isPresent()),S(1),T("ngIf",r.chosen.isPresent()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var rr=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(rr||(rr={})),rr))();class Ke{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===z.ZERO&&t===rr.BIG?Ke.BIG_DARK:e===z.ZERO&&t===rr.MEDIUM?Ke.MEDIUM_DARK:e===z.ZERO&&t===rr.SMALL?Ke.SMALL_DARK:e===z.ONE&&t===rr.BIG?Ke.BIG_LIGHT:e===z.ONE&&t===rr.MEDIUM?Ke.MEDIUM_LIGHT:e===z.ONE&&t===rr.SMALL?Ke.SMALL_LIGHT:Ke.NONE}getPlayer(){switch(this){case Ke.SMALL_DARK:case Ke.MEDIUM_DARK:case Ke.BIG_DARK:return z.ZERO;case Ke.SMALL_LIGHT:case Ke.MEDIUM_LIGHT:case Ke.BIG_LIGHT:return z.ONE;default:return de.NONE}}getSize(){switch(this){case Ke.BIG_DARK:case Ke.BIG_LIGHT:return rr.BIG;case Ke.MEDIUM_DARK:case Ke.MEDIUM_LIGHT:return rr.MEDIUM;case Ke.SMALL_DARK:case Ke.SMALL_LIGHT:return rr.SMALL;default:return we.expectToBe(this,Ke.NONE),rr.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Ke.BIG_DARK:return"BIG_DARK";case Ke.BIG_LIGHT:return"BIG_LIGHT";case Ke.MEDIUM_DARK:return"MEDIUM_DARK";case Ke.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Ke.SMALL_DARK:return"SMALL_DARK";case Ke.SMALL_LIGHT:return"SMALL_LIGHT";default:return we.expectToBe(this,Ke.NONE),"EMPTY"}}}Ke.SMALL_DARK=new Ke(0),Ke.SMALL_LIGHT=new Ke(1),Ke.MEDIUM_DARK=new Ke(2),Ke.MEDIUM_LIGHT=new Ke(3),Ke.BIG_DARK=new Ke(4),Ke.BIG_LIGHT=new Ke(5),Ke.NONE=new Ke(6);class Kl extends ws{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const e=new Xr(de.NONE,de.NONE,de.NONE).encode(),r=Ye.createTable(3,3,e),s=Ye.mapBiArray(r,Xr.decode);return new Kl(s,0,[Ke.BIG_DARK,Ke.BIG_DARK,Ke.BIG_LIGHT,Ke.BIG_LIGHT,Ke.MEDIUM_DARK,Ke.MEDIUM_DARK,Ke.MEDIUM_LIGHT,Ke.MEDIUM_LIGHT,Ke.SMALL_DARK,Ke.SMALL_DARK,Ke.SMALL_LIGHT,Ke.SMALL_LIGHT])}getRemainingPieces(){return Ye.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class Xr{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}static decode(t){ye(t%1==0,"EncapsuleSpace must be encoded as integer: "+t),ye(t>=0,"To small representation for EncapsuleSpace: "+t),ye(t<=26,"To big representation for EncapsuleSpace: "+t);const e=z.numberEncoder.decodeNumber(t%3);t-=e.value;const r=z.numberEncoder.decodeNumber((t/=3)%3);t-=r.value;const s=z.numberEncoder.decodeNumber(t/=3);return new Xr(e,r,s)}isEmpty(){return this.small===de.NONE&&this.medium===de.NONE&&this.big===de.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Ke.ofSizeAndPlayer(rr.SMALL,this.small)),this.medium.isPlayer()&&t.push(Ke.ofSizeAndPlayer(rr.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Ke.ofSizeAndPlayer(rr.BIG,this.big)),t}toOrderedPieceNames(){const t=Ke.ofSizeAndPlayer(rr.SMALL,this.small),e=Ke.ofSizeAndPlayer(rr.MEDIUM,this.medium),r=Ke.ofSizeAndPlayer(rr.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===z.ZERO?Ke.BIG_DARK:this.big===z.ONE?Ke.BIG_LIGHT:this.medium===z.ZERO?Ke.MEDIUM_DARK:this.medium===z.ONE?Ke.MEDIUM_LIGHT:this.small===z.ZERO?Ke.SMALL_DARK:this.small===z.ONE?Ke.SMALL_LIGHT:Ke.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Ke.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?P.of(this.put(t)):P.empty()}removeBiggest(){const t=this.getBiggest();if(t===Ke.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case rr.BIG:e=new Xr(this.small,this.medium,de.NONE);break;case rr.MEDIUM:e=new Xr(this.small,de.NONE,de.NONE);break;default:we.expectToBe(r,rr.SMALL),e=new Xr(de.NONE,de.NONE,de.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Ke.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case rr.BIG:return new Xr(this.small,this.medium,e);case rr.MEDIUM:return ye(this.big===de.NONE,"Cannot put a piece on top of a bigger one"),new Xr(this.small,e,this.big);default:return we.expectToBe(r,rr.SMALL),ye(this.big===de.NONE,"Cannot put a piece on top of a bigger one"),ye(this.medium===de.NONE,"Cannot put a piece on top of a bigger one"),new Xr(e,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}Xr.EMPTY=new Xr(de.NONE,de.NONE,de.NONE);let Tm=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class Mc extends tr{static isVictory(t){const e=t.getCopiedBoard();for(const r of Mc.LINES){const i=Mc.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return P.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===de.NONE?P.empty():r[0]===r[1]&&r[1]===r[2]?P.of(r[0]):P.empty()}static isLegal(t,e){let s;if(K(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return G.failure(Tm.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?G.success(o.get()):G.failure(Tm.INVALID_PLACEMENT())}isLegal(t,e){return Mc.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=Xr.decode(r.encode()),t.isDropping()){c=t.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=t.startingCoord.get(),g=s[h.y][h.x].encode(),C=Xr.decode(g).removeBiggest();s[h.y][h.x]=Xr.decode(C.removedSpace.encode()),c=C.removedPiece}return new Kl(s,o,i)}static getGameStatus(t){const r=Mc.isVictory(t.gameState);return r.isPresent()?Ie.getVictory(r.get()):Ie.ONGOING}getGameStatus(t){return Mc.getGameStatus(t)}}Mc.LINES=[[new M(0,0),new M(0,1),new M(0,2)],[new M(1,0),new M(1,1),new M(1,2)],[new M(2,0),new M(2,1),new M(2,2)],[new M(0,0),new M(1,0),new M(2,0)],[new M(0,1),new M(1,1),new M(2,1)],[new M(0,2),new M(1,2),new M(2,2)],[new M(0,0),new M(1,1),new M(2,2)],[new M(0,2),new M(1,1),new M(2,0)]];class Ws extends yi{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static fromMove(t,e){if(t.equals(e))throw new Error("Starting coord and landing coord must be separate coords");return new Ws(P.of(t),e,P.empty())}static fromDrop(t,e){return new Ws(P.empty(),e,P.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Ws.encoder=new class extends _n{maxValue(){return 161}encodeNumber(n){const t=n.landingCoord.x,e=n.landingCoord.y;if(n.isDropping())return 18*n.piece.get().value+6*t+2*e+0;{const s=n.startingCoord.get().y;return 54*n.startingCoord.get().x+18*s+6*t+2*e+1}}decodeNumber(n){const t=n%2;n-=t;const e=(n/=2)%3;n-=e;const r=(n/=3)%3;n-=r,n/=3;const s=new M(r,e);if(0===t){const i=Ke.of(n);return Ws.fromDrop(i,s)}{const i=n%3;n-=i;const c=new M((n/=3)%3,i);return Ws.fromMove(c,s)}}};class olt extends q1{getBoardValue(t){const e=Mc.getGameStatus(t);return new st(e.toBoardValue())}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=ote.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new M(u,c);for(const g of o){const m=Ws.fromDrop(g,h);Mc.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let g=0;g<3;g++)for(let m=0;m<3;m++){const C=new M(m,g);if(!C.equals(h)){const w=Ws.fromMove(h,C);Mc.isLegal(w,r).isSuccess()&&e.push(w)}}}return e}}const So=new Xr(de.NONE,de.NONE,de.NONE),Rce=new Xr(z.ZERO,de.NONE,de.NONE),alt=new Xr(de.NONE,z.ZERO,de.NONE),clt=new Xr(de.NONE,de.NONE,z.ZERO),Dce=new Xr(z.ONE,de.NONE,de.NONE),oP=new Xr(de.NONE,de.NONE,z.ONE),llt=new Xr(z.ONE,z.ZERO,de.NONE),ult=new Xr(z.ZERO,z.ZERO,de.NONE);class zce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new Kl([[Rce,Dce,oP],[So,alt,So],[So,So,clt]],0,[Ke.SMALL_DARK,Ke.MEDIUM_DARK,Ke.BIG_DARK,Ke.SMALL_LIGHT,Ke.MEDIUM_LIGHT,Ke.MEDIUM_LIGHT,Ke.BIG_LIGHT])),fe.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,Kl.getInitialState(),Ws.fromDrop(Ke.SMALL_DARK,new M(1,1)),$localize`Congratulations!`),fe.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new Kl([[Rce,oP,So],[So,So,So],[So,So,So]],0,[]),[Ws.fromMove(new M(0,0),new M(2,0)),Ws.fromMove(new M(0,0),new M(0,1)),Ws.fromMove(new M(0,0),new M(1,1)),Ws.fromMove(new M(0,0),new M(2,1)),Ws.fromMove(new M(0,0),new M(0,2)),Ws.fromMove(new M(0,0),new M(1,2)),Ws.fromMove(new M(0,0),new M(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new Kl([[llt,So,Dce],[ult,oP,oP],[So,So,So]],0,[Ke.MEDIUM_DARK,Ke.BIG_DARK,Ke.MEDIUM_LIGHT,Ke.MEDIUM_LIGHT]),Ws.fromMove(new M(0,1),new M(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new M(0,2))){if(t.isDropping())return U.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new M(0,1)))return U.SUCCESS}return U.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function flt(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"circle",5),J("click",function(){const s=ue(e),i=s.$implicit,o=s.index,c=v().$implicit;return oe(v().onPieceClick(c.value,i,o))}),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().$implicit,i=v();S(1),Ko("id","piece_",s.value,"_",e.toString(),"_",r,""),T("ngClass",i.getSidePieceClasses(e,r)),D("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function hlt(n,t){if(1&n&&(B(),b(0,"g",null,4),k(2,flt,2,8,"g",1),O()),2&n){const e=t.$implicit,r=v();S(2),T("ngForOf",r.getRemainingPieces(e))}}function dlt(n,t){if(1&n){const e=Te();B(),b(0,"circle",8),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onBoardClick(s,i))}),O()}if(2&n){const e=t.$implicit,r=v().index,s=v().index,i=v();T("ngClass",i.getPieceClasses(e)),D("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function plt(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",6),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onBoardClick(i,o))}),O(),k(2,dlt,1,4,"circle",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",i.getRectClasses(r,s)),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngForOf",i.getListPieces(e))}}function glt(n,t){if(1&n&&(B(),b(0,"g"),k(1,plt,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function mlt(n,t){if(1&n){const e=Te();B(),b(0,"rect",9),J("click",function(){ue(e);const s=v();return oe(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),O()}if(2&n){const e=v();We("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let _lt=(()=>{class n extends Eo{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty(),this.chosenCoord=P.empty(),this.chosenPiece=P.empty(),this.remainingPieceCenterCoords=new zn,this.rules=new Mc(Kl),this.availableMinimaxes=[new olt(this.rules,"EncapsuleMinimax")],this.encoder=Ws.encoder,this.tutorial=(new zce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.rules.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=P.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=P.of(o),s.chosenPiece.isPresent()){const u=Ws.fromDrop(s.chosenPiece.get(),o);return s.chooseMove(u,s.getState())}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(Tm.INVALID_PIECE_SELECTED()):U.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),U.SUCCESS;{const u=Ws.fromMove(s.chosenCoord.get(),o);return s.chooseMove(u,s.getState())}})()}cancelMoveAttempt(){this.chosenCoord=P.empty(),this.chosenPiece=P.empty(),this.chosenPieceIndex=P.empty()}onPieceClick(e,r,s){var i=this;return A(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(Tm.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=P.empty(),i.chosenPieceIndex=P.empty()):(i.chosenPiece=P.of(r),i.chosenPieceIndex=P.of(s)),U.SUCCESS):i.cancelMove(Tm.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new M(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return ye(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case rr.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case rr.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return we.expectToBe(e.getSize(),rr.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new zn;for(const e of z.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new M(2-i,3),u=this.STROKE_WIDTH):(o=new M(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),g=this.getPieceCenter(o.y);r.push(new M(h+c,g+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,hlt,3,1,"g",1),b(2,"g",null,2),k(4,glt,2,1,"g",1),k(5,mlt,1,6,"rect",3),O()()),2&e&&(D("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),S(1),T("ngForOf",r.Player.PLAYERS),S(3),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Sc extends m3{constructor(t,e,r,s,i){if(super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(r<1)throw new Error("Must select minimum one piece (got "+r+").");if(s<1)throw new Error("Step size must be minimum one (got "+s+").");if(s>r)throw new Error("Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}Sc.encoder=new class extends _n{maxValue(){return 122303}encodeNumber(n){const t=n.direction.toInt();return 8*n.coord.x*7*13*12+8*n.coord.y*7*13+8*(n.movedPieces-1)*7+8*(n.stepSize-1)+t}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%8;n-=t;const e=(n/=8)%7;n-=e;const r=(n/=7)%13;n-=r;const s=(n/=13)%12;n-=s;const i=n/=12,o=be.factory.fromInt(t);return new Sc(i,s,r+1,e+1,o.get())}};class S3 extends ws{static getInitialState(){const t=de.NONE,e=de.ZERO,r=de.ONE;return new S3([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let Pc=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class j0 extends tr{static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return G.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=Ye.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=j0.getCaptureValidity(e,i,t,o);return c.isFailure()?c:G.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return U.failure(Pc.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===de.NONE)return U.failure(Pc.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return U.failure(Pc.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return U.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=de.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return G.failure(Pc.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return G.failure(Pc.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?G.failure(Pc.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?G.failure(gt.CANNOT_SELF_CAPTURE()):(r[i.y][i.x]=de.NONE,r[o.y][o.x]=s,G.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=de.NONE),o++,o>=r.movedPieces)return G.failure(Pc.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return G.success(e)}isLegal(t,e){return j0.isLegal(t,e)}applyLegalMove(t,e,r){return new S3(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(z.ZERO,0),s=e.count(z.ONE,11);if(e.turn%2==0){if(r>s)return Ie.ZERO_WON}else if(s>r)return Ie.ONE_WON;return!1===e.doesOwnPiece(z.ZERO)?Ie.ONE_WON:!1===e.doesOwnPiece(z.ONE)?Ie.ZERO_WON:Ie.ONGOING}}class wm extends q1{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=de.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const g=new M(h,u);if(o.getPieceAt(g)===e)for(const m of be.DIRECTIONS){let C=1,w=g.getNext(m,1);for(;w.isInRange(14,12)&&o.getPieceAt(w)===e;)C+=1,w=w.getNext(m,1);let I=1;for(;w.isInRange(14,12)&&I<=C&&o.getPieceAt(w)===s;)c=new Sc(h,u,C,I,m),i=this.addMove(i,c,o),I++,w=w.getNext(m,1);w.isInRange(14,12)&&I<=C&&o.getPieceAt(w)===r&&(c=new Sc(h,u,C,I,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return j0.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=wm.getListMoves(t);return Ye.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=this.ruler.getGameStatus(t);return new st(e.isEndGame?e.toBoardValue():this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let g=0;g<14;g++){const m=new M(g,c),C=t.getPieceAt(m);if(C.isPlayer()){const w=C.getScoreModifier();o+=2002*w,h[C.value]=w,u+=w;for(const I of[be.UP_LEFT,be.UP,be.UP_RIGHT]){let H=m.getNext(I,1);for(;H.isInRange(14,12)&&t.getPieceAt(H)===C;)o+=1*w,H=H.getNext(I,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((g,m)=>g+m)}return o}}class vlt extends q1{getListMoves(t){const e=wm.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return Ye.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=this.ruler.getGameStatus(t);return new st(e.isEndGame?e.toBoardValue():this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new M(u,c),g=t.getPieceAt(h);if(g.isPlayer()){let m,C;g===z.ZERO?(m=12-c,C=[be.UP_LEFT,be.UP,be.UP_RIGHT]):(m=c+1,C=[be.DOWN_LEFT,be.DOWN,be.DOWN_RIGHT]);const w=g.getScoreModifier();o+=m*w,o+=149629*w;for(const I of C){let H=h.getNext(I,1);for(;H.isInRange(14,12)&&t.getPieceAt(H)===g;)o+=337*w,H=H.getNext(I,1)}}}return o}}class Clt extends wm{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new M(r,11))===z.ZERO&&(e+=z.ZERO.getScoreModifier()),t.getPieceAt(new M(r,0))===z.ONE&&(e+=z.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new M(s+o,r+c);if(u.isInRange(14,12)){const h=t.getPieceAt(u);(h===i||h===de.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new M(r,0))===z.ZERO&&(e+=z.ZERO.getScoreModifier()),t.getPieceAt(new M(r,11))===z.ONE&&(e+=z.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new M(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const h of be.DIRECTIONS){let g=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)g+=1,m=m.getNext(h,1);let C=1;for(;m.isInRange(14,12)&&C<=g&&t.getPieceAt(m)===de.NONE;)C++,m=m.getNext(h,1);e+=C*C*u.getScoreModifier(),u===z.ZERO?r=Math.max(r,C):u===z.ONE&&(s=Math.max(s,C))}}return(e+r*z.ZERO.getScoreModifier()+s*z.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=this.ruler.getGameStatus(t);if(r.isEndGame)return new st(r.toBoardValue());const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),h=this.getMobility(e);return new st(s+i+o+c+u+h)}}const x=de.NONE,Or=de.ZERO,B1=de.ONE;class Vce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,S3.getInitialState()),fe.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new S3([[x,x,x,x,x,Or,x,x,B1,B1,B1,B1,B1,B1],[x,x,x,x,x,Or,x,x,x,x,x,x,B1,B1],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,B1,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,Or,Or,Or,Or,x,x,x]],0)),fe.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new S3([[x,x,x,x,x,Or,x,x,x,x,B1,B1,B1,B1],[x,x,x,x,x,Or,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,B1,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,B1,B1,x,x,x,Or,Or,x,Or,Or,Or,Or]],1)),fe.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,S3.getInitialState(),new Sc(0,10,1,1,be.UP),(t,e,r)=>1===t.movedPieces?U.SUCCESS:U.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),fe.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,S3.getInitialState(),new Sc(0,11,2,1,be.UP),(t,e,r)=>t.movedPieces>1?U.SUCCESS:U.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),fe.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new S3([[x,x,x,x,x,x,x,x,B1,B1,B1,B1,B1,B1],[x,x,x,x,x,x,B1,x,x,x,x,x,x,x],[x,x,x,x,x,B1,x,x,x,x,x,x,x,x],[x,x,B1,x,B1,x,x,x,x,x,x,x,x,x],[x,x,B1,B1,x,x,x,x,x,x,x,x,x,x],[x,x,B1,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,Or,x,x,x,x,x,x,x,x,x,x,x],[x,x,Or,x,x,x,x,B1,x,x,x,x,x,x],[x,x,Or,x,x,x,x,x,x,x,x,x,x,x],[x,x,Or,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,Or,Or,Or,Or,Or,Or,Or]],0),[new Sc(2,10,4,2,be.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function ylt(n,t){if(1&n){const e=Te();B(),b(0,"circle",4),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onClick(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Elt(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",2),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),O(),k(2,ylt,1,4,"circle",3),O()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]!==s.NONE)}}function Mlt(n,t){if(1&n&&(B(),b(0,"g"),k(1,Elt,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Slt(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",5),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let Plt=(()=>{class n extends Eo{constructor(e){super(e),this.NONE=de.NONE,this.firstPiece=P.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=P.empty(),this.phalanxDirection=P.empty(),this.phalanxMiddles=[],this.moveds=[],this.captureds=[],this.hasAsymetricBoard=!0,this.rules=new j0(S3),this.availableMinimaxes=[new wm(this.rules,"Normal"),new vlt(this.rules,"Positional"),new Clt(this.rules,"Attack")],this.encoder=Sc.encoder,this.tutorial=(new Vce).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=P.empty(),this.lastPiece=P.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.rules.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.captureds.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return A(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=P.of(new M(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),U.SUCCESS;case i:return s.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE());default:return we.expectToBe(s.board[r][e],de.NONE),s.cancelMove(gt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.captureds=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of be.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=be.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=be.factory.fromMove(e,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const g=e.getNext(c,1);return this.getLandingsToward(g,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of be.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===de.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=P.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=P.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return A(function*(){const i=new M(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),U.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(Pc.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),g=o.getDirectionToward(i).get();switch(s.board[r][e]){case de.NONE:return 1===h?s.tryMove(new Sc(o.x,o.y,1,1,g)):s.cancelMove(Pc.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(Pc.SINGLE_PIECE_CANNOT_CAPTURE());default:we.expectToBe(s.board[r][e],u);const m=new Sc(o.x,o.y,h,1,g),C=s.getState(),w=j0.getPhalanxValidity(C,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=P.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=P.of(g),U.SUCCESS)}})()}thirdClick(e,r){var s=this;return A(function*(){const i=s.getState().getCurrentPlayer(),o=new M(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(Pc.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=be.factory.fromMove(c,u).get();const g=be.factory.fromMove(c,o).get();if(h===g.getOpposite()&&(s.firstPiece=P.of(u),s.lastPiece=P.of(c),h=g),h!==g)return s.cancelMove(Pc.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,C=s.lastPiece.get().getDistance(o),w=new Sc(s.firstPiece.get().x,s.firstPiece.get().y,m,C,h);return s.tryMove(w)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return A(function*(){i.lastPiece=P.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new Sc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=j0.getPhalanxValidity(i.rules.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),U.SUCCESS)})()}moveFirstPiece(e){var r=this;return A(function*(){return r.firstPiece=P.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),U.SUCCESS})()}moveLastPiece(e){var r=this;return A(function*(){return r.lastPiece=P.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),U.SUCCESS)})()}moveOnlyPiece(e){var r=this;return A(function*(){return r.lastPiece=P.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=P.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),U.SUCCESS})()}tryMove(e){const r=this.getState();return this.cancelMove(),this.chooseMove(e,r)}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new M(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new M(e,r);return this.captureds.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new M(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,Mlt,2,1,"g",1),k(2,Slt,2,4,"g",1),O()),2&e&&(D("transform",r.rotation),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getHighlightedCoords()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class g2{constructor(t){if(t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===za.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=Ye.copyImmutableArray(t).sort((r,s)=>{if(r.x===s.x){if(r.y===s.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return r.y>s.y?1:-1}return r.x>s.x?1:-1});let e=P.empty();for(const r of this.capturedSpaces){if(e.isPresent()&&1!==e.get().getDistance(r))throw new Error("Cannot create a GipfCapture with non-consecutive coords");e=P.of(r)}}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return za.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}g2.encoder=new class extends C4{encode(n){return n.capturedSpaces.map(t=>M.encoder.encode(t))}decode(n){return new g2(n.map(M.encoder.decode))}};class Ha{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}Ha.encoder=new class extends C4{constructor(){super(...arguments),this.optionalDirectionEncoder=P.getEncoder(xe.encoder)}encode(n){return{coord:M.encoder.encode(n.coord),direction:this.optionalDirectionEncoder.encode(n.direction)}}decode(n){const t=n;return ye(null!=t.coord,"Invalid encoded GipfPlacement"),new Ha(M.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class ia extends yi{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===Ye.compareArray(this.initialCaptures,t.initialCaptures)||!1===Ye.compareArray(this.finalCaptures,t.finalCaptures))}encode(){return ia.encoder.encode(this)}decode(t){return ia.encoder.decode(t)}}ia.encoder=new class extends Gi{encodeMove(n){const t={placement:Ha.encoder.encode(n.placement)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=g2.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=g2.encoder.encode(e)}),t}decodeMove(n){const t=n;return ye(null!=t.placement,"Invalid encoded GipfMove"),new ia(Ha.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",g2.encoder.decode),this.decodeArray(t,"finalCapture",g2.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Fa extends lH{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],Ne.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=Ne.EMPTY,e=Ne.UNREACHABLE,r=Ne.ZERO,s=Ne.ONE;return new Fa([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&Ye.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=Ye.copyBiArray(this.board);return r[t.y][t.x]=e,new Fa(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Ne.UNREACHABLE}}let Tc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class $n extends tr{applyLegalMove(t,e,r){return new Fa(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=$n.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,Ne.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Fa(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return Ts.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===Ne.EMPTY?e.push(new Ha(r,P.empty())):$n.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===$n.isLineComplete(t,r,s)&&e.push(new Ha(r,P.of(s)))})}),e}static isLineComplete(t,e,r){return $n.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===Ne.EMPTY)return P.of(s);return P.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=Ne.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==Ne.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==Ne.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new Fa(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=$n.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==Ne.EMPTY;)o.push(c),c=c.getNext(i);return ye(s.isOnBoard(c)&&s.getPieceAt(c)===Ne.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(Ts.INSTANCE.isTopLeftCorner(t,e))return[xe.RIGHT,xe.DOWN,xe.UP_RIGHT];if(Ts.INSTANCE.isTopCorner(t,e))return[xe.DOWN,xe.DOWN_LEFT,xe.RIGHT];if(Ts.INSTANCE.isTopRightCorner(t,e))return[xe.DOWN_LEFT,xe.DOWN,xe.LEFT];if(Ts.INSTANCE.isBottomLeftCorner(t,e))return[xe.UP_RIGHT,xe.UP,xe.RIGHT];if(Ts.INSTANCE.isBottomCorner(t,e))return[xe.UP,xe.LEFT,xe.UP_RIGHT];if(Ts.INSTANCE.isBottomRightCorner(t,e))return[xe.LEFT,xe.UP,xe.DOWN_LEFT];if(Ts.INSTANCE.isOnTopLeftBorder(t,e))return[xe.RIGHT,xe.DOWN];if(Ts.INSTANCE.isOnLeftBorder(t,e))return[xe.UP_RIGHT,xe.RIGHT];if(Ts.INSTANCE.isOnBottomLeftBorder(t,e))return[xe.UP,xe.UP_RIGHT];if(Ts.INSTANCE.isOnBottomRightBorder(t,e))return[xe.LEFT,xe.UP];if(Ts.INSTANCE.isOnRightBorder(t,e))return[xe.LEFT,xe.DOWN_LEFT];if(Ts.INSTANCE.isOnTopRightBorder(t,e))return[xe.DOWN_LEFT,xe.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=$n.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toFailedFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toFailedFallible();const c=$n.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toFailedFallible();const h=$n.applyCaptures(t.finalCaptures,c),g=this.noMoreCapturesValidity(h);return g.isFailure()?g.toFailedFallible():G.success(h)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=$n.applyCapture(s,r)}return U.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=$n.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return U.failure(Tc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return $n.getCapturable(t,i).equals(e)?U.SUCCESS:U.failure(Tc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=$n.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return P.of({0:c,1:u,2:o});return P.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===$n.getLinePortionsWithFourPiecesOfPlayer(t,e).length?U.SUCCESS:U.failure(Tc.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==Ne.EMPTY){if(e.direction.isAbsent())return U.failure(Tc.PLACEMENT_WITHOUT_DIRECTION());if($n.isLineComplete(t,e.coord,e.direction.get()))return U.failure(Tc.PLACEMENT_ON_COMPLETE_LINE());for(const s of $n.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return U.SUCCESS;return U.failure(Tc.INVALID_PLACEMENT_DIRECTION())}return U.SUCCESS}placementCoordValidity(t,e){return Ts.INSTANCE.isOnBorder(t,e)?U.SUCCESS:U.failure(Tc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==Ne.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;t.isOnBoard(h)&&t.getPieceAt(h)!==Ne.EMPTY;h=h.getNext(o))r.push(h);return new g2(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return $n.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push($n.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===$n.getPossibleCaptures(t).length)return P.empty();const s=t.getNumberOfPiecesCaptured(e);return P.of(r+3*s)}static isGameOver(t){const e=$n.getPlayerScore(t,z.ZERO),r=$n.getPlayerScore(t,z.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=$n.getPlayerScore(e,z.ZERO),s=$n.getPlayerScore(e,z.ONE);return r.isAbsent()?Ie.ONE_WON:s.isAbsent()?Ie.ZERO_WON:Ie.ONGOING}}class bm extends q1{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=bm.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(g=>e[i].some(m=>g===m))?o.push(Ye.copyImmutableArray(u)):c?(o.push(Ye.copyImmutableArray(u)),u.push(i),o.push(Ye.copyImmutableArray(u))):(u.push(i),o.push(Ye.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getBoardValue(t){const e=t.gameState,r=$n.getPlayerScore(e,z.ZERO),s=$n.getPlayerScore(e,z.ONE);return r.isAbsent()?new st(z.ONE.getVictoryValue()):s.isAbsent()?new st(z.ZERO.getVictoryValue()):new st(r.get()-s.get())}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return $n.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=$n.applyCaptures(r,t);$n.getPlacements(s).forEach(i=>{const o=$n.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new ia(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=$n.getPossibleCaptures(t);return bm.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class Hce{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const n1=Ne.UNREACHABLE,ut=Ne.EMPTY,Nr=Ne.ZERO,T4=Ne.ONE;class Fce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Fa.getInitialState()),fe.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Fa.getInitialState(),new ia(new Ha(new M(3,0),P.of(xe.DOWN)),[],[]),$localize`Congratulations!`),fe.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Fa([[n1,n1,n1,Nr,T4,ut,ut],[n1,n1,ut,ut,ut,ut,ut],[n1,ut,ut,ut,ut,ut,ut],[Nr,Nr,Nr,ut,ut,ut,ut],[T4,ut,ut,ut,ut,ut,n1],[ut,ut,ut,T4,ut,n1,n1],[ut,ut,ut,T4,n1,n1,n1]],42,[8,8],[0,0]),[new ia(new Ha(new M(0,3),P.of(xe.RIGHT)),[],[new g2([new M(0,3),new M(1,3),new M(2,3),new M(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),fe.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Fa([[n1,n1,n1,ut,ut,ut,ut],[n1,n1,ut,T4,ut,ut,ut],[n1,ut,ut,Nr,ut,ut,ut],[Nr,Nr,Nr,T4,ut,ut,ut],[ut,ut,ut,Nr,ut,ut,n1],[ut,ut,ut,Nr,ut,n1,n1],[ut,ut,ut,T4,n1,n1,n1]],42,[8,4],[2,3]),[new ia(new Ha(new M(0,3),P.of(xe.RIGHT)),[],[new g2([new M(3,1),new M(3,2),new M(3,3),new M(3,4),new M(3,5),new M(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),fe.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Fa([[n1,n1,n1,Nr,ut,ut,Nr],[n1,n1,ut,Nr,ut,ut,Nr],[n1,Nr,Nr,ut,Nr,T4,Nr],[ut,ut,ut,Nr,ut,ut,Nr],[ut,ut,ut,Nr,ut,ut,n1],[Nr,Nr,Nr,T4,T4,n1,n1],[ut,ut,ut,Nr,n1,n1,n1]],42,[3,4],[2,3]),[new ia(new Ha(new M(3,6),P.of(xe.UP)),[new g2([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new g2([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)]),new g2([new M(1,2),new M(2,2),new M(3,2),new M(4,2),new M(5,2)])]),new ia(new Ha(new M(4,6),P.of(xe.UP)),[new g2([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new g2([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)]),new g2([new M(3,0),new M(3,1),new M(3,2),new M(3,3),new M(3,4)])]),new ia(new Ha(new M(3,6),P.of(xe.UP)),[new g2([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new g2([new M(1,2),new M(2,2),new M(3,2),new M(4,2),new M(5,2)]),new g2([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function Tlt(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=v().$implicit,r=v();T("ngClass",r.getPieceClass(e)),D("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function wlt(n,t){if(1&n){const e=Te();B(),b(0,"g",10),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i))}),X(1,"polygon",11),k(2,Tlt,1,4,"circle",12),O()}if(2&n){const e=t.$implicit,r=v();We("id","click_",e.x,"_",e.y,""),S(1),We("id","space_",e.x,"_",e.y,""),T("ngClass",r.getSpaceClass(e)),D("points",r.getHexaPointsAt(e)),S(1),T("ngIf",r.isPiece(e))}}function blt(n,t){if(1&n){const e=Te();B(),b(0,"polygon",16),J("click",function(){const i=ue(e).$implicit;return oe(v(2).onClick(i))}),O()}if(2&n){const e=t.$implicit;D("points",v(2).getHexaPointsAt(e))}}function Olt(n,t){if(1&n&&(B(),b(0,"g",14),k(1,blt,1,1,"polygon",15),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e.capturedSpaces)}}function Nlt(n,t){if(1&n){const e=Te();B(),b(0,"line",17),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.destination))}),O()}if(2&n){const e=t.$implicit;D("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function Alt(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",18),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v();S(1),We("id","piece_",r.value,"_",e,""),T("ngClass",s.getPlayerClass(r)),D("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function Ilt(n,t){if(1&n&&(B(),b(0,"g"),k(1,Alt,2,6,"g",8),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getPlayerSidePieces(e))}}function xlt(n,t){if(1&n&&(B(),X(0,"line",19)),2&n){const e=v();D("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let klt=(()=>{class n extends s9{constructor(e){super(e),this.inserted=P.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=P.empty(),this.placementEntrance=P.empty(),this.finalCaptures=[],this.hasAsymetricBoard=!0,this.scores=P.of([0,0]),this.rules=new $n(Fa),this.availableMinimaxes=[new bm(this.rules,"GipfMinimax")],this.encoder=ia.encoder,this.tutorial=(new Fce).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new i9(1.5*this.SPACE_SIZE,new M(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Ts.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt()}showLastMove(){this.inserted=P.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const r=e.get().placement;this.inserted=P.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new Hce(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==Ne.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return we.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return A(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove(Tc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(Tc.MISSING_CAPTURES());const i=s[0];return r.constructedState=$n.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=$n.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():U.SUCCESS):(we.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):U.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,U.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=$n.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,U.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return A(function*(){return e.possibleCaptures=$n.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,U.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of $n.getAllDirectionsForEntrance(this.constructedState,e))if(!1===$n.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new Hce(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return A(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),U.SUCCESS):(r.placementEntrance=P.of(e),r.constructedState.getPieceAt(e)===Ne.EMPTY?r.selectPlacementDirection(P.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove(Tc.NO_DIRECTIONS_AVAILABLE()),U.SUCCESS))})()}selectPlacementDirection(e){var r=this;return A(function*(){r.placement=P.of(new Ha(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=$n.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return A(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=xe.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){var i=this;return A(function*(){const o=new ia(r,e,s);return yield i.chooseMove(o,i.getState(),i.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const r=e.get(),s=this.rules.node.mother.get().gameState;r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=P.empty(),this.placement=P.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(z.of(r.value))}getRemainingPieceCy(e){return e===z.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===z.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),O(),b(4,"marker",3),X(5,"polygon",4),O()(),k(6,wlt,3,7,"g",5),k(7,Olt,2,1,"g",6),k(8,Nlt,1,4,"line",7),k(9,Ilt,2,1,"g",8),k(10,xlt,1,4,"line",9),O()),2&e&&(D("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),S(6),T("ngForOf",r.getAllCoords()),S(1),T("ngForOf",r.possibleCaptures),S(1),T("ngForOf",r.arrows),S(1),T("ngForOf",r.Player.PLAYERS),S(1),T("ngIf",r.inserted.isPresent()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Y1 extends m3{equals(t){return this===t||this.coord.equals(t.coord)}toString(){return this===Y1.PASS?"GoMove.PASS":this===Y1.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}Y1.PASS=new Y1(-1,0),Y1.ACCEPT=new Y1(-2,0),Y1.PASS_NUMBER=-1,Y1.ACCEPT_NUMBER=-2,Y1.encoder=new class extends _n{maxValue(){return 360}encodeNumber(n){return 19*n.coord.y+n.coord.x}decodeNumber(n){if(n===Y1.PASS_NUMBER)return Y1.PASS;const t=n%19;return new Y1(t,(n-t)/19)}};class Be{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case Be.DARK:return"GoPiece.DARK";case Be.LIGHT:return"GoPiece.LIGHT";case Be.EMPTY:return"GoPiece.EMPTY";case Be.DEAD_DARK:return"GoPiece.DEAD_DARK";case Be.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Be.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return ye(this===Be.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===z.ZERO?Be.DARK:Be.LIGHT}isOccupied(){return[Be.DARK,Be.LIGHT,Be.DEAD_DARK,Be.DEAD_LIGHT].includes(this)}isEmpty(){return[Be.DARK_TERRITORY,Be.LIGHT_TERRITORY,Be.EMPTY].includes(this)}isDead(){return[Be.DEAD_DARK,Be.DEAD_LIGHT].includes(this)}isTerritory(){return[Be.DARK_TERRITORY,Be.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return ye(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Be.EMPTY}}Be.DARK=new Be(z.ZERO,"alive"),Be.LIGHT=new Be(z.ONE,"alive"),Be.EMPTY=new Be(de.NONE,"empty"),Be.DEAD_DARK=new Be(z.ZERO,"dead"),Be.DEAD_LIGHT=new Be(z.ONE,"dead"),Be.DARK_TERRITORY=new Be(de.NONE,"territory"),Be.LIGHT_TERRITORY=new Be(de.NONE,"territory");var Vn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Vn||(Vn={})),Vn))();let Os=(()=>{class n extends ws{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,P.empty(),Vn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Ye.createTable(n.WIDTH,n.HEIGHT,Be.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=13,n.HEIGHT=13,n})(),Z0=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class Dlt extends Z0{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===Be.DARK?this.darkCoords:this.color===Be.LIGHT?this.lightCoords:this.color===Be.DEAD_DARK?this.deadDarkCoords:this.color===Be.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(ye(!1===this.contains(t),"This group already contains "+t.toString()),e){case Be.DARK:this.darkCoords=Z0.insertAsEntryPoint(this.darkCoords,t);break;case Be.LIGHT:this.lightCoords=Z0.insertAsEntryPoint(this.lightCoords,t);break;case Be.DEAD_DARK:this.deadDarkCoords=Z0.insertAsEntryPoint(this.deadDarkCoords,t);break;case Be.DEAD_LIGHT:this.deadLightCoords=Z0.insertAsEntryPoint(this.deadLightCoords,t);break;default:we.expectToBeMultiple(e,[Be.EMPTY,Be.DARK_TERRITORY,Be.LIGHT_TERRITORY]),this.emptyCoords=Z0.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new zn;t.set(Be.EMPTY,this.emptyCoords.length),t.set(Be.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(Be.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==Be.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==Be.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==Be.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==Be.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==Be.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class Om extends class Rlt{getGroupDatas(t,e){K(Z0.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){K(Z0.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new Dlt(t,[],[],[],[],[])}getDirections(){return Ve.ORTHOGONALS}}let Nm=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})(),P3=(()=>{class n extends tr{static isLegal(e,r){if(K(n.VERBOSE||!1,{isLegal:{move:e,state:r}}),n.isPass(e)){const i=r.phase===Vn.PLAYING,o=r.phase===Vn.PASSED;return K(n.VERBOSE||!1,"GoRules.isLegal at "+r.phase+(i||o?" forbid":" allowed")+" passing on "+r.getCopiedBoard()),i||o?G.success([]):G.failure(Nm.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){const o=r.phase===Vn.ACCEPT;return r.phase===Vn.COUNTING||o?G.success([]):G.failure(Nm.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,r.getCopiedBoard())?(K(n.VERBOSE||!1,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,r)?G.success([]):G.failure(Nm.OCCUPIED_INTERSECTION())):(K(n.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,r))}static getNewKo(e,r,s){if(1===s.length){const i=s[0],o=e.coord,c=r[o.y][o.x],h=(new Om).getGroupDatas(o,r),g=h.emptyCoords,m=Be.pieceBelongTo(c,z.ZERO)?h.darkCoords:h.lightCoords;if(1===g.length&&g[0].equals(i)&&1===m.length)return P.of(i)}return P.empty()}static markTerritoryAndCount(e){K(n.VERBOSE,{markTerritoryAndCount:{state:e}});const r=e.getCopiedBoard(),s=n.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of s){const c=o.getWrapper();if(c===Be.LIGHT){i[1]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=Be.LIGHT_TERRITORY}else{ye(c===Be.DARK,"territory should be wrapped by dark or light, not by "+c.toString()),i[0]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=Be.DARK_TERRITORY}}return new Os(r,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy();let i;for(let o=0;o<e.board.length;o++)for(let c=0;c<e.board[0].length;c++)i=r[o][c],i===Be.DARK_TERRITORY?(r[o][c]=Be.EMPTY,s[0]=s[0]-1):i===Be.LIGHT_TERRITORY&&(r[o][c]=Be.EMPTY,s[1]=s[1]-1);return new Os(r,s,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),r=>r.isEmpty())}static getGroupsDatasWhere(e,r){const s=[];let i,o,c;const u=new Om;for(let h=0;h<e.length;h++)for(let g=0;g<e[0].length;g++)i=new M(g,h),c=e[h][g],r(c)&&(s.some(m=>m.selfContains(i))||(o=u.getGroupDatas(i,e),s.push(o)));return s}static addDeadToScore(e){const r=e.getCapturedCopy();let o,s=r[1],i=r[0];for(let c=0;c<e.board.length;c++)for(let u=0;u<e.board[0].length;u++)o=e.getPieceAtXY(u,c),o===Be.DEAD_DARK?s++:o===Be.DEAD_LIGHT&&i++;return[i,s]}static switchAliveness(e,r){const s=r.getCopiedBoard();ye(s[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const c=(new Om).getGroupDatas(e,s),u=r.getCapturedCopy();switch(c.color){case Be.DEAD_DARK:u[1]-=2*c.deadDarkCoords.length;for(const h of c.deadDarkCoords)s[h.y][h.x]=Be.DARK;break;case Be.DEAD_LIGHT:u[0]-=2*c.deadLightCoords.length;for(const h of c.deadLightCoords)s[h.y][h.x]=Be.LIGHT;break;case Be.LIGHT:u[0]+=2*c.lightCoords.length;for(const h of c.lightCoords)s[h.y][h.x]=Be.DEAD_LIGHT;break;default:we.expectToBe(c.color,Be.DARK),u[1]+=2*c.darkCoords.length;for(const h of c.darkCoords)s[h.y][h.x]=Be.DEAD_DARK}return new Os(s,u,r.turn,r.koCoord,r.phase)}static getGameStatus(e){const r=e.gameState;return r.phase===Vn.FINISHED?r.captured[0]>r.captured[1]?Ie.ZERO_WON:r.captured[1]>r.captured[0]?Ie.ONE_WON:Ie.DRAW:Ie.ONGOING}static isPass(e){return e.equals(Y1.PASS)}static isAccept(e){return e.equals(Y1.ACCEPT)}static isLegalDeadMarking(e,r){return n.isOccupied(e.coord,r.getCopiedBoard())&&(r.phase===Vn.COUNTING||r.phase===Vn.ACCEPT)}static isLegalNormalMove(e,r){const s=r.getCopiedBoard();if(n.isKo(e,r))return G.failure(Nm.ILLEGAL_KO());[Vn.COUNTING,Vn.ACCEPT].includes(r.phase)&&(r=n.resurrectStones(r));const i=n.getCaptureState(e,r);if($ce.isCapturing(i))return G.success(i.capturedCoords);{s[e.coord.y][e.coord.x]=r.turn%2==0?Be.DARK:Be.LIGHT;const u=0===(new Om).getGroupDatas(e.coord,s).emptyCoords.length;return s[e.coord.y][e.coord.x]=Be.EMPTY,u?G.failure(Nm.CANNOT_COMMIT_SUICIDE()):G.success([])}}static isOccupied(e,r){return r[e.y][e.x].isOccupied()}static isKo(e,r){return!!r.koCoord.isPresent()&&e.coord.equals(r.koCoord.get())}static getCaptureState(e,r){K(n.VERBOSE||!1,{getCaptureState:{move:e,state:r}});const i=new $ce;let o;for(const c of Ve.ORTHOGONALS)o=n.getCapturedInDirection(e.coord,c,r),o.length>0&&i.capturedCoords.every(u=>!o[0].equals(u))&&(i.capturedCoords=i.capturedCoords.concat(o));return i}static getCapturedInDirection(e,r,s){const o=s.getCopiedBoard(),c=e.getNext(r);if(c.isInRange(s.board[0].length,s.board.length)&&o[c.y][c.x]===(s.turn%2==0?Be.LIGHT:Be.DARK)){K(n.VERBOSE||!1,"a group could be captured");const g=(new Om).getGroupDatas(c,o);if(n.isCapturableGroup(g,s.koCoord))return K(n.VERBOSE||!1,{neightbooringGroupCoord:g.getCoords(),message:"is capturable"}),g.getCoords()}return[]}static isCapturableGroup(e,r){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===r.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return n.getEmptyZones(e).filter(s=>s.isMonoWrapped())}static applyPass(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy(),i=e.turn;let o,c;return e.phase===Vn.PASSED?(o=Vn.COUNTING,c=new Os(r,s,i+1,P.empty(),o),c=n.markTerritoryAndCount(c)):(ye(e.phase===Vn.PLAYING,"Cannot pass in counting phase!"),o=Vn.PASSED,c=new Os(r,s,i+1,P.empty(),o)),c}static applyLegalAccept(e){const r=e.getCopiedBoard();let s;return s=e.phase===Vn.COUNTING?Vn.ACCEPT:Vn.FINISHED,new Os(r,e.getCapturedCopy(),e.turn+1,P.empty(),s)}static applyNormalLegalMove(e,r,s){let i;K(n.VERBOSE,{applyNormalLegal:{currentState:r,legalMove:e,status}}),i=[Vn.COUNTING,Vn.ACCEPT].includes(r.phase)?n.resurrectStones(r):r.copy();const o=e.coord.x,c=e.coord.y,u=i.getCopiedBoard(),h=i.turn,g=Be.ofPlayer(i.getCurrentPlayer()),m=h+1;u[c][o]=g;for(const I of s)u[I.y][I.x]=Be.EMPTY;const C=n.getNewKo(e,u,s),w=i.getCapturedCopy();return w[g.player.value]+=s.length,new Os(u,w,m,C,Vn.PLAYING)}static resurrectStones(e){for(let r=0;r<e.board.length;r++)for(let s=0;s<e.board[0].length;s++)e.getPieceAtXY(s,r).isDead()&&(e=n.switchAliveness(new M(s,r),e));return n.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,r){K(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:r}});const s=n.removeAndSubstractTerritory(r),i=n.switchAliveness(e.coord,s),o=new Os(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,P.empty(),Vn.COUNTING);return n.markTerritoryAndCount(o)}isLegal(e,r){return n.isLegal(e,r)}applyLegalMove(e,r,s){return K(n.VERBOSE,{applyLegalMove:{legalMove:e,state:r,status:s}}),n.isPass(e)?(K(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(r)):n.isAccept(e)?(K(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(r)):n.isLegalDeadMarking(e,r)?(K(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,r)):(K(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,r,s))}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class $ce{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class zlt extends q1{getListMoves(t){K(P3.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===Vn.PLAYING||r.phase===Vn.PASSED)return s.push(Y1.PASS),s;{K(P3.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[Y1.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new Y1(i,s),t.getPieceAt(r.coord)===Be.EMPTY&&P3.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=P3.getGroupsDatasWhere(r,i=>i!==Be.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const h=new Y1(o.x,o.y);return e.push(h),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===Be.DARK?Be.DEAD_DARK:o===Be.LIGHT?Be.DEAD_LIGHT:o.isTerritory()?Be.EMPTY:o),s=new Os(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=P3.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){for(let r=0;r<t.length;r++)for(let s=0;s<t[0].length;s++)t[r][s]=e(t[r][s]);return t}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=P3.switchAliveness(o,r))}return r}getBoardValue(t){const e=t.gameState,r=P3.getGameStatus(t);if(r.isEndGame)return new st(r.toBoardValue());K(P3.VERBOSE||!1,"GoRules.getBoardValue");const i=P3.markTerritoryAndCount(e),o=i.getCapturedCopy(),c=this.getDeadStones(i);return new st(o[1]+2*c[0]-(o[0]+2*c[1]))}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}const it=Be.LIGHT,Xe=Be.DARK,fH=Be.DEAD_LIGHT,p9=Be.LIGHT_TERRITORY,wc=Be.DARK_TERRITORY,me=Be.EMPTY;class Uce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Os.getInitialState()),fe.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Os([[me,Xe,me,me,it,it],[me,Xe,me,me,it,me],[me,Xe,Xe,it,it,me],[me,me,Xe,it,me,me],[me,me,Xe,it,me,me],[me,me,Xe,it,me,me]],[0,0],0,P.empty(),Vn.PLAYING)),fe.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Os([[me,me,me,me,me],[me,me,Xe,me,me],[me,Xe,it,me,me],[me,me,Xe,me,me],[me,me,me,me,me]],[0,0],0,P.empty(),Vn.PLAYING),[new Y1(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),fe.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Os([[me,Xe,me,me,me],[Xe,it,me,me,me],[Xe,it,it,Xe,me],[me,Xe,Xe,me,me],[me,me,me,me,me]],[0,0],0,P.empty(),Vn.PLAYING),[new Y1(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),fe.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Os([[me,Xe,me,me,me],[Xe,me,me,me,me],[Xe,me,me,me,it],[it,Xe,me,it,me],[me,it,me,it,Xe]],[0,0],0,P.empty(),Vn.PLAYING)),fe.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Os([[me,me,me,me,me],[Xe,Xe,Xe,me,me],[it,it,Xe,me,me],[me,it,Xe,me,me],[it,it,Xe,me,me]],[0,0],0,P.empty(),Vn.PLAYING)),fe.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Os([[me,Xe,it,me,me],[it,Xe,it,me,me],[Xe,Xe,it,me,me],[it,Xe,it,me,me],[me,Xe,it,me,me]],[0,0],0,P.empty(),Vn.PLAYING)),fe.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Os([[me,it,Xe,me,it,Xe,me],[me,it,Xe,Xe,it,Xe,me],[me,it,Xe,Xe,it,Xe,me],[me,it,Xe,Xe,it,Xe,me],[me,it,Xe,it,it,Xe,me],[me,it,Xe,it,it,Xe,me],[me,it,Xe,me,it,Xe,me]],[0,0],0,P.empty(),Vn.PLAYING)),fe.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Os([[me,me,me,me,me,me,me],[me,me,me,me,me,me,me],[me,me,me,Xe,it,me,me],[me,me,Xe,it,me,it,me],[me,me,me,Xe,it,me,me],[me,me,me,me,me,me,me],[me,me,me,me,me,me,me]],[0,0],0,P.empty(),Vn.PLAYING),[new Y1(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),fe.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Os([[it,Xe,Xe,Xe,Xe,Xe,wc,wc,wc],[it,it,it,it,Xe,Xe,Xe,wc,wc],[it,p9,it,it,Xe,fH,fH,Xe,wc],[Xe,it,it,it,it,Xe,wc,wc,wc],[me,it,p9,it,Xe,Xe,fH,Xe,wc],[it,p9,it,it,Xe,Xe,Xe,Xe,Xe],[it,it,Xe,Xe,Xe,it,it,Xe,it],[Xe,Xe,Xe,it,it,it,p9,it,it],[wc,wc,Xe,Xe,Xe,it,it,p9,p9]],[0,0],0,P.empty(),Vn.COUNTING),[new Y1(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}function Vlt(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v(2).index,r=v().index;D("cx",25+50*e)("cy",25+50*r)("r",22)}}function Hlt(n,t){if(1&n){const e=Te();B(),b(0,"line",11),J("click",function(){ue(e);const s=v(2).index,i=v().index;return oe(v().onClick(s,i))}),O()}if(2&n){const e=v(2).index,r=v().index;D("x1",50*e)("y1",50*r)("x2",50+50*e)("y2",50+50*r)}}function Flt(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"circle",7),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onClick(s,i))}),O(),k(2,Vlt,1,3,"circle",8),k(3,Hlt,1,4,"line",9),O()}if(2&n){const e=v().index,r=v().index,s=v();S(1),T("ngClass",s.getSpaceClass(e,r)),D("cx",25+50*e)("cy",25+50*r)("r",22),S(1),T("ngIf",s.isLastSpace(e,r)),S(1),T("ngIf",s.isDead(e,r))}}function Blt(n,t){if(1&n){const e=Te();B(),b(0,"circle",15),J("click",function(){ue(e);const s=v(2).index,i=v().index;return oe(v().onClick(s,i))}),O()}if(2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();D("cx",25+50*r)("cy",25+50*i)("r",10)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function $lt(n,t){if(1&n){const e=Te();B(),b(0,"rect",12),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onClick(s,i))}),O(),b(1,"line",13),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onClick(s,i))}),O(),b(2,"line",13),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().onClick(s,i))}),O(),k(3,Blt,1,4,"circle",14)}if(2&n){const e=v().index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("x",50*e)("y",50*r),S(1),D("x1",50*e)("y1",25+50*r)("x2",50+50*e)("y2",25+50*r),S(1),D("x1",25+50*e)("y1",50*r)("x2",25+50*e)("y2",50+50*r),S(1),T("ngIf",s.isTerritory(e,r))}}function Ult(n,t){if(1&n&&(B(),b(0,"g"),k(1,Flt,4,6,"g",5),k(2,$lt,4,13,"ng-template",null,6,c1),O()),2&n){const e=t.index,r=t1(3),s=v().index,i=v();S(1),T("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function Glt(n,t){if(1&n&&(B(),b(0,"g"),k(1,Ult,4,2,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Wlt(n,t){if(1&n&&(B(),X(0,"rect",16)),2&n){const e=v();D("x",12.5+50*e.ko.get().x)("y",12.5+50*e.ko.get().y)}}function qlt(n,t){if(1&n){const e=Te();B(),b(0,"circle",17),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.x,i.y))}),O()}if(2&n){const e=t.$implicit;D("cx",25+50*e.x)("cy",25+50*e.y)("r",7)}}let jlt=(()=>{class n extends Eo{constructor(e){super(e),this.ko=P.empty(),this.last=P.empty(),this.captures=[],this.GoPiece=Be,this.scores=P.of([0,0]),this.rules=new P3(Os),this.availableMinimaxes=[new zlt(this.rules,"GoMinimax")],this.encoder=Y1.encoder,this.tutorial=(new Uce).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=P.empty();const o=new Y1(e,r);return s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){K(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.rules.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=P.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==Vn.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new M(s,r),o=e.getPieceAt(i).isOccupied(),c=this.board[r][s]===Be.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return A(function*(){const r=e.getState().phase;return r===Vn.PLAYING||r===Vn.PASSED?e.onClick(Y1.PASS.coord.x,Y1.PASS.coord.y):(ye(r===Vn.COUNTING||r===Vn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(Y1.ACCEPT.coord.x,Y1.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==Be.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new M(e,r))}isTerritory(e,r){return this.getState().isTerritory(new M(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-go"]],features:[l],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),X(1,"rect",1),k(2,Glt,2,1,"g",2),k(3,Wlt,1,2,"rect",3),k(4,qlt,1,3,"circle",4),O()),2&e&&(D("viewBox","0 -3 "+50*r.board.length+" "+(6+50*r.board.length)),S(1),D("width",50*r.board.length)("height",50*r.board.length),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.ko.isPresent()),S(1),T("ngForOf",r.captures))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Xl{constructor(t,e,r,s){this.left=t,this.up=e,this.width=r,this.height=s}static fromLimits(t,e,r,s){return new Xl(t,r,e-t,s-r)}static fromHexa(t,e,r){const s=t.flatMap(g=>e.getHexaPointsListAt(g)),i=Xl.getLimits(s);return new Xl(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of t)s=Math.min(s,o.x),i=Math.min(i,o.y),e=Math.max(e,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:e,maxY:r}}center(){return new M(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(t,e,r,s){return new Xl(this.left-t,this.up-r,this.width+t+e,this.height+r+s)}containingAtLeast(t){const e=Math.min(this.left,t.left),r=Math.max(this.right(),t.right()),s=Math.min(this.up,t.up),i=Math.max(this.bottom(),t.bottom());return Xl.fromLimits(e,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let Qr=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();class qs{constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}qs.encoder=new class extends C4{encode(n){return{owner:n.owner.value,kind:n.kind}}decode(n){ye(null!==we.getNonNullable(n).kind,"invalid encoded HivePiece"),ye(null!==we.getNonNullable(n).owner,"invalid encoded HivePiece");const t=we.getNonNullable(n).kind,e=z.of(we.getNonNullable(n).owner);return new qs(e,t)}};class w4{constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&Ye.compareArray(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new w4([t,...this.pieces])}topPiece(){return we.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new w4(t)}size(){return this.pieces.length}}w4.EMPTY=new w4([]);class Ba extends m3{constructor(t,e,r){super(e,r),this.piece=t}static from(t,e){return new Ba(t,e.x,e.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof Ba&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}Ba.encoder=Gi.tuple([qs.encoder,M.encoder],n=>[n.piece,n.coord],n=>new Ba(n[0],n[1].x,n[1].y));class Si extends $0{constructor(t,e){super(t,e)}static from(t,e){return t.equals(e)?G.failure(gt.MOVE_CANNOT_BE_STATIC()):G.success(new Si(t,e))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof bc)&&t instanceof Si&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}Si.encoder=P4.getEncoder(Si.from);class bc extends Si{constructor(t){super(t[0],t[3]),this.coords=t}static fromCoords(t){return new bc(t)}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof bc&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}bc.encoder=Gi.tuple([M.encoder,M.encoder,M.encoder,M.encoder],n=>n.coords,n=>new bc(n));class hH extends yi{toString(){return"HiveMovePass"}equals(t){return t instanceof hH}}var m2;!function(n){n.PASS=new hH,n.drop=function t(s,i){return Ba.from(s,i)},n.move=function e(s,i){return Si.from(s,i)},n.spiderMove=function r(s){return bc.fromCoords(s)},n.encoder=new class extends Gi{encodeMove(s){return s instanceof Ba?{moveType:"Drop",encoded:Ba.encoder.encode(s)}:s instanceof bc?{moveType:"Spider",encoded:bc.encoder.encode(s)}:s instanceof Si?{moveType:"CoordToCoord",encoded:Si.encoder.encode(s)}:{moveType:"Pass"}}decodeMove(s){const i=we.getNonNullable(s).moveType,o=we.getNonNullable(s).encoded;return"Drop"===i?Ba.encoder.decode(o):"Spider"===i?bc.encoder.decode(o):"CoordToCoord"===i?Si.encoder.decode(o):n.PASS}}}(m2||(m2={}));class Oc{static from(t){return Oc.INSTANCES.isAbsent()&&(Oc.INSTANCES=P.of({QueenBee:aP.get(),Beetle:cP.get(),Grasshopper:lP.get(),Spider:Am.get(),SoldierAnt:uP.get()})),Oc.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?G.failure(Qr.THIS_PIECE_CANNOT_CLIMB()):G.success(void 0)}canSlideBetweenNeighbors(t,e,r){const s=new $t(Mi.getNeighbors(e)),i=new $t(Mi.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(t.getAt(c).isEmpty())return!0;return!1}}Oc.INSTANCES=P.empty();class aP extends Oc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new aP)),this.INSTANCE.get()}moveValidity(t,e){return!1===Mi.areNeighbors(t.getStart(),t.getEnd())?G.failure(Qr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?G.failure(Qr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of Mi.getNeighbors(t))e.getAt(s).isEmpty()&&r.push(Si.from(t,s).get());return r}}aP.INSTANCE=P.empty();class cP extends Oc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new cP)),this.INSTANCE.get()}moveValidity(t,e){return!1===Mi.areNeighbors(t.getStart(),t.getEnd())?G.failure(Qr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):G.success(void 0)}getPotentialMoves(t,e){const r=[];for(const s of Mi.getNeighbors(t))r.push(Si.from(t,s).get());return r}}cP.INSTANCE=P.empty();class lP extends Oc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new lP)),this.INSTANCE.get()}moveValidity(t,e){if(xe.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return G.failure(Qr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=t.getStart().getCoordsToward(t.getEnd());if(0===s.length)return G.failure(Qr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(e.getAt(i).isEmpty())return G.failure(Qr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of xe.factory.all){const i=t.getNext(s);if(e.getAt(i).hasPieces()){let o=i;for(;e.getAt(o).hasPieces();)o=o.getNext(s);r.push(Si.from(t,o).get())}}return r}}lP.INSTANCE=P.empty();class Am extends Oc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new Am)),this.INSTANCE.get()}prefixLegality(t,e){const r=new $t,s=e.update().setAt(t[0],w4.EMPTY).increaseTurnAndFinalizeUpdate();t=t.map(i=>i.getNext(s.offset));for(let i=1;i<t.length;i++){if(s.getAt(t[i]).hasPieces())return G.failure(Qr.THIS_PIECE_CANNOT_CLIMB());if(!1===Mi.areNeighbors(t[i-1],t[i]))return G.failure(Qr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(t[i],t[i-1]))return G.failure(Qr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,t[i-1],t[i]))return G.failure(Qr.MUST_BE_ABLE_TO_SLIDE());if(r.contains(t[i]))return G.failure(Qr.SPIDER_CANNOT_BACKTRACK());r.add(t[i])}return G.success(void 0)}moveValidity(t,e){we.assert(t instanceof bc,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(t.coords,e);return s.isFailure()?s:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=e.update().setAt(t,w4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[t=t.getNext(r.offset)]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new $t(s.map(function i(c){return c=c.map(u=>u.getPrevious(r.offset)),bc.fromCoords(c)})).toList()}nextMoveStep(t,e){const r=e[e.length-1];return new $t(Mi.getNeighbors(r)).filter(function s(o){return!t.getAt(o).hasPieces()&&void 0===e.find(c=>o.equals(c))&&t.haveCommonNeighbor(o,r)}).toList().map(o=>[...e,o])}}Am.INSTANCE=P.empty();class uP extends Oc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new uP)),this.INSTANCE.get()}pathExists(t,e,r){const s=new $t,i=[e];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of Mi.getNeighbors(o)){const u=t.getAt(c).isEmpty(),h=t.getOccupiedNeighbors(c).size()>0,g=this.canSlideBetweenNeighbors(t,o,c);u&&h&&g&&i.push(c)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?G.failure(Qr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=new $t;for(const s of e.occupiedSpaces())if(!s.equals(t))for(const i of e.emptyNeighbors(s))r.add(Si.from(t,i).get());return r.toList()}}uP.INSTANCE=P.empty();class Gce extends XS{constructor(t,e,r){super(e),this.pieces=t;const s=this.computeScale();this.pieces=s.pieces,this.width=s.width,this.height=s.height,this.offset=r??s.offset,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const c of this.pieces.listKeys())t=Math.min(c.x,t),e=Math.max(c.x,e),r=Math.min(c.y,r),s=Math.max(c.y,s);let i=new Xf;const o=new ln(-t,-r);if(0===t&&0===r)i=this.pieces;else for(const c of this.pieces.listKeys()){const u=this.pieces.delete(c),h=c.getNext(o);i.set(h,u)}return{width:e+1-t,height:s+1-r,pieces:i,offset:o}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new $t(Mi.getNeighbors(t)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const t=new $t,e=new $t;return this.pieces.forEach(r=>{if(!1===t.contains(r.key)){const s=new $t,i=new $t([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),t.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===t.contains(c)))}e.add(s)}}),e}}class fP{constructor(t){this.pieces=t}static getInitial(){const t=new zn;for(const e of z.PLAYERS)t.set(new qs(e,"QueenBee"),1),t.set(new qs(e,"Beetle"),2),t.set(new qs(e,"Spider"),2),t.set(new qs(e,"Grasshopper"),3),t.set(new qs(e,"SoldierAnt"),3);return t.makeImmutable(),new fP(t)}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return P.of(e);return P.empty()}remove(t){const e=this.pieces.get(t).get();we.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(t,e-1),new fP(r)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const r=[];for(let s=0;s<e.value;s++)r.push(e.key);t.push(new w4(r))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(r=>{r.key.owner===t&&r.value>0&&e.push(r.key)}),e}}class Im{constructor(t,e,r,s){this.pieces=t,this.remainingPieces=e,this.queenBees=r,this.turn=s}static of(t){return new Im(t.pieces,t.remainingPieces,t.queenBees,t.turn)}setAt(t,e){const r=this.queenBees.getCopy();for(const i of z.PLAYERS)r.get(i).equalsValue(t)&&r.delete(i);for(const i of e.pieces)"QueenBee"===i.kind&&r.put(i.owner,t);const s=this.pieces.getCopy();return e.isEmpty()?s.delete(t):s.put(t,e),new Im(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(t){return new Im(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new Pi(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class Pi extends Gce{constructor(t,e,r,s,i){super(t,s,i),this.remainingPieces=e,this.queenBees=r,this.queenBees=r.getCopy();for(const o of r.listKeys()){const u=r.get(o).get().getNext(this.offset);this.queenBees.replace(o,u)}this.queenBees.makeImmutable()}static getInitialState(){return Pi.fromRepresentation([],0)}static fromRepresentation(t,e){const r=new Xf;let s=fP.getInitial();const i=new zn;for(let o=0;o<t.length;o++)for(let c=0;c<t[0].length;c++)if(t[o][c].length>0){r.set(new M(c,o),new w4(t[o][c]));const u=P.ofNullable(t[o][c].find(h=>"QueenBee"===h.kind));u.isPresent()&&i.set(u.get().owner,new M(c,o));for(const h of t[o][c])s=s.remove(h)}return new Pi(r,s,i,e)}update(){return Im.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():w4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const r of xe.factory.all){const s=t.getNext(r);this.getAt(s).hasPieces()&&(e+=1)}return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const r of Mi.getNeighbors(t))this.getAt(r).isEmpty()&&e.push(r);return e}haveCommonNeighbor(t,e){const r=this.getOccupiedNeighbors(t),s=this.getOccupiedNeighbors(e);return r.findAnyCommonElement(s).isPresent()}}class _2 extends tr{constructor(){super(Pi)}static get(){return _2.singleton.isAbsent()&&(_2.singleton=P.of(new _2)),_2.singleton.get()}applyLegalMove(t,e,r){return t instanceof Ba?this.applyLegalDrop(t,e):t instanceof Si?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const r=e.getAt(t.coord);return e.update().setAt(t.coord,r.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const r=e.getAt(t.getStart()),s=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),r.removeTopPiece()).setAt(t.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof Ba?this.isLegalDrop(t,e):t instanceof Si?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?G.success(void 0):G.failure(gt.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return G.failure(Qr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=e.getAt(t.getStart());if(r.isEmpty())return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===e.getCurrentOpponent())return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());const i=Oc.from(s).moveValidity(t,e);if(i.isFailure())return i;const o=e.update().setAt(t.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return G.failure(Qr.CANNOT_DISCONNECT_HIVE());const c=t.getEnd().getNext(o.offset);return 0===o.numberOfNeighbors(c)?G.failure(Qr.CANNOT_DISCONNECT_HIVE()):G.success(void 0)}mustPlaceQueenBee(t){return t.turn>=6&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const r=e.getCurrentPlayer();if(t.piece.owner===r.getOpponent())return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.remainingPieces.hasRemaining(t.piece))return G.failure(Qr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return G.failure(Qr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(t,e);return s.isFailure()?s:e.getAt(t.coord).hasPieces()?G.failure(Qr.MUST_DROP_ON_EMPTY_SPACE()):G.success(void 0)}checkNeighborValidity(t,e){const r=e.getCurrentPlayer();let s=!1;for(const i of Mi.getNeighbors(t.coord)){const o=e.getAt(i);if(o.hasPieces()&&(s=!0,1!==e.turn&&o.topPiece().owner===r.getOpponent()))return G.failure(Qr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===s?G.failure(Qr.MUST_BE_CONNECTED_TO_HIVE()):G.success(void 0)}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new $t([new M(0,0)]);if(1===t.turn)return new $t(Mi.getNeighbors(new M(0,0)));const r=t.remainingPieces.getAny(e);if(r.isAbsent())return new $t;const s=r.get(),i=new $t;for(const o of t.occupiedSpaces())if(t.getAt(o).topPiece().owner===e)for(const c of t.emptyNeighbors(o)){const u=Ba.from(s,c);this.isLegalDrop(u,t).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(t,e){const r=t.getCurrentPlayer(),s=new $t,i=t.getAt(e).topPiece();if(i.owner===r)for(const o of Oc.from(i).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(o,t).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(t){const e=new $t;for(const r of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,r));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of z.PLAYERS){const i=e.queenBeeLocation(s);i.isPresent()&&(r[s.value]=e.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?Ie.DRAW:6===r[0]?Ie.getVictory(z.ONE):6===r[1]?Ie.getVictory(z.ZERO):Ie.ONGOING}}_2.singleton=P.empty();class Ylt extends q1{getListMoves(t){const e=this.getListDrops(t.gameState),r=this.getListOfOnBoardMoves(t.gameState),s=e.concat(r);return 0===s.length?[m2.PASS]:s}getListOfOnBoardMoves(t){return _2.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],r=t.getCurrentPlayer(),s=new qs(r,"QueenBee");for(const i of _2.get().getPossibleDropLocations(t))if(_2.get().mustPlaceQueenBee(t))e.push(m2.drop(s,i));else for(const o of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(m2.drop(o,i));return e}getBoardValue(t){const e=_2.get().getGameStatus(t);if(e!==Ie.ONGOING)return new st(e.toBoardValue());const r=this.queenBeeMobility(t.gameState,z.ZERO),s=this.queenBeeMobility(t.gameState,z.ONE);return st.from(r,s)}queenBeeMobility(t,e){const r=t.queenBeeLocation(e);return r.isPresent()?_2.get().getPossibleMovesFrom(t,r.get()).size():0}}const b4=new qs(z.ZERO,"QueenBee"),l5=new qs(z.ZERO,"Beetle"),g9=new qs(z.ZERO,"Grasshopper"),hP=new qs(z.ZERO,"Spider"),dP=new qs(z.ZERO,"SoldierAnt"),u5=new qs(z.ONE,"QueenBee"),$a=new qs(z.ONE,"Beetle"),dH=new qs(z.ONE,"Grasshopper"),pH=new qs(z.ONE,"Spider"),xm=new qs(z.ONE,"SoldierAnt");class Wce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,Pi.fromRepresentation([[[u5],[$a],[pH],[g9]],[[g9],[],[dP],[]],[[dP],[],[],[]]],8)),fe.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,Pi.fromRepresentation([[[],[$a],[hP]],[[xm],[u5],[b4]],[[g9],[l5],[]]],7)),fe.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,Pi.getInitialState(),m2.drop(l5,new M(0,0)),$localize`Congratulations!`),fe.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,Pi.fromRepresentation([[[$a],[g9]]],2),m2.drop(b4,new M(2,0)),$localize`Congratulations!`),fe.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,Pi.fromRepresentation([[[],[hP],[dH],[u5],[$a]],[[$a],[b4],[l5],[],[]]],4),[m2.move(new M(1,1),new M(0,2)).get(),m2.move(new M(1,1),new M(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,Pi.fromRepresentation([[[b4],[u5],[l5]],[[$a],[],[]]],6),[m2.move(new M(2,0),new M(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,Pi.fromRepresentation([[[$a,b4],[u5],[l5]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,Pi.fromRepresentation([[[g9],[b4],[$a],[xm]],[[dH],[],[],[]]],6),[m2.move(new M(0,0),new M(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,Pi.fromRepresentation([[[],[dP],[u5]],[[],[b4],[$a]],[[xm],[pH],[]]],6),m2.move(new M(1,0),new M(3,1)).get(),(t,e,r)=>t.equals(m2.move(new M(1,0),new M(0,1)).get())?U.failure($localize`You have not freed your queen, try again!`):U.SUCCESS,$localize`Congratulations!`),fe.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,Pi.fromRepresentation([[[],[hP],[pH],[$a]],[[],[],[],[l5]],[[$a],[],[],[xm]],[[dP],[],[g9],[]],[[b4],[dH],[],[]]],6),m2.spiderMove([new M(1,0),new M(1,1),new M(2,1),new M(2,2)]),$localize`Congratulations!`),fe.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,Pi.fromRepresentation([[[],[hP],[]],[[],[b4],[$a]],[[xm],[],[]]],6)),fe.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,Pi.fromRepresentation([[[$a,l5],[b4],[u5]]],4))]}}const Klt=["app-hive-piece",""];function Xlt(n,t){1&n&&(B(),X(0,"path",9))}function Qlt(n,t){1&n&&(B(),X(0,"path",10))}function Jlt(n,t){1&n&&(B(),X(0,"path",11))}function e6t(n,t){1&n&&(B(),X(0,"path",12))}function t6t(n,t){1&n&&(B(),X(0,"path",13))}let n6t=(()=>{class n extends Cce{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new M(0,0)}ngAfterContentChecked(){const e=new M(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(e),this.hexaCenter=this.hexaLayout.getCenterAt(e);const s=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=qr(n)))(r||n)}}(),n.\u0275cmp=mt({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:Klt,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(e,r){1&e&&(B(),b(0,"g"),X(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),b(5,"g"),k(6,Xlt,1,0,"path",4),k(7,Qlt,1,0,"path",5),k(8,Jlt,1,0,"path",6),k(9,e6t,1,0,"path",7),k(10,t6t,1,0,"path",8),O()()),2&e&&(D("transform",r.layerTransform),S(1),T("ngClass",r.pieceClass),D("points",r.isoPointsLight),S(1),T("ngClass",r.pieceClass),D("points",r.isoPointsDark),S(1),D("points",r.isoPointsStroke),S(1),T("ngClass",r.pieceClass),D("points",r.hexaPoints),S(1),D("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),S(1),T("ngIf","QueenBee"===r.piece.kind),S(1),T("ngIf","Beetle"===r.piece.kind),S(1),T("ngIf","Grasshopper"===r.piece.kind),S(1),T("ngIf","Spider"===r.piece.kind),S(1),T("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[En,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function r6t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"polygon",4),J("click",function(){const i=ue(e).$implicit;return oe(v().selectSpace(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","space_",e.x,"_",e.y,""),T("ngClass",e.content.spaceClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function s6t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",6),J("click",function(){ue(e);const s=v().$implicit;return oe(v().selectSpace(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","stroke_",e.x,"_",e.y,""),T("ngClass",e.content.strokeClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function i6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,s6t,1,4,"polygon",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.strokeClasses.length>0)}}function o6t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",8),J("click",function(){ue(e);const s=v().$implicit;return oe(v().selectSpace(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","stroke_",e.x,"_",e.y,""),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function a6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,o6t,1,3,"polygon",7),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.selected)}}function c6t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"g",9),J("click",function(){const i=ue(e).$implicit;return oe(v(2).selectStack(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v().index,s=v();S(1),We("id","piece_",e.x,"_",e.y,""),T("piece",e.content.piece)("x",e.x)("y",e.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function l6t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",6),J("click",function(){ue(e);const s=v().$implicit;return oe(v(2).selectStack(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v().index,s=v();We("id","stroke_",e.x,"_",e.y,""),T("ngClass",e.content.strokeClasses),D("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(e.x,e.y))}}function u6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,l6t,1,5,"polygon",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.strokeClasses.length>0)}}function f6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,c6t,2,8,"g",1),k(2,u6t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e),S(1),T("ngForOf",e)}}function h6t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"g",10),J("click",function(){const i=ue(e).$implicit;return oe(v(2).selectRemaining(i))}),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v(2);S(1),S1("id","remainingPiece_",e.toString(),""),T("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),D("transform",s.getRemainingPieceTransform(e))}}function d6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,h6t,2,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e.pieces)}}function p6t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v();D("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))("points",e.getHexaPointsAt(e.ORIGIN))}}function g6t(n,t){if(1&n&&(B(),X(0,"g",13)),2&n){const e=t.$implicit,r=t.index,s=v(2);S1("id","inspectedStack_",r,""),T("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),D("transform",s.inspectedStackTransform)}}function m6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,g6t,1,8,"g",12),O()),2&n){const e=v();S(1),T("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class qce extends ate{constructor(){super(...arguments),this.highlighted=[]}initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(r=>r.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class _6t extends ate{constructor(){super(...arguments),this.highlighted=[]}initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let v6t=(()=>{class n extends s9{constructor(e){super(e),this.ORIGIN=new M(0,0),this.remainingStacks=[],this.layers=[],this.ground=new qce,this.inspectedStack=P.empty(),this.inspectedStackCoord=P.empty(),this.selectedRemaining=P.empty(),this.selectedStart=P.empty(),this.selectedSpiderCoords=[],this.rules=_2.get(),this.availableMinimaxes=[new Ylt(this.rules,"HiveMinimax")],this.encoder=m2.encoder,this.tutorial=(new Wce).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new i9(1.5*this.SPACE_SIZE,new M(2*this.SPACE_SIZE,0),Ts.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new _6t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new M(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=_2.get().shouldPass(this.getState());const e=_2.get().getGameStatus(this.rules.node);switch(e){case Ie.ONGOING:break;case Ie.DRAW:this.highlight(this.getState().queenBeeLocation(z.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(z.ONE).get(),"victory-stroke");break;default:const s=e.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}this.rules.node.move.isPresent()&&this.showLastMove()}highlight(e,r){const s=this.getState().getAt(e).size();s-1 in this.layers&&this.layers[s-1].highlight(e,r)}pass(){var e=this;return A(function*(){return we.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(m2.PASS,e.getState())})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new M(0,0)),this.boardViewBox=Xl.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const r=new Xl(this.getRemainingPieceTransformAsCoord(new qs(z.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(z.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(z.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new M(c.right()+this.SPACE_SIZE,c.center().y),h=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(h-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new qce;for(const r of this.getAllNeighbors())e.initialize(r);return e}getAllNeighbors(){const e=new $t;for(const r of this.getPieceCoords())e.addAll(new $t(this.getState().emptyNeighbors(r)));return e.isEmpty()&&e.add(new M(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=P.empty(),this.selectedRemaining=P.empty(),this.selectedSpiderCoords=[],this.inspectedStack=P.empty(),this.rules.node.move.isPresent()&&this.showLastMove(),this.computeViewBox()}showLastMove(){for(const e of this.getLastMoveCoords())this.highlight(e,"last-move-stroke"),this.ground.highlightStroke(e,"last-move-stroke"),this.ground.highlightFill(e,"moved-fill")}getLastMoveCoords(){const e=this.rules.node.move.get();let r=[];e instanceof Ba?r=[e.coord]:e instanceof Si&&(r=[e.getStart(),e.getEnd()]);const s=this.getState().offset;return r.map(i=>i.getNext(s))}getRemainingPieceTransformAsCoord(e){const r=this.getRemainingPieceShift(e),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=e.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new M(s,i)}getRemainingPieceTransform(e){const r=this.getRemainingPieceTransformAsCoord(e);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(e){const r=this.getRemainingPieceTransformAsCoord(e),s=this.getState().remainingPieces.getQuantity(e);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return we.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var r=this;return A(function*(){const s=r.canUserPlay(`#remainingPiece_${e.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(e.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==e.kind&&_2.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(Qr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(e))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=P.of(e),r.clearHighlights();const i=_2.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return U.SUCCESS})()}selectStack(e,r){return this.select(new M(e,r),"piece")}selectSpace(e,r){return this.select(new M(e,r),"space")}select(e,r){var s=this;return A(function*(){const i=s.canUserPlay(`#${r}_${e.x}_${e.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(e);if(s.selectedRemaining.isPresent()){const u=m2.drop(s.selectedRemaining.get(),e);return s.chooseMove(u,o)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(e)?s.cancelMove():s.selectTarget(e,u)}return 0===c.size()?s.cancelMove():s.selectStart(e,c)})()}selectTarget(e,r){var s=this;return A(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(e);{const i=m2.move(s.selectedStart.get(),e);return ye(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get(),s.getState())}})()}selectStart(e,r){var s=this;return A(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),U.SUCCESS):(s.highlight(e,"selected-stroke"),s.inspectedStack=P.of(r),s.inspectedStackCoord=P.of(e),s.computeViewBox(),U.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&_2.get().mustPlaceQueenBee(i)?s.cancelMove(Qr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=P.of(e),s.highlight(e,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=P.of(r),s.inspectedStackCoord=P.of(e),s.computeViewBox()),s.highlightNextPossibleCoords(e),U.SUCCESS))})()}highlightNextPossibleCoords(e){for(const r of this.getNextPossibleCoords(e))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(e){const r=this.getState(),s=r.getAt(e).topPiece(),i=_2.get().getPossibleMovesFrom(r,e);return"Spider"===s.kind?i.filter(c=>Ye.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(e){var r=this;return A(function*(){if(r.selectedSpiderCoords.push(e),4===r.selectedSpiderCoords.length){const i=m2.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i,r.getState())}const s=Am.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),U.SUCCESS})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,r6t,2,4,"g",1),k(2,i6t,2,1,"g",1),k(3,a6t,2,1,"g",1),k(4,f6t,3,2,"g",1),k(5,d6t,2,1,"g",1),k(6,p6t,1,2,"polygon",2),k(7,m6t,2,1,"g",3),O()),2&e&&(D("viewBox",r.viewBox),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.layers),S(1),T("ngForOf",r.remainingStacks),S(1),T("ngIf",r.selectedRemaining.isPresent()),S(1),T("ngIf",r.inspectedStack.isPresent()))},dependencies:[En,Dn,on,n6t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Po extends sH{static of(t,e){return new Po(t,e)}static from(t,e){try{const r=new Po(t,e);return G.success(r)}catch(r){return G.failure(r.message)}}getMaximalDistance(){return 11}}Po.encoder=P4.getEncoder(Po.from);const C6t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:z.ZERO};class T3 extends iH{static getInitialState(){const t=fn.UNOCCUPIED,e=fn.INVADERS,r=fn.DEFENDERS;return new T3([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,fn.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}from(t,e){return new T3(t,e)}}class f5 extends oH{constructor(){super(T3,C6t,Po.of)}static get(){return null==f5.singleton&&(f5.singleton=new f5),V1.ruler=this.singleton,f5.singleton}}const R=fn.UNOCCUPIED,qt=fn.INVADERS,Jr=fn.DEFENDERS,pP=fn.PLAYER_ONE_KING;class jce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,T3.getInitialState()),fe.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,T3.getInitialState(),Po.of(new M(5,1),new M(1,1)),$localize`Congratulations!`),fe.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new T3([[R,R,R,R,qt,qt,qt,qt,R,R,R],[R,R,R,R,R,qt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[qt,R,R,R,R,Jr,R,R,R,R,qt],[qt,R,R,qt,Jr,Jr,Jr,R,R,R,qt],[qt,qt,R,Jr,Jr,pP,Jr,Jr,R,qt,qt],[qt,R,R,R,Jr,Jr,Jr,R,R,R,qt],[qt,R,R,R,R,Jr,R,R,R,R,qt],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,qt,R,R,R,R,R],[R,R,R,qt,qt,qt,qt,qt,R,R,R]],1),[Po.of(new M(5,3),new M(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Po.of(new M(3,0),new M(3,4))).withPreviousState(T3.getInitialState()),fe.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new T3([[R,R,R,qt,qt,qt,qt,qt,R,R,R],[R,Jr,R,R,R,qt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,Jr,R,R,R,R,qt],[qt,R,R,R,R,Jr,Jr,R,R,R,qt],[qt,qt,pP,R,Jr,R,Jr,Jr,R,R,qt],[R,R,qt,R,R,Jr,Jr,R,R,R,qt],[qt,R,R,R,R,Jr,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,qt,R,R,R,R,R,R,R,R,R],[R,R,R,qt,qt,qt,qt,R,qt,R,R]],12),[Po.of(new M(3,0),new M(3,5)),Po.of(new M(3,10),new M(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),fe.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new T3([[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,qt,R,R,R,R,R,R,R,R,R],[qt,pP,R,qt,R,R,R,R,R,R,R],[R,qt,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[Po.of(new M(3,4),new M(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),fe.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new T3([[R,R,qt,pP,qt,R,R,R,R,R,R],[R,R,R,R,R,R,Jr,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,qt,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[Po.of(new M(3,3),new M(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function y6t(n,t){1&n&&(B(),X(0,"polygon",8))}function E6t(n,t){1&n&&(B(),X(0,"rect",9))}function M6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,y6t,1,0,"polygon",6),k(2,E6t,1,0,"ng-template",null,7,c1),O()),2&n){const e=t1(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function S6t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function P6t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function T6t(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function w6t(n,t){if(1&n&&(B(),k(0,P6t,1,1,"polyline",14),k(1,T6t,4,20,"ng-template",null,15,c1)),2&n){const e=t1(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function b6t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",10),k(2,S6t,6,25,"g",11),k(3,w6t,3,2,"ng-template",null,12,c1),O()),2&n){const e=t1(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function O6t(n,t){if(1&n){const e=Te();B(),b(0,"g",3),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),X(1,"rect",4),k(2,M6t,4,2,"g",5),k(3,b6t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function N6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,O6t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function A6t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",17),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let I6t=(()=>{class n extends aH{constructor(e){super(e,!1,Po.from),this.rules=f5.get(),this.availableMinimaxes=[new tP(this.rules,"DummyBot"),new rP(this.rules,"Piece > Influence"),new C3(this.rules,"Piece > Control"),new c9(this.rules,"Escape > Piece > Control")],this.encoder=Po.encoder,this.tutorial=(new jce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,N6t,2,1,"g",1),k(2,A6t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class yn{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return yn.ANY;case 1:return yn.ORANGE;case 2:return yn.BLUE;case 3:return yn.PURPLE;case 4:return yn.PINK;case 5:return yn.YELLOW;case 6:return yn.RED;case 7:return yn.GREEN;default:return we.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),yn.BROWN}}}yn.ANY=new yn(0,"any","#000"),yn.ORANGE=new yn(1,"orange","#d67421"),yn.BLUE=new yn(2,"blue","#006bac"),yn.PURPLE=new yn(3,"purple","#6f3787"),yn.PINK=new yn(4,"pink","#d2719e"),yn.YELLOW=new yn(5,"yellow","#e2c200"),yn.RED=new yn(6,"red","#d23339"),yn.GREEN=new yn(7,"green","#009157"),yn.BROWN=new yn(8,"brown","#562500");class Hn{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new Hn(t,yn.of(e))}static createPlayerColors(t){return{ORANGE:new Hn(t,yn.ORANGE),BLUE:new Hn(t,yn.BLUE),PURPLE:new Hn(t,yn.PURPLE),PINK:new Hn(t,yn.PINK),YELLOW:new Hn(t,yn.YELLOW),RED:new Hn(t,yn.RED),GREEN:new Hn(t,yn.GREEN),BROWN:new Hn(t,yn.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(de.NONE)}belongsTo(t){return this.player===t}}Hn.EMPTY=new Hn(de.NONE,yn.ANY),Hn.ZERO=Hn.createPlayerColors(z.ZERO),Hn.ONE=Hn.createPlayerColors(z.ONE);class v2{static getColorAt(t,e){return v2.COLORS[e][t]}static getInitialBoard(){const t=Hn.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>Hn.of(z.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>Hn.of(z.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals(Hn.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new M(s,r);v2.isEmptyAt(t,i)||e.push(i)}return e}}v2.INITIAL=v2.getInitialBoard(),v2.SIZE=8,v2.COLORS=Ye.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],yn.of);class gH extends yi{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}gH.PASS=new gH;class mH extends $0{constructor(t,e){super(t,e)}static of(t,e){if(t.isNotInRange(v2.SIZE,v2.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(e.isNotInRange(v2.SIZE,v2.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+e.toString());return new mH(t,e)}isPieceMove(){return!0}equals(t){return t===this||!!t.isPieceMove()&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}var To;!function(n){n.PASS=gH.PASS,n.of=function t(e,r){return mH.of(e,r)},n.encoder=new class extends _n{maxValue(){return 34952}encodeNumber(e){return e.isPieceMove()?4096*e.getStart().x+256*e.getStart().y+16*e.getEnd().x+e.getEnd().y:0}decodeNumber(e){if(0===e)return n.PASS;const r=e%16,s=(e=e/16|0)%16,i=(e=e/16|0)%16;return n.of(new M((e=e/16|0)%16,i),new M(s,r))}}}(To||(To={}));class w3 extends ws{constructor(t,e,r,s,i){super(Ye.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new w3(0,yn.ANY,P.empty(),!1,v2.INITIAL)}}let km=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class wo extends tr{static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new M(0,7),new M(1,7),new M(2,7),new M(3,7),new M(4,7),new M(5,7),new M(6,7),new M(7,7)]}static getMovablePieces(t){return wo.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&v2.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===z.ONE?[be.DOWN,be.DOWN_LEFT,be.DOWN_RIGHT]:[be.UP,be.UP_LEFT,be.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===z.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=wo.getMovablePieces(t);return 0===e.length?(ye(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[To.PASS]):wo.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of wo.playerDirections(s))for(let c=1;c<v2.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!v2.isEmptyAt(t.board,u))break;{const h=To.of(i,u);r.push(h)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return v2.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);ye(i!==Hn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===z.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(t.isPieceMove()){const r=t.getStart(),s=t.getEnd(),i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());if(i!==yn.ANY&&o.color!==i)return G.failure(km.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return G.failure(gt.MUST_CLICK_ON_EMPTY_SPACE());const u=be.factory.fromMove(r,s);if(u.isFailure())return G.failure(km.DIRECTION_NOT_ALLOWED());const h=u.get();if(!wo.directionAllowedForPlayer(h,e.getCurrentPlayer()))return G.failure(km.DIRECTION_NOT_ALLOWED());let g=r;for(;!g.equals(s);)if(g=g.getNext(h),!e.getPieceAt(g).isEmpty())return G.failure(km.MOVE_BLOCKED());return G.success(void 0)}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?G.success(void 0):G.failure(gt.CANNOT_PASS())}nextCoordToPlay(t,e){return P.ofNullable(v2.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(t.isPieceMove()){const s=t.getStart(),i=t.getEnd(),o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=Hn.EMPTY;const c=v2.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new w3(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new w3(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return wo.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(wo.mustPass(e)&&e.alreadyPassed)return Ie.getDefeat(r);const[s,i]=wo.getFurthestPiecePositions(e);return 7===i?Ie.ONE_WON:0===s?Ie.ZERO_WON:Ie.ONGOING}}class x6t extends q1{getListMoves(t){const e=wo.getListMovesFromState(t.gameState);return Ye.sortByDescending(e,r=>r.length()),e}getBoardValue(t){const e=t.gameState,r=e.getCurrentPlayer();if(wo.mustPass(e)&&e.alreadyPassed)return new st(r.getDefeatValue());const[s,i]=wo.getFurthestPiecePositions(e);return new st(7===i?z.ONE.getVictoryValue():0===s?z.ZERO.getVictoryValue():i-(7-s))}}const se=Hn.EMPTY,gP=Hn.ZERO.ORANGE,mP=Hn.ONE.ORANGE,_P=Hn.ZERO.BLUE,vP=Hn.ONE.BLUE,_H=Hn.ZERO.PURPLE,Lm=Hn.ONE.PURPLE,CP=Hn.ZERO.PINK,yP=Hn.ONE.PINK,EP=Hn.ZERO.YELLOW,MP=Hn.ONE.YELLOW,SP=Hn.ZERO.RED,PP=Hn.ONE.RED,TP=Hn.ZERO.GREEN,wP=Hn.ONE.GREEN,bP=Hn.ZERO.BROWN,OP=Hn.ONE.BROWN;class Zce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new w3(5,yn.ORANGE,P.empty(),!1,[[bP,vP,Lm,yP,MP,PP,wP,OP],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,mP,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,TP,SP,EP,CP,_H,_P,gP]])).withPreviousMove(To.of(new M(0,7),new M(0,0))),fe.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,w3.getInitialState(),To.of(new M(7,7),new M(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),fe.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new w3(1,yn.PINK,P.of(new M(3,0)),!1,[[mP,vP,Lm,yP,MP,PP,wP,OP],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,_P,se],[se,se,se,se,se,se,se,se],[bP,TP,SP,EP,CP,_H,se,gP]]),[To.of(new M(3,0),new M(3,6)),To.of(new M(3,0),new M(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(To.of(new M(6,7),new M(6,5))),fe.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new w3(1,yn.PINK,P.of(new M(3,6)),!1,[[mP,vP,Lm,se,MP,PP,wP,OP],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,_P],[se,se,se,se,se,se,se,se],[se,se,se,yP,se,se,se,se],[bP,TP,SP,EP,CP,_H,se,gP]])).withPreviousMove(To.of(new M(6,5),new M(7,4))),fe.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new w3(2,yn.RED,P.of(new M(2,4)),!1,[[se,vP,Lm,se,se,PP,se,se],[se,se,se,MP,se,se,se,se],[se,se,se,yP,se,Lm,se,se],[se,se,se,EP,se,se,se,se],[se,se,SP,se,se,se,se,se],[se,se,se,se,se,se,wP,se],[mP,se,se,se,se,CP,se,OP],[bP,TP,se,se,se,se,_P,gP]]),[To.of(new M(2,4),new M(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(To.of(new M(4,0),new M(3,1)))]}}function k6t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=v(),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.piecePlayerClass(r)),D("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function L6t(n,t){if(1&n&&(B(),X(0,"rect",9)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();D("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function R6t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"g",4),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),X(2,"rect",5),k(3,k6t,1,4,"circle",6),k(4,L6t,1,7,"rect",7),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),S(1),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),S(1),T("ngIf",e!==i.UNOCCUPIED),S(1),T("ngIf",e!==i.UNOCCUPIED)}}function D6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,R6t,5,9,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function z6t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"rect",10)(2,"rect",10),O()),2&n){const e=v();S(1),D("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),S(1),D("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function V6t(n,t){if(1&n&&(B(),X(0,"circle",11)),2&n){const e=v();D("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let H6t=(()=>{class n extends Eo{constructor(e){super(e),this.UNOCCUPIED=Hn.EMPTY,this.lastMove=P.empty(),this.lastPieceMove=P.empty(),this.chosen=P.empty(),this.chosenAutomatically=!1,this.hasAsymetricBoard=!0,this.rules=new wo(w3),this.availableMinimaxes=[new x6t(this.rules,"KamisadoMinimax")],this.encoder=To.encoder,this.tutorial=(new Zce).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return v2.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===z.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=P.empty(),this.lastMove.isPresent()){const s=this.lastMove.get();s.isPieceMove()&&(this.lastPieceMove=P.of(s))}this.canPass=wo.mustPass(e);const r=this.rules.getGameStatus(this.rules.node)!==Ie.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=P.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return A(function*(){return ye(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(To.PASS,e.getState())})()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(s.canPass)return s.cancelMove(gt.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),U.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(km.PLAY_WITH_SELECTED_PIECE()):(s.chosen=P.of(o),U.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=P.of(new M(e,r)),U.SUCCESS)}chooseDestination(e,r){var s=this;return A(function*(){const i=s.chosen.get(),o=new M(e,r),c=To.of(i,o);return s.chooseMove(c,s.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=P.empty())}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,D6t,2,1,"g",1),k(2,z6t,3,8,"g",2),k(3,V6t,1,3,"circle",3),O()),2&e&&(D("viewBox",r.getViewBox())("transform",r.rotation),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.lastPieceMove.isPresent()),S(1),T("ngIf",r.chosen.isPresent()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),js=(()=>{class n extends ws{static getInitialState(){const e=de.NONE,r=de.ZERO,s=de.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class z2 extends $0{constructor(t,e,r){super(t,e),this.direction=r,this.direction=be.factory.fromMove(t,e).get()}static from(t,e){const r=be.factory.fromMove(t,e);return r.isFailure()?G.failure(r.getReason()):t.isNotInRange(js.SIZE,js.SIZE)?G.failure("start coord is not in range"):e.isNotInRange(js.SIZE,js.SIZE)?G.failure("end coord is not in range"):G.success(new z2(t,e,r.get()))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}encode(){return z2.encoder.encode(this)}decode(t){return z2.encoder.decode(t)}}z2.encoder=P4.getEncoder(z2.from);let vH=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class qi extends tr{static getListMovesFromState(t){const e=[];if(qi.getVictory(t).isPresent())return e;for(let r=0;r<js.SIZE;r++)for(let s=0;s<js.SIZE;s++){const i=new M(s,r);if(t.getPieceAt(i).isPlayer())for(const c of qi.possibleTargets(t,i)){const u=z2.from(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=Ye.createTable(js.SIZE,js.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<js.SIZE;i++)for(let o=0;o<js.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new M(o,i));c.isPlayer()&&(s+=1,qi.markGroupStartingAt(t,e,new M(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=we.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const h of be.DIRECTIONS){const g=c.getNext(h);t.isOnBoard(g)&&i.push(g)}}else u===de.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.getStart().y][t.getStart().x]=de.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new js(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?G.failure(gt.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?G.failure(vH.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?G.failure(vH.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?G.failure(gt.CANNOT_SELF_CAPTURE()):G.success(void 0)}isLegal(t,e){return qi.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of qi.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=qi.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;js.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case be.UP:case be.DOWN:return[new M(t.x,0),be.DOWN];case be.LEFT:case be.RIGHT:return[new M(0,t.y),be.RIGHT];case be.UP_RIGHT:case be.DOWN_LEFT:return[new M(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),be.UP_RIGHT];default:return we.expectToBeMultiple(e,[be.UP_LEFT,be.DOWN_RIGHT]),[new M(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),be.DOWN_RIGHT]}}static getVictory(t){const[e,r]=qi.getNumberOfGroups(t);return 1===e&&1===r?P.of(de.NONE):1===e?P.of(z.ZERO):1===r?P.of(z.ONE):P.empty()}static possibleTargets(t,e){const r=[];for(const s of be.DIRECTIONS){const i=qi.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=z2.from(e,o).get();qi.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=qi.getNumberOfGroups(e);return 1===r&&s>1?Ie.ZERO_WON:r>1&&1===s?Ie.ONE_WON:Ie.ONGOING}}class F6t extends q1{getListMoves(t){return qi.getListMovesFromState(t.gameState)}getBoardValue(t){const e=t.gameState,[r,s]=qi.getNumberOfGroups(e);return new st(1===r&&s>1?z.ZERO.getVictoryValue():r>1&&1===s?z.ONE.getVictoryValue():100/r*z.ZERO.getScoreModifier()+100/s*z.ONE.getScoreModifier())}}const j=de.NONE,ur=de.ZERO,sr=de.ONE;class Yce{constructor(){this.tutorial=[fe.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new js([[j,j,j,j,j,j,j,j],[sr,j,j,j,ur,j,j,sr],[j,j,ur,ur,sr,j,j,j],[j,j,j,ur,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j]],0)),fe.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,js.getInitialState(),z2.from(new M(1,7),new M(1,5)).get(),$localize`Congratulations!`),fe.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new js([[j,j,j,j,j,j,j,j],[j,j,sr,ur,ur,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,sr],[j,j,j,j,j,j,j,ur]],0),[z2.from(new M(3,1),new M(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),fe.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new js([[j,j,j,j,j,j,sr,j],[j,j,j,j,j,ur,j,j],[j,j,j,j,sr,j,j,j],[j,j,j,ur,j,j,j,j],[j,j,j,j,j,j,j,sr],[j,j,j,j,j,sr,j,sr],[j,j,j,ur,j,j,sr,sr],[j,j,j,ur,j,j,j,j]],0),[z2.from(new M(3,3),new M(3,0)).get(),z2.from(new M(3,3),new M(0,0)).get(),z2.from(new M(3,3),new M(2,3)).get(),z2.from(new M(3,3),new M(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),fe.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new js([[j,ur,j,ur,ur,ur,ur,j],[sr,j,j,j,j,j,j,sr],[j,j,ur,j,sr,j,j,j],[sr,j,j,j,j,j,j,sr],[sr,j,j,j,j,j,j,sr],[sr,j,j,j,j,j,j,sr],[sr,j,j,j,j,j,j,sr],[j,ur,ur,ur,ur,ur,ur,j]],0),z2.from(new M(2,2),new M(4,2)).get(),(t,e,r)=>e.getPieceAt(t.getEnd())===de.ONE?U.SUCCESS:U.failure($localize`Failed. Try again.`),$localize`Congratulations!`),fe.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new js([[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[ur,j,j,ur,sr,ur,j,j],[j,j,j,ur,j,j,j,sr],[j,j,j,j,j,j,j,sr],[j,j,j,j,j,j,j,sr],[j,j,j,j,j,j,j,sr],[j,j,j,j,j,j,j,j]],0),[z2.from(new M(0,2),new M(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function B6t(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=v().index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function $6t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"g",3),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),X(2,"rect",4),k(3,B6t,1,6,"circle",5),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),S(1),T("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function U6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,$6t,4,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function G6t(n,t){if(1&n){const e=Te();B(),b(0,"rect",7),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.x,i.y))}),O()}if(2&n){const e=t.$implicit,r=v();D("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let W6t=(()=>{class n extends Eo{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=de.NONE,this.targets=[],this.selected=P.empty(),this.lastMove=P.empty(),this.captured=P.empty(),this.rules=new qi(js),this.availableMinimaxes=[new F6t(this.rules,"LinesOfActionMinimax")],this.encoder=z2.encoder,this.tutorial=(new Yce).tutorial,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),U.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return A(function*(){const s=z2.from(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get(),r.rules.node.gameState):r.cancelMove(s.getReason())})()}select(e){var r=this;return A(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=P.of(e),r.targets=qi.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(vH.PIECE_CANNOT_MOVE()):U.SUCCESS)})()}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.getEnd()).isPlayer()?P.of(e.getEnd()):P.empty()}}cancelMoveAttempt(){this.selected=P.empty(),this.targets=[]}getSquareClasses(e,r){const s=new M(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new M(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,U6t,2,1,"g",1),k(2,G6t,1,4,"rect",2),O()),2&e&&(S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.targets))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class O4 extends m3{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}O4.encoder=new class extends Gi{encodeMove(n){return{coord:M.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decodeMove(n){const t=n;return ye(null!=t.coord,"Invalid encoded LodestoneMove"),ye(null!=t.direction,"Invalid encoded LodestoneMove"),ye(null!=t.orientation,"Invalid encoded LodestoneMove"),ye(null!=t.captures,"Invalid encoded LodestoneMove"),new O4(M.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};let m9=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class ji{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}ji.UNREACHABLE=new ji(!0),ji.EMPTY=new ji(!1);class Nc{constructor(t){this.owner=t}static of(t){return t===z.ZERO?Nc.ZERO:Nc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Nc.ZERO=new Nc(z.ZERO),Nc.ONE=new Nc(z.ONE);class bo{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return bo.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}bo.LODESTONES={0:{push:{diagonal:new bo(z.ZERO,"push","diagonal"),orthogonal:new bo(z.ZERO,"push","orthogonal")},pull:{diagonal:new bo(z.ZERO,"pull","diagonal"),orthogonal:new bo(z.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new bo(z.ONE,"push","diagonal"),orthogonal:new bo(z.ONE,"push","orthogonal")},pull:{diagonal:new bo(z.ONE,"pull","diagonal"),orthogonal:new bo(z.ONE,"pull","orthogonal")}}};class _r{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?_r.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(ye(this.pieces.length+e===3,"should never put more pieces than the plate can support"),P.empty());{const r=Ye.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(Nc.of(t));return P.of(new _r(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:ji.EMPTY}}_r.POSITIONS=["top","bottom","left","right"],_r.EMPTY_5=new _r(5,[]),_r.EMPTY_3=new _r(3,[]);let ir=(()=>{class n extends ws{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=ji.EMPTY,r=Nc.ZERO,s=Nc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new zn,{top:P.of(_r.EMPTY_5),bottom:P.of(_r.EMPTY_5),left:P.of(_r.EMPTY_5),right:P.of(_r.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of _r.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return P.empty();{const s=this.getPieceAt(r.get());switch(ye(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return P.of("pull");case"pull":return P.of("push")}}}}return n.SIZE=8,n})();class Ti extends tr{constructor(){super(ir)}static get(){return Ti.singleton.isAbsent()&&(Ti.singleton=P.of(new Ti)),Ti.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=Ye.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new ir(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of _r.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=Ti.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(ir.SIZE,ir.SIZE);i=i.getNext(r)){for(const o of z.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=ji.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return G.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return G.failure(m9.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of _r.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return G.failure(m9.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return G.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=Ye.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=ji.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=bo.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const g of h)for(let m=r.getNext(g);t.isOnBoard(m);m=m.getNext(g)){const C=e[m.y][m.x],w=m.getNext(g);if(t.isOnBoard(w)){const I=e[w.y][w.x];I.isPlayerPiece()&&I.owner===i&&(C.isEmpty()?(u.push(m),e[m.y][m.x]=I,u.push(w),e[w.y][w.x]=ji.EMPTY):C.isPlayerPiece()&&C.owner===o&&(c.push(m),e[m.y][m.x]=I,u.push(w),e[w.y][w.x]=ji.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const g of h)for(let C=r.getNext(g,ir.SIZE);!1===C.equals(r);C=C.getPrevious(g))if(t.isOnBoard(C)){const w=e[C.y][C.x];if(w.isPlayerPiece()&&w.owner===o){const I=C.getNext(g);if(t.isOnBoard(I)){const H=e[I.y][I.x];H.isUnreachable()?(c.push(C),e[C.y][C.x]=ji.EMPTY):H.isEmpty()&&(u.push(I),e[I.y][I.x]=w,u.push(C),e[C.y][C.x]=ji.EMPTY)}else c.push(C),e[C.y][C.x]=ji.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?U.failure(m9.MUST_FLIP_LODESTONE()):U.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return U.failure(m9.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return U.failure(gt.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?U.failure(gt.MUST_CLICK_ON_EMPTY_SQUARE()):U.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?Ie.DRAW:0===r[0]?Ie.ONE_WON:0===r[1]?Ie.ZERO_WON:Ie.ONGOING}}Ti.THREATENED_COORD_RANGE=zn.from({top:{startForBigPlate:new M(0,0),startForSmallPlate:new M(0,1),direction:be.RIGHT},bottom:{startForBigPlate:new M(0,ir.SIZE-1),startForSmallPlate:new M(0,ir.SIZE-2),direction:be.RIGHT},left:{startForBigPlate:new M(0,0),startForSmallPlate:new M(1,0),direction:be.DOWN},right:{startForBigPlate:new M(ir.SIZE-1,0),startForSmallPlate:new M(ir.SIZE-2,0),direction:be.DOWN}}),Ti.singleton=P.empty();class q6t extends q1{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const g=Ti.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,g))s.push(new O4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new $t([{top:0,bottom:0,left:0,right:0}]);{const r=new $t,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<ir.SIZE;s++)for(let i=0;i<ir.SIZE;i++){const o=new M(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?z.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?z.ONE.getVictoryValue():e[0]*z.ZERO.getScoreModifier()+e[1]*z.ONE.getScoreModifier(),new st(r)}}const Ue=ji.UNREACHABLE,ce=ji.EMPTY,fs=Nc.ZERO,Zi=Nc.ONE,Rm=bo.of(z.ONE,{direction:"push",orientation:"orthogonal"}),CH={top:P.of(_r.EMPTY_5),bottom:P.of(_r.EMPTY_5),left:P.of(_r.EMPTY_5),right:P.of(_r.EMPTY_5)};class Kce extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,ir.getInitialState()),fe.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,ir.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),fe.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,ir.getInitialState()),fe.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,ir.getInitialState()),fe.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,ir.getInitialState()),fe.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,ir.getInitialState(),new O4(new M(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?U.failure($localize`You have not captured any of the opponent's pieces, try again!`):U.SUCCESS,$localize`Congratulations!`),fe.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new ir([[ce,ce,ce,ce,Zi,ce,ce,ce],[ce,ce,fs,ce,ce,Zi,ce,ce],[ce,ce,Rm,ce,ce,ce,ce,fs],[ce,ce,ce,ce,Zi,ce,ce,fs],[ce,ce,ce,ce,ce,fs,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce]],0,new zn([{key:z.ONE,value:new M(2,2)}]),{...CH,top:_r.EMPTY_5.addCaptured(z.ONE,4)}),new O4(new M(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?U.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):U.SUCCESS,$localize`Congratulations!`),fe.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new ir([[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue],[ce,ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,fs],[ce,ce,ce,ce,ce,fs,ce,fs],[ce,Rm,ce,ce,Zi,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,Zi,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce]],0,new zn([{key:z.ONE,value:new M(1,4)}]),{...CH,top:_r.EMPTY_3.addCaptured(z.ONE,2)}),new O4(new M(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?U.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):U.SUCCESS,$localize`Congratulations!`),fe.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new ir([[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue],[Ue,Ue,fs,Zi,ce,ce,Ue,Ue],[Ue,Ue,Rm,Zi,ce,ce,Ue,Ue],[Ue,Ue,ce,fs,fs,ce,Ue,Ue],[Ue,Ue,fs,ce,ce,ce,Ue,Ue],[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue]],0,new zn([{key:z.ONE,value:new M(2,3)}]),{top:P.empty(),bottom:P.empty(),left:P.empty(),right:P.empty()})),fe.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new ir([[ce,ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,Zi,ce,ce],[ce,ce,ce,Rm,ce,ce,fs,ce],[ce,ce,fs,fs,Zi,ce,ce,fs],[ce,ce,ce,ce,ce,fs,ce,ce],[ce,ce,fs,ce,ce,ce,ce,ce],[ce,ce,Zi,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce]],0,new zn([{key:z.ONE,value:new M(3,2)}]),{...CH,top:_r.EMPTY_5.addCaptured(z.ONE,4)}),[new O4(new M(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),fe.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new ir([[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue],[Ue,Zi,fs,Zi,ce,ce,Ue,Ue],[Ue,Zi,Rm,ce,Zi,ce,Ue,Ue],[Ue,ce,ce,fs,fs,ce,Ue,Ue],[Ue,Zi,fs,ce,Zi,ce,Ue,Ue],[Ue,ce,ce,ce,fs,ce,Ue,Ue],[Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue]],0,new zn([{key:z.ONE,value:new M(2,3)}]),{top:P.empty(),bottom:_r.EMPTY_3.addCaptured(z.ZERO,2),left:P.of(_r.EMPTY_3),right:P.empty()}),[new O4(new M(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}function j6t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Z6t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=v().$implicit,r=v(3).$implicit,s=v(2);J8("transform","rotate(",90*e,")"),T("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_OUT)}}function Y6t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=v().$implicit,r=v(3).$implicit,s=v(2);J8("transform","rotate(",90*e,")"),T("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_IN)}}function K6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,Z6t,1,3,"polygon",14),k(2,Y6t,1,3,"polygon",14),O()),2&n){const e=v(3).$implicit;S(1),T("ngIf","push"===e.lodestone.direction),S(1),T("ngIf","pull"===e.lodestone.direction)}}const Xce=function(){return[0,1,2,3]};function X6t(n,t){if(1&n&&(B(),b(0,"g",11),X(1,"circle",12)(2,"circle",13),b(3,"g"),k(4,K6t,3,2,"g",1),O()()),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();D("transform",o.getSquareTransform(r,i)),S(1),T("ngClass",s.lodestone.selectedClass),D("r",o.PIECE_RADIUS),S(1),T("ngClass",s.lodestone.pieceClasses),D("r",o.PIECE_RADIUS/4),S(1),J8("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),S(1),T("ngForOf",J1(7,Xce))}}function Q6t(n,t){if(1&n){const e=Te();B(),b(0,"g",6),J("click",function(){ue(e);const s=v().$implicit;return oe(v(2).selectCoord(s.coord))}),X(1,"rect",7),k(2,j6t,1,6,"circle",8),k(3,X6t,5,8,"g",9),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","square_",r,"_",i,""),S(1),T("ngClass",s.squareClasses),D("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),S(1),T("ngIf",s.hasPiece),S(1),T("ngIf",s.lodestone)}}function J6t(n,t){if(1&n&&(B(),b(0,"g"),k(1,Q6t,4,9,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",!1===e.crumbled)}}function e0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,J6t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function t0t(n,t){if(1&n&&(B(),b(0,"g",16),X(1,"circle",17),O()),2&n){const e=t.$implicit,r=t.index,s=v();S1("id","capture_",r,""),D("transform",s.getCaptureTransform(r)),S(1),T("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS)}}function n0t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polygon",15),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v();S(1),J8("transform","rotate(",90*e,")"),T("ngClass",r.movingClass),D("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function r0t(n,t){if(1&n){const e=Te();B(),b(0,"g",6),J("click",function(){const i=ue(e).$implicit;return oe(v().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),b(3,"g"),k(4,n0t,2,3,"g",1),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v();We("id","lodestone_",e.direction,"_",e.orientation,""),D("transform",s.getAvailableLodestoneTransform(r)),S(1),T("ngClass",e.selectedClass),D("r",s.PIECE_RADIUS),S(1),T("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS/4),S(1),J8("transform","rotate(","diagonal"===e.orientation?45:0,")"),S(1),T("ngForOf",J1(9,Xce))}}function s0t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().$implicit,o=v();We("id","platePiece_",i.position,"_",r,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function i0t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"g",6),J("click",function(){const s=ue(e),i=s.$implicit,o=s.index,c=v().$implicit;return oe(v().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),k(3,s0t,1,6,"circle",8),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().$implicit,i=v();D("transform",i.getPressurePlateTransform(s.position)),S(1),We("id","plate_",s.position,"_",r,""),S(1),We("id","plateSquare_",s.position,"_",r,""),T("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.hasPiece)}}function o0t(n,t){if(1&n&&(B(),b(0,"g",16),k(1,i0t,4,11,"g",1),O()),2&n){const e=t.$implicit;S1("id","pressurePlate_",e.position,""),S(1),T("ngForOf",e.coords)}}function a0t(n,t){if(1&n&&(B(),X(0,"rect",19)),2&n){const e=v();We("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),D("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class wi extends H0{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:P.empty(),pressurePlateShift:{top:new ln(0,0),left:new ln(0,0),right:new ln(0,0),bottom:new ln(0,0)}},this.stateAfterPlacingLodestone=P.empty(),this.lastInfos=P.empty(),this.capturesToPlace=0,this.selectedCoord=P.empty(),this.selectedLodestone=P.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=Ti.get(),this.tutorial=(new Kce).tutorial,this.availableMinimaxes=[new q6t(this.rules,"LodestoneDummyMinimax")],this.encoder=O4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=P.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return A(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove(m9.MUST_PLACE_CAPTURES());const s=Ti.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),U.SUCCESS):(e.selectedCoord=P.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),U.SUCCESS))})()}selectLodestone(t){var e=this;return A(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());ye(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=bo.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),U.SUCCESS):(e.selectedLodestone=P.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),U.SUCCESS))})()}putLodestone(){var t=this;return A(function*(){ye(t.selectedCoord.isPresent(),"coord should have been selected"),ye(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();ye(Ti.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=Ti.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=P.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=P.of(t.displayedState),t.updateViewInfo(),U.SUCCESS)})()}applyMove(){var t=this;return A(function*(){ye(t.selectedCoord.isPresent(),"coord should have been selected"),ye(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new O4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s,t.getState())})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(m9.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Ye.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return Ti.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new ir(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),U.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Ye.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return Ti.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new ir(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),U.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=P.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=P.empty(),this.lastInfos=P.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=Ye.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=ji.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=P.empty(),this.selectedLodestone=P.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<ir.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<ir.SIZE;e++){const r=new M(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:P.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=bo.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of _r.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=wi.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(){const t=this.rules.node.mother.get().gameState,e=this.rules.node.move.get();this.lastInfos=P.of(Ti.get().applyMoveWithoutPlacingCaptures(t,e.coord,e)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(t,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of _r.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=we.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),g=o.getPieceAt(u);!1===h.equals(g)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new M(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new M(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new M(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new M(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(ir.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(ir.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}wi.PRESSURE_PLATE_EXTRA_SHIFT=.2,wi.PRESSURE_PLATES_POSITIONS=zn.from({top:{startForBigPlate:new M(.5,-1-wi.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new M(1.5,0-wi.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},bottom:{startForBigPlate:new M(.5,8+wi.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new M(1.5,7+wi.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},left:{startForBigPlate:new M(-1-wi.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new M(0-wi.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN},right:{startForBigPlate:new M(8+wi.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new M(7+wi.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN}}),wi.\u0275fac=function(t){return new(t||wi)(Q(Nn))},wi.\u0275cmp=mt({type:wi,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(B(),b(0,"svg",0),k(1,e0t,2,1,"g",1),k(2,t0t,2,4,"g",2),k(3,r0t,5,10,"g",3),k(4,o0t,2,2,"g",2),k(5,a0t,1,6,"rect",4),O()),2&t&&(S(1),T("ngForOf",e.viewInfo.boardInfo),S(1),T("ngForOf",e.viewInfo.capturesToPlace),S(1),T("ngForOf",e.viewInfo.availableLodestones),S(1),T("ngForOf",e.viewInfo.pressurePlates),S(1),T("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let NP=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class hs extends $0{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return G.failure(NP.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return G.failure(NP.END_COORD_OUT_OF_RANGE());if(e.equals(t))return G.failure(gt.MOVE_CANNOT_BE_STATIC());const s=be.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?G.failure(s.getReason()):G.success(new hs(t,e,r))}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==this.getStart().equals(t.getStart())&&!1!==this.getEnd().equals(t.getEnd())&&this.calledTheClock===t.calledTheClock}isValidForPawn(){const t=Math.abs(this.getStart().x-this.getEnd().x),e=Math.abs(this.getStart().y-this.getEnd().y);return 1===t&&1===e}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}hs.encoder=_n.tuple([M.numberEncoder(4,8),M.numberEncoder(4,8),_n.booleanEncoder],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>hs.from(n[0],n[1],n[2]).get());class Rt{constructor(t){this.value=t}static tryMerge(t,e){ye(t!==Rt.EMPTY&&e!==Rt.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?P.of(Rt.from(s)):P.empty()}static from(t){return t===Rt.DRONE.value?Rt.DRONE:(we.expectToBe(t,Rt.QUEEN.value),Rt.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}Rt.EMPTY=new Rt(0),Rt.PAWN=new Rt(1),Rt.DRONE=new Rt(2),Rt.QUEEN=new Rt(3);class c0t extends q1{constructor(t,e){super(t,e),this.ruler=t}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case Rt.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case Rt.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case Rt.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new M(e,r),i=[];for(const o of be.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(Rt.DRONE),c=!1===t.isTherePieceOnPlayerSide(Rt.QUEEN),u=t.lastMove;for(const h of r){const g=t.getPieceAt(h);if(g===Rt.EMPTY)this.add(s,hs.from(e,h).get(),u);else if(t.isInPlayerTerritory(h)){const m=Rt.tryMerge(g,i);if(m.isPresent()){const C=m.get(),w=hs.from(e,h).get();(C===Rt.DRONE&&o||C===Rt.QUEEN&&c)&&this.add(s,w,u)}}else this.add(s,hs.from(e,h).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new M(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of be.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Rt.EMPTY);for(;h;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Rt.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new M(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getBoardValue(t){const e=this.ruler.getGameStatus(t);let r;if(e.isEndGame)r=e.toBoardValue();else{const s=t.gameState.getScoreOf(z.ZERO);r=t.gameState.getScoreOf(z.ONE)-s}return new st(r)}}class h5{constructor(t){this.captures=t,t.makeImmutable()}static from(t){const e=new zn;for(const r of t)h5.addToMap(e,r);return new h5(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return h5.addToMap(e,t),new h5(e)}}class Ns extends ws{constructor(t,e,r=P.empty(),s=P.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new zn([{key:z.ZERO,value:h5.from([])},{key:z.ONE,value:h5.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=Rt.EMPTY,e=Rt.PAWN,r=Rt.DRONE,s=Rt.QUEEN;return new Ns([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,P.empty())}getPlayerTerritory(t){return t===z.ZERO?Ns.PLAYER_ZERO_TERRITORY:Ns.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(z.ZERO)?P.of(z.ZERO):this.isTerritoryEmpty(z.ONE)?P.of(z.ONE):P.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Rt.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(Rt.PAWN).getOrElse(0),e.captures.get(Rt.DRONE).getOrElse(0),e.captures.get(Rt.QUEEN).getOrElse(0)]}}Ns.PLAYER_ZERO_TERRITORY=new $t([4,5,6,7]),Ns.PLAYER_ONE_TERRITORY=new $t([0,1,2,3]);let AP=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class _9 extends tr{applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.getStart().y][t.getStart().x]=Rt.EMPTY;const i=r.finalPiece;s[t.getEnd().y][t.getEnd().x]=i;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=_9.STARTING_COUNT_DOWN;else{const h=e.countDown.get();c=P.of(h-1)}return t.calledTheClock&&(c=_9.STARTING_COUNT_DOWN),new Ns(s,e.turn+1,P.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return G.failure(r.getReason());if(t.isUndoneBy(e.lastMove))return G.failure(AP.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.getStart()),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const h=e.getPieceAt(t.getEnd());u=u.add(h),i.replace(c,u),i.makeImmutable()}return G.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){ye(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Rt.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Rt.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return G.failure(AP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return G.failure(AP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return G.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return G.failure(AP.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.getStart());if(s===Rt.EMPTY)return G.failure(gt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Rt.PAWN)return t.isValidForPawn()?G.success(void 0):G.failure(NP.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Rt.DRONE&&!1===t.isValidForDrone())return G.failure(NP.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.getStart().getUntil(t.getEnd()))if(e.getPieceAt(i)!==Rt.EMPTY)return G.failure(gt.SOMETHING_IN_THE_WAY());return G.success(void 0)}getPromotedPiece(t,e){const r=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd());return Rt.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,Ie.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=Ie.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return Ie.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(z.ZERO),s=t.getScoreOf(z.ONE);return r>s?Ie.ZERO_WON:s>r?Ie.ONE_WON:e}}_9.STARTING_COUNT_DOWN=P.of(7);let Qce=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const ie=Rt.EMPTY,bi=Rt.PAWN,Ql=Rt.DRONE,Y0=Rt.QUEEN,Jce=()=>$localize`This is not a field promotion!`;class e3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ns.getInitialState()),fe.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ns.getInitialState()),fe.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ns.getInitialState(),hs.from(new M(2,5),new M(1,4)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Rt.PAWN?U.SUCCESS:U.failure($localize`This is not a pawn!`),$localize`Congratulations!`),fe.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ns.getInitialState(),hs.from(new M(1,7),new M(0,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Rt.DRONE?U.SUCCESS:U.failure($localize`This is not a drone!`),$localize`Congratulations!`),fe.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new Ns([[Ql,bi,ie,ie],[Y0,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,Y0,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[Y0,Ql,bi,ie]],1),hs.from(new M(2,3),new M(2,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Rt.QUEEN?U.SUCCESS:U.failure($localize`This is not a queen!`),$localize`Congratulations!`),fe.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new Ns([[Ql,bi,bi,ie],[ie,ie,ie,ie],[Y0,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,bi,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,Ql,bi,ie]],1),[hs.from(new M(0,2),new M(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,Qce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),fe.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new Ns([[ie,ie,ie,Y0],[ie,bi,ie,ie],[ie,ie,bi,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,Y0],[ie,ie,Ql,ie],[ie,bi,ie,ie]],1),[hs.from(new M(1,1),new M(2,2)).get(),hs.from(new M(2,2),new M(1,1)).get()],$localize`Congratulations!`,Jce()),fe.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new Ns([[bi,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,Ql,ie],[ie,bi,ie,ie]],0),hs.from(new M(1,7),new M(2,6)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Rt.QUEEN?U.SUCCESS:U.failure(Jce()),$localize`Congratulations!`),fe.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ns.getInitialState(),hs.from(new M(1,5),new M(0,4),!0).get(),(t,e,r)=>t.calledTheClock?U.SUCCESS:U.failure($localize`You did not call the clock!`),$localize`Congratulations!`),fe.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new Ns([[ie,ie,ie,ie],[ie,bi,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,bi],[ie,ie,Ql,ie],[ie,bi,ie,ie]],15,P.empty(),P.of(1)),[hs.from(new M(1,1),new M(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),fe.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new Ns([[ie,ie,ie,Y0],[ie,bi,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[Ql,ie,ie,ie],[ie,ie,ie,ie],[ie,Ql,ie,ie]],15,P.empty(),P.of(1)),hs.from(new M(1,1),new M(2,2)).get(),$localize`Congratulations!`),fe.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new Ns([[ie,ie,ie,Y0],[ie,bi,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,bi,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie]],0),hs.from(new M(2,4),new M(1,3)).get(),(t,e,r)=>3===t.getEnd().y?U.SUCCESS:U.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}function l0t(n,t){if(1&n&&(B(),X(0,"g",19)),2&n){const e=v(2).index,r=v().index,s=v();ci(s.style),We("mainShapeId","pawn_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function u0t(n,t){if(1&n&&(B(),X(0,"g",20)),2&n){const e=v(2).index,r=v().index,s=v();ci(s.style),We("mainShapeId","drone_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function f0t(n,t){if(1&n&&(B(),X(0,"g",21)),2&n){const e=v(2).index,r=v().index,s=v();ci(s.style),We("mainShapeId","queen_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function h0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,l0t,1,5,"g",16),k(2,u0t,1,5,"g",17),k(3,f0t,1,5,"g",18),O()),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();D("transform",o.getPieceLocation(r,i)),S(1),T("ngIf",s===o.pieces.PAWN),S(1),T("ngIf",s===o.pieces.DRONE),S(1),T("ngIf",s===o.pieces.QUEEN)}}function d0t(n,t){if(1&n){const e=Te();B(),b(0,"g",14),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),X(1,"rect",15),k(2,h0t,4,4,"g",13),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();We("id","click_",r,"_",s,""),D("transform",i.getPieceTranslation(s)),S(1),We("id","square_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.pieces.EMPTY)}}function p0t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",22),J("click",function(){const i=ue(e).$implicit;return oe(v(3).onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v(3);S(1),We("id","indicator_",e.x,"_",e.y,""),D("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function g0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,p0t,2,7,"g",1),O()),2&n){const e=v(2);S(1),T("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function m0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,d0t,3,11,"g",12),k(2,g0t,2,1,"g",13),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",e),S(1),T("ngIf",r.selectedPieceInfo.isPresent())}}function _0t(n,t){if(1&n&&(B(),b(0,"text",23),St(1),O()),2&n){const e=v();T("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),D("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),S(1),a1(e.countDown.get())}}function v0t(n,t){if(1&n&&(B(),X(0,"polyline",24)),2&n){const e=v();T("ngClass",e.getClockCircleClasses()),D("points",e.clockNeedlesPoints)}}const IP=function(n){return[n]};function C0t(n,t){if(1&n){const e=Te();B(),an(0),b(1,"g",27),J("click",function(){const i=ue(e).index;return oe(v(2).chooseStyle(i))}),O(),cn()}if(2&n){const e=t.$implicit,r=t.index,s=v(2);S(1),ci(e.style),T("id",e.name)("pieceClasses",c3(5,IP,"player"+s.getCurrentPlayer().value+"-fill")),D("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function y0t(n,t){if(1&n&&(B(),b(0,"g",25),X(1,"rect",26),k(2,C0t,2,7,"ng-container",1),O()),2&n){const e=v();S(1),D("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),S(1),T("ngForOf",e.listOfStyles)}}function E0t(n,t){if(1&n&&(B(),b(0,"text",33),St(1),O()),2&n){const e=v(2).$implicit,r=v().$implicit,s=v();T("ngClass",s.getPlayerClass(r)),D("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),S(1),a1(e+" x ")}}function M0t(n,t){if(1&n&&(B(),X(0,"g",34)),2&n){const e=v(3).$implicit,r=v();ci(r.style),T("pieceClasses",c3(3,IP,r.getPlayerClass(e)))}}function S0t(n,t){if(1&n&&(B(),X(0,"g",35)),2&n){const e=v(3).$implicit,r=v();ci(r.style),T("pieceClasses",c3(3,IP,r.getPlayerClass(e)))}}function P0t(n,t){if(1&n&&(B(),X(0,"g",36)),2&n){const e=v(3).$implicit,r=v();ci(r.style),T("pieceClasses",c3(3,IP,r.getPlayerClass(e)))}}function T0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,E0t,2,4,"text",29),b(2,"g",28),k(3,M0t,1,5,"g",30),k(4,S0t,1,5,"g",31),k(5,P0t,1,5,"g",32),O()()),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().$implicit,o=v();D("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),S(1),T("ngIf",s>1),S(1),We("id","piece_",r,"_player_",i.value,""),D("transform","translate("+o.SPACE_SIZE+", 0)"),S(1),T("ngIf",0===r),S(1),T("ngIf",1===r),S(1),T("ngIf",2===r)}}function w0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,T0t,6,8,"g",13),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e>0)}}function b0t(n,t){if(1&n&&(B(),b(0,"g")(1,"g",28),k(2,w0t,2,1,"g",1),O()()),2&n){const e=t.$implicit,r=v();S(1),S1("id","capture_of_player_",e.value,""),D("transform",r.getCapturesTransformation(e)),S(1),T("ngForOf",r.state.getCapturesOf(e))}}let Oo=(()=>{class n extends Eo{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Rt,this.selectedPieceInfo=P.empty(),this.countDown=P.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymetricBoard=!0,this.rules=new _9(Ns),this.availableMinimaxes=[new c0t(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=hs.encoder,this.tutorial=(new e3e).tutorial,this.scores=P.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const h=(c*(360/e)+r)/180*Math.PI,g=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*g*Math.cos(h),C=o+.8*g*Math.sin(h);s.push(new M(m,C))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const h=(c*(360/e)-90)/180*Math.PI,g=.5*n.SPACE_SIZE,m=i+.8*g*Math.cos(h),C=o+.8*g*Math.sin(h)+r;s.push(new M(m,C))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(z.ZERO),r=this.state.getScoreOf(z.ONE);this.countDown=this.state.countDown,this.scores=P.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new M(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().getEnd().equals(s)&&this.rules.node.mother.get().gameState.getPieceAt(s)!==Rt.EMPTY&&this.getState().isInOpponentTerritory(new M(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return A(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return A(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),U.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return A(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=P.of({selectedPiece:e,legalLandings:s}),U.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===Rt.PAWN?be.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===Rt.DRONE?2:8),s.filter(i=>{const o=hs.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return be.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Rt.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return A(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),U.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=hs.from(s.selectedPiece,e,r.callTheClock);ye(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const o=r.getState();return r.chooseMove(i.get(),o)}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=hs.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get(),r.getState()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==Rt.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=P.empty(),this.callTheClock=!1}onClockClick(){var e=this;return A(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),U.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===z.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new M(e,r),i=["base"];if(this.rules.node.move.isPresent()){const o=this.rules.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Rt.EMPTY||o.gameState.isInOpponentTerritory(new M(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0,  "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g"),k(2,m0t,3,2,"g",1),O(),b(3,"g",2),J("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),k(6,_0t,2,5,"text",5),k(7,v0t,1,2,"polyline",6),O(),b(8,"g",7)(9,"g",8),J("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),O(),k(12,y0t,3,5,"g",10),O(),b(13,"g",11),k(14,b0t,3,3,"g",1),O()()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),S(1),D("transform",r.getBoardTransformation()),S(1),T("ngForOf",r.board),S(1),D("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),S(1),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngClass",r.getClockCircleClasses()),D("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),S(1),T("ngIf",r.countDown.isPresent()),S(1),T("ngIf",r.countDown.isAbsent()),S(1),D("transform",r.configViewTranslation),S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngClass",r.getPlayerClass(r.getCurrentPlayer())),D("transform",r.configCogTransformation),S(1),T("ngIf",r.displayModePanel),S(2),T("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Jl extends ws{static getInitialState(){const t=Ye.createTable(7,6,de.NONE);return new Jl(t,0)}}class I1 extends yi{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return I1.ZERO;case 1:return I1.ONE;case 2:return I1.TWO;case 3:return I1.THREE;case 4:return I1.FOUR;case 5:return I1.FIVE;case 6:return I1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}I1.ZERO=new I1(0),I1.ONE=new I1(1),I1.TWO=new I1(2),I1.THREE=new I1(3),I1.FOUR=new I1(4),I1.FIVE=new I1(5),I1.SIX=new I1(6),I1.encoder=new class extends _n{maxValue(){return 6}encodeNumber(n){return n.x}decodeNumber(n){return I1.of(n)}};let O0t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();class t3e{constructor(t,e,r){this.isInRange=t,this.getOwner=e,this.N=r}getSquareScore(t,e){const r=t.getPieceAt(e),s=this.getOwner(r);ye(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new zn,o=new zn;for(const u of be.DIRECTIONS){const h=this.getNumberOfFreeSpacesAndAllies(t,e,u,s);i.set(u,h[0]),o.set(u,h[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let r=0;for(const s of[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT]){if(t.get(s).get()+t.get(s.getOpposite()).get()+1>=this.N)return Number.MAX_SAFE_INTEGER;const g=e.get(s).get()+e.get(s.getOpposite()).get();g+1>=this.N&&(r+=2+g-this.N)}return r}getNumberOfFreeSpacesAndAllies(t,e,r,s){let i=0,o=0,c=!0,u=new M(e.x+r.x,e.y+r.y),h=1;const g=s.getOpponent();for(;this.isInRange(u)&&h<this.N;){const m=t.getPieceAt(u);if(this.getOwner(m)===g)return[i,o];this.getOwner(m)===s&&c?o++:c=!1,m!==g&&m!==s&&i++,u=u.getNext(r),h++}return[i,o]}}class Ar extends tr{static getOwner(t){return t}static isInRange(t){return t.isInRange(7,6)}static getVictoriousCoords(t){const e=[];for(let r=0;r<7;r++)for(let s=5;-1!==s&&t.board[s][r].isPlayer();s--){const i=Ar.getSquareScore(t,new M(r,s));(i===z.ZERO.getVictoryValue()||i===z.ONE.getVictoryValue())&&e.push(new M(r,s))}return e}static getBoardValueFromScratch(t){K(Ar.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let e=0;for(let r=0;r<7;r++)for(let s=5;-1!==s&&t.board[s][r].isPlayer();s--){const i=Ar.getSquareScore(t,new M(r,s));if(V1.getScoreStatus(i)!==vn.DEFAULT)return K(Ar.VERBOSE,{preVictoryOrVictory:{state:t,squareScore:i,coord:{x:r,y:s}}}),new st(i);e+=i}return new st(e)}static getLowestUnoccupiedSpace(t,e){let r=0;for(;r<6&&t[r][e]===de.NONE;)r++;return r-1}static getSquareScore(t,e){return K(Ar.VERBOSE,"getSquareScore(board, "+e.x+", "+e.y+") called"),K(Ar.VERBOSE,t.board),Ar.P4_HELPER.getSquareScore(t,e)}static getListMoves(t){K(Ar.VERBOSE,{context:"P4Rules.getListMoves",node:t});const e=t.gameState,r=[];for(let s=0;s<7;s++)if(e.getPieceAtXY(s,0)===de.NONE){const i=I1.of(s);r.push(i)}return r}static getBoardValue(t){return K(Ar.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),Ar.getBoardValueFromScratch(t)}applyLegalMove(t,e,r){const s=t.x,i=e.getCopiedBoard(),o=Ar.getLowestUnoccupiedSpace(i,s),c=e.turn;return i[o][s]=e.getCurrentPlayer(),new Jl(i,c+1)}isLegal(t,e){return K(Ar.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:e}),e.getPieceAtXY(t.x,0).isPlayer()?G.failure(O0t.COLUMN_IS_FULL()):G.success(void 0)}getGameStatus(t){const e=t.gameState;for(let r=0;r<7;r++)for(let s=5;s>=0&&e.board[s][r].isPlayer();s--){const i=Ar.getSquareScore(e,new M(r,s));if(V1.getScoreStatus(i)===vn.VICTORY)return Ie.getVictory(e.getCurrentOpponent())}return 42===e.turn?Ie.DRAW:Ie.ONGOING}}Ar.VERBOSE=!1,Ar.P4_HELPER=new t3e(Ar.isInRange,Ar.getOwner,4);class N0t extends q1{getListMoves(t){return Ar.getListMoves(t).sort((e,r)=>Math.abs(e.x-3)-Math.abs(r.x-3))}getBoardValue(t){const e=t.gameState;return K(Ar.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:e.getCopiedBoard()}),Ar.getBoardValue(e)}}const Ct=de.NONE,e6=de.ZERO,v9=de.ONE;class n3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Jl.getInitialState()),fe.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Jl.getInitialState(),I1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),fe.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new Jl([[Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,v9,Ct,Ct,Ct],[Ct,Ct,Ct,v9,Ct,Ct,Ct],[Ct,Ct,e6,e6,e6,v9,Ct]],0),[I1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),fe.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new Jl([[Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,e6,v9,Ct,Ct],[Ct,Ct,e6,e6,v9,Ct,Ct],[Ct,e6,v9,e6,e6,Ct,Ct]],0),[I1.of(3),I1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function A0t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getSquareFillClass(e,r)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function I0t(n,t){if(1&n){const e=Te();B(),b(0,"g",5),J("click",function(){const i=ue(e).index;return oe(v(2).onClick(i))}),X(1,"rect",6),k(2,A0t,1,4,"circle",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S1("id","click_",r,""),S(1),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function x0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,I0t,3,6,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function k0t(n,t){if(1&n&&(B(),X(0,"rect",9)),2&n){const e=v();D("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function L0t(n,t){if(1&n&&(B(),X(0,"rect",10)),2&n){const e=t.$implicit,r=v();We("id","victory_coord_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let R0t=(()=>{class n extends Eo{constructor(e){super(e),this.EMPTY=de.NONE,this.victoryCoords=[],this.rules=new Ar(Jl),this.availableMinimaxes=[new N0t(this.rules,"P4Minimax")],this.encoder=I1.encoder,this.tutorial=(new n3e).tutorial,this.updateBoard()}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=I1.of(e);return yield r.chooseMove(i,r.getState())})()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.victoryCoords=Ar.getVictoriousCoords(e),this.board=e.board,r.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.getState(),r=this.rules.node.move,s=Ar.getLowestUnoccupiedSpace(e.board,r.get().x)+1;this.last=P.of(new M(r.get().x,s))}hideLastMove(){this.last=P.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,x0t,2,1,"g",1),k(2,k0t,1,4,"rect",2),k(3,L0t,1,6,"rect",3),O()),2&e&&(S(1),T("ngForOf",r.board),S(1),T("ngIf",r.last.isPresent()),S(1),T("ngForOf",r.victoryCoords))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class As extends m3{constructor(t,e,r,s=!1){if(super(t,e),this.blockTurned=r,this.turnedClockwise=s,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,e,r,s){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new As(t,e,P.of(r),s)}static rotationless(t,e){return new As(t,e,P.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}As.encoder=new class extends Gi{encodeMove(n){const t={coord:M.encoder.encode(n.coord)};return n.blockTurned.isPresent()&&(t.blockTurned=n.blockTurned.get(),t.turnedClockwise=n.turnedClockwise),t}decodeMove(n){const t=n,e=M.encoder.decode(t.coord),r=P.ofNullable(t.blockTurned);if(r.isPresent()){const s=t.turnedClockwise;return As.withRotation(e.x,e.y,r.get(),s)}return As.rotationless(e.x,e.y)}};let r3e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class V2 extends ws{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=Ye.createTable(6,6,de.NONE);return new V2(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=V2.getBlockCenter(t),r=this.getPieceAt(e.getNext(be.UP,1)),s=this.getPieceAt(e.getNext(be.UP_LEFT,1));return this.getPieceAt(e.getNext(be.RIGHT,1))===r&&this.getPieceAt(e.getNext(be.DOWN,1))===r&&this.getPieceAt(e.getNext(be.LEFT,1))===r&&this.getPieceAt(e.getNext(be.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(be.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(be.DOWN_LEFT,1))===s}static getBlockCenter(t){return new M(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new V2(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const s=V2.getBlockCenter(t.blockTurned.get());if(t.turnedClockwise)for(const i of V2.ROTATION_MAP){const o=i[0].getNext(s),c=i[1].getNext(s),u=e.getPieceAt(o);r[c.y][c.x]=u}else for(const i of V2.ROTATION_MAP){const o=i[1].getNext(s),c=i[0].getNext(s),u=e.getPieceAt(o);r[c.y][c.x]=u}}return new V2(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}V2.ROTATION_MAP=[[new M(-1,-1),new M(1,-1)],[new M(0,-1),new M(1,0)],[new M(1,-1),new M(1,1)],[new M(1,0),new M(0,1)],[new M(1,1),new M(-1,1)],[new M(0,1),new M(-1,0)],[new M(-1,1),new M(-1,-1)],[new M(-1,0),new M(0,-1)]];class b3 extends tr{static get(){return b3.singleton.isAbsent()&&(b3.singleton=P.of(new b3(V2))),b3.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return G.failure(gt.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return G.failure(r3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return G.failure(r3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return G.success(void 0)}getVictoryCoords(t){let e=[];for(const r of b3.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?Ie.DRAW:Ie.ZERO_WON:!0===s[1]?Ie.ONE_WON:36===e.turn?Ie.DRAW:Ie.ONGOING}}b3.singleton=P.empty(),b3.VICTORY_SOURCE=[[new M(1,0),new ln(1,1),!1],[new M(0,1),new ln(1,1),!1],[new M(4,0),new ln(-1,1),!1],[new M(5,1),new ln(-1,1),!1],[new M(1,1),new ln(1,1),!0],[new M(4,1),new ln(-1,1),!0],[new M(0,1),new ln(0,1),!0],[new M(1,1),new ln(0,1),!0],[new M(2,1),new ln(0,1),!0],[new M(3,1),new ln(0,1),!0],[new M(4,1),new ln(0,1),!0],[new M(5,1),new ln(0,1),!0],[new M(1,0),new ln(1,0),!0],[new M(1,1),new ln(1,0),!0],[new M(1,2),new ln(1,0),!0],[new M(1,3),new ln(1,0),!0],[new M(1,4),new ln(1,0),!0],[new M(1,5),new ln(1,0),!0]];class xP extends q1{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return xP.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=As.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const g of u)e.push(As.withRotation(i.x,i.y,g[0],g[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new M(s,r);t.getPieceAt(i)===de.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getBoardValue(t){return new st(b3.get().getGameStatus(t).toBoardValue())}}xP.FIRST_TURN_MOVES=[As.rotationless(0,0),As.rotationless(1,0),As.rotationless(2,0),As.rotationless(0,1),As.rotationless(1,1),As.rotationless(0,2)];const je=de.NONE,N4=de.ZERO,t6=de.ONE;class s3e{constructor(){this.tutorial=[fe.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,V2.getInitialState()),fe.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new V2([[N4,je,je,N4,t6,je],[N4,t6,je,je,je,je],[N4,je,t6,je,je,je],[N4,je,je,je,je,t6],[N4,je,je,je,t6,je],[je,je,je,je,je,je]],10)).withPreviousMove(As.withRotation(0,0,0,!1)),fe.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new V2([[je,je,je,je,je,je],[je,N4,je,je,t6,je],[je,je,je,je,je,je],[je,je,je,je,je,je],[je,t6,je,je,N4,je],[je,je,je,je,je,je]],10),As.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?U.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):U.SUCCESS,$localize`Congratulations!`),fe.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new V2([[je,je,je,je,je,je],[je,N4,je,je,t6,je],[je,je,je,je,je,je],[je,je,je,je,je,je],[je,t6,je,je,N4,je],[je,je,je,je,je,je]],10),As.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?U.SUCCESS:U.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function D0t(n,t){if(1&n){const e=Te();B(),an(0),b(1,"circle",9),J("click",function(){const i=ue(e).$implicit,o=v().$implicit,c=v().index,u=v().index;return oe(v().onClick(3*c+i,3*u+o))}),O(),cn()}if(2&n){const e=t.$implicit,r=v().$implicit,s=v(),i=s.index,o=s.$implicit,c=v(),u=c.index,h=c.$implicit,g=v();S(1),We("id","click_",3*i+e,"_",3*u+r,""),T("ngClass",g.getSquareClasses(3*i+e,3*u+r)),D("cx",o+2*g.STROKE_WIDTH+(e+.5)*g.SPACE_SIZE)("cy",h+2*g.STROKE_WIDTH+(r+.5)*g.SPACE_SIZE)("r",(g.SPACE_SIZE-g.STROKE_WIDTH)/2)}}const i3e=function(){return[0,1,2]};function z0t(n,t){1&n&&(B(),an(0),k(1,D0t,2,6,"ng-container",3),cn()),2&n&&(S(1),T("ngForOf",J1(1,i3e)))}function V0t(n,t){if(1&n&&(B(),an(0),X(1,"rect",8),k(2,z0t,2,2,"ng-container",3),cn()),2&n){const e=t.$implicit,r=t.index,s=v(),i=s.index,o=s.$implicit,c=v();S(1),T("ngClass",c.getBlockClasses(r,i)),D("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),S(1),T("ngForOf",J1(8,i3e))}}const o3e=function(n){return[0,n]};function H0t(n,t){if(1&n&&(B(),an(0),k(1,V0t,3,9,"ng-container",3),cn()),2&n){const e=v();S(1),T("ngForOf",c3(1,o3e,e.BLOCK_SEPARATION))}}function F0t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v();We("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),T("ngClass",e.getPlayerClass(e.getCurrentPlayer())),D("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function B0t(n,t){if(1&n){const e=Te();B(),b(0,"path",11),J("click",function(){const i=ue(e).$implicit;return oe(v().rotate(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),D("d",e[0])("stroke-width",2*r.STROKE_WIDTH)}}function $0t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=t.$implicit,r=v();We("id","victoryCoord_",e.x,"_",e.y,""),T("ngClass",r.getSquareClasses(e.x,e.y)),D("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function U0t(n,t){if(1&n){const e=Te();B(),b(0,"g",13),J("click",function(){return ue(e),oe(v().skipRotation())}),X(1,"circle",14)(2,"line",15),O()}if(2&n){const e=v();S(1),D("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),S(1),D("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let G0t=(()=>{class n extends Eo{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=new b3(V2),this.availableMinimaxes=[new xP(this.rules,"PentagoMinimax")],this.encoder=As.encoder,this.tutorial=(new s3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const r=e.get();this.movedBlock=r.blockTurned;const s=new M(r.coord.x%3-1,r.coord.y%3-1);if(r.blockTurned.isPresent()&&!1===s.equals(new M(0,0))&&this.coordBelongToBlock(r)){let i;i=r.turnedClockwise?we.getNonNullable(V2.ROTATION_MAP.find(h=>h[0].equals(s)))[1]:we.getNonNullable(V2.ROTATION_MAP.find(h=>h[1].equals(s)))[0];const o=r.blockTurned.get();i=i.getNext(new ln(o%2==0?1:4,o<2?1:4),1),this.lastDrop=P.of(i)}else this.lastDrop=P.of(r.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=P.empty(),this.movedBlock=P.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,r=this.SPACE_SIZE,s=.5*this.SPACE_SIZE;return[["M "+s+" 0 q "+r+" -"+r+" "+2*r+" 0",0,!0],["M 0 "+s+" q -"+r+" "+r+" 0 "+2*r,0,!1],["M "+e+" "+s+" q "+r+" "+r+" 0 "+2*r,1,!0],["M "+(e-s)+" 0 q -"+r+" -"+r+" -"+2*r+" 0",1,!1],["M 0 "+(e-s)+" q -"+r+" -"+r+" 0 -"+2*r,2,!0],["M "+s+" "+e+" q "+r+" "+r+" "+2*r+" 0",2,!1],["M "+(e-s)+" "+e+" q -"+r+" "+r+" -"+2*r+" 0",3,!0],["M "+e+" "+(e-s)+"  q "+r+" -"+r+" 0 -"+2*r,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=P.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.board[r][e].isPlayer())return s.cancelMove(gt.MUST_LAND_ON_EMPTY_SPACE());const o=As.rotationless(e,r),c=s.getState(),u=c.applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o,c);const h=s.rules.getGameStatus(s.rules.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=P.of(new M(e,r)),s.displayArrows(u.neutralBlocks),U.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i[1]===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["moved-fill"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new M(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return A(function*(){const i=r.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=As.withRotation(o.x,o.y,e[1],e[2]);return r.chooseMove(c,r.getState())})()}skipRotation(){var e=this;return A(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=As.rotationless(s.x,s.y);return e.chooseMove(i,e.getState())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-pentago"]],features:[l],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),O()(),k(4,H0t,2,3,"ng-container",3),k(5,F0t,1,6,"circle",4),k(6,B0t,1,4,"path",5),k(7,$0t,1,7,"circle",6),k(8,U0t,3,9,"g",7),O()),2&e&&(S(4),T("ngForOf",c3(5,o3e,r.BLOCK_SEPARATION)),S(1),T("ngIf",r.currentDrop.isPresent()),S(1),T("ngForOf",r.arrows),S(1),T("ngForOf",r.victoryCoords),S(1),T("ngIf",r.canSkipRotation))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class A4 extends M{constructor(t,e,r){super(t,e),this.z=r}static getEncoder(t){return new class extends C4{encode(e){return{x:e.x,y:e.y,z:e.z}}decode(e){const r=e;return ye(null!=r.x&&"number"==typeof r.x&&null!=r.y&&"number"==typeof r.y,"Invalid encoded Coord3D"),t(r.x,r.y,r.z)}}}static of(t,e,r){return new A4(t,e,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}A4.encoder=A4.getEncoder(A4.of),A4.optionalEncoder=P.getEncoder(A4.encoder);class Mn extends A4{constructor(t,e,r){if(super(t,e,r),t<0||t>3)throw new Error(`PylosCoord: Invalid X: ${t}.`);if(e<0||e>3)throw new Error(`PylosCoord: Invalid Y: ${e}.`);if(r<0||r>3)throw new Error(`PylosCoord: Invalid Z: ${r}.`);const s=4-r;if(this.isNotInRange(s,s))throw new Error(this.toString()+" is not in range.")}static from(t,e,r){return new Mn(t,e,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new Mn(this.x,this.y,t),new Mn(this.x+1,this.y,t),new Mn(this.x,this.y+1,t),new Mn(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new M(this.x-1,this.y-1),r=new M(this.x,this.y-1),s=new M(this.x-1,this.y),i=new M(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new Mn(c.x,c.y,t))}getNextValid(t){const e=new M(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?P.empty():P.of(new Mn(e.x,e.y,this.z))}}Mn.encoder=A4.getEncoder(Mn.from),Mn.optionalEncoder=P.getEncoder(Mn.encoder);let K0=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),a3e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class ds extends yi{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static fromClimb(t,e,r){const s=P.of(t),i=ds.checkCaptures(r),o=new ds(s,e,i.firstCapture,i.secondCapture);if(!1===e.isHigherThan(t))throw new Error(K0.MUST_MOVE_UPWARD());return o}static checkCaptures(t){let e=P.empty(),r=P.empty();if(t.length>0&&(e=P.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=P.of(t[1]),t[1].isHigherThan(t[0])&&(e=P.of(t[1]),r=P.of(t[0])),t.length>2)throw new Error(a3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static fromDrop(t,e){const r=P.empty(),s=ds.checkCaptures(e);return new ds(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=ds.checkCaptures(e);return new ds(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}ds.encoder=new class extends Gi{encodeMove(n){return{firstCapture:Mn.optionalEncoder.encode(n.firstCapture),landingCoord:Mn.encoder.encode(n.landingCoord),secondCapture:Mn.optionalEncoder.encode(n.secondCapture),startingCoord:Mn.optionalEncoder.encode(n.startingCoord)}}decodeMove(n){const e=n.firstCapture,r=n.landingCoord,s=n.secondCapture;return new ds(Mn.optionalEncoder.decode(n.startingCoord),Mn.encoder.decode(r),Mn.optionalEncoder.decode(e),Mn.optionalEncoder.decode(s))}};class Ac extends XS{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=Ye.createTable(4,4,de.NONE),e=Ye.createTable(3,3,de.NONE),r=Ye.createTable(2,2,de.NONE);return new Ac([t,e,r,[[de.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return we.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:de.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:de.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:de.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[Ye.copyBiArray(this.boards[0]),Ye.copyBiArray(this.boards[1]),Ye.copyBiArray(this.boards[2]),Ye.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new Ac(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===de.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[de.NONE.value]=0,t[z.ZERO.value]=0,t[z.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new Mn(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:de.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=Ac.getLevelRange(r);for(const i of s)for(const o of s){const c=new Mn(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class No extends tr{static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new Mn(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=ds.fromClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=ds.fromDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[Ve.UP,Ve.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[Ve.LEFT,Ve.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(t.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new $t,r=t.getFreeToMoves();for(const s of r){e.add(new $t([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new $t([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[z.ZERO.value]?Ie.ONE_WON:15===r[z.ONE.value]?Ie.ZERO_WON:Ie.ONGOING}applyLegalMove(t,e,r){return No.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return G.failure(r.getReason());const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return G.failure(i.getReason());const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:G.success(void 0)}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return G.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===de.NONE)return G.failure(gt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return G.success(c)}return G.failure(K0.CANNOT_MOVE_SUPPORTING_PIECE())}return G.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?G.failure(gt.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?G.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):G.failure(K0.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return G.success(void 0);if(!1===No.canCapture(e,t.landingCoord))return G.failure(K0.CANNOT_CAPTURE());if(No.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||No.isValidCapture(r,t,t.secondCapture.get())?G.success(void 0):G.failure(K0.INVALID_SECOND_CAPTURE())}return G.failure(K0.INVALID_FIRST_CAPTURE())}getGameStatus(t){return No.getGameStatus(t)}}class Dm extends q1{static getListMoves(t){const e=t.gameState,r=[],s=No.getStateInfo(e),i=No.getClimbingMoves(s),o=No.getDropMoves(s),c=i.concat(o);for(const u of c){const h=e.applyLegalMove(u,!1);let g=new $t;No.canCapture(h,u.landingCoord)?g=No.getPossibleCaptures(h):r.push(u);for(const m of g){const C=ds.changeCapture(u,m.toList());r.push(C)}}return r}getListMoves(t){return Dm.getListMoves(t)}getBoardValue(t){const e=No.getGameStatus(t);if(e.isEndGame)return new st(e.toBoardValue());{const r=t.gameState.getPiecesRepartition();return new st(r[z.ZERO.value]-r[z.ONE.value])}}}class C9 extends Dm{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=Dm.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*C9.countStoneUsed(e),i=12*C9.countStoneUsed(r);return s+C9.sumMoveEmplacementByValue(e)-(i+C9.sumMoveEmplacementByValue(r))})}}const nt=de.NONE,n6=de.ZERO,c3e=de.ONE;class l3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Ac.getInitialState()),fe.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Ac.getInitialState(),ds.fromDrop(new Mn(1,1,0),[]),$localize`There you go, as simple as that.`),fe.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Ac([[[n6,c3e,nt,nt],[c3e,n6,nt,nt],[nt,nt,nt,nt],[nt,nt,nt,n6]],[[nt,nt,nt],[nt,nt,nt],[nt,nt,nt]],[[nt,nt],[nt,nt]],[[nt]]],0),[ds.fromClimb(new Mn(3,3,0),new Mn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),fe.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Ac([[[n6,n6,nt,nt],[nt,n6,nt,nt],[nt,nt,nt,nt],[nt,nt,nt,nt]],[[nt,nt,nt],[nt,nt,nt],[nt,nt,nt]],[[nt,nt],[nt,nt]],[[nt]]],0),[ds.fromDrop(new Mn(0,1,0),[new Mn(0,0,0)]),ds.fromDrop(new Mn(0,1,0),[new Mn(0,1,0)]),ds.fromDrop(new Mn(0,1,0),[new Mn(1,0,0)]),ds.fromDrop(new Mn(0,1,0),[new Mn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),fe.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Ac([[[n6,n6,nt,nt],[nt,n6,nt,nt],[nt,nt,nt,nt],[nt,nt,nt,nt]],[[nt,nt,nt],[nt,nt,nt],[nt,nt,nt]],[[nt,nt],[nt,nt]],[[nt]]],0),ds.fromDrop(new Mn(0,1,0),[new Mn(0,0,0),new Mn(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?U.SUCCESS:t.firstCapture.isPresent()?U.failure($localize`Failed, you only captured one piece.`):U.failure(Qce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function W0t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","piece_",r.value,"_",e,""),T("ngClass",s.getPlayerClass(r)),D("cx",s.SPACE_SIZE/4+e/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function q0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,W0t,1,6,"circle",7),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getPlayerSidePieces(e))}}function j0t(n,t){if(1&n){const e=Te();B(),b(0,"circle",12),J("click",function(){ue(e);const s=v(2).$implicit,i=v().$implicit,o=v().$implicit;return oe(v().onPieceClick(s,i,o))}),O()}if(2&n){const e=v(2).$implicit,r=v().$implicit,s=v().$implicit,i=v();Ko("id","piece_",e,"_",r,"_",s,""),T("ngClass",i.getPieceClasses(e,r,s)),D("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function Z0t(n,t){if(1&n){const e=Te();B(),b(0,"rect",12),J("click",function(){ue(e);const s=v(3).$implicit,i=v().$implicit,o=v().$implicit;return oe(v().onDrop(s,i,o))}),O()}if(2&n){const e=v(3).$implicit,r=v().$implicit,s=v().$implicit,i=v();Ko("id","drop_",e,"_",r,"_",s,""),T("ngClass",i.getSquareClasses(e,r,s)),D("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function Y0t(n,t){if(1&n&&(B(),k(0,Z0t,1,8,"rect",13)),2&n){const e=v(2).$implicit,r=v().$implicit,s=v().$implicit;T("ngIf",v().mustDisplayLandingCoord(e,r,s))}}function K0t(n,t){if(1&n&&(B(),an(0),k(1,j0t,1,7,"circle",10),k(2,Y0t,1,1,"ng-template",null,11,c1),cn()),2&n){const e=t1(3),r=v().$implicit,s=v().$implicit,i=v().$implicit,o=v();S(1),T("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function X0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,K0t,4,2,"ng-container",9),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v().$implicit,i=v();S(1),T("ngIf",i.mustDraw(e,r,s))}}function Q0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,X0t,2,1,"g",1),O()),2&n){const e=v().$implicit,r=v();S(1),T("ngForOf",r.getLevelRange(e))}}function J0t(n,t){if(1&n&&(B(),b(0,"g"),k(1,Q0t,2,1,"g",1),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getLevelRange(e))}}function e8t(n,t){if(1&n&&(B(),X(0,"rect",14)),2&n){const e=v();Ko("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),D("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function t8t(n,t){if(1&n){const e=Te();B(),b(0,"g",15),J("click",function(){return ue(e),oe(v().validateCapture())}),X(1,"circle",16)(2,"polygon",17),O()}if(2&n){const e=v();D("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),S(1),T("ngClass",e.getCaptureValidationButtonClasses()),D("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function n8t(n,t){if(1&n){const e=Te();B(),b(0,"g",18),J("click",function(){const i=ue(e).$implicit;return oe(v().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),O()}if(2&n){const e=t.$implicit,r=v();Ko("id","capturable_",e.x,"_",e.y,"_",e.z,""),D("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),S(1),D("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),S(1),D("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const r8t=function(){return[0,1,2]};let s8t=(()=>{class n extends H0{constructor(e){super(e),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty(),this.lastFirstCapture=P.empty(),this.lastSecondCapture=P.empty(),this.highCapture=P.empty(),this.capturables=[],this.chosenStartingCoord=P.empty(),this.chosenLandingCoord=P.empty(),this.chosenFirstCapture=P.empty(),this.chosenSecondCapture=P.empty(),this.lastMove=P.empty(),this.remainingPieces={0:15,1:15},this.hasAsymetricBoard=!0,this.rules=new No(Ac),this.availableMinimaxes=[new Dm(this.rules,"PylosMinimax"),new C9(this.rules,"PylosOrderedMinimax")],this.encoder=ds.encoder,this.tutorial=(new l3e).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===z.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return Ac.getLevelRange(e)}mustDraw(e,r,s){const i=new Mn(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return A(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Mn(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),U.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(K0.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(K0.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return A(function*(){return r.chosenStartingCoord=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),U.SUCCESS})()}onCaptureClick(e){var r=this;return A(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=P.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),U.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=P.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),U.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),U.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),U.SUCCESS):r.cancelMove(a3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return A(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?U.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return A(function*(){let s;return s=r.chosenStartingCoord.isAbsent()?ds.fromDrop(r.chosenLandingCoord.get(),e):ds.fromClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e),r.tryMove(s,r.state)})()}tryMove(e,r){var s=this;return A(function*(){return s.cancelMove(),s.chooseMove(e,r)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=P.empty(),this.chosenLandingCoord=P.empty(),this.chosenFirstCapture=P.empty(),this.chosenSecondCapture=P.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return A(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Mn(e,r,s);return No.canCapture(i.constructedState,c)?(i.chosenLandingCoord=P.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),U.SUCCESS):(i.chosenLandingCoord=P.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new Mn(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new Mn(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new Mn(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=P.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=P.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=P.empty(),this.lastLandingCoord=P.empty(),this.lastFirstCapture=P.empty(),this.lastSecondCapture=P.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new Mn(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g"),k(2,q0t,2,1,"g",1),O(),b(3,"g",null,2),X(5,"rect",3),k(6,J0t,2,1,"g",1),k(7,e8t,1,7,"rect",4),k(8,t8t,3,5,"g",5),k(9,n8t,3,12,"g",6),O()()),2&e&&(D("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),S(1),D("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),S(1),T("ngForOf",r.Player.PLAYERS),S(1),D("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),S(2),D("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),S(1),T("ngForOf",J1(10,r8t)),S(1),T("ngIf",r.highCapture.isPresent()),S(1),T("ngIf",r.chosenLandingCoord.isPresent()),S(1),T("ngForOf",r.capturables))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class qe{constructor(t){this.value=t}static fromInt(t){if(0<=t&&t<=15)return qe.pieces[t];if(16===t)return qe.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}qe.AAAA=new qe(0),qe.AAAB=new qe(1),qe.AABA=new qe(2),qe.AABB=new qe(3),qe.ABAA=new qe(4),qe.ABAB=new qe(5),qe.ABBA=new qe(6),qe.ABBB=new qe(7),qe.BAAA=new qe(8),qe.BAAB=new qe(9),qe.BABA=new qe(10),qe.BABB=new qe(11),qe.BBAA=new qe(12),qe.BBAB=new qe(13),qe.BBBA=new qe(14),qe.BBBB=new qe(15),qe.EMPTY=new qe(16),qe.pieces=[qe.AAAA,qe.AAAB,qe.AABA,qe.AABB,qe.ABAA,qe.ABAB,qe.ABBA,qe.ABBB,qe.BAAA,qe.BAAB,qe.BABA,qe.BABB,qe.BBAA,qe.BBAB,qe.BBBA,qe.BBBB];class I4 extends m3{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!!t.coord.equals(this.coord)&&this.piece===t.piece}}I4.encoder=new class extends _n{maxValue(){return 496}encodeNumber(n){return 128*n.coord.x+32*n.coord.y+n.piece.value}decodeNumber(n){const t=n%32;n-=t;const e=(n/=32)%4;return n-=e,new I4(n/=4,e,qe.fromInt(t))}};class Ic extends ws{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=Ye.createTable(4,4,qe.EMPTY);return new Ic(t,0,qe.AAAA)}static isGivable(t,e,r){return t!==r&&!1===Ic.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=qe.pieces,e=[];for(const r of t)Ic.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let yH=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class zm{constructor(t){this.subCriterion=[P.empty(),P.empty(),P.empty(),P.empty()],this.subCriterion[0]=P.of(8==(8&t.value)),this.subCriterion[1]=P.of(4==(4&t.value)),this.subCriterion[2]=P.of(2==(2&t.value)),this.subCriterion[3]=P.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=P.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new zm(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new zm(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class x4{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class Zs extends tr{static isOccupied(t){return t!==qe.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return Zs.isOccupied(o[s][r])?U.failure(gt.MUST_LAND_ON_EMPTY_SPACE()):i===qe.EMPTY?15===e.turn?U.SUCCESS:U.failure(yH.MUST_GIVE_A_PIECE()):Ic.isAlreadyOnBoard(i,o)?U.failure(yH.PIECE_ALREADY_ON_BOARD()):c===i?U.failure(yH.CANNOT_GIVE_PIECE_IN_HAND()):U.SUCCESS}isLegal(t,e){return Zs.isLegal(t,e).toFallible(void 0)}applyLegalMove(t,e){const r=e.getCopiedBoard();return r[t.coord.y][t.coord.x]=e.pieceInHand,new Ic(r,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===vn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:vn.VICTORY,sensitiveSquares:new mr}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new zm(s);for(let o=0;o<3&&!1!==Zs.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!Zs.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=Zs.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:vn.VICTORY,sensitiveSquares:new mr};{i.get().matchPiece(e.pieceInHand)&&(r.score=vn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=P.empty(),i=P.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===qe.EMPTY){if(!s.isAbsent())return{sensitiveCoord:P.of(o),commonCriterion:i,boardStatus:P.of(r)};s=P.of(o)}else i.isAbsent()?(i=P.of(new zm(u)),K(Zs.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),K(Zs.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:P.empty()}}static scoreToGameStatus(t,e){const r=z.of(e%2);return t===vn.VICTORY?Ie.getDefeat(r):16===e?Ie.DRAW:Ie.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:vn.DEFAULT,sensitiveSquares:new mr};for(const s of Zs.lines)if(r=Zs.updateBoardStatus(s,e,r),r.score===vn.VICTORY)return Zs.scoreToGameStatus(r.score,e.turn);return Zs.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of Zs.lines)if(Zs.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}Zs.VERBOSE=!1,Zs.lines=[new x4(new M(0,0),be.DOWN),new x4(new M(1,0),be.DOWN),new x4(new M(2,0),be.DOWN),new x4(new M(3,0),be.DOWN),new x4(new M(0,0),be.RIGHT),new x4(new M(0,1),be.RIGHT),new x4(new M(0,2),be.RIGHT),new x4(new M(0,3),be.RIGHT),new x4(new M(0,0),be.DOWN_RIGHT),new x4(new M(0,3),be.UP_RIGHT)];class EH extends q1{static scoreToBoardValue(t,e){if(t===vn.DEFAULT)return new st(0);{const r=z.of(e%2);return new st(t===vn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===qe.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const g=new I4(h,u,qe.EMPTY);return e.push(g),e}for(const g of i){const m=new I4(h,u,g);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:vn.DEFAULT,sensitiveSquares:new mr};for(const s of Zs.lines)if(r=Zs.updateBoardStatus(s,e,r),r.score===vn.VICTORY)break;return EH.scoreToBoardValue(r.score,e.turn)}}const i8t=qe.AABA,o8t=qe.AABB,u3e=qe.ABAA,a8t=qe.ABAB,c8t=qe.ABBA,f3e=qe.BAAA,l8t=qe.BAAB,u8t=qe.BABB,h3e=qe.BBAA,f8t=qe.BBAB,MH=qe.BBBA,h8t=qe.BBBB,x1=qe.EMPTY;class d3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Ic([[MH,h3e,u3e,i8t],[x1,x1,x1,x1],[x1,x1,x1,x1],[x1,x1,x1,x1]],7,qe.ABAB)),fe.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Ic([[MH,o8t,c8t,x1],[x1,x1,x1,x1],[x1,f3e,x1,x1],[x1,x1,x1,x1]],7,qe.ABAA),new I4(2,2,qe.BAAB),$localize`Perfect!`),fe.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Ic([[h8t,MH,f8t,x1],[u3e,u8t,h3e,x1],[a8t,f3e,l8t,x1],[x1,x1,x1,x1]],7,qe.AABA),[new I4(3,3,qe.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function d8t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=v(2),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.getPieceClasses(r.value)),D("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function p8t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.getPieceClasses(r.value)),D("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function g8t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=v(2).index,r=v().index,s=v();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function m8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,d8t,1,5,"rect",10),k(2,p8t,1,4,"ng-template",null,11,c1),k(4,g8t,1,3,"circle",7),O()),2&n){const e=t1(3),r=v().$implicit,s=v(2);S(1),T("ngIf",r.isRectangle())("ngIfElse",e),S(3),T("ngIf",s.pieceHasDot(r.value))}}function _8t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",9),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().chooseCoord(i,o))}),O(),k(2,m8t,5,3,"g",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","chooseCoord_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function v8t(n,t){if(1&n&&(B(),b(0,"g",null,8),k(2,_8t,3,8,"g",2),O()),2&n){const e=t.$implicit;S(2),T("ngForOf",e)}}function C8t(n,t){if(1&n&&(B(),X(0,"rect",17)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function y8t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function E8t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=v(2);D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function M8t(n,t){if(1&n){const e=Te();B(),b(0,"g",13,14),J("click",function(){return ue(e),oe(v().deselectDroppedPiece())}),X(2,"rect",15),k(3,C8t,1,5,"rect",16),k(4,y8t,1,4,"ng-template",null,11,c1),k(6,E8t,1,3,"circle",7),O()}if(2&n){const e=t1(5),r=v();We("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),D("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),S(3),T("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function S8t(n,t){if(1&n&&(B(),b(0,"g",null,18),X(2,"rect",19),O()),2&n){const e=t.$implicit,r=v();S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function P8t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function T8t(n,t){if(1&n&&(B(),X(0,"circle",21)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function w8t(n,t){1&n&&(B(),X(0,"circle",22)),2&n&&D("cy",.75*v(2).SPACE_SIZE)("r",10)}function b8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,P8t,1,6,"rect",10),k(2,T8t,1,3,"ng-template",null,11,c1),k(4,w8t,1,2,"circle",20),O()),2&n){const e=t1(3),r=v();S(1),T("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),S(3),T("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function O8t(n,t){if(1&n&&(B(),X(0,"rect",27)),2&n){const e=v(2).index,r=v().index,s=v();S1("id","chosenPiece_",4*r+e,""),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function N8t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getPieceClasses(4*r+e)),D("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function A8t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getPieceClasses(4*r+e)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function I8t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=v(2).index,r=v().index,s=v();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function x8t(n,t){if(1&n){const e=Te();B(),b(0,"g",13),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().choosePiece(4*i+s))}),k(1,O8t,1,5,"rect",26),k(2,N8t,1,5,"rect",10),k(3,A8t,1,4,"ng-template",null,11,c1),k(5,I8t,1,3,"circle",7),O()}if(2&n){const e=t1(4),r=v().index,s=v().index,i=v();S1("id","choosePiece_",4*s+r,""),S(1),T("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.fromInt(4*s+r))),S(1),T("ngIf",(4*s+r)%4<2)("ngIfElse",e),S(3),T("ngIf",i.pieceHasDot(4*s+r))}}function k8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,x8t,6,5,"g",3),O()),2&n){const e=t.index,r=v().index,s=v();S(1),T("ngIf",s.isRemaining(4*r+e))}}function L8t(n,t){if(1&n&&(B(),b(0,"g",null,23),X(2,"rect",24,25),k(4,k8t,2,1,"g",2),O()),2&n){const e=t.$implicit,r=v();D("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),S(2),D("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),S(2),T("ngForOf",e)}}let R8t=(()=>{class n extends Eo{constructor(e){super(e),this.EMPTY=qe.EMPTY,this.QuartoPiece=qe,this.chosen=P.empty(),this.lastMove=P.empty(),this.pieceInHand=qe.EMPTY,this.pieceToGive=P.empty(),this.victoriousCoords=[],this.rules=new Zs(Ic),this.availableMinimaxes=[new EH(this.rules,"QuartoMinimax")],this.encoder=I4.encoder,this.tutorial=(new d3e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=P.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===qe.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new I4(e,r,qe.EMPTY);return s.chooseMove(o,s.getState())}if(s.pieceToGive.isAbsent())return U.SUCCESS;{const o=new I4(e,r,s.pieceToGive.get());return s.chooseMove(o,s.getState())}}return s.cancelMove(gt.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return A(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(qe.fromInt(e)))return r.cancelMoveAttempt(),U.SUCCESS;if(r.pieceToGive=P.of(qe.fromInt(e)),r.chosen.isAbsent())return U.SUCCESS;{const i=r.chosen.get(),o=new I4(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o,r.rules.node.gameState)}})()}hideLastMove(){this.lastMove=P.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=P.empty(),this.chosen=P.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new M(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),U.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=P.of(new M(e,r))}isRemaining(e){return Ic.isGivable(qe.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new M(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==qe.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g",1),k(2,v8t,3,1,"g",2),k(3,M8t,7,8,"g",3),k(4,S8t,3,3,"g",2),b(5,"g",null,4),X(7,"rect",5,6),k(9,b8t,5,3,"g",7),O(),k(10,L8t,5,6,"g",2),O()()),2&e&&(D("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),S(2),T("ngForOf",r.board),S(1),T("ngIf",r.chosen.isPresent()),S(1),T("ngForOf",r.victoriousCoords),S(1),D("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),S(2),D("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),S(2),T("ngIf",r.chosen.isAbsent()),S(1),T("ngForOf",r.board))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),D8t=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class k4 extends m3{constructor(t,e,r){super(t,e),this.direction=r;const s=k4.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===Ve.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===Ve.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===Ve.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===Ve.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isValidCoord(t){return t.isNotInRange(5,5)?U.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?U.failure(D8t.NO_INSIDE_CLICK()):U.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}k4.encoder=new class extends _n{maxValue(){return 128}encodeNumber(n){const t=n.direction.toInt();return 20*n.coord.x+4*n.coord.y+t}decodeNumber(n){const t=Ve.factory.fromInt(n%4).get();n-=n%4;const e=(n/=4)%5;return n-=n%5,new k4(n/=5,e,t)}};class X0 extends ws{static getInitialState(){const t=Ye.createTable(5,5,de.NONE);return new X0(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;i.isInRange(5,5);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new X0(e,r)}}class Ao extends tr{static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new M(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new M(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new M(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new M(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push(Ve.LEFT),0!==t.y&&e.push(Ve.UP),4!==t.x&&e.push(Ve.RIGHT),4!==t.y&&e.push(Ve.DOWN),e}static getLinesSums(t){const e={};e[z.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[z.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){const e=Ao.getLinesSums(t),r=[];for(let s=0;s<2;s++){for(let i=0;i<5;i++){if(5===e[s].columns[i])for(let o=0;o<5;o++)r.push(new M(i,o));if(5===e[s].rows[i])for(let o=0;o<5;o++)r.push(new M(o,i))}if(5===e[s].diagonals[0])for(let i=0;i<5;i++)r.push(new M(i,i));if(5===e[s].diagonals[1])for(let i=0;i<5;i++)r.push(new M(i,4-i))}return r}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return Ao.applyLegalMove(t,e,r)}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?G.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):G.success(void 0)}getGameStatus(t){const e=t.gameState,r=Ao.getLinesSums(e),s=Ao.getFullestLine(r[z.ZERO.value]),i=Ao.getFullestLine(r[z.ONE.value]),o=e.getCurrentPlayer();return 5===s&&(o===z.ZERO||i<5)?Ie.ZERO_WON:5===i?Ie.ONE_WON:Ie.ONGOING}}class z8t extends q1{getListMoves(t){const e=[],r=Ao.getVerticalCoords(t),i=Ao.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=Ao.getPossibleDirections(o);for(const u of c){const h=new k4(o.x,o.y,u);e.push(h)}}return e}getBoardValue(t){const e=t.gameState,r=Ao.getLinesSums(e),s=Ao.getFullestLine(r[z.ZERO.value]),i=Ao.getFullestLine(r[z.ONE.value]),o=e.getCurrentPlayer();return new st(5===s&&(o===z.ZERO||i<5)?z.ZERO.getVictoryValue():5===i?z.ONE.getVictoryValue():i-s)}}const fr=de.NONE,xc=de.ZERO,O3=de.ONE;class p3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,X0.getInitialState()),fe.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new X0([[fr,fr,fr,fr,fr],[fr,fr,fr,fr,fr],[fr,fr,fr,fr,fr],[fr,fr,fr,fr,fr],[xc,xc,xc,xc,fr]],1),[new k4(4,4,Ve.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),fe.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new X0([[fr,O3,fr,O3,O3],[fr,xc,xc,fr,xc],[O3,O3,O3,xc,O3],[xc,fr,xc,O3,O3],[O3,xc,fr,O3,xc]],31),[new k4(3,0,Ve.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function V8t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"circle",4),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onBoardClick(i,o))}),O()()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function H8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,V8t,2,6,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function F8t(n,t){if(1&n){const e=Te();B(),b(0,"use",6),J("click",function(){const i=ue(e).$implicit;return oe(v(2).chooseDirection(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);S1("id","chooseDirection_",e,""),D("transform",r.getArrowTransform(e))}}function B8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,F8t,1,2,"use",5),O()),2&n){const e=v();S(1),T("ngForOf",e.getPossiblesDirections())}}let $8t=(()=>{class n extends Eo{constructor(e){super(e),this.lastMoveCoord=P.empty(),this.chosenCoord=P.empty(),this.victoriousCoords=[],this.rules=new Ao(X0),this.availableMinimaxes=[new z8t(this.rules,"QuixoMinimax")],this.encoder=k4.encoder,this.tutorial=(new p3e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=Ao.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=P.empty()}getPieceClasses(e,r){const s=new M(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new M(e,r),o=k4.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=P.of(i),U.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push(Ve.RIGHT),0!==r.x&&e.push(Ve.LEFT),4!==r.y&&e.push(Ve.DOWN),0!==r.y&&e.push(Ve.UP),e}chooseDirection(e){var r=this;return A(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return A(function*(){const r=e.chosenCoord.get(),s=new k4(r.x,r.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(s,e.getState())})()}getArrowTransform(e){return class Zlt{static getArrowTransform(t,e,r){let s,i,o;switch(r){case Ve.UP:s=1,i=0,o=-90;break;case Ve.DOWN:s=1,i=2,o=90;break;case Ve.LEFT:s=0,i=1,o=180;break;default:we.expectToBe(r,Ve.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new M(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs"),X(2,"polygon",1),O(),k(3,H8t,2,1,"g",2),k(4,B8t,2,1,"g",3),O()),2&e&&(D("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),S(3),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),$1=(()=>{class n extends ws{static getInitialState(){const e=Ye.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,de.NONE);return e[3][3]=z.ZERO,e[4][4]=z.ZERO,e[3][4]=z.ONE,e[4][3]=z.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new M(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class H2 extends m3{equals(t){return t===this||t.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}H2.encoder=new class extends _n{maxValue(){return($1.BOARD_HEIGHT-1)*$1.BOARD_WIDTH+($1.BOARD_WIDTH-1)}encodeNumber(n){return n.coord.y*$1.BOARD_WIDTH+n.coord.x}decodeNumber(n){const t=n%$1.BOARD_WIDTH;return new H2(t,(n-t)/$1.BOARD_WIDTH)}},H2.PASS=new H2(-1,-1),H2.PASS_NUMBER=H2.encoder.encodeNumber(H2.PASS);let U8t=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class g3e{constructor(t,e){this.move=t,this.switched=e}}let Vm=(()=>{class n extends tr{static getGameStatus(e){const r=e.gameState;if(!1===n.isGameEnded(r))return Ie.ONGOING;const i=r.countScore(),o=i[1]-i[0];return o<0?Ie.ZERO_WON:o>0?Ie.ONE_WON:Ie.DRAW}applyLegalMove(e,r,s){const i=r.turn,o=r.getCurrentPlayer(),c=r.getCopiedBoard();if(e.equals(H2.PASS))return new $1(c,i+1);for(const h of s)c[h.y][h.x]=o;return c[e.coord.y][e.coord.x]=o,new $1(c,i+1)}static getAllSwitcheds(e,r,s){const i=[],o=r.getOpponent();for(const c of be.DIRECTIONS){const u=e.coord.getNext(c);if(u.isInRange($1.BOARD_WIDTH,$1.BOARD_HEIGHT)&&s[u.y][u.x]===o){const h=n.getSandwicheds(r,c,u,s);for(const g of h)i.push(g)}}return i}static getSandwicheds(e,r,s,i){const o=[s];let c=s.getNext(r);for(;c.isInRange($1.BOARD_WIDTH,$1.BOARD_HEIGHT);){const u=i[c.y][c.x];if(u===e)return o;if(u===de.NONE)return[];o.push(c),c=c.getNext(r)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return n.getGameStatus(e)}static playerCanOnlyPass(e){const r=this.getListMoves(e);return 1===r.length&&r[0].move.equals(H2.PASS)}static nextPlayerCantOnlyPass(e){const r=e.getCopiedBoard(),i=new $1(r,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const r=[];let s;const i=e.getCurrentPlayer(),o=e.getCurrentOpponent();for(let c=0;c<8;c++)for(let u=0;u<8;u++)if(e.getPieceAtXY(u,c)===de.NONE&&(s=e.getCopiedBoard(),$1.getNeighboringPawnLike(s,o,u,c).length>0)){const g=new H2(u,c),m=n.getAllSwitcheds(g,i,s);if(m.length>0){for(const C of m)ye(i!==e.getPieceAt(C),C+"was already switched!"),s[C.y][C.x]=i;s[c][u]=i,r.push(new g3e(g,m.length))}}return 0===r.length&&r.push(new g3e(H2.PASS,0)),r}isLegal(e,r){if(e.equals(H2.PASS))return n.playerCanOnlyPass(r)?G.success([]):G.failure(gt.MUST_PASS());if(r.getPieceAt(e.coord).isPlayer())return K(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),G.failure(gt.MUST_CLICK_ON_EMPTY_SPACE());const s=r.getCopiedBoard(),i=n.getAllSwitcheds(e,r.getCurrentPlayer(),s);return K(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?G.failure(U8t.NO_ELEMENT_SWITCHED()):G.success(i)}}return n.VERBOSE=!1,n})();class kP extends q1{getBoardValue(t){const e=Vm.getGameStatus(t);if(e.isEndGame)return st.fromWinner(e.winner);const s=t.gameState.getCopiedBoard();let i=0,o=0;for(let c=0;c<$1.BOARD_HEIGHT;c++)for(let u=0;u<$1.BOARD_WIDTH;u++){const m=(0===u||u===$1.BOARD_WIDTH-1?4:1)*(0===c||c===$1.BOARD_HEIGHT-1?4:1);s[c][u]===z.ZERO&&(i+=m),s[c][u]===z.ONE&&(o+=m)}return i*=z.ZERO.getScoreModifier(),o*=z.ONE.getScoreModifier(),new st(o+i)}getListMoves(t){const e=Vm.getListMoves(t.gameState);return Ye.sortByDescending(e,r=>kP.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}kP.bestCoords=[new M(0,0),new M(0,$1.BOARD_HEIGHT-1),new M($1.BOARD_WIDTH-1,0),new M($1.BOARD_WIDTH-1,$1.BOARD_HEIGHT-1)];const Dt=de.NONE,Vt=de.ZERO,ct=de.ONE;class m3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new $1([[Vt,Vt,Vt,Vt,Vt,Vt,Vt,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,Vt,Vt,Vt,Vt,Vt,Vt,Vt]],60)),fe.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,$1.getInitialState(),new H2(2,4),$localize`Congratulations!`),fe.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new $1([[Dt,Dt,Dt,Dt,Dt,Dt,Dt,Dt],[Dt,Dt,Dt,Dt,Dt,Dt,Dt,Dt],[Dt,Dt,Dt,Dt,Dt,Dt,Dt,Dt],[Dt,Dt,Dt,Dt,ct,Dt,Dt,Dt],[Dt,Dt,Dt,Vt,Dt,Dt,Dt,Dt],[Dt,Dt,Vt,Dt,Dt,Dt,Dt,Dt],[Vt,Vt,Dt,Dt,Dt,Dt,Dt,Dt],[Dt,Vt,ct,Vt,ct,Vt,Dt,Dt]],1),[new H2(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),fe.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new $1([[ct,Vt,Vt,Vt,Vt,Vt,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[Vt,ct,ct,ct,ct,ct,ct,Vt],[ct,ct,ct,ct,ct,ct,Dt,Dt],[Vt,Vt,Vt,Vt,Vt,Vt,Dt,Dt]],60))]}}function G8t(n,t){if(1&n&&(B(),X(0,"circle",4)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPieceClass(e,r)),D("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function W8t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",2),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),O(),k(2,G8t,1,4,"circle",3),O()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function q8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,W8t,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let j8t=(()=>{class n extends Eo{constructor(e){super(e),this.EMPTY=de.NONE,this.lastMove=new M(-2,-2),this.captureds=[],this.scores=P.of([2,2]),this.rules=new Vm($1),this.availableMinimaxes=[new kP(this.rules,"ReversiMinimax")],this.encoder=H2.encoder,this.tutorial=(new m3e).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new H2(e,r);return yield s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new M(-2,-2),this.scores=P.of(e.countScore()),this.canPass=Vm.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.getState().getCurrentPlayer(),r=this.getState().getCurrentOpponent();for(const s of be.DIRECTIONS){let i=this.lastMove.getNext(s,1);for(;i.isInRange($1.BOARD_WIDTH,$1.BOARD_HEIGHT)&&this.getState().getPieceAt(i)===r&&this.rules.node.mother.get().gameState.getPieceAt(i)===e;)this.captureds.push(i),i=i.getNext(s,1)}}getRectClasses(e,r){const s=new M(e,r);return this.captureds.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return A(function*(){return ye(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(H2.PASS.coord.x,H2.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,q8t,2,1,"g",1),O()),2&e&&(D("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),S(1),T("ngForOf",r.board))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),C2=(()=>{class n extends c5{static getInitialState(){const e=Ne.UNREACHABLE,r=Ne.ZERO,s=Ne.ONE,i=Ne.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),y9=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class N3 extends $0{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const i=Math.abs(t.x-e.x)+Math.abs(t.y-e.y);if(0===i)return U.failure(gt.MOVE_CANNOT_BE_STATIC());if(1===i){const o=Ec.getFakeNeighbors(t);if(e.equals(o))return U.failure(y9.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==i)return U.failure($localize`You can move one or two spaces, not ${i}.`);if(Ec.isSpaceDark(t))return U.failure(y9.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return U.failure(y9.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return U.SUCCESS}static from(t,e){if(!t.isInRange(C2.WIDTH,C2.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!e.isInRange(C2.WIDTH,C2.HEIGHT))throw new Error("Move must end inside the board not at "+e.toString()+".");const r=N3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toFailedFallible():G.success(new N3(t,e))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}N3.encoder=new class extends _n{maxValue(){return 396*C2.WIDTH+66*C2.HEIGHT+6*C2.WIDTH+C2.HEIGHT}encodeNumber(n){const t=n.getEnd().y,e=n.getEnd().x,r=n.getStart().y;return 396*n.getStart().x+66*r+6*e+t}decodeNumber(n){const t=n%6;n-=t;const e=(n/=6)%11;n-=e;const r=(n/=11)%6;return n-=r,N3.from(new M(n/=6,r),new M(e,t)).get()}};let E9=(()=>{class n extends tr{static getStartingCoords(e,r){const s=[];for(let i=0;i<C2.HEIGHT;i++)for(let o=0;o<C2.WIDTH;o++)e[i][o].is(r)&&s.push(new M(o,i));return s}static getBoardValuesFor(e,r){const s=n.getStartingCoords(e,r),i=[];for(const o of s){const c=c5.getEmptyNeighbors(e,o,Ne.EMPTY).length;if(0===c)return[0];i.push(c)}return i.sort((o,c)=>o-c)}applyLegalMove(e,r,s){K(n.VERBOSE,"Legal move "+e.toString()+" applied");const i=r.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Ne.EMPTY,new C2(i,r.turn+1)}isLegal(e,r){if(r.getPieceAt(e.getStart()).value!==r.getCurrentPlayer().value)return G.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE());if(r.getPieceAt(e.getEnd())!==Ne.EMPTY)return G.failure(gt.MUST_LAND_ON_EMPTY_SPACE());const o=Ec.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?r.getPieceAt(o.get())===Ne.EMPTY?G.success(void 0):G.failure(y9.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):G.success(void 0)}getGameStatus(e){const r=e.gameState.getCopiedBoard(),s=n.getBoardValuesFor(r,z.ZERO),i=n.getBoardValuesFor(r,z.ONE);return n.getGameStatusFromFreedoms(s,i)}getLandingCoords(e,r){const s=o=>o.isInRange(C2.WIDTH,C2.HEIGHT)&&e[o.y][o.x]===Ne.EMPTY,i=new $t(Ec.getNeighbors(r).filter(s));if(!0===Ec.isSpaceDark(r))return i.toList();{const o=new $t(i.toList());for(const c of i){const u=Ec.getNeighbors(c).filter(s);for(const h of u)o.add(h)}return o.toList()}}static getGameStatusFromFreedoms(e,r){return 0===e[0]?Ie.ONE_WON:0===r[0]?Ie.ZERO_WON:Ie.ONGOING}}return n.VERBOSE=!1,n})();class Z8t extends q1{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=E9.getStartingCoords(r,s);for(const o of i){const c=c5.getEmptyNeighbors(r,o,Ne.EMPTY);for(const u of c){const h=N3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=Ne.EMPTY,e.push(h),(u.y+u.x)%2==0){const m=c5.getEmptyNeighbors(r,u,Ne.EMPTY);for(const C of m)if(!C.equals(o)){const w=N3.from(o,C).get();r[C.y][C.x]=r[u.y][u.x],r[u.y][u.x]=Ne.EMPTY,e.push(w),r[u.y][u.x]=r[C.y][C.x],r[C.y][C.x]=Ne.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=Ne.EMPTY}}return e}getBoardValue(t){const r=t.gameState.getCopiedBoard(),s=E9.getBoardValuesFor(r,z.ZERO),i=E9.getBoardValuesFor(r,z.ONE),o=E9.getGameStatusFromFreedoms(s,i);if(o.isEndGame)return st.fromWinner(o.winner);let c=0;for(;c<6&&s[c]===i[c];)c++;return new st(i[c%6]-s[c%6])}}const kc=Ne.UNREACHABLE,M9=Ne.ZERO,S9=Ne.ONE,An=Ne.EMPTY;class _3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,C2.getInitialState()),fe.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new C2([[kc,kc,An,An,S9,An,An,M9,S9,kc,kc],[kc,An,An,An,An,An,An,An,An,An,kc],[S9,M9,An,An,An,An,An,An,An,An,M9],[M9,An,An,An,An,An,An,An,An,An,S9],[kc,An,An,An,An,An,An,An,An,An,kc],[kc,kc,S9,M9,An,An,An,S9,M9,kc,kc]],3)),fe.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,C2.getInitialState(),N3.from(new M(2,0),new M(2,1)).get(),(t,e,r)=>t.isSimpleStep()?U.SUCCESS:U.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),fe.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,C2.getInitialState(),N3.from(new M(7,0),new M(5,0)).get(),(t,e,r)=>t.isSimpleStep()?U.failure($localize`Failed! You have made a single step.`):U.SUCCESS,$localize`Congratulations!`)]}}function Y8t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polygon",7),O()),2&n){const e=v().index,r=v().index,s=v();S(1),T("ngClass",s.getPlayerClassFor(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function K8t(n,t){if(1&n&&(B(),X(0,"polygon",10)),2&n){const e=v(2).index,r=v().index;D("points",v().getTriangleCoordinate(e,r))}}function X8t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v(2).index,r=v().index;D("points",v().getTriangleCoordinate(e,r))}}function Q8t(n,t){if(1&n&&(B(),b(0,"g"),k(1,K8t,1,1,"polygon",8),k(2,X8t,1,1,"polygon",9),O()),2&n){const e=v().index,r=v().index;S(1),T("ngIf",(e+r)%2==1),S(1),T("ngIf",(e+r)%2==0)}}function J8t(n,t){if(1&n){const e=Te();B(),b(0,"g",5),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),k(1,Y8t,2,2,"g",6),k(2,Q8t,3,2,"g",6),O()}if(2&n){const e=t.$implicit;We("id","click_",t.index,"_",v().index,""),S(1),T("ngIf",e.isPlayer()),S(1),T("ngIf",2===e.value)}}function eut(n,t){if(1&n&&(B(),b(0,"g"),k(1,J8t,3,4,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function tut(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=t.$implicit,r=v(2);We("id","possible_landing_",e.x,"_",e.y,""),D("points",r.getTriangleCoordinate(e.x,e.y))}}function nut(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=v(2);We("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function rut(n,t){if(1&n&&(B(),an(0),k(1,tut,1,3,"polygon",12),k(2,nut,1,3,"polygon",13),cn()),2&n){const e=v();S(1),T("ngForOf",e.possibleLandings),S(1),T("ngIf",e.chosenCoord.isPresent())}}function sut(n,t){if(1&n&&(B(),an(0),X(1,"polygon",15)(2,"polygon",15),cn()),2&n){const e=v(2);S(1),D("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),S(1),D("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function iut(n,t){1&n&&(B(),k(0,sut,3,2,"ng-container",6)),2&n&&T("ngIf",v().lastMoved.isPresent())}let out=(()=>{class n extends wce{constructor(e){super(e),this.lastCoord=P.empty(),this.lastMoved=P.empty(),this.chosenCoord=P.empty(),this.possibleLandings=[],this.rules=new E9(C2),this.availableMinimaxes=[new Z8t(this.rules,"SaharaMinimax")],this.encoder=N3.encoder,this.tutorial=(new _3e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=P.empty()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=Ne.ofPlayer(o);return s.chosenCoord.equalsValue(new M(e,r))?(s.cancelMoveAttempt(),U.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===Ne.EMPTY)return this.cancelMove(y9.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(z.fromTurn(this.getTurn()))){const s=new M(e,r);return this.selectPiece(s),U.SUCCESS}return this.cancelMove(y9.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=P.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return A(function*(){const i=new M(e,r),o=N3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get(),s.getState())})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(r=>r.getStart()),this.lastMoved=e.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(z.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(B(),b(0,"svg",0),k(1,eut,2,1,"g",1),k(2,rut,3,2,"ng-container",2),k(3,iut,1,1,"ng-template",null,3,c1),O()),2&e){const s=t1(4);S(1),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class oa extends m3{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static of(t,e,r,s){const i=new oa(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return G.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return G.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return G.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return G.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}oa.encoder=_n.tuple([_n.numberEncoder(6),_n.numberEncoder(6),P.getNumberEncoder(new vce),new vce],n=>[n.x+1,n.y+1,n.direction,n.landingOrientation],n=>oa.of(n[0]-1,n[1]-1,n[2],n[3]).get());class dt{constructor(t){this.value=t}static decode(t){switch(t){case 0:return dt.EMPTY;case 1:return dt.LIGHT_UP;case 2:return dt.LIGHT_RIGHT;case 3:return dt.LIGHT_DOWN;case 4:return dt.LIGHT_LEFT;case 5:return dt.DARK_UP;case 6:return dt.DARK_RIGHT;case 7:return dt.DARK_DOWN;case 8:return dt.DARK_LEFT;case 9:return dt.MOUNTAIN}}belongTo(t){return t===z.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?z.ZERO:5<=this.value&&this.value<=8?z.ONE:de.NONE}getOptionalDirection(){switch(this.value){case 0:return P.empty();case 1:case 5:return P.of(Ve.UP);case 2:case 6:return P.of(Ve.RIGHT);case 3:case 7:return P.of(Ve.DOWN);case 4:case 8:return P.of(Ve.LEFT);default:return we.expectToBe(this.value,9),P.empty()}}static of(t,e){return e===z.ZERO?t===Ve.UP?dt.LIGHT_UP:t===Ve.RIGHT?dt.LIGHT_RIGHT:t===Ve.DOWN?dt.LIGHT_DOWN:dt.LIGHT_LEFT:t===Ve.UP?dt.DARK_UP:t===Ve.RIGHT?dt.DARK_RIGHT:t===Ve.DOWN?dt.DARK_DOWN:dt.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return we.expectToBe(this.value,9),"MOUNTAIN"}}}dt.EMPTY=new dt(0),dt.LIGHT_UP=new dt(1),dt.LIGHT_RIGHT=new dt(2),dt.LIGHT_DOWN=new dt(3),dt.LIGHT_LEFT=new dt(4),dt.DARK_UP=new dt(5),dt.DARK_RIGHT=new dt(6),dt.DARK_DOWN=new dt(7),dt.DARK_LEFT=new dt(8),dt.MOUNTAIN=new dt(9);class A3 extends ws{static getInitialState(){const t=Ye.createTable(5,5,dt.EMPTY);return t[2][1]=dt.MOUNTAIN,t[2][2]=dt.MOUNTAIN,t[2][3]=dt.MOUNTAIN,new A3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==dt.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let P9=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class v3e{constructor(t,e){this.resultingBoard=t,this.moved=e}}class T1 extends tr{constructor(){super(A3)}static get(){return T1.singleton.isAbsent()&&(T1.singleton=P.of(new T1)),T1.singleton.get()}isLegal(t,e){if(K(T1.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return G.failure(gt.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return K(T1.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){K(T1.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return G.failure(s.legal.getReason());r=s.insertedPiece}else K(T1.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?U.SUCCESS:U.failure(P9.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return dt.of(-1===t.x?Ve.RIGHT:-1===t.y?Ve.DOWN:5===t.x?Ve.LEFT:Ve.UP,e)}isLegalForwarding(t,e,r){K(T1.VERBOSE,{isLegalForwarding:{move:t.toString(),state:e,firstPiece:r}}),ye(r!==dt.MOUNTAIN&&r!==dt.EMPTY,"forwarding must be done with player piece");const s=[];let i=dt.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==dt.EMPTY&&!1===this.isStraight(r,t))return K(T1.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),G.failure(P9.ILLEGAL_PUSH());let u=P.of(o);const h=o.getOpposite();let g=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=dt.EMPTY,s.push(t.coord));let C=c.isInRange(5,5)&&i!==dt.EMPTY;for(;C;){u.equalsValue(o)?g++:u.equalsValue(h)&&g--,K(T1.VERBOSE,{totalForce:g,movingPiece:i,landingCoord:c});const w=m[c.y][c.x];w===dt.MOUNTAIN&&(g-=.9),m[c.y][c.x]=i,s.push(c),i=w,c=c.getNext(o),u=i.getOptionalDirection(),C=c.isInRange(5,5)&&i!==dt.EMPTY&&g>0}return c.isNotInRange(5,5)&&(K(T1.VERBOSE,"This movement would push "+i+" outside the board"),u.equalsValue(o)?g++:u.equalsValue(h)&&g--),g<=0?(K(T1.VERBOSE,"This move is an illegal push: "+m),G.failure(P9.NOT_ENOUGH_FORCE_TO_PUSH())):(K(T1.VERBOSE,"This move is a legal push: "+m),G.success(new v3e(m,s)))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){K(T1.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return G.failure(P9.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=dt.of(t.landingOrientation,i),G.success(new v3e(o,[r]))}applyLegalMove(t,e,r){const s=Ye.copyBiArray(r.resultingBoard);return new A3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===z.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const g=e.getCurrentPlayer();for(const C of c)C.coord.isInRange(5,5)?e.getPieceAt(C.coord).belongTo(z.ZERO)?u=Math.min(u,C.distance):h=Math.min(h,C.distance):g===z.ZERO?u=Math.min(u,C.distance):h=Math.min(h,C.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,g)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===dt.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):de.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return K(T1.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==dt.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){K(T1.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=Ve.DOWN,u=new M(o,4);i.push({direction:c,fallingCoord:u}),c=Ve.UP,u=new M(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=Ve.LEFT,u=new M(0,o);i.push({direction:c,fallingCoord:u}),c=Ve.RIGHT,u=new M(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return K(T1.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){K(T1.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=P.empty(),h=!1,g=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const C=t.getPieceAt(c);if(C.isEmptyOrMountain())C===dt.MOUNTAIN?(m+=.9,g=!0):i++;else{const w=C.getDirection();w===r?g&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):w===s?(m+=1,g||i++):g?(u=P.of(c),o!==dt.EMPTY&&i++):i++}o=C,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?P.empty():P.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of Ve.ORTHOGONALS){const o=new M(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of Ve.ORTHOGONALS){const u=oa.of(o.x,o.y,P.of(i),c);ye(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new M(r,s);let o=this.getRotationMovesAt(i,e);for(const c of Ve.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):Ve.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of Ve.ORTHOGONALS)if(i!==s){const o=oa.of(t.x,t.y,P.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=Ve.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?Ve.ORTHOGONALS:[o];for(const u of i){const h=oa.of(e.x,e.y,P.of(o),u).get();this.isLegalForwarding(h,t,c).isSuccess()&&s.push(h)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?Ie.getVictory(r):Ie.ONGOING}}T1.singleton=P.empty(),T1.VERBOSE=!1;class aut extends q1{getBoardValue(t){return new st(T1.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(T1.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of T1.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return K(T1.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const Ge=dt.EMPTY,Ua=dt.MOUNTAIN,SH=dt.LIGHT_UP,PH=dt.LIGHT_LEFT,T9=dt.LIGHT_RIGHT,cut=dt.LIGHT_DOWN,lut=dt.DARK_UP,C3e=dt.DARK_LEFT,y3e=dt.DARK_RIGHT,uut=dt.DARK_DOWN;class E3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,A3.getInitialState()),fe.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,A3.getInitialState(),oa.of(2,-1,P.of(Ve.DOWN),Ve.DOWN).get(),$localize`Congratulations!`),fe.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new A3([[Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge],[Ge,Ua,Ua,Ua,Ge],[Ge,Ge,Ge,Ge,Ge],[Ge,Ge,SH,Ge,Ge]],0),[oa.of(2,4,P.of(Ve.UP),Ve.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),fe.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new A3([[Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge],[Ge,Ua,Ua,Ua,Ge],[Ge,Ge,Ge,Ge,Ge],[Ge,Ge,SH,Ge,Ge]],0),[oa.of(2,4,P.of(Ve.DOWN),Ve.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),fe.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new A3([[Ge,T9,C3e,Ge,Ge],[T9,y3e,PH,Ge,Ge],[Ge,Ge,SH,Ge,Ge],[Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge]],0),[oa.of(2,2,P.of(Ve.UP),Ve.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new A3([[Ge,Ge,T9,Ua,Ge],[Ge,Ge,T9,Ua,PH],[Ge,T9,Ua,Ua,Ge],[Ge,T9,y3e,C3e,Ua],[Ge,Ge,Ge,Ge,Ge]],0),[oa.of(1,3,P.of(Ve.RIGHT),Ve.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),fe.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new A3([[Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge],[Ua,lut,PH,Ge,cut],[Ge,Ge,Ge,Ge,uut],[Ge,Ge,Ge,Ge,Ua]],0),[oa.of(2,2,P.of(Ve.LEFT),Ve.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function fut(n,t){if(1&n){const e=Te();B(),b(0,"use",11),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().clickSquare(s,i))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",o.getPieceClasses(r,i,s)),D("transform",o.getPieceTransform(r,i))}}function hut(n,t){if(1&n){const e=Te();B(),b(0,"use",12),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v().clickSquare(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v();D("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function dut(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",8),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().clickSquare(i,o))}),O(),k(2,fut,1,4,"use",9),k(3,hut,1,1,"use",10),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","square_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.isPiece()),S(1),T("ngIf",i.isMountain(e))}}function put(n,t){if(1&n&&(B(),b(0,"g"),k(1,dut,4,9,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function gut(n,t){if(1&n){const e=Te();B(),b(0,"rect",15),J("click",function(){ue(e);const s=v().$implicit;return oe(v().clickSquare(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","square_",e.x,"_",e.y,""),T("ngClass",r.getSquareClasses(e.x,e.y)),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function mut(n,t){if(1&n){const e=Te();B(),b(0,"g"),k(1,gut,1,7,"rect",13),b(2,"rect",14),J("click",function(){const i=ue(e).$implicit;return oe(v().clickSquare(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),T("ngIf",!1===e.isInRange(5,5)),S(1),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function _ut(n,t){if(1&n){const e=Te();B(),b(0,"rect",16),J("click",function(){ue(e);const s=v();return oe(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),O()}if(2&n){const e=v();D("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function vut(n,t){if(1&n){const e=Te();B(),b(0,"rect",16),J("click",function(){ue(e);const s=v();return oe(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),O()}if(2&n){const e=v();D("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function Cut(n,t){if(1&n&&(B(),X(0,"use",19)),2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","remainingPieces_",r.value,"_",e,""),T("ngClass",s.getRemainingPieceClasses(r,e)),D("transform",s.getRemainingPieceTransform(e,r))}}function yut(n,t){if(1&n){const e=Te();B(),b(0,"g",17),J("click",function(){const i=ue(e).$implicit;return oe(v().selectPieceForInsertion(i))}),k(1,Cut,1,4,"use",18),O()}if(2&n){const e=t.$implicit,r=v();S1("id","remainingPieces_",e.value,""),S(1),T("ngForOf",r.ArrayUtils.range(r.playerPieces(e)))}}function Eut(n,t){if(1&n){const e=Te();B(),b(0,"use",22),J("click",function(){ue(e);const s=v().$implicit;return oe(v().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),O()}if(2&n){const e=v().$implicit,r=v();T("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),D("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function Mut(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"use",20),J("click",function(){const i=ue(e).$implicit;return oe(v().clickArrow(i))}),O(),k(2,Eut,1,2,"use",21),O()}if(2&n){const e=t.$implicit,r=v();S(1),Ko("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),D("transform",r.getIndicatorTransform(e)),S(1),T("ngIf",e.source.isPresent())}}function Sut(n,t){if(1&n){const e=Te();B(),b(0,"use",23),J("click",function(){const i=ue(e).$implicit;return oe(v().selectOrientation(i))}),O()}if(2&n){const e=t.$implicit,r=v();S1("id","orientation_",e.landingOrientation,""),T("ngClass",r.getCurrentPlayerClass()),D("transform",r.getOrientationTransform(e.landingOrientation))}}let Put=(()=>{class n extends Eo{constructor(e){super(e),this.lastMove=P.empty(),this.movedPieces=[],this.selectedPiece=P.empty(),this.selectedLanding=P.empty(),this.orientations=[],this.clickableCoords=new $t,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=T1.get(),this.availableMinimaxes=[new aut(this.rules,"SiamMinimax")],this.encoder=oa.encoder,this.tutorial=(new E3e).tutorial,this.updateBoard()}updateBoard(){K(n.VERBOSE,"updateBoard");const e=this.getState();if(this.board=e.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const r=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=P.empty(),this.selectedLanding=P.empty(),this.orientations=[],this.clickableCoords=new $t,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return A(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),U.SUCCESS;r.cancelMoveAttempt();for(const i of T1.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==dt.EMPTY){const c={source:P.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,U.SUCCESS})()}selectOrientation(e){var r=this;return A(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e,r.getState())})()}clickSquare(e,r,s=!1){var i=this;return A(function*(){if(K(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new M(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),U.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=P.of(o);const c=T1.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{ye(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(gt.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return A(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(P9.MUST_SELECT_ORIENTATION()),U.SUCCESS;r.selectedLanding=P.of(e);const s=T1.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return A(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(P9.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return A(function*(){return ye(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0],r.getState())):(r.clickableCoords=new $t,r.indicatorArrows=[],r.orientations=e,U.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=P.of(e);const i=T1.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==dt.EMPTY){const u={source:P.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return U.SUCCESS}clickArrow(e){var r=this;return A(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move,r.getState())})()}isMountain(e){return e===dt.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,h,c=2;return r===z.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,h=Ve.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,h=Ve.LEFT),this.getArrowTransform(c,u,h)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new M(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new M(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),O(),k(5,put,2,1,"g",4),k(6,mut,3,5,"g",4),k(7,_ut,1,4,"rect",5),k(8,vut,1,4,"rect",5),k(9,yut,2,2,"g",6),k(10,Mut,3,5,"g",4),k(11,Sut,1,3,"use",7),O()),2&e&&(S(5),T("ngForOf",r.board),S(1),T("ngForOf",r.clickableCoords),S(1),T("ngIf",r.selectedLanding.isPresent()),S(1),T("ngIf",r.selectedPiece.isPresent()),S(1),T("ngForOf",r.Player.PLAYERS),S(1),T("ngForOf",r.indicatorArrows),S(1),T("ngForOf",r.orientations))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),I3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class F2 extends Gce{static getInitialState(){return F2.fromRepresentation([[z.ZERO.value],[z.ONE.value]],0)}static fromRepresentation(t,e,r){const s=new Xf;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)t[i][o]!==de.NONE.value&&s.set(new M(o,i),z.of(t[i][o]));return new F2(s,e,r)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new F2(e,this.turn)}toRepresentation(){const t=Ye.createTable(this.width,this.height,de.NONE.value);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e).value;t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?U.failure(gt.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?U.SUCCESS:U.failure(I3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of xe.factory.all){const s=t.getNext(r,1);if(this.pieces.containsKey(s)&&!1===e.equalsValue(s))return!0}return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():de.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new F2(e,this.turn+1)}applyLegalDeplacement(t,e){const r=this.movePiece(t);if(e.size()>0){const s=new Xf;for(const i of e)s.set(i,r.getPieceAt(i));return new F2(s,this.turn+1)}return new F2(r.pieces,this.turn+1,r.offset)}countPieces(){const t=this.pieces.reverse(),e=t.get(z.ZERO).getOrElse(new mr),r=t.get(z.ONE).getOrElse(new mr);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new F2(e,this.turn,this.offset);Ss.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class Fr extends yi{constructor(t,e,r){if(super(),this.start=t,this.landing=e,this.keep=r,t.equalsValue(e))throw new Error("Deplacement cannot be static!");if(t.isPresent()&&t.equals(r))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new Fr(P.empty(),t,P.empty())}static fromMovement(t,e){return new Fr(P.of(t),e,P.empty())}static fromCut(t,e,r){return new Fr(P.of(t),e,P.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}Fr.encoder=new class extends Gi{encodeMove(n){return{start:n.start.isPresent()?M.encoder.encode(n.start.get()):null,landing:M.encoder.encode(n.landing),keep:n.keep.isPresent()?M.encoder.encode(n.keep.get()):null}}decodeMove(n){const t=n;if("object"!=typeof n)throw new Error("Invalid encodedMove of type "+typeof n+"!");const e=M.encoder.decode(t.landing);if(null==t.start)return Fr.fromDrop(e);const r=M.encoder.decode(t.start);if(null==t.keep)return Fr.fromMovement(r,e);{const s=M.encoder.decode(t.keep);return Fr.fromCut(r,e,s)}}};class x3 extends tr{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){K(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toFailedFallible():e.turn<40?this.isLegalDrop(t,e):x3.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new mr;for(const r of t.getPieceCoords())for(const s of xe.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===de.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?G.failure(I3.NO_MOVEMENT_BEFORE_TURN_40()):G.success(new $t(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return G.failure(I3.CAN_NO_LONGER_DROP());switch(e.getPieceAt(t.start.get())){case de.NONE:return G.failure(gt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case e.getCurrentOpponent():return G.failure(gt.CANNOT_CHOOSE_OPPONENT_PIECE())}const r=e.movePiece(t),s=r.getGroups();if(x3.isSplit(s)){const i=this.getBiggerGroups(s);if(1===i.size())return t.keep.isPresent()?G.failure(I3.CANNOT_CHOOSE_TO_KEEP()):G.success(i.getAnyElement().get());{const o=t.keep.map(c=>c.getNext(r.offset));return this.moveKeepBiggerGroup(o,i,r)}}return G.success(new mr)}static isSplit(t){return t.size()>1}static getBiggerGroups(t){let e=0,r=new $t;for(const s of t){const i=s.size();i>e?(e=i,r=new $t([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return G.failure(I3.MUST_CUT());if(r.getPieces().get(t.get()).isAbsent())return G.failure(I3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return G.success(i);return G.failure(I3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return Ie.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?Ie.ONE_WON:c<o?Ie.ZERO_WON:Ie.DRAW:o<6?Ie.getDefeat(z.ZERO):c<6?Ie.getDefeat(z.ONE):Ie.ONGOING}return Ie.ONGOING}startSearchingVictorySources(){K(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(K(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(xe.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(t+o.length)%6;o.push(c),c=c.getNext(xe.factory.all[h],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=xe.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=xe.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=xe.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=xe.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=xe.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}class Tut extends q1{calculateBoardValue(t,e){this.startSearchingVictorySources();let r={status:vn.DEFAULT,victory:P.empty(),preVictory:P.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===vn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===vn.VICTORY)return i;r={status:i.status,victory:P.empty(),preVictory:i.preVictory,sum:r.sum+i.sum}}return r}}class r6 extends st{constructor(t,e){super(t),this.value=t,this.preVictory=e}}class Q0 extends Tut{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(Q0.singleton.isAbsent()){const t=new x3(F2);Q0.singleton=P.of(new Q0(t,"SixMinimax"))}return Q0.singleton.get()}getListMoves(t){const e=Q0.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(t,r);const s=x3.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getListDeplacement(t.gameState,s)}createForcedDrop(t){K(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=Fr.fromDrop(t.preVictory.get());return e.push(r),e}createForcedDeplacement(t,e){K(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t),s=[e.preVictory.get()];return this.getDeplacementFrom(t.gameState,r,s)}getDeplacementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=Fr.fromMovement(i,o);if(t.isCoordConnected(o,P.of(i))){const h=t.movePiece(c).getGroups();if(x3.isSplit(h))for(const g of h){const m=g.getAnyElement().get(),C=Fr.fromCut(i,o,m);s.push(C)}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.gameState,r=e.getPieces().reverse(),s=e.getCurrentPlayer(),i=r.get(s).get(),o=i.getAnyElement().get(),c=[];for(const u of i)!1===this.isPieceBlockingAVictory(e,u)&&c.push(u);return new mr(0===c.length?[o]:c)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=Fr.fromDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===vn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=Fr.fromDrop(r);e.push(s)}return e}getListDeplacement(t,e){const r=t.getCurrentPlayer(),s=t.getPieces().reverse().get(r).get();return this.getDeplacementFrom(t,s,e)}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:vn.DEFAULT,victory:P.empty(),preVictory:P.empty(),sum:0};e.isPresent()&&(o=this.calculateBoardValue(e.get(),r));let c=P.empty();if(o.status===vn.DEFAULT&&o.preVictory.isPresent()&&(c=P.of(o.preVictory.get())),o.status===vn.VICTORY)return new r6(i,P.empty());if(r.turn>39){const u=r.countPieces(),h=u[0],g=u[1];return h<6&&g<6?new r6(h<g?z.ONE.getVictoryValue():g<h?z.ZERO.getVictoryValue():0,P.empty()):h<6?new r6(z.ZERO.getDefeatValue(),P.empty()):g<6?new r6(z.ONE.getDefeatValue(),P.empty()):new r6(h-g,c)}return new r6(o.status===vn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),c)}startSearchingVictorySources(){K(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(K(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(xe.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:vn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};const h=(t+o.length)%6;o.push(c),c=c.getNext(xe.factory.all[h],1)}return{status:vn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=xe.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:vn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:vn.VICTORY,victory:P.of(c),preVictory:P.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=xe.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:vn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};o.length%2==0&&(i=xe.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:vn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=xe.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:vn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};o.push(c),o.length%2==0&&(i=xe.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:vn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}getBoardInfo(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing.getNext(r.offset,1);switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){K(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(xe.factory.all[t],1),h=0,g=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const C=(t+c.length)%6;c.push(u);const w=xe.factory.all[C];m===de.NONE?(h+=.16,g=P.of(u)):h++,u=u.getNext(w,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(K(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:vn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};i=e}else if(5===t)return{status:vn.VICTORY,victory:P.of(r),preVictory:P.empty(),sum:0};return{status:s.status,victory:P.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=xe.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],h=P.empty();for(let H=0;H<6;H++){const Y=this.updateEncounterAndReturnLastEmpty(r,o,u);Y.isPresent()&&(h=Y),c.push(o),o=o.getNext(i,1)}let g=s.status,m=s.preVictory,C=0,w=0;for(;C<6;){const H=u.reduce((ee,_e)=>ee+_e);if(6===H)return{status:vn.VICTORY,victory:P.of(c),preVictory:P.empty(),sum:0};5.16===H&&g===vn.DEFAULT&&(m.isPresent()?(ye(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),g=vn.PRE_VICTORY):m=h),w=Math.max(w,H),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const Y=this.updateEncounterAndReturnLastEmpty(r,o,u);Y.isPresent()&&(h=Y),C++,o=o.getNext(i,1)}const I={status:g,victory:P.of(c),preVictory:m,sum:w};return this.getBoardInfoResult(w,h,c,I)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),P.empty();case de.NONE:return r.push(.16),P.of(e);default:return r.push(1),P.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=xe.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===de.NONE?(h+=.16,g=P.of(u)):h++,c.length%2==0&&(o=xe.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=xe.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===de.NONE?(h+=.16,g=P.of(u)):h++,c.push(u),c.length%2==0&&(o=xe.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}}Q0.singleton=P.empty();const Ee=de.NONE.value,Ht=z.ZERO.value,jt=z.ONE.value;let TH=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class M3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,F2.getInitialState()),fe.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,F2.fromRepresentation([[Ht,jt,jt,jt,jt,Ht],[Ee,Ht,jt,Ee,Ht,Ee],[jt,jt,Ht,Ee,Ee,Ee],[Ee,Ee,Ht,Ee,Ee,Ee],[Ee,Ht,Ee,Ee,Ee,Ee],[Ht,Ee,Ee,Ee,Ee,Ee]],0),[Fr.fromDrop(new M(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,F2.fromRepresentation([[Ee,Ee,Ee,jt,Ee,Ee],[Ee,Ee,jt,jt,Ht,Ht],[Ee,jt,Ee,Ht,jt,Ee],[jt,Ht,Ht,Ht,Ht,jt]],0),[Fr.fromDrop(new M(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),fe.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,F2.fromRepresentation([[Ee,Ee,Ee,jt,Ee,Ee],[Ee,Ht,jt,Ht,Ht,Ht],[Ee,Ht,Ee,Ht,Ht,Ee],[jt,jt,jt,Ee,jt,Ee]],0),[Fr.fromDrop(new M(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),fe.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,F2.fromRepresentation([[Ee,Ee,Ee,Ee,Ee,Ee,Ee,jt,Ee],[Ee,Ee,Ee,Ee,Ee,Ee,Ht,Ee,Ee],[Ee,Ee,Ee,Ee,Ht,Ht,Ht,Ee,Ee],[Ee,Ee,Ee,Ee,jt,jt,Ee,jt,Ht],[Ee,Ht,jt,jt,Ht,Ht,jt,Ee,Ee],[Ht,Ht,Ht,Ht,jt,jt,jt,Ht,Ee],[jt,jt,Ht,Ee,jt,jt,Ht,Ee,Ee],[Ee,Ht,Ee,Ht,Ht,Ee,Ee,Ee,Ee],[jt,jt,jt,jt,Ee,Ee,Ee,Ee,Ee],[Ee,Ht,Ee,jt,Ee,Ee,Ee,Ee,Ee]],40),Fr.fromMovement(new M(6,1),new M(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?U.SUCCESS:U.failure(TH.MOVEMENT_NOT_DISCONNECTING()):U.failure(TH.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),fe.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,F2.fromRepresentation([[Ee,Ee,Ee,Ee,Ee,jt],[Ee,Ee,Ee,Ee,Ht,jt],[Ee,Ee,Ee,jt,Ht,Ht],[Ee,Ee,Ht,Ee,jt,Ht],[jt,jt,Ee,Ee,Ee,Ht],[Ht,jt,Ee,Ee,Ee,Ee],[Ht,Ee,Ee,Ee,Ee,Ee]],40),Fr.fromMovement(new M(2,3),new M(3,3)),(t,e,r)=>t.start.equalsValue(new M(2,3))?U.SUCCESS:U.failure(TH.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),fe.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,F2.fromRepresentation([[Ee,Ee,Ee,Ee,Ee,jt],[Ee,Ee,Ee,Ee,Ht,jt],[Ee,Ee,Ee,jt,Ht,Ht],[Ht,Ee,Ht,Ee,Ee,jt],[jt,jt,Ee,Ee,Ee,Ee],[Ht,Ht,Ee,Ee,Ee,Ee],[Ht,Ee,Ee,Ee,Ee,Ee]],40),Fr.fromCut(new M(2,3),new M(2,5),new M(2,5)),(t,e,r)=>t.keep.isAbsent()?U.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing.getNext(r.offset))===de.NONE?U.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):U.SUCCESS,$localize`Congratulations, you won!`)]}}function wut(n,t){if(1&n){const e=Te();B(),b(0,"polygon",10),J("click",function(){const i=ue(e).$implicit;return oe(v().onPieceClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","piece_",e.x,"_",e.y,""),T("ngClass",r.getPieceClass(e)),D("points",r.getHexaPointsAt(e))}}function but(n,t){if(1&n){const e=Te();B(),b(0,"polygon",11),J("click",function(){const i=ue(e).$implicit;return oe(v().onNeighborClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","neighbor_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function Out(n,t){if(1&n){const e=Te();B(),b(0,"polygon",10),J("click",function(){ue(e);const s=v();return oe(s.onPieceClick(s.chosenLanding.get()))}),O()}if(2&n){const e=v();We("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),T("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),D("points",e.getHexaPointsAt(e.chosenLanding.get()))}}function Nut(n,t){if(1&n&&(B(),X(0,"polygon",12)),2&n){const e=t.$implicit,r=v();We("id","disconnected_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function Aut(n,t){if(1&n){const e=Te();B(),b(0,"polygon",13),J("click",function(){ue(e);const s=v();return oe(s.onNeighborClick(s.leftCoord.get()))}),O()}if(2&n){const e=v();We("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),D("points",e.getHexaPointsAt(e.leftCoord.get()))}}function Iut(n,t){if(1&n){const e=Te();B(),b(0,"polygon",14),J("click",function(){ue(e);const s=v();return oe(s.onPieceClick(s.lastDrop.get()))}),O()}if(2&n){const e=v();We("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),D("points",e.getHexaPointsAt(e.lastDrop.get()))}}function xut(n,t){if(1&n){const e=Te();B(),b(0,"polygon",15),J("click",function(){ue(e);const s=v();return oe(s.onPieceClick(s.selectedPiece.get()))}),O()}if(2&n){const e=v();We("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),T("ngClass",e.getSelectedPieceClass()),D("points",e.getHexaPointsAt(e.selectedPiece.get()))}}function kut(n,t){if(1&n&&(B(),X(0,"polygon",16)),2&n){const e=t.$implicit,r=v();We("id","victoryCoord_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function Lut(n,t){if(1&n){const e=Te();B(),b(0,"polygon",19),J("click",function(){const i=ue(e).$implicit;return oe(v(2).onPieceClick(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);We("id","cuttable_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function Rut(n,t){if(1&n&&(B(),b(0,"g",17),k(1,Lut,1,3,"polygon",18),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let Dut=(()=>{class n extends s9{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=P.empty(),this.lastDrop=P.empty(),this.selectedPiece=P.empty(),this.chosenLanding=P.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new x3(F2),this.availableMinimaxes=[new Q0(this.rules,"SixMinimax")],this.encoder=Fr.encoder,this.tutorial=(new M3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new i9(1.5*this.SPACE_SIZE,new M(2*this.SPACE_SIZE,0),Ts.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=P.empty(),this.chosenLanding=P.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=P.empty(),this.lastDrop=P.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return Xl.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=P.of(e.landing.getNext(this.state.offset)),this.leftCoord=!1===e.isDrop()?P.of(e.start.get().getNext(this.state.offset,1)):P.empty();const r=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of e)!1===this.rules.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o.getNext(this.state.offset,1)))&&s.push(o.getNext(this.state.offset,1));const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=x3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(I3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(gt.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?P.empty():P.of(e),U.SUCCESS);{const i=Fr.fromCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i,r.state)}})()}onNeighborClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(I3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Fr.fromDrop(e),r.state);if(r.selectedPiece.isAbsent())return r.cancelMove(I3.CAN_NO_LONGER_DROP());{const i=Fr.fromMovement(r.selectedPiece.get(),e),o=x3.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=P.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,U.SUCCESS):r.chooseMove(i,r.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===I3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Fr.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(e).getGroups(),i=x3.getBiggerGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,wut,1,4,"polygon",1),k(2,but,1,3,"polygon",2),k(3,Out,1,4,"polygon",3),k(4,Nut,1,3,"polygon",4),k(5,Aut,1,3,"polygon",5),k(6,Iut,1,3,"polygon",6),k(7,xut,1,4,"polygon",7),k(8,kut,1,3,"polygon",8),k(9,Rut,2,1,"g",9),O()),2&e&&(D("viewBox",r.viewBox),S(1),T("ngForOf",r.pieces),S(1),T("ngForOf",r.neighbors),S(1),T("ngIf",r.chosenLanding.isPresent()),S(1),T("ngForOf",r.disconnecteds),S(1),T("ngIf",r.leftCoord.isPresent()),S(1),T("ngIf",r.lastDrop.isPresent()),S(1),T("ngIf",r.selectedPiece.isPresent()),S(1),T("ngForOf",r.victoryCoords),S(1),T("ngForOf",r.cuttableGroups))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class aa extends sH{static of(t,e){return new aa(t,e)}static from(t,e){try{const r=new aa(t,e);return G.success(r)}catch(r){return G.failure(r.message)}}getMaximalDistance(){return 9}}aa.encoder=P4.getEncoder(aa.from);const zut={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:z.ZERO};class L4 extends iH{static getInitialState(){const t=fn.UNOCCUPIED,e=fn.INVADERS,r=fn.DEFENDERS;return new L4([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,fn.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}from(t,e){return new L4(t,e)}}class d5 extends oH{constructor(){super(L4,zut,aa.of)}static get(){return null==d5.singleton&&(d5.singleton=new d5),V1.ruler=this.singleton,d5.singleton}}const q=fn.UNOCCUPIED,r1=fn.INVADERS,Yi=fn.DEFENDERS,LP=fn.PLAYER_ONE_KING;class S3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,L4.getInitialState()),fe.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,L4.getInitialState(),aa.of(new M(4,1),new M(1,1)),$localize`Congratulations!`),fe.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new L4([[q,q,q,r1,r1,r1,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,q,Yi,q,q,q,q],[q,q,q,r1,Yi,q,q,q,r1],[r1,r1,Yi,Yi,LP,Yi,Yi,r1,r1],[q,q,q,q,Yi,q,q,q,r1],[q,q,q,q,Yi,q,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,r1,r1,r1,q,q,q]],1),[aa.of(new M(2,4),new M(2,3)),aa.of(new M(4,2),new M(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),fe.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new L4([[q,q,q,r1,r1,r1,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,q,Yi,q,q,q,q],[q,q,Yi,q,LP,q,Yi,q,r1],[r1,r1,q,Yi,q,Yi,Yi,r1,r1],[q,q,q,q,Yi,q,q,q,r1],[q,q,q,q,Yi,q,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,r1,r1,r1,q,q,q]],12),[aa.of(new M(1,4),new M(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),fe.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new L4([[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,r1,q,q,q,q,q,q,q],[r1,LP,q,r1,q,q,q,q,q],[q,r1,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q]],72),[aa.of(new M(3,4),new M(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),fe.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new L4([[q,q,r1,LP,r1,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,r1,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q]],72),[aa.of(new M(3,3),new M(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function Vut(n,t){1&n&&(B(),X(0,"polygon",8))}function Hut(n,t){1&n&&(B(),X(0,"rect",9))}function Fut(n,t){if(1&n&&(B(),b(0,"g"),k(1,Vut,1,0,"polygon",6),k(2,Hut,1,0,"ng-template",null,7,c1),O()),2&n){const e=t1(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function But(n,t){if(1&n&&(B(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function $ut(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function Uut(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function Gut(n,t){if(1&n&&(B(),k(0,$ut,1,1,"polyline",14),k(1,Uut,4,20,"ng-template",null,15,c1)),2&n){const e=t1(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function Wut(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",10),k(2,But,6,25,"g",11),k(3,Gut,3,2,"ng-template",null,12,c1),O()),2&n){const e=t1(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function qut(n,t){if(1&n){const e=Te();B(),b(0,"g",3),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),X(1,"rect",4),k(2,Fut,4,2,"g",5),k(3,Wut,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function jut(n,t){if(1&n&&(B(),b(0,"g"),k(1,qut,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Zut(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"rect",17),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let Yut=(()=>{class n extends aH{constructor(e){super(e,!1,aa.from),this.rules=d5.get(),this.availableMinimaxes=[new tP(this.rules,"DummyBot"),new rP(this.rules,"Piece > Influence"),new C3(this.rules,"Piece > Control"),new c9(this.rules,"Escape > Piece > Control")],this.encoder=aa.encoder,this.tutorial=(new S3e).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),k(1,jut,2,1,"g",1),k(2,Zut,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Oi{constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Is{constructor(t){this.pieces=t}static from(t){let e=-1;for(const r of t)ye(e<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=r.tileId;return new Is(t)}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?de.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return Is.from(this.pieces.concat(t))}getPieceAt(t){return ye(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}Is.EMPTY=Is.from([]);let Br=(()=>{class n extends ws{static getInitialState(){const e=Ye.createTable(n.SIZE,n.SIZE,Is.EMPTY);return new n(e,0)}static from(e,r){ye(e.length===n.SIZE,"Invalid board dimensions");for(const s of e)ye(s.length===n.SIZE,"Invalid board dimensions");return G.success(new n(e,r))}drop(e,r){const s=this.getCopiedBoard(),i=new Oi(r,this.turn);return s[e.y][e.x]=s[e.y][e.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(r=>"TrexoPieceStack.from("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,r,s){return this.getPieceAtXY(e,r).getPieceAt(s)}}return n.SIZE=10,n})(),RP=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class ca extends P4{constructor(t,e){super(t,e)}static from(t,e){return ye(t.isInRange(Br.SIZE,Br.SIZE),`${t.toString()} is out of the TrexoBoard!`),ye(e.isInRange(Br.SIZE,Br.SIZE),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?G.success(new ca(t,e)):G.failure(RP.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}ca.encoder=P4.getEncoder(ca.from);class B2 extends tr{constructor(){super(Br)}static getOwner(t){return t.getOwner()}static isInRange(t){return t.isInRange(Br.SIZE,Br.SIZE)}static get(){return B2.instance.isAbsent()&&(B2.instance=P.of(new B2)),B2.instance.get()}applyLegalMove(t,e){return e.drop(t.getZero(),z.ZERO).drop(t.getOne(),z.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?G.failure(RP.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?G.failure(RP.CANNOT_DROP_ON_ONLY_ONE_PIECE()):G.success(void 0)}isUnevenGround(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(t,e){return B2.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],r=[],s=t.getCurrentOpponent();for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=B2.getSquareScore(t,o);V1.getScoreStatus(u)===vn.VICTORY&&(c===s?e.push(o):r.push(o))}}return r.length>0?r:e}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=!1;for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=B2.getSquareScore(e,o);if(V1.getScoreStatus(u)===vn.VICTORY){if(c!==r)return Ie.getDefeat(r);s=!0}}}return s?Ie.getVictory(r):Ie.ONGOING}getLegalMoves(t){const e=[];for(const r of t.toMap()){const s=r.key;if(s.x+1<Br.SIZE){const i=new M(s.x+1,s.y);e.push(...this.getPossiblesMoves(t,s,i))}if(s.y+1<Br.SIZE){const i=new M(s.x,s.y+1);e.push(...this.getPossiblesMoves(t,s,i))}}return e}getPossiblesMoves(t,e,r){const s=t.getPieceAt(e),i=t.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[ca.from(e,r).get(),ca.from(r,e).get()]}}B2.instance=P.empty(),B2.TREXO_HELPER=new t3e(B2.isInRange,B2.getOwner,5);class wH extends q1{static getBoardValue(t){let e=0;const r=t.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=B2.getSquareScore(r,o.key);if(V1.getScoreStatus(u)===vn.VICTORY){if(c!==s)return new st(s.getDefeatValue());i=!0}else e+=u}}return new st(i?s.getVictoryValue():e)}getListMoves(t){return B2.get().getLegalMoves(t.gameState)}getBoardValue(t){return wH.getBoardValue(t)}}const ae=Is.EMPTY,P3e=Is.from([new Oi(z.ONE,0)]),Kut=Is.from([new Oi(z.ZERO,0)]),Xut=Is.from([new Oi(z.ONE,1)]),T3e=Is.from([new Oi(z.ZERO,1)]),Qut=Is.from([new Oi(z.ZERO,2)]),Jut=Is.from([new Oi(z.ONE,2)]),e5t=Is.from([new Oi(z.ZERO,0),new Oi(z.ZERO,3)]),t5t=Is.from([new Oi(z.ONE,1),new Oi(z.ONE,3)]),n5t=Is.from([new Oi(z.ZERO,4)]),r5t=Is.from([new Oi(z.ONE,4)]),s5t=Is.from([new Oi(z.ZERO,5)]),i5t=Is.from([new Oi(z.ONE,5)]),o5t=Is.from([new Oi(z.ONE,6)]),a5t=Is.from([new Oi(z.ZERO,6)]);class w3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,Br.getInitialState()),fe.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,Br.getInitialState(),ca.from(new M(4,4),new M(3,4)).get(),$localize`Congratulations!`),fe.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new Br([[ae,ae,ae,P3e,Kut,T3e,Xut,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae]],7),[ca.from(new M(4,0),new M(5,0)).get(),ca.from(new M(5,0),new M(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),fe.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new Br([[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,s5t,ae,ae,ae,ae,ae,ae],[ae,ae,ae,i5t,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,P3e,ae,ae,n5t,r5t,ae],[ae,ae,ae,ae,e5t,t5t,T3e,ae,ae,ae],[ae,ae,ae,ae,ae,Qut,o5t,a5t,ae,ae],[ae,ae,ae,ae,ae,Jut,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae]],7),ca.from(new M(2,0),new M(2,1)).get(),(t,e,r)=>B2.TREXO_HELPER.getSquareScore(r,t.getOne())===Number.MAX_SAFE_INTEGER?U.SUCCESS:U.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function c5t(n,t){if(1&n){const e=Te();B(),b(0,"g")(1,"polygon",5),J("click",function(){const i=ue(e).index,o=v().index;return oe(v().onClick(i,o))}),O()()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","space_",e,"_",r,""),T("ngClass",s.getSpaceClasses(e,r)),D("points",s.getParallelogramPoints())("transform",s.getTranslate(e,r,0))}}function l5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,c5t,2,5,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function u5t(n,t){if(1&n){const e=Te();B(),b(0,"g",8),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v(2).onClick(s,i))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v().index,c=v();Ko("id","half_tile_",r,"_",i,"_",o,""),T("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),D("transform",c.getTranslate(r,i,o+1))}}const b3e=function(n){return[n]};function f5t(n,t){if(1&n){const e=Te();B(),b(0,"g",9),J("click",function(){ue(e);const s=v().index,i=v().index;return oe(v(2).onClick(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v().index,i=v();Ko("id","dropped_piece_",e,"_",r,"_",s,""),T("mode",i.mode)("coord",i.Coord3D.of(e,r,s))("pieceClasses",c3(7,b3e,i.currentOpponentClass)),D("transform",i.getTranslate(e,r,s+1))}}function h5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,u5t,1,9,"g",6),k(2,f5t,1,9,"g",7),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.move.isPresent()),S(1),T("ngIf",e.isDroppedPiece)}}function d5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,h5t,3,2,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function p5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,d5t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}const g5t=function(){return["player0-fill"]};function m5t(n,t){if(1&n){const e=Te();B(),b(0,"g",10),J("click",function(){return ue(e),oe(v().switchToMode("3D"))}),O()}if(2&n){const e=v();T("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",J1(4,g5t)),D("transform",e.get3DSwitcherTransform())}}function _5t(n,t){if(1&n){const e=Te();B(),b(0,"g",11),J("click",function(){return ue(e),oe(v().switchToMode("2D"))}),O()}if(2&n){const e=v();T("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",c3(4,b3e,e.currentPlayerClass)),D("transform",e.getTranslate(12,9,0))}}class Sn extends Eo{constructor(t){super(t),this.TrexoComponent=Sn,this.left=-this.STROKE_WIDTH/2,this.Coord3D=A4,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=P.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=B2.get(),this.availableMinimaxes=[new wH(this.rules,"TrexoMinimax")],this.encoder=ca.encoder,this.tutorial=(new w3e).tutorial,Sn.SPACE_SIZE=this.SPACE_SIZE,Sn.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=Sn.modeMap[t]}getViewBoxWidth(){const t=Sn.modeMap["3D"],e=Br.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=Br.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*Sn.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(t.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(t.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(t),this.victoryCoords=B2.getVictoriousCoords(t),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const t=Ye.create3DTable(1,Br.SIZE,Br.SIZE,Sn.INITIAL_PIECE_ON_BOARD);let e=1;for(let r=0;r<=e;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(e=Math.max(e,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,t)}}return t}extractMoveFromState(t,e,r){const s=this.getState().getPieceAtXYZ(t,e,r),i=new M(t,e);let o=new M(-2,-2);for(const c of be.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(Br.SIZE,Br.SIZE)){const h=this.getState().getPieceAt(u);h.getHeight()>r&&h.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===z.ZERO?ca.from(i,o).get():ca.from(o,i).get()}addMoveToArray(t,e,r){for(;r.length<=t;)r.push(Ye.createTable(Br.SIZE,Br.SIZE,Sn.INITIAL_PIECE_ON_BOARD));r[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:P.of(e)},r[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:P.of(e)}}onClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#space_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),U.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===z.ZERO,g=ca.from(c?i:o,c?o:i).get();return r.chooseMove(g,r.getState())}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[t][e][r]=Sn.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[t][s.y][s.x].isPossibleClick=!1}selectPiece(t){if(this.possibleMoves.some(e=>e.getZero().equals(t))){const e=this.getState().getPieceAt(t).getHeight();return e>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Ye.createTable(Br.SIZE,Br.SIZE,Sn.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(t,e),U.SUCCESS}return this.cancelMove(RP.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(t,e){this.droppedPiece=P.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const r of this.possibleNextClicks)this.pieceOnBoard[e][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:P.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:P.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(r=>r.getZero().equals(t)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=P.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(t,e,r){const s=new M(t,e),i=this.getState().getPieceAtXYZ(t,e,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(t,e));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.rules.node.move.isPresent()){const c=this.rules.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(t,e){for(const r of this.pieceOnBoard)if(r[e][t].isPossibleClick)return["darker"];return[]}static getCoordTranslate(t,e,r,s){return new M(t*(this.SPACE_SIZE*s.horizontalWidthRatio)+s.offsetRatio*this.SPACE_SIZE*(Br.SIZE-e),e*this.SPACE_SIZE-s.pieceHeightRatio*this.SPACE_SIZE*r)}getTranslate(t,e,r){const i=Sn.getCoordTranslate(t,e,r,Sn.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoords().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoords(){const t=Sn.modeMap[this.chosenMode],e=Sn.SPACE_SIZE*t.horizontalWidthRatio,r=Sn.SPACE_SIZE,s=t.offsetRatio*Sn.SPACE_SIZE,i=e,c=e-s,u=r,h=-s,g=r;return[new M(0,0),new M(i,0),new M(c,u),new M(h,g)]}get3DSwitcherTransform(){const t=Sn.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*this.SPACE_SIZE+", "+(9+(1-1/e)/2)*this.SPACE_SIZE+") scale("+1/e+")"}}Sn.VERBOSE=!1,Sn.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:P.empty()},Sn.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2}},Sn.\u0275fac=function(t){return new(t||Sn)(Q(Nn))},Sn.\u0275cmp=mt({type:Sn,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,e){if(1&t&&(B(),b(0,"svg",0),k(1,l5t,2,1,"g",1),k(2,p5t,2,1,"g",1),b(3,"g",null,2),k(5,m5t,1,5,"g",3),k(6,_5t,1,6,"ng-template",null,4,c1),O()()),2&t){const r=t1(7);D("viewBox",e.left+" "+e.up+" "+e.width+" "+e.height),S(1),T("ngForOf",e.board),S(1),T("ngForOf",e.pieceOnBoard),S(3),T("ngIf","2D"===e.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ir{}Ir.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,Ir.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,Ir.MISSING_CAPTURES=Tc.MISSING_CAPTURES,Ir.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,Ir.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,Ir.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,Ir.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,Ir.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,Ir.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,Ir.AMBIGUOUS_CAPTURE_COORD=Tc.AMBIGUOUS_CAPTURE_COORD,Ir.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class Tt{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===de.NONE?Tt.EMPTY:e?Tt.RINGS[t.value]:Tt.MARKERS[t.value]}equals(t){return this===t}flip(){return ye(!1===this.isRing,"cannot flip a ring (it should never happen)"),ye(this.player.isPlayer(),"cannot flip a non-player piece"),Tt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case Tt.UNREACHABLE:return"NONE";case Tt.EMPTY:return"EMPTY";case Tt.MARKER_ZERO:return"MARKER_ZERO";case Tt.MARKER_ONE:return"MARKER_ONE";case Tt.RING_ZERO:return"RING_ZERO";default:return we.expectToBe(this,Tt.RING_ONE),"RING_ONE"}}}Tt.encoder=_n.tuple([z.numberEncoder,_n.booleanEncoder],n=>[n.player,n.isRing],n=>Tt.of(n[0],n[1])),Tt.UNREACHABLE=new Tt(de.NONE,!1),Tt.EMPTY=new Tt(de.NONE,!1),Tt.MARKER_ZERO=new Tt(z.ZERO,!1),Tt.MARKER_ONE=new Tt(z.ONE,!1),Tt.MARKERS=[Tt.MARKER_ZERO,Tt.MARKER_ONE],Tt.RING_ZERO=new Tt(z.ZERO,!0),Tt.RING_ONE=new Tt(z.ONE,!0),Tt.RINGS=[Tt.RING_ZERO,Tt.RING_ONE];let Ga=(()=>{class n extends lH{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],Tt.EMPTY),this.sideRings=r}static getInitialState(){const e=Tt.EMPTY,r=Tt.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Ye.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Tt.UNREACHABLE}setAtUnsafe(e,r){const s=Ye.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class la extends g2{constructor(t,e){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=P.ofNullable(e)}static of(t,e,r){const s=[],i=xe.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new la(s,r)}setRingTaken(t){return new la(this.capturedSpaces,t)}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}la.encoder=new class extends C4{encode(n){return{captured:n.capturedSpaces.map(t=>M.encoder.encode(t)),ringTaken:M.encoder.encode(n.ringTaken.get())}}decode(n){const t=n;return ye(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new la(t.captured.map(e=>M.encoder.decode(e)),M.encoder.decode(t.ringTaken))}};class Wa extends yi{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===Ye.compareArray(this.initialCaptures,t.initialCaptures)||!1===Ye.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}Wa.coordOptionalEncoder=P.getEncoder(M.encoder),Wa.encoder=new class extends Gi{encodeMove(n){const t={moveStart:M.encoder.encode(n.start),moveEnd:Wa.coordOptionalEncoder.encode(n.end)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=la.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=la.encoder.encode(e)}),t}decodeMove(n){const t=n;return ye(null!=t.moveStart,"Invalid encoded YinshMove"),new Wa(this.decodeArray(t,"initialCapture",la.encoder.decode),M.encoder.decode(t.moveStart),Wa.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",la.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class C5t extends q1{getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?st.fromWinner(e.winner):new st(t.gameState.sideRings[0]*z.ZERO.getScoreModifier()+t.gameState.sideRings[1]*z.ONE.getScoreModifier())}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const[s,i]of r.getCoordsAndContents())i===Tt.EMPTY&&e.push(new Wa([],s,P.empty(),[]));else{const s=this.ruler;this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const g=new Wa(i,c.start,P.of(c.end),h);e.push(g)})})})}return e}getPossibleCaptureCombinations(t){const r=this.ruler.getPossibleCaptures(t),s=this.getRingCoords(t);return bm.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class v5t{static getCombinations(t,e){return ye(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new la(c.capturedSpaces,o[u])))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=this.ruler,r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===Tt.RINGS[e]&&r.push(s)}),r}}class O3e extends tr{applyLegalMove(t,e,r){return new Ga(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new Ga(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,Tt.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new Ga(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,Tt.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===Tt.RINGS[r]?U.SUCCESS:U.failure(Ir.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,Tt.MARKERS[s]);i=i.setAt(e,Tt.RINGS[s]);const o=xe.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==Tt.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return G.failure(Ir.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toFailedFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toFailedFallible();const u=this.applyCaptures(t.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toFailedFallible():G.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return G.failure(Ir.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==Tt.EMPTY)return G.failure(gt.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,Tt.of(r,!0)).board,o=new Ga(i,s,t.turn);return G.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==Tt.RINGS[r]?U.failure(Ir.SHOULD_SELECT_PLAYER_RING()):U.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==Tt.EMPTY)return U.failure(Ir.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=xe.factory.fromMove(e,r);if(i.isFailure())return U.failure(Ir.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=t.getPieceAt(u);if(h===Tt.EMPTY){if(c)return U.failure(Ir.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return U.failure(Ir.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return U.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return U.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==Tt.MARKERS[r])return U.failure(Ir.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==Tt.RINGS[r]?U.failure(Ir.CAPTURE_SHOULD_TAKE_RING()):U.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?U.SUCCESS:U.failure(Ir.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const h=t.getPieceAt(u);if(h.player===e&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?P.of({start:c,end:u,dir:o}):P.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(la.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of xe.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===Tt.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?Ie.ONGOING:t.gameState.sideRings[0]>=3?Ie.ZERO_WON:t.gameState.sideRings[1]>=3?Ie.ONE_WON:Ie.ONGOING}}const W=Tt.EMPTY,Me=Tt.UNREACHABLE,$2=Tt.MARKER_ZERO,Ki=Tt.RING_ZERO,R4=Tt.MARKER_ONE,y2=Tt.RING_ONE;let N3e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class A3e extends lr{constructor(){super(...arguments),this.tutorial=[fe.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Ga([[Me,Me,Me,Me,Me,Me,W,W,W,W,Me],[Me,Me,Me,Me,W,W,W,W,W,W,W],[Me,Me,Me,$2,y2,W,W,W,W,W,W],[Me,Me,W,$2,W,y2,W,R4,W,W,W],[Me,W,Ki,R4,W,W,y2,$2,W,W,W],[Me,W,W,$2,R4,W,W,W,W,W,Me],[W,W,W,$2,W,W,W,y2,W,W,Me],[W,W,W,R4,$2,Ki,W,W,W,Me,Me],[W,W,W,W,W,W,W,W,Me,Me,Me],[W,W,W,W,W,W,W,Me,Me,Me,Me],[Me,W,W,W,W,Me,Me,Me,Me,Me,Me]],[3,1],20)),fe.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new Ga(Ga.getInitialState().board,[5,5],0),new Wa([],new M(5,5),P.empty(),[]),$localize`Congratulations!`),fe.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Ga([[Me,Me,Me,Me,Me,Me,W,W,W,W,Me],[Me,Me,Me,Me,W,W,W,W,W,W,W],[Me,Me,Me,y2,W,W,W,W,W,W,W],[Me,Me,y2,W,W,y2,W,W,W,W,W],[Me,W,Ki,R4,W,W,y2,W,W,W,W],[Me,W,W,R4,W,W,W,W,W,W,Me],[W,W,W,W,Ki,W,W,y2,W,W,Me],[W,W,W,W,W,Ki,W,W,W,Me,Me],[W,W,W,Ki,W,W,W,Me,Me,Me,Me],[W,W,W,W,W,W,W,Me,Me,Me,Me],[Me,W,W,W,W,Me,Me,Me,Me,Me,Me]],[0,0],20),new Wa([],new M(2,4),P.of(new M(4,4)),[]),$localize`Congratulations!`),fe.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Ga([[Me,Me,Me,Me,Me,Me,W,W,W,W,Me],[Me,Me,Me,Me,W,W,W,W,W,W,W],[Me,Me,Me,y2,W,W,W,W,W,W,W],[Me,Me,y2,W,W,y2,W,W,W,W,W],[Me,W,$2,$2,Ki,R4,R4,W,W,W,W],[Me,W,W,y2,W,W,W,W,W,W,Me],[W,W,W,W,Ki,W,W,y2,W,W,Me],[W,W,W,W,W,Ki,W,W,W,Me,Me],[W,W,W,Ki,W,W,W,Ki,Me,Me,Me],[W,W,W,W,W,W,W,Me,Me,Me,Me],[Me,W,W,W,W,Me,Me,Me,Me,Me,Me]],[0,0],20),new Wa([],new M(4,4),P.of(new M(7,4)),[la.of(new M(2,4),new M(6,4),new M(7,4))]),(t,e,r)=>1===r.sideRings[z.ZERO.value]?U.SUCCESS:U.failure(N3e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),fe.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new Ga([[Me,Me,Me,Me,Me,Me,W,W,W,W,Me],[Me,Me,Me,Me,Ki,W,W,y2,y2,Ki,W],[Me,Me,Me,Ki,W,W,R4,y2,W,Ki,W],[Me,Me,W,Ki,W,W,W,W,W,y2,W],[Me,W,W,W,W,$2,W,W,y2,W,W],[Me,W,W,W,$2,$2,W,R4,W,W,Me],[W,W,W,$2,W,$2,W,W,W,W,Me],[W,W,$2,W,W,$2,W,W,W,Me,Me],[W,$2,W,W,W,$2,W,W,Me,Me,Me],[W,W,W,W,W,$2,W,Me,Me,Me,Me],[Me,W,W,W,W,Me,Me,Me,Me,Me,Me]],[0,0],10),new Wa([la.of(new M(5,4),new M(1,8),new M(3,2)),la.of(new M(5,9),new M(5,5),new M(3,3))],new M(4,1),P.of(new M(4,2)),[]),(t,e,r)=>2===r.sideRings[z.ZERO.value]?U.SUCCESS:U.failure(N3e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function y5t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2).$implicit,r=v(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function E5t(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","ring_",r,"_",i,""),T("ngClass",s.ringClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function M5t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2).$implicit,r=v(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function S5t(n,t){if(1&n&&(B(),X(0,"circle",14)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","marker_",r,"_",i,""),T("ngClass",s.markerClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function P5t(n,t){if(1&n){const e=Te();B(),b(0,"g",6),J("click",function(){ue(e);const s=v().$implicit;return oe(v(2).onClick(s.coord))}),X(1,"polygon",7),b(2,"g",8),k(3,y5t,1,3,"circle",9),k(4,E5t,1,6,"circle",10),k(5,M5t,1,3,"circle",9),k(6,S5t,1,6,"circle",11),O()()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index;We("id","click_",r,"_",i,""),S(1),We("id","space_",r,"_",i,""),T("ngClass",s.spaceClasses),D("points",s.coordinates),S(1),We("id","pieceGroup_",r,"_",i,""),T("ngClass",s.removedClass),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isMarker)}}function T5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,P5t,7,13,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",null!=e)}}function w5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,T5t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function b5t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",15),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","selected_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function O5t(n,t){if(1&n){const e=Te();B(),b(0,"polygon",17),J("click",function(){const i=ue(e).$implicit;return oe(v(2).onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);We("id","selectable_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function N5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,O5t,1,3,"polygon",16),O()),2&n){const e=v();S(1),T("ngForOf",e.viewInfo.selectableCoords)}}function A5t(n,t){if(1&n){const e=Te();B(),b(0,"rect",18),J("click",function(){const i=ue(e).$implicit;return oe(v().onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","indicator_",e.x,"_",e.y,""),D("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function I5t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),O()),2&n){const e=t.index,r=v().$implicit,s=v();S(1),We("id","player_",r.value,"_sideRing_",e+1,""),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),S(1),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),S(1),T("ngClass",s.viewInfo.sideRingClass[r.value]),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const x5t=function(){return[]};function k5t(n,t){if(1&n&&(B(),b(0,"g"),k(1,I5t,4,12,"g",1),O()),2&n){const e=t.$implicit,r=v();D("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),S(1),T("ngForOf",J1(2,x5t).constructor(r.viewInfo.sideRings[e.value]))}}class E2 extends s9{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=P.empty(),this.moveEnd=P.empty(),this.currentlyMoved=[],this.currentCapture=P.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:E2.MARKER_SIZE,ringOuterSize:E2.RING_OUTER_SIZE,ringMidSize:E2.RING_MID_SIZE,ringInnerSize:E2.RING_INNER_SIZE,indicatorSize:E2.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=P.of([0,0]),this.rules=new O3e(Ga),this.availableMinimaxes=[new C5t(this.rules,"YinshMinimax")],this.encoder=Wa.encoder,this.tutorial=(new A3e).tutorial,this.hexaLayout=new i9(1.5*E2.RING_OUTER_SIZE,new M(2*E2.RING_OUTER_SIZE,0),Ts.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPointsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=P.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of z.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==Tt.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=P.empty(),this.moveStart=P.empty(),this.moveEnd=P.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const t=this.rules.node.move;if(t.isPresent()){const e=t.get();if(e.isInitialPlacement())this.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const s of this.coordsBetween(e.start,e.end.get()))this.viewInfo.spaceInfo[s.y][s.x].spaceClasses=["moved-fill"];const r=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();e.initialCaptures.forEach(s=>this.showLastMoveCapture(s,r)),e.finalCaptures.forEach(s=>this.showLastMoveCapture(s,r))}}}coordsBetween(t,e){const r=[],s=xe.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==Tt.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),U.SUCCESS}onClick(t){var e=this;return A(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return A(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(Ir.MISSING_CAPTURES());e.selectCapture(r[0])}return U.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(we.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return A(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(Ir.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(Ir.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=P.of(t),this.constructedState=new Ga(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(ye("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),U.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,Tt.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,Tt.RINGS[e.value])}selectRing(t){var e=this;return A(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=P.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),U.SUCCESS)):(we.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),U.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),U.SUCCESS}tryMove(){var t=this;return A(function*(){const e=new Wa(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e,t.getState(),t.scores.get())})()}selectMoveStart(t){var e=this;return A(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=P.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=P.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return U.SUCCESS})()}selectMoveEnd(t){var e=this;return A(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),U.SUCCESS;const r=Tt.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=P.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return A(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),U.SUCCESS)})()}}function L5t(n,t){if(1&n&&(b(0,"option",5),St(1),O()),2&n){const e=t.$implicit;T("value",e.urlName),S(1),a1(e.name)}}E2.RING_OUTER_SIZE=40,E2.RING_MID_SIZE=34,E2.RING_INNER_SIZE=28,E2.MARKER_SIZE=E2.RING_INNER_SIZE,E2.INDICATOR_SIZE=10,E2.\u0275fac=function(t){return new(t||E2)(Q(Nn))},E2.\u0275cmp=mt({type:E2,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(B(),b(0,"svg",0),k(1,w5t,2,1,"g",1),k(2,b5t,1,3,"polygon",2),k(3,N5t,2,1,"g",3),k(4,A5t,1,6,"rect",4),k(5,k5t,2,3,"g",1),O()),2&t&&(S(1),T("ngForOf",e.viewInfo.spaceInfo),S(1),T("ngForOf",e.viewInfo.selectedCoords),S(1),T("ngIf",e.isPlayerTurn()),S(1),T("ngForOf",e.viewInfo.targets),S(1),T("ngForOf",e.Player.PLAYERS))},dependencies:[En,Dn,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let U1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),w9=(()=>{class n{constructor(e,r,s,i,o,c,u,h=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",R0t,new n3e,new Ar(Jl),new Date("2018-08-28"),U1.P4()),new n($localize`Awal`,"Awale",Z3t,new Sce,new S4(Wi),new Date("2018-11-29"),U1.AWALE()),new n($localize`Quarto`,"Quarto",R8t,new d3e,new Zs(Ic),new Date("2018-12-09"),U1.QUARTO()),new n($localize`Tablut`,"Tablut",Yut,new S3e,d5.get(),new Date("2018-12-27"),U1.TABLUT()),new n($localize`Reversi`,"Reversi",j8t,new m3e,new Vm($1),new Date("2019-01-16"),U1.REVERSI()),new n($localize`Go`,"Go",jlt,new Uce,new P3(Os),new Date("2019-12-21"),U1.GO()),new n($localize`Encapsule`,"Encapsule",_lt,new zce,new Mc(Kl),new Date("2019-12-30"),U1.ENCAPSULE()),new n($localize`Siam`,"Siam",Put,new E3e,T1.get(),new Date("2020-01-11"),U1.SIAM()),new n($localize`Sahara`,"Sahara",out,new _3e,new E9(C2),new Date("2020-02-29"),U1.SAHARA()),new n($localize`Pylos`,"Pylos",s8t,new l3e,new No(Ac),new Date("2020-10-02"),U1.PYLOS()),new n($localize`Kamisado`,"Kamisado",H6t,new Zce,new wo(w3),new Date("2020-10-03"),U1.KAMISADO()),new n($localize`Quixo`,"Quixo",$8t,new p3e,new Ao(X0),new Date("2020-10-15"),U1.QUIXO()),new n($localize`Dvonn`,"Dvonn",ilt,new Lce,new p2(Va),new Date("2020-10-21"),U1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",Plt,new Vce,new j0(S3),new Date("2021-01-16"),U1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",klt,new Fce,new $n(Fa),new Date("2021-02-22"),U1.GIPF()),new n($localize`Coerceo`,"Coerceo",T4t,new Oce,new sP(P1),new Date("2021-03-21"),U1.COERCEO()),new n($localize`Six`,"Six",Dut,new M3e,new x3(F2),new Date("2021-04-08"),U1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",W6t,new Yce,new qi(js),new Date("2021-04-28"),U1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",G0t,new s3e,new b3(V2),new Date("2021-05-23"),U1.PENTAGO()),new n($localize`Abalone`,"Abalone",R3t,new Ece,new _3(Zl),new Date("2021-07-13"),U1.ABALONE()),new n($localize`Yinsh`,"Yinsh",E2,new A3e,new O3e(Ga),new Date("2021-07-31"),U1.YINSH()),new n($localize`Apagos`,"Apagos",U3t,new Mce,M4.get(),new Date("2021-11-04"),U1.APAGOS()),new n($localize`Diam`,"Diam",M3,new Ice,E3.get(),new Date("2021-11-30"),U1.DIAM()),new n($localize`Brandhub`,"Brandhub",c4t,new Tce,a5.get(),new Date("2021-12-07"),U1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",D4t,new Nce,Da.get(),new Date("2021-12-30"),U1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",wi,new Kce,Ti.get(),new Date("2022-06-24"),U1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",Oo,new e3e,new _9(Ns),new Date("2022-07-01"),U1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",I6t,new jce,f5.get(),new Date("2022-09-21"),U1.HNEFATAFL()),new n($localize`Hive`,"Hive",v6t,new Wce,_2.get(),new Date("2023-03-29"),U1.HIVE()),new n($localize`Trexo`,"Trexo",Sn,new w3e,B2.get(),new Date("2023-04-16"),U1.TREXO())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),bH=(()=>{class n{constructor(){this.games=w9.ALL_GAMES(),this.pickGame=new dr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mt({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"select",1),J("change",function(i){return r.onChange(i)}),b(2,"option",2),ge(3,3),O(),k(4,L5t,2,2,"option",4),O()()),2&e&&(S(4),T("ngForOf",r.games))},dependencies:[Dn,up,fp],encapsulation:2}),n})();function R5t(n,t){if(1&n){const e=Te();b(0,"div",26)(1,"div",27),J("click",function(){return ue(e),oe(v().closeInfo())}),O(),b(2,"div",28)(3,"header",29)(4,"p",30),St(5),O(),b(6,"button",31),J("click",function(){return ue(e),oe(v().closeInfo())}),O()(),b(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),O()(),b(12,"div",7)(13,"div",13),St(14),O()()(),b(15,"div",6)(16,"div",33)(17,"a",36),J("click",function(){ue(e);const s=v();return oe(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),St(19,"\xa0"),b(20,"span"),ge(21,38),O()()(),b(22,"div",33)(23,"a",36),J("click",function(){ue(e);const s=v();return oe(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),St(25,"\xa0"),b(26,"span"),ge(27,39),O()()(),b(28,"div",33)(29,"a",36),J("click",function(){ue(e);const s=v();return oe(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),St(31,"\xa0"),b(32,"span"),ge(33,40),O()()()()()()()}if(2&n){const e=v();S(5),a1(e.gameInfoDetails.get().name),S(6),We("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",Qc),S(3),zi(" ",e.gameInfoDetails.get().description," "),S(4),T("icon",e.iconOnlineGame),S(6),T("icon",e.iconLocalGame),S(6),T("icon",e.iconTutorial)}}function D5t(n,t){if(1&n){const e=Te();b(0,"div",8)(1,"div",9)(2,"p",10),St(3),O()(),b(4,"div",42)(5,"figure",34)(6,"img",43),J("click",function(){const i=ue(e).$implicit;return oe(v(2).openInfo(i))}),O(),b(7,"figcaption",44),J("click",function(){const i=ue(e).$implicit;return oe(v(2).openInfo(i))}),b(8,"div",45),St(9,"?"),O()(),b(10,"figcaption",46)(11,"a",47),J("click",function(){const i=ue(e).$implicit;return oe(v(2).createGame(i.urlName))}),X(12,"fa-icon",37),O(),b(13,"a",48),J("click",function(){const i=ue(e).$implicit;return oe(v(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),O(),b(15,"a",49),J("click",function(){const i=ue(e).$implicit;return oe(v(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),O()()()(),b(17,"div",50),St(18),O()()}if(2&n){const e=t.$implicit,r=v(2);S(3),a1(e.name),S(3),S1("id","image_",e.urlName,""),We("src","assets/images/",r.theme,"/",e.urlName,".png",Qc),S(5),S1("id","playOnline_",e.urlName,""),S(1),T("icon",r.iconOnlineGame),S(1),S1("id","playLocally_",e.urlName,""),S(1),T("icon",r.iconLocalGame),S(1),S1("id","startTutorial_",e.urlName,""),S(1),T("icon",r.iconTutorial),S(2),zi(" ",e.description," ")}}function z5t(n,t){if(1&n&&(b(0,"div",7),k(1,D5t,19,11,"div",41),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let V5t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.observedPartService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=Bie,this.iconLocalGame=jV,this.iconTutorial=Uae,this.gameInfoDetails=P.empty(),this.theme=i.getTheme();const o=w9.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return A(function*(){const s=r.observedPartService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return A(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=P.of(e)}closeInfo(){this.gameInfoDetails=P.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Nn),Q(Ci),Q(pS))},n.\u0275cmp=mt({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,C,w,I;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,g=$localize`Play offline`,m=$localize`Learn the rules`,C=$localize`Play online`,w=$localize`Play offline`,I=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,g,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",C,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",I,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(b(0,"section",0)(1,"div",1)(2,"p",2),ge(3,3),O(),b(4,"p",4),ac(5,5),X(6,"br"),cc(),O()(),b(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),ge(12,11),O()(),b(13,"div",12)(14,"div",13)(15,"button",14),J("click",function(){return r.createGame()}),ge(16,15),O(),b(17,"button",16),ge(18,17),O()()()()(),b(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),ge(23,18),O()(),b(24,"div",12)(25,"div",19)(26,"button",20),ge(27,21),O(),b(28,"button",22),ge(29,23),O()()()()()(),k(30,R5t,34,7,"div",24),b(31,"div",6),k(32,z5t,2,1,"div",25),O()()),2&e&&(S(30),T("ngIf",r.gameInfoDetails.isPresent()),S(2),T("ngForOf",r.games))},dependencies:[Dn,on,Op,r9],encapsulation:2}),n})();const H5t=["board"];let b9=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,n})(),DP=(()=>{class n{constructor(e,r,s,i,o){this.componentFactoryResolver=e,this.actRoute=r,this.connectedUserService=s,this.router=i,this.messageDisplayer=o,this.boardRef=null,this.players=[P.empty(),P.empty()],this.role=de.NONE,this.endGame=!1,this.Player=z,K(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return K(n.VERBOSE,"GameWrapper.getMatchingComponent"),P.ofNullable(w9.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return A(function*(){K(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.rules.setInitialBoard(),e.gameComponent.updateBoard()),r})()}getGameName(){return we.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return A(function*(){K(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",b9.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;ye(null!=e.boardRef,"Board element should be present");const i=e.componentFactoryResolver.resolveComponentFactory(s.get()),o=we.getNonNullable(e.boardRef).createComponent(i);return e.gameComponent=o.instance,e.gameComponent.chooseMove=(c,u,h)=>e.receiveValidMove(c,u,h),e.gameComponent.canUserPlay=c=>e.onUserClick(c),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=c=>{e.onCancelMove(c)},e.setRole(e.role),e.canPass=e.gameComponent.canPass,!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}receiveValidMove(e,r,s){var i=this;return A(function*(){if(K(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e,state:r,scores:s}}),!i.isPlayerTurn())return U.failure(b9.NOT_YOUR_TURN());if(i.endGame)return U.failure($localize`The game has ended.`);const c=i.gameComponent.rules.isLegal(e,r);return c.isFailure()?(i.gameComponent.cancelMove(c.getReason()),U.ofFallible(c)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(e,s),K(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),U.SUCCESS)})()}onUserClick(e){if(this.role===de.NONE){const r=b9.NO_CLONING_FEATURE();return U.failure(r)}return this.isPlayerTurn()?U.SUCCESS:U.failure(b9.NOT_YOUR_TURN())}onCancelMove(e){}isPlayerTurn(){if(this.role===de.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return K(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&vc(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ya),Q(go),Q(Ps),Q(jn),Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&s4(H5t,5,wa),2&e){let s;uc(s=fc())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const F5t=["board"];let B5t=(()=>{class n extends DP{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return A(function*(){setTimeout(A(function*(){yield e.afterViewInit(),e.gameComponent.rules.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.gameComponent.updateBoard(),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(we.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return A(function*(){})()}getPlayer(){return"no-player"}}return n.\u0275fac=function(e){return new(e||n)(Q(ya),Q(go),Q(Ps),Q(jn),Q(Nn),Q(nu))},n.\u0275cmp=mt({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&s4(F5t,5,wa),2&e){let s;uc(s=fc())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&X(0,"div",null,0)},encapsulation:2}),n})();function $5t(n,t){if(1&n&&(b(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),O()()),2&n){const e=v().$implicit;S(2),T("demoNodeInfo",e)}}function U5t(n,t){if(1&n&&(b(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),O()()),2&n){const e=v().$implicit;S(2),T("demoNodeInfo",e)}}function G5t(n,t){if(1&n&&(b(0,"div",12)(1,"div",13)(2,"p",14),St(3),O()(),k(4,$5t,3,1,"div",15),k(5,U5t,3,1,"ng-template",null,16,c1),O()),2&n){const e=t.$implicit,r=t1(6),s=v(2);S(3),a1(e.name),S(1),T("ngIf",s.squared.value)("ngIfElse",r)}}function W5t(n,t){if(1&n&&(b(0,"div",10),k(1,G5t,7,3,"div",11),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let q5t=(()=>{class n{constructor(){this.numberOfColumns=new ba(5),this.squared=new ba(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=w9.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const g of h){const m=this.getNodeFromStep(g,u);c.push(m)}for(const g of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:g.node,click:g.click}),i++,s=(s+1)%e}}getNodeFromStep(e,r){if(e.hasSolution()){const s=e.getSolution();if("string"==typeof s)return{node:new V1(e.state),click:P.of(s)};{const i=s;return{node:new V1(r.applyLegalMove(i,e.state,r.isLegal(i,e.state).get()),P.of(new V1(e.state)),P.of(i)),click:P.empty()}}}return{node:new V1(e.state),click:P.empty()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mt({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(b(0,"form")(1,"div",0)(2,"label",1),an(3),ge(4,2),cn(),b(5,"output"),St(6),O()(),b(7,"div",3),X(8,"input",4),O()(),b(9,"div",0)(10,"label",5),X(11,"input",6),St(12," \xa0"),an(13),ge(14,7),cn(),O()()(),b(15,"div",8),k(16,W5t,2,1,"div",9),O()),2&e&&(S(6),a1(r.numberOfColumns.value),S(2),T("formControl",r.numberOfColumns),S(3),T("formControl",r.squared),S(5),T("ngForOf",r.columns))},dependencies:[Dn,on,au,c4,Sy,UO,Cl,ou,nN,cp,B5t],encapsulation:2}),n})(),OH=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(ri))},n.\u0275dir=Ft({type:n,selectors:[["","autofocus",""]]}),n})(),I3e=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(ri))},n.\u0275dir=Ft({type:n,selectors:[["","toggleVisibility",""]]}),n})();function j5t(n,t){if(1&n&&(b(0,"div",29)(1,"div",30),ge(2,31),O(),b(3,"div",32),St(4),O()()),2&n){const e=v();S(4),a1(e.errorMessage)}}const Z5t=function(){return["/register"]},Y5t=function(){return["/reset-password"]};let K5t=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=PV,this.loginForm=new s0({email:new ba,password:new ba})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=A(function*(s){s!==n5.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return A(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return A(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return A(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Ps))},n.\u0275cmp=mt({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,C;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,g=$localize`Forgot your password?`,m=$localize`Reset your password`,C=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,g,m,["role","alert",1,"message","is-danger"],[1,"message-header"],C,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),ge(2,2),O(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ge(7,7),O()(),b(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),O()()()(),b(12,"div",4)(13,"div",5)(14,"label",12),ge(15,13),O()(),b(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),b(20,"span",16),X(21,"fa-icon",17),O()()()()(),b(22,"div",4),X(23,"div",5),b(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),J("click",function(){return r.loginWithEmail(r.loginForm.value)}),ge(28,19),O()()()()(),b(29,"div",4),X(30,"div",5),b(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),J("click",function(){return r.loginWithGoogle()}),ge(35,21),O()()()()(),k(36,j5t,5,1,"div",22),b(37,"p",23),an(38),ge(39,24),cn(),St(40,"\xa0 "),b(41,"a",25),ge(42,26),O()(),b(43,"p",23),an(44),ge(45,27),cn(),St(46,"\xa0 "),b(47,"a",25),ge(48,28),O()()()()),2&e&&(S(3),T("formGroup",r.loginForm),S(18),T("icon",r.faEye),S(6),T("disabled",!r.canLogin()),S(9),T("ngIf",r.errorMessage),S(5),T("routerLink",J1(6,Z5t)),S(6),T("routerLink",J1(7,Y5t)))},dependencies:[on,pu,au,c4,Cl,ou,uu,cu,Z7,r9,OH,I3e],encapsulation:2}),n})(),X5t=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new hS(u=>{r=r.concat(...u),e(r)},u=>{const h=r;for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)});r=h,e(r)},u=>{const h=[];for(const g of r)u.some(m=>m.id===g.id)||h.push(g);r=h,e(r)});return this.partDAO.observingWhere([["result","==",Ln.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(Le(cte))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Q5t=(()=>{class n{constructor(e){this.userDAO=e}subscribeToActiveUsers(e){K(n.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let r=[];const c=new hS(u=>{K(n.VERBOSE,"our DAO gave us "+u.length+" new user(s)"),r=this.sort(r.concat(...u)),e(r)},u=>{let h=r;K(n.VERBOSE,"our DAO updated "+u.length+" user(s)");for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)}),h=this.sort(h);r=h,e(r)},u=>{r=r.filter(h=>!u.some(g=>g.id===h.id)),e(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],c)}sort(e){return e.sort((r,s)=>{const i=we.getNonNullable(r.data).lastUpdateTime,o=we.getNonNullable(i).seconds,c=we.getNonNullable(s.data).lastUpdateTime;return o-we.getNonNullable(c).seconds})}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Le(uS))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),x3e=(()=>{class n{transform(e){return $U(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=e2({name:"firebaseDate",type:n,pure:!0}),n})();const J5t=["chatDiv"];function e7t(n,t){1&n&&(an(0),ge(1,5),cn())}function t7t(n,t){1&n&&ge(0,6),2&n&&(A1(v().unreadMessagesText),z1(0))}function n7t(n,t){if(1&n){const e=Te();b(0,"button",11),J("click",function(){return ue(e),oe(v(2).scrollToBottom())}),St(1),O()}if(2&n){const e=v(2);S(1),zi("",e.unreadMessagesText," \u2193")}}function r7t(n,t){if(1&n&&(b(0,"p"),St(1),lc(2,"firebaseDate"),b(3,"b",12),St(4),O(),b(5,"span",13),St(6),O()()),2&n){const e=t.$implicit;S(1),zi(" [",l3(2,3,e.postedTime),"] "),S(3),zi("",e.sender.name," : "),S(2),a1(e.content)}}function s7t(n,t){if(1&n){const e=Te();b(0,"div"),k(1,n7t,2,1,"button",7),b(2,"div",8,9),J("scroll",function(){return ue(e),oe(v().updateCurrentScrollPosition())}),k(4,r7t,7,5,"p",10),O()()}if(2&n){const e=v();S(1),T("ngIf",e.showUnreadMessagesButton),S(3),T("ngForOf",e.chat)}}const i7t=function(){return{standalone:!0}};function o7t(n,t){if(1&n){const e=Te();b(0,"form",14),J("onSubmit",function(){return ue(e),oe(v().sendMessage())}),b(1,"div",15)(2,"div",16)(3,"input",17,18),J("ngModelChange",function(s){return ue(e),oe(v().userMessage=s)}),O(),b(5,"p",19),St(6),O()(),b(7,"div",20)(8,"button",21),J("click",function(){return ue(e),oe(v().sendMessage())}),X(9,"fa-icon",22),O()()(),b(10,"div",23)(11,"p")(12,"strong"),ge(13,24),O()()()()}if(2&n){const e=t1(4),r=v();S(3),T("ngModel",r.userMessage)("ngModelOptions",J1(4,i7t)),S(3),zi("",e.value.length,"/128"),S(3),T("icon",r.faReply)}}let k3e=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=lV,this.isNearBottom=!0,this.notYetScrolled=!0,K(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){K(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),ye(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new hS(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return A(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(lS),Q(Ps))},n.\u0275cmp=mt({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&s4(J5t,5),2&e){let s;uc(s=fc())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(b(0,"div")(1,"button",0),J("click",function(){return r.switchChatVisibility()}),k(2,e7t,2,0,"ng-container",1),k(3,t7t,1,1,"ng-template",null,2,c1),O(),k(5,s7t,5,2,"div",3),k(6,o7t,14,5,"form",4),O()),2&e){const s=t1(4);S(2),T("ngIf",r.visible)("ngIfElse",s),S(3),T("ngIf",r.visible),S(1),T("ngIf",r.visible)}},dependencies:[Dn,on,au,c4,Cl,ou,oN,lp,cp,r9,x3e],encapsulation:2}),n})(),L3e=(()=>{class n{constructor(e,r,s){this.router=e,this.observedPartService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return A(function*(){const r=e.observedPartService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Ci),Q(Nn))},n.\u0275cmp=mt({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),J("click",function(){return r.navigateToOnlineGameCreation()}),ge(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[bH],encapsulation:2}),n})();function a7t(n,t){if(1&n&&(an(0),St(1),cn()),2&n){const e=v().$implicit;S(1),a1(e.data.playerOne.name)}}function c7t(n,t){1&n&&(an(0),ge(1,26),cn())}function l7t(n,t){if(1&n){const e=Te();b(0,"tr",22),J("click",function(){const i=ue(e).$implicit;return oe(v(2).joinGame(i))}),b(1,"td",23),St(2),O(),b(3,"td",23),St(4),O(),b(5,"td",23),k(6,a7t,2,1,"ng-container",24),k(7,c7t,2,0,"ng-template",null,25,c1),O(),b(9,"td",23),St(10),O()()}if(2&n){const e=t.$implicit,r=t.index,s=t1(8);S1("id","part_",r,""),S(2),a1(e.data.typeGame),S(2),a1(e.data.playerZero.name),S(2),T("ngIf",e.data.playerOne)("ngIfElse",s),S(4),a1(e.data.turn)}}function u7t(n,t){if(1&n&&(b(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),ge(6,17),O(),b(7,"th",16),ge(8,18),O(),b(9,"th",16),ge(10,19),O(),b(11,"th",16),ge(12,20),O()()(),b(13,"tbody"),k(14,l7t,11,6,"tr",21),O()()()()),2&n){const e=v();S(14),T("ngForOf",e.activeParts)}}function f7t(n,t){1&n&&(b(0,"div",27),X(1,"app-online-game-selection",28),O())}function h7t(n,t){if(1&n&&(b(0,"li",39),St(1),lc(2,"firebaseDate"),O()),2&n){const e=v().$implicit;Lb("id",e.data.username),S(1),RC("",e.data.username,": ",l3(2,3,e.data.lastUpdateTime),"")}}function d7t(n,t){if(1&n&&(an(0),k(1,h7t,3,5,"li",38),cn()),2&n){const e=t.$implicit;S(1),T("ngIf",e.data.lastUpdateTime)}}function p7t(n,t){if(1&n&&(b(0,"div",29)(1,"div",30)(2,"div",31),X(3,"app-chat",32),O()(),b(4,"div",33)(5,"div",34)(6,"p"),ge(7,35),O(),b(8,"ul",36),k(9,d7t,2,1,"ng-container",37),O()()()()),2&n){const e=v();S(3),T("turn",-1),S(6),T("ngForOf",e.activeUsers)}}let g7t=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.activeUsersService=i,this.observedPartService=o,this.activeUsers=[],this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){K(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.observedPartService.subscribeToObservedPart(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){K(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e){var r=this;return A(function*(){const s=e.id,i=e.data.typeGame,c=r.observedPartService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.observedPartService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Nn),Q(X5t),Q(Q5t),Q(Ci))},n.\u0275cmp=mt({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,h=$localize`Connected users:`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],h,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),J("click",function(){return r.selectTab("games")}),ge(4,3),O()(),b(5,"li",4)(6,"a",5),J("click",function(){return r.selectTab("create")}),ge(7,6),O()(),b(8,"li",7)(9,"a",8),J("click",function(){return r.selectTab("chat")}),ge(10,9),O()()()(),k(11,u7t,15,1,"div",10),k(12,f7t,2,0,"div",11),k(13,p7t,10,2,"div",12)),2&e&&(S(6),T("ngClass",r.createTabClasses),S(5),T("ngIf","games"===r.currentTab),S(1),T("ngIf","create"===r.currentTab),S(1),T("ngIf","chat"===r.currentTab))},dependencies:[En,Dn,on,k3e,L3e,x3e],encapsulation:2}),n})(),R3e=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(Q(go))},n.\u0275cmp=mt({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),ge(2,2),O(),b(3,"div",3),St(4),O()()),2&e&&(S(4),a1(r.message))},encapsulation:2}),n})();class O9{constructor(t,e,r){this.added=t,this.modified=e,this.removed=r}static from(t,e){const r=new O9({},{},{});if(null==t)return r.added={...e},r;if(null==e)return r.removed={...t},r;const s=Object.keys(t),i=Object.keys(e),o=s.filter(h=>!1===i.includes(h)),c=s.filter(h=>i.includes(h)),u=i.filter(h=>!1===s.includes(h));return r.addNewKeys(u,e),r.addCommonKeys(c,e,t),r.addRemovedKeys(o,t),r}static differs(t,e){return O9.from(t,e).countChanges()>0}addNewKeys(t,e){for(const r of t)null!=e[r]&&(this.added[r]=e[r])}addCommonKeys(t,e,r){for(const s of t)this.addCommonKey(s,r[s],e[s])}addCommonKey(t,e,r){if(null==r)null!=e&&(this.removed[t]=e);else if(null==e)this.added[t]=r;else if(["string","boolean","number"].includes(typeof e))e!==r&&(this.modified[t]=r);else if(Array.isArray(e)){if(!Array.isArray(r))throw new Error("Thing should not change type");e.length===r.length?this.addCommonKeyList(t,e,r):this.modified[t]=r}else{ye("object"==typeof e,`ObjectDifference: expected JSON, but got a ${typeof e} in ${t}`),ye("object"==typeof r,`ObjectDifference: expected JSON, but got a ${typeof r} in ${t}`);const o=O9.from(e,r);o.countChanges()>0&&(this.modified[t]=o)}}addCommonKeyList(t,e,r){let s=!0;for(let i=0;s&&i<e.length;i++)typeof e[i]==typeof r[i]&&"object"==typeof e[i]?O9.differs(e[i],r[i])&&(s=!1,this.modified[t]=r):e[i]!==r[i]&&(s=!1,this.modified[t]=r)}addRemovedKeys(t,e){for(const r of t)this.removed[r]=e[r]}countChanges(){const t=Object.keys(this.removed).length,e=Object.keys(this.modified).length;return Object.keys(this.added).length+e+t}isPresent(t){return null!=this.added[t]?{state:"added",present:!0}:null!=this.modified[t]?{state:"modified",present:!0}:null!=this.removed[t]?{state:"removed",present:!0}:{state:null,present:!1}}isFullyCreated(){return 0===Object.keys(this.modified).length&&0===Object.keys(this.removed).length}addedOrModified(t){const e=this.isPresent(t);return!0===e.present&&"removed"!==e.state}}function D3e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function z3e(n,t){return D3e(t)-D3e(n)}function Hm(n){return hr((t,e)=>{xo(n).subscribe(rs(e,()=>e.complete(),Qi)),!e.closed&&t.subscribe(e)})}let m7t=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=e2({name:"humanDuration",type:n,pure:!0}),n})();function _7t(n,t){if(1&n&&(an(0),St(1),cn()),2&n){const e=v(3);S(1),a1(e.viewInfo.chosenOpponent)}}function v7t(n,t){1&n&&ge(0,44)}function C7t(n,t){if(1&n&&(b(0,"div",45)(1,"div",8)(2,"label",46),an(3),ge(4,47),cn(),b(5,"output"),St(6),lc(7,"humanDuration"),O()(),b(8,"div",37),X(9,"input",48),O()(),b(10,"div",8)(11,"label",49),ac(12,50),X(13,"output"),lc(14,"humanDuration"),cc(),O(),b(15,"div",37),X(16,"input",51),O()()()),2&n){const e=v(3);S(6),a1(l3(7,2,e.viewInfo.maximalMoveDuration||0)),S(8),A1(l3(14,4,e.viewInfo.totalPartDuration||0)),z1(12)}}function y7t(n,t){1&n&&(b(0,"div"),ac(1,52),X(2,"br"),cc(),O())}function E7t(n,t){1&n&&(b(0,"button",64),ge(1,65),O())}function M7t(n,t){if(1&n){const e=Te();b(0,"tr",60),J("click",function(){const i=ue(e).$implicit;return oe(v(4).selectOpponent(i))}),b(1,"td",61),St(2),O(),b(3,"td",62),k(4,E7t,2,0,"button",63),O()()}if(2&n){const e=t.$implicit,r=v(4);S1("id","presenceOf_",e,""),T("ngClass",r.viewInfo.candidateClasses[e]),S(1),T("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),S(1),a1(e),S(2),T("ngIf",r.viewInfo.chosenOpponent!==e)}}function S7t(n,t){if(1&n&&(an(0),ge(1,53),cn(),b(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),ge(7,57),O(),b(8,"th",56),ge(9,58),O()()(),b(10,"tbody"),k(11,M7t,5,5,"tr",59),O()()()),2&n){const e=v(3);S(11),T("ngForOf",e.viewInfo.candidates)}}function P7t(n,t){if(1&n){const e=Te();b(0,"button",66),J("click",function(){return ue(e),oe(v(3).changeConfig())}),ge(1,67),O()}}function T7t(n,t){if(1&n){const e=Te();b(0,"div")(1,"h1",4),ge(2,5),O(),b(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),ge(7,10),O(),b(8,"div",11)(9,"button",12),J("click",function(){return ue(e),oe(v(2).selectFirstPlayer("RANDOM"))}),ge(10,13),O(),b(11,"button",14),J("click",function(){return ue(e),oe(v(2).selectFirstPlayer("CREATOR"))}),ge(12,15),O(),b(13,"button",16),J("click",function(){return ue(e),oe(v(2).selectFirstPlayer("CHOSEN_PLAYER"))}),k(14,_7t,2,1,"ng-container",17),k(15,v7t,1,0,"ng-template",null,18,c1),O()()(),b(17,"div",8)(18,"label",9),ge(19,19),O(),b(20,"div",11)(21,"div",20),J("click",function(){return ue(e),oe(v(2).selectPartType("STANDARD"))}),b(22,"div",21)(23,"span"),ge(24,22),O()(),b(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),an(29),ge(30,26),cn(),b(31,"strong"),St(32),lc(33,"humanDuration"),O(),X(34,"br"),an(35),ac(36,27),X(37,"strong"),lc(38,"humanDuration"),cc(),cn(),O()()()()(),b(39,"div",28),J("click",function(){return ue(e),oe(v(2).selectPartType("BLITZ"))}),b(40,"div",21)(41,"span"),ge(42,29),O()(),b(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),an(47),ge(48,30),cn(),b(49,"strong"),St(50),lc(51,"humanDuration"),O(),X(52,"br"),an(53),ac(54,31),X(55,"strong"),lc(56,"humanDuration"),cc(),cn(),O()()()()(),b(57,"button",32),J("click",function(){return ue(e),oe(v(2).selectPartType("CUSTOM"))}),ge(58,33),O()()(),k(59,C7t,17,6,"div",34),b(60,"div",8)(61,"label",35),ge(62,36),O(),b(63,"div",37),k(64,y7t,3,0,"div",17),k(65,S7t,12,1,"ng-template",null,38,c1),O()()(),b(67,"div",8)(68,"div",11)(69,"button",39),J("click",function(){return ue(e),oe(v(2).proposeConfig())}),ge(70,40),O(),k(71,P7t,2,0,"button",41),b(72,"button",42),J("click",function(){return ue(e),oe(v(2).cancelGameCreation())}),ge(73,43),O()()()()()}if(2&n){const e=t1(16),r=t1(66),s=v(2);S(3),T("formGroup",s.configFormGroup),S(1),T("disabled",!s.viewInfo.canEditConfig),S(5),T("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),S(2),T("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),S(2),T("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),S(1),T("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),S(7),T("ngClass",s.viewInfo.partTypeClasses.STANDARD),S(11),a1(l3(33,19,s.partType.NORMAL_MOVE_DURATION)),S(6),A1(l3(38,21,s.partType.NORMAL_PART_DURATION)),z1(36),S(1),T("ngClass",s.viewInfo.partTypeClasses.BLITZ),S(11),a1(l3(51,23,s.partType.BLITZ_MOVE_DURATION)),S(6),A1(l3(56,25,s.partType.BLITZ_PART_DURATION)),z1(54),S(1),T("ngClass",s.viewInfo.partTypeClasses.CUSTOM),S(2),T("ngIf",s.viewInfo.showCustomTime),S(5),T("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),S(5),T("disabled",!s.viewInfo.canProposeConfig),S(2),T("ngIf",s.viewInfo.canReviewConfig)}}function w7t(n,t){if(1&n&&(b(0,"div",74)(1,"p"),ac(2,75),X(3,"br"),cc(),O()()),2&n){const e=v(3);S(3),A1(e.viewInfo.creator),z1(2)}}function b7t(n,t){if(1&n&&(b(0,"span"),ge(1,81),O()),2&n){const e=v(4);S(1),A1(e.viewInfo.creator),z1(1)}}function O7t(n,t){1&n&&(b(0,"span"),ge(1,82),O())}function N7t(n,t){1&n&&(b(0,"span"),ge(1,83),O())}function A7t(n,t){if(1&n){const e=Te();b(0,"div",74)(1,"p"),ge(2,76),O(),b(3,"ul")(4,"li"),k(5,b7t,2,1,"span",2),k(6,O7t,2,0,"span",2),k(7,N7t,2,0,"span",2),O(),b(8,"li"),ac(9,77),X(10,"strong"),lc(11,"humanDuration"),cc(),O(),b(12,"li"),ac(13,78),X(14,"strong"),lc(15,"humanDuration"),cc(),O()(),b(16,"button",79),J("click",function(){return ue(e),oe(v(3).acceptConfig())}),ge(17,80),O()()}if(2&n){const e=v(3);S(2),A1(e.viewInfo.creator)(e.viewInfo.partTypeName),z1(2),S(3),T("ngIf","CREATOR"===e.viewInfo.firstPlayer),S(1),T("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),S(1),T("ngIf","RANDOM"===e.viewInfo.firstPlayer),S(4),A1(l3(11,7,e.viewInfo.maximalMoveDuration||0)),z1(9),S(4),A1(l3(15,9,e.viewInfo.totalPartDuration||0)),z1(13)}}function I7t(n,t){if(1&n&&(b(0,"div")(1,"div",68)(2,"div",69)(3,"p"),ge(4,70),O()(),b(5,"div",71),k(6,w7t,4,1,"div",72),k(7,A7t,18,11,"ng-template",null,73,c1),O()()()),2&n){const e=t1(8),r=v(2);S(6),T("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function x7t(n,t){if(1&n&&(an(0),ge(1,86),cn()),2&n){const e=v(3);S(1),A1(e.viewInfo.creator),z1(1)}}function k7t(n,t){if(1&n&&ge(0,87),2&n){const e=v(3);A1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),z1(0)}}function L7t(n,t){if(1&n&&(b(0,"div",68)(1,"div",69)(2,"p"),ge(3,84),O()(),b(4,"div",71)(5,"p"),k(6,x7t,2,1,"ng-container",17),k(7,k7t,1,2,"ng-template",null,85,c1),O()()()),2&n){const e=t1(8),r=v(2);S(6),T("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function R7t(n,t){if(1&n&&(b(0,"div",1),k(1,T7t,74,27,"div",2),k(2,I7t,9,2,"div",2),k(3,L7t,9,2,"div",3),O()),2&n){const e=v();S(1),T("ngIf",e.viewInfo.userIsCreator),S(1),T("ngIf",e.viewInfo.userIsChosenOpponent),S(1),T("ngIf",e.viewInfo.userIsObserver)}}class u1{constructor(t,e,r,s,i,o,c,u,h,g){this.router=t,this.actRoute=e,this.connectedUserService=r,this.observedPartService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=g,this.partType=Pr,this.gameStartNotification=new dr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new Ai,this.allUserInterval=P.empty(),this.ownTokenInterval=P.empty(),this.selfSubscription=new G1,this.configRoomSubscription=new G1,this.candidatesSubscription=new G1,this.allDocDeleted=!1,K(u1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return A(function*(){K(u1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),K(u1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;ye(t.isPresent(),"PartCreationComponent should not be called without connected user"),ye(t.get()!==n5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),ye(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[$s.RANDOM.value,rp.required],maximalMoveDuration:[Pr.NORMAL_MOVE_DURATION,rp.required],partType:["STANDARD",rp.required],totalPartDuration:[Pr.NORMAL_PART_DURATION,rp.required],chosenOpponent:["",rp.required]})}updateUserDocWithObservedPart(t){K(u1.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:we.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.observedPartService.updateObservedPart(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:we.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=A(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=A(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return we.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Hm(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=we.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==Us.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(Hm(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(Hm(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(Hm(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(Hm(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=we.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===Us.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==Us.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==Us.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(Pr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Pr.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(Pr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Pr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return A(function*(){K(u1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.observedPartService.updateObservedPart({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return we.getNonNullable(e)}changeConfig(){var t=this;return A(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return A(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,Pr.of(r),s,$s.of(i),o)})()}cancelGameCreation(){var t=this;return A(function*(){t.allDocDeleted=!0,yield t.observedPartService.removeObservedPart(),K(u1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),K(u1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),K(u1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),K(u1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return A(function*(){if(K(u1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return K(u1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=we.getNonNullable(e.currentConfigRoom),o=we.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.observedPartService.updateObservedPart({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithObservedPart(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(ye(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithObservedPart(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(K(u1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return A(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return A(function*(){K(u1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return ye(null!=t,"configRoom should not be null (isGameStarted)"),we.getNonNullable(t).partStatus===Us.PART_STARTED.value}onGameStarted(){const t=we.getNonNullable(this.currentConfigRoom);K(u1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,K(u1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return A(function*(){const e=we.getNonNullable(t.currentConfigRoom);K(u1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),ye(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=P.of(window.setInterval(A(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),u1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return A(function*(){const r=we.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return A(function*(){ye(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),ye(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return A(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return A(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(Ss.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):z3e(s.get(),e)>u1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return A(function*(){const r=we.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return A(function*(){yield t.connectedUserService.sendPresenceToken(),ye(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=P.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},u1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUser(e,r=>{ye(r.isPresent(),"connected user should exist");const s=r.get();null!=s.lastUpdateTime&&(t.lastToken=s.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=P.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return K(u1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,we.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return A(function*(){K(u1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded();const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?K(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?K(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(K(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(K(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.observedPartService.removeObservedPart(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function D7t(n,t){if(1&n){const e=Te();b(0,"button",3),J("click",function(){return ue(e),oe(v().addTime())}),ge(1,4),O()}if(2&n){const e=v();S(1),A1(e.timeToAdd),z1(1)}}u1.VERBOSE=!1,u1.TOKEN_INTERVAL=5e3,u1.TOKEN_TIMEOUT=2*u1.TOKEN_INTERVAL,u1.\u0275fac=function(t){return new(t||u1)(Q(jn),Q(go),Q(Ps),Q(Ci),Q(dS),Q(Az),Q(lS),Q(nm),Q(W5e),Q(Nn))},u1.\u0275cmp=mt({type:u1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,h,g,m,C,w,I,H,Y,ee,_e,te,Ae,Fe,Ze,zt,k1,w1,es,Lc,Io,Ni,Zn,o6,yt,Bt,Zt,s1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,g=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,C=$localize`Opponents`,w=$localize`Propose configuration`,I=$localize`Cancel game`,H=$localize`The opponent`,Y=$localize`Maximal turn duration: `,ee=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,_e=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,te=$localize`Click on the opponent against which you would like to play.`,Ae=$localize`Name`,Fe=$localize`Actions`,Ze=$localize`Pick`,zt=$localize`Change configuration`,k1=$localize`Configuration proposal`,w1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,es=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,Lc=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Io=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,Ni=$localize`Accept and start`,Zn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,o6=$localize`you play first`,yt=$localize`the first player is selected randomly`,Bt=$localize`One moment...`,Zt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,s1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,g,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],C,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],w,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],I,H,["id","customTime"],["for","maximalMoveDuration",1,"label"],Y,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],ee,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],_e,te,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],Ae,Fe,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],Ze,["id","reviewConfig",1,"button",3,"click"],zt,[1,"message","is-primary"],[1,"message-header"],k1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],w1,es,Lc,Io,["id","acceptConfig",1,"button","is-primary",3,"click"],Ni,Zn,o6,yt,Bt,["proposalSent",""],Zt,s1]},template:function(t,e){1&t&&k(0,R7t,4,3,"div",0),2&t&&T("ngIf",e.viewInfo)},dependencies:[En,Dn,on,au,c4,Sy,Cl,ou,cu,Z7,m7t],encapsulation:2});let z7t=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new dr,this.addTimeToOpponent=new dr,this.cssClasses=n.SAFE_TIME}ngOnInit(){K(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){K(n.VERBOSE,this.debugName+".set("+e+"ms)"),we.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){let r=!1;!1===this.isPaused&&(this.pause(),r=!0),this.remainingMs=e,this.displayDuration(),r&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){K(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),we.assert(this.isSet,"Should not start a chrono that has not been set!"),we.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){K(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),we.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){K(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){K(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),we.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),we.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){K(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),we.assert(this.started,"Should only stop chrono that are started!"),this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){K(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mt({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),St(2),lc(3,"number"),O(),k(4,D7t,2,1,"button",2),O()),2&e&&(T("ngClass",r.getTimeClass()),S(2),RC("",r.displayedMinute,":",A$(3,4,r.displayedSec,"2.0-0"),""),S(2),T("ngIf",r.canAddTime))},dependencies:[En,on,nG],encapsulation:2}),n})();const V7t=["partCreation"],H7t=["chatComponent"],F7t=["chronoZeroGlobal"],B7t=["chronoOneGlobal"],$7t=["chronoZeroTurn"],U7t=["chronoOneTurn"];function G7t(n,t){if(1&n){const e=Te();b(0,"app-part-creation",5,6),J("gameStartNotification",function(s){return ue(e),oe(v().startGame(s))}),O()}2&n&&T("partId",v().currentPartId)}function W7t(n,t){1&n&&(an(0),b(1,"span",41),ge(2,42),O(),cn())}function q7t(n,t){if(1&n&&(b(0,"span",43),ge(1,44),O()),2&n){const e=v(4);S(1),A1(null==e.currentPlayer?null:e.currentPlayer.name),z1(1)}}function j7t(n,t){if(1&n&&(b(0,"p",38),k(1,W7t,3,0,"ng-container",39),k(2,q7t,2,1,"ng-template",null,40,c1),O()),2&n){const e=t1(3),r=v(3);S(1),T("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function Z7t(n,t){if(1&n&&(b(0,"div",34)(1,"p",35),ge(2,36),O(),k(3,j7t,4,2,"p",37),O()),2&n){const e=v(2);S(2),A1(e.currentPart.getTurn()+1),z1(2),S(1),T("ngIf",!1===e.endGame)}}function Y7t(n,t){if(1&n&&(b(0,"p",45),St(1),O()),2&n){const e=v(2);T("ngClass",e.getPlayerNameClass(e.Player.ZERO)),S(1),a1(e.players[0].get().name)}}function K7t(n,t){if(1&n&&(b(0,"p",46),ge(1,47),O()),2&n){const e=v(2);S(1),A1(e.gameComponent.scores.get()[0]),z1(1)}}function X7t(n,t){if(1&n&&(b(0,"p",48),St(1),O()),2&n){const e=v(2);T("ngClass",e.getPlayerNameClass(e.Player.ONE)),S(1),a1(e.players[1].get().name)}}function Q7t(n,t){if(1&n&&(b(0,"p",49),ge(1,50),O()),2&n){const e=v(2);S(1),A1(e.gameComponent.scores.get()[1]),z1(1)}}function J7t(n,t){if(1&n){const e=Te();b(0,"button",59),J("click",function(){return ue(e),oe(v(3).resign())}),ge(1,60),O()}}function eft(n,t){if(1&n){const e=Te();b(0,"button",61),J("click",function(){return ue(e),oe(v(3).proposeDraw())}),ge(1,62),O()}}function tft(n,t){if(1&n){const e=Te();b(0,"button",63),J("click",function(){return ue(e),oe(v(3).acceptDraw())}),ge(1,64),O()}}function nft(n,t){if(1&n){const e=Te();b(0,"button",65),J("click",function(){return ue(e),oe(v(3).refuseDraw())}),ge(1,66),O()}}function rft(n,t){if(1&n){const e=Te();b(0,"button",67),J("click",function(){return ue(e),oe(v(3).gameComponent.pass())}),ge(1,68),O()}}function sft(n,t){if(1&n){const e=Te();b(0,"button",69),J("click",function(){return ue(e),oe(v(3).acceptTakeBack())}),ge(1,70),O()}}function ift(n,t){if(1&n){const e=Te();b(0,"button",71),J("click",function(){return ue(e),oe(v(3).refuseTakeBack())}),ge(1,72),O()}}function oft(n,t){if(1&n){const e=Te();b(0,"button",73),J("click",function(){return ue(e),oe(v(3).askTakeBack())}),ge(1,74),O()}}function aft(n,t){if(1&n&&(an(0),k(1,J7t,2,0,"button",51),k(2,eft,2,0,"button",52),k(3,tft,2,0,"button",53),k(4,nft,2,0,"button",54),k(5,rft,2,0,"button",55),k(6,sft,2,0,"button",56),k(7,ift,2,0,"button",57),k(8,oft,2,0,"button",58),cn()),2&n){const e=v(2);S(1),T("ngIf",e.canResign()),S(1),T("ngIf",e.canProposeDraw()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),S(1),T("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),S(1),T("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function cft(n,t){1&n&&(b(0,"div")(1,"p",76),ge(2,77),O()())}function lft(n,t){1&n&&(b(0,"p",81),ge(1,82),O())}function uft(n,t){1&n&&(b(0,"p",83),ge(1,84),O())}function fft(n,t){1&n&&(b(0,"p",85),ge(1,86),O())}function hft(n,t){if(1&n&&(b(0,"div"),k(1,lft,2,0,"p",78),k(2,uft,2,0,"p",79),k(3,fft,2,0,"p",80),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function dft(n,t){1&n&&(b(0,"p",90),ge(1,91),O())}function pft(n,t){1&n&&(b(0,"p",92),ge(1,93),O())}function gft(n,t){if(1&n&&(b(0,"p",94),ge(1,95),O()),2&n){const e=v(4);S(1),A1(e.currentPart.getWinner().get().name),z1(1)}}function mft(n,t){if(1&n&&(b(0,"div"),k(1,dft,2,0,"p",87),k(2,pft,2,0,"p",88),k(3,gft,2,1,"p",89),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function _ft(n,t){if(1&n&&(b(0,"p",90),ge(1,96),O()),2&n){const e=v(4);S(1),A1(e.currentPart.getLoser().get().name),z1(1)}}function vft(n,t){1&n&&(b(0,"p",94),ge(1,97),O())}function Cft(n,t){if(1&n&&(b(0,"p",94),ge(1,98),O()),2&n){const e=v(4);S(1),A1(e.currentPart.getLoser().get().name),z1(1)}}function yft(n,t){if(1&n&&(b(0,"div"),k(1,_ft,2,1,"p",87),k(2,vft,2,0,"p",89),k(3,Cft,2,1,"p",89),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function Eft(n,t){1&n&&(b(0,"p",100),ge(1,101),O())}function Mft(n,t){if(1&n&&(b(0,"p",100),ge(1,102),O()),2&n){const e=v(4);S(1),A1(e.currentPart.getLoser().get().name),z1(1)}}function Sft(n,t){if(1&n&&(b(0,"div"),k(1,Eft,2,0,"p",99),k(2,Mft,2,1,"p",99),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function Pft(n,t){if(1&n&&(b(0,"div",75),X(1,"hr"),k(2,cft,3,0,"div",26),k(3,hft,4,3,"div",26),k(4,mft,4,3,"div",26),k(5,yft,4,3,"div",26),k(6,Sft,3,2,"div",26),O()),2&n){const e=v(2);S(2),T("ngIf",e.currentPart.isHardDraw()),S(1),T("ngIf",e.currentPart.isAgreedDraw()),S(1),T("ngIf",e.currentPart.isWin()),S(1),T("ngIf",e.currentPart.isTimeout()),S(1),T("ngIf",e.currentPart.isResign())}}function Tft(n,t){1&n&&(b(0,"button",103),ge(1,104),O())}function wft(n,t){if(1&n){const e=Te();b(0,"button",105),J("click",function(){return ue(e),oe(v(2).proposeRematch())}),ge(1,106),O()}}function bft(n,t){if(1&n){const e=Te();b(0,"button",107),J("click",function(){return ue(e),oe(v(2).acceptRematch())}),ge(1,108),O()}}function Oft(n,t){if(1&n){const e=Te();b(0,"div",7)(1,"div",8)(2,"div",9),k(3,Z7t,4,2,"div",10),b(4,"div",11),k(5,Y7t,2,2,"p",12),k(6,K7t,2,1,"p",13),b(7,"app-count-down",14,15),J("outOfTimeAction",function(){ue(e);const s=v();return oe(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return ue(e),oe(v().addGlobalTime())}),O(),b(9,"app-count-down",16,17),J("outOfTimeAction",function(){ue(e);const s=v();return oe(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return ue(e),oe(v().addTurnTime())}),O()(),b(11,"p",18),ge(12,19),O(),b(13,"div",11),k(14,X7t,2,2,"p",20),k(15,Q7t,2,1,"p",21),b(16,"app-count-down",22,23),J("outOfTimeAction",function(){ue(e);const s=v();return oe(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return ue(e),oe(v().addGlobalTime())}),O(),b(18,"app-count-down",24,25),J("outOfTimeAction",function(){ue(e);const s=v();return oe(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return ue(e),oe(v().addTurnTime())}),O()(),X(20,"hr"),k(21,aft,9,8,"ng-container",26),k(22,Pft,7,5,"div",27),k(23,Tft,2,0,"button",28),k(24,wft,2,0,"button",29),k(25,bft,2,0,"button",30),O()(),b(26,"div",31)(27,"div",32),X(28,"div",null,33),O()()()}if(2&n){const e=v();S(3),T("ngIf",null!==e.currentPart),S(2),T("ngIf",e.players[0].isPresent()),S(1),T("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),S(1),T("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),S(2),T("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),S(5),T("ngIf",e.players[1].isPresent()),S(1),T("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),S(1),T("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),S(2),T("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),S(3),T("ngIf",e.isPlaying()),S(1),T("ngIf",e.endGame&&null!==e.currentPart),S(1),T("ngIf",e.endGame),S(1),T("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),S(1),T("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),S(1),T("ngClass",e.getBoardHighlight())}}let Nft=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})();class Un{constructor(t){this.value=t}}Un.PRE_START_DOC=new Un("PRE_START_DOC"),Un.STARTING_DOC=new Un("STARTING_DOC"),Un.DUPLICATE=new Un("DUPLICATE"),Un.MOVE_WITHOUT_TIME=new Un("MOVE_WITHOUT_TIME"),Un.MOVE=new Un("MOVE"),Un.REQUEST=new Un("REQUEST"),Un.END_GAME=new Un("END_GAME"),Un.END_GAME_WITHOUT_TIME=new Un("END_GAME_WITHOUT_TIME"),Un.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Un("ACCEPT_TAKE_BACK_WITHOUT_TIME");let Aft=(()=>{class n extends DP{constructor(e,r,s,i,o,c,u,h){super(e,r,s,i,o),this.observedPartService=c,this.userService=u,this.gameService=h,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.userLinkedToThisPart=!0,this.observedPart=P.empty(),this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new G1,this.partSubscription=new G1,this.observedPartSubscription=new G1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.onCurrentUpdateOngoing=!1,K(n.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return we.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return we.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.role===e}redirectIfPartOrGameIsInvalid(){var e=this;return A(function*(){const r=e.extractGameNameFromURL();if(w9.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=Nft.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=b9.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=A(function*(s){s instanceof f0&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var r=A(function*(s){yield e.onObservedPartUpdate(s)});return function(s){return r.apply(this,arguments)}}()),K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onObservedPartUpdate(e){var r=this;return A(function*(){if(K(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.observedPart=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.observedPart=P.empty()})()}getObservedPart(){return this.observedPart}startGame(e){var r=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),ye(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(A(function*(){ye(yield r.afterViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),r.startPart()}),2)})()}startPart(){var e=this;K(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var r=A(function*(s){ye(s.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield e.onCurrentPartUpdate(s.get())});return function(s){return r.apply(this,arguments)}}())}onCurrentPartUpdate(e,r=5){var s=this;return A(function*(){const i=new fS(s.currentPartId,e);if(K(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:s.currentPart,then:e,before_part_turn:i.data.turn,before_state_turn:s.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),s.onCurrentUpdateOngoing)return ye((r-=1)>0,"Update took more than 5sec to be handled by the component!"),void window.setTimeout(A(function*(){yield s.onCurrentPartUpdate(e,r)}),1e3);s.onCurrentUpdateOngoing=!0;const o=s.getUpdateTypes(i),c=e.turn;o.includes(Un.REQUEST)?K(n.VERBOSE,"UpdateType: Request("+we.getNonNullable(i.data.request).code+") ("+c+")"):K(n.VERBOSE,"UpdateType: "+o.map(h=>h.value)+"("+c+")");const u=s.currentPart;s.currentPart=i;for(const h of o)yield s.applyUpdate(h,i,u);s.onCurrentUpdateOngoing=!1})()}applyUpdate(e,r,s){var i=this;return A(function*(){switch(e){case Un.REQUEST:return yield i.onRequest(we.getNonNullable(r.data.request),s);case Un.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(i.currentPart=s);case Un.DUPLICATE:return;case Un.END_GAME_WITHOUT_TIME:return void(i.currentPart=s);case Un.END_GAME:return i.applyEndGame();case Un.MOVE_WITHOUT_TIME:const o=we.getNonNullable(i.currentPart),c=we.getNonNullable(s);return void(o.data={...o.data,turn:o.data.turn-1,lastUpdate:c.data.lastUpdate,lastUpdateTime:c.data.lastUpdateTime,listMoves:o.data.listMoves.slice(0,o.data.listMoves.length-1)});case Un.MOVE:return i.msToSubstract=i.getLastUpdateTime(s,r),i.doNewMoves(r);case Un.PRE_START_DOC:return;default:return ye(e===Un.STARTING_DOC,"Unexpected update type "+e),i.startCountDown(r)}})()}startCountDown(e){var r=this;return A(function*(){r.setChronos(),yield r.setPlayersDatas(e),r.startCountDownFor(0===e.data.listMoves.length?z.ZERO:z.fromTurn(e.data.turn-1))})()}getUpdateTypes(e){const r=null!=this.currentPart?this.currentPart.data:null,s=O9.from(r,e.data),i=[];if(K(n.VERBOSE,{currentPartDoc:r,update:e,diff:s}),0===s.countChanges()&&i.push(Un.DUPLICATE),s.isFullyCreated()&&s.isPresent("beginning").present&&i.push(Un.STARTING_DOC),e.data.request){const c=null!=s.removed.lastUpdateTime;i.push("TakeBackAccepted"===e.data.request.code&&c?Un.ACCEPT_TAKE_BACK_WITHOUT_TIME:Un.REQUEST)}if(null==r?"added"===s.isPresent("listMoves").state&&e.data.turn>0&&i.push(this.getMoveUpdateType(e,s)):this.turnHasIncreased(r.turn,e.data.turn,e.data.listMoves)&&i.push(this.getMoveUpdateType(e,s)),null==e.data.beginning&&i.push(Un.PRE_START_DOC),s.isPresent("result").present&&e.data.result!==Ln.UNACHIEVED.value){const c=null!=s.modified.turn,u=!1===s.addedOrModified("lastUpdateTime");i.push(c&&u?Un.END_GAME_WITHOUT_TIME:Un.END_GAME)}return i}getMoveUpdateType(e,r){return 1===e.data.turn?null==e.data.lastUpdateTime?Un.MOVE_WITHOUT_TIME:Un.MOVE:null==r.modified.lastUpdateTime&&null==r.added.lastUpdateTime?Un.MOVE_WITHOUT_TIME:Un.MOVE}turnHasIncreased(e,r,s){return ye(s.length===r,"ListMoves size and newTurn do not match, it is impossible!"),e<r}getLastUpdateTime(e,r){if(null==e)return[0,0];const s=this.getMoreRecentTime(e),i=this.getMoreRecentTime(r);ye(null!=s,"oldTime should not be null"),ye(null!=i,"updateTime should not be null");const o=z.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(we.getNonNullable(s),we.getNonNullable(i),o)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,r,s){const i=z3e(e,r),o=[0,0];return o[s.value]=i,o}setChronos(){K(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(e){K(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"+JSON.stringify(e)),this.switchPlayer();const r=Ye.copyImmutableArray(e.data.listMoves),s=this.gameComponent.rules;for(;this.gameComponent.getTurn()<r.length;){const i=this.gameComponent.getTurn(),o=this.gameComponent.encoder.decode(r[i]),c=s.isLegal(o,this.gameComponent.getState()),u="We received an incorrect db move: "+o.toString()+" in "+r+" at turn "+i+'because "'+c.getReasonOr("")+'"';ye(c.isSuccess(),u),s.choose(o)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}switchPlayer(){K(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const e=we.getNonNullable(this.currentPart),r=z.fromTurn(e.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();const s=r.getOpponent();this.pauseCountDownsFor(s),this.didUserPlay(r)?(K(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(r)):this.startCountDownFor(r)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){var e=this;return A(function*(){yield e.observedPartService.removeObservedPart();const r=we.getNonNullable(e.currentPart),s=z.fromTurn(r.data.turn);if(e.endGame=!0,!1===[Ln.VICTORY,Ln.HARD_DRAW].some(c=>c.value===r.data.result)){ye(!0===[Ln.RESIGN,Ln.TIMEOUT,Ln.HARD_DRAW,Ln.AGREED_DRAW_BY_ZERO,Ln.AGREED_DRAW_BY_ONE].some(g=>g.value===r.data.result),"Unknown type of end game ("+r.data.result+")");const h="endGame is true and winner is "+r.getWinner().getOrElse({id:"fake",name:"no one"}).name;K(n.VERBOSE,h)}e.stopCountdownsFor(s)})()}notifyDraw(e,r){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!0)}notifyTimeoutVictory(e,r,s,i){var o=this;return A(function*(){o.endGame=!0;const c=we.getNonNullable(o.currentPart).setWinnerAndLoser(e,i);o.currentPart=c,yield o.gameService.notifyTimeout(o.currentPartId,r,s,e,i)})()}notifyVictory(e,r){K(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const s=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node),i=we.getNonNullable(this.currentPart),o=this.players[0].get(),c=this.players[1].get();return s===Ie.ONE_WON?this.currentPart=i.setWinnerAndLoser(c,o):(ye(s===Ie.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=i.setWinnerAndLoser(o,c)),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){ye(this.isPlaying(),"Non playing should not call canAskTakeBack"),ye(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet");const e=we.getNonNullable(this.currentPart);return!(e.data.turn<=this.role.value||e.data.request&&"TakeBackRefused"===e.data.request.code&&this.role.isPlayer()&&e.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===de.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&e!==this.role}getTakeBackRequester(){const r=we.getNonNullable(this.currentPart).data.request;return r&&"TakeBackAsked"===r.code?zr.getPlayer(r):de.NONE}canProposeDraw(){ye(this.isPlaying(),"Non playing should not call canProposeDraw");const e=we.getNonNullable(this.currentPart);return!(this.endGame||e.data.request&&"DrawRefused"===e.data.request.code&&this.role.isPlayer()&&zr.getPlayer(e.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===de.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==de.NONE&&e!==this.role}getDrawRequester(){const r=we.getNonNullable(this.currentPart).data.request;return r&&"DrawProposed"===r.code?zr.getPlayer(r):de.NONE}onRequest(e,r){var s=this;return A(function*(){switch(K(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:r}),e.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":s.takeBackTo(we.getNonNullable(s.currentPart).data.turn);break;case"RematchProposed":s.rematchProposed=!0;const i=zr.getPlayer(e).getOpponent();s.isPlayer(i)&&(K(n.VERBOSE,"ton adversaire te propose une revanche"),s.opponentProposedRematch=!0);break;case"RematchAccepted":yield s.router.navigate(["/nextGameLoading"]),yield s.router.navigate(["/play",zr.getTypeGame(e),zr.getPartId(e)]);break;case"AddTurnTime":const o=3e4,c=z.of(e.data.player);s.addTurnTimeTo(c,o);break;default:we.expectToBe(e.code,"AddGlobalTime","Unknown RequestType : "+e.code+" for "+JSON.stringify(e));const u=3e5,h=z.of(e.data.player);s.addGlobalTimeTo(h,u)}})()}takeBackTo(e){if(K(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const r=z.fromTurn(e);this.resetChronoFor(r)}this.gameComponent.updateBoard()}setPlayersDatas(e){var r=this;return A(function*(){K(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),r.players=[P.of(e.data.playerZero),P.ofNullable(e.data.playerOne)],ye(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{ye(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUser(s.get().id,i)}})()}setRealObserverRole(){var e=this;return A(function*(){let r=P.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(z.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(z.ONE),r=e.players[0]):e.setRole(de.NONE),yield e.observedPartService.updateObservedPart({...e.observedPart.get(),role:e.role===de.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e,r){var s=this;return A(function*(){if(K(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!s.isOpponentWaitingForTakeBackResponse())return s.updateDBBoard(e,s.msToSubstract,r);s.gameComponent.message("You must answer to take back request")})()}updateDBBoard(e,r,s){var i=this;return A(function*(){const o=i.gameComponent.encoder.encodeMove(e);K(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+s+")"),i.gameComponent.rules.choose(e);const c=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return c.isEndGame?c===Ie.DRAW?i.notifyDraw(o,s):i.notifyVictory(o,s):i.gameService.updateDBBoard(i.currentPartId,i.role,o,r,s)})()}resign(){var e=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.getLastIndex(),s=e.role,i=e.getPlayer(),o=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,s,o,i)})()}getLastIndex(){return we.getNonNullable(this.currentPart).data.lastUpdate.index}reachedOutOfTime(e){var r=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")");const s=r.getLastIndex(),i=r.role;if(r.stopCountdownsFor(e),!1===r.isPlaying())return;const o=we.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(o,i,s,r.authUser.toMinimalUser()):(ye(!1===r.endGame,"time might be better handled in the future"),r.opponentIsOffline()&&(yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),i,e.value,o),r.endGame=!0))})()}acceptRematch(){var e=this;return A(function*(){ye(e.isPlaying(),"Non playing should not call acceptRematch");const r=new fS(e.currentPartId,we.getNonNullable(e.currentPart).data);return yield e.gameService.acceptRematch(r,e.getLastIndex(),e.role),!0})()}proposeRematch(){var e=this;return A(function*(){return ye(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role),!0})()}proposeDraw(){return ye(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}acceptDraw(){return ye(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}refuseDraw(){return ye(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}askTakeBack(){return ye(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}acceptTakeBack(){var e=this;return A(function*(){ye(e.isPlaying(),"Non playing should not call acceptTakeBack");const r=e.role;yield e.gameService.acceptTakeBack(e.currentPartId,we.getNonNullable(e.currentPart),r,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return ye(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}startCountDownFor(e){K(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+we.getNonNullable(this.currentPart).data.turn+")"),this.hasUserPlayed[e.value]=!0,e===z.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(e,r=!0){let s;K(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+we.getNonNullable(this.currentPart).data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.changeDuration(we.getNonNullable(this.currentPart?.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),s=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(we.getNonNullable(this.currentPart?.data.remainingMsForOne)),this.chronoOneGlobal.resume(),s=this.chronoOneTurn),r?(s.setDuration(1e3*this.configRoom.maximalMoveDuration),s.start()):s.resume()}pauseCountDownsFor(e,r=!0){let s;K(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart?.data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.pause(),s=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),s=this.chronoOneTurn),r?s.stop():s.pause()}stopCountdownsFor(e){K(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart?.data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===z.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return ye(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}addGlobalTime(){const e=this.role,r=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,r,we.getNonNullable(this.currentPart).data,e)}addTurnTime(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,r){const s=z.fromTurn(we.getNonNullable(this.currentPart).getTurn());this.pauseCountDownsFor(s,!1),e===z.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+r):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+r),this.resumeCountDownFor(s,!1)}addGlobalTimeTo(e,r){e===z.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+r):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+r)}ngOnDestroy(){var e=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&(yield e.observedPartService.removeObservedPart()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe()),K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ya),Q(go),Q(Ps),Q(jn),Q(Nn),Q(Ci),Q(nm),Q(dS))},n.\u0275cmp=mt({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(s4(V7t,5),s4(H7t,5),s4(F7t,5),s4(B7t,5),s4($7t,5),s4(U7t,5)),2&e){let s;uc(s=fc())&&(r.partCreation=s.first),uc(s=fc())&&(r.chatComponent=s.first),uc(s=fc())&&(r.chronoZeroGlobal=s.first),uc(s=fc())&&(r.chronoOneGlobal=s.first),uc(s=fc())&&(r.chronoZeroTurn=s.first),uc(s=fc())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,C,w,I,H,Y,ee,_e,te,Ae,Fe,Ze,zt,k1,w1,es,Lc,Io,Ni;return t=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Resign`,u=$localize`Propose a draw`,h=$localize`Accept draw`,g=$localize`Reject draw`,m=$localize`Pass a turn`,C=$localize`Accept take back`,w=$localize`Reject take back`,I=$localize`Ask to take back one move`,H=$localize`Draw`,Y=$localize`You agreed to draw.`,ee=$localize`Your draw proposal has been accepted.`,_e=$localize`Players agreed to draw.`,te=$localize`You won.`,Ae=$localize`You lost.`,Fe=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,Ze=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,zt=$localize`You reached your time limit.`,k1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,w1=$localize`You resigned.`,es=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,Lc=$localize`Go back to the game list`,Io=$localize`Propose to play again`,Ni=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],r,["id","opponentTurn"],s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],c,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],g,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],C,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],w,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],I,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],H,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],Y,["id","yourOpponentAgreedToDrawIndicator",1,"title"],ee,["id","playersAgreedToDraw",1,"title"],_e,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],te,["id","youLostIndicator",1,"title"],Ae,[1,"title"],Fe,Ze,zt,k1,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],w1,es,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Lc,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],Io,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],Ni]},template:function(e,r){1&e&&(k(0,G7t,2,1,"app-part-creation",0),k(1,Oft,30,27,"div",1),b(2,"div",2)(3,"div",3),X(4,"app-chat",4),O()()),2&e&&(T("ngIf",!1===r.gameStarted),S(1),T("ngIf",r.gameStarted),S(3),T("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[En,on,Op,k3e,u1,z7t],encapsulation:2}),n})();function Ift(n,t){if(1&n&&(b(0,"option",26),St(1),O()),2&n){const e=t.$implicit;T("value",e.name),S(1),a1(e.name)}}function xft(n,t){if(1&n&&(b(0,"option",26),ge(1,30),O()),2&n){const e=t.$implicit;T("value",e),S(1),A1(e),z1(1)}}const kft=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Lft(n,t){if(1&n){const e=Te();b(0,"select",27),J("ngModelChange",function(s){return ue(e),oe(v(2).aiDepths[0]=s)})("change",function(){ue(e);const s=v(2);return oe(s.updatePlayer(s.Player.ZERO))}),b(1,"option",28),ge(2,29),O(),k(3,xft,2,2,"option",17),O()}2&n&&(T("ngModel",v(2).aiDepths[0]),S(3),T("ngForOf",J1(2,kft)))}function Rft(n,t){if(1&n&&(b(0,"p",31),ge(1,32),O()),2&n){const e=v(2);S(1),A1(e.gameComponent.scores.get()[0]),z1(1)}}function Dft(n,t){if(1&n&&(b(0,"option",26),St(1),O()),2&n){const e=t.$implicit;T("value",e.name),S(1),a1(e.name)}}function zft(n,t){if(1&n&&(b(0,"option",26),ge(1,35),O()),2&n){const e=t.$implicit;T("value",e),S(1),A1(e),z1(1)}}const Vft=function(){return[1,2,3,4,5,6,7,8,9,10]};function Hft(n,t){if(1&n){const e=Te();b(0,"select",33),J("ngModelChange",function(s){return ue(e),oe(v(2).aiDepths[1]=s)})("change",function(){ue(e);const s=v(2);return oe(s.updatePlayer(s.Player.ONE))}),b(1,"option",28),ge(2,34),O(),k(3,zft,2,2,"option",17),O()}2&n&&(T("ngModel",v(2).aiDepths[1]),S(3),T("ngForOf",J1(2,Vft)))}function Fft(n,t){if(1&n&&(b(0,"p",36),ge(1,37),O()),2&n){const e=v(2);S(1),A1(e.gameComponent.scores.get()[1]),z1(1)}}function Bft(n,t){if(1&n&&(b(0,"h4",41),St(1),O()),2&n){const e=v(3);S(1),a1(e.winnerMessage.get())}}function $ft(n,t){1&n&&(b(0,"h4",42),ge(1,43),O())}function Uft(n,t){if(1&n&&(b(0,"div",38),k(1,Bft,2,1,"h4",39),k(2,$ft,2,0,"h4",40),O()),2&n){const e=v(2);S(1),T("ngIf",e.winnerMessage.isPresent()),S(1),T("ngIf",e.winnerMessage.isAbsent())}}function Gft(n,t){if(1&n){const e=Te();b(0,"div",7)(1,"div",8)(2,"p",9),ge(3,10),O()(),b(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),J("change",function(){ue(e);const s=v();return oe(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return ue(e),oe(v().playerSelection[0]=s)}),b(8,"option",15),ge(9,16),O(),k(10,Ift,2,2,"option",17),O()(),b(11,"div",13),k(12,Lft,4,3,"select",18),O(),k(13,Rft,2,1,"p",19),O(),b(14,"div",20)(15,"div",13)(16,"select",21),J("change",function(){ue(e);const s=v();return oe(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return ue(e),oe(v().playerSelection[1]=s)}),b(17,"option",15),ge(18,22),O(),k(19,Dft,2,2,"option",17),O()(),b(20,"div",13),k(21,Hft,4,3,"select",23),O(),k(22,Fft,2,1,"p",24),O()(),k(23,Uft,3,2,"div",25),O()}if(2&n){const e=v();S(3),A1(e.gameComponent.getTurn()+1),z1(3),S(4),T("ngModel",e.playerSelection[0]),S(3),T("ngForOf",e.gameComponent.availableMinimaxes),S(2),T("ngIf",!1===e.players[0].equalsValue("human")),S(1),T("ngIf",e.gameComponent.scores.isPresent()),S(3),T("ngModel",e.playerSelection[1]),S(3),T("ngForOf",e.gameComponent.availableMinimaxes),S(2),T("ngIf",!1===e.players[1].equalsValue("human")),S(1),T("ngIf",e.gameComponent.scores.isPresent()),S(1),T("ngIf",e.endGame)}}function Wft(n,t){if(1&n&&(an(0),St(1),X(2,"br"),cn()),2&n){const e=t.$implicit,r=v(3);S(1),zi(" ",e.name+": "+e.getBoardValue(r.gameComponent.rules.node)," ")}}function qft(n,t){if(1&n&&(an(0),k(1,Wft,3,1,"ng-container",50),St(2),X(3,"br"),St(4),X(5,"br"),cn()),2&n){const e=v(2);S(1),T("ngForOf",e.gameComponent.availableMinimaxes),S(1),zi(" Created ",e.getCreatedNodes()," nodes."),S(2),zi(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function jft(n,t){if(1&n){const e=Te();b(0,"button",51),J("click",function(){return ue(e),oe(v(2).gameComponent.pass())}),ge(1,52),O()}}function Zft(n,t){if(1&n){const e=Te();b(0,"button",53),J("click",function(){return ue(e),oe(v(2).takeBack())}),ge(1,54),O()}}function Yft(n,t){if(1&n){const e=Te();b(0,"div",44),k(1,qft,6,3,"ng-container",45),k(2,jft,2,0,"button",46),k(3,Zft,2,0,"button",47),b(4,"button",48),J("click",function(){return ue(e),oe(v().restartGame())}),ge(5,49),O()()}if(2&n){const e=v();S(1),T("ngIf",e.gameComponent.rules.node.move),S(1),T("ngIf",!1===e.endGame&&e.gameComponent.canPass),S(1),T("ngIf",e.canTakeBack())}}let Kft=(()=>{class n extends DP{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=P.empty(),this.botTimeOut=1e3,this.players=[P.of(this.playerSelection[0]),P.of(this.playerSelection[1])],this.role=z.ZERO,K(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return QS.createdNodes}getMinimaxTime(){return QS.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(A(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=P.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?z.ONE:z.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return A(function*(){K(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.rules.choose(e),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?P.of($localize`${r} won`):P.of($localize`You won`):this.players[i].equalsValue("human")?P.of($localize`You lost`):P.of($localize`${this.players[e.winner.value].get()} (${r}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(A(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return P.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?P.empty():P.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return A(function*(){const s=r.gameComponent.rules;ye(s.getGameStatus(s.node)===Ie.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[s.node.gameState.turn%2%2]),u=s.node.findBestMove(c,e,!0);return s.choose(u)?(r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),U.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),Ss.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=P.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ya),Q(go),Q(Ps),Q(jn),Q(Nn),Q(nu))},n.\u0275cmp=mt({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,C,w;return t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,g=$localize`Draw`,m=$localize`Start a new game`,C=$localize`Pass a turn`,w=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],h,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],g,[1,"tile","is-child","box","is-vcentered"],[4,"ngIf"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],C,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],w]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),k(2,Gft,24,10,"div",2),k(3,Yft,6,3,"div",3),O(),b(4,"div",4)(5,"div",5),X(6,"div",null,6),O()()()),2&e&&(S(2),T("ngIf",r.gameComponent),S(1),T("ngIf",r.gameComponent),S(1),T("ngClass",r.getBoardHighlight()))},dependencies:[En,Dn,on,up,fp,Py,Cl,lp],encapsulation:2,changeDetection:0}),n})(),V3e=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function Xft(n,t){if(1&n&&(b(0,"div",21)(1,"div",22),ge(2,23),O(),X(3,"div",24),O()),2&n){const e=v();S(3),T("innerHTML",e.currentReason.get(),D8)}}function Qft(n,t){if(1&n){const e=Te();b(0,"button",25),J("click",function(){return ue(e),oe(v().retry())}),ge(1,26),O()}}function Jft(n,t){1&n&&(an(0),ge(1,31),cn())}function e9t(n,t){1&n&&(an(0),ge(1,32),cn())}function t9t(n,t){if(1&n&&k(0,e9t,2,0,"ng-container",28),2&n){v();const e=t1(5),r=v();T("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function n9t(n,t){1&n&&(an(0),ge(1,33),cn())}function r9t(n,t){if(1&n){const e=Te();b(0,"button",27),J("click",function(){return ue(e),oe(v().next())}),k(1,Jft,2,0,"ng-container",28),k(2,t9t,1,2,"ng-template",null,29,c1),k(4,n9t,2,0,"ng-template",null,30,c1),O()}if(2&n){const e=t1(3),r=v();S(1),T("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function s9t(n,t){if(1&n){const e=Te();b(0,"button",34),J("click",function(){return ue(e),oe(v().start())}),ge(1,35),O()}}function i9t(n,t){if(1&n){const e=Te();b(0,"button",36),J("click",function(){return ue(e),oe(v().playLocally())}),ge(1,37),O()}}function o9t(n,t){if(1&n){const e=Te();b(0,"button",38),J("click",function(){return ue(e),oe(v().createGame())}),ge(1,39),O()}}function a9t(n,t){if(1&n){const e=Te();b(0,"button",40),J("click",function(){return ue(e),oe(v().showSolution())}),ge(1,41),O()}}function c9t(n,t){if(1&n&&(an(0),b(1,"option",43),St(2),O(),cn()),2&n){const e=v(),r=e.index,s=e.$implicit;S(1),S1("id","step_",r,""),T("value",r),S(1),a1(s.title)}}function l9t(n,t){1&n&&(an(0),St(1,"v "),cn())}function u9t(n,t){1&n&&St(0,"x ")}function f9t(n,t){if(1&n&&(b(0,"option",44),k(1,l9t,2,0,"ng-container",28),k(2,u9t,1,0,"ng-template",null,45,c1),b(4,"span",46),St(5),O()()),2&n){const e=t1(3),r=v(),s=r.index,i=r.$implicit,o=v();T("value",s),S(1),T("ngIf",o.stepFinished[s])("ngIfElse",e),S(3),S1("id","step_",s,""),S(1),a1(i.title)}}function h9t(n,t){if(1&n&&(an(0),k(1,c9t,3,3,"ng-container",28),k(2,f9t,6,5,"ng-template",null,42,c1),cn()),2&n){const e=t.index,r=t1(3),s=v();S(1),T("ngIf",e===s.stepIndex)("ngIfElse",r)}}let d9t=(()=>{class n extends DP{constructor(e,r,s,i,o,c){super(e,r,c,s,i),this.cdr=o,this.connectedUserService=c,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=P.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,K(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=z.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return A(function*(){K(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){K(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){K(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];let s;if(this.currentMessage=r.instruction,this.currentReason=P.empty(),r.previousState.isPresent()){const i=new V1(r.previousState.get());s=P.of(i)}else s=P.empty();this.gameComponent.rules.node=new V1(r.state,s,r.previousMove),this.gameComponent.updateBoard(),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return A(function*(){K(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex];if(ye(r.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.gameComponent.updateBoard(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=we.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=P.of(u.getReason())}else if(s.isAnyMove())K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{ye(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=P.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){K(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(e){if(K(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=P.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return U.failure(V3e.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,we.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),U.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),U.SUCCESS):U.failure(V3e.INFORMATIONAL_STEP())}onCancelMove(e){K(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=P.of(e)),this.cdr.detectChanges()}showStepSuccess(e){K(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return A(function*(){K(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];ye(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof yi?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(i),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return A(function*(){const r=we.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return A(function*(){const r=we.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ya),Q(go),Q(jn),Q(Nn),Q(nu),Q(Ps))},n.\u0275cmp=mt({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,h=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],h,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),b(4,"div",4)(5,"p",5),St(6),O(),X(7,"p",6),O(),k(8,Xft,4,1,"div",7),b(9,"div",8),k(10,Qft,2,0,"button",9),k(11,r9t,6,2,"button",10),k(12,s9t,2,0,"button",11),k(13,i9t,2,0,"button",12),k(14,o9t,2,0,"button",13),k(15,a9t,2,0,"button",14),b(16,"div",15)(17,"select",16),J("change",function(i){return r.changeStep(i)}),k(18,h9t,4,2,"ng-container",17),O()()()()(),b(19,"div",18)(20,"div",19),X(21,"div",null,20),O()()()),2&e&&(S(3),D("value",r.successfulSteps)("max",r.getNumberOfSteps()),S(3),Db("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),S(1),T("innerHTML",r.currentMessage,D8),S(1),T("ngIf",r.currentReason.isPresent()),S(2),T("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),S(1),T("ngIf",!1===r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),S(3),T("ngForOf",r.steps),S(1),T("ngClass",r.getBoardHighlight()))},dependencies:[En,Dn,on,up,fp],encapsulation:2,changeDetection:0}),n})();function p9t(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),ge(2,37),O(),b(3,"div",38),St(4),O()()),2&n){const e=v();S(4),a1(e.errorMessage)}}const g9t=function(){return["/login"]};let m9t=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=PV,this.registrationForm=new s0({email:new ba,username:new ba,password:new ba})}registerWithEmail(){var e=this;return A(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return A(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(Q(Ps),Q(jn))},n.\u0275cmp=mt({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,C,w,I;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,g=$localize`Register`,m=$localize`Register with Google`,C=$localize`Have an account?`,w=$localize`Log in`,I=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],g,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],C,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],I,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),ge(2,2),O(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ge(7,7),O()(),b(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),b(12,"p",12),ge(13,13),O()()()()(),b(14,"div",4)(15,"div",5)(16,"label",14),ge(17,15),O()(),b(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),O()()()(),b(22,"div",4)(23,"div",5)(24,"label",17),ge(25,18),O()(),b(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),b(30,"span",21),X(31,"fa-icon",22),O(),b(32,"p",23),ge(33,24),O()()()()(),b(34,"div",4),X(35,"div",5),b(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),J("click",function(){return r.registerWithEmail()}),ge(40,26),O()()()()(),b(41,"div",4),X(42,"div",5),b(43,"div",27),k(44,p9t,5,1,"div",28),O()(),b(45,"div",4),X(46,"div",5),b(47,"div",8)(48,"button",29),J("click",function(){return r.registerWithGoogle()}),ge(49,30),O()()(),b(50,"p",31),an(51),ge(52,32),cn(),St(53,"\xa0 "),b(54,"a",33),ge(55,34),O()()()()),2&e&&(S(3),T("formGroup",r.registrationForm),S(28),T("icon",r.faEye),S(1),T("ngClass",r.getPasswordHelpClass()),S(7),T("disabled",!r.canRegister()),S(5),T("ngIf",r.errorMessage),S(10),T("routerLink",J1(6,g9t)))},dependencies:[En,on,pu,au,c4,Cl,ou,uu,cu,Z7,r9,OH,I3e],encapsulation:2}),n})(),_9t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return A(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn))},n.\u0275cmp=mt({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),J("click",function(){return r.playLocally()}),ge(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[bH],encapsulation:2}),n})(),v9t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return A(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn))},n.\u0275cmp=mt({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),J("click",function(){return r.launchTutorial()}),ge(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[bH],encapsulation:2}),n})(),C9t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mt({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),ge(1,0),O())},encapsulation:2}),n})();function E9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.HEPTAGON)}}function M9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function S9t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function P9t(n,t){if(1&n&&(an(0),B(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),cn()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function T9t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),O()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function w9t(n,t){if(1&n&&(B(),b(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class s6{constructor(){this.MartianChessQueenComponent=s6,this.MartianChessComponent=Oo,this.horizontalDotsRadius=Oo.SPACE_SIZE/15}}function O9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.PENTAGON)}}function N9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function A9t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function I9t(n,t){if(1&n&&(an(0),B(),X(1,"circle",6)(2,"circle",6),cn()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function x9t(n,t){if(1&n&&(B(),b(0,"g",7),X(1,"circle",8)(2,"circle",8),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function k9t(n,t){if(1&n&&(B(),b(0,"g",7),X(1,"circle",9)(2,"circle",9),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}s6.HEPTAGON=Oo.getRegularPolygon(7),s6.EIGHT_POINTED_STAR=Oo.getNPointedStar(8,0),s6.\u0275fac=function(t){return new(t||s6)},s6.\u0275cmp=mt({type:s6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(k(0,E9t,1,3,"polygon",0),k(1,M9t,1,3,"polygon",0),k(2,S9t,1,5,"circle",1),k(3,P9t,4,9,"ng-container",2),k(4,T9t,4,9,"g",2),k(5,w9t,4,10,"g",3)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[En,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class i6{constructor(){this.MartianChessComponent=Oo,this.MartianChessDroneComponent=i6,this.horizontalDotsRadius=Oo.SPACE_SIZE/15}}function R9t(n,t){if(1&n&&(B(),X(0,"polygon",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.TRIANGLE)}}function D9t(n,t){if(1&n&&(B(),X(0,"polygon",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function z9t(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function V9t(n,t){if(1&n&&(B(),X(0,"circle",7)),2&n){const e=v();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function H9t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=v();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function F9t(n,t){if(1&n&&(B(),b(0,"g",9),X(1,"circle",10),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}i6.FOUR_POINTED_STAR_VERTICAL=Oo.getNPointedStar(4,0),i6.PENTAGON=Oo.getRegularPolygon(5),i6.\u0275fac=function(t){return new(t||i6)},i6.\u0275cmp=mt({type:i6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(k(0,O9t,1,3,"polygon",0),k(1,N9t,1,3,"polygon",0),k(2,A9t,1,5,"circle",1),k(3,I9t,3,6,"ng-container",2),k(4,x9t,3,7,"g",3),k(5,k9t,3,7,"g",3)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[En,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class ua{constructor(){this.MartianChessComponent=Oo,this.MartianChessPawnComponent=ua,this.horizontalDotsRadius=Oo.SPACE_SIZE/15}static getTriangle(){return Oo.getRegularPolygon(3,ua.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=Oo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,h)=>Math.min(u,h))+(100-e.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?ua.TRIANGLE_Y_OFFSET:0}}function $9t(n,t){if(1&n&&(B(),X(0,"text",8)),2&n){const e=v();Ko("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),T("innerHTML",e.coord.z,D8)}}function U9t(n,t){if(1&n&&(B(),X(0,"polyline",9)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getUpperHorizontalLine())}}function G9t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polyline",10)(2,"polyline",11),O()),2&n){const e=v();S(1),T("ngClass",e.pieceClasses),D("points",e.getMiddleHorizontalLine()),S(1),T("ngClass",e.pieceClasses),D("points",e.getLowerHorizontalLine())}}function W9t(n,t){if(1&n&&(B(),X(0,"polyline",12)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getLeftDiagonalLine())}}function q9t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polyline",13)(2,"polyline",14),O()),2&n){const e=v();S(1),T("ngClass",e.pieceClasses),D("points",e.getMiddleDiagonalLine()),S(1),T("ngClass",e.pieceClasses),D("points",e.getRighterDiagonalLine())}}function j9t(n,t){if(1&n&&(B(),X(0,"polyline",15)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getLeftVerticalLine())}}function Z9t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getMiddleVerticalLine())}}function Y9t(n,t){if(1&n&&(B(),X(0,"polyline",17)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getRighterVerticalLine())}}ua.FOUR_POINTED_STAR_DIAGONAL=Oo.getNPointedStar(4,45),ua.TRIANGLE_Y_OFFSET=ua.yOffsetForVerticalCentering(),ua.TRIANGLE=ua.getTriangle(),ua.\u0275fac=function(t){return new(t||ua)},ua.\u0275cmp=mt({type:ua,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(k(0,R9t,1,3,"polygon",0),k(1,D9t,1,3,"polygon",0),k(2,z9t,1,5,"circle",1),k(3,V9t,1,3,"circle",2),k(4,H9t,1,3,"circle",3),k(5,F9t,2,4,"g",4)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[En,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class N9{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=Sn.SPACE_SIZE*this.mode.horizontalWidthRatio,e=Sn.SPACE_SIZE,r=this.mode.offsetRatio*Sn.SPACE_SIZE,s=Sn.SPACE_SIZE*this.mode.pieceHeightRatio,i=t,c=t-r,u=e,h=-r,g=e;return[new M(0,0),new M(i,0),new M(h,g),new M(c,u),new M(i,0+s),new M(h,g+s),new M(c,u+s)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],r=t[1],i=new ln(-1*this.mode.offsetRatio*Sn.STROKE_WIDTH,Sn.STROKE_WIDTH),o=e.getNext(i),c=r.getNext(i);return[e,r,c,o]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],r=t[3],i=new ln(-1*this.mode.offsetRatio*Sn.STROKE_WIDTH,Sn.STROKE_WIDTH);return[e.getNext(i,-1),r.getNext(i,-1),r,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],r=t[6],s=new ln(0,Sn.STROKE_WIDTH),i=e.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],r=t[2],i=new ln(Sn.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[3],i=new ln(Sn.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],r=t[6],i=new ln(0,Sn.STROKE_WIDTH),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],r=t[5],i=new ln(Sn.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],r=t[6],i=new ln(Sn.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[4],o=new ln(Sn.STROKE_WIDTH,-Sn.STROKE_WIDTH/this.mode.offsetRatio),c=e.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,e,r,u])}getOtherCoord(){ye(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}}N9.STROKE_OFFSET=Sn.STROKE_WIDTH/2,N9.\u0275fac=function(t){return new(t||N9)},N9.\u0275cmp=mt({type:N9,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,e){1&t&&(B(),X(0,"polyline",0),k(1,$9t,1,4,"text",1),k(2,U9t,1,2,"polyline",2),k(3,G9t,3,4,"g",3),k(4,W9t,1,2,"polyline",4),k(5,q9t,3,4,"g",3),k(6,j9t,1,2,"polyline",5),k(7,Z9t,1,2,"polyline",6),k(8,Y9t,1,2,"polyline",7)),2&t&&(Ko("id","tile_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),T("ngClass",e.pieceClasses),D("points",e.get3DIsoSquarePoints()),S(1),T("ngIf",e.mustDisplayHeight),S(1),T("ngIf",!1===e.isBottomHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isTopHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isRightHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isLeftHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isBottomHalf()||e.isLeftHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isBottomHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isTopHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()))},dependencies:[En,on],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const Fm_firebaseConfig={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let NH=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return A(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=A(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(Le(Ps))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Bm=(()=>{class n extends NH{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return A(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return A(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(Le(Ps),Le(jn))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),AH=(()=>{class n{constructor(e,r){this.observedPartService=e,this.router=r,this.observedPartSubscription=P.empty()}canActivate(e){var r=this;return A(function*(){const s=yield new Promise(i=>{const o=r.observedPartService.subscribeToObservedPart(c=>{if(c.isAbsent())return i(!0);const u=c.get();return i(e.params.id===u.id||r.router.parseUrl("/play/"+u.typeGame+"/"+u.id))});r.observedPartSubscription=P.of(o)});return r.observedPartSubscription.get().unsubscribe(),r.observedPartSubscription=P.empty(),s})()}}return n.\u0275fac=function(e){return new(e||n)(Le(Ci),Le(jn))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),K9t=(()=>{class n extends NH{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return A(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Le(Ps),Le(jn))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),H3e=(()=>{class n extends NH{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return A(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Le(Ps),Le(jn))},n.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function X9t(n,t){1&n&&(b(0,"p",20),ge(1,21),O())}function Q9t(n,t){if(1&n){const e=Te();b(0,"div",7)(1,"p",8),ge(2,9),O(),b(3,"div",10)(4,"p",11),ge(5,12),O(),b(6,"button",13),J("click",function(){return ue(e),oe(v().finalizeEmailVerification())}),ge(7,14),O()(),b(8,"div",15)(9,"p",11),ge(10,16),O(),b(11,"button",17),J("click",function(){return ue(e),oe(v().sendEmailVerification())}),ge(12,18),O()(),k(13,X9t,2,0,"p",19),O()}if(2&n){const e=v();S(2),A1(e.emailAddress),z1(2),S(11),T("ngIf",e.success)}}function J9t(n,t){if(1&n){const e=Te();b(0,"div",24)(1,"div",8),ge(2,25),O(),b(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),O(),b(7,"div",28)(8,"button",30),J("click",function(){ue(e);const s=v(2);return oe(s.pickUsername(s.usernameForm.value))}),ge(9,31),O()()()()()}if(2&n){const e=v(2);S(3),T("formGroup",e.usernameForm)}}const eht=function(){return["/lobby"]};function tht(n,t){1&n&&(b(0,"div",32),ac(1,33),X(2,"a",34),cc(),O()),2&n&&(S(2),T("routerLink",J1(1,eht)))}function nht(n,t){if(1&n&&(an(0),k(1,J9t,10,1,"div",22),k(2,tht,3,2,"div",23),cn()),2&n){const e=v();S(1),T("ngIf",!e.success),S(1),T("ngIf",e.success)}}function rht(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),St(2),O()()),2&n){const e=v();S(2),a1(e.errorMessage)}}let sht=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new s0({username:new ba})}ngOnInit(){var e=this;return A(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=A(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return A(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return A(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return A(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Ps),Q(jn))},n.\u0275cmp=mt({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,g=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],g,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),ge(3,3),O(),k(4,Q9t,14,2,"div",4),k(5,nht,3,2,"ng-container",5),O(),k(6,rht,3,1,"div",6),O()),2&e&&(S(4),T("ngIf","send-email"===r.verificationType),S(1),T("ngIf","enter-username"===r.verificationType),S(1),T("ngIf",r.errorMessage))},dependencies:[on,pu,au,c4,Cl,ou,uu,cu,Z7],encapsulation:2}),n})();function iht(n,t){1&n&&(b(0,"p",12),ge(1,13),O())}function oht(n,t){if(1&n&&(b(0,"div",14)(1,"div",15),ge(2,16),O(),b(3,"div",17),St(4),O()()),2&n){const e=v();S(4),a1(e.errorMessage.get())}}const aht=function(){return{standalone:!0}};let cht=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=P.empty(),this.email=""}resetPassword(){var e=this;return A(function*(){ye(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=P.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=P.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Ps))},n.\u0275cmp=mt({type:n,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let t,e,r,s,i,o;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,o=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field"],[1,"control"],["id","email","name","email","placeholder",e,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],r,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],o,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),ge(2,2),O(),b(3,"div",3)(4,"div",4)(5,"input",5),J("ngModelChange",function(i){return r.email=i}),O(),b(6,"p",6),ge(7,7),O(),k(8,iht,2,0,"p",8),O()(),b(9,"button",9),J("click",function(){return r.resetPassword()}),ge(10,10),O(),k(11,oht,5,1,"div",11),O()),2&e&&(S(5),T("ngModel",r.email)("ngModelOptions",J1(5,aht)),S(3),T("ngIf",r.success),S(1),T("disabled",""===r.email),S(2),T("ngIf",r.errorMessage.isPresent()))},dependencies:[on,c4,Cl,uu,lp,OH],encapsulation:2}),n})();function lht(n,t){if(1&n&&(b(0,"option",13),St(1),O()),2&n){const e=t.$implicit,r=v();T("value",e.value)("selected",e.value===r.currentTheme),S(1),zi(" ",e.name," ")}}function uht(n,t){if(1&n&&(b(0,"option",13),St(1),O()),2&n){const e=t.$implicit,r=v();T("value",e.value)("selected",e.value===r.currentLanguage),S(1),zi(" ",e.name," ")}}let fht=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(Q(Gte),Q(pS))},n.\u0275cmp=mt({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),ge(2,2),O(),b(3,"div",3)(4,"label",4),ge(5,5),O(),b(6,"div",6)(7,"div",7)(8,"select",8),J("change",function(i){return r.changeTheme(i)}),k(9,lht,2,3,"option",9),O()()()(),b(10,"div",3)(11,"label",10),ge(12,11),O(),b(13,"div",6)(14,"div",7)(15,"select",12),J("change",function(i){return r.changeLanguage(i)}),k(16,uht,2,3,"option",9),O()()()()()),2&e&&(S(9),T("ngForOf",r.availableThemes),S(7),T("ngForOf",r.availableLanguages))},dependencies:[Dn,up,fp],encapsulation:2}),n})(),hht=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.observedPartService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return A(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return we.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return A(function*(){if(ye(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",b9.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.observedPartService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return P.ofNullable(w9.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(Q(go),Q(jn),Q(Ps),Q(Ci),Q(Nn),Q(dS))},n.\u0275cmp=mt({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),ge(1,0),O())},encapsulation:2}),n})();!function d8e(n,t,e){(function B4e(n,t,e){"string"!=typeof t&&(e=t,t=n[pt.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),U7[t]=n,e&&(U7[t][pt.ExtraData]=e)})(n,t,e)}(xde);const dht=[{path:"login",component:K5t},{path:"lobby",component:g7t,canActivate:[Bm]},{path:"settings",component:fht},{path:"register",component:m9t,canActivate:[H3e]},{path:"reset-password",component:cht,canActivate:[H3e]},{path:"notFound/:message",component:R3e},{path:"nextGameLoading",component:C9t,canActivate:[Bm]},{path:"verify-account",component:sht,canActivate:[K9t]},{path:"play",component:L3e,canActivate:[Bm,AH]},{path:"play/:compo",component:hht,canActivate:[Bm,AH]},{path:"play/:compo/:id",component:Aft,canActivate:[Bm,AH]},{path:"local",component:_9t},{path:"local/:compo",component:Kft},{path:"tutorial",component:v9t},{path:"tutorial/:compo",component:d9t},{path:"",component:V5t},{path:"demo",component:q5t},{path:"**",component:R3e}];class IH{static app(){return function WMe(n,...t){return{ngModule:GMe,providers:[{provide:hR,useFactory:UMe(n),multi:!0,deps:[Er,s2,uR,...t]}]}}(()=>qMe(Fm_firebaseConfig))}static firestore(){return function Gwe(n,...t){return{ngModule:Uwe,providers:[{provide:Oz,useFactory:Fwe(n),multi:!0,deps:[Er,s2,uR,fR,[new r2,ete],[new r2,AR],...t]}]}}(()=>{const t=Xwe();t.toJSON();return t})}static auth(){return function Owe(n,...t){return{ngModule:bwe,providers:[{provide:bz,useFactory:Pwe(n),multi:!0,deps:[Er,s2,uR,fR,[new r2,AR],...t]}]}}(()=>{const t=Iwe();return t})}}let pht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Js({type:n,bootstrap:[m3t]}),n.\u0275inj=Ur({providers:[Ps,dS,Az,nm,lS,pS,{provide:i4,useValue:sm.getLocale()}],imports:[IH.app(),IH.firestore(),IH.auth(),PG,o7e,P9e.forRoot(dht,{useHash:!1}),kW,G5e,Ade,Aze]}),n})();l8(Oo,function(){return[En,Dn,on,s6,i6,ua]},[]),l8(Sn,function(){return[En,Dn,on,N9]},[]);var ght=ja(7742);function F3e(){(function o0e(){SU=!1})(),Lue().bootstrapModule(pht).catch(n=>console.error(n))}const B3e=sm.getLocale();"en"!==B3e?fetch("/assets/"+B3e+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,ght.XJ)(n.translations),$localize.locale=n.locale,F3e()}).catch(function(n){console.log(n)}):F3e()},2486:function(A9,g5){!function(ja){"use strict";function nn(ft,ot){var Xt=Object.keys(ft);if(Object.getOwnPropertySymbols){var i1=Object.getOwnPropertySymbols(ft);ot&&(i1=i1.filter(function(xs){return Object.getOwnPropertyDescriptor(ft,xs).enumerable})),Xt.push.apply(Xt,i1)}return Xt}function ns(ft){for(var ot,Xt=1;Xt<arguments.length;Xt++)ot=arguments[Xt]??{},Xt%2?nn(Object(ot),!0).forEach(function(i1){e8(ft,i1,ot[i1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ft,Object.getOwnPropertyDescriptors(ot)):nn(Object(ot)).forEach(function(i1){Object.defineProperty(ft,i1,Object.getOwnPropertyDescriptor(ot,i1))});return ft}function k3(ft,ot){if(!(ft instanceof ot))throw new TypeError("Cannot call a class as a function")}function Dc(ft,ot){for(var Xt,i1=0;i1<ot.length;i1++)(Xt=ot[i1]).enumerable=Xt.enumerable||!1,Xt.configurable=!0,"value"in Xt&&(Xt.writable=!0),Object.defineProperty(ft,Xt.key,Xt)}function G1(ft,ot,Xt){return ot&&Dc(ft.prototype,ot),Xt&&Dc(ft,Xt),ft}function e8(ft,ot,Xt){return ot in ft?Object.defineProperty(ft,ot,{value:Xt,enumerable:!0,configurable:!0,writable:!0}):ft[ot]=Xt,ft}function zc(){var ft;return null!==(ft=z4)&&void 0!==ft?ft:document}var L3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Qi=ns({},L3),Ys={},z4=null,I9=function(ft,ot,Xt,i1,xs){return"top-left"===ft?"left:".concat(i1,";top:").concat(ot,";text-align:left;align-items:flex-start;"):"top-right"===ft?"right:".concat(xs,";top:").concat(ot,";text-align:right;align-items:flex-end;"):"top-center"===ft?"top:".concat(ot,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ft?"left:".concat(i1,";bottom:").concat(Xt,";text-align:left;align-items:flex-start;"):"bottom-right"===ft?"right:".concat(xs,";bottom:").concat(Xt,";text-align:right;align-items:flex-end;"):"bottom-center"===ft?"bottom:".concat(Xt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ft?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},t8=function(){function ft(ot){var Xt=this;k3(this,ft),this.element=zc().createElement("div"),this.opacity=ot.opacity,this.type=ot.type,this.animate=ot.animate,this.dismissible=ot.dismissible,this.closeOnClick=ot.closeOnClick,this.message=ot.message,this.duration=ot.duration,this.pauseOnHover=ot.pauseOnHover,this.offsetTop=ot.offsetTop,this.offsetBottom=ot.offsetBottom,this.offsetLeft=ot.offsetLeft,this.offsetRight=ot.offsetRight,this.extraClasses=ot.extraClasses;var i1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),xs=["notification",this.extraClasses];if(this.type&&xs.push(this.type),this.animate&&this.animate.in){var bn="animate__".concat(this.animate.in),or=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";xs.push("animate__animated ".concat(bn," ").concat(or)),this.onAnimationEnd(function(){return Xt.element.classList.remove(bn)})}if(this.element.className=xs.join(" "),this.dismissible){var R3=zc().createElement("button");R3.className="delete",R3.addEventListener("click",function(){Xt.destroy()}),this.element.insertAdjacentElement("afterbegin",R3)}else i1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){Xt.destroy()}),this.element.setAttribute("style",i1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var m5=new Hc(function(){Xt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){m5.pause()}),this.element.addEventListener("mouseout",function(){m5.resume()}))}return G1(ft,[{key:"destroy",value:function(){var ot=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ot.removeParent(ot.element.parentNode),ot.element.remove(),delete Ys.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete Ys.position)}},{key:"removeParent",value:function(ot){ot&&1>=ot.children.length&&ot.remove()}},{key:"onAnimationEnd",value:function(){var ot=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},Xt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var i1 in Xt)if(void 0!==this.element.style[i1]){this.element.addEventListener(Xt[i1],function(){return ot()});break}}}]),ft}(),Hc=function(){function ft(ot,Xt){k3(this,ft),this.remaining=Xt,this.callback=ot,this.resume()}return G1(ft,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ft}();ja.resetDefaults=function(){Qi=ns({},L3)},ja.setDefaults=function(ft){Qi=ns(ns({},L3),ft)},ja.setDoc=function Za(ft){for(var ot in Ys)Ys[ot].remove();Ys={},z4=ft},ja.toast=function Vc(ft){if(!ft.message)throw new Error("message is required");var ot=ns(ns({},Qi),ft),Xt=new t8(ot),i1=function hn(ft,ot,Xt,i1,xs,bn){if(Ys.position)return Ys.position;var or=zc().createElement("div");return or.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+I9(ot,Xt,i1,xs,bn)),ft.appendChild(or),Ys.position=or,or}(ot.appendTo||zc().body,ot.position||Qi.position,ot.offsetTop||Qi.offsetTop,ot.offsetBottom||Qi.offsetBottom,ot.offsetLeft||Qi.offsetLeft,ot.offsetRight||Qi.offsetRight);if(ot.single)for(var xs=i1.lastElementChild;xs;)i1.removeChild(xs),xs=i1.lastElementChild;i1.appendChild(Xt.element)},Object.defineProperty(ja,"__esModule",{value:!0})}(g5)},7742:(A9,g5,ja)=>{"use strict";ja.d(g5,{XJ:()=>Q8,pQ:()=>IC,Q:()=>Ab});class dn{constructor(a){this.digits=a}static zero(){return new dn([0])}static one(){return new dn([1])}clone(){return new dn(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let p=0;p<l;p++){let _=f;p<this.digits.length&&(_+=this.digits[p]),p<a.digits.length&&(_+=a.digits[p]),_>=10?(this.digits[p]=_-10,f=1):(this.digits[p]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class C5{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=dn.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const p=this.getMultipliedByPowerOfTwo(f);l.addToSelf(p)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class LH{constructor(a){this.base=a,this.exponents=[new C5(dn.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new C5(f)}return this.exponents[a]}}function Zm(d){const a=function Ai(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const p=d.charCodeAt(l+1);p>=56320&&p<=57343&&(l++,f=(f-55296<<10)+p-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=GP(a,0),f=GP(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function GP(d,a){let p,l=2654435769,f=2654435769;const _=d.length;for(p=0;p+12<=_;p+=12){l=U2(l,a6(d,p,$r.Little)),f=U2(f,a6(d,p+4,$r.Little));const y=WP(l,f,a=U2(a,a6(d,p+8,$r.Little)));l=y[0],f=y[1],a=y[2]}return l=U2(l,a6(d,p,$r.Little)),f=U2(f,a6(d,p+4,$r.Little)),a=U2(a,_),WP(l,f,a=U2(a,a6(d,p+8,$r.Little)<<8))[2]}function WP(d,a,l){return d=Ks(d,a),d=Ks(d,l),d^=l>>>13,a=Ks(a,l),a=Ks(a,d),a^=d<<8,l=Ks(l,d),l=Ks(l,a),l^=a>>>13,d=Ks(d,a),d=Ks(d,l),d^=l>>>12,a=Ks(a,l),a=Ks(a,d),a^=d<<16,l=Ks(l,d),l=Ks(l,a),l^=a>>>5,d=Ks(d,a),d=Ks(d,l),d^=l>>>3,a=Ks(a,l),a=Ks(a,d),a^=d<<10,l=Ks(l,d),l=Ks(l,a),[d,a,l^=a>>>15]}var $r=(()=>(($r=$r||{})[$r.Little=0]="Little",$r[$r.Big=1]="Big",$r))();function U2(d,a){return qP(d,a)[1]}function qP(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function Ks(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function Km(d,a){return a>=d.length?0:d[a]}function a6(d,a,l){let f=0;if(l===$r.Big)for(let p=0;p<4;p++)f+=Km(d,a+p)<<24-8*p;else for(let p=0;p<4;p++)f+=Km(d,a+p)<<8*p;return f}const z9=new LH(256);function wC(d,a,l,f,p=[]){const _={},y={},N={},L=function bC(d,a){const{text:l,block:f}=H7(d,a);if(void 0===f)return{text:l};{const[p,..._]=f.split("\u241f"),[y,N]=p.split("@@",2);let[L,V]=y.split("|",2);return void 0===V&&(V=L,L=void 0),""===V&&(V=void 0),{text:l,meaning:L,description:V,customId:N,legacyIds:_}}}(d[0],d.raw[0]),V=[L.text],$=[];let re=L.text;for(let De=1;De<d.length;De++){const{messagePart:vt,placeholderName:tt=i3(De),associatedMessageId:_t}=OC(d[De],d.raw[De]);re+=`{$${tt}}${vt}`,void 0!==a&&(_[tt]=a[De-1],y[tt]=p[De-1]),$.push(tt),void 0!==_t&&(N[tt]=_t),V.push(vt)}const Se=L.customId||function Ym(d,a=""){let l=Zm(d);if(a){const _=Zm(a);l=function jP(d,a){const l=d[0],p=a[0],y=qP(d[1],a[1]),N=y[0],L=y[1];return[U2(U2(l,p),N),L]}(function zH(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function Jm(d,a){const l=z9.toThePowerOf(0).multiplyBy(a);return z9.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(re,L.meaning||""),ze=L.legacyIds?L.legacyIds.filter(De=>De!==Se):[];return{id:Se,legacyIds:ze,substitutions:_,substitutionLocations:y,text:re,customId:L.customId,meaning:L.meaning||"",description:L.description||"",messageParts:V,messagePartLocations:f,placeholderNames:$,associatedMessageIds:N,location:l}}function OC(d,a){const{text:l,block:f}=H7(d,a);if(void 0===f)return{messagePart:l};{const[p,_]=f.split("@@");return{messagePart:l,placeholderName:p,associatedMessageId:_}}}function H7(d,a){if(":"!==a.charAt(0))return{text:d};{const l=X8(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function i3(d){return 1===d?"PH":"PH_"+(d-1)}function X8(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class F7 extends Error{constructor(a){super(`No translation found for ${AC(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function NC(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function AC(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function Q8(d){$localize.translate||($localize.translate=qF),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function zd(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const p=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:NC(l,p),placeholderNames:f}}(d[a])})}function qF(d,a){try{return function Ob(d,a,l){const f=wC(a,l);let p=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===p;_++)p=d[f.legacyIds[_]];if(void 0===p)throw new F7(f);return[p.messageParts,p.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${AC(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const Ab=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),IC=function(d,...a){if(IC.translate){const f=IC.translate(d,a);d=f[0],a=f[1]}let l=xC(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+xC(d[f],d.raw[f]);return l};function xC(d,a){return":"===a.charAt(0)?d.substring(X8(d,a)+1):d}}},A9=>{A9(A9.s=992)}]);