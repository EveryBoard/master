!function(){var e,t,n,r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k,_,C,w,b,E,S,P,O,T,I,A,R,x,M,N,D,L,F,U,V,B,z,H,G,$,q,j,W,Z,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,he,fe,de,ve,pe,ge,ye,me,ke,_e,Ce,we,be,Ee,Se,Pe,Oe,Te,Ie,Ae,Re,xe,Me,Ne,De,Le,Fe,Ue,Ve,Be,ze,He,Ge,$e,qe,je,We,Ze,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ht,ft,dt,vt,pt,gt,yt,mt,kt,_t,Ct,wt,bt,Et,St,Pt,Ot,Tt,It,At,Rt,xt,Mt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Ht,Gt,$t,qt,jt,Wt,Zt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,hn,fn,dn,vn,pn,gn,yn,mn,kn,_n,Cn,wn,bn,En,Sn,Pn,On,Tn,In,An,Rn,xn,Mn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Hn,Gn,$n,qn,jn,Wn,Zn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,hr,fr,dr,vr,pr,gr,yr,mr,kr,_r,Cr,wr,br,Er,Sr,Pr,Or,Tr,Ir,Ar,Rr,xr,Mr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Hr,Gr,$r,qr,jr,Wr,Zr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,hi,fi,di,vi,pi,gi,yi,mi,ki,_i,Ci,wi,bi,Ei,Si,Pi,Oi,Ti,Ii,Ai,Ri,xi,Mi,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Hi,Gi,$i,qi,ji,Wi,Zi,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,ha,fa,da,va,pa,ga,ya,ma,ka,_a,Ca,wa,ba,Ea,Sa,Pa,Oa,Ta,Ia,Aa,Ra,xa,Ma,Na,Da,La,Fa,Ua,Va,Ba,za,Ha,Ga,$a,qa,ja,Wa,Za,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,ho,fo,vo,po,go,yo,mo,ko,_o,Co,wo,bo,Eo,So,Po,Oo,To,Io,Ao,Ro,xo,Mo,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Ho,Go,$o,qo,jo,Wo,Zo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,hs,fs,ds,vs,ps,gs,ys,ms,ks,_s,Cs,ws,bs,Es,Ss,Ps,Os,Ts,Is,As,Rs,xs,Ms,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Hs,Gs,$s,qs,js,Ws,Zs,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,hu,fu,du,vu,pu,gu,yu,mu,ku,_u,Cu,wu,bu,Eu,Su,Pu,Ou,Tu,Iu,Au,Ru,xu,Mu,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Hu,Gu,$u,qu,ju,Wu,Zu,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,hc,fc,dc,vc,pc,gc,yc,mc,kc,_c,Cc,wc,bc,Ec,Sc,Pc,Oc,Tc,Ic,Ac,Rc,xc,Mc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Hc,Gc,$c,qc,jc,Wc,Zc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,hl,fl,dl,vl,pl,gl,yl,ml,kl,_l,Cl,wl,bl,El,Sl,Pl,Ol,Tl,Il,Al,Rl,xl,Ml,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Hl,Gl,$l,ql,jl,Wl,Zl,Yl,Kl,Ql,Xl,Jl,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,hh,fh,dh,vh,ph,gh,yh,mh,kh,_h,Ch,wh,bh,Eh,Sh,Ph,Oh,Th,Ih,Ah,Rh,xh,Mh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Hh,Gh,$h,qh,jh,Wh,Zh,Yh,Kh,Qh,Xh,Jh,ef,tf,nf,rf,af,of,sf,uf,cf,lf,hf,ff,df,vf,pf,gf,yf,mf,kf,_f,Cf,wf,bf,Ef,Sf,Pf,Of,Tf,If,Af,Rf,xf,Mf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Hf,Gf,$f,qf,jf,Wf,Zf,Yf,Kf,Qf,Xf,Jf,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,hd,fd,dd,vd,pd,gd,yd,md,kd,_d,Cd,wd,bd,Ed,Sd,Pd,Od,Td,Id,Ad,Rd,xd,Md,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Hd,Gd,$d,qd,jd,Wd,Zd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,hv,fv,dv,vv,pv,gv,yv,mv,kv,_v,Cv,wv,bv,Ev,Sv,Pv,Ov,Tv,Iv,Av,Rv,xv,Mv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Hv,Gv,$v,qv,jv,Wv,Zv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,hp,fp,dp,vp,pp,gp,yp,mp,kp,_p,Cp,wp,bp,Ep,Sp,Pp,Op,Tp,Ip,Ap,Rp,xp,Mp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Hp,Gp,$p,qp,jp,Wp,Zp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,hg,fg,dg,vg,pg,gg,yg,mg,kg,_g,Cg;function wg(e){return Ig(e)||Hg(e)||$g(e)||Tg()}function bg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Eg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Eg(Object(n),!0).forEach(function(t){Pg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Og(e,t){return Ig(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||$g(e,t)||Tg()}function Tg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ig(e){if(Array.isArray(e))return e}function Ag(e){var t="function"==typeof Map?new Map:void 0;return Ag=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Rg(e,arguments,Bg(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Dg(r,e)},Ag(e)}function Rg(e,t,n){return Rg=Vg()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Dg(i,n.prototype),i},Rg.apply(null,arguments)}function xg(){return xg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Mg(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},xg.apply(this,arguments)}function Mg(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bg(e)););return e}function Ng(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dg(e,t)}function Dg(e,t){return Dg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Dg(e,t)}function Lg(e){var t=Vg();return function(){var n,r=Bg(e);if(t){var i=Bg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fg(this,n)}}function Fg(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ug(e)}function Ug(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Bg(e){return Bg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bg(e)}function zg(e){return function(e){if(Array.isArray(e))return qg(e)}(e)||Hg(e)||$g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hg(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Gg(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=$g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function $g(e,t){if(e){if("string"==typeof e)return qg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qg(e,t):void 0}}function qg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zg(e,t,n){return t&&Wg(e.prototype,t),n&&Wg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=h)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},h=null,f=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},5615:function(Eg,Tg,Ig){"use strict";var Mg,Dg;function Vg(e){return"function"==typeof e}function Hg(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var $g=Hg(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function qg(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Wg=function(){function e(t){jg(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return Zg(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=Gg(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(h){r.e(h)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(Vg(a))try{a()}catch(i){e=i instanceof $g?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=Gg(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{Qg(c)}catch(f){var l;e=null!==(l=e)&&void 0!==l?l:[],f instanceof $g?e=[].concat(zg(e),zg(f.errors)):e.push(f)}}}catch(h){u.e(h)}finally{u.f()}}if(e)throw new $g(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)Qg(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&qg(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&qg(n,t),t instanceof e&&t._removeParent(this)}}]),e}();Wg.EMPTY=function(){var e=new Wg;return e.closed=!0,e}();var Yg=Wg.EMPTY;function Kg(e){return e instanceof Wg||e&&"closed"in e&&Vg(e.remove)&&Vg(e.add)&&Vg(e.unsubscribe)}function Qg(e){Vg(e)?e():e.unsubscribe()}var Xg=null,Jg=null,ey=void 0,ty=!1,ny=!1,ry={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=ry.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=ry.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function iy(e){ry.setTimeout(function(){if(!Xg)throw e;Xg(e)})}function ay(){}var oy=sy("C",void 0,void 0);function sy(e,t,n){return{kind:e,value:t,error:n}}var uy=null;function cy(e){if(ty){var t=!uy;if(t&&(uy={errorThrown:!1,error:null}),e(),t){var n=uy,r=n.errorThrown,i=n.error;if(uy=null,r)throw i}}else e()}var ly=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,Kg(e)&&e.add(Ug(r))):r.destination=py,r}return Zg(n,[{key:"next",value:function(e){this.isStopped?vy(sy("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?vy(sy("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?vy(oy,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,xg(Bg(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new hy(e,t,n)}}]),n}(Wg),hy=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a,o,s;if(jg(this,n),o=t.call(this),Vg(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,Ug(o)&&ny?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?fy(s):ay,error:fy(null!==(a=r)&&void 0!==a?a:dy),complete:i?fy(i):ay},Fg(o)}return Zg(n)}(ly);function fy(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){ty?function(e){ty&&uy&&(uy.errorThrown=!0,uy.error=e)}(t):iy(t)}}}function dy(e){throw e}function vy(e,t){var n=Jg;n&&ry.setTimeout(function(){return n(e,t)})}var py={closed:!0,next:ay,error:dy,complete:ay},gy="function"==typeof Symbol&&Symbol.observable||"@@observable";function yy(e){return e}var my=function(){var e=function(){function e(t){jg(this,e),t&&(this._subscribe=t)}return Zg(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof ly||function(e){return e&&Vg(e.next)&&Vg(e.error)&&Vg(e.complete)}(e)&&Kg(e)}(e)?e:new hy(e,t,n);return cy(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=ky(t))(function(t,r){var i=new hy({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:gy,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?yy:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=ky(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function ky(e){var t;return null!==(t=null!=e?e:ey)&&void 0!==t?t:Promise}var _y=Hg(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Cy=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return Zg(n,[{key:"lift",value:function(e){var t=new wy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new _y}},{key:"next",value:function(e){var t=this;cy(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=Gg(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;cy(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;cy(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),xg(Bg(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?Yg:(r.push(e),new Wg(function(){return qg(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new my;return e.source=this,e}}]),n}(my);return e.create=function(e,t){return new wy(e,t)},e}(),wy=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).destination=e,i.source=r,i}return Zg(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Yg}}]),n}(Cy);function by(e){return Vg(null==e?void 0:e.lift)}function Ey(e){return function(t){if(by(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Sy=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s,u,c,l;return jg(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:xg((s=Ug(l),Bg(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:xg((u=Ug(l),Bg(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:xg((c=Ug(l),Bg(n.prototype)),"_complete",c),l}return Zg(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;xg(Bg(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(ly);function Py(e,t){return Ey(function(n,r){var i=0;n.subscribe(new Sy(r,function(n){r.next(e.call(t,n,i++))}))})}function Oy(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Ty(e){return this instanceof Ty?(this.v=e,this):new Ty(e)}function Iy(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Ty?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Ay(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var Ry=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function xy(e){return Vg(null==e?void 0:e.then)}function My(e){return Vg(e[gy])}function Ny(e){return Symbol.asyncIterator&&Vg(null==e?void 0:e[Symbol.asyncIterator])}function Dy(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var Ly="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Fy(e){return Vg(null==e?void 0:e[Ly])}function Uy(e){return Iy(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Ty(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Ty(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Ty(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function Vy(e){return Vg(null==e?void 0:e.getReader)}function By(e){if(e instanceof my)return e;if(null!=e){if(My(e))return function(e){return new my(function(t){var n=e[gy]();if(Vg(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Ry(e))return function(e){return new my(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(xy(e))return function(e){return new my(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,iy)})}(e);if(Ny(e))return zy(e);if(Fy(e))return function(e){return new my(function(t){var n,r=Gg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(Vy(e))return function(e){return zy(Uy(e))}(e)}throw Dy(e)}function zy(e){return new my(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Ay(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function Hy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Gy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Vg(t)?Gy(function(n,r){return Py(function(e,i){return t(n,e,r,i)})(By(e(n,r)))},n):("number"==typeof t&&(n=t),Ey(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,h=!1,f=function(){h&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;By(n(i,l++)).subscribe(new Sy(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}f()}catch(n){t.error(n)}}))};return e.subscribe(new Sy(t,function(e){return c<r?d(e):u.push(e)},function(){h=!0,f()})),function(){}}(t,r,e,n)}))}function $y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Gy(yy,e)}var qy=new my(function(e){return e.complete()});function jy(e){return e[e.length-1]}function Wy(e){return Vg(jy(e))?e.pop():void 0}function Zy(e){return function(e){return e&&Vg(e.schedule)}(jy(e))?e.pop():void 0}function Yy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ey(function(n,r){n.subscribe(new Sy(r,function(n){return Hy(r,e,function(){return r.next(n)},t)},function(){return Hy(r,e,function(){return r.complete()},t)},function(n){return Hy(r,e,function(){return r.error(n)},t)}))})}function Ky(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ey(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Qy(e,t){if(!e)throw new Error("Iterable cannot be null");return new my(function(n){Hy(n,t,function(){var r=e[Symbol.asyncIterator]();Hy(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Xy(e,t){return t?function(e,t){if(null!=e){if(My(e))return function(e,t){return By(e).pipe(Ky(t),Yy(t))}(e,t);if(Ry(e))return function(e,t){return new my(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(xy(e))return function(e,t){return By(e).pipe(Ky(t),Yy(t))}(e,t);if(Ny(e))return Qy(e,t);if(Fy(e))return function(e,t){return new my(function(n){var r;return Hy(n,t,function(){r=e[Ly](),Hy(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return Vg(null==r?void 0:r.return)&&r.return()}})}(e,t);if(Vy(e))return function(e,t){return Qy(Uy(e),t)}(e,t)}throw Dy(e)}(e,t):By(e)}function Jy(e){return e<=0?function(){return qy}:Ey(function(t,n){var r=0;t.subscribe(new Sy(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function em(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(Jy(1)).subscribe(function(){return e()})}function tm(e){for(var t in e)if(e[t]===tm)return t;throw Error("Could not find renamed property on target object.")}function nm(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function rm(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(rm).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function im(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var am=tm({__forward_ref__:tm});function om(e){return e.__forward_ref__=om,e.toString=function(){return rm(this())},e}function sm(e){return um(e)?e():e}function um(e){return"function"==typeof e&&e.hasOwnProperty(am)&&e.__forward_ref__===om}var cm=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return Zg(n)}(Ag(Error));function lm(e){return"string"==typeof e?e:null==e?"":String(e)}function hm(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():lm(e)}function fm(e,t){var n=t?" in ".concat(t):"";throw new cm("201","No provider for ".concat(hm(e)," found").concat(n))}function dm(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function vm(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function pm(e){return{providers:e.providers||[],imports:e.imports||[]}}function gm(e){return ym(e,_m)||ym(e,wm)}function ym(e,t){return e.hasOwnProperty(t)?e[t]:null}function mm(e){return e&&(e.hasOwnProperty(Cm)||e.hasOwnProperty(bm))?e[Cm]:null}var km,_m=tm({"\u0275prov":tm}),Cm=tm({"\u0275inj":tm}),wm=tm({ngInjectableDef:tm}),bm=tm({ngInjectorDef:tm}),Em=((Em=Em||{})[Em.Default=0]="Default",Em[Em.Host=1]="Host",Em[Em.Self=2]="Self",Em[Em.SkipSelf=4]="SkipSelf",Em[Em.Optional=8]="Optional",Em);function Sm(e){var t=km;return km=e,t}function Pm(e,t,n){var r=gm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Em.Optional?null:void 0!==t?t:void fm(rm(e),"Injector")}function Om(e){return{toString:e}.toString()}var Tm=((Tm=Tm||{})[Tm.OnPush=0]="OnPush",Tm[Tm.Default=1]="Default",Tm),Im=((Im=Im||{})[Im.Emulated=0]="Emulated",Im[Im.None=2]="None",Im[Im.ShadowDom=3]="ShadowDom",Im),Am="undefined"!=typeof globalThis&&globalThis,Rm="undefined"!=typeof window&&window,xm="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Mm=Am||"undefined"!=typeof global&&global||Rm||xm,Nm={},Dm=[],Lm=tm({"\u0275cmp":tm}),Fm=tm({"\u0275dir":tm}),Um=tm({"\u0275pipe":tm}),Vm=tm({"\u0275mod":tm}),Bm=tm({"\u0275loc":tm}),zm=tm({"\u0275fac":tm}),Hm=tm({__NG_ELEMENT_ID__:tm}),Gm=0;function $m(e){return Om(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Tm.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Dm,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Im.Emulated,id:"c",styles:e.styles||Dm,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=Gm++,n.inputs=Ym(e.inputs,t),n.outputs=Ym(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(qm)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(jm)}:null,n})}function qm(e){return Xm(e)||function(e){return e[Fm]||null}(e)}function jm(e){return function(e){return e[Um]||null}(e)}var Wm={};function Zm(e){return Om(function(){var t={type:e.type,bootstrap:e.bootstrap||Dm,declarations:e.declarations||Dm,imports:e.imports||Dm,exports:e.exports||Dm,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(Wm[e.id]=e.type),t})}function Ym(e,t){if(null==e)return Nm;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var Km=$m;function Qm(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Xm(e){return e[Lm]||null}function Jm(e,t){var n=e[Vm]||null;if(!n&&!0===t)throw new Error("Type ".concat(rm(e)," does not have '\u0275mod' property."));return n}function ek(e){return Array.isArray(e)&&"object"==typeof e[1]}function tk(e){return Array.isArray(e)&&!0===e[1]}function nk(e){return 0!=(8&e.flags)}function rk(e){return 2==(2&e.flags)}function ik(e){return 1==(1&e.flags)}function ak(e){return null!==e.template}function ok(e){return 0!=(512&e[2])}function sk(e,t){return e.hasOwnProperty(zm)?e[zm]:null}var uk=function(){function e(t,n,r){jg(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return Zg(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function ck(){return lk}function lk(e){return e.type.prototype.ngOnChanges&&(e.setInput=fk),hk}function hk(){var e=vk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===Nm)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function fk(e,t,n,r){var i=vk(e)||function(e,t){return e[dk]=t}(e,{previous:Nm,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new uk(u&&u.currentValue,t,o===Nm),e[r]=t}ck.ngInherit=!0;var dk="__ngSimpleChanges__";function vk(e){return e[dk]||null}var pk,gk="http://www.w3.org/2000/svg";function yk(){return void 0!==pk?pk:"undefined"!=typeof document?document:void 0}function mk(e){return!!e.listen}var kk={createRenderer:function(e,t){return yk()}};function _k(e){for(;Array.isArray(e);)e=e[0];return e}function Ck(e,t){return _k(t[e])}function wk(e,t){return _k(t[e.index])}function bk(e,t){return e.data[t]}function Ek(e,t){return e[t]}function Sk(e,t){var n=t[e];return ek(n)?n:n[0]}function Pk(e){return 4==(4&e[2])}function Ok(e){return 128==(128&e[2])}function Tk(e,t){return null==t?null:e[t]}function Ik(e){e[18]=0}function Ak(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Rk={lFrame:r_(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function xk(){return Rk.bindingsEnabled}function Mk(){return Rk.lFrame.lView}function Nk(){return Rk.lFrame.tView}function Dk(e){return Rk.lFrame.contextLView=e,e[8]}function Lk(){for(var e=Fk();null!==e&&64===e.type;)e=e.parent;return e}function Fk(){return Rk.lFrame.currentTNode}function Uk(){var e=Rk.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Vk(e,t){var n=Rk.lFrame;n.currentTNode=e,n.isParent=t}function Bk(){return Rk.lFrame.isParent}function zk(){Rk.lFrame.isParent=!1}function Hk(){return Rk.isInCheckNoChangesMode}function Gk(e){Rk.isInCheckNoChangesMode=e}function $k(){var e=Rk.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function qk(){return Rk.lFrame.bindingIndex}function jk(){return Rk.lFrame.bindingIndex++}function Wk(e){var t=Rk.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Zk(e){Rk.lFrame.inI18n=e}function Yk(e,t){var n=Rk.lFrame;n.bindingIndex=n.bindingRootIndex=e,Kk(t)}function Kk(e){Rk.lFrame.currentDirectiveIndex=e}function Qk(){return Rk.lFrame.currentQueryIndex}function Xk(e){Rk.lFrame.currentQueryIndex=e}function Jk(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function e_(e,t,n){if(n&Em.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&Em.Host||(r=Jk(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=Rk.lFrame=n_();return a.currentTNode=t,a.lView=e,!0}function t_(e){var t=n_(),n=e[1];Rk.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function n_(){var e=Rk.lFrame,t=null===e?null:e.child;return null===t?r_(e):t}function r_(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function i_(){var e=Rk.lFrame;return Rk.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var a_=i_;function o_(){var e=i_();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function s_(){return Rk.lFrame.selectedIndex}function u_(e){Rk.lFrame.selectedIndex=e}function c_(){var e=Rk.lFrame;return bk(e.tView,e.selectedIndex)}function l_(){Rk.lFrame.currentNamespace=gk}function h_(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function f_(e,t,n){p_(e,t,3,n)}function d_(e,t,n,r){(3&e[2])===n&&p_(e,t,n,r)}function v_(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function p_(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(g_(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function g_(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var y_=Zg(function e(t,n,r){jg(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function m_(e,t,n){for(var r=mk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];__(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function k_(e){return 3===e||4===e||6===e}function __(e){return 64===e.charCodeAt(0)}function C_(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||w_(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function w_(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function b_(e){return-1!==e}function E_(e){return 32767&e}function S_(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var P_=!0;function O_(e){var t=P_;return P_=e,t}var T_=0;function I_(e,t){var n=R_(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,A_(r.data,e),A_(t,null),A_(r.blueprint,null));var i=x_(e,t),a=e.injectorIndex;if(b_(i))for(var o=E_(i),s=S_(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function A_(e,t){e.push(0,0,0,0,0,0,0,0,t)}function R_(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function x_(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function M_(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Hm)&&(r=n[Hm]),null==r&&(r=n[Hm]=T_++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function N_(e,t,n){if(n&Em.Optional)return e;fm(t,"NodeInjector")}function D_(e,t,n,r){if(n&Em.Optional&&void 0===r&&(r=null),0==(n&(Em.Self|Em.Host))){var i=e[9],a=Sm(void 0);try{return i?i.get(t,r,n&Em.Optional):Pm(t,r,n&Em.Optional)}finally{Sm(a)}}return N_(r,t,n)}function L_(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Em.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(Hm)?e[Hm]:void 0;return"number"==typeof t?t>=0?255&t:U_:t}(n);if("function"==typeof a){if(!e_(t,e,r))return r&Em.Host?N_(i,n,r):D_(t,n,r,i);try{var o=a(r);if(null!=o||r&Em.Optional)return o;fm(n)}finally{a_()}}else if("number"==typeof a){var s=null,u=R_(e,t),c=-1,l=r&Em.Host?t[16][6]:null;for((-1===u||r&Em.SkipSelf)&&(-1!==(c=-1===u?x_(e,t):t[u+8])&&G_(r,!1)?(s=t[1],u=E_(c),t=S_(c,t)):u=-1);-1!==u;){var h=t[1];if(H_(a,u,h.data)){var f=V_(u,t,n,s,r,l);if(f!==F_)return f}-1!==(c=t[u+8])&&G_(r,t[1].data[u+8]===l)&&H_(a,u,t)?(s=h,u=E_(c),t=S_(c,t)):u=-1}}}return D_(t,n,r,i)}var F_={};function U_(){return new $_(Lk(),Mk())}function V_(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=B_(s,o,n,null==r?rk(s)&&P_:r!=o&&0!=(3&s.type),i&Em.Host&&a===s);return null!==u?z_(t,o,u,s):F_}function B_(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=o[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(i){var d=o[u];if(d&&ak(d)&&d.type===n)return u}return null}function z_(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof y_}(i)){var o=i;o.resolving&&function(e,t){throw new cm("200","Circular dependency in DI detected for ".concat(e))}(hm(a[n]));var s=O_(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?Sm(o.injectImpl):null;e_(e,r,Em.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=lk(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&Sm(u),O_(s),o.resolving=!1,a_()}}return i}function H_(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function G_(e,t){return!(e&Em.Self||e&Em.Host&&t)}var $_=function(){function e(t,n){jg(this,e),this._tNode=t,this._lView=n}return Zg(e,[{key:"get",value:function(e,t,n){return L_(this._tNode,this._lView,e,n,t)}}]),e}();function q_(e){return Om(function(){for(var t=e.prototype.constructor,n=t[zm]||j_(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[zm]||j_(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function j_(e){return um(e)?function(){var t=j_(sm(e));return t&&t()}:sk(e)}function W_(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(k_(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(Lk(),e)}var Z_="__parameters__";function Y_(e,t,n){return Om(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Rg(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(Z_)?e[Z_]:Object.defineProperty(e,Z_,{value:[]})[Z_];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var K_=function(){function e(t,n){jg(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=vm({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return Zg(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),Q_=new K_("AnalyzeForEntryComponents"),X_=Function;function J_(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),J_(r,t)):t!==e&&t.push(r)}return t}function eC(e,t){e.forEach(function(e){return Array.isArray(e)?eC(e,t):t(e)})}function tC(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function nC(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function rC(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function iC(e,t,n){var r=oC(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function aC(e,t){var n=oC(e,t);if(n>=0)return e[1|n]}function oC(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var sC,uC={},cC="__NG_DI_FLAG__",lC="ngTempTokenPath",hC=/\n/gm,fC="__source",dC=tm({provide:String,useValue:tm});function vC(e){var t=sC;return sC=e,t}function pC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em.Default;if(void 0===sC)throw new Error("inject() must be called from an injection context");return null===sC?Pm(e,void 0,t):sC.get(e,t&Em.Optional?null:void 0,t)}function gC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em.Default;return(km||pC)(sm(e),t)}function yC(e){for(var t=[],n=0;n<e.length;n++){var r=sm(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=Em.Default,o=0;o<r.length;o++){var s=r[o],u=kC(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(gC(i,a))}else t.push(gC(r))}return t}function mC(e,t){return e[cC]=t,e.prototype[cC]=t,e}function kC(e){return e[cC]}function _C(e,t,n,r){var i=e[lC];throw t[fC]&&i.unshift(t[fC]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=rm(t);if(Array.isArray(t))i=t.map(rm).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):rm(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(hC,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[lC]=null,e}var CC,wC,bC=mC(Y_("Inject",function(e){return{token:e}}),-1),EC=mC(Y_("Optional"),8),SC=mC(Y_("SkipSelf"),4);function PC(e){var t;return(null===(t=function(){if(void 0===CC&&(CC=null,Mm.trustedTypes))try{CC=Mm.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return CC}())||void 0===t?void 0:t.createHTML(e))||e}function OC(e){var t;return(null===(t=function(){if(void 0===wC&&(wC=null,Mm.trustedTypes))try{wC=Mm.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return wC}())||void 0===t?void 0:t.createHTML(e))||e}var TC=function(){function e(t){jg(this,e),this.changingThisBreaksApplicationSecurity=t}return Zg(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),IC=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(TC),AC=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(TC),RC=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(TC),xC=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(TC),MC=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(TC);function NC(e){return e instanceof TC?e.changingThisBreaksApplicationSecurity:e}function DC(e,t){var n=LC(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function LC(e){return e instanceof TC&&e.getTypeName()||null}function FC(e){var t=new VC(e);return function(){try{return!!(new window.DOMParser).parseFromString(PC(""),"text/html")}catch(e){return!1}}()?new UC(t):t}var UC=function(){function e(t){jg(this,e),this.inertDocumentHelper=t}return Zg(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(PC(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),VC=function(){function e(t){if(jg(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return Zg(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=PC(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=PC(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),BC=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,zC=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function HC(e){return(e=String(e)).match(BC)||e.match(zC)?e:"unsafe:"+e}function GC(e){return(e=String(e)).split(",").map(function(e){return HC(e.trim())}).join(", ")}function $C(e){var t,n={},r=Gg(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function qC(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var jC,WC=$C("area,br,col,hr,img,wbr"),ZC=$C("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),YC=$C("rp,rt"),KC=qC(WC,qC(ZC,$C("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),qC(YC,$C("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),qC(YC,ZC)),QC=$C("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),XC=$C("srcset"),JC=qC(QC,XC,$C("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),$C("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ew=$C("script,style,template"),tw=function(){function e(){jg(this,e),this.sanitizedSomething=!1,this.buf=[]}return Zg(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!KC.hasOwnProperty(t))return this.sanitizedSomething=!0,!ew.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(JC.hasOwnProperty(o)){var s=i.value;QC[o]&&(s=HC(s)),XC[o]&&(s=GC(s)),this.buf.push(" ",a,'="',iw(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();KC.hasOwnProperty(t)&&!WC.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(iw(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),nw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rw=/([^\#-~ |!])/g;function iw(e){return e.replace(/&/g,"&amp;").replace(nw,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(rw,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function aw(e,t){var n=null;try{jC=jC||FC(e);var r=t?String(t):"";n=jC.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=jC.getInertBodyElement(r)}while(r!==a);return PC((new tw).sanitizeChildren(ow(n)||n))}finally{if(n)for(var o=ow(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function ow(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var sw=((sw=sw||{})[sw.NONE=0]="NONE",sw[sw.HTML=1]="HTML",sw[sw.STYLE=2]="STYLE",sw[sw.SCRIPT=3]="SCRIPT",sw[sw.URL=4]="URL",sw[sw.RESOURCE_URL=5]="RESOURCE_URL",sw);function uw(e){var t=lw();return t?OC(t.sanitize(sw.HTML,e)||""):DC(e,"HTML")?OC(NC(e)):aw(yk(),lm(e))}function cw(e){var t=lw();return t?t.sanitize(sw.URL,e)||"":DC(e,"URL")?NC(e):HC(lm(e))}function lw(){var e=Mk();return e&&e[12]}var hw="__ngContext__";function fw(e,t){e[hw]=t}function dw(e){var t=function(e){return e[hw]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function vw(e){return e.ngOriginalError}function pw(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var gw=function(){function e(){jg(this,e),this._console=console}return Zg(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||pw;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(vw(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&vw(e);t&&vw(t);)t=vw(t);return t||null}}]),e}(),yw=/^>|^->|<!--|-->|--!>|<!-$/g,mw=/(<|>)/,kw=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Mm);function _w(e){return e instanceof Function?e():e}var Cw,ww=((ww=ww||{})[ww.Important=1]="Important",ww[ww.DashCase=2]="DashCase",ww);function bw(e,t){return Cw(e,t)}function Ew(e){var t=e[3];return tk(t)?t[3]:t}function Sw(e){return Ow(e[13])}function Pw(e){return Ow(e[4])}function Ow(e){for(;null!==e&&!tk(e);)e=e[4];return e}function Tw(e,t,n,r,i){if(null!=r){var a,o=!1;tk(r)?a=r:ek(r)&&(o=!0,r=r[0]);var s=_k(r);0===e&&null!==n?null==i?Bw(t,n,s):Vw(t,n,s,i||null,!0):1===e&&null!==n?Vw(t,n,s,i||null,!0):2===e?Xw(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==_k(n)&&Tw(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];eb(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function Iw(e,t){return mk(e)?e.createText(t):e.createTextNode(t)}function Aw(e,t,n){mk(e)?e.setValue(t,n):t.textContent=n}function Rw(e,t){return e.createComment(function(e){return e.replace(yw,function(e){return e.replace(mw,"\u200b$1\u200b")})}(t))}function xw(e,t,n){return mk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Mw(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Ak(i,-1)),n.splice(r,1)}function Nw(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&Mw(i,r),t>0&&(e[n-1][4]=r[4]);var a=nC(e,10+t);!function(e,t){eb(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function Dw(e,t){if(!(256&t[2])){var n=t[11];mk(n)&&n.destroyNode&&eb(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return Lw(e[1],e);for(;t;){var n=null;if(ek(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)ek(t)&&Lw(t[1],t),t=t[3];null===t&&(t=e),ek(t)&&Lw(t[1],t),n=t&&t[4]}t=n}}(t)}}function Lw(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof y_)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):_k(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var h=i+1;h<r.length;h++)r[h]();t[7]=null}}(e,t),1===t[1].type&&mk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&tk(t[3])){n!==t[3]&&Mw(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function Fw(e,t,n){return Uw(e,t.parent,n)}function Uw(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Im.None||i===Im.Emulated)return null}return wk(r,n)}function Vw(e,t,n,r,i){mk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function Bw(e,t,n){mk(e)?e.appendChild(t,n):t.appendChild(n)}function zw(e,t,n,r,i){null!==r?Vw(e,t,n,r,i):Bw(e,t,n)}function Hw(e,t){return mk(e)?e.parentNode(t):t.parentNode}function Gw(e,t,n){return jw(e,t,n)}function $w(e,t,n){return 40&e.type?wk(e,n):null}var qw,jw=$w;function Ww(e,t){jw=e,qw=t}function Zw(e,t,n,r){var i=Fw(e,r,t),a=t[11],o=Gw(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)zw(a,i,n[s],o,!1);else zw(a,i,n,o,!1);void 0!==qw&&qw(a,r,t,n,i)}function Yw(e,t){if(null!==t){var n=t.type;if(3&n)return wk(t,e);if(4&n)return Qw(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return Yw(e,r);var i=e[t.index];return tk(i)?Qw(-1,i):_k(i)}if(32&n)return bw(t,e)()||_k(e[t.index]);var a=Kw(e,t);return null!==a?Array.isArray(a)?a[0]:Yw(Ew(e[16]),a):Yw(e,t.next)}return null}function Kw(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Qw(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return Yw(r,i)}return t[7]}function Xw(e,t,n){var r=Hw(e,t);r&&function(e,t,n,r){mk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function Jw(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&fw(_k(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)Jw(e,t,n.child,r,i,a,!1),Tw(t,e,i,s,a);else if(32&u){for(var c=bw(n,r),l=void 0;l=c();)Tw(t,e,i,l,a);Tw(t,e,i,s,a)}else 16&u?tb(e,t,r,n,i,a):Tw(t,e,i,s,a);n=o?n.projectionNext:n.next}}function eb(e,t,n,r,i,a){Jw(n,r,e.firstChild,t,i,a,!1)}function tb(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)Tw(t,e,i,s[u],a);else Jw(e,t,s,o[3],i,a,!0)}function nb(e,t,n){mk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function rb(e,t,n){mk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function ib(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var ab="ng-template";function ob(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==ib((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function sb(e){return 4===e.type&&e.value!==ab}function ub(e,t,n){return t===(4!==e.type||n?e.value:ab)}function cb(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(k_(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!ub(e,u,n)||""===u&&1===t.length){if(lb(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!ob(e.attrs,c,n)){if(lb(r))return!1;o=!0}continue}var l=hb(8&r?"class":u,i,sb(e),n);if(-1===l){if(lb(r))return!1;o=!0;continue}if(""!==c){var h;h=l>a?"":i[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==ib(f,c,0)||2&r&&c!==h){if(lb(r))return!1;o=!0}}}}else{if(!o&&!lb(r)&&!lb(u))return!1;if(o&&lb(u))continue;o=!1,r=u|1&r}}return lb(r)||o}function lb(e){return 0==(1&e)}function hb(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function fb(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(cb(e,t[r],n))return!0;return!1}function db(e,t){return e?":not("+t.trim()+")":t}function vb(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!lb(o)&&(t+=db(a,i),i=""),r=o,a=a||!lb(r);n++}return""!==i&&(t+=db(a,i)),t}var pb={};function gb(e){yb(Nk(),Mk(),s_()+e,Hk())}function yb(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&f_(t,i,n)}else{var a=e.preOrderHooks;null!==a&&d_(t,a,0,n)}u_(n)}function mb(e,t){return e<<17|t<<2}function kb(e){return e>>17&32767}function _b(e){return 2|e}function Cb(e){return(131068&e)>>2}function wb(e,t){return-131069&e|t<<2}function bb(e){return 1|e}function Eb(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];Xk(i),o.contentQueries(2,t[a],a)}}}function Sb(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Ik(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function Pb(e,t,n,r,i){var a=e.data[t];if(null===a)a=Ob(e,t,n,r,i),Rk.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=Uk();a.injectorIndex=null===o?-1:o.injectorIndex}return Vk(a,!0),a}function Ob(e,t,n,r,i){var a=Fk(),o=Bk(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function Tb(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Ib(e,t,n){t_(t);try{var r=e.viewQuery;null!==r&&sE(1,r,n);var i=e.template;null!==i&&xb(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Eb(e,t),e.staticViewQueries&&sE(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)nE(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,o_()}}function Ab(e,t,n,r){var i=t[2];if(256!=(256&i)){t_(t);var a=Hk();try{Ik(t),function(e){Rk.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&xb(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&f_(t,s,null)}else{var u=e.preOrderHooks;null!==u&&d_(t,u,0,null),v_(t,0)}if(function(e){for(var t=Sw(e);null!==t;t=Pw(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Ak(a,1),i[2]|=1024}}(t),function(e){for(var t=Sw(e);null!==t;t=Pw(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Ok(r)&&Ab(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&Eb(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&f_(t,c)}else{var l=e.contentHooks;null!==l&&d_(t,l,1),v_(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)u_(~i);else{var a=i,o=n[++r],s=n[++r];Yk(o,a),s(2,t[a])}}}finally{u_(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)eE(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&sE(2,f,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&f_(t,d)}else{var v=e.viewHooks;null!==v&&d_(t,v,2),v_(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Ak(t[3],-1))}finally{o_()}}}function Rb(e,t,n,r){var i=t[10],a=!Hk(),o=Pk(t);try{a&&!o&&i.begin&&i.begin(),o&&Ib(e,t,r),Ab(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function xb(e,t,n,r,i){var a=s_(),o=2&r;try{u_(-1),o&&t.length>20&&yb(e,t,20,Hk()),n(r,i)}finally{u_(a)}}function Mb(e,t,n){if(nk(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function Nb(e,t,n){!xk()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||I_(n,t),fw(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=ak(u);c&&Zb(t,n,u);var l=z_(t,e,s,n);fw(l,t),null!==o&&Qb(0,s-i,l,u,0,o),c&&(Sk(n.index,t)[8]=l)}}(e,t,n,wk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=Rk.lFrame.currentDirectiveIndex;try{u_(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];Kk(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Gb(u,c)}}finally{u_(-1),Kk(o)}}(e,t,n))}function Db(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function Lb(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Fb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Fb(e,t,n,r,i,a,o,s,u,c){var l=20+r,h=l+i,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:pb);return n}(l,h),d="function"==typeof c?c():c;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:s,declTNode:t,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function Ub(e,t,n,r){var i=cE(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&lE(e).push(r,i.length-1))}function Vb(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Bb(e,t,n,r,i,a,o,s){var u,c=wk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(fE(e,n,u,r,i),rk(t)&&function(e,t){var n=Sk(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,mk(a)?a.setProperty(c,r,i):__(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function zb(e,t,n,r){var i=!1;if(xk()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];fb(n,o.selectors,!1)&&(i||(i=[]),M_(I_(n,t),e,o.type),ak(o)?($b(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,jb(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,h=Tb(e,t,a.length,null),f=0;f<a.length;f++){var d=a[f];n.mergedAttrs=C_(n.mergedAttrs,d.hostAttrs),Wb(e,n,t,h,d),qb(h,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),h++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,h=null===i||sb(t)?null:Xb(l,i);a.push(h),o=Vb(l,u,o),s=Vb(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new cm("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=C_(n.mergedAttrs,n.attrs),i}function Hb(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function Gb(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function $b(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function qb(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ak(t)&&(n[""]=e)}}function jb(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Wb(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=sk(i.type)),o=new y_(a,ak(i),null);e.blueprint[r]=o,n[r]=o,Hb(e,t,0,r,Tb(e,n,i.hostVars,pb),i)}function Zb(e,t,n){var r=wk(t,e),i=Lb(n),a=e[10],o=rE(e,Sb(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function Yb(e,t,n,r,i,a){var o=wk(e,t);Kb(t[11],o,a,e.value,n,r,i)}function Kb(e,t,n,r,i,a,o){if(null==a)mk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?lm(a):o(a,r||"",i);mk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function Qb(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],h=o[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function Xb(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Jb(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function eE(e,t){var n=Sk(t,e);if(Ok(n)){var r=n[1];80&n[2]?Ab(r,n,r.template,n[8]):n[5]>0&&tE(n)}}function tE(e){for(var t=Sw(e);null!==t;t=Pw(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];Ab(i,r,i.template,r[8])}else r[5]>0&&tE(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Sk(a[o],e);Ok(s)&&s[5]>0&&tE(s)}}function nE(e,t){var n=Sk(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Ib(r,n,n[8])}function rE(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function iE(e){for(;e;){e[2]|=64;var t=Ew(e);if(ok(e)&&!t)return e;e=t}return null}function aE(e,t,n){var r=t[10];r.begin&&r.begin();try{Ab(e,t,e.template,n)}catch(i){throw hE(t,i),i}finally{r.end&&r.end()}}function oE(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=dw(n),i=r[1];Rb(i,r,i.template,n)}}(e[8])}function sE(e,t,n){Xk(0),t(e,n)}var uE=Promise.resolve(null);function cE(e){return e[7]||(e[7]=[])}function lE(e){return e.cleanup||(e.cleanup=[])}function hE(e,t){var n=e[9],r=n?n.get(gw,null):null;r&&r.handleError(t)}function fE(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function dE(e,t,n){var r=Ck(t,e);Aw(e[11],r,n)}function vE(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=im(i,s):2==a&&(r=im(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var pE,gE=new K_("INJECTOR",-1),yE=function(){function e(){jg(this,e)}return Zg(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uC;if(t===uC){var n=new Error("NullInjectorError: No provider for ".concat(rm(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),mE=new K_("Set Injector scope."),kE={},_E={};function CE(){return void 0===pE&&(pE=new yE),pE}function wE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new bE(e,n,t||CE(),r)}var bE=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;jg(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&eC(n,function(e){return i.processProvider(e,t,n)}),eC([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(gE,PE(void 0,this));var s=this.records.get(mE);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:rm(t))}return Zg(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Em.Default;this.assertNotDestroyed();var r,i=vC(this),a=Sm(void 0);try{if(!(n&Em.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof K_)&&gm(e);o=s&&this.injectableDefInScope(s)?PE(EE(e),kE):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&Em.Self?CE():this.parent).get(e,t=n&Em.Optional&&t===uC?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[lC]=u[lC]||[]).unshift(rm(e)),i)throw u;return _C(u,e,"R3InjectorError",this.source)}throw u}finally{Sm(a),vC(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(rm(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=sm(e)))return!1;var i=mm(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=mm(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{eC(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;eC(i,function(e){return r.processProvider(e,n,i||Dm)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var h=sk(o)||function(){return new o};this.records.set(o,PE(h,kE));var f=i.providers;if(null!=f&&!s){var d=e;eC(f,function(e){return r.processProvider(e,d,f)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=TE(e=sm(e))?e:sm(e&&e.provide),a=OE(r=e)?PE(void 0,r.useValue):PE(SE(r),kE);if(TE(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=PE(void 0,kE,!0)).factory=function(){return yC(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===kE&&(t.value=_E,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=sm(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function EE(e){var t=gm(e),n=null!==t?t.factory:sk(e);if(null!==n)return n;if(e instanceof K_)throw new Error("Token ".concat(rm(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=rC(t,"?");throw new Error("Can't resolve all parameters for ".concat(rm(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[_m]||e[wm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function SE(e,t,n){var r;if(TE(e)){var i=sm(e);return sk(i)||EE(i)}if(OE(e))r=function(){return sm(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,zg(yC(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return gC(sm(e.useExisting))};else{var a=sm(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return sk(a)||EE(a);r=function(){return Rg(a,zg(yC(e.deps)))}}return r}function PE(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function OE(e){return null!==e&&"object"==typeof e&&dC in e}function TE(e){return"function"==typeof e}var IE=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=wE(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},AE=function(){var e=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?IE(e,t,""):IE(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=uC,e.NULL=new yE,e.\u0275prov=vm({token:e,providedIn:"any",factory:function(){return gC(gE)}}),e.__NG_ELEMENT_ID__=-1,e}();function RE(e,t){h_(dw(e)[1],Lk())}function xE(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(ak(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=ME(e.inputs),a.declaredInputs=ME(e.declaredInputs),a.outputs=ME(e.outputs);var o=i.hostBindings;o&&LE(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&NE(e,s),u&&DE(e,u),nm(e.inputs,i.inputs),nm(e.declaredInputs,i.declaredInputs),nm(e.outputs,i.outputs),ak(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var h=0;h<l.length;h++){var f=l[h];f&&f.ngInherit&&f(e),f===xE&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=C_(i.hostAttrs,n=C_(n,i.hostAttrs))}}(r)}function ME(e){return e===Nm?{}:e===Dm?[]:e}function NE(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function DE(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function LE(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var FE=null;function UE(){if(!FE){var e=Mm.Symbol;if(e&&e.iterator)FE=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(FE=r)}}return FE}var VE=function(){function e(t){jg(this,e),this.wrapped=t}return Zg(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function BE(e){return!!zE(e)&&(Array.isArray(e)||!(e instanceof Map)&&UE()in e)}function zE(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function HE(e,t,n){return e[t]=n}function GE(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function $E(e,t,n,r){var i=GE(e,t,n);return GE(e,t+1,r)||i}function qE(e,t,n,r){var i=Mk();return GE(i,jk(),t)&&(Nk(),Yb(c_(),i,e,t,n,r)),qE}function jE(e,t,n,r){return GE(e,jk(),n)?t+lm(n)+r:pb}function WE(e,t,n,r,i,a){var o=$E(e,qk(),n,i);return Wk(2),o?t+lm(n)+r+lm(i)+a:pb}function ZE(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=$E(e,t,n,r);return GE(e,t+2,i)||a}(e,qk(),n,i,o);return Wk(3),u?t+lm(n)+r+lm(i)+a+lm(o)+s:pb}function YE(e,t,n,r,i,a){var o=Mk(),s=jE(o,t,n,r);return s!==pb&&Yb(c_(),o,e,s,i,a),YE}function KE(e,t,n,r,i,a,o,s){var u=Mk(),c=Nk(),l=e+20,h=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=Pb(t,e,4,o||null,Tk(c,s));zb(t,n,l,Tk(c,u)),h_(t,l);var h=l.tViews=Fb(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];Vk(h,!1);var f=u[11].createComment("");Zw(c,u,f,h),fw(f,u),rE(u,u[l]=Jb(f,u,f,h)),ik(h)&&Nb(c,u,h),null!=o&&Db(u,h,s)}function QE(e){return Ek(Rk.lFrame.contextLView,20+e)}function XE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em.Default,n=Mk();return null===n?gC(e,t):L_(Lk(),n,sm(e),t)}function JE(e,t,n){var r=Mk();return GE(r,jk(),t)&&Bb(Nk(),c_(),r,e,t,r[11],n,!1),JE}function eS(e,t,n,r,i){var a=i?"class":"style";fE(e,n,t.inputs[a],a,r)}function tS(e,t,n,r){var i=Mk(),a=Nk(),o=20+e,s=i[11],u=i[o]=xw(s,t,Rk.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=Pb(t,e,2,i,Tk(s,a));return zb(t,n,u,Tk(s,o)),null!==u.attrs&&vE(u,u.attrs,!1),null!==u.mergedAttrs&&vE(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];Vk(c,!0);var l=c.mergedAttrs;null!==l&&m_(s,u,l);var h=c.classes;null!==h&&rb(s,u,h);var f=c.styles;null!==f&&nb(s,u,f),64!=(64&c.flags)&&Zw(a,i,u,c),0===Rk.lFrame.elementDepthCount&&fw(u,i),Rk.lFrame.elementDepthCount++,ik(c)&&(Nb(a,i,c),Mb(a,c,i)),null!==r&&Db(i,c)}function nS(){var e=Lk();Bk()?zk():Vk(e=e.parent,!1);var t=e;Rk.lFrame.elementDepthCount--;var n=Nk();n.firstCreatePass&&(h_(n,e),nk(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&eS(n,t,Mk(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&eS(n,t,Mk(),t.stylesWithoutHost,!1)}function rS(e,t,n,r){tS(e,t,n,r),nS()}function iS(e,t,n){var r=Mk(),i=Nk(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=Tk(a,r),s=Pb(t,e,8,"ng-container",o);return null!==o&&vE(s,o,!0),zb(t,n,s,Tk(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];Vk(o,!0);var s=r[a]=r[11].createComment("");Zw(i,r,s,o),fw(s,r),ik(o)&&(Nb(i,r,o),Mb(i,o,r)),null!=n&&Db(r,o)}function aS(){var e=Lk(),t=Nk();Bk()?zk():Vk(e=e.parent,!1),t.firstCreatePass&&(h_(t,e),nk(e)&&t.queries.elementEnd(e))}function oS(){return Mk()}function sS(e){return!!e&&"function"==typeof e.then}var uS=function(e){return!!e&&"function"==typeof e.subscribe};function cS(e,t,n,r){var i=Mk(),a=Nk(),o=Lk();return function(e,t,n,r,i,a,o,s){var u=ik(r),c=e.firstCreatePass&&lE(e),l=t[8],h=cE(t),f=!0;if(3&r.type||s){var d=wk(r,t),v=s?s(d):d,p=h.length,g=s?function(e){return s(_k(e[r.index]))}:r.index;if(mk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,f=!1;else{a=hS(r,t,l,a,!1);var m=n.listen(v,i,a);h.push(a,m),c&&c.push(i,g,p,p+1)}}else a=hS(r,t,l,a,!0),v.addEventListener(i,a,o),h.push(a),c&&c.push(i,g,p,o)}else a=hS(r,t,l,a,!1);var k,_=r.outputs;if(f&&null!==_&&(k=_[i])){var C=k.length;if(C)for(var w=0;w<C;w+=2){var b=t[k[w]][k[w+1]].subscribe(a),E=h.length;h.push(a,b),c&&c.push(i,r.index,E,-(E+1))}}}(a,i,i[11],o,e,t,!!n,r),cS}function lS(e,t,n,r){try{return!1!==n(r)}catch(i){return hE(e,i),!1}}function hS(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?Sk(e.index,t):t;0==(32&t[2])&&iE(o);for(var s=lS(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=lS(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function fS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Rk.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Rk.lFrame.contextLView))[8]}(e)}function dS(e,t,n){return vS(e,"",t,"",n),dS}function vS(e,t,n,r,i){var a=Mk(),o=jE(a,t,n,r);return o!==pb&&Bb(Nk(),c_(),a,e,o,a[11],i,!1),vS}function pS(e,t,n,r,i,a,o){var s=Mk(),u=WE(s,t,n,r,i,a);return u!==pb&&Bb(Nk(),c_(),s,e,u,s[11],o,!1),pS}function gS(e,t,n,r,i,a,o,s,u){var c=Mk(),l=ZE(c,t,n,r,i,a,o,s);return l!==pb&&Bb(Nk(),c_(),c,e,l,c[11],u,!1),gS}function yS(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?kb(a):Cb(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];mS(e[s],t)&&(u=!0,e[s+1]=r?bb(c):_b(c)),s=r?kb(c):Cb(c)}u&&(e[n+1]=r?_b(a):bb(a))}function mS(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&oC(e,t)>=0}var kS={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function _S(e){return e.substring(kS.key,kS.keyEnd)}function CS(e){return e.substring(kS.value,kS.valueEnd)}function wS(e,t){var n=kS.textEnd,r=kS.key=bS(e,t,n);return n===r?-1:(r=kS.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=ES(e,r,n),r=kS.value=bS(e,r,n),r=kS.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=SS(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=SS(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),ES(e,r,n))}function bS(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function ES(e,t,n,r){return(t=bS(e,t,n))<n&&t++,t}function SS(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function PS(e,t){return function(e,t,n,r){var i=Mk(),a=Nk(),o=Wk(2);a.firstUpdatePass&&AS(a,e,o,true),t!==pb&&GE(i,o,t)&&NS(a,a.data[s_()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=rm(NC(e))),e}(t),true,o)}(e,t),PS}function OS(e){!function(e,t,n,r){var i=Nk(),a=Wk(2);i.firstUpdatePass&&AS(i,null,a,r);var o=Mk();if(n!==pb&&GE(o,a,n)){var s=i.data[s_()];if(FS(s,r)&&!IS(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=im(u,n||"")),eS(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===pb&&(i=Dm);for(var u=0,c=0,l=0<i.length?i[0]:null,h=0<a.length?a[0]:null;null!==l||null!==h;){var f=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===h?(u+=2,c+=2,f!==d&&(p=h,v=d)):null===h||null!==l&&l<h?(u+=2,p=l):(c+=2,p=h,v=d),null!==p&&NS(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,h=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return Dm;var r=[],i=NC(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(MS,TS,e,!1)}function TS(e,t){for(var n=function(e){return function(e){kS.key=0,kS.keyEnd=0,kS.value=0,kS.valueEnd=0,kS.textEnd=e.length}(e),wS(e,bS(e,0,kS.textEnd))}(t);n>=0;n=wS(t,n))MS(e,_S(t),CS(t))}function IS(e,t){return t>=e.expandoStartIndex}function AS(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[s_()],o=IS(e,n);FS(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=Rk.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=xS(n=RS(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=RS(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==Cb(r))return e[kb(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[kb(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=xS(s=RS(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=xS(r,e[a].hostAttrs,n);return xS(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=kb(o),u=Cb(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||oC(h,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var f=kb(e[s+1]);e[r+1]=mb(f,s),0!==f&&(e[f+1]=wb(e[f+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=mb(s,0),0!==s&&(e[s+1]=wb(e[s+1],r)),s=r;else e[r+1]=mb(u,0),0===s?s=r:e[u+1]=wb(e[u+1],r),u=r;l&&(e[r+1]=_b(e[r+1])),yS(e,c,r,!0),yS(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&oC(a,t)>=0&&(n[r+1]=bb(n[r+1]))}(t,c,e,r,a),o=mb(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function RS(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=xS(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function xS(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),iC(e,o,!!n||t[++a]))}return void 0===e?null:e}function MS(e,t,n){iC(e,t,NC(n))}function NS(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];LS(function(e){return 1==(1&e)}(c)?DS(u,t,n,i,Cb(c),o):void 0)||(LS(a)||function(e){return 2==(2&e)}(c)&&(a=DS(u,null,n,i,s,o)),function(e,t,n,r,i){var a=mk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:ww.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=ww.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,Ck(s_(),n),i,a))}}function DS(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[i+1];f===pb&&(f=h?Dm:void 0);var d=h?aC(f,r):l===r?f:void 0;if(c&&!LS(d)&&(d=aC(u,r)),LS(d)&&(o=d,s))return o;var v=e[i+1];i=s?kb(v):Cb(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=aC(p,r))}return o}function LS(e){return void 0!==e}function FS(e,t){return 0!=(e.flags&(t?16:32))}function US(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Mk(),r=Nk(),i=e+20,a=r.firstCreatePass?Pb(r,i,1,t,null):r.data[i],o=n[i]=Iw(n[11],t);Zw(r,n,o,a),Vk(a,!1)}function VS(e){return BS("",e,""),VS}function BS(e,t,n){var r=Mk(),i=jE(r,e,t,n);return i!==pb&&dE(r,s_(),i),BS}function zS(e,t,n,r,i){var a=Mk(),o=WE(a,e,t,n,r,i);return o!==pb&&dE(a,s_(),o),zS}function HS(e,t,n,r,i,a,o){var s=Mk(),u=ZE(s,e,t,n,r,i,a,o);return u!==pb&&dE(s,s_(),u),HS}function GS(e,t,n){var r=Mk();return GE(r,jk(),t)&&Bb(Nk(),c_(),r,e,t,r[11],n,!0),GS}var $S=void 0,qS=["en",[["a","p"],["AM","PM"],$S],[["AM","PM"],$S,$S],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],$S,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],$S,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",$S,"{1} 'at' {0}",$S],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],jS={};function WS(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=YS(t);if(n)return n;var r=t.split("-")[0];if(n=YS(r))return n;if("en"===r)return qS;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function ZS(e){return WS(e)[KS.PluralCase]}function YS(e){return e in jS||(jS[e]=Mm.ng&&Mm.ng.common&&Mm.ng.common.locales&&Mm.ng.common.locales[e]),jS[e]}var KS=((KS=KS||{})[KS.LocaleId=0]="LocaleId",KS[KS.DayPeriodsFormat=1]="DayPeriodsFormat",KS[KS.DayPeriodsStandalone=2]="DayPeriodsStandalone",KS[KS.DaysFormat=3]="DaysFormat",KS[KS.DaysStandalone=4]="DaysStandalone",KS[KS.MonthsFormat=5]="MonthsFormat",KS[KS.MonthsStandalone=6]="MonthsStandalone",KS[KS.Eras=7]="Eras",KS[KS.FirstDayOfWeek=8]="FirstDayOfWeek",KS[KS.WeekendRange=9]="WeekendRange",KS[KS.DateFormat=10]="DateFormat",KS[KS.TimeFormat=11]="TimeFormat",KS[KS.DateTimeFormat=12]="DateTimeFormat",KS[KS.NumberSymbols=13]="NumberSymbols",KS[KS.NumberFormats=14]="NumberFormats",KS[KS.CurrencyCode=15]="CurrencyCode",KS[KS.CurrencySymbol=16]="CurrencySymbol",KS[KS.CurrencyName=17]="CurrencyName",KS[KS.Currencies=18]="Currencies",KS[KS.Directionality=19]="Directionality",KS[KS.PluralCase=20]="PluralCase",KS[KS.ExtraData=21]="ExtraData",KS),QS=["zero","one","two","few","many"],XS="en-US",JS={marker:"element"},eP={marker:"ICU"},tP=((tP=tP||{})[tP.SHIFT=2]="SHIFT",tP[tP.APPEND_EAGERLY=1]="APPEND_EAGERLY",tP[tP.COMMENT=2]="COMMENT",tP),nP=XS;function rP(e){(function(e,t){null==e&&dm("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(nP=e.toLowerCase().replace(/_/g,"-"))}function iP(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?$w(e,0,n):_k(n[i])}function aP(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)Vw(e,o,n[a[u]],s,!1)}}function oP(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];sP(r)||uP(r,t)&&null===cP(r)&&lP(r,t.index)}}function sP(e){return!(64&e.type)}function uP(e,t){return sP(t)||e.index>t.index}function cP(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function lP(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(Ww(iP,aP),e.insertBeforeIndex=t)}function hP(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function fP(e,t,n){var r=Ob(e,n,64,null,null);return oP(t,r),r}function dP(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function vP(e){return e>>>17}function pP(e){return(131070&e)>>>1}var gP=0,yP=0;function mP(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=Iw(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=vP(u),h=void 0,f=void 0;if(null===o&&(o=l,i=Hw(a,r)),l===o?(h=r,f=i):(h=null,f=_k(n[l])),null!==f){var d=pP(u);Vw(a,f,n[d],h,!1);var v=hP(e,d);if(null!==v&&"object"==typeof v){var p=dP(v,n);null!==p&&mP(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];Kb(a,Ck(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case eP:var m=t[++s],k=t[++s];null===n[k]&&fw(n[k]=Rw(a,m),n);break;case JS:var _=t[++s],C=t[++s];null===n[C]&&fw(n[C]=xw(a,_,null),n)}}}function kP(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=lm(t[r-l]);else{var h=l>>>2;switch(3&l){case 1:var f=n[++c],d=n[++c],v=e.data[h];"string"==typeof v?Kb(t[11],t[h],null,v,f,u,d):Bb(e,v,t,f,u,t[11],d,!1);break;case 0:var p=t[h];null!==p&&Aw(t[11],p,u);break;case 2:CP(e,hP(e,h),t,u);break;case 3:_P(e,hP(e,h),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=hP(e,g>>>2);t[y.currentCaseLViewIndex]<0&&_P(e,y,r,t)}}a+=s}}function _P(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=gP;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),kP(e,r,t.update[i],n,a)}}function CP(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=ZS(t)(parseInt(e,10)),r=QS[n];return void 0!==r?r:"other"}(t,nP);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(dP(t,n)!==i&&(wP(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&mP(e,t.create[i],n,a)}}function wP(e,t,n){var r=dP(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Ck(o,n);null!==s&&Xw(n[11],s)}else wP(e,hP(e,~o),n)}}function bP(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=dP(e,n);t=null!==i?e.remove[i]:Dm}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var EP=/\ufffd(\d+):?\d*\ufffd/gi,SP=/\ufffd(\d+)\ufffd/,PP=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,OP=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,TP=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,IP=/\uE500/g;function AP(e,t,n,r,i,a,o){var s=Tb(e,r,1,null),u=s<<tP.SHIFT,c=Uk();t===c&&(c=null),null===c&&(u|=tP.APPEND_EAGERLY),o&&(u|=tP.COMMENT,function(e){void 0===Cw&&(Cw=e())}(bP)),i.push(u,null===a?"":a);var l=Ob(e,s,o?32:1,null===a?"":a,null);oP(n,l);var h=l.index;return Vk(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(Ww(iP,aP),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&dm("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,h),l}function RP(e,t,n,r,i,a,o){var s=o.match(EP),u=AP(e,t,n,a,r,s?null:o,!1);s&&xP(i,o,u.index,null,0,null)}function xP(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(EP),l=0,h=0;h<c.length;h++){var f=c[h];if(1&h){var d=i+parseInt(f,10);e.push(-1-d),l|=MP(d)}else""!==f&&e.push(f)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function MP(e){return 1<<Math.min(e,31)}function NP(e){for(var t,n,r="",i=0,a=!1;null!==(t=OP.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function DP(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:Tb(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(MP(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],h=[],f=0;f<l.length;f++){var d=l[f];if("string"!=typeof d){var v=h.push(d)-1;l[f]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=UP(e,s,t,n,r,i.cases[c],l.join(""),h)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function LP(e){for(var t=[],n=[],r=1,i=0,a=FP(e=e.replace(PP,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=FP(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function FP(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);PP.test(s)?i.push(LP(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function UP(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var h=FC(yk()).getInertBodyElement(o),f=ow(h)||h;return f?VP(e,t,n,r,u,c,l,f,i,s,0):0}function VP(e,t,n,r,i,a,o,s,u,c,l){for(var h=0,f=s.firstChild;f;){var d=Tb(e,n,1,null);switch(f.nodeType){case Node.ELEMENT_NODE:var v=f,p=v.tagName.toLowerCase();if(KC.hasOwnProperty(p)){HP(i,JS,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(EP)?JC.hasOwnProperty(k)&&xP(o,m.value,d,m.name,0,QC[k]?HC:XC[k]?GC:null):GP(i,d,m)}h=VP(e,t,n,r,i,a,o,f,d,c,l+1)|h,BP(a,d,l)}break;case Node.TEXT_NODE:var _=f.textContent||"",C=_.match(EP);HP(i,null,C?"":_,u,d),BP(a,d,l),C&&(h=xP(o,_,d,null,0,null)|h);break;case Node.COMMENT_NODE:var w=SP.exec(f.textContent||"");if(w){var b=c[parseInt(w[1],10)];HP(i,eP,"",u,d),DP(e,n,r,u,b,d),zP(a,d,l)}}f=f.nextSibling}return h}function BP(e,t,n){0===n&&e.push(t)}function zP(e,t,n){0===n&&(e.push(~t),e.push(t))}function HP(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function GP(e,t,n){e.push(t<<1|1,n.name,n.value)}function $P(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=Nk(),i=Mk(),a=20+e,o=Tk(r.consts,t),s=Uk();r.firstCreatePass&&function(e,t,n,r,i,a){var o=Uk(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return NP(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return NP(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(IP," ")}(i).split(TP),h=0;h<l.length;h++){var f=l[h];if(0==(1&h))for(var d=FP(f),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&RP(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));DP(e,n,u,t,y,AP(e,o,c[0],n,s,"",!0).index)}}else{var m=47===f.charCodeAt(0),k=(f.charCodeAt(m?1:0),20+Number.parseInt(f.substring(m?2:1)));if(m)c.shift(),Vk(Uk(),!1);else{var _=fP(e,c[0],k);c.unshift([]),Vk(_,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=Uw(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&tP.COMMENT)===tP.COMMENT,c=(o&tP.APPEND_EAGERLY)===tP.APPEND_EAGERLY,l=o>>>tP.SHIFT,h=e[l];null===h&&(h=e[l]=u?i.createComment(s):Iw(i,s)),c&&null!==n&&Vw(i,n,h,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),Zk(!0)}function qP(){Zk(!1)}function jP(e,t,n){$P(e,t,n),qP()}function WP(e){return function(e){e&&(gP|=1<<Math.min(yP,31)),yP++}(GE(Mk(),jk(),e)),WP}function ZP(e){!function(e,t,n){if(yP>0){var r=e.data[n];kP(e,t,Array.isArray(r)?r:r.update,qk()-yP-1,gP)}gP=0,yP=0}(Nk(),Mk(),e+20)}function YP(e,t,n,r,i){if(e=sm(e),Array.isArray(e))for(var a=0;a<e.length;a++)YP(e[a],t,n,r,i);else{var o=Nk(),s=Mk(),u=TE(e)?e:sm(e.provide),c=SE(e),l=Lk(),h=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(TE(e)||!e.multi){var v=new y_(c,i,XE),p=XP(u,t,i?h:h+d,f);-1===p?(M_(I_(l,s),o,u),KP(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=XP(u,t,h+d,f),y=XP(u,t,h,h+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){M_(I_(l,s),o,u);var _=function(e,t,n,r,i){var a=new y_(e,n,XE);return a.multi=[],a.index=t,a.componentProviders=0,QP(a,i,r&&!n),a}(i?eO:JP,n.length,i,r,c);!i&&k&&(n[y].providerFactory=_),KP(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(_),s.push(_)}else KP(o,e,g>-1?g:y,QP(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function KP(e,t,n,r){var i=TE(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function QP(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function XP(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function JP(e,t,n,r){return tO(this.multi,[])}function eO(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=z_(n,n[1],this.providerFactory.index,r);tO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else tO(a,i=[]);return i}function tO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function nO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=Nk();if(r.firstCreatePass){var i=ak(e);YP(n,r.data,r.blueprint,i,!0),YP(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var rO=Zg(function e(){jg(this,e)}),iO=function(){function e(){jg(this,e)}return Zg(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(rm(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),aO=function(){var e=Zg(function e(){jg(this,e)});return e.NULL=new iO,e}();function oO(){}function sO(e,t){return new cO(wk(e,t))}var uO=function(){return sO(Lk(),Mk())},cO=function(){var e=Zg(function e(t){jg(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=uO,e}();function lO(e){return e instanceof cO?e.nativeElement:e}var hO=Zg(function e(){jg(this,e)}),fO=function(){var e=Zg(function e(){jg(this,e)});return e.__NG_ELEMENT_ID__=function(){return dO()},e}(),dO=function(){var e=Mk(),t=Sk(Lk().index,e);return function(e){return e[11]}(ek(t)?t:e)},vO=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275prov=vm({token:e,providedIn:"root",factory:function(){return null}}),e}(),pO=Zg(function e(t){jg(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),gO=new pO("12.2.16"),yO=function(){function e(){jg(this,e)}return Zg(e,[{key:"supports",value:function(e){return BE(e)}},{key:"create",value:function(e){return new kO(e)}}]),e}(),mO=function(e,t){return t},kO=function(){function e(t){jg(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||mO}return Zg(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<bO(n,r,i)?t:n,o=bO(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!BE(e))throw new Error("Error trying to diff '".concat(rm(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[UE()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new _O(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new wO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),_O=Zg(function e(t,n){jg(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),CO=function(){function e(){jg(this,e),this._head=null,this._tail=null}return Zg(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),wO=function(){function e(){jg(this,e),this.map=new Map}return Zg(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new CO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function bO(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var EO=function(){function e(){jg(this,e)}return Zg(e,[{key:"supports",value:function(e){return e instanceof Map||zE(e)}},{key:"create",value:function(){return new SO}}]),e}(),SO=function(){function e(){jg(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Zg(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||zE(e)))throw new Error("Error trying to diff '".concat(rm(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new PO(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),PO=Zg(function e(t){jg(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function OO(){return new TO([new yO])}var TO=function(){var e=function(){function e(t){jg(this,e),this.factories=t}return Zg(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||OO())},deps:[[e,new SC,new EC]]}}}]),e}();return e.\u0275prov=vm({token:e,providedIn:"root",factory:OO}),e}();function IO(){return new AO([new EO])}var AO=function(){var e=function(){function e(t){jg(this,e),this.factories=t}return Zg(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||IO())},deps:[[e,new SC,new EC]]}}}]),e}();return e.\u0275prov=vm({token:e,providedIn:"root",factory:IO}),e}();function RO(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(_k(a)),tk(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&RO(s[1],s,u,r)}var c=n.type;if(8&c)RO(e,t,n.child,r);else if(32&c)for(var l=bw(n,t),h=void 0;h=l();)r.push(h);else if(16&c){var f=Kw(t,n);if(Array.isArray(f))r.push.apply(r,zg(f));else{var d=Ew(t[16]);RO(d[1],d,f,r,!0)}}n=i?n.projectionNext:n.next}return r}var xO=function(){function e(t,n){jg(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return Zg(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return RO(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(tk(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Nw(e,n),nC(t,n))}this._attachedToViewContainer=!1}Dw(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){Ub(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){iE(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){aE(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Gk(!0);try{aE(e,t,n)}finally{Gk(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,eb(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),MO=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e))._view=e,r}return Zg(n,[{key:"detectChanges",value:function(){oE(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Gk(!0);try{oE(e)}finally{Gk(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(xO),NO=function(e){return function(e,t,n){if(rk(e)&&!n){var r=Sk(e.index,t);return new xO(r,r)}return 47&e.type?new xO(t[16],t):null}(Lk(),Mk(),16==(16&e))},DO=function(){var e=Zg(function e(){jg(this,e)});return e.__NG_ELEMENT_ID__=NO,e}(),LO=[new EO],FO=new TO([new yO]),UO=new AO(LO),VO=function(){return HO(Lk(),Mk())},BO=function(){var e=Zg(function e(){jg(this,e)});return e.__NG_ELEMENT_ID__=VO,e}(),zO=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return Zg(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=Sb(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Ib(t,n,e),new xO(n)}}]),n}(BO);function HO(e,t){return 4&e.type?new zO(t,e,sO(e,t)):null}var GO=Zg(function e(){jg(this,e)}),$O=Zg(function e(){jg(this,e)}),qO=function(){return KO(Lk(),Mk())},jO=function(){var e=Zg(function e(){jg(this,e)});return e.__NG_ELEMENT_ID__=qO,e}(),WO=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return Zg(n,[{key:"element",get:function(){return sO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new $_(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=x_(this._hostTNode,this._hostLView);if(b_(e)){var t=S_(e,this._hostLView),n=E_(e);return new $_(t[1].data[n+8],t)}return new $_(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=ZO(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(GO,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(tk(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],tC(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=Qw(u,c),h=r[11],f=Hw(h,c[7]);return null!==f&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,eb(e,r,n,1,i,a)}(i,c[6],h,r,f,l),e.attachToViewContainerRef(),tC(YO(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=ZO(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=Nw(this._lContainer,t);n&&(nC(YO(this._lContainer),t),Dw(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=Nw(this._lContainer,t);return n&&null!=nC(YO(this._lContainer),t)?new xO(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(jO);function ZO(e){return e[8]}function YO(e){return e[8]||(e[8]=[])}function KO(e,t){var n,r=t[e.index];if(tk(r))n=r;else{var i;if(8&e.type)i=_k(r);else{var a=t[11];i=a.createComment("");var o=wk(e,t);Vw(a,Hw(a,o),i,function(e,t){return mk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=Jb(r,t,i,e),rE(t,n)}return new WO(n,e,t)}var QO={},XO=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).ngModule=e,r}return Zg(n,[{key:"resolveComponentFactory",value:function(e){var t=Xm(e);return new tT(t,this.ngModule)}}]),n}(aO);function JO(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var eT=new K_("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return kw}}),tT=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(vb).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return Zg(n,[{key:"inputs",get:function(){return JO(this.componentDef.inputs)}},{key:"outputs",get:function(){return JO(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,QO,i);return a!==QO||r===QO?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(hO,kk),u=o.get(vO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(mk(e))return e.selectRootElement(t,n===Im.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):xw(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?gk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d={components:[],scheduler:kw,clean:uE,playerHandler:null,flags:0},v=Fb(0,null,null,1,0,null,null,null,null,null),p=Sb(null,v,d,f,null,null,s,c,u,o);t_(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=Pb(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(vE(s,u,!0),null!==e&&(m_(i,e,u),null!==s.classes&&rb(i,e,s.classes),null!==s.styles&&nb(i,e,s.styles)));var c=r.createRenderer(e,t),l=Sb(n,Lb(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(M_(I_(s,n),o,t.type),$b(o,s),jb(s,n.length,1)),rE(n,l),n[20]=l}(h,this.componentDef,p,s,c);if(h)if(n)m_(c,h,["ng-version",gO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!lb(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&m_(c,h,m),k&&k.length>0&&rb(c,h,k.join(" "))}if(a=bk(v,20),void 0!==t)for(var _=a.projection=[],C=0;C<this.ngContentSelectors.length;C++){var w=t[C];_.push(null!=w?Array.from(w):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=Lk();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Wb(e,r,t,Tb(e,t,1,null),n));var i=z_(t,e,r.directiveStart,r);fw(i,t);var a=wk(r,t);return a&&fw(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=Lk();t.contentQueries(1,o,s.directiveStart)}var u=Lk();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(u_(u.index),Hb(n[1],u,0,u.directiveStart,u.directiveEnd,t),Gb(t,o)),o}(g,this.componentDef,p,d,[RE]),Ib(v,p,null)}finally{o_()}return new nT(this.componentType,i,sO(a,p),p,a)}}]),n}(rO),nT=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new MO(a),s.componentType=e,s}return Zg(n,[{key:"injector",get:function(){return new $_(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return Zg(function e(){jg(this,e)})}()),rT=new Map,iT=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;jg(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=Ug(i),i.destroyCbs=[],i.componentFactoryResolver=new XO(Ug(i));var a=Jm(e),o=e[Bm]||null;return o&&rP(o),i._bootstrapComponents=_w(a.bootstrap),i._r3Injector=wE(e,r,[{provide:GO,useValue:Ug(i)},{provide:aO,useValue:i.componentFactoryResolver}],rm(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return Zg(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AE.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Em.Default;return e===AE||e===GO||e===gE?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(GO),aT=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).moduleType=e,null!==Jm(e)&&function(e){var t=new Set;!function e(n){var r=Jm(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(rm(t)," vs ").concat(rm(t.name)))}(i,rT.get(i),n),rT.set(i,n));var a,o=Gg(_w(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return Zg(n,[{key:"create",value:function(e){return new iT(this.moduleType,e)}}]),n}($O);function oT(e,t,n){var r=$k()+e,i=Mk();return i[r]===pb?HE(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function sT(e,t,n,r){return lT(Mk(),$k(),e,t,n,r)}function uT(e,t,n,r,i){return hT(Mk(),$k(),e,t,n,r,i)}function cT(e,t){var n=e[t];return n===pb?void 0:n}function lT(e,t,n,r,i,a){var o=t+n;return GE(e,o,i)?HE(e,o+1,a?r.call(a,i):r(i)):cT(e,o+1)}function hT(e,t,n,r,i,a,o){var s=t+n;return $E(e,s,i,a)?HE(e,s+2,o?r.call(o,i,a):r(i,a)):cT(e,s+2)}function fT(e,t){var n,r=Nk(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new cm("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=sk(n.type)),o=Sm(XE);try{var s=O_(!1),u=a();return O_(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,Mk(),i,u),u}finally{Sm(o)}}function dT(e,t,n){var r=e+20,i=Mk(),a=Ek(i,r);return pT(i,vT(i,r)?lT(i,$k(),t,a.transform,n,a):a.transform(n))}function vT(e,t){return e[1].data[t].pure}function pT(e,t){return VE.isWrapped(t)&&(t=VE.unwrap(t),e[qk()]=pb),t}function gT(e){return function(t){setTimeout(e,void 0,t)}}var yT=function(e){Ng(n,e);var t=Lg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return jg(this,n),(e=t.call(this)).__isAsync=r,e}return Zg(n,[{key:"emit",value:function(e){xg(Bg(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=gT(u),s&&(s=gT(s)),c&&(c=gT(c)));var h=xg(Bg(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof Wg&&e.add(h),h}}]),n}(Cy);function mT(){return this._results[UE()]()}var kT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];jg(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=UE(),r=e.prototype;r[n]||(r[n]=mT)}return Zg(e,[{key:"changes",get:function(){return this._changes||(this._changes=new yT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=J_(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var _T=function(){function e(t){jg(this,e),this.queryList=t,this.matches=null}return Zg(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),CT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];jg(this,e),this.queries=t}return Zg(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==xT(e,t).matches&&this.queries[t].setDirty()}}]),e}(),wT=Zg(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;jg(this,e),this.predicate=t,this.flags=n,this.read=r}),bT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];jg(this,e),this.queries=t}return Zg(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),ET=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;jg(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return Zg(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,ST(t,i)),this.matchTNodeWithReadOption(e,t,B_(t,e,i,!1,!1))}else n===BO?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,B_(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===cO||r===jO||r===BO&&4&t.type)this.addMatch(t.index,-2);else{var i=B_(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function ST(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function PT(e,t,n,r){return-1===n?function(e,t){return 11&e.type?sO(e,t):4&e.type?HO(e,t):null}(t,e):-2===n?function(e,t,n){return n===cO?sO(t,e):n===BO?HO(t,e):n===jO?KO(t,e):void 0}(e,t,r):z_(e,e[1],n,t)}function OT(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:PT(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function TT(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=OT(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],h=10;h<l.length;h++){var f=l[h];f[17]===f[3]&&TT(f[1],f,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];TT(p[1],p,c,r)}}}return r}function IT(e){var t=Mk(),n=Nk(),r=Qk();Xk(r+1);var i=xT(n,r);if(e.dirty&&Pk(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?TT(n,t,r,[]):OT(n,t,i,r);e.reset(a,lO),e.notifyOnChanges()}return!0}return!1}function AT(e,t,n){var r=Nk();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new bT),e.queries.track(new ET(t,-1))}(r,new wT(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new kT(4==(4&n));Ub(e,t,r,r.destroy),null===t[19]&&(t[19]=new CT),t[19].queries.push(new _T(r))}(r,Mk(),t)}function RT(){return e=Mk(),t=Qk(),e[19].queries[t].queryList;var e,t}function xT(e,t){return e.queries.getByIndex(t)}function MT(e,t){return HO(e,t)}var NT=new K_("Application Initializer"),DT=function(){var e=function(){function e(t){var n=this;jg(this,e),this.appInits=t,this.resolve=oO,this.reject=oO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return Zg(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(sS(r))t.push(r);else if(uS(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(NT,8))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),LT=new K_("AppId"),FT={provide:LT,useFactory:function(){return"".concat(UT()).concat(UT()).concat(UT())},deps:[]};function UT(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var VT=new K_("Platform Initializer"),BT=new K_("Platform ID"),zT=new K_("appBootstrapListener"),HT=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),GT=new K_("LocaleId"),$T=new K_("DefaultCurrencyCode"),qT=Zg(function e(t,n){jg(this,e),this.ngModuleFactory=t,this.componentFactories=n}),jT=function(e){return new aT(e)},WT=jT,ZT=function(e){return Promise.resolve(jT(e))},YT=function(e){var t=jT(e),n=_w(Jm(e).declarations).reduce(function(e,t){var n=Xm(t);return n&&e.push(new tT(n)),e},[]);return new qT(t,n)},KT=YT,QT=function(e){return Promise.resolve(YT(e))},XT=function(){var e=function(){function e(){jg(this,e),this.compileModuleSync=WT,this.compileModuleAsync=ZT,this.compileModuleAndAllComponentsSync=KT,this.compileModuleAndAllComponentsAsync=QT}return Zg(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),JT=Promise.resolve(0);function eI(e){"undefined"==typeof Zone?JT.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var tI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(jg(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new yT(!1),this.onMicrotaskEmpty=new yT(!1),this.onStable=new yT(!1),this.onError=new yT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Mm.requestAnimationFrame,t=Mm.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Mm,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,iI(e),e.isCheckStableRunning=!0,rI(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),iI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return aI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),oI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return aI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),oI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,iI(e),rI(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return Zg(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,nI,oO,oO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),nI={};function rI(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function iI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function aI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function oI(e){e._nesting--,rI(e)}var sI,uI=function(){function e(){jg(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new yT,this.onMicrotaskEmpty=new yT,this.onStable=new yT,this.onError=new yT}return Zg(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),cI=function(){var e=function(){function e(t){var n=this;jg(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return Zg(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){tI.assertNotInAngularZone(),eI(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())eI(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(tI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),lI=function(){var e=function(){function e(){jg(this,e),this._applications=new Map,hI.addToWindow(this)}return Zg(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return hI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),hI=new(function(){function e(){jg(this,e)}return Zg(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),fI=!0,dI=!1,vI=new K_("AllowMultipleToken"),pI=Zg(function e(t,n){jg(this,e),this.name=t,this.token=n});function gI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new K_(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=yI();if(!a||a.injector.get(vI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:mE,useValue:"platform"});!function(e){if(sI&&!sI.destroyed&&!sI.injector.get(vI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");sI=e.get(mI);var t=e.get(VT,null);t&&t.forEach(function(e){return e()})}(AE.create({providers:o,name:r}))}return function(e){var t=yI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function yI(){return sI&&!sI.destroyed?sI:null}var mI=function(){var e=function(){function e(t){jg(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return Zg(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new uI:("zone.js"===e?void 0:e)||new tI({enableLongStackTrace:(dI=!0,fI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:tI,useValue:r}];return r.run(function(){var a=AE.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(gw,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){CI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(DT)).runInitializers(),s.donePromise.then(function(){return rP(o.injector.get(GT,XS)||XS),n._moduleDoBootstrap(o),o}));return sS(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=kI({},n);return function(e,t,n){var r=new aT(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(_I);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(rm(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(AE))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function kI(e,t){return Array.isArray(t)?t.reduce(kI,e):Object.assign(Object.assign({},e),t)}var _I=function(){var e=function(){function e(t,n,r,i,a){var o=this;jg(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new my(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new my(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){tI.assertNotInAngularZone(),eI(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){tI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Zy(t),i=function(e,t){return"number"==typeof jy(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?By(a[0]):$y(i)(Xy(a,r)):qy}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Cy}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,h=function(){null==r||r.unsubscribe(),r=null},f=function(){h(),t=a=null,c=l=!1},d=function(){var e=t;f(),null==e||e.unsubscribe()};return Ey(function(e,v){var p;s++,!l&&!c&&h();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=em(d,u))}),g.subscribe(v),t||(t=new hy({next:function(e){return g.next(e)},error:function(e){l=!0,h(),r=em(f,i,e),g.error(e)},complete:function(){c=!0,h(),r=em(f,o),g.complete()}}),Xy(e).subscribe(t))})(e)}}()))}return Zg(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof rO?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(GO),a=n.create(AE.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(cI,null),u=s&&a.injector.get(lI);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),CI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=Gg(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;CI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(zT,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(tI),gC(AE),gC(gw),gC(aO),gC(DT))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function CI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var wI=Zg(function e(){jg(this,e)}),bI=Zg(function e(){jg(this,e)}),EI={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},SI=function(){var e=function(){function e(t,n){jg(this,e),this._compiler=t,this._config=n||EI}return Zg(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Og(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Ig(8255)(r).then(function(e){return e[i]}).then(function(e){return PI(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Og(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Ig(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return PI(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(XT),gC(bI,8))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function PI(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var OI=gI(null,"core",[{provide:BT,useValue:"unknown"},{provide:mI,deps:[AE]},{provide:lI,deps:[]},{provide:HT,deps:[]}]),TI=[{provide:_I,useClass:_I,deps:[tI,AE,gw,aO,DT]},{provide:eT,deps:[tI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:DT,useClass:DT,deps:[[new EC,NT]]},{provide:XT,useClass:XT,deps:[]},FT,{provide:TO,useFactory:function(){return FO},deps:[]},{provide:AO,useFactory:function(){return UO},deps:[]},{provide:GT,useFactory:function(e){return rP(e=e||"undefined"!=typeof $localize&&$localize.locale||XS),e},deps:[[new bC(GT),new EC,new SC]]},{provide:$T,useValue:"USD"}],II=function(){var e=Zg(function e(t){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)(gC(_I))},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:TI}),e}(),AI=null;function RI(){return AI}var xI=new K_("DocumentToken"),MI=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({factory:NI,token:e,providedIn:"platform"}),e}();function NI(){return gC(LI)}var DI=new K_("Location Initialized"),LI=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this))._doc=e,r._init(),r}return Zg(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return RI().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=RI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=RI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){FI()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){FI()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(MI);return e.\u0275fac=function(t){return new(t||e)(gC(xI))},e.\u0275prov=vm({factory:UI,token:e,providedIn:"platform"}),e}();function FI(){return!!window.history.pushState}function UI(){return new LI(gC(xI))}function VI(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function BI(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function zI(e){return e&&"?"!==e[0]?"?"+e:e}var HI=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({factory:GI,token:e,providedIn:"root"}),e}();function GI(e){var t=gC(xI).location;return new qI(gC(MI),t&&t.origin||"")}var $I=new K_("appBaseHref"),qI=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;if(jg(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,Fg(i)}return Zg(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return VI(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+zI(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zI(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zI(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(HI);return e.\u0275fac=function(t){return new(t||e)(gC(MI),gC($I,8))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),jI=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return Zg(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=VI(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zI(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zI(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(HI);return e.\u0275fac=function(t){return new(t||e)(gC(MI),gC($I,8))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),WI=function(){var e=function(){function e(t,n){var r=this;jg(this,e),this._subject=new yT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=BI(YI(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return Zg(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+zI(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,YI(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+zI(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+zI(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(HI),gC(MI))},e.normalizeQueryParams=zI,e.joinWithSlash=VI,e.stripTrailingSlash=BI,e.\u0275prov=vm({factory:ZI,token:e,providedIn:"root"}),e}();function ZI(){return new WI(gC(HI),gC(MI))}function YI(e){return e.replace(/\/index.html$/,"")}var KI=((KI=KI||{})[KI.Decimal=0]="Decimal",KI[KI.Percent=1]="Percent",KI[KI.Currency=2]="Currency",KI[KI.Scientific=3]="Scientific",KI),QI=((QI=QI||{})[QI.Zero=0]="Zero",QI[QI.One=1]="One",QI[QI.Two=2]="Two",QI[QI.Few=3]="Few",QI[QI.Many=4]="Many",QI[QI.Other=5]="Other",QI),XI=((XI=XI||{})[XI.Format=0]="Format",XI[XI.Standalone=1]="Standalone",XI),JI=((JI=JI||{})[JI.Narrow=0]="Narrow",JI[JI.Abbreviated=1]="Abbreviated",JI[JI.Wide=2]="Wide",JI[JI.Short=3]="Short",JI),eA=((eA=eA||{})[eA.Short=0]="Short",eA[eA.Medium=1]="Medium",eA[eA.Long=2]="Long",eA[eA.Full=3]="Full",eA),tA=((tA=tA||{})[tA.Decimal=0]="Decimal",tA[tA.Group=1]="Group",tA[tA.List=2]="List",tA[tA.PercentSign=3]="PercentSign",tA[tA.PlusSign=4]="PlusSign",tA[tA.MinusSign=5]="MinusSign",tA[tA.Exponential=6]="Exponential",tA[tA.SuperscriptingExponent=7]="SuperscriptingExponent",tA[tA.PerMille=8]="PerMille",tA[tA.Infinity=9]="Infinity",tA[tA.NaN=10]="NaN",tA[tA.TimeSeparator=11]="TimeSeparator",tA[tA.CurrencyDecimal=12]="CurrencyDecimal",tA[tA.CurrencyGroup=13]="CurrencyGroup",tA);function nA(e,t){return uA(WS(e)[KS.DateFormat],t)}function rA(e,t){return uA(WS(e)[KS.TimeFormat],t)}function iA(e,t){return uA(WS(e)[KS.DateTimeFormat],t)}function aA(e,t){var n=WS(e),r=n[KS.NumberSymbols][t];if(void 0===r){if(t===tA.CurrencyDecimal)return n[KS.NumberSymbols][tA.Decimal];if(t===tA.CurrencyGroup)return n[KS.NumberSymbols][tA.Group]}return r}var oA=ZS;function sA(e){if(!e[KS.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[KS.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function uA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function cA(e){var t=Og(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var lA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,hA={},fA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,dA=((dA=dA||{})[dA.Short=0]="Short",dA[dA.ShortGMT=1]="ShortGMT",dA[dA.Long=2]="Long",dA[dA.Extended=3]="Extended",dA),vA=((vA=vA||{})[vA.FullYear=0]="FullYear",vA[vA.Month=1]="Month",vA[vA.Date=2]="Date",vA[vA.Hours=3]="Hours",vA[vA.Minutes=4]="Minutes",vA[vA.Seconds=5]="Seconds",vA[vA.FractionalSeconds=6]="FractionalSeconds",vA[vA.Day=7]="Day",vA),pA=((pA=pA||{})[pA.DayPeriods=0]="DayPeriods",pA[pA.Days=1]="Days",pA[pA.Months=2]="Months",pA[pA.Eras=3]="Eras",pA);function gA(e,t,n,r){var i=function(e){if(IA(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=Og(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return yA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(lA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!IA(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=mA(n,t)||t;for(var a,o=[];t;){if(!(a=fA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=TA(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(TA(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(OA[e])return OA[e];var t;switch(e){case"G":case"GG":case"GGG":t=wA(pA.Eras,JI.Abbreviated);break;case"GGGG":t=wA(pA.Eras,JI.Wide);break;case"GGGGG":t=wA(pA.Eras,JI.Narrow);break;case"y":t=CA(vA.FullYear,1,0,!1,!0);break;case"yy":t=CA(vA.FullYear,2,0,!0,!0);break;case"yyy":t=CA(vA.FullYear,3,0,!1,!0);break;case"yyyy":t=CA(vA.FullYear,4,0,!1,!0);break;case"Y":t=PA(1);break;case"YY":t=PA(2,!0);break;case"YYY":t=PA(3);break;case"YYYY":t=PA(4);break;case"M":case"L":t=CA(vA.Month,1,1);break;case"MM":case"LL":t=CA(vA.Month,2,1);break;case"MMM":t=wA(pA.Months,JI.Abbreviated);break;case"MMMM":t=wA(pA.Months,JI.Wide);break;case"MMMMM":t=wA(pA.Months,JI.Narrow);break;case"LLL":t=wA(pA.Months,JI.Abbreviated,XI.Standalone);break;case"LLLL":t=wA(pA.Months,JI.Wide,XI.Standalone);break;case"LLLLL":t=wA(pA.Months,JI.Narrow,XI.Standalone);break;case"w":t=SA(1);break;case"ww":t=SA(2);break;case"W":t=SA(1,!0);break;case"d":t=CA(vA.Date,1);break;case"dd":t=CA(vA.Date,2);break;case"c":case"cc":t=CA(vA.Day,1);break;case"ccc":t=wA(pA.Days,JI.Abbreviated,XI.Standalone);break;case"cccc":t=wA(pA.Days,JI.Wide,XI.Standalone);break;case"ccccc":t=wA(pA.Days,JI.Narrow,XI.Standalone);break;case"cccccc":t=wA(pA.Days,JI.Short,XI.Standalone);break;case"E":case"EE":case"EEE":t=wA(pA.Days,JI.Abbreviated);break;case"EEEE":t=wA(pA.Days,JI.Wide);break;case"EEEEE":t=wA(pA.Days,JI.Narrow);break;case"EEEEEE":t=wA(pA.Days,JI.Short);break;case"a":case"aa":case"aaa":t=wA(pA.DayPeriods,JI.Abbreviated);break;case"aaaa":t=wA(pA.DayPeriods,JI.Wide);break;case"aaaaa":t=wA(pA.DayPeriods,JI.Narrow);break;case"b":case"bb":case"bbb":t=wA(pA.DayPeriods,JI.Abbreviated,XI.Standalone,!0);break;case"bbbb":t=wA(pA.DayPeriods,JI.Wide,XI.Standalone,!0);break;case"bbbbb":t=wA(pA.DayPeriods,JI.Narrow,XI.Standalone,!0);break;case"B":case"BB":case"BBB":t=wA(pA.DayPeriods,JI.Abbreviated,XI.Format,!0);break;case"BBBB":t=wA(pA.DayPeriods,JI.Wide,XI.Format,!0);break;case"BBBBB":t=wA(pA.DayPeriods,JI.Narrow,XI.Format,!0);break;case"h":t=CA(vA.Hours,1,-12);break;case"hh":t=CA(vA.Hours,2,-12);break;case"H":t=CA(vA.Hours,1);break;case"HH":t=CA(vA.Hours,2);break;case"m":t=CA(vA.Minutes,1);break;case"mm":t=CA(vA.Minutes,2);break;case"s":t=CA(vA.Seconds,1);break;case"ss":t=CA(vA.Seconds,2);break;case"S":t=CA(vA.FractionalSeconds,1);break;case"SS":t=CA(vA.FractionalSeconds,2);break;case"SSS":t=CA(vA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=bA(dA.Short);break;case"ZZZZZ":t=bA(dA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=bA(dA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=bA(dA.Long);break;default:return null}return OA[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function yA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function mA(e,t){var n=function(e){return WS(e)[KS.LocaleId]}(e);if(hA[n]=hA[n]||{},hA[n][t])return hA[n][t];var r="";switch(t){case"shortDate":r=nA(e,eA.Short);break;case"mediumDate":r=nA(e,eA.Medium);break;case"longDate":r=nA(e,eA.Long);break;case"fullDate":r=nA(e,eA.Full);break;case"shortTime":r=rA(e,eA.Short);break;case"mediumTime":r=rA(e,eA.Medium);break;case"longTime":r=rA(e,eA.Long);break;case"fullTime":r=rA(e,eA.Full);break;case"short":var i=mA(e,"shortTime"),a=mA(e,"shortDate");r=kA(iA(e,eA.Short),[i,a]);break;case"medium":var o=mA(e,"mediumTime"),s=mA(e,"mediumDate");r=kA(iA(e,eA.Medium),[o,s]);break;case"long":var u=mA(e,"longTime"),c=mA(e,"longDate");r=kA(iA(e,eA.Long),[u,c]);break;case"full":var l=mA(e,"fullTime"),h=mA(e,"fullDate");r=kA(iA(e,eA.Full),[l,h])}return r&&(hA[n][t]=r),r}function kA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function _A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function CA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case vA.FullYear:return t.getFullYear();case vA.Month:return t.getMonth();case vA.Date:return t.getDate();case vA.Hours:return t.getHours();case vA.Minutes:return t.getMinutes();case vA.Seconds:return t.getSeconds();case vA.FractionalSeconds:return t.getMilliseconds();case vA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===vA.Hours)0===s&&-12===n&&(s=12);else if(e===vA.FractionalSeconds)return function(e,t){return _A(e,3).substr(0,t)}(s,t);var u=aA(o,tA.MinusSign);return _A(s,t,u,r,i)}}function wA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XI.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case pA.Months:return function(e,t,n){var r=WS(e),i=uA([r[KS.MonthsFormat],r[KS.MonthsStandalone]],t);return uA(i,n)}(t,i,r)[e.getMonth()];case pA.Days:return function(e,t,n){var r=WS(e),i=uA([r[KS.DaysFormat],r[KS.DaysStandalone]],t);return uA(i,n)}(t,i,r)[e.getDay()];case pA.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=WS(e);return sA(t),(t[KS.ExtraData][2]||[]).map(function(e){return"string"==typeof e?cA(e):[cA(e[0]),cA(e[1])]})}(t),c=function(e,t,n){var r=WS(e);sA(r);var i=uA([r[KS.ExtraData][0],r[KS.ExtraData][1]],t)||[];return uA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Og(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=WS(e),i=uA([r[KS.DayPeriodsFormat],r[KS.DayPeriodsStandalone]],t);return uA(i,n)}(t,i,r)[o<12?0:1];case pA.Eras:return function(e,t){return uA(WS(e)[KS.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function bA(e){return function(t,n,r){var i=-1*r,a=aA(n,tA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case dA.Short:return(i>=0?"+":"")+_A(o,2,a)+_A(Math.abs(i%60),2,a);case dA.ShortGMT:return"GMT"+(i>=0?"+":"")+_A(o,1,a);case dA.Long:return"GMT"+(i>=0?"+":"")+_A(o,2,a)+":"+_A(Math.abs(i%60),2,a);case dA.Extended:return 0===r?"Z":(i>=0?"+":"")+_A(o,2,a)+":"+_A(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function EA(e){return yA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function SA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=EA(n),u=function(e){var t=yA(e,0,1).getDay();return yA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return _A(i,e,aA(r,tA.MinusSign))}}function PA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return _A(EA(n).getFullYear(),e,aA(r,tA.MinusSign),t)}}var OA={};function TA(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function IA(e){return e instanceof Date&&!isNaN(e.valueOf())}var AA=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function RA(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var xA=Zg(function e(){jg(this,e)}),MA=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).locale=e,r}return Zg(n,[{key:"getPluralCategory",value:function(e,t){switch(oA(t||this.locale)(e)){case QI.Zero:return"zero";case QI.One:return"one";case QI.Two:return"two";case QI.Few:return"few";case QI.Many:return"many";default:return"other"}}}]),n}(xA);return e.\u0275fac=function(t){return new(t||e)(gC(GT))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function NA(e,t){t=encodeURIComponent(t);var n,r=Gg(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Og(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var DA=function(){var e=function(){function e(t,n,r,i){jg(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return Zg(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(BE(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(rm(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(TO),XE(AO),XE(cO),XE(fO))},e.\u0275dir=Km({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),LA=function(){function e(t,n,r,i){jg(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return Zg(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),FA=function(){var e=function(){function e(t,n,r){jg(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return Zg(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new LA(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new UA(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new UA(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(jO),XE(BO),XE(TO))},e.\u0275dir=Km({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),UA=Zg(function e(t,n){jg(this,e),this.record=t,this.view=n}),VA=function(){var e=function(){function e(t,n){jg(this,e),this._viewContainer=t,this._context=new BA,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return Zg(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){zA("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){zA("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(jO),XE(BO))},e.\u0275dir=Km({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),BA=Zg(function e(){jg(this,e),this.$implicit=null,this.ngIf=null});function zA(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(rm(t),"'."))}var HA=function(){var e=function(){function e(t){jg(this,e),this._locale=t}return Zg(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,h=t.minFrac,f=t.maxFrac;if(a){var d=a.match(AA);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=RA(v)),null!=p&&(h=RA(p)),null!=g?f=RA(g):null!=p&&h>f&&(f=h)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var h=0!==a,f=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,h&&(0===r[n]&&n>=f?r.pop():h=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,h,f);var y=c.digits,m=c.integerLen,k=c.exponent,_=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?_=y.splice(m,y.length):(_=y,y=[0]);var C=[];for(y.length>=t.lgSize&&C.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)C.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&C.unshift(y.join("")),s=C.join(aA(n,r)),_.length&&(s+=aA(n,i)+_.join("")),k&&(s+=aA(n,tA.Exponential)+"+"+k)}else s=aA(n,tA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var h=s.split(",");if(n.gSize=h[1]?h[1].length:0,n.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,a){var f=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+f).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return WS(e)[KS.NumberFormats][t]}(t,KI.Decimal),aA(t,tA.MinusSign)),t,tA.Group,tA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(rm(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(GT,16))},e.\u0275pipe=Qm({name:"number",type:e,pure:!0}),e}(),GA=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[{provide:xA,useClass:MA}]}),e}(),$A=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275prov=vm({token:e,providedIn:"root",factory:function(){return new qA(gC(xI),window)}}),e}(),qA=function(){function e(t,n){jg(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return Zg(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=jA(this.window.history)||jA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function jA(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var WA,ZA=Zg(function e(){jg(this,e)}),YA=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(KA=KA||document.querySelector("base"))?KA.getAttribute("href"):null;return null==t?null:function(e){(WA=WA||document.createElement("a")).setAttribute("href",e);var t=WA.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){KA=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return NA(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,AI||(AI=e)}}]),n}(function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return Zg(n)}(function(){return Zg(function e(){jg(this,e)})}())),KA=null,QA=new K_("TRANSITION_ID"),XA=[{provide:NT,useFactory:function(e,t,n){return function(){n.get(DT).donePromise.then(function(){for(var n=RI(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[QA,xI,AE],multi:!0}],JA=function(){function e(){jg(this,e)}return Zg(e,[{key:"addToWindow",value:function(e){Mm.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Mm.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Mm.getAllAngularRootElements=function(){return e.getAllRootElements()},Mm.frameworkStabilizers||(Mm.frameworkStabilizers=[]),Mm.frameworkStabilizers.push(function(e){var t=Mm.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?RI().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,hI=t}}]),e}(),eR=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),tR=new K_("EventManagerPlugins"),nR=function(){var e=function(){function e(t,n){var r=this;jg(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return Zg(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(tR),gC(tI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),rR=function(){function e(t){jg(this,e),this._doc=t}return Zg(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=RI().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),iR=function(){var e=function(){function e(){jg(this,e),this._stylesSet=new Set}return Zg(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),aR=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return Zg(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(oR),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(oR)})}}]),n}(iR);return e.\u0275fac=function(t){return new(t||e)(gC(xI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function oR(e){RI().remove(e)}var sR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},uR=/%COMP%/g;function cR(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?cR(e,i,n):(i=i.replace(uR,e),n.push(i))}return n}function lR(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var hR=function(){var e=function(){function e(t,n,r){jg(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new fR(t)}return Zg(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Im.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new dR(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Im.ShadowDom:return new vR(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=cR(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(nR),gC(aR),gC(LT))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),fR=function(){function e(t){jg(this,e),this.eventManager=t,this.data=Object.create(null)}return Zg(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(sR[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=sR[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=sR[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(ww.DashCase|ww.Important)?e.style.setProperty(t,n,r&ww.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&ww.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,lR(n)):this.eventManager.addEventListener(e,t,lR(n))}}]),e}(),dR=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;jg(this,n),(o=t.call(this,e)).component=i;var s=cR(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(uR,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(uR,a+"-"+i.id),o}return Zg(n,[{key:"applyToHost",value:function(e){xg(Bg(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=xg(Bg(n.prototype),"createElement",this).call(this,e,t);return xg(Bg(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(fR),vR=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;jg(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=cR(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return Zg(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return xg(Bg(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return xg(Bg(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return xg(Bg(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(xg(Bg(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(fR),pR=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,e)}return Zg(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(rR);return e.\u0275fac=function(t){return new(t||e)(gC(xI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),gR=["alt","control","meta","shift"],yR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mR={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},kR={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},_R=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,e)}return Zg(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return RI().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(gR.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&mR.hasOwnProperty(t)&&(t=mR[t]))}return yR[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),gR.forEach(function(r){r!=n&&kR[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(rR);return e.\u0275fac=function(t){return new(t||e)(gC(xI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),CR=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({factory:function(){return gC(wR)},token:e,providedIn:"root"}),e}(),wR=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this))._doc=e,r}return Zg(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case sw.NONE:return t;case sw.HTML:return DC(t,"HTML")?NC(t):aw(this._doc,String(t)).toString();case sw.STYLE:return DC(t,"Style")?NC(t):t;case sw.SCRIPT:if(DC(t,"Script"))return NC(t);throw new Error("unsafe value used in a script context");case sw.URL:return LC(t),DC(t,"URL")?NC(t):HC(String(t));case sw.RESOURCE_URL:if(DC(t,"ResourceURL"))return NC(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new IC(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new AC(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new RC(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new xC(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new MC(e)}(e)}}]),n}(CR);return e.\u0275fac=function(t){return new(t||e)(gC(xI))},e.\u0275prov=vm({factory:function(){return function(e){return new wR(e.get(xI))}(gC(gE))},token:e,providedIn:"root"}),e}(),bR=[{provide:BT,useValue:"browser"},{provide:VT,useValue:function(){YA.makeCurrent(),JA.init()},multi:!0},{provide:xI,useFactory:function(){return e=document,pk=e,document;var e},deps:[]}],ER=gI(OI,"browser",bR),SR=[[],{provide:mE,useValue:"root"},{provide:gw,useFactory:function(){return new gw},deps:[]},{provide:tR,useClass:pR,multi:!0,deps:[xI,tI,BT]},{provide:tR,useClass:_R,multi:!0,deps:[xI]},[],{provide:hR,useClass:hR,deps:[nR,aR,LT]},{provide:hO,useExisting:hR},{provide:iR,useExisting:aR},{provide:aR,useClass:aR,deps:[xI]},{provide:cI,useClass:cI,deps:[tI]},{provide:nR,useClass:nR,deps:[tR,tI]},{provide:ZA,useClass:eR,deps:[]},[]],PR=function(){var e=function(){function e(t){if(jg(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return Zg(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:LT,useValue:t.appId},{provide:QA,useExisting:LT},XA]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(e,12))},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:SR,imports:[GA,II]}),e}();"undefined"!=typeof window&&window;var OR=Array.isArray,TR=Object.getPrototypeOf,IR=Object.prototype,AR=Object.keys;function RR(e){if(1===e.length){var t=e[0];if(OR(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&TR(e)===IR}(t)){var n=AR(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var xR=Array.isArray;function MR(e){return Py(function(t){return function(e,t){return xR(t)?e.apply(void 0,zg(t)):e(t)}(e,t)})}function NR(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var DR=function(){var e=function(){function e(t,n){jg(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return Zg(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(fO),XE(cO))},e.\u0275dir=Km({type:e}),e}(),LR=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n)}(DR);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275dir=Km({type:t,features:[xE]}),t}(),FR=new K_("NgValueAccessor"),UR={provide:FR,useExisting:om(function(){return BR}),multi:!0},VR=new K_("CompositionEventMode"),BR=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=RI()?RI().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return Zg(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(DR);return e.\u0275fac=function(t){return new(t||e)(XE(fO),XE(cO),XE(VR,8))},e.\u0275dir=Km({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&cS("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[nO([UR]),xE]}),e}();function zR(e){return null==e||0===e.length}function HR(e){return null!=e&&"number"==typeof e.length}var GR=new K_("NgValidators"),$R=new K_("NgAsyncValidators"),qR=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,jR=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"min",value:function(e){return t=e,function(e){if(zR(e.value)||zR(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(zR(e.value)||zR(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return WR(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return zR((t=e).value)||qR.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return zR(e.value)||!HR(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return ZR(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(zR(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):YR;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return tx(e)}},{key:"composeAsync",value:function(e){return rx(e)}}]),e}();function WR(e){return zR(e.value)?{required:!0}:null}function ZR(e){return function(t){return HR(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function YR(e){return null}function KR(e){return null!=e}function QR(e){var t=sS(e)?Xy(e):e;return uS(t),t}function XR(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function JR(e,t){return t.map(function(t){return t(e)})}function ex(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function tx(e){if(!e)return null;var t=e.filter(KR);return 0==t.length?null:function(e){return XR(JR(e,t))}}function nx(e){return null!=e?tx(ex(e)):null}function rx(e){if(!e)return null;var t=e.filter(KR);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t),i=RR(t),a=i.args,o=i.keys,s=new my(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;By(a[t]).subscribe(new Sy(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?NR(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(MR(r)):s}(JR(e,t).map(QR)).pipe(Py(XR))}}function ix(e){return null!=e?rx(ex(e)):null}function ax(e,t){return null===e?[t]:Array.isArray(e)?[].concat(zg(e),[t]):[e,t]}function ox(e){return e._rawValidators}function sx(e){return e._rawAsyncValidators}function ux(e){return e?Array.isArray(e)?e:[e]:[]}function cx(e,t){return Array.isArray(e)?e.includes(t):e===t}function lx(e,t){var n=ux(t);return ux(e).forEach(function(e){cx(n,e)||n.push(e)}),n}function hx(e,t){return ux(t).filter(function(t){return!cx(e,t)})}var fx=function(){var e=function(){function e(){jg(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return Zg(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=nx(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ix(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Km({type:e}),e}(),dx=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(fx);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275dir=Km({type:t,features:[xE]}),t}(),vx=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return Zg(n)}(fx),px=function(){function e(t){jg(this,e),this._cd=t}return Zg(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),gx=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,e)}return Zg(n)}(px);return e.\u0275fac=function(t){return new(t||e)(XE(vx,2))},e.\u0275dir=Km({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&PS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[xE]}),e}(),yx=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,e)}return Zg(n)}(px);return e.\u0275fac=function(t){return new(t||e)(XE(dx,10))},e.\u0275dir=Km({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&PS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[xE]}),e}();function mx(e,t){return[].concat(zg(t.path),[e])}function kx(e,t){wx(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Ex(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Ex(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function _x(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),bx(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function Cx(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function wx(e,t){var n=ox(e);null!==t.validator?e.setValidators(ax(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=sx(e);null!==t.asyncValidator?e.setAsyncValidators(ax(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};Cx(t._rawValidators,i),Cx(t._rawAsyncValidators,i)}function bx(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=ox(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=sx(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return Cx(t._rawValidators,s),Cx(t._rawAsyncValidators,s),n}function Ex(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Sx(e,t){wx(e,t)}function Px(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Ox(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Tx(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===BR?n=e:function(e){return Object.getPrototypeOf(e.constructor)===LR}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function Ix(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Ax="VALID",Rx="INVALID",xx="PENDING",Mx="DISABLED";function Nx(e){return(Ux(e)?e.validators:e)||null}function Dx(e){return Array.isArray(e)?nx(e):e||null}function Lx(e,t){return(Ux(t)?t.asyncValidators:e)||null}function Fx(e){return Array.isArray(e)?ix(e):e||null}function Ux(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Vx=function(){function e(t,n){jg(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=Dx(this._rawValidators),this._composedAsyncValidatorFn=Fx(this._rawAsyncValidators)}return Zg(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===Ax}},{key:"invalid",get:function(){return this.status===Rx}},{key:"pending",get:function(){return this.status==xx}},{key:"disabled",get:function(){return this.status===Mx}},{key:"enabled",get:function(){return this.status!==Mx}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=Dx(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Fx(e)}},{key:"addValidators",value:function(e){this.setValidators(lx(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(lx(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(hx(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(hx(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return cx(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return cx(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=xx,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Mx,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Ax,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ax||this.status===xx)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?Mx:Ax}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=xx,this._hasOwnPendingAsyncValidator=!0;var n=QR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof zx?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof Hx&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new yT,this.statusChanges=new yT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?Mx:this.errors?Rx:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xx)?xx:this._anyControlsHaveStatus(Rx)?Rx:Ax}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){Ux(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),Bx=function(e){Ng(n,e);var t=Lg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return jg(this,n),(e=t.call(this,Nx(i),Lx(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return Zg(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){Ix(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){Ix(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(Vx),zx=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,Nx(r),Lx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Zg(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Bx?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(Vx),Hx=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,Nx(r),Lx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Zg(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Bx?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=Gg(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(Vx),Gx={provide:dx,useExisting:om(function(){return qx})},$x=Promise.resolve(null),qx=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new yT,i.form=new zx({},nx(e),ix(r)),i}return Zg(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;$x.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),kx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;$x.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),Ix(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;$x.then(function(){var n=t._findContainer(e.path),r=new zx({});Sx(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;$x.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;$x.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Ox(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(dx);return e.\u0275fac=function(t){return new(t||e)(XE(GR,10),XE($R,10))},e.\u0275dir=Km({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&cS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nO([Gx]),xE]}),e}(),jx={provide:vx,useExisting:om(function(){return Zx})},Wx=Promise.resolve(null),Zx=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this)).control=new Bx,o._registered=!1,o.update=new yT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=Tx(0,a),o}return Zg(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),Px(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?mx(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){kx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;Wx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Wx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(vx);return e.\u0275fac=function(t){return new(t||e)(XE(dx,9),XE(GR,10),XE($R,10),XE(FR,10))},e.\u0275dir=Km({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[nO([jx]),xE,ck]}),e}(),Yx=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Km({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),Kx=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({}),e}(),Qx={provide:FR,useExisting:om(function(){return Xx}),multi:!0},Xx=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(LR);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275dir=Km({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&cS("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[nO([Qx]),xE]}),t}(),Jx=new K_("NgModelWithFormControlWarning"),eM={provide:dx,useExisting:om(function(){return tM})},tM=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new yT,i._setValidators(e),i._setAsyncValidators(r),i}return Zg(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(bx(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return kx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){_x(e.control||null,e,!1),Ix(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Ox(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(_x(n||null,t),r instanceof Bx&&(kx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);Sx(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return bx(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){wx(this.form,this),this._oldForm&&bx(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(dx);return e.\u0275fac=function(t){return new(t||e)(XE(GR,10),XE($R,10))},e.\u0275dir=Km({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&cS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nO([eM]),xE,ck]}),e}(),nM={provide:vx,useExisting:om(function(){return rM})},rM=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new yT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=Tx(0,a),s}return Zg(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),Px(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return mx(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(vx);return e.\u0275fac=function(t){return new(t||e)(XE(dx,13),XE(GR,10),XE($R,10),XE(FR,10),XE(Jx,8))},e.\u0275dir=Km({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[nO([nM]),xE,ck]}),e._ngModelWarningSentOnce=!1,e}(),iM={provide:FR,useExisting:om(function(){return oM}),multi:!0};function aM(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var oM=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Zg(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=aM(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(LR);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275dir=Km({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&cS("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[nO([iM]),xE]}),t}(),sM=function(){var e=function(){function e(t,n,r){jg(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return Zg(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(aM(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(cO),XE(fO),XE(oM,9))},e.\u0275dir=Km({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),uM={provide:FR,useExisting:om(function(){return lM}),multi:!0};function cM(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var lM=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Zg(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(LR);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275dir=Km({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&cS("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[nO([uM]),xE]}),t}(),hM=function(){var e=function(){function e(t,n,r){jg(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return Zg(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(cM(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(cM(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(cO),XE(fO),XE(lM,9))},e.\u0275dir=Km({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),fM={provide:GR,useExisting:om(function(){return dM}),multi:!0},dM=function(){var e=function(){function e(){jg(this,e),this._required=!1}return Zg(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?WR(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Km({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&qE("required",t.required?"":null)},inputs:{required:"required"},features:[nO([fM])]}),e}(),vM={provide:GR,useExisting:om(function(){return pM}),multi:!0},pM=function(){var e=function(){function e(){jg(this,e),this._validator=YR}return Zg(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?ZR(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):YR}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Km({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&qE("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[nO([vM]),ck]}),e}(),gM=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({imports:[[Kx]]}),e}(),yM=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({imports:[gM]}),e}(),mM=function(){var e=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Jx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({imports:[gM]}),e}(),kM=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new zx(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new Bx(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new Hx(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof Bx||e instanceof zx||e instanceof Hx?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({factory:function(){return new e},token:e,providedIn:mM}),e}();function _M(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Xy(t,Zy(t))}function CM(e,t){return Vg(t)?Gy(e,t,1):Gy(e,1)}function wM(e,t){return Ey(function(n,r){var i=0;n.subscribe(new Sy(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var bM=Zg(function e(){jg(this,e)}),EM=Zg(function e(){jg(this,e)}),SM=function(){function e(t){var n=this;jg(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return Zg(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,zg(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),PM=function(){function e(){jg(this,e)}return Zg(e,[{key:"encodeKey",value:function(e){return IM(e)}},{key:"encodeValue",value:function(e){return IM(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),OM=/%(\d[a-f0-9])/gi,TM={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function IM(e){return encodeURIComponent(e).replace(OM,function(e,t){var n;return null!==(n=TM[t])&&void 0!==n?n:e})}function AM(e){return"".concat(e)}var RM=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(jg(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new PM,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Og(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return Zg(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(AM(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(AM(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),xM=function(){function e(){jg(this,e),this.map=new Map}return Zg(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function MM(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function NM(e){return"undefined"!=typeof Blob&&e instanceof Blob}function DM(e){return"undefined"!=typeof FormData&&e instanceof FormData}var LM=function(){function e(t,n,r,i){var a;if(jg(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new SM),this.context||(this.context=new xM),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new RM,this.urlWithParams=n}return Zg(e,[{key:"serializeBody",value:function(){return null===this.body?null:MM(this.body)||NM(this.body)||DM(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof RM?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||DM(this.body)?null:NM(this.body)?this.body.type||null:MM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof RM?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,h=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:h,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),FM=((FM=FM||{})[FM.Sent=0]="Sent",FM[FM.UploadProgress=1]="UploadProgress",FM[FM.ResponseHeader=2]="ResponseHeader",FM[FM.DownloadProgress=3]="DownloadProgress",FM[FM.Response=4]="Response",FM[FM.User=5]="User",FM),UM=Zg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";jg(this,e),this.headers=t.headers||new SM,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),VM=function(e){Ng(n,e);var t=Lg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jg(this,n),(e=t.call(this,r)).type=FM.ResponseHeader,e}return Zg(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(UM),BM=function(e){Ng(n,e);var t=Lg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jg(this,n),(e=t.call(this,r)).type=FM.Response,e.body=void 0!==r.body?r.body:null,e}return Zg(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(UM),zM=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return Zg(n)}(UM);function HM(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var GM=function(){var e=function(){function e(t){jg(this,e),this.handler=t}return Zg(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof LM?n=e:(r=o.headers instanceof SM?o.headers:new SM(o.headers),o.params&&(i=o.params instanceof RM?o.params:new RM({fromObject:o.params})),n=new LM(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=_M(n).pipe(CM(function(e){return a.handler.handle(e)}));if(e instanceof LM||"events"===o.observe)return s;var u=s.pipe(wM(function(e){return e instanceof BM}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Py(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Py(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Py(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(Py(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new RM).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,HM(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,HM(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,HM(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(bM))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),$M=function(){function e(t,n){jg(this,e),this.next=t,this.interceptor=n}return Zg(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),qM=new K_("HTTP_INTERCEPTORS"),jM=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),WM=/^\)\]\}',?\n/,ZM=function(){var e=function(){function e(t){jg(this,e),this.xhrFactory=t}return Zg(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new my(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new SM(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new VM({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(WM,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new BM({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new zM({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new zM({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},h=!1,f=function(t){h||(n.next(u()),h=!0);var i={type:FM.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:FM.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",f),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:FM.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",f),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(ZA))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),YM=new K_("XSRF_COOKIE_NAME"),KM=new K_("XSRF_HEADER_NAME"),QM=Zg(function e(){jg(this,e)}),XM=function(){var e=function(){function e(t,n,r){jg(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return Zg(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=NA(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(xI),gC(BT),gC(YM))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),JM=function(){var e=function(){function e(t,n){jg(this,e),this.tokenService=t,this.headerName=n}return Zg(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(QM),gC(KM))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),eN=function(){var e=function(){function e(t,n){jg(this,e),this.backend=t,this.injector=n,this.chain=null}return Zg(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(qM,[]);this.chain=t.reduceRight(function(e,t){return new $M(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(EM),gC(AE))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),tN=function(){var e=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:JM,useClass:jM}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:YM,useValue:t.cookieName}:[],t.headerName?{provide:KM,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[JM,{provide:qM,useExisting:JM,multi:!0},{provide:QM,useClass:XM},{provide:YM,useValue:"XSRF-TOKEN"},{provide:KM,useValue:"X-XSRF-TOKEN"}]}),e}(),nN=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[GM,{provide:bM,useClass:eN},ZM,{provide:EM,useExisting:ZM}],imports:[[tN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),rN=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this))._value=e,r}return Zg(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=xg(Bg(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){xg(Bg(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Cy);function iN(e,t,n){e?Hy(n,e,t):t()}var aN=Hg(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function oN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return $y(1)(Xy(t,Zy(t)))}function sN(e){return new my(function(t){By(e()).subscribe(t)})}function uN(){return Ey(function(e,t){var n=null;e._refCount++;var r=new Sy(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var cN=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,by(e)&&(i.lift=e.lift),i}return Zg(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new Wg;var n=this.getSubject();t.add(this.source.subscribe(new Sy(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=Wg.EMPTY)}return t}},{key:"refCount",value:function(){return uN()(this)}}]),n}(my);function lN(e,t){return Ey(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new Sy(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;By(e(n,u)).subscribe(i=new Sy(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function hN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new Sy(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function fN(e,t){return Ey(hN(e,t,arguments.length>=2,!0))}function dN(e){return Ey(function(t,n){var r,i=null,a=!1;i=t.subscribe(new Sy(n,void 0,void 0,function(o){r=By(e(o,dN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function vN(e){return e<=0?function(){return qy}:Ey(function(t,n){var r=[];t.subscribe(new Sy(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=Gg(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function pN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gN;return Ey(function(t,n){var r=!1;t.subscribe(new Sy(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function gN(){return new aN}function yN(e){return Ey(function(t,n){var r=!1;t.subscribe(new Sy(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function mN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wM(function(t,n){return e(t,n,r)}):yy,Jy(1),n?yN(t):pN(function(){return new aN}))}}function kN(e,t,n){var r=Vg(e)||t||n?{next:e,error:t,complete:n}:e;return r?Ey(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new Sy(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):yy}var _N=Zg(function e(t,n){jg(this,e),this.id=t,this.url=n}),CN=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return jg(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return Zg(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(_N),wN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return Zg(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(_N),bN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).reason=i,a}return Zg(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(_N),EN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).error=i,a}return Zg(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(_N),SN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Zg(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(_N),PN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Zg(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(_N),ON=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return Zg(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(_N),TN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Zg(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(_N),IN=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Zg(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(_N),AN=function(){function e(t){jg(this,e),this.route=t}return Zg(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),RN=function(){function e(t){jg(this,e),this.route=t}return Zg(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),xN=function(){function e(t){jg(this,e),this.snapshot=t}return Zg(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),MN=function(){function e(t){jg(this,e),this.snapshot=t}return Zg(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),NN=function(){function e(t){jg(this,e),this.snapshot=t}return Zg(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),DN=function(){function e(t){jg(this,e),this.snapshot=t}return Zg(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),LN=function(){function e(t,n,r){jg(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return Zg(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),FN="primary",UN=function(){function e(t){jg(this,e),this.params=t||{}}return Zg(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function VN(e){return new UN(e)}var BN="ngNavigationCancelingError";function zN(e){var t=Error("NavigationCancelingError: "+e);return t[BN]=!0,t}function HN(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function GN(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!$N(e[n=r[a]],t[n]))return!1;return!0}function $N(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=zg(e).sort(),r=zg(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function qN(e){return Array.prototype.concat.apply([],e)}function jN(e){return e.length>0?e[e.length-1]:null}function WN(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function ZN(e){return uS(e)?e:sS(e)?Xy(Promise.resolve(e)):_M(e)}var YN={exact:function e(t,n,r){if(!iD(t.segments,n.segments)||!eD(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:XN},KN={exact:function(e,t){return GN(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return $N(e[n],t[n])})},ignored:function(){return!0}};function QN(e,t,n){return YN[n.paths](e.root,t.root,n.matrixParams)&&KN[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function XN(e,t,n){return JN(e,t,t.segments,n)}function JN(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!iD(i,n)||t.hasChildren()||!eD(i,n,r))}if(e.segments.length===n.length){if(!iD(e.segments,n)||!eD(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!XN(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(iD(e.segments,o)&&eD(e.segments,o,r)&&e.children[FN])&&JN(e.children[FN],t,s,r)}function eD(e,t,n){return t.every(function(t,r){return KN[n](e[r].parameters,t.parameters)})}var tD=function(){function e(t,n,r){jg(this,e),this.root=t,this.queryParams=n,this.fragment=r}return Zg(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=VN(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return sD.serialize(this)}}]),e}(),nD=function(){function e(t,n){var r=this;jg(this,e),this.segments=t,this.children=n,this.parent=null,WN(n,function(e,t){return e.parent=r})}return Zg(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return uD(this)}}]),e}(),rD=function(){function e(t,n){jg(this,e),this.path=t,this.parameters=n}return Zg(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=VN(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return pD(this)}}]),e}();function iD(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var aD=Zg(function e(){jg(this,e)}),oD=function(){function e(){jg(this,e)}return Zg(e,[{key:"parse",value:function(e){var t=new _D(e);return new tD(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(cD(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(hD(t),"=").concat(hD(e))}).join("&"):"".concat(hD(t),"=").concat(hD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),sD=new oD;function uD(e){return e.segments.map(function(e){return pD(e)}).join("/")}function cD(e,t){if(!e.hasChildren())return uD(e);if(t){var n=e.children[FN]?cD(e.children[FN],!1):"",r=[];return WN(e.children,function(e,t){t!==FN&&r.push("".concat(t,":").concat(cD(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return WN(e.children,function(e,r){r===FN&&(n=n.concat(t(e,r)))}),WN(e.children,function(e,r){r!==FN&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===FN?[cD(e.children[FN],!1)]:["".concat(n,":").concat(cD(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[FN]?"".concat(uD(e),"/").concat(i[0]):"".concat(uD(e),"/(").concat(i.join("//"),")")}function lD(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function hD(e){return lD(e).replace(/%3B/gi,";")}function fD(e){return lD(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dD(e){return decodeURIComponent(e)}function vD(e){return dD(e.replace(/\+/g,"%20"))}function pD(e){return"".concat(fD(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(fD(t),"=").concat(fD(e[t]))}).join("")}(e.parameters))}var gD=/^[^\/()?;=#]+/;function yD(e){var t=e.match(gD);return t?t[0]:""}var mD=/^[^=?&#]+/,kD=/^[^?&#]+/,_D=function(){function e(t){jg(this,e),this.url=t,this.remaining=t}return Zg(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new nD([],{}):new nD([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[FN]=new nD(e,t)),n}},{key:"parseSegment",value:function(){var e=yD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new rD(dD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=yD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=yD(this.remaining);r&&(n=r,this.capture(n))}e[dD(t)]=dD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(mD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(kD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=vD(t),a=vD(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=yD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=FN);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[FN]:new nD([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),CD=function(){function e(t){jg(this,e),this._root=t}return Zg(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=wD(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=wD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=bD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return bD(e,this._root).map(function(e){return e.value})}}]),e}();function wD(e,t){if(e===t.value)return t;var n,r=Gg(t.children);try{for(r.s();!(n=r.n()).done;){var i=wD(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function bD(e,t){if(e===t.value)return[t];var n,r=Gg(t.children);try{for(r.s();!(n=r.n()).done;){var i=bD(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var ED=function(){function e(t,n){jg(this,e),this.value=t,this.children=n}return Zg(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function SD(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var PD=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e)).snapshot=r,xD(Ug(i),e),i}return Zg(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(CD);function OD(e,t){var n=function(e,t){var n=new AD([],{},{},"",{},FN,t,null,e.root,-1,{});return new RD("",new ED(n,[]))}(e,t),r=new rN([new rD("",{})]),i=new rN({}),a=new rN({}),o=new rN({}),s=new rN(""),u=new TD(r,i,o,s,a,FN,t,n.root);return u.snapshot=n.root,new PD(new ED(u,[]),n)}var TD=function(){function e(t,n,r,i,a,o,s,u){jg(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return Zg(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Py(function(e){return VN(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Py(function(e){return VN(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function ID(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var AD=function(){function e(t,n,r,i,a,o,s,u,c,l,h){jg(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return Zg(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=VN(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=VN(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),RD=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,r)).url=e,xD(Ug(i),r),i}return Zg(n,[{key:"toString",value:function(){return MD(this._root)}}]),n}(CD);function xD(e,t){t.value._routerState=e,t.children.forEach(function(t){return xD(e,t)})}function MD(e){var t=e.children.length>0?" { ".concat(e.children.map(MD).join(", ")," } "):"";return"".concat(e.value).concat(t)}function ND(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,GN(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),GN(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!GN(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),GN(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function DD(e,t){var n=GN(e.params,t.params)&&function(e,t){return iD(e,t)&&e.every(function(e,n){return GN(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||DD(e.parent,t.parent))}function LD(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=Gg(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return LD(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return LD(e,t)})}(e,t,n);return new ED(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return FD(t,o),o}}var s=function(e){return new TD(new rN(e.url),new rN(e.params),new rN(e.queryParams),new rN(e.fragment),new rN(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return LD(e,t)});return new ED(s,u)}function FD(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)FD(e.children[n],t.children[n])}function UD(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function VD(e){return"object"==typeof e&&null!=e&&e.outlets}function BD(e,t,n,r,i){var a={};return r&&WN(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new tD(n.root===e?t:zD(n.root,e,t),a,i)}function zD(e,t,n){var r={};return WN(e.children,function(e,i){r[i]=e===t?n:zD(e,t,n)}),new nD(e.segments,r)}var HD=function(){function e(t,n,r){if(jg(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&UD(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(VD);if(i&&i!==jN(r))throw new Error("{outlets:{}} has to be the last command")}return Zg(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),GD=Zg(function e(t,n,r){jg(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function $D(e,t,n){if(e||(e=new nD([],{})),0===e.segments.length&&e.hasChildren())return qD(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(VD(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!YD(u,c,o))return a;r+=2}else{if(!YD(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new nD(e.segments.slice(0,r.pathIndex),{});return a.children[FN]=new nD(e.segments.slice(r.pathIndex),e.children),qD(a,0,i)}return r.match&&0===i.length?new nD(e.segments,{}):r.match&&!e.hasChildren()?jD(e,t,n):r.match?qD(e,0,i):jD(e,t,n)}function qD(e,t,n){if(0===n.length)return new nD(e.segments,{});var r=function(e){return VD(e[0])?e[0].outlets:Pg({},FN,e)}(n),i={};return WN(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=$D(e.children[r],t,n))}),WN(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new nD(e.segments,i)}function jD(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(VD(a)){var o=WD(a.outlets);return new nD(r,o)}if(0===i&&UD(n[0]))r.push(new rD(e.segments[t].path,ZD(n[0]))),i++;else{var s=VD(a)?a.outlets[FN]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&UD(u)?(r.push(new rD(s,ZD(u))),i+=2):(r.push(new rD(s,{})),i++)}}return new nD(r,{})}function WD(e){var t={};return WN(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=jD(new nD([],{}),0,e))}),t}function ZD(e){var t={};return WN(e,function(e,n){return t[n]="".concat(e)}),t}function YD(e,t,n){return e==n.path&&GN(t,n.parameters)}var KD=function(){function e(t,n,r,i){jg(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return Zg(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),ND(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=SD(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),WN(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=SD(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=SD(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new DN(e.value.snapshot))}),e.children.length&&this.forwardEvent(new MN(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(ND(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),QD(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function QD(e){ND(e.value),e.children.forEach(QD)}var XD=Zg(function e(t,n){jg(this,e),this.routes=t,this.module=n});function JD(e){return"function"==typeof e}function eL(e){return e instanceof tD}var tL=Symbol("INITIAL_VALUE");function nL(){return lN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Zy(t),i=Wy(t),a=RR(t),o=a.args,s=a.keys;if(0===o.length)return Xy([],r);var u=new my(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yy;return function(r){iN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){iN(t,function(){var u=Xy(e[i],t),c=!1;u.subscribe(new Sy(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return NR(s,e)}:yy));return i?u.pipe(MR(i)):u}(e.map(function(e){return e.pipe(Jy(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Zy(t);return Ey(function(e,n){(r?oN(t,e,r):oN(t,e)).subscribe(n)})}(tL))})).pipe(fN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==tL?e:(r===tL&&(n=!0),n||!1!==r&&i!==t.length-1&&!eL(r)?e:r)},e)},tL),wM(function(e){return e!==tL}),Py(function(e){return eL(e)?e:!0===e}),Jy(1))})}var rL=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=$m({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&rS(0,"router-outlet")},directives:function(){return[eF]},encapsulation:2}),e}();function iL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];aL(r,oL(t,r))}}function aL(e,t){e.children&&iL(e.children,t)}function oL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function sL(e){var t=e.children&&e.children.map(sL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==FN&&(n.component=rL),n}function uL(e){return e.outlet||FN}function cL(e,t){var n=e.filter(function(e){return uL(e)===t});return n.push.apply(n,zg(e.filter(function(e){return uL(e)!==t}))),n}var lL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function hL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},lL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||HN)(n,e,t);if(!i)return Object.assign({},lL);var a={};WN(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function fL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return dL(e,t,n)&&uL(n)!==FN})}(e,n,r)){var a=new nD(t,function(e,t,n,r){var i={};i[FN]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=Gg(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&uL(s)!==FN){var u=new nD([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[uL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new nD(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return dL(e,t,n)})}(e,n,r)){var o=new nD(e.segments,function(e,t,n,r,i,a){var o,s={},u=Gg(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(dL(e,n,c)&&!i[uL(c)]){var l=new nD([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[uL(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new nD(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function dL(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function vL(e,t,n,r){return!!(uL(e)===r||r!==FN&&dL(t,n,e))&&("**"===e.path||hL(t,e,n).matched)}function pL(e,t,n){return 0===t.length&&!e.children[n]}var gL=Zg(function e(t){jg(this,e),this.segmentGroup=t||null}),yL=Zg(function e(t){jg(this,e),this.urlTree=t});function mL(e){return new my(function(t){return t.error(new gL(e))})}function kL(e){return new my(function(t){return t.error(new yL(e))})}function _L(e){return new my(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var CL=function(){function e(t,n,r,i,a){jg(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(GO)}return Zg(e,[{key:"apply",value:function(){var e=this,t=fL(this.urlTree.root,[],[],this.config).segmentGroup,n=new nD(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,FN).pipe(Py(function(t){return e.createUrlTree(wL(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(dN(function(t){if(t instanceof yL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof gL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,FN).pipe(Py(function(n){return t.createUrlTree(wL(n),e.queryParams,e.fragment)})).pipe(dN(function(e){throw e instanceof gL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new nD([],Pg({},FN,e)):e;return new tD(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Py(function(e){return new nD([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return Xy(i).pipe(CM(function(i){var a=n.children[i],o=cL(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Py(function(e){return{segment:e,outlet:i}}))}),fN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wM(function(t,n){return e(t,n,r)}):yy,vN(1),n?yN(t):pN(function(){return new aN}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return Xy(n).pipe(CM(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(dN(function(e){if(e instanceof gL)return _M(null);throw e}))}),mN(function(e){return!!e}),dN(function(e,n){if(e instanceof aN||"EmptyError"===e.name){if(pL(t,r,i))return _M(new nD([],{}));throw new gL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return vL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):mL(t):mL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?kL(a):this.lineralizeSegments(n,a).pipe(Gy(function(n){var a=new nD(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=hL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return mL(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?kL(f):this.lineralizeSegments(r,f).pipe(Gy(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?_M(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Py(function(e){return n._loadedConfig=e,new nD(r,{})})):_M(new nD(r,{}));var o=hL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return mL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(Gy(function(e){var r=e.module,o=e.routes,s=fL(t,u,l,o),c=s.segmentGroup,h=s.slicedSegments,f=new nD(c.segments,c.children);if(0===h.length&&f.hasChildren())return a.expandChildren(r,o,f).pipe(Py(function(e){return new nD(u,e)}));if(0===o.length&&0===h.length)return _M(new nD(u,{}));var d=uL(n)===i;return a.expandSegment(r,f,o,h,d?FN:i,!0).pipe(Py(function(e){return new nD(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?_M(new XD(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?_M(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Gy(function(n){return n?r.configLoader.load(e.injector,t).pipe(Py(function(e){return t._loadedConfig=e,e})):(i=t,new my(function(e){return e.error(zN("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):_M(new XD([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?_M(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&JD(a.canLoad))i=o.canLoad(t,n);else{if(!JD(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return ZN(i)})).pipe(nL(),kN(function(e){if(eL(e)){var t=zN('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Py(function(e){return!0===e})):_M(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return _M(n);if(r.numberOfChildren>1||!r.children[FN])return _L(e.redirectTo);r=r.children[FN]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new tD(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return WN(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return WN(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new nD(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function wL(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=wL(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[FN]){var t=e.children[FN];return new nD(e.segments.concat(t.segments),t.children)}return e}(new nD(e.segments,t))}var bL=Zg(function e(t){jg(this,e),this.path=t,this.route=this.path[this.path.length-1]}),EL=Zg(function e(t,n){jg(this,e),this.component=t,this.route=n});function SL(e,t,n){var r=e._root;return OL(r,t?t._root:null,n,[r.value])}function PL(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function OL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=SD(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!iD(e.url,t.url);case"pathParamsOrQueryParamsChange":return!iD(e.url,t.url)||!GN(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!DD(e,t)||!GN(e.queryParams,t.queryParams);default:return!DD(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new bL(r)):(a.data=o.data,a._resolvedData=o._resolvedData),OL(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new EL(s.outlet.component,o))}else o&&TL(t,s,i),i.canActivateChecks.push(new bL(r)),OL(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),WN(a,function(e,t){return TL(e,n.getContext(t),i)}),i}function TL(e,t,n){var r=SD(e),i=e.value;WN(r,function(e,r){TL(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new EL(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var IL=Zg(function e(){jg(this,e)});function AL(e){return new my(function(t){return t.error(e)})}var RL=function(){function e(t,n,r,i,a,o){jg(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return Zg(e,[{key:"recognize",value:function(){var e=fL(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,FN);if(null===t)return null;var n=new AD([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},FN,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new ED(n,t),i=new RD(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=ID(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=cL(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,zg(u))}var c=xL(n);return c.sort(function(e,t){return e.value.outlet===FN?-1:t.value.outlet===FN?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=Gg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return pL(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!vL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?jN(n).parameters:{};i=new AD(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DL(e),uL(e),e.component,e,ML(t),NL(t)+n.length,LL(e))}else{var u=hL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new AD(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DL(e),uL(e),e.component,e,ML(t),NL(t)+a.length,LL(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],h=fL(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),f=h.segmentGroup,d=h.slicedSegments;if(0===d.length&&f.hasChildren()){var v=this.processChildren(l,f);return null===v?null:[new ED(i,v)]}if(0===l.length&&0===d.length)return[new ED(i,[])];var p=uL(e)===r,g=this.processSegment(l,f,d,p?FN:r);return null===g?null:[new ED(i,g)]}}]),e}();function xL(e){var t,n=[],r=new Set,i=Gg(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,zg(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=Gg(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=xL(u.children);n.push(new ED(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function ML(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function NL(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function DL(e){return e.data||{}}function LL(e){return e.resolve||{}}function FL(e){return lN(function(t){var n=e(t);return n?Xy(n).pipe(Py(function(){return t})):_M(t)})}var UL=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n)}(function(){function e(){jg(this,e)}return Zg(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),VL=new K_("ROUTES"),BL=function(){function e(t,n,r,i){jg(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return Zg(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Py(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new XD(qN(i.injector.get(VL,void 0,Em.Self|Em.Optional)).map(sL),i)}),dN(function(e){throw t._loader$=void 0,e}));return t._loader$=new cN(r,function(){return new Cy}).pipe(uN()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Xy(this.loader.load(e)):ZN(e()).pipe(Gy(function(e){return e instanceof $O?_M(e):Xy(t.compiler.compileModuleAsync(e))}))}}]),e}(),zL=Zg(function e(){jg(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new HL,this.attachRef=null}),HL=function(){function e(){jg(this,e),this.contexts=new Map}return Zg(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new zL,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),GL=function(){function e(){jg(this,e)}return Zg(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function $L(e){throw e}function qL(e,t,n){return t.parse("/")}function jL(e,t){return _M(null)}var WL={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ZL={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},YL=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;jg(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Cy,this.errorHandler=$L,this.malformedUriErrorHandler=qL,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:jL,afterPreactivation:jL},this.urlHandlingStrategy=new GL,this.routeReuseStrategy=new UL,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(GO),this.console=a.get(HT);var l=a.get(tI);this.isNgZoneEnabled=l instanceof tI&&tI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new tD(new nD([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new BL(o,s,function(e){return c.triggerEvent(new AN(e))},function(e){return c.triggerEvent(new RN(e))}),this.routerState=OD(this.currentUrlTree,this.rootComponentType),this.transitions=new rN({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return Zg(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(wM(function(e){return 0!==e.id}),Py(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),lN(function(e){var r=!1,i=!1;return _M(e).pipe(kN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),lN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return KL(e.source)&&(t.browserUrlTree=e.extractedUrl),_M(e).pipe(lN(function(e){var r=t.transitions.getValue();return n.next(new CN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?qy:Promise.resolve(e)}),function(e,t,n,r){return lN(function(i){return function(e,t,n,r,i){return new CL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Py(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),kN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return Gy(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new RL(e,t,n,r,a,o).recognize();return null===s?AL(new IL):_M(s)}catch(i){return AL(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Py(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),kN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new SN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,h=new CN(o,t.serializeUrl(s),u,c);n.next(h);var f=OD(s,t.rootComponentType).snapshot;return _M(Object.assign(Object.assign({},e),{targetSnapshot:f,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),qy}),FL(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),kN(function(e){var n=new PN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Py(function(e){return Object.assign(Object.assign({},e),{guards:SL(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return Gy(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?_M(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Xy(e).pipe(Gy(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?_M(a.map(function(a){var o,s=PL(a,t,i);if(function(e){return e&&JD(e.canDeactivate)}(s))o=ZN(s.canDeactivate(e,t,n,r));else{if(!JD(s))throw new Error("Invalid CanDeactivate guard");o=ZN(s(e,t,n,r))}return o.pipe(mN())})).pipe(nL()):_M(!0)}(e.component,e.route,n,t,r)}),mN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(Gy(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return Xy(t).pipe(CM(function(t){return oN(function(e,t){return null!==e&&t&&t(new xN(e)),_M(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new NN(e)),_M(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return sN(function(){return _M(t.guards.map(function(i){var a,o=PL(i,t.node,n);if(function(e){return e&&JD(e.canActivateChild)}(o))a=ZN(o.canActivateChild(r,e));else{if(!JD(o))throw new Error("Invalid CanActivateChild guard");a=ZN(o(r,e))}return a.pipe(mN())})).pipe(nL())})});return _M(i).pipe(nL())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return _M(!0);var i=r.map(function(r){return sN(function(){var i,a=PL(r,t,n);if(function(e){return e&&JD(e.canActivate)}(a))i=ZN(a.canActivate(t,e));else{if(!JD(a))throw new Error("Invalid CanActivate guard");i=ZN(a(t,e))}return i.pipe(mN())})});return _M(i).pipe(nL())}(e,t.route,n))}),mN(function(e){return!0!==e},!0))}(r,o,e,t):_M(n)}),Py(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),kN(function(e){if(eL(e.guardsResult)){var n=zN('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new ON(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),wM(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),FL(function(e){if(e.guards.canActivateChecks.length)return _M(e).pipe(kN(function(e){var n=new TN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),lN(function(e){var n=!1;return _M(e).pipe(function(e,t){return Gy(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return _M(n);var a=0;return Xy(i).pipe(CM(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return _M({});var a={};return Xy(i).pipe(Gy(function(i){return function(e,t,n,r){var i=PL(e,t,r);return ZN(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(kN(function(e){a[i]=e}))}),vN(1),Gy(function(){return Object.keys(a).length===i.length?_M(a):qy}))}(e._resolve,e,t,r).pipe(Py(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),ID(e,n).resolve),null}))}(n.route,r,e,t)}),kN(function(){return a++}),vN(1),Gy(function(e){return a===i.length?_M(n):qy}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),kN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),kN(function(e){var n=new IN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),FL(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Py(function(e){var n=function(e,t,n){var r=LD(e,t._root,n?n._root:void 0);return new PD(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),kN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Py(function(r){return new KD(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),kN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return Ey(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),dN(function(r){if(i=!0,function(e){return e&&e[BN]}(r)){var a=eL(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new bN(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||KL(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new EN(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return qy}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){iL(e),this.config=e.map(sL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return BD(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new HD(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return WN(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(zg(e),[{outlets:a}])}if(r.segmentPath)return[].concat(zg(e),[r.segmentPath])}return"string"!=typeof r?[].concat(zg(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(zg(e),[r])},[]);return new HD(n,t,r)}(n);if(a.toRoot())return BD(t.root,new nD([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new GD(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new GD(r,r===t.root,0)}var i=UD(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new GD(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?qD(o.segmentGroup,o.index,a.commands):$D(o.segmentGroup,o.index,a.commands);return BD(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=eL(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},WL):!1===t?Object.assign({},ZL):t,eL(e))return QN(this.currentUrlTree,e,n);var r=this.parseUrl(e);return QN(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new wN(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),h=KL(t)&&l&&!KL(l.source),f=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(h&&f)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new bN(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(X_),gC(aD),gC(HL),gC(WI),gC(AE),gC(wI),gC(XT),gC(void 0))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function KL(e){return"imperative"!==e}var QL=function(){var e=function(){function e(t,n,r,i,a){jg(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Cy,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return Zg(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:JL(this.skipLocationChange),replaceUrl:JL(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:JL(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL),XE(TD),W_("tabindex"),XE(fO),XE(cO))},e.\u0275dir=Km({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&cS("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ck]}),e}(),XL=function(){var e=function(){function e(t,n,r){var i=this;jg(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Cy,this.subscription=t.events.subscribe(function(e){e instanceof wN&&i.updateTargetUrlAndHref()})}return Zg(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:JL(this.skipLocationChange),replaceUrl:JL(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:JL(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL),XE(TD),XE(HI))},e.\u0275dir=Km({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&cS("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(GS("href",t.href,cw),qE("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ck]}),e}();function JL(e){return""===e||!!e}var eF=function(){var e=function(){function e(t,n,r,i,a){jg(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new yT,this.deactivateEvents=new yT,this.name=i||FN,t.onChildOutletCreated(this.name,this)}return Zg(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new tF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(HL),XE(jO),XE(aO),W_("name"),XE(DO))},e.\u0275dir=Km({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),tF=function(){function e(t,n,r){jg(this,e),this.route=t,this.childContexts=n,this.parent=r}return Zg(e,[{key:"get",value:function(e,t){return e===TD?this.route:e===HL?this.childContexts:this.parent.get(e,t)}}]),e}(),nF=Zg(function e(){jg(this,e)}),rF=function(){function e(){jg(this,e)}return Zg(e,[{key:"preload",value:function(e,t){return _M(null)}}]),e}(),iF=function(){var e=function(){function e(t,n,r,i,a){jg(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new BL(n,r,function(e){return t.triggerEvent(new AN(e))},function(e){return t.triggerEvent(new RN(e))})}return Zg(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(wM(function(e){return e instanceof wN}),CM(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(GO);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return Xy(r).pipe($y(),Py(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?_M(t._loadedConfig):n.loader.load(e.injector,t)).pipe(Gy(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(YL),gC(wI),gC(XT),gC(AE),gC(nF))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),aF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};jg(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return Zg(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof CN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof wN&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof LN&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new LN(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(YL),gC($A),gC(void 0))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),oF=new K_("ROUTER_CONFIGURATION"),sF=new K_("ROUTER_FORROOT_GUARD"),uF=[WI,{provide:aD,useClass:oD},{provide:YL,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new YL(null,e,t,n,r,i,a,qN(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[aD,HL,WI,AE,wI,XT,VL,oF,[function(){return Zg(function e(){jg(this,e)})}(),new EC],[function(){return Zg(function e(){jg(this,e)})}(),new EC]]},HL,{provide:TD,useFactory:function(e){return e.routerState.root},deps:[YL]},{provide:wI,useClass:SI},iF,rF,function(){function e(){jg(this,e)}return Zg(e,[{key:"preload",value:function(e,t){return t().pipe(dN(function(){return _M(null)}))}}]),e}(),{provide:oF,useValue:{enableTracing:!1}}];function cF(){return new pI("Router",YL)}var lF=function(){var e=function(){function e(t,n){jg(this,e)}return Zg(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[uF,vF(t),{provide:sF,useFactory:dF,deps:[[YL,new EC,new SC]]},{provide:oF,useValue:n||{}},{provide:HI,useFactory:fF,deps:[MI,[new bC($I),new EC],oF]},{provide:aF,useFactory:hF,deps:[YL,$A,oF]},{provide:nF,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:rF},{provide:pI,multi:!0,useFactory:cF},[pF,{provide:NT,multi:!0,useFactory:gF,deps:[pF]},{provide:mF,useFactory:yF,deps:[pF]},{provide:zT,multi:!0,useExisting:mF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[vF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(sF,8),gC(YL,8))},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({}),e}();function hF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new aF(e,t,n)}function fF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new jI(e,t):new qI(e,t)}function dF(e){return"guarded"}function vF(e){return[{provide:Q_,multi:!0,useValue:e},{provide:VL,multi:!0,useValue:e}]}var pF=function(){var e=function(){function e(t){jg(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Cy}return Zg(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(DI,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(YL),i=e.injector.get(oF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?_M(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(oF),n=this.injector.get(iF),r=this.injector.get(aF),i=this.injector.get(YL),a=this.injector.get(_I);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(AE))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}();function gF(e){return e.appInitializer.bind(e)}function yF(e){return e.bootstrapListener.bind(e)}var mF=new K_("Router Initializer"),kF=Zg(function e(){jg(this,e)}),_F="*";function CF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function wF(e){return{type:6,styles:e,offset:null}}function bF(e){Promise.resolve(null).then(e)}var EF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;jg(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return Zg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;bF(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),SF=function(){function e(t){var n=this;jg(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?bF(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return Zg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function PF(){return"undefined"!=typeof window&&void 0!==window.document}function OF(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function TF(e){switch(e.length){case 0:return new EF;case 1:return e[0];default:return new SF(e)}}function IF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case _F:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function AF(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&RF(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&RF(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&RF(n,"destroy",e))})}}function RF(e,t,n){var r,i=xF(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function xF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function MF(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function NF(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var DF=function(e,t){return!1},LF=function(e,t){return!1},FF=function(e,t,n){return[]},UF=OF();(UF||"undefined"!=typeof Element)&&(DF=PF()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},LF=function(){if(UF||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:LF}(),FF=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var VF=null,BF=!1;function zF(e){VF||(VF=("undefined"!=typeof document?document.body:null)||{},BF=!!VF.style&&"WebkitAppearance"in VF.style);var t=!0;return VF.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in VF.style)&&BF&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in VF.style)),t}var HF=LF,GF=DF,$F=FF;function qF(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var jF=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"validateStyleProperty",value:function(e){return zF(e)}},{key:"matchesElement",value:function(e,t){return HF(e,t)}},{key:"containsElement",value:function(e,t){return GF(e,t)}},{key:"query",value:function(e,t,n){return $F(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new EF(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),WF=function(){var e=Zg(function e(){jg(this,e)});return e.NOOP=new jF,e}(),ZF="ng-enter",YF="ng-leave",KF="ng-trigger",QF=".ng-trigger",XF="ng-animating",JF=".ng-animating";function eU(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:tU(parseFloat(t[1]),t[2])}function tU(e,t){return"s"===t?1e3*e:e}function nU(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=tU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=tU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function rU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function iU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else rU(e,n);return n}function aU(e,t,n){return n?t+":"+n+";":""}function oU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=aU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=aU(0,gU(i),e.style[i]));e.setAttribute("style",t)}function sU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=pU(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),OF()&&oU(e))}function uU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=pU(t);e.style[n]=""}),OF()&&oU(e))}function cU(e){return Array.isArray(e)?1==e.length?e[0]:CF(e):e}var lU=new RegExp("{{\\s*(.+?)\\s*}}","g");function hU(e){var t=[];if("string"==typeof e){for(var n;n=lU.exec(e);)t.push(n[1]);lU.lastIndex=0}return t}function fU(e,t,n){var r=e.toString(),i=r.replace(lU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function dU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var vU=/-+([a-z0-9])/g;function pU(e){return e.replace(vU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function gU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function yU(e,t){return 0===e||0===t}function mU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=_U(e,t)})},s=1;s<t.length;s++)o()}return t}function kU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function _U(e,t){return window.getComputedStyle(e)[t]}function CU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(EU(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(EU(s,a))}(e,n,t)}):n.push(e),n}var wU=new Set(["true","1"]),bU=new Set(["false","0"]);function EU(e,t){var n=wU.has(e)||bU.has(e),r=wU.has(t)||bU.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?wU.has(e):bU.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?wU.has(t):bU.has(t)),o&&s}}var SU=new RegExp("s*:selfs*,?","g");function PU(e,t,n){return new OU(e).build(t,n)}var OU=function(){function e(t){jg(this,e),this._driver=t}return Zg(e,[{key:"build",value:function(e,t){var n=new TU(t);return this._resetContextStyleTimingState(n),kU(this,cU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(IU(e)){var t=e;Object.keys(t).forEach(function(e){hU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=dU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=kU(this,cU(e.animation),t);return{type:1,matchers:CU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:AU(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return kU(n,e,t)}),options:AU(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=kU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:AU(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return RU(nU(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=RU(0,0,"");return i.dynamic=!0,i.strValue=r,i}return RU((n=n||nU(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:wF({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=wF(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==_F?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(IU(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=hU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(IU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(IU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(l-1));var f=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=h>0?i==f?1:h*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:kU(this,cU(e.animation),t),options:AU(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:AU(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:AU(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(SU,"")),e=e.replace(/@\*/g,QF).replace(/@\w+/g,function(e){return QF+"-"+e.substr(1)}).replace(/:animating/g,JF),[e,t]}(e.selector),a=Og(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,MF(t.collectedStyles,t.currentQuerySelector,{});var u=kU(this,cU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:AU(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:nU(e.timings,t.errors,!0);return{type:12,animation:kU(this,cU(e.animation),t),timings:n,options:null}}}]),e}(),TU=Zg(function e(t){jg(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function IU(e){return!Array.isArray(e)&&"object"==typeof e}function AU(e){return e?(e=rU(e)).params&&(e.params=function(e){return e?rU(e):null}(e.params)):e={},e}function RU(e,t,n){return{duration:e,delay:t,easing:n}}function xU(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var MU=function(){function e(){jg(this,e),this._map=new Map}return Zg(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,zg(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),NU=new RegExp(":enter","g"),DU=new RegExp(":leave","g");function LU(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new FU).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var FU=function(){function e(){jg(this,e)}return Zg(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new MU;var l=new VU(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),kU(this,n,l);var h=l.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(o).length){var f=h[h.length-1];f.allowOnlyTimelineStyles()||f.setStyles([o],null,l.errors,s)}return h.length?h.map(function(e){return e.buildKeyframes()}):[xU(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?eU(n.duration):null,a=null!=n.delay?eU(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),kU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=UU);var o=eU(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return kU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?eU(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),kU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return nU(t.params?fU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?eU(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=UU);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),kU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;kU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),UU={},VU=function(){function e(t,n,r,i,a,o,s,u){jg(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=UU,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new BU(this._driver,n,0),s.push(this.currentTimeline)}return Zg(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=eU(r.duration)),null!=r.delay&&(i.delay=eU(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=fU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=UU,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new zU(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(NU,"."+this._enterClassName)).replace(DU,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,zg(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),BU=function(){function e(t,n,r,i){jg(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return Zg(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||_F,t._currentKeyframe[e]=_F}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=_F}):iU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=fU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:_F),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=iU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==_F&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?dU(t.values()):[],o=n.size?dU(n.values()):[];if(r){var s=i[0],u=rU(s);s.offset=0,u.offset=1,i=[s,u]}return xU(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),zU=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return jg(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return Zg(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=iU(e[0],!1);u.offset=0,a.push(u);var c=iU(e[0],!1);c.offset=HU(s),a.push(c);for(var l=e.length-1,h=1;h<=l;h++){var f=iU(e[h],!1);f.offset=HU((n+f.offset*r)/o),a.push(f)}r=o,n=0,i="",e=a}return xU(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(BU);function HU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var GU=Zg(function e(){jg(this,e)}),$U=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"normalizePropertyName",value:function(e,t){return pU(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(qU[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(GU),qU=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function jU(e,t,n,r,i,a,o,s,u,c,l,h,f){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:f}}var WU={},ZU=function(){function e(t,n,r){jg(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return Zg(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||WU,f=this.buildStyles(n,o&&o.params||WU,l),d=s&&s.params||WU,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},h),d)},_=c?[]:LU(e,t,this.ast.animation,i,a,f,v,k,u,l),C=0;if(_.forEach(function(e){C=Math.max(e.duration+e.delay,C)}),l.length)return jU(t,this._triggerName,n,r,m,f,v,[],[],g,y,C,l);_.forEach(function(e){var n=e.element,r=MF(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=MF(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var w=dU(p.values());return jU(t,this._triggerName,n,r,m,f,v,_,w,g,y,C)}}]),e}(),YU=function(){function e(t,n,r){jg(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return Zg(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=rU(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=fU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),KU=function(){function e(t,n,r){var i=this;jg(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new YU(e.style,e.options&&e.options.params||{},r)}),QU(this.states,"true","1"),QU(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new ZU(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new ZU(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return Zg(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function QU(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var XU=new MU,JU=function(){function e(t,n,r){jg(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return Zg(e,[{key:"register",value:function(e,t){var n=[],r=PU(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=IF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=LU(this._driver,t,o,ZF,YF,{},{},i,XU,a)).forEach(function(e){var t=MF(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,_F)})});var u=TF(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=xF(t,"","","");return AF(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),eV="ng-animate-queued",tV="ng-animate-disabled",nV=".ng-animate-disabled",rV=[],iV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},aV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},oV="__ng_removed",sV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";jg(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=rU(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return Zg(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),uV="void",cV=new sV(uV),lV=function(){function e(t,n,r){jg(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,mV(n,this._hostClassName)}return Zg(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=MF(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=MF(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(mV(e,KF),mV(e,KF+"-"+t),u[t]=cV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new fV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(mV(e,KF),mV(e,KF+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new sV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=cV),c.value===uV||u.value!==c.value){var l=MF(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=a.matchTransition(u.value,c.value,e,c.params),f=!1;if(!h){if(!i)return;h=a.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:o,isFallbackTransition:f}),f||(mV(e,eV),o.onStart(function(){kV(e,eV)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){uU(e,v),sU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,QF,!0);r.forEach(function(e){if(!e[oV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,uV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&TF(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||cV,u=new sV(uV),c=new fV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[oV];(!s||s===iV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){mV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=xF(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,AF(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),hV=function(){function e(t,n,r){jg(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return Zg(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new lV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(dV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(dV(t)){var i=t[oV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),mV(e,tV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),kV(e,tV))}},{key:"removeNode",value:function(e,t,n,r){if(dV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[oV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return dV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,QF,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,JF,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return TF(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[oV];if(n&&n.setForRemoval){if(e[oV]=iV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,nV)&&this.markElementAsDisabled(e,!1),this.driver.query(e,nV,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)mV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?TF(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new MU,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var h=this.bodyNode,f=Array.from(this.statesByElement.keys()),d=gV(f,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=ZF+p++;v.set(t,n),e.forEach(function(e){return mV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var _=this.collectedLeaveElements[k],C=_[oV];C&&C.setForRemoval&&(g.push(_),y.add(_),C.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(_))}var w=new Map,b=gV(f,Array.from(y));b.forEach(function(e,t){var n=YF+p++;w.set(t,n),e.forEach(function(e){return mV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return kV(e,n)})}),b.forEach(function(e,t){var n=w.get(t);e.forEach(function(e){return kV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(E.push(t),n.collectedEnterElements.length){var l=a[oV];if(l&&l.setForMove)return void t.destroy()}var f=!h||!n.driver.containsElement(h,a),d=w.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,f);if(g.errors&&g.errors.length)S.push(g);else{if(f)return t.onStart(function(){return uU(a,g.fromStyles)}),t.onDestroy(function(){return sU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return uU(a,g.fromStyles)}),t.onDestroy(function(){return sU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return MF(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){MF(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return wV(e,u,c)}),R=new Map;pV(R,this.driver,m,c,_F).forEach(function(e){wV(e,u,c)&&A.push(e)});var x=new Map;d.forEach(function(e,t){pV(x,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=R.get(e),n=x.get(e);R.set(e,Object.assign(Object.assign({},t),n))});var M=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return sU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,h=[];c=c.parentNode;){var f=I.get(c);if(f){u=f;break}h.push(c)}h.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,x,R);if(o.setRealPlayer(d),u===D)M.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=TF(v)),i.push(o)}}else uU(t,s.fromStyles),o.onDestroy(function(){return sU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=TF(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[oV];if(kV(F,YF),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,zg(B));for(var z=this.driver.query(F,JF,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,zg(G))}}var $=V.filter(function(e){return!e.destroyed});$.length?_V(this,F,$):this.processLeaveNode(F)}}return g.length=0,M.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),M}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[oV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==uV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=Gg(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=MF(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}uU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,f=t.timelines.map(function(t){var f=t.element;l.add(f);var d=f[oV];if(d&&d.removedBeforeQueried)return new EF(t.duration,t.delay);var v=f!==u,p=function(e){var t=[];return CV(e,t),t}((n.get(f)||rV).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===f}),g=i.get(f),y=a.get(f),m=IF(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&h.add(f),v){var _=new fV(e,s,f);_.setRealPlayer(k),c.push(_)}return k});c.forEach(function(e){MF(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return mV(e,XF)});var d=TF(f);return d.onDestroy(function(){l.forEach(function(e){return kV(e,XF)}),sU(u,t.toStyles)}),h.forEach(function(e){MF(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new EF(e.duration,e.delay)}}]),e}(),fV=function(){function e(t,n,r){jg(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new EF,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return Zg(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return AF(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){MF(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function dV(e){return e&&1===e.nodeType}function vV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function pV(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(vV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[oV]=aV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return vV(e,a[s++])}),o}function gV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var yV="$$classes";function mV(e,t){if(e.classList)e.classList.add(t);else{var n=e[yV];n||(n=e[yV]={}),n[t]=!0}}function kV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[yV];n&&delete n[t]}}function _V(e,t,n){TF(n).onDone(function(){return e.processLeaveNode(t)})}function CV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof SF?CV(r.players,t):t.push(r)}}function wV(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var bV=function(){function e(t,n,r){var i=this;jg(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new hV(t,n,r),this._timelineEngine=new JU(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return Zg(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=PU(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new KU(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Og(NF(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Og(NF(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function EV(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=PV(t[0]),t.length>1&&(r=PV(t[t.length-1]))):t&&(n=PV(t)),n||r?new SV(e,n,r):null}var SV=function(){var e=function(){function e(t,n,r){jg(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return Zg(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&sU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(sU(this._element,this._initialStyles),this._endStyles&&(sU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(uU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(uU(this._element,this._endStyles),this._endStyles=null),sU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function PV(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];OV(i)&&((t=t||{})[i]=e[i])}return t}function OV(e){return"display"===e||"position"===e}var TV="animation",IV="animationend",AV=function(){function e(t,n,r,i,a,o,s){var u=this;jg(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return Zg(e,[{key:"apply",value:function(){(function(e,t){var n=LV(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),DV(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),NV(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){RV(this._element,this._name,"paused")}},{key:"resume",value:function(){RV(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=xV(this._element,this._name);this._position=e*this._duration,DV(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),NV(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=LV(e,"").split(","),r=MV(n,t);r>=0&&(n.splice(r,1),DV(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function RV(e,t,n){DV(e,"PlayState",n,xV(e,t))}function xV(e,t){var n=LV(e,"");return n.indexOf(",")>0?MV(n.split(","),t):MV([n],t)}function MV(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function NV(e,t,n){n?e.removeEventListener(IV,t):e.addEventListener(IV,t)}function DV(e,t,n,r){var i=TV+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function LV(e,t){return e.style[TV+t]||""}var FV=function(){function e(t,n,r,i,a,o,s,u){jg(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return Zg(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new AV(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:_U(e.element,r))})}this.currentSnapshot=t}}]),e}(),UV=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=qF(r),i}return Zg(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),xg(Bg(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),xg(Bg(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,xg(Bg(n.prototype),"destroy",this).call(this))}}]),n}(EF),VV=function(){function e(){jg(this,e),this._count=0}return Zg(e,[{key:"validateStyleProperty",value:function(e){return zF(e)}},{key:"matchesElement",value:function(e,t){return HF(e,t)}},{key:"containsElement",value:function(e,t){return GF(e,t)}},{key:"query",value:function(e,t,n){return $F(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return qF(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof FV}),s={};yU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=mU(e,t,s));if(0==n)return new UV(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var h=EV(e,t),f=new FV(e,t,c,n,r,i,u,h);return f.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),f}}]),e}(),BV=function(){function e(t,n,r,i){jg(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return Zg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:_U(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),zV=function(){function e(){jg(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(HV().toString()),this._cssKeyframesDriver=new VV}return Zg(e,[{key:"validateStyleProperty",value:function(e){return zF(e)}},{key:"matchesElement",value:function(e,t){return HF(e,t)}},{key:"containsElement",value:function(e,t){return GF(e,t)}},{key:"query",value:function(e,t,n){return $F(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof BV});yU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=EV(e,t=mU(e,t=t.map(function(e){return iU(e,!1)}),u));return new BV(e,t,s,l)}}]),e}();function HV(){return PF()&&Element.prototype.animate||{}}var GV=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Im.None,styles:[],data:{animation:[]}}),i}return Zg(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?CF(e):e;return jV(this._renderer,null,t,"register",[n]),new $V(t,this._renderer)}}]),n}(kF);return e.\u0275fac=function(t){return new(t||e)(gC(hO),gC(xI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),$V=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return Zg(n,[{key:"create",value:function(e,t){return new qV(this._id,e,t||{},this._renderer)}}]),n}(function(){return Zg(function e(){jg(this,e)})}()),qV=function(){function e(t,n,r,i){jg(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return Zg(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return jV(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function jV(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var WV="@.disabled",ZV=function(){var e=function(){function e(t,n,r){jg(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return Zg(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new YV("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new KV(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Og(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(hO),gC(bV),gC(tI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),YV=function(){function e(t,n,r){jg(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return Zg(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==WV?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),KV=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return Zg(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==WV?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=Og(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(YV),QV=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){return jg(this,n),t.call(this,e.body,r,i)}return Zg(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(bV);return e.\u0275fac=function(t){return new(t||e)(gC(xI),gC(WF),gC(GU))},e.\u0275prov=vm({token:e,factory:e.\u0275fac}),e}(),XV=new K_("AnimationModuleType"),JV=[{provide:kF,useClass:GV},{provide:GU,useFactory:function(){return new $U}},{provide:bV,useClass:QV},{provide:hO,useFactory:function(e,t,n){return new ZV(e,t,n)},deps:[hR,bV,tI]}],eB=[{provide:WF,useFactory:function(){return"function"==typeof HV()?new zV:new VV}},{provide:XV,useValue:"BrowserAnimations"}].concat(JV),tB=[{provide:WF,useClass:jF},{provide:XV,useValue:"NoopAnimations"}].concat(JV),nB=function(){var e=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?tB:eB}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:eB,imports:[PR]}),e}(),rB=Ig(9575),iB=Ig.n(rB);function aB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function oB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){aB(a,r,i,o,s,"next",e)}function s(e){aB(a,r,i,o,s,"throw",e)}o(void 0)})}}var sB=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=Gg(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function uB(e,t){e&&console.log(t)}function cB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===cB(n[o],r[o]))return!1}return!0}return e===t}function lB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===lB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function hB(e,t){if(lB(e)&&lB(t))return cB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var fB=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&hB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),dB=function(e,t){if(!e)throw vB(t)},vB=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},pB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},gB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(pB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},yB=function(e){var t=pB(e);return gB.encodeByteArray(t,!0)},mB=function(e){return yB(e).replace(/\./g,"")},kB=function(e){try{return gB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function _B(e){return CB(void 0,e)}function CB(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)!t.hasOwnProperty(n)||!wB(n)||(e[n]=CB(e[n],t[n]));return e}function wB(e){return"__proto__"!==e}var bB=function(){function e(){var t=this;jg(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return Zg(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function EB(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[mB(JSON.stringify({alg:"none",type:"JWT"})),mB(JSON.stringify(a)),""].join(".")}function SB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function PB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(SB())}function OB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function TB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function IB(){var e=SB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function AB(){return"object"==typeof indexedDB}function RB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function xB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var MB=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(Ug(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(Ug(a),NB.prototype.create),a}return Zg(n)}(Ag(Error)),NB=function(){function e(t,n,r){jg(this,e),this.service=t,this.serviceName=n,this.errors=r}return Zg(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(DB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new MB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),DB=/\{\$([^}]+)}/g;function LB(e){return JSON.parse(e)}function FB(e){return JSON.stringify(e)}var UB=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=LB(kB(a[0])||""),n=LB(kB(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function VB(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function BB(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function zB(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function HB(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function GB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if($B(s)&&$B(u)){if(!GB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function $B(e){return null!==e&&"object"==typeof e}function qB(e){for(var t=[],n=function(){var e=Og(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function jB(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Og(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function WB(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var ZB=function(){function e(){jg(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return Zg(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],v=0;v<80;v++){v<40?v<20?(s=f^l&(h^f),u=1518500249):(s=l^h^f,u=1859775393):v<60?(s=l&h|f&(l|h),u=2400959708):(s=l^h^f,u=3395469782);var p=(c<<5|c>>>27)+s+d+u+n[v]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=p}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}(),YB=function(){function e(t,n){var r=this;jg(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return Zg(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=KB),void 0===r.error&&(r.error=KB),void 0===r.complete&&(r.complete=KB);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function KB(){}function QB(e,t){return"".concat(e," failed: ").concat(t," argument ")}var XB=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function JB(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function ez(e){return e&&e._delegate?e._delegate:e}var tz,nz,rz=function(){function e(t,n,r){jg(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return Zg(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),iz="[DEFAULT]",az=function(){function e(t,n){jg(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return Zg(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new bB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:iz})}catch(u){}var t,n=Gg(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Og(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iz;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(zg(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),zg(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iz;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iz;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Gg(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Og(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===iz?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iz;return this.component?this.component.multipleInstances?e:iz:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),oz=function(){function e(t){jg(this,e),this.name=t,this.providers=new Map}return Zg(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new az(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),sz=[],uz=function(){return(e=uz||(uz={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",uz;var e}(),cz={debug:uz.DEBUG,verbose:uz.VERBOSE,info:uz.INFO,warn:uz.WARN,error:uz.ERROR,silent:uz.SILENT},lz=uz.INFO,hz=(Pg(Mg={},uz.DEBUG,"log"),Pg(Mg,uz.VERBOSE,"log"),Pg(Mg,uz.INFO,"info"),Pg(Mg,uz.WARN,"warn"),Pg(Mg,uz.ERROR,"error"),Mg),fz=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=hz[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},dz=function(){function e(t){jg(this,e),this.name=t,this._logLevel=lz,this._logHandler=fz,this._userLogHandler=null,sz.push(this)}return Zg(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in uz))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?cz[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,uz.DEBUG].concat(t)),this._logHandler.apply(this,[this,uz.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,uz.VERBOSE].concat(t)),this._logHandler.apply(this,[this,uz.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,uz.INFO].concat(t)),this._logHandler.apply(this,[this,uz.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,uz.WARN].concat(t)),this._logHandler.apply(this,[this,uz.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,uz.ERROR].concat(t)),this._logHandler.apply(this,[this,uz.ERROR].concat(t))}}]),e}(),vz=new WeakMap,pz=new WeakMap,gz=new WeakMap,yz=new WeakMap,mz=new WeakMap,kz={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return pz.get(e);if("objectStoreNames"===t)return e.objectStoreNames||gz.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _z(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function _z(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(_z(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&vz.set(t,e)}).catch(function(){}),mz.set(t,e),t}(e);if(yz.has(e))return yz.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(nz||(nz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Cz(this),n),_z(vz.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _z(e.apply(Cz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Cz(this),t].concat(r));return gz.set(a,t.sort?t.sort():[t]),_z(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!pz.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});pz.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,tz||(tz=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,kz):e)}(e);return t!==e&&(yz.set(e,t),mz.set(t,e)),t}var Cz=function(e){return mz.get(e)};function wz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=_z(s);return i&&s.addEventListener("upgradeneeded",function(e){i(_z(s.result),e.oldVersion,e.newVersion,_z(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function bz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),_z(r).then(function(){})}var Ez,Sz=["get","getKey","getAll","getAllKeys","count"],Pz=["put","add","delete","clear"],Oz=new Map;function Tz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(Oz.get(t))return Oz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Pz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Sz.includes(n))){var a,o=(a=oB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=h.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=h[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return Oz.set(t,o),o}}}kz=Sg(Sg({},Ez=kz),{},{get:function(e,t,n){return Tz(e,t)||Ez.get(e,t,n)},has:function(e,t){return!!Tz(e,t)||Ez.has(e,t)}});var Iz=function(){function e(t){jg(this,e),this.container=t}return Zg(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),Az="@firebase/app",Rz=new dz("@firebase/app"),xz="[DEFAULT]",Mz=(Pg(Dg={},Az,"fire-core"),Pg(Dg,"@firebase/app-compat","fire-core-compat"),Pg(Dg,"@firebase/analytics","fire-analytics"),Pg(Dg,"@firebase/analytics-compat","fire-analytics-compat"),Pg(Dg,"@firebase/app-check","fire-app-check"),Pg(Dg,"@firebase/app-check-compat","fire-app-check-compat"),Pg(Dg,"@firebase/auth","fire-auth"),Pg(Dg,"@firebase/auth-compat","fire-auth-compat"),Pg(Dg,"@firebase/database","fire-rtdb"),Pg(Dg,"@firebase/database-compat","fire-rtdb-compat"),Pg(Dg,"@firebase/functions","fire-fn"),Pg(Dg,"@firebase/functions-compat","fire-fn-compat"),Pg(Dg,"@firebase/installations","fire-iid"),Pg(Dg,"@firebase/installations-compat","fire-iid-compat"),Pg(Dg,"@firebase/messaging","fire-fcm"),Pg(Dg,"@firebase/messaging-compat","fire-fcm-compat"),Pg(Dg,"@firebase/performance","fire-perf"),Pg(Dg,"@firebase/performance-compat","fire-perf-compat"),Pg(Dg,"@firebase/remote-config","fire-rc"),Pg(Dg,"@firebase/remote-config-compat","fire-rc-compat"),Pg(Dg,"@firebase/storage","fire-gcs"),Pg(Dg,"@firebase/storage-compat","fire-gcs-compat"),Pg(Dg,"@firebase/firestore","fire-fst"),Pg(Dg,"@firebase/firestore-compat","fire-fst-compat"),Pg(Dg,"fire-js","fire-js"),Pg(Dg,"firebase","fire-js-all"),Dg),Nz=new Map,Dz=new Map;function Lz(e,t){try{e.container.addComponent(t)}catch(n){Rz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Fz(e){var t=e.name;if(Dz.has(t))return Rz.debug("There were multiple attempts to register component ".concat(t,".")),!1;Dz.set(t,e);var n,r=Gg(Nz.values());try{for(r.s();!(n=r.n()).done;){Lz(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function Uz(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Vz=new NB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),Bz=function(){function e(t,n,r){var i=this;jg(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rz("app",function(){return i},"PUBLIC"))}return Zg(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Vz.create("app-deleted",{appName:this._name})}}]),e}(),zz="9.9.0";function Hz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xz,t=Nz.get(e);if(!t)throw Vz.create("no-app",{appName:e});return t}function Gz(){return Array.from(Nz.values())}function $z(e,t,n){var r,i=null!==(r=Mz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Rz.warn(s.join(" "))}Fz(new rz("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var qz="firebase-heartbeat-store",jz=null;function Wz(){return jz||(jz=wz("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(qz)}}).catch(function(e){throw Vz.create("storage-open",{originalErrorMessage:e.message})})),jz}function Zz(){return Zz=oB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wz();case 3:return e.abrupt("return",e.sent.transaction(qz).objectStore(qz).get(Qz(t)));case 6:throw e.prev=6,e.t0=e.catch(0),Vz.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),Zz.apply(this,arguments)}function Yz(e,t){return Kz.apply(this,arguments)}function Kz(){return Kz=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wz();case 3:return i=e.sent.transaction(qz,"readwrite"),e.next=6,i.objectStore(qz).put(n,Qz(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),Vz.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),Kz.apply(this,arguments)}function Qz(e){return"".concat(e.name,"!").concat(e.options.appId)}var Xz=function(){function e(t){var n=this;jg(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new eH(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return Zg(e,[{key:"triggerHeartbeat",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Jz(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=Jz(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=Gg(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),tH(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),tH(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=mB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function Jz(){return(new Date).toISOString().substring(0,10)}var eH=function(){function e(t){jg(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return Zg(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!AB()&&RB().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return Zz.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",Yz(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",Yz(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(zg(i.heartbeats),zg(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function tH(e){return mB(JSON.stringify({version:2,heartbeats:e})).length}Fz(new rz("platform-logger",function(e){return new Iz(e)},"PRIVATE")),Fz(new rz("heartbeat",function(e){return new Xz(e)},"PRIVATE")),$z(Az,"0.7.28",""),$z(Az,"0.7.28","esm2017"),$z("fire-js",""),$z("firebase","9.9.0","app");var nH="@firebase/installations",rH="0.5.12",iH="w:".concat(rH),aH="FIS_v2",oH=new NB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function sH(e){return e instanceof MB&&e.code.includes("request-failed")}function uH(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function cH(e){return{token:e.token,requestStatus:2,expiresIn:gH(e.expiresIn),creationTime:Date.now()}}function lH(e,t){return hH.apply(this,arguments)}function hH(){return hH=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",oH.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),hH.apply(this,arguments)}function fH(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function dH(e,t){var n=t.refreshToken,r=fH(e);return r.append("Authorization",function(e){return"".concat(aH," ").concat(e)}(n)),r}function vH(e){return pH.apply(this,arguments)}function pH(){return pH=oB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),pH.apply(this,arguments)}function gH(e){return Number(e.replace("s","000"))}function yH(e,t){return mH.apply(this,arguments)}function mH(){return mH=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=uH(r),s=fH(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:aH,appId:r.appId,sdkVersion:iH})},e.next=11,vH(function(){return fetch(o,l)});case 11:if(!(h=e.sent).ok){e.next=17;break}return e.next=15,h.json();case 15:return f=e.sent,e.abrupt("return",{fid:f.fid||a,registrationStatus:2,refreshToken:f.refreshToken,authToken:cH(f.authToken)});case 17:return e.next=19,lH("Create Installation",h);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),mH.apply(this,arguments)}function kH(e){return new Promise(function(t){setTimeout(t,e)})}var _H=/^[cdef][\w-]{21}$/;function CH(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,zg(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return _H.test(t)?t:""}catch(n){return""}}function wH(e){return"".concat(e.appName,"!").concat(e.appId)}var bH=new Map;function EH(e,t){var n=wH(e);SH(n,t),function(e,t){var n=(!PH&&"BroadcastChannel"in self&&((PH=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){SH(e.data.key,e.data.fid)}),PH);n&&n.postMessage({key:e,fid:t}),0===bH.size&&PH&&(PH.close(),PH=null)}(n,t)}function SH(e,t){var n=bH.get(e);if(n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var PH=null,OH="firebase-installations-store",TH=null;function IH(){return TH||(TH=wz("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(OH)}})),TH}function AH(e,t){return RH.apply(this,arguments)}function RH(){return RH=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=wH(t),e.next=3,IH();case 3:return i=e.sent.transaction(OH,"readwrite"),a=i.objectStore(OH),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&EH(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),RH.apply(this,arguments)}function xH(e){return MH.apply(this,arguments)}function MH(){return MH=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=wH(t),e.next=3,IH();case 3:return r=e.sent.transaction(OH,"readwrite"),e.next=6,r.objectStore(OH).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),MH.apply(this,arguments)}function NH(e,t){return DH.apply(this,arguments)}function DH(){return DH=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=wH(t),e.next=3,IH();case 3:return i=e.sent.transaction(OH,"readwrite"),a=i.objectStore(OH),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&EH(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),DH.apply(this,arguments)}function LH(e){return FH.apply(this,arguments)}function FH(){return FH=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,NH(t.appConfig,function(e){var r=UH(e),i=VH(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),FH.apply(this,arguments)}function UH(e){return $H(e||{fid:CH(),registrationStatus:0})}function VH(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(oH.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return BH.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:zH(e)}:{installationEntry:t}}function BH(){return BH=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yH(t,n);case 3:return r=e.sent,e.abrupt("return",AH(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!sH(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,xH(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,AH(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),BH.apply(this,arguments)}function zH(e){return HH.apply(this,arguments)}function HH(){return HH=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GH(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,kH(100);case 6:return e.next=8,GH(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,LH(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),HH.apply(this,arguments)}function GH(e){return NH(e,function(e){if(!e)throw oH.create("installation-not-found");return $H(e)})}function $H(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function qH(e,t){return jH.apply(this,arguments)}function jH(){return jH=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=WH(r,n),o=dH(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:iH,appId:r.appId}})},e.next=10,vH(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=cH,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,lH("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),jH.apply(this,arguments)}function WH(e,t){var n=t.fid;return"".concat(uH(e),"/").concat(n,"/authTokens:generate")}function ZH(e){return YH.apply(this,arguments)}function YH(){return YH=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,NH(t.appConfig,function(e){if(!tG(e))throw oH.create("not-registered");var i=e.authToken;if(!n&&nG(i))return e;if(1===i.requestStatus)return r=KH(t,n),e;if(!navigator.onLine)throw oH.create("app-offline");var a=rG(e);return r=JH(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),YH.apply(this,arguments)}function KH(e,t){return QH.apply(this,arguments)}function QH(){return QH=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,XH(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,kH(100);case 6:return e.next=8,XH(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?ZH(t,n):i);case 13:case"end":return e.stop()}},e)})),QH.apply(this,arguments)}function XH(e){return NH(e,function(e){if(!tG(e))throw oH.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function JH(e,t){return eG.apply(this,arguments)}function eG(){return eG=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,qH(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,AH(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),sH(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,AH(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,xH(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),eG.apply(this,arguments)}function tG(e){return void 0!==e&&2===e.registrationStatus}function nG(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function rG(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function iG(){return iG=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,LH(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):ZH(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),iG.apply(this,arguments)}function aG(){return aG=oB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,oG(r);case 4:return e.next=6,ZH(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),aG.apply(this,arguments)}function oG(e){return sG.apply(this,arguments)}function sG(){return sG=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LH(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),sG.apply(this,arguments)}function uG(e){return oH.create("missing-app-config-values",{valueName:e})}var cG="installations";Fz(new rz(cG,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw uG("App Configuration");if(!e.name)throw uG("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw uG(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Uz(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),Fz(new rz("installations-internal",function(e){var t=Uz(e.getProvider("app").getImmediate(),cG).getImmediate();return{getId:function(){return function(e){return iG.apply(this,arguments)}(t)},getToken:function(e){return function(e){return aG.apply(this,arguments)}(t,e)}}},"PRIVATE")),$z(nH,rH),$z(nH,rH,"esm2017");var lG="@firebase/remote-config",hG=new NB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),fG=function(){function e(t,n,r,i){jg(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return Zg(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Og(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function dG(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var vG=function(){function e(t,n,r,i,a,o){jg(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return Zg(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k,_,C,w;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=Og(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),h={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},f={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:dG()},d={method:"POST",headers:h,body:JSON.stringify(f)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),hG.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:w=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),hG.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:_=w.entries,C=w.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===C?m=500:"NO_CHANGE"===C?m=304:("NO_TEMPLATE"===C||"EMPTY_CONFIG"===C)&&(_={}),304===m||200===m){n.next=39;break}throw hG.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:_});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),pG=function(){function e(t,n){jg(this,e),this.client=t,this.storage=n}return Zg(e,[{key:"fetch",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return oB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(hG.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof MB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+JB(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),gG=function(){function e(t,n,r,i,a){jg(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return Zg(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function yG(e,t){var n,r=e.target.error||void 0;return hG.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var mG="app_namespace_store",kG=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(yG(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(mG,{keyPath:"compositeKey"})}}catch(r){t(hG.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});jg(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return Zg(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([mG],"readonly").objectStore(mG),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(yG(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i(hG.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([mG],"readwrite").objectStore(mG),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(yG(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a(hG.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([mG],"readwrite").objectStore(mG),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(yG(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i(hG.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),_G=function(){function e(t){jg(this,e),this.storage=t}return Zg(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function CG(){return(CG=oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(AB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,RB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}Fz(new rz("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw hG.create("registration-window");if(!AB())throw hG.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw hG.create("registration-project-id");if(!s)throw hG.create("registration-api-key");if(!u)throw hG.create("registration-app-id");var c=new kG(u,r.name,n=n||"firebase"),l=new _G(c),h=new dz(lG);h.logLevel=uz.ERROR;var f=new vG(i,zz,n,o,s,u),d=new pG(f,c),v=new fG(d,c,l,h),p=new gG(r,v,l,c,h);return function(e){var t=ez(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),$z(lG,"0.3.11"),$z(lG,"0.3.11","esm2017");var wG="/firebase-messaging-sw.js",bG="/firebase-cloud-messaging-push-scope",EG="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",SG="google.c.a.c_id",PG="google.c.a.c_l",OG="google.c.a.ts",TG="google.c.a.e",IG=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(IG||(IG={})),IG);function AG(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,zg(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function RG(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var xG="fcm_token_details_db",MG="fcm_token_object_Store";function NG(e){return DG.apply(this,arguments)}function DG(){return DG=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(xG);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,wz(xG,5,{upgrade:(r=oB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(MG)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(MG),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:AG(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:AG(h.auth),p256dh:AG(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:AG(h.vapidKey)}}:4===i&&(n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:AG(f.auth),p256dh:AG(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:AG(f.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,bz(xG);case 13:return e.next=15,bz("fcm_vapid_details_db");case 15:return e.next=17,bz("undefined");case 17:return e.abrupt("return",LG(n)?n:null);case 18:case"end":return e.stop()}},e)})),DG.apply(this,arguments)}function LG(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var FG="firebase-messaging-store",UG=null;function VG(){return UG||(UG=wz("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(FG)}})),UG}function BG(e){return zG.apply(this,arguments)}function zG(){return zG=oB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=jG(t),e.next=3,VG();case 3:return e.next=5,e.sent.transaction(FG).objectStore(FG).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,NG(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,HG(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),zG.apply(this,arguments)}function HG(e,t){return GG.apply(this,arguments)}function GG(){return GG=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=jG(t),e.next=3,VG();case 3:return i=e.sent.transaction(FG,"readwrite"),e.next=6,i.objectStore(FG).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),GG.apply(this,arguments)}function $G(e){return qG.apply(this,arguments)}function qG(){return qG=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=jG(t),e.next=3,VG();case 3:return r=e.sent.transaction(FG,"readwrite"),e.next=6,r.objectStore(FG).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),qG.apply(this,arguments)}function jG(e){return e.appConfig.appId}var WG=new NB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function ZG(e,t){return YG.apply(this,arguments)}function YG(){return YG=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t$(t);case 2:return i=e.sent,a=r$(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(e$(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),WG.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw WG.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw WG.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),YG.apply(this,arguments)}function KG(e,t){return QG.apply(this,arguments)}function QG(){return QG=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t$(t);case 2:return i=e.sent,a=r$(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(e$(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),WG.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw WG.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw WG.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),QG.apply(this,arguments)}function XG(e,t){return JG.apply(this,arguments)}function JG(){return JG=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t$(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(e$(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw WG.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),WG.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),JG.apply(this,arguments)}function e$(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function t$(e){return n$.apply(this,arguments)}function n$(){return n$=oB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),n$.apply(this,arguments)}function r$(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==EG&&(a.web.applicationPubKey=i),a}function i$(e){return a$.apply(this,arguments)}function a$(){return a$=oB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f$(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:AG(n.getKey("auth")),p256dh:AG(n.getKey("p256dh"))},e.next=6,BG(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!v$(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?u$(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,XG(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",l$(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),a$.apply(this,arguments)}function o$(e){return s$.apply(this,arguments)}function s$(){return s$=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,BG(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,XG(t.firebaseDependencies,n.token);case 7:return e.next=9,$G(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),s$.apply(this,arguments)}function u$(e,t){return c$.apply(this,arguments)}function c$(){return c$=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,KG(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,HG(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,o$(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),c$.apply(this,arguments)}function l$(e,t){return h$.apply(this,arguments)}function h$(){return h$=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ZG(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,HG(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),h$.apply(this,arguments)}function f$(e,t){return d$.apply(this,arguments)}function d$(){return d$=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:RG(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),d$.apply(this,arguments)}function v$(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function p$(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function g$(e){return"object"==typeof e&&!!e&&SG in e}function y$(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function m$(e){return WG.create("missing-app-config-values",{valueName:e})}y$("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),y$("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var k$=function(){function e(t,n,r){jg(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw m$("App Configuration Object");if(!e.name)throw m$("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw m$(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return Zg(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function _$(e){return C$.apply(this,arguments)}function C$(){return C$=oB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(wG,{scope:bG});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),WG.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),C$.apply(this,arguments)}function w$(e,t){return b$.apply(this,arguments)}function b$(){return b$=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,_$(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw WG.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),b$.apply(this,arguments)}function E$(e,t){return S$.apply(this,arguments)}function S$(){return S$=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=EG);case 1:case"end":return e.stop()}},e)})),S$.apply(this,arguments)}function P$(){return P$=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw WG.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw WG.create("permission-blocked");case 8:return e.next=10,E$(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,w$(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",i$(t));case 13:case"end":return e.stop()}},e)})),P$.apply(this,arguments)}function O$(e,t,n){return T$.apply(this,arguments)}function T$(){return T$=oB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=I$(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[SG],message_name:r[PG],message_time:r[OG],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),T$.apply(this,arguments)}function I$(e){switch(e){case IG.NOTIFICATION_CLICKED:return"notification_open";case IG.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function A$(){return A$=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===IG.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(p$(r)):t.onMessageHandler.next(p$(r))),i=r.data,e.t0=g$(i)&&"1"===i[TG],!e.t0){e.next=9;break}return e.next=9,O$(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),A$.apply(this,arguments)}var R$="@firebase/messaging";function x$(){return(x$=oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,RB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&AB()&&xB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}Fz(new rz("messaging",function(e){var t=new k$(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return A$.apply(this,arguments)}(t,e)}),t},"PUBLIC")),Fz(new rz("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return P$.apply(this,arguments)}(t,e)}}},"PRIVATE")),$z(R$,"0.9.16"),$z(R$,"0.9.16","esm2017");var M$="analytics",N$="firebase_id",D$="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",L$="https://www.googletagmanager.com/gtag/js",F$=new dz("@firebase/analytics");function U$(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function V$(e,t){var n=document.createElement("script");n.src="".concat(L$,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function B$(e,t,n,r,i,a){return z$.apply(this,arguments)}function z$(){return z$=oB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,U$(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),F$.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),z$.apply(this,arguments)}function H$(e,t,n,r,i){return G$.apply(this,arguments)}function G$(){return G$=oB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,U$(r);case 7:u=e.sent,c=Gg(s),e.prev=9,h=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==h()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),F$.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),G$.apply(this,arguments)}function $$(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(L$))return r}return null}var q$=new NB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),j$=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;jg(this,e),this.throttleMetadata=t,this.intervalMillis=n}return Zg(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function W$(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function Z$(e){return Y$.apply(this,arguments)}function Y$(){return Y$=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:W$(i)},o=D$.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw q$.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),Y$.apply(this,arguments)}function K$(e){return Q$.apply(this,arguments)}function Q$(){return Q$=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:j$,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw q$.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw q$.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new iq,e.abrupt("return",(setTimeout(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),X$({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),Q$.apply(this,arguments)}function X$(e,t,n){return J$.apply(this,arguments)}function J$(){return J$=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:j$,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,eq(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(F$.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,Z$(t);case 16:return h=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),h));case 20:if(e.prev=20,e.t1=e.catch(13),tq(f=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(F$.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==f?void 0:f.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==f?void 0:f.customData)||void 0===u?void 0:u.httpStatus)?JB(a,o.intervalMillis,30):JB(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),F$.debug("Calling attemptFetch again in ".concat(d," millis")),X$(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),J$.apply(this,arguments)}function eq(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(q$.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function tq(e){if(!(e instanceof MB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var nq,rq,iq=function(){function e(){jg(this,e),this.listeners=[]}return Zg(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function aq(){return aq=oB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),aq.apply(this,arguments)}function oq(e){rq=e}function sq(e){nq=e}function uq(){return cq.apply(this,arguments)}function cq(){return cq=oB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(AB()){e.next=2;break}return e.abrupt("return",(F$.warn(q$.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,RB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(F$.warn(q$.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),cq.apply(this,arguments)}function lq(){return lq=oB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=K$(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&F$.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return F$.error(e)}),n.push(c),l=uq().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return h=e.sent,f=Og(h,2),d=f[0],v=f[1],$$()||V$(o,d.measurementId),rq&&(a("consent","default",rq),oq(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[N$]=v),a("config",d.measurementId,p),nq&&(a("set",nq),sq(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),lq.apply(this,arguments)}var hq,fq,dq=function(){function e(t){jg(this,e),this.app=t}return Zg(e,[{key:"_delete",value:function(){return delete vq[this.app.options.appId],Promise.resolve()}}]),e}(),vq={},pq=[],gq={},yq="dataLayer",mq=!1;function kq(){return(kq=oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!OB()&&xB()&&AB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,RB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var _q="@firebase/analytics";Fz(new rz(M$,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(OB()&&e.push("This is a browser extension environment."),xB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=q$.create("invalid-analytics-context",{errorInfo:t});F$.warn(n.message)}}();var r=e.options.appId;if(!r)throw q$.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw q$.create("no-api-key");F$.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=vq[r])throw q$.create("already-exists",{id:r});if(!mq){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(yq);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=oB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,H$(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,B$(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),F$.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(vq,pq,gq,yq,"gtag"),a=i.wrappedGtag,o=i.gtagCore;fq=a,hq=o,mq=!0}return vq[r]=function(e,t,n,r,i,a,o){return lq.apply(this,arguments)}(e,pq,gq,t,hq,yq,n),new dq(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Fz(new rz("analytics-internal",function(e){try{var t=e.getProvider(M$).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=ez(e),function(e,t,n,r,i){return aq.apply(this,arguments)}(fq,vq[e.app.options.appId],t,n,r).catch(function(e){return F$.error(e)})}(t,e,n,r)}}}catch(t){throw q$.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),$z(_q,"0.8.0"),$z(_q,"0.8.0","esm2017");var Cq=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this)}return Zg(n,[{key:"schedule",value:function(e){return this}}]),n}(Wg),wq={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=wq.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=wq.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},bq=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return Zg(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wq.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;wq.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,qg(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,xg(Bg(n.prototype),"unsubscribe",this).call(this)}}}]),n}(Cq),Eq={now:function(){return(Eq.delegate||Date).now()},delegate:void 0},Sq=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;jg(this,e),this.schedulerActionCtor=t,this.now=n}return Zg(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();Sq.now=Eq.now;var Pq=function(e){Ng(n,e);var t=Lg(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sq.now;return jg(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return Zg(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(Sq),Oq=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n)}(Pq))(function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return Zg(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?xg(Bg(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?xg(Bg(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?xg(Bg(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(bq)),Tq=new Pq(bq),Iq=new pO("7.4.1"),Aq="__angularfire_symbol__analyticsIsSupportedValue",Rq="__angularfire_symbol__analyticsIsSupported",xq="__angularfire_symbol__remoteConfigIsSupportedValue",Mq="__angularfire_symbol__remoteConfigIsSupported",Nq="__angularfire_symbol__messagingIsSupportedValue",Dq="__angularfire_symbol__messagingIsSupported";function Lq(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[Rq]||(globalThis[Rq]=function(){return kq.apply(this,arguments)}().then(function(e){return globalThis[Aq]=e}).catch(function(){return globalThis[Aq]=!1})),globalThis[Dq]||(globalThis[Dq]=function(){return x$.apply(this,arguments)}().then(function(e){return globalThis[Nq]=e}).catch(function(){return globalThis[Nq]=!1})),globalThis[Mq]||(globalThis[Mq]=function(){return CG.apply(this,arguments)}().then(function(e){return globalThis[xq]=e}).catch(function(){return globalThis[xq]=!1}));var Fq=function(e,t){var n=t?[t]:Gz(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function Uq(){}var Vq=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Oq;jg(this,e),this.zone=t,this.delegate=n}return Zg(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),Bq=function(){function e(t){jg(this,e),this.zone=t,this.task=null}return Zg(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",Uq,{},Uq,Uq)}),t.pipe(kN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),zq=function(){var e=Zg(function e(t){jg(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new Vq(Zone.current)}),this.insideAngular=t.run(function(){return new Vq(Zone.current,Tq)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(gC(tI))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Hq(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function Gq(e){return Hq().ngZone.runOutsideAngular(function(){return e()})}function $q(e){return Hq().ngZone.run(function(){return e()})}function qq(e){return Hq(),function(e){return function(t){return(t=t.lift(new Bq(e.ngZone))).pipe(Ky(e.outsideAngular),Yy(e.insideAngular))}}(Hq())(e)}var jq=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),$q(function(){return e.apply(n,r)})}},Wq=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=$q(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",Uq,{},Uq,Uq)}))),i[a]=jq(i[a],n));var o=Gq(function(){return e.apply(r,i)});if(!t){if(o instanceof my){var s=Hq();return o.pipe(Ky(s.outsideAngular),Yy(s.insideAngular))}return $q(function(){return o})}return o instanceof my?o.pipe(qq):o instanceof Promise?$q(function(){return new Promise(function(e,t){return o.then(function(t){return $q(function(){return e(t)})},function(e){return $q(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:$q(function(){return o})}},Zq=Zg(function e(t){return jg(this,e),t}),Yq=Zg(function e(){return jg(this,e),Gz()}),Kq=new K_("angularfire2._apps"),Qq={provide:Zq,useFactory:function(e){return e&&1===e.length?e[0]:new Zq(Hz())},deps:[[new EC,Kq]]},Xq={provide:Yq,deps:[[new EC,Kq]]};function Jq(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new Zq(r)}}var ej=function(){var e=Zg(function e(t){jg(this,e),$z("angularfire",Iq.full,"core"),$z("angularfire",Iq.full,"app"),$z("angular",gO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(gC(BT))},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[Qq,Xq]}),e}(),tj=Wq(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:xz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Vz.create("bad-app-name",{appName:String(r)});var i=Nz.get(r);if(i){if(GB(e,i.options)&&GB(n,i.config))return i;throw Vz.create("duplicate-app",{appName:r})}var a,o=new oz(r),s=Gg(Dz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new Bz(e,n,o);return Nz.set(r,c),c},!0),nj=new Map,rj={activated:!1,tokenObservers:[]},ij={initialized:!1,enabled:!1};function aj(e){return nj.get(e)||rj}function oj(e,t){nj.set(e,t)}function sj(){return ij}var uj=function(){function e(t,n,r,i,a){if(jg(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return Zg(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new bB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new bB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),cj=new NB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function lj(e){if(!aj(e).activated)throw cj.create("use-before-activation",{appName:e.name})}function hj(e,t){return fj.apply(this,arguments)}function fj(){return fj=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:h=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),cj.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===h.status){e.next=19;break}throw cj.create("fetch-status-error",{httpStatus:h.status});case 19:return e.prev=19,e.next=22,h.json();case 22:f=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),cj.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=f.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw cj.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(f.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:f.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),fj.apply(this,arguments)}function dj(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var vj="firebase-app-check-store",pj=null;function gj(){return pj||(pj=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t(cj.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(vj,{keyPath:"compositeKey"})}}catch(r){t(cj.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),pj)}function yj(){return yj=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gj();case 2:return r=e.sent.transaction(vj,"readwrite"),i=r.objectStore(vj).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(cj.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),yj.apply(this,arguments)}var mj=new dz("@firebase/app-check");function kj(e,t){return AB()?function(e,t){return function(e,t){return yj.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){mj.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function _j(){return sj().enabled}function Cj(){return wj.apply(this,arguments)}function wj(){return wj=oB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=sj()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),wj.apply(this,arguments)}var bj={error:"UNKNOWN_ERROR"};function Ej(e){return gB.encodeString(JSON.stringify(e),!1)}function Sj(e){return Pj.apply(this,arguments)}function Pj(){return Pj=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]&&h[1],lj(r=t.app),i=aj(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&Aj(s)&&(o=s);case 10:if(n||!o||!Aj(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!_j()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=hj,e.t2=dj,e.t3=r,e.next=21,Cj();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,kj(r,l);case 31:return oj(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?mj.warn(e.t7.message):mj.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},oj(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,kj(r,o);case 48:e.next=51;break;case 50:u=Rj(a);case 51:return c&&Ij(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),Pj.apply(this,arguments)}function Oj(e,t){var n=aj(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),oj(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function Tj(e){var t=e.app,n=aj(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new uj(oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!aj(t).token){n.next=6;break}return n.next=3,Sj(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,Sj(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=aj(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),oj(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Ij(e,t){var n,r=Gg(aj(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function Aj(e){return e.expireTimeMillis-Date.now()>0}function Rj(e){return{token:Ej(bj),error:e}}var xj=function(){function e(t,n){jg(this,e),this.app=t,this.heartbeatServiceProvider=n}return Zg(e,[{key:"_delete",value:function(){var e,t=Gg(aj(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;Oj(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),Mj="app-check-internal";Fz(new rz("app-check",function(e){return function(e,t){return new xj(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(Mj).initialize()})),Fz(new rz(Mj,function(e){return function(e){return{getToken:function(t){return Sj(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=aj(i),o={next:n,error:void 0,type:"INTERNAL"};if(oj(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(zg(a.tokenObservers),[o])})),a.token&&Aj(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),Tj(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return Tj(e)})}(e,0,t)},removeTokenListener:function(t){return Oj(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),$z("@firebase/app-check","0.5.11");var Nj=Zg(function e(){return jg(this,e),Fq("app-check")});"undefined"!=typeof window&&window;var Dj=new NB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Lj=new dz("@firebase/auth");function Fj(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Lj.logLevel<=uz.ERROR&&Lj.error.apply(Lj,["Auth (9.9.0): ".concat(e)].concat(n))}function Uj(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Hj.apply(void 0,[e].concat(n))}function Vj(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Hj.apply(void 0,[e].concat(n))}function Bj(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Pg({},t,n));return new NB("auth","Firebase",r).create(t,{appName:e.name})}function zj(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Uj(e,"argument-error"),Bj(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function Hj(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=zg(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(zg(o)))}return Dj.create.apply(Dj,[e].concat(n))}function Gj(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw Hj.apply(void 0,[t].concat(r))}function $j(e){var t="INTERNAL ASSERTION FAILED: "+e;throw Fj(t),new Error(t)}function qj(e,t){e||$j(t)}var jj=new Map;function Wj(e){qj(e instanceof Function,"Expected a class definition");var t=jj.get(e);return t?(qj(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,jj.set(e,t),t)}function Zj(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Yj(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var Kj=function(){function e(t,n){jg(this,e),this.shortDelay=t,this.longDelay=n,qj(n>t,"Short delay should be less than long delay!"),this.isMobile=PB()||TB()}return Zg(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Yj()||"https:"===Yj()||OB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function Qj(e,t){qj(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var Xj=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void $j("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void $j("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void $j("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Jj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},eW=new Kj(3e4,6e4);function tW(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function nW(e,t,n,r){return rW.apply(this,arguments)}function rW(){return rW=oB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",iW(t,a,oB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=qB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),Xj.fetch()(uW(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),rW.apply(this,arguments)}function iW(e,t,n){return aW.apply(this,arguments)}function aW(){return aW=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},Jj),n),e.prev=2,a=new cW(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw lW(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Og(c,2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=18;break}throw lW(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==h){e.next=20;break}throw lW(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==h){e.next=22;break}throw lW(t,"user-disabled",s);case 22:if(d=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){e.next=25;break}throw Bj(t,d,f);case 25:Uj(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof MB)){e.next=32;break}throw e.t0;case 32:Uj(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),aW.apply(this,arguments)}function oW(e,t,n,r){return sW.apply(this,arguments)}function sW(){return sW=oB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,nW(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&Uj(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),sW.apply(this,arguments)}function uW(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Qj(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var cW=function(){function e(t){var n=this;jg(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(Vj(n.auth,"network-request-failed"))},eW.get())})}return Zg(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function lW(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=Vj(e,t,r);return i.customData._tokenResponse=n,i}function hW(){return hW=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nW(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),hW.apply(this,arguments)}function fW(e,t){return dW.apply(this,arguments)}function dW(){return dW=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nW(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),dW.apply(this,arguments)}function vW(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function pW(){return pW=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=ez(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,Gj((a=yW(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:vW(gW(a.auth_time)),issuedAtTime:vW(gW(a.iat)),expirationTime:vW(gW(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),pW.apply(this,arguments)}function gW(e){return 1e3*Number(e)}function yW(e){var t,n=Og(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return Fj("JWT malformed, contained fewer than 3 sections"),null;try{var o=kB(i);return o?JSON.parse(o):(Fj("Failed to decode base64 JWT payload"),null)}catch(s){return Fj("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function mW(e,t){return kW.apply(this,arguments)}function kW(){return kW=oB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof MB&&_W(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),kW.apply(this,arguments)}function _W(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var CW=function(){function e(t){jg(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return Zg(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),wW=function(){function e(t,n){jg(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return Zg(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=vW(this.lastLoginAt),this.creationTime=vW(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function bW(e){return EW.apply(this,arguments)}function EW(){return EW=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,mW(t,fW(r,{idToken:i}));case 6:Gj(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?OW(o.providerUserInfo):[],u=PW(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new wW(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),EW.apply(this,arguments)}function SW(){return SW=oB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ez(t),e.next=3,bW(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),SW.apply(this,arguments)}function PW(e,t){return[].concat(zg(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),zg(t))}function OW(e){return e.map(function(e){var t=e.providerId,n=Oy(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function TW(){return TW=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,iW(t,{},oB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=qB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=uW(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",Xj.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),TW.apply(this,arguments)}var IW=function(){function e(){jg(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return Zg(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){Gj(e.idToken,"internal-error"),Gj(void 0!==e.idToken,"internal-error"),Gj(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=yW(e);return Gj(t,"internal-error"),Gj(void 0!==t.exp,"internal-error"),Gj(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(Gj(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return TW.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return $j("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(Gj("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(Gj("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(Gj("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function AW(e,t){Gj("string"==typeof e||void 0===e,"internal-error",{appName:t})}var RW=function(){function e(t){jg(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Oy(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new CW(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?zg(a.providerData):[],this.metadata=new wW(a.createdAt||void 0,a.lastLoginAt||void 0)}return Zg(e,[{key:"getIdToken",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,mW(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(Gj(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return pW.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return SW.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(Gj(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){Gj(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,bW(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,mW(e,function(e,t){return hW.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,C=n.isAnonymous,w=n.providerData,b=n.stsTokenManager;Gj(k&&b,t,"internal-error");var E=IW.fromJSON(this.name,b);Gj("string"==typeof k,t,"internal-error"),AW(h,t.name),AW(f,t.name),Gj("boolean"==typeof _,t,"internal-error"),Gj("boolean"==typeof C,t,"internal-error"),AW(d,t.name),AW(v,t.name),AW(p,t.name),AW(g,t.name),AW(y,t.name),AW(m,t.name);var S=new e({uid:k,auth:t,email:f,emailVerified:_,displayName:h,isAnonymous:C,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:y,lastLoginAt:m});return w&&Array.isArray(w)&&(S.providerData=w.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return oB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new IW).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,bW(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),xW=function(){var e=function(){function e(){jg(this,e),this.type="NONE",this.storage={}}return Zg(e,[{key:"_isAvailable",value:function(){return oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function MW(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var NW=function(){function e(t,n,r){jg(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=MW(this.userKey,a.apiKey,o),this.fullPersistenceKey=MW("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return Zg(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?RW._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return oB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,h,f,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(Wj(xW),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||Wj(xW),s=MW(r,t.config.apiKey,t.name),u=null,c=Gg(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return h=l.value,i.prev=13,i.next=16,h._get(s);case 16:if(!(f=i.sent)){i.next=21;break}return d=RW._fromJSON(t,f),h!==o&&(u=d),o=h,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function DW(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(VW(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(LW(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(zW(t))return"Blackberry";if(HW(t))return"Webos";if(FW(t))return"Safari";if((t.includes("chrome/")||UW(t))&&!t.includes("edge/"))return"Chrome";if(BW(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function LW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/firefox\//i.test(e)}function FW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function UW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/crios\//i.test(e)}function VW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/iemobile/i.test(e)}function BW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/android/i.test(e)}function zW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/blackberry/i.test(e)}function HW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/webos/i.test(e)}function GW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function $W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return GW(e)||BW(e)||HW(e)||zW(e)||/windows phone/i.test(e)||VW(e)}function qW(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=DW(SB());break;case"Worker":t="".concat(DW(SB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var jW=function(){function e(t){jg(this,e),this.auth=t,this.queue=[]}return Zg(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=Gg(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=Gg(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(h){}}}catch(f){u.e(f)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),WW=function(){function e(t,n,r){jg(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new YW(this),this.idTokenSubscription=new YW(this),this.beforeStateQueue=new jW(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dj,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return Zg(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=Wj(t)),this._initializationPromise=this.queue(oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,NW.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return Gj(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,bW(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?ez(e):null,n.abrupt("return",(r&&Gj(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&Gj(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(Wj(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new NB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return Gj(r=e&&Wj(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,NW.create(t,[Wj(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Gj(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return Gj(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qW(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function ZW(e){return ez(e)}var YW=function(){function e(t){var n,r=this;jg(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new YB(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return Zg(e,[{key:"next",get:function(){return Gj(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function KW(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function QW(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var XW=function(){function e(t,n){jg(this,e),this.providerId=t,this.signInMethod=n}return Zg(e,[{key:"toJSON",value:function(){return $j("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return $j("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return $j("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return $j("not implemented")}}]),e}();function JW(){return JW=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nW(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),JW.apply(this,arguments)}function eZ(){return eZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oW(t,"POST","/v1/accounts:signInWithPassword",tW(t,n)));case 1:case"end":return e.stop()}},e)})),eZ.apply(this,arguments)}function tZ(e,t){return nZ.apply(this,arguments)}function nZ(){return nZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nW(t,"POST","/v1/accounts:sendOobCode",tW(t,n)));case 1:case"end":return e.stop()}},e)})),nZ.apply(this,arguments)}function rZ(e,t){return iZ.apply(this,arguments)}function iZ(){return iZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",tZ(t,n));case 1:case"end":return e.stop()}},e)})),iZ.apply(this,arguments)}function aZ(e,t){return oZ.apply(this,arguments)}function oZ(){return oZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",tZ(t,n));case 1:case"end":return e.stop()}},e)})),oZ.apply(this,arguments)}function sZ(){return sZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oW(t,"POST","/v1/accounts:signInWithEmailLink",tW(t,n)));case 1:case"end":return e.stop()}},e)})),sZ.apply(this,arguments)}function uZ(){return uZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oW(t,"POST","/v1/accounts:signInWithEmailLink",tW(t,n)));case 1:case"end":return e.stop()}},e)})),uZ.apply(this,arguments)}var cZ=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return jg(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return Zg(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return eZ.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return sZ.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:Uj(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return JW.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return uZ.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:Uj(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(XW);function lZ(e,t){return hZ.apply(this,arguments)}function hZ(){return hZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oW(t,"POST","/v1/accounts:signInWithIdp",tW(t,n)));case 1:case"end":return e.stop()}},e)})),hZ.apply(this,arguments)}var fZ=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return Zg(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return lZ(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,lZ(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,lZ(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=qB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Uj("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Oy(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(XW),dZ=function(){function e(t){var n,r,i,a,o,s;jg(this,e);var u=jB(WB(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);Gj(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return Zg(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=jB(WB(e)).link,n=t?jB(WB(t)).deep_link_id:null,r=jB(WB(e)).deep_link_id;return(r?jB(WB(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),vZ=function(){var e=function(){function e(){jg(this,e),this.providerId=e.PROVIDER_ID}return Zg(e,null,[{key:"credential",value:function(e,t){return cZ._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=dZ.parseLink(t);return Gj(n,"argument-error"),cZ._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),pZ=function(){function e(t){jg(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return Zg(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),gZ=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).scopes=[],e}return Zg(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return zg(this.scopes)}}]),n}(pZ),yZ=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return Zg(n,null,[{key:"credential",value:function(e,t){return fZ._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(gZ);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function mZ(e,t){return kZ.apply(this,arguments)}function kZ(){return kZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oW(t,"POST","/v1/accounts:signUp",tW(t,n)));case 1:case"end":return e.stop()}},e)})),kZ.apply(this,arguments)}var _Z=function(){function e(t){jg(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return Zg(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return oB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,RW._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=CZ(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=CZ(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function CZ(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var wZ=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o,s;return jg(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(Ug(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return Zg(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(MB);function bZ(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?wZ._fromErrorAndOperation(e,n,t,r):n})}function EZ(e,t){return SZ.apply(this,arguments)}function SZ(){return SZ=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=mW,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",_Z._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),SZ.apply(this,arguments)}function PZ(){return PZ=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,mW(t,bZ(a,o,n,t),r);case 5:return Gj((s=e.sent).idToken,a,"internal-error"),Gj(u=yW(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(Gj(t.uid===c,a,"user-mismatch"),_Z._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&Uj(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),PZ.apply(this,arguments)}function OZ(e,t){return TZ.apply(this,arguments)}function TZ(){return TZ=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,bZ(t,i,n);case 4:return a=e.sent,e.next=7,_Z._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),TZ.apply(this,arguments)}function IZ(){return IZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",OZ(ZW(t),n));case 1:case"end":return e.stop()}},e)})),IZ.apply(this,arguments)}function AZ(e,t,n){var r;Gj((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Gj(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Gj(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Gj(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function RZ(){return RZ=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=ez(t),a={requestType:"PASSWORD_RESET",email:n},r&&AZ(i,a,r),e.next=4,aZ(i,a);case 4:case"end":return e.stop()}},e)})),RZ.apply(this,arguments)}function xZ(){return xZ=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=ZW(t),e.next=3,mZ(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,_Z._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),xZ.apply(this,arguments)}function MZ(){return MZ=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ez(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&AZ(r.auth,i,n),e.next=8,rZ(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),MZ.apply(this,arguments)}function NZ(e,t){return DZ.apply(this,arguments)}function DZ(){return DZ=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nW(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),DZ.apply(this,arguments)}function LZ(){return LZ=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=ez(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,mW(a,NZ(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),LZ.apply(this,arguments)}new WeakMap;var FZ="__sak",UZ=function(){function e(t,n){jg(this,e),this.storageRetriever=t,this.type=n}return Zg(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(FZ,"1"),this.storage.removeItem(FZ),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),VZ=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=SB();return FW(e)||GW(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=$W(),e._shouldAllowMigration=!0,e}return Zg(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);IB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return oB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,xg(Bg(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,xg(Bg(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,xg(Bg(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(UZ);return e.type="LOCAL",e}(),BZ=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return Zg(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(UZ);return e.type="SESSION",e}(),zZ=function(){var e=function(){function e(t){jg(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return Zg(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function HZ(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var GZ=function(){function e(t){jg(this,e),this.target=t,this.handlers=new Set}return Zg(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return oB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=HZ("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function $Z(){return window}function qZ(){return void 0!==$Z().WorkerGlobalScope&&"function"==typeof $Z().importScripts}function jZ(){return(jZ=oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var WZ="firebaseLocalStorageDb",ZZ="firebaseLocalStorage",YZ="fbase_key",KZ=function(){function e(t){jg(this,e),this.request=t}return Zg(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function QZ(e,t){return e.transaction([ZZ],t?"readwrite":"readonly").objectStore(ZZ)}function XZ(){var e=indexedDB.open(WZ,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(ZZ,{keyPath:YZ})}catch(r){n(r)}}),e.addEventListener("success",oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(ZZ)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(WZ);return new KZ(e).toPromise()}();case 8:return n.t0=t,n.next=11,XZ();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function JZ(e,t,n){return eY.apply(this,arguments)}function eY(){return eY=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=QZ(t,!0).put((Pg(i={},YZ,n),Pg(i,"value",r),i)),e.abrupt("return",new KZ(a).toPromise());case 2:case"end":return e.stop()}},e)})),eY.apply(this,arguments)}function tY(){return tY=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=QZ(t,!1).get(n),e.next=3,new KZ(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),tY.apply(this,arguments)}function nY(e,t){var n=QZ(e,!0).delete(t);return new KZ(n).toPromise()}var rY=function(){var e=function(){function e(){jg(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return Zg(e,[{key:"_openDb",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,XZ();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",qZ()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=zZ._getInstance(qZ()?self:null),e.receiver._subscribe("keyChanged",function(){var t=oB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return jZ.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new GZ(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return oB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,XZ();case 5:return t=e.sent,e.next=8,JZ(t,FZ,"1");case 8:return e.next=10,nY(t,FZ);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return JZ(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return tY.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return nY(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=QZ(e,!1).getAll();return new KZ(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=Gg(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,h=Object.keys(e.localCache);l<h.length;l++)f=h[l],e.localCache[f]&&!i.has(f)&&(e.notifyListeners(f,null),r.push(f));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function iY(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function aY(e,t){return t?Wj(t):(Gj(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}iY("rcb"),new Kj(3e4,6e4);var oY=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,"custom","custom")).params=e,r}return Zg(n,[{key:"_getIdTokenResponse",value:function(e){return lZ(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return lZ(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return lZ(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(XW);function sY(e){return OZ(e.auth,new oY(e),e.bypassAuthState)}function uY(e){var t=e.auth,n=e.user;return Gj(n,t,"internal-error"),function(e,t){return PZ.apply(this,arguments)}(n,new oY(e),e.bypassAuthState)}function cY(e){return lY.apply(this,arguments)}function lY(){return lY=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(Gj(r,n,"internal-error"),EZ(r,new oY(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),lY.apply(this,arguments)}var hY=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];jg(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return Zg(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=oB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sY;case"linkViaPopup":case"linkViaRedirect":return cY;case"reauthViaPopup":case"reauthViaRedirect":return uY;default:Uj(this.auth,"internal-error")}}},{key:"resolve",value:function(e){qj(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){qj(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),fY=new Kj(2e3,1e4);function dY(){return dY=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=ZW(t),zj(t,n,pZ),a=aY(i,r),e.abrupt("return",new vY(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),dY.apply(this,arguments)}var vY=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=Ug(s),s}return Zg(n,[{key:"executeNotNull",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(Gj(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return qj(1===e.filter.length,"Popup operations only handle one event"),n=HZ(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(Vj(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(Vj(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(Vj(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,fY.get())}()}}]),n}(hY);return e.currentPopupAction=null,e}(),pY=new Map,gY=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return jg(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return Zg(n,[{key:"execute",value:function(){var e=this,t=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=pY.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return yY.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,xg(Bg(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:pY.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||pY.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return xg(Bg(n.prototype),"onAuthEvent",t)},i=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(hY);function yY(){return yY=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_Y(n),i=kY(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),yY.apply(this,arguments)}function mY(e,t){pY.set(e._key(),t)}function kY(e){return Wj(e._redirectPersistence)}function _Y(e){return MW("pendingRedirect",e.config.apiKey,e.name)}function CY(e,t){return wY.apply(this,arguments)}function wY(){return wY=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=ZW(t),a=aY(i,n),e.next=5,new gY(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),wY.apply(this,arguments)}var bY=function(){function e(t){jg(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return Zg(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return SY(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!SY(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Vj(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(EY(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(EY(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function EY(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function SY(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function PY(e){return OY.apply(this,arguments)}function OY(){return OY=oB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",nW(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),OY.apply(this,arguments)}var TY=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IY=/^https?/;function AY(){return AY=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,PY(t);case 4:n=e.sent,r=n.authorizedDomains,i=Gg(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!RY(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:Uj(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),AY.apply(this,arguments)}function RY(e){var t=Zj(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!IY.test(r))return!1;if(TY.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var xY=new Kj(3e4,6e4);function MY(){var e=$Z().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=zg(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var NY=null;function DY(e){return NY=NY||function(e){return new Promise(function(t,n){var r,i,a;function o(){MY(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){MY(),n(Vj(e,"network-request-failed"))},timeout:xY.get()})}if(null===(i=null===(r=$Z().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=$Z().gapi)||void 0===a?void 0:a.load)){var s=iY("iframefcb");return $Z()[s]=function(){gapi.load?o():n(Vj(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=Vj("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw NY=null,e})}(e),NY}var LY=new Kj(5e3,15e3),FY={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},UY=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VY(e){var t=e.config;Gj(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Qj(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:zz},i=UY.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(qB(r).slice(1))}function BY(){return BY=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,DY(t);case 2:return n=e.sent,r=$Z().gapi,e.abrupt("return",(Gj(r,t,"internal-error"),n.open({where:document.body,url:VY(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FY,dontclear:!0},function(e){return new Promise((n=oB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){$Z().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=Vj(t,"network-request-failed"),o=$Z().setTimeout(function(){i(a)},LY.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),BY.apply(this,arguments)}var zY={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},HY=function(){function e(t){jg(this,e),this.window=t,this.associatedEvent=null}return Zg(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function GY(e,t,n,r,i,a){Gj(e.config.authDomain,e,"auth-domain-config-required"),Gj(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:zz,eventId:i};if(t instanceof pZ){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",zB(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Og(u[s],2),l=c[0],h=c[1];o[l]=h}}if(t instanceof gZ){var f=t.getScopes().filter(function(e){return""!==e});f.length>0&&(o.scopes=f.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?Qj(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(qB(d).slice(1))}var $Y="webStorageSupport",qY=function(){function e(){jg(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BZ,this._completeRedirectFn=CY,this._overrideRedirectResult=mY}return Zg(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return qj(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=GY(e,t,n,Zj(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},zY),{width:r.toString(),height:i.toString(),top:a,left:o}),c=SB().toLowerCase();n&&(s=UW(c)?"_blank":n),LW(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Og(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SB();return GW(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new HY(null);var h=window.open(t||"",s,l);Gj(h,e,"popup-blocked");try{h.focus()}catch(f){}return new HY(h)}(e,s,HZ()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){$Z().location.href=e}(GY(e,t,n,Zj(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(qj(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return BY.apply(this,arguments)}(e);case 2:return r=n.sent,i=new bY(e),n.abrupt("return",(r.register("authEvent",function(t){return Gj(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send($Y,{type:$Y},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[$Y];void 0!==i&&t(!!i),Uj(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return AY.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return $W()||FW()||GW()}}]),e}(),jY="@firebase/auth",WY=function(){function e(t){jg(this,e),this.auth=t,this.internalListeners=new Map}return Zg(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){Gj(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){Fz(new rz("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){Gj(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),Gj(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qW(e)},a=new WW(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wj);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),Fz(new rz("auth-internal",function(e){var t=ZW(e.getProvider("auth").getImmediate());return new WY(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),$z(jY,"0.20.5",void 0),$z(jY,"0.20.5","esm2017")}("Browser");var ZY=Zg(function e(t){return jg(this,e),t}),YY=Zg(function e(){return jg(this,e),Fq("auth")}),KY=new K_("angularfire2.auth-instances");function QY(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new ZY(r)}}var XY,JY={provide:YY,deps:[[new EC,KY]]},eK={provide:ZY,useFactory:function(e,t){var n=Lq("auth",e,t);return n&&new ZY(n)},deps:[[new EC,KY],Zq]},tK=function(){var e=Zg(function e(){jg(this,e),$z("angularfire",Iq.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[eK,JY]}),e}(),nK=Wq(function(e,t,n){var r=ZW(e);Gj(r._canInitEmulator,r,"emulator-config-failed"),Gj(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null==n?void 0:n.disableWarnings),a=KW(t),o=function(e){var t=KW(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:QW(r.substr(a.length+1))}}var o=Og(r.split(":"),2);return{host:o[0],port:QW(o[1])}}(t),s=o.host,u=o.port;r.config.emulator={url:"".concat(a,"//").concat(s).concat(null===u?"":":".concat(u),"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()},!0),rK=Wq(function(e,t,n){return xZ.apply(this,arguments)},!0),iK=Wq(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hz(),t=Uz(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=Uz(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(GB(n.getOptions(),null!=t?t:{}))return r;Uj(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:qY,persistence:[rY,VZ,BZ]})},!0),aK=Wq(function(e,t,n,r){return ez(e).onAuthStateChanged(t,n,r)},!0),oK=Wq(function(e,t){return MZ.apply(this,arguments)},!0),sK=Wq(function(e,t,n){return RZ.apply(this,arguments)},!0),uK=Wq(function(e,t,n){return function(e,t){return IZ.apply(this,arguments)}(ez(e),vZ.credential(t,n))},!0),cK=Wq(function(e,t,n){return dY.apply(this,arguments)},!0),lK=Wq(function(e,t){return LZ.apply(this,arguments)},!0),hK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},fK={},dK=dK||{},vK=hK||self;function pK(){}function gK(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function yK(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var mK="closure_uid_"+(1e9*Math.random()>>>0),kK=0;function _K(e,t,n){return e.call.apply(e.bind,arguments)}function CK(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function wK(e,t,n){return(wK=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_K:CK).apply(null,arguments)}function bK(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function EK(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function SK(){this.s=this.s,this.o=this.o}var PK={};SK.prototype.s=!1,SK.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,mK)&&e[mK]||(e[mK]=++kK)}(this);delete PK[e]}},SK.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var OK=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},TK=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function IK(e){return Array.prototype.concat.apply([],arguments)}function AK(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function RK(e){return/^[\s\xa0]*$/.test(e)}var xK,MK=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function NK(e,t){return-1!=e.indexOf(t)}function DK(e,t){return e<t?-1:e>t?1:0}e:{var LK=vK.navigator;if(LK){var FK=LK.userAgent;if(FK){xK=FK;break e}}xK=""}function UK(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function VK(e){var t={};for(var n in e)t[n]=e[n];return t}var BK="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zK(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<BK.length;a++)n=BK[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function HK(e){return HK[" "](e),e}HK[" "]=pK;var GK,$K=NK(xK,"Opera"),qK=NK(xK,"Trident")||NK(xK,"MSIE"),jK=NK(xK,"Edge"),WK=jK||qK,ZK=NK(xK,"Gecko")&&!(NK(xK.toLowerCase(),"webkit")&&!NK(xK,"Edge"))&&!(NK(xK,"Trident")||NK(xK,"MSIE"))&&!NK(xK,"Edge"),YK=NK(xK.toLowerCase(),"webkit")&&!NK(xK,"Edge");function KK(){var e=vK.document;return e?e.documentMode:void 0}e:{var QK="",XK=function(){var e=xK;return ZK?/rv:([^\);]+)(\)|;)/.exec(e):jK?/Edge\/([\d\.]+)/.exec(e):qK?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):YK?/WebKit\/(\S+)/.exec(e):$K?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(XK&&(QK=XK?XK[1]:""),qK){var JK=KK();if(null!=JK&&JK>parseFloat(QK)){GK=String(JK);break e}}GK=QK}var eQ={};var tQ=vK.document&&qK&&(KK()||parseInt(GK,10))||void 0,nQ=function(){if(!vK.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{vK.addEventListener("test",pK,t),vK.removeEventListener("test",pK,t)}catch(n){}return e}();function rQ(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function iQ(e,t){if(rQ.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(ZK){e:{try{HK(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:aQ[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&iQ.Z.h.call(this)}}rQ.prototype.h=function(){this.defaultPrevented=!0},EK(iQ,rQ);var aQ={2:"touch",3:"pen",4:"mouse"};iQ.prototype.h=function(){iQ.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var oQ="closure_listenable_"+(1e6*Math.random()|0),sQ=0;function uQ(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++sQ,this.ca=this.fa=!1}function cQ(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function lQ(e){this.src=e,this.g={},this.h=0}function hQ(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=OK(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(cQ(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function fQ(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}lQ.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=fQ(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new uQ(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var dQ="closure_lm_"+(1e6*Math.random()|0),vQ={};function pQ(e,t,n,r,i){if(r&&r.once)return yQ(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)pQ(e,t[a],n,r,i);return null}return n=EQ(n),e&&e[oQ]?e.N(t,n,yK(r)?!!r.capture:!!r,i):gQ(e,t,n,!1,r,i)}function gQ(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=yK(i)?!!i.capture:!!i,s=wQ(e);if(s||(e[dQ]=s=new lQ(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=CQ;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)nQ||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(_Q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function yQ(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)yQ(e,t[a],n,r,i);return null}return n=EQ(n),e&&e[oQ]?e.O(t,n,yK(r)?!!r.capture:!!r,i):gQ(e,t,n,!0,r,i)}function mQ(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)mQ(e,t[a],n,r,i);else r=yK(r)?!!r.capture:!!r,n=EQ(n),e&&e[oQ]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=fQ(a=e.g[t],n,r,i))&&(cQ(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=wQ(e))&&(t=e.g[t.toString()],e=-1,t&&(e=fQ(t,n,r,i)),(n=-1<e?t[e]:null)&&kQ(n))}function kQ(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[oQ])hQ(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(_Q(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=wQ(t))?(hQ(n,e),0==n.h&&(n.src=null,t[dQ]=null)):cQ(e)}}}function _Q(e){return e in vQ?vQ[e]:vQ[e]="on"+e}function CQ(e,t){if(e.ca)e=!0;else{t=new iQ(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&kQ(e),e=n.call(r,t)}return e}function wQ(e){return(e=e[dQ])instanceof lQ?e:null}var bQ="__closure_events_fn_"+(1e9*Math.random()>>>0);function EQ(e){return"function"==typeof e?e:(e[bQ]||(e[bQ]=function(t){return e.handleEvent(t)}),e[bQ])}function SQ(){SK.call(this),this.i=new lQ(this),this.P=this,this.I=null}function PQ(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new rQ(t,e);else if(t instanceof rQ)t.target=t.target||e;else{var i=t;zK(t=new rQ(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=OQ(o,r,!0,t)&&i}if(i=OQ(o=t.g=e,r,!0,t)&&i,i=OQ(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=OQ(o=t.g=n[a],r,!1,t)&&i}function OQ(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&hQ(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}EK(SQ,SK),SQ.prototype[oQ]=!0,SQ.prototype.removeEventListener=function(e,t,n,r){mQ(this,e,t,n,r)},SQ.prototype.M=function(){if(SQ.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)cQ(n[r]);delete t.g[e],t.h--}}this.I=null},SQ.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},SQ.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var TQ=vK.JSON.stringify;function IQ(){var e=LQ,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var AQ,RQ=new(function(){function e(t,n){jg(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return Zg(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new xQ},function(e){return e.reset()}),xQ=function(){function e(){jg(this,e),this.next=this.g=this.h=null}return Zg(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function MQ(e){vK.setTimeout(function(){throw e},0)}function NQ(e,t){AQ||function(){var e=vK.Promise.resolve(void 0);AQ=function(){e.then(FQ)}}(),DQ||(AQ(),DQ=!0),LQ.add(e,t)}var DQ=!1,LQ=new(function(){function e(){jg(this,e),this.h=this.g=null}return Zg(e,[{key:"add",value:function(e,t){var n=RQ.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function FQ(){for(var e;e=IQ();){try{e.h.call(e.g)}catch(n){MQ(n)}var t=RQ;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}DQ=!1}function UQ(e,t){SQ.call(this),this.h=e||1,this.g=t||vK,this.j=wK(this.kb,this),this.l=Date.now()}function VQ(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function BQ(e,t,n){if("function"==typeof e)n&&(e=wK(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=wK(e.handleEvent,e)}return 2147483647<Number(t)?-1:vK.setTimeout(e,t||0)}function zQ(e){e.g=BQ(function(){e.g=null,e.i&&(e.i=!1,zQ(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}EK(UQ,SQ),(XY=UQ.prototype).da=!1,XY.S=null,XY.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),PQ(this,"tick"),this.da&&(VQ(this),this.start()))}},XY.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},XY.M=function(){UQ.Z.M.call(this),VQ(this),delete this.g};var HQ=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return Zg(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:zQ(this)}},{key:"M",value:function(){xg(Bg(n.prototype),"M",this).call(this),this.g&&(vK.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(SK);function GQ(e){SK.call(this),this.h=e,this.g={}}EK(GQ,SK);var $Q=[];function qQ(e,t,n,r){Array.isArray(n)||(n&&($Q[0]=n.toString()),n=$Q);for(var i=0;i<n.length;i++){var a=pQ(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function jQ(e){UK(e.g,function(e,t){this.g.hasOwnProperty(t)&&kQ(e)},e),e.g={}}function WQ(){this.g=!0}function ZQ(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return TQ(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}GQ.prototype.M=function(){GQ.Z.M.call(this),jQ(this)},GQ.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},WQ.prototype.Aa=function(){this.g=!1},WQ.prototype.info=function(){};var YQ={},KQ=null;function QQ(){return KQ=KQ||new SQ}function XQ(e){rQ.call(this,YQ.Ma,e)}function JQ(e){var t=QQ();PQ(t,new XQ(t,e))}function eX(e,t){rQ.call(this,YQ.STAT_EVENT,e),this.stat=t}function tX(e){var t=QQ();PQ(t,new eX(t,e))}function nX(e,t){rQ.call(this,YQ.Na,e),this.size=t}function rX(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return vK.setTimeout(function(){e()},t)}YQ.Ma="serverreachability",EK(XQ,rQ),YQ.STAT_EVENT="statevent",EK(eX,rQ),YQ.Na="timingevent",EK(nX,rQ);var iX={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},aX={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function oX(){}function sX(){}oX.prototype.h=null;var uX,cX={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function lX(){rQ.call(this,"d")}function hX(){rQ.call(this,"c")}function fX(){}function dX(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new GQ(this),this.P=pX,this.W=new UQ(e=WK?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new vX}function vX(){this.i=null,this.g="",this.h=!1}EK(lX,rQ),EK(hX,rQ),EK(fX,oX),fX.prototype.g=function(){return new XMLHttpRequest},fX.prototype.i=function(){return{}},uX=new fX;var pX=45e3,gX={},yX={};function mX(e,t,n){e.K=1,e.v=zX(DX(t)),e.s=n,e.U=!0,kX(e,null)}function kX(e,t){e.F=Date.now(),bX(e),e.A=DX(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),eJ(n.h,"t",r),e.C=0,n=e.l.H,e.h=new vX,e.g=e1(e.l,n?t:null,!e.s),0<e.O&&(e.L=new HQ(wK(e.Ia,e,e.g),e.O)),qQ(e.V,e.g,"readystatechange",e.gb),t=e.H?VK(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),JQ(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function _X(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function CX(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=wX(e,n))==yX){4==t&&(e.o=4,tX(14),i=!1),ZQ(e.j,e.m,null,"[Incomplete Response]");break}if(r==gX){e.o=4,tX(15),ZQ(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}ZQ(e.j,e.m,r,null),TX(e,r)}_X(e)&&r!=yX&&r!=gX&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,tX(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),jJ(t),t.L=!0,tX(11))):(ZQ(e.j,e.m,n,"[Invalid Chunked Response]"),OX(e),PX(e))}function wX(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?yX:(n=Number(t.substring(n,r)),isNaN(n)?gX:(r+=1)+n>t.length?yX:(t=t.substr(r,n),e.C=r+n,t))}function bX(e){e.Y=Date.now()+e.P,EX(e,e.P)}function EX(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=rX(wK(e.eb,e),t)}function SX(e){e.B&&(vK.clearTimeout(e.B),e.B=null)}function PX(e){0==e.l.G||e.I||YJ(e.l,e)}function OX(e){SX(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,VQ(e.W),jQ(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function TX(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||oJ(n.i,e)))if(n.I=e.N,!e.J&&oJ(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=rX(wK(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;ZJ(n),FJ(n)}qJ(n),tX(18)}if(1>=aJ(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else QJ(n,11)}else if((e.J||n.g==e)&&ZJ(n),!RK(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(NK(l,"spdy")||NK(l,"quic")||NK(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(sJ(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,BX(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=JJ(r,r.H?r.la:null,r.W),d.J){uJ(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(SX(v),bX(v)),r.g=d}else $J(r);0<n.l.length&&BJ(n)}else"stop"!=a[0]&&"close"!=a[0]||QJ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?QJ(n,7):LJ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}JQ(4)}catch(m){}}function IX(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(gK(e)||"string"==typeof e)TK(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(gK(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(gK(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function AX(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof AX)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function RX(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];xX(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)xX(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function xX(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(XY=dX.prototype).setTimeout=function(e){this.P=e},XY.gb=function(e){e=e.target;var t=this.L;t&&3==RJ(e)?t.l():this.Ia(e)},XY.Ia=function(e){try{if(e==this.g)e:{var t=RJ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||WK||this.g&&(this.h.h||this.g.ga()||xJ(this.g)))){this.I||4!=t||7==n||JQ(8==n||0>=r?3:2),SX(this);var i=this.g.ba();this.N=i;t:if(_X(this)){var a=xJ(this.g);e="";var o=a.length,s=4==RJ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){OX(this),PX(this);var u="";break t}this.h.i=new vK.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!RK(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,tX(12),OX(this),PX(this);break e}ZQ(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,TX(this,i)}this.U?(CX(this,t,u),WK&&this.i&&3==t&&(qQ(this.V,this.W,"tick",this.fb),this.W.start())):(ZQ(this.j,this.m,u,null),TX(this,u)),4==t&&OX(this),this.i&&!this.I&&(4==t?YJ(this.l,this):(this.i=!1,bX(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,tX(12)):(this.o=0,tX(13)),OX(this),PX(this)}}}catch(f){}},XY.fb=function(){if(this.g){var e=RJ(this.g),t=this.g.ga();this.C<t.length&&(SX(this),CX(this,e,t),this.i&&4!=e&&bX(this))}},XY.cancel=function(){this.I=!0,OX(this)},XY.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(JQ(3),tX(17)),OX(this),this.o=2,PX(this)):EX(this,this.Y-e)},(XY=AX.prototype).R=function(){RX(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},XY.T=function(){return RX(this),this.g.concat()},XY.get=function(e,t){return xX(this.h,e)?this.h[e]:t},XY.set=function(e,t){xX(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},XY.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var MX=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function NX(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof NX){this.g=void 0!==t?t:e.g,LX(this,e.j),this.s=e.s,FX(this,e.i),UX(this,e.m),this.l=e.l,t=e.h;var n=new KX;n.i=t.i,t.g&&(n.g=new AX(t.g),n.h=t.h),VX(this,n),this.o=e.o}else e&&(n=String(e).match(MX))?(this.g=!!t,LX(this,n[1]||"",!0),this.s=HX(n[2]||""),FX(this,n[3]||"",!0),UX(this,n[4]),this.l=HX(n[5]||"",!0),VX(this,n[6]||"",!0),this.o=HX(n[7]||"")):(this.g=!!t,this.h=new KX(null,this.g))}function DX(e){return new NX(e)}function LX(e,t,n){e.j=n?HX(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function FX(e,t,n){e.i=n?HX(t,!0):t}function UX(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function VX(e,t,n){t instanceof KX?(e.h=t,function(e,t){t&&!e.j&&(QX(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(XX(this,t),eJ(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=GX(t,ZX)),e.h=new KX(t,e.g))}function BX(e,t,n){e.h.set(t,n)}function zX(e){return BX(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function HX(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function GX(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,$X),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function $X(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}NX.prototype.toString=function(){var e=[],t=this.j;t&&e.push(GX(t,qX,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(GX(t,qX,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(GX(n,"/"==n.charAt(0)?WX:jX,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",GX(n,YX)),e.join("")};var qX=/[#\/\?@]/g,jX=/[#\?:]/g,WX=/[#\?]/g,ZX=/[#\?@]/g,YX=/#/g;function KX(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function QX(e){e.g||(e.g=new AX,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function XX(e,t){QX(e),t=tJ(e,t),xX(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,xX((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&RX(e)))}function JX(e,t){return QX(e),t=tJ(e,t),xX(e.g.h,t)}function eJ(e,t,n){XX(e,t),0<n.length&&(e.i=null,e.g.set(tJ(e,t),AK(n)),e.h+=n.length)}function tJ(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function nJ(e){this.l=e||rJ,e=vK.PerformanceNavigationTiming?0<(e=vK.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(vK.g&&vK.g.Ea&&vK.g.Ea()&&vK.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(XY=KX.prototype).add=function(e,t){QX(this),this.i=null,e=tJ(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},XY.forEach=function(e,t){QX(this),this.g.forEach(function(n,r){TK(n,function(n){e.call(t,n,r,this)},this)},this)},XY.T=function(){QX(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},XY.R=function(e){QX(this);var t=[];if("string"==typeof e)JX(this,e)&&(t=IK(t,this.g.get(tJ(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=IK(t,e[n])}return t},XY.set=function(e,t){return QX(this),this.i=null,JX(this,e=tJ(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},XY.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},XY.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var rJ=10;function iJ(e){return!!e.h||!!e.g&&e.g.size>=e.j}function aJ(e){return e.h?1:e.g?e.g.size:0}function oJ(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function sJ(e,t){e.g?e.g.add(t):e.h=t}function uJ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function cJ(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Gg(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return AK(e.i)}function lJ(){}function hJ(){this.g=new lJ}function fJ(e,t,n){var r=n||"";try{IX(e,function(e,n){var i=e;yK(e)&&(i=TQ(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function dJ(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function vJ(e){this.l=e.$b||null,this.j=e.ib||!1}function pJ(e,t){SQ.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=gJ,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nJ.prototype.cancel=function(){if(this.i=cJ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Gg(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},lJ.prototype.stringify=function(e){return vK.JSON.stringify(e,void 0)},lJ.prototype.parse=function(e){return vK.JSON.parse(e,void 0)},EK(vJ,oX),vJ.prototype.g=function(){return new pJ(this.l,this.j)},vJ.prototype.i=function(e){return function(){return e}}({}),EK(pJ,SQ);var gJ=0;function yJ(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function mJ(e){e.readyState=4,e.l=null,e.j=null,e.A=null,kJ(e)}function kJ(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(XY=pJ.prototype).open=function(e,t){if(this.readyState!=gJ)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,kJ(this)},XY.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||vK).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},XY.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,mJ(this)),this.readyState=gJ},XY.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,kJ(this)),this.g&&(this.readyState=3,kJ(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==vK.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;yJ(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},XY.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?mJ(this):kJ(this),3==this.readyState&&yJ(this)}},XY.Ua=function(e){this.g&&(this.response=this.responseText=e,mJ(this))},XY.Ta=function(e){this.g&&(this.response=e,mJ(this))},XY.ha=function(){this.g&&mJ(this)},XY.setRequestHeader=function(e,t){this.v.append(e,t)},XY.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},XY.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(pJ.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var _J=vK.JSON.parse;function CJ(e){SQ.call(this),this.headers=new AX,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=wJ,this.K=this.L=!1}EK(CJ,SQ);var wJ="",bJ=/^https?$/i,EJ=["POST","PUT"];function SJ(e){return"content-type"==e.toLowerCase()}function PJ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,OJ(e),IJ(e)}function OJ(e){e.D||(e.D=!0,PQ(e,"complete"),PQ(e,"error"))}function TJ(e){if(e.h&&void 0!==dK&&(!e.C[1]||4!=RJ(e)||2!=e.ba()))if(e.v&&4==RJ(e))BQ(e.Fa,0,e);else if(PQ(e,"readystatechange"),4==RJ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(MX)[1]||null;if(!a&&vK.self&&vK.self.location){var o=vK.self.location.protocol;a=o.substr(0,o.length-1)}i=!bJ.test(a?a.toLowerCase():"")}t=i}if(t)PQ(e,"complete"),PQ(e,"success");else{e.m=6;try{var s=2<RJ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",OJ(e)}}finally{IJ(e)}}}function IJ(e,t){if(e.g){AJ(e);var n=e.g,r=e.C[0]?pK:null;e.g=null,e.C=null,t||PQ(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function AJ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(vK.clearTimeout(e.A),e.A=null)}function RJ(e){return e.g?e.g.readyState:0}function xJ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case wJ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function MJ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return UK(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):BX(e,t,n))}function NJ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function DJ(e){this.za=0,this.l=[],this.h=new WQ,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=NJ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=NJ("baseRetryDelayMs",5e3,e),this.$a=NJ("retryDelaySeedMs",1e4,e),this.Ya=NJ("forwardChannelMaxRetries",2,e),this.ra=NJ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new nJ(e&&e.concurrentRequestLimit),this.Ca=new hJ,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function LJ(e){if(UJ(e),3==e.G){var t=e.V++,n=DX(e.F);BX(n,"SID",e.J),BX(n,"RID",t),BX(n,"TYPE","terminate"),HJ(e,n),(t=new dX(e,e.h,t,void 0)).K=2,t.v=zX(DX(n)),n=!1,vK.navigator&&vK.navigator.sendBeacon&&(n=vK.navigator.sendBeacon(t.v.toString(),"")),!n&&vK.Image&&((new Image).src=t.v,n=!0),n||(t.g=e1(t.l,null),t.g.ea(t.v)),t.F=Date.now(),bX(t)}XJ(e)}function FJ(e){e.g&&(jJ(e),e.g.cancel(),e.g=null)}function UJ(e){FJ(e),e.u&&(vK.clearTimeout(e.u),e.u=null),ZJ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&vK.clearTimeout(e.m),e.m=null)}function VJ(e,t){e.l.push(new(function(){return Zg(function e(t,n){jg(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&BJ(e)}function BJ(e){iJ(e.i)||e.m||(e.m=!0,NQ(e.Ha,e),e.C=0)}function zJ(e,t){var n;n=t?t.m:e.V++;var r=DX(e.F);BX(r,"SID",e.J),BX(r,"RID",n),BX(r,"AID",e.U),HJ(e,r),e.o&&e.s&&MJ(r,e.o,e.s),n=new dX(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=GJ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),sJ(e.i,n),mX(n,r,t)}function HJ(e,t){e.j&&IX({},function(e,n){BX(t,n,e)})}function GJ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?wK(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{fJ(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function $J(e){e.g||e.u||(e.Y=1,NQ(e.Ga,e),e.A=0)}function qJ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=rX(wK(e.Ga,e),KJ(e,e.A)),e.A++,0))}function jJ(e){null!=e.B&&(vK.clearTimeout(e.B),e.B=null)}function WJ(e){e.g=new dX(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=DX(e.oa);BX(t,"RID","rpc"),BX(t,"SID",e.J),BX(t,"CI",e.N?"0":"1"),BX(t,"AID",e.U),HJ(e,t),BX(t,"TYPE","xmlhttp"),e.o&&e.s&&MJ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=zX(DX(t)),n.s=null,n.U=!0,kX(n,e)}function ZJ(e){null!=e.v&&(vK.clearTimeout(e.v),e.v=null)}function YJ(e,t){var n=null;if(e.g==t){ZJ(e),jJ(e),e.g=null;var r=2}else{if(!oJ(e.i,t))return;n=t.D,uJ(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;PQ(r=QQ(),new nX(r,n,t,i)),BJ(e)}else $J(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(aJ(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=rX(wK(e.Ha,e,t),KJ(e,e.C)),e.C++,0)))}(e,t)||2==r&&qJ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:QJ(e,5);break;case 4:QJ(e,10);break;case 3:QJ(e,6);break;default:QJ(e,2)}}function KJ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function QJ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=wK(e.jb,e);n||(n=new NX("//www.google.com/images/cleardot.gif"),vK.location&&"http"==vK.location.protocol||LX(n,"https"),zX(n)),function(e,t){var n=new WQ;if(vK.Image){var r=new Image;r.onload=bK(dJ,n,r,"TestLoadImage: loaded",!0,t),r.onerror=bK(dJ,n,r,"TestLoadImage: error",!1,t),r.onabort=bK(dJ,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=bK(dJ,n,r,"TestLoadImage: timeout",!1,t),vK.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else tX(2);e.G=0,e.j&&e.j.va(t),XJ(e),UJ(e)}function XJ(e){e.G=0,e.I=-1,e.j&&((0!=cJ(e.i).length||0!=e.l.length)&&(e.i.i.length=0,AK(e.l),e.l.length=0),e.j.ua())}function JJ(e,t,n){var r=function(e){return e instanceof NX?DX(e):new NX(e,void 0)}(n);if(""!=r.i)t&&FX(r,t+"."+r.i),UX(r,r.m);else{var i=vK.location;r=function(e,t,n,r){var i=new NX(null,void 0);return e&&LX(i,e),t&&FX(i,t),n&&UX(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&UK(e.aa,function(e,t){BX(r,t,e)}),n=e.sa,(t=e.D)&&n&&BX(r,t,n),BX(r,"VER",e.ma),HJ(e,r),r}function e1(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new CJ(n&&e.Ba&&!e.qa?new vJ({ib:!0}):e.qa)).L=e.H,t}function t1(){}function n1(){if(qK&&!(10<=Number(tQ)))throw Error("Environmental error: no available transport.")}function r1(e,t){SQ.call(this),this.g=new DJ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!RK(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!RK(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new o1(this)}function i1(e){lX.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function a1(){hX.call(this),this.status=1}function o1(e){this.g=e}(XY=CJ.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():uX.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:uX),this.g.onreadystatechange=wK(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void PJ(this,a)}e=n||"";var i=new AX(this.headers);r&&IX(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=SJ,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=vK.FormData&&e instanceof vK.FormData,!(0<=OK(EJ,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{AJ(this),0<this.B&&((this.K=function(e){return qK&&function(){return e=eQ,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=MK(String(GK)).split("."),n=MK("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=DK(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||DK(0==a[2].length,0==o[2].length)||DK(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=wK(this.pa,this)):this.A=BQ(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){PJ(this,a)}},XY.pa=function(){void 0!==dK&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,PQ(this,"timeout"),this.abort(8))},XY.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,PQ(this,"complete"),PQ(this,"abort"),IJ(this))},XY.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),IJ(this,!0)),CJ.Z.M.call(this)},XY.Fa=function(){this.s||(this.F||this.v||this.l?TJ(this):this.cb())},XY.cb=function(){TJ(this)},XY.ba=function(){try{return 2<RJ(this)?this.g.status:-1}catch(e){return-1}},XY.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},XY.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),_J(t)}},XY.Da=function(){return this.m},XY.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(XY=DJ.prototype).ma=8,XY.G=1,XY.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},XY.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new dX(this,this.h,e,void 0),n=this.s;if(this.P&&(n?zK(n=VK(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=GJ(this,t,r),BX(i=DX(this.F),"RID",e),BX(i,"CVER",22),this.D&&BX(i,"X-HTTP-Session-Id",this.D),HJ(this,i),this.o&&n&&MJ(i,this.o,n),sJ(this.i,t),this.Ra&&BX(i,"TYPE","init"),this.ja?(BX(i,"$req",r),BX(i,"SID","null"),t.$=!0,mX(t,i,null)):mX(t,i,r),this.G=2}}else 3==this.G&&(e?zJ(this,e):0==this.l.length||iJ(this.i)||zJ(this))},XY.Ga=function(){if(this.u=null,WJ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=rX(wK(this.bb,this),e)}},XY.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,tX(10),FJ(this),WJ(this))},XY.ab=function(){null!=this.v&&(this.v=null,FJ(this),qJ(this),tX(19))},XY.jb=function(e){e?(this.h.info("Successfully pinged google.com"),tX(2)):(this.h.info("Failed to ping google.com"),tX(1))},(XY=t1.prototype).xa=function(){},XY.wa=function(){},XY.va=function(){},XY.ua=function(){},XY.Oa=function(){},n1.prototype.g=function(e,t){return new r1(e,t)},EK(r1,SQ),r1.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),NQ(wK(e.hb,e,t))),tX(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=JJ(e,null,e.W),BJ(e)},r1.prototype.close=function(){LJ(this.g)},r1.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,VJ(this.g,t)}else this.v?((t={}).__data__=TQ(e),VJ(this.g,t)):VJ(this.g,e)},r1.prototype.M=function(){this.g.j=null,delete this.j,LJ(this.g),delete this.g,r1.Z.M.call(this)},EK(i1,lX),EK(a1,hX),EK(o1,t1),o1.prototype.xa=function(){PQ(this.g,"a")},o1.prototype.wa=function(e){PQ(this.g,new i1(e))},o1.prototype.va=function(e){PQ(this.g,new a1(e))},o1.prototype.ua=function(){PQ(this.g,"b")},n1.prototype.createWebChannel=n1.prototype.g,r1.prototype.send=r1.prototype.u,r1.prototype.open=r1.prototype.m,r1.prototype.close=r1.prototype.close,iX.NO_ERROR=0,iX.TIMEOUT=8,iX.HTTP_ERROR=6,aX.COMPLETE="complete",sX.EventType=cX,cX.OPEN="a",cX.CLOSE="b",cX.ERROR="c",cX.MESSAGE="d",SQ.prototype.listen=SQ.prototype.N,CJ.prototype.listenOnce=CJ.prototype.O,CJ.prototype.getLastError=CJ.prototype.La,CJ.prototype.getLastErrorCode=CJ.prototype.Da,CJ.prototype.getStatus=CJ.prototype.ba,CJ.prototype.getResponseJson=CJ.prototype.Qa,CJ.prototype.getResponseText=CJ.prototype.ga,CJ.prototype.send=CJ.prototype.ea;var s1=fK.createWebChannelTransport=function(){return new n1},u1=fK.getStatEventTarget=function(){return QQ()},c1=fK.ErrorCode=iX,l1=fK.EventType=aX,h1=fK.Event=YQ,f1=fK.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},d1=fK.FetchXmlHttpFactory=vJ,v1=fK.WebChannel=sX,p1=fK.XhrIo=CJ,g1="@firebase/firestore",y1=function(){function e(t){jg(this,e),this.uid=t}return Zg(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();y1.UNAUTHENTICATED=new y1(null),y1.GOOGLE_CREDENTIALS=new y1("google-credentials-uid"),y1.FIRST_PARTY=new y1("first-party-uid"),y1.MOCK_USER=new y1("mock-user");var m1="9.9.0",k1=new dz("@firebase/firestore");function _1(){return k1.logLevel}function C1(e){if(k1.logLevel<=uz.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(E1);k1.debug.apply(k1,["Firestore (".concat(m1,"): ").concat(e)].concat(zg(i)))}}function w1(e){if(k1.logLevel<=uz.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(E1);k1.error.apply(k1,["Firestore (".concat(m1,"): ").concat(e)].concat(zg(i)))}}function b1(e){if(k1.logLevel<=uz.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(E1);k1.warn.apply(k1,["Firestore (".concat(m1,"): ").concat(e)].concat(zg(i)))}}function E1(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function S1(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(m1,") INTERNAL ASSERTION FAILED: ")+e;throw w1(t),new Error(t)}function P1(e,t){e||S1()}function O1(e,t){return e}var T1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I1=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return Zg(n)}(MB),A1=Zg(function e(){var t=this;jg(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),R1=Zg(function e(t,n){jg(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),x1=function(){function e(){jg(this,e)}return Zg(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(y1.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),M1=function(){function e(t){jg(this,e),this.token=t,this.changeListener=null}return Zg(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),N1=function(){function e(t){jg(this,e),this.t=t,this.currentUser=y1.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return Zg(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new A1;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new A1,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){C1("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(C1("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new A1)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(C1("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(P1("string"==typeof n.accessToken),new R1(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return P1(null===e||"string"==typeof e),new y1(e)}}]),e}(),D1=Zg(function e(t,n,r){jg(this,e),this.type="FirstParty",this.user=y1.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),L1=function(){function e(t,n,r){jg(this,e),this.h=t,this.l=n,this.m=r}return Zg(e,[{key:"getToken",value:function(){return Promise.resolve(new D1(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(y1.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),F1=Zg(function e(t){jg(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),U1=function(){function e(t){jg(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return Zg(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&C1("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,C1("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){C1("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):C1("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(P1("string"==typeof t.token),e.p=t.token,new F1(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function V1(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var B1=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=V1(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function z1(e,t){return e<t?-1:e>t?1:0}function H1(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var G1=function(){function e(t,n){if(jg(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new I1(T1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I1(T1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new I1(T1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new I1(T1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return Zg(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?z1(this.nanoseconds,e.nanoseconds):z1(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),$1=function(){function e(t){jg(this,e),this.timestamp=t}return Zg(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new G1(0,0))}},{key:"max",value:function(){return new e(new G1(253402300799,999999999))}}]),e}(),q1=function(){function e(t,n,r){jg(this,e),void 0===n?n=0:n>t.length&&S1(),void 0===r?r=t.length-n:r>t.length-n&&S1(),this.segments=t,this.offset=n,this.len=r}return Zg(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),j1=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new I1(T1.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,zg(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(q1),W1=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Z1=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return W1.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new I1(T1.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new I1(T1.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new I1(T1.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new I1(T1.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(q1),Y1=function(){function e(t){jg(this,e),this.path=t}return Zg(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===j1.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(j1.fromString(t))}},{key:"fromName",value:function(t){return new e(j1.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(j1.emptyPath())}},{key:"comparator",value:function(e,t){return j1.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new j1(t.slice()))}}]),e}();function K1(e){return new Q1(e.readTime,e.key,-1)}var Q1=function(){function e(t,n,r){jg(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return Zg(e,null,[{key:"min",value:function(){return new e($1.min(),Y1.empty(),-1)}},{key:"max",value:function(){return new e($1.max(),Y1.empty(),-1)}}]),e}();function X1(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=Y1.comparator(e.documentKey,t.documentKey))?n:z1(e.largestBatchId,t.largestBatchId)}var J1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function e0(e){return t0.apply(this,arguments)}function t0(){return t0=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===T1.FAILED_PRECONDITION&&t.message===J1){e.next=2;break}throw t;case 2:C1("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),t0.apply(this,arguments)}var n0=function(){function e(t){var n=this;jg(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return Zg(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&S1(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Gg(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function r0(e){return"IndexedDbTransactionError"===e.name}var i0=function(){function e(t,n){var r=this;jg(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return Zg(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function a0(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function o0(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function s0(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}i0.ot=-1;var u0=function(){function e(t,n){jg(this,e),this.comparator=t,this.root=n||l0.EMPTY}return Zg(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,l0.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,l0.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new c0(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new c0(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new c0(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new c0(this.root,e,this.comparator,!0)}}]),e}(),c0=function(){function e(t,n,r,i){jg(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return Zg(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),l0=function(){function e(t,n,r,i,a){jg(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return Zg(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw S1();var e=this.left.check();if(e!==this.right.check())throw S1();return e+(this.isRed()?0:1)}}]),e}();l0.EMPTY=null,l0.RED=!0,l0.BLACK=!1,l0.EMPTY=new(function(){function e(){jg(this,e),this.size=0}return Zg(e,[{key:"key",get:function(){throw S1()}},{key:"value",get:function(){throw S1()}},{key:"color",get:function(){throw S1()}},{key:"left",get:function(){throw S1()}},{key:"right",get:function(){throw S1()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new l0(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var h0=function(){function e(t){jg(this,e),this.comparator=t,this.data=new u0(this.comparator)}return Zg(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new f0(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new f0(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),f0=function(){function e(t){jg(this,e),this.iter=t}return Zg(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),d0=function(){function e(t){jg(this,e),this.fields=t,t.sort(Z1.comparator)}return Zg(e,[{key:"unionWith",value:function(t){var n,r=new h0(Z1.comparator),i=Gg(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=Gg(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=Gg(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return H1(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),v0=function(e){function t(e){jg(this,t),this.binaryString=e}return Zg(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return z1(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();v0.EMPTY_BYTE_STRING=new v0("");var p0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function g0(e){if(P1(!!e),"string"==typeof e){var t=0,n=p0.exec(e);if(P1(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:y0(e.seconds),nanos:y0(e.nanos)}}function y0(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function m0(e){return"string"==typeof e?v0.fromBase64String(e):v0.fromUint8Array(e)}function k0(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function _0(e){var t=e.mapValue.fields.__previous_value__;return k0(t)?_0(t):t}function C0(e){var t=g0(e.mapValue.fields.__local_write_time__.timestampValue);return new G1(t.seconds,t.nanos)}var w0=Zg(function e(t,n,r,i,a,o,s,u){jg(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),b0=function(){function e(t,n){jg(this,e),this.projectId=t,this.database=n||"(default)"}return Zg(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function E0(e){return null==e}function S0(e){return 0===e&&1/e==-1/0}var P0={fields:{__type__:{stringValue:"__max__"}}};function O0(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?k0(e)?4:z0(e)?9007199254740991:10:S1()}function T0(e,t){if(e===t)return!0;var n,r=O0(e);if(r!==O0(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return C0(e).isEqual(C0(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=g0(e.timestampValue),r=g0(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,m0(e.bytesValue).isEqual(m0(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return y0(e.geoPointValue.latitude)===y0(t.geoPointValue.latitude)&&y0(e.geoPointValue.longitude)===y0(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return y0(e.integerValue)===y0(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=y0(e.doubleValue),r=y0(t.doubleValue);return n===r?S0(n)===S0(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return H1(e.arrayValue.values||[],t.arrayValue.values||[],T0);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(a0(n)!==a0(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!T0(n[i],r[i])))return!1;return!0}(e,t);default:return S1()}}function I0(e,t){return void 0!==(e.values||[]).find(function(e){return T0(e,t)})}function A0(e,t){if(e===t)return 0;var n,r,i,a,o=O0(e),s=O0(t);if(o!==s)return z1(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return z1(e.booleanValue,t.booleanValue);case 2:return r=t,i=y0((n=e).integerValue||n.doubleValue),a=y0(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return R0(e.timestampValue,t.timestampValue);case 4:return R0(C0(e),C0(t));case 5:return z1(e.stringValue,t.stringValue);case 6:return function(e,t){var n=m0(e),r=m0(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=z1(n[i],r[i]);if(0!==a)return a}return z1(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=z1(y0(e.latitude),y0(t.latitude));return 0!==n?n:z1(y0(e.longitude),y0(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=A0(n[i],r[i]);if(a)return a}return z1(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===P0&&t===P0)return 0;if(e===P0)return 1;if(t===P0)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=z1(r[o],a[o]);if(0!==s)return s;var u=A0(n[r[o]],i[a[o]]);if(0!==u)return u}return z1(r.length,a.length)}(e.mapValue,t.mapValue);default:throw S1()}}function R0(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return z1(e,t);var n=g0(e),r=g0(t),i=z1(n.seconds,r.seconds);return 0!==i?i:z1(n.nanos,r.nanos)}function x0(e){return M0(e)}function M0(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=g0(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?m0(e.bytesValue).toBase64():"referenceValue"in e?Y1.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Gg(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=M0(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Gg(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(M0(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):S1();var t,n,r}function N0(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function D0(e){return!!e&&"integerValue"in e}function L0(e){return!!e&&"arrayValue"in e}function F0(e){return!!e&&"nullValue"in e}function U0(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function V0(e){return!!e&&"mapValue"in e}function B0(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return o0(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=B0(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=B0(e.arrayValue.values[r]);return n}return Object.assign({},e)}function z0(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var H0=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!V0(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=B0(t)}},{key:"setAll",value:function(e){var t=this,n=Z1.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=B0(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());V0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return T0(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];V0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){o0(t,function(t,n){return e[t]=n});var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(B0(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function G0(e){var t=[];return o0(e.fields,function(e,n){var r=new Z1([e]);if(V0(n)){var i=G0(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Gg(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new d0(t)}var $0=function(){function e(t,n,r,i,a,o){jg(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return Zg(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=H0.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=H0.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=$1.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,$1.min(),$1.min(),H0.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,$1.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,$1.min(),H0.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,$1.min(),H0.empty(),2)}}]),e}(),q0=Zg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;jg(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function j0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new q0(e,t,n,r,i,a,o)}function W0(e){var t=O1(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+x0(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),E0(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return x0(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return x0(e)}).join(",")),t.ut=n}return t.ut}function Z0(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!s2(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!T0(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!c2(e.startAt,t.startAt)&&c2(e.endAt,t.endAt)}function Y0(e){return Y1.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var K0=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return Zg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(A0(t,this.value)):null!==t&&O0(this.value)===O0(t)&&this.at(A0(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return S1()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new Q0(e,t,r):"array-contains"===t?new t2(e,r):"in"===t?new n2(e,r):"not-in"===t?new r2(e,r):"array-contains-any"===t?new i2(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new X0(e,n):new J0(e,n)}}]),n}(function(){return Zg(function e(){jg(this,e)})}()),Q0=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r,i)).key=Y1.fromName(i.referenceValue),a}return Zg(n,[{key:"matches",value:function(e){var t=Y1.comparator(e.key,this.key);return this.at(t)}}]),n}(K0),X0=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,"in",r)).keys=e2(0,r),i}return Zg(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(K0),J0=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,"not-in",r)).keys=e2(0,r),i}return Zg(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(K0);function e2(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return Y1.fromName(e.referenceValue)})}var t2=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,"array-contains",r)}return Zg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return L0(t)&&I0(t.arrayValue,this.value)}}]),n}(K0),n2=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,"in",r)}return Zg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&I0(this.value.arrayValue,t)}}]),n}(K0),r2=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,"not-in",r)}return Zg(n,[{key:"matches",value:function(e){if(I0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!I0(this.value.arrayValue,t)}}]),n}(K0),i2=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,"array-contains-any",r)}return Zg(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!L0(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return I0(t.value.arrayValue,e)})}}]),n}(K0),a2=Zg(function e(t,n){jg(this,e),this.position=t,this.inclusive=n}),o2=Zg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";jg(this,e),this.field=t,this.dir=n});function s2(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function u2(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?Y1.comparator(Y1.fromName(o.referenceValue),n.key):A0(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function c2(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!T0(e.position[n],t.position[n]))return!1;return!0}var l2=Zg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;jg(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function h2(e){return new l2(e)}function f2(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function d2(e){var t,n=Gg(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function v2(e){return null!==e.collectionGroup}function p2(e){var t=O1(e);if(null===t.lt){t.lt=[];var n=d2(t),r=f2(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new o2(n)),t.lt.push(new o2(Z1.keyField(),"asc"));else{var i,a=!1,o=Gg(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new o2(Z1.keyField(),u))}}}return t.lt}function g2(e){var t=O1(e);if(!t.ft)if("F"===t.limitType)t.ft=j0(t.path,t.collectionGroup,p2(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Gg(p2(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new o2(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new a2(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new a2(t.startAt.position,t.startAt.inclusive):null;t.ft=j0(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function y2(e,t,n){return new l2(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function m2(e,t){return Z0(g2(e),g2(t))&&e.limitType===t.limitType}function k2(e){return"".concat(W0(g2(e)),"|lt:").concat(e.limitType)}function _2(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(x0(t.value));var t}).join(", "),"]")),E0(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return x0(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return x0(e)}).join(",")),"Target(".concat(t,")")}(g2(e)),"; limitType=").concat(e.limitType,")")}function C2(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Y1.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Gg(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Gg(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=p2(o),i=s,a=u2(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=u2(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,p2(o),s)));var n,r,i,a,o,s}function w2(e){return function(t,n){var r,i=!1,a=Gg(p2(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=b2(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function b2(e,t,n){var r,i,a,o,s=e.field.isKeyField()?Y1.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?A0(a,o):S1());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return S1()}}function E2(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:S0(t)?"-0":t}}function S2(e){return{integerValue:""+e}}var P2=Zg(function e(){jg(this,e),this._=void 0});function O2(e,t,n){return e instanceof A2?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof R2?x2(e,t):e instanceof M2?N2(e,t):function(e,t){var n=I2(e,t),r=L2(n)+L2(e._t);return D0(n)&&D0(e._t)?S2(r):E2(e.wt,r)}(e,t);var r,i,a}function T2(e,t,n){return e instanceof R2?x2(e,t):e instanceof M2?N2(e,t):n}function I2(e,t){return e instanceof D2?D0(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var A2=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n)}(P2),R2=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).elements=e,r}return Zg(n)}(P2);function x2(e,t){var n,r=F2(t),i=Gg(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return T0(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var M2=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).elements=e,r}return Zg(n)}(P2);function N2(e,t){var n,r=F2(t),i=Gg(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!T0(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var D2=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).wt=e,i._t=r,i}return Zg(n)}(P2);function L2(e){return y0(e.integerValue||e.doubleValue)}function F2(e){return L0(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var U2=Zg(function e(t,n){jg(this,e),this.field=t,this.transform=n}),V2=Zg(function e(t,n){jg(this,e),this.version=t,this.transformResults=n}),B2=function(){function e(t,n){jg(this,e),this.updateTime=t,this.exists=n}return Zg(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function z2(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var H2=Zg(function e(){jg(this,e)});function G2(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new t3(e.key,B2.none()):new Z2(e.key,e.data,B2.none());var n,r=e.data,i=H0.empty(),a=new h0(Z1.comparator),o=Gg(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new Y2(e.key,i,new d0(a.toArray()),B2.none())}function $2(e,t,n){var r,i,a,o,s;e instanceof Z2?(i=t,a=n,o=(r=e).value.clone(),s=Q2(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof Y2?function(e,t,n){if(z2(e.precondition,t)){var r=Q2(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(K2(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function q2(e,t,n,r){return e instanceof Z2?function(e,t,n,r){if(!z2(e.precondition,t))return n;var i=e.value.clone(),a=X2(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Y2?function(e,t,n,r){if(!z2(e.precondition,t))return n;var i=X2(e.fieldTransforms,r,t),a=t.data;return a.setAll(K2(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,z2(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function j2(e,t){var n,r=null,i=Gg(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=I2(a.transform,o||null);null!=s&&(null===r&&(r=H0.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function W2(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&H1(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof R2&&r instanceof R2||n instanceof M2&&r instanceof M2?H1(n.elements,r.elements,T0):n instanceof D2&&r instanceof D2?T0(n._t,r._t):n instanceof A2&&r instanceof A2);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var Z2=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return jg(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return Zg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(H2),Y2=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return jg(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return Zg(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(H2);function K2(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function Q2(e,t,n){var r=new Map;P1(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,T2(o,s,n[i]))}return r}function X2(e,t,n){var r,i=new Map,a=Gg(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,O2(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var J2,e3,t3=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return Zg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(H2),n3=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return Zg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(H2),r3=Zg(function e(t){jg(this,e),this.count=t});function i3(e){switch(e){default:return S1();case T1.CANCELLED:case T1.UNKNOWN:case T1.DEADLINE_EXCEEDED:case T1.RESOURCE_EXHAUSTED:case T1.INTERNAL:case T1.UNAVAILABLE:case T1.UNAUTHENTICATED:return!1;case T1.INVALID_ARGUMENT:case T1.NOT_FOUND:case T1.ALREADY_EXISTS:case T1.PERMISSION_DENIED:case T1.FAILED_PRECONDITION:case T1.ABORTED:case T1.OUT_OF_RANGE:case T1.UNIMPLEMENTED:case T1.DATA_LOSS:return!0}}function a3(e){if(void 0===e)return w1("GRPC error has no .code"),T1.UNKNOWN;switch(e){case J2.OK:return T1.OK;case J2.CANCELLED:return T1.CANCELLED;case J2.UNKNOWN:return T1.UNKNOWN;case J2.DEADLINE_EXCEEDED:return T1.DEADLINE_EXCEEDED;case J2.RESOURCE_EXHAUSTED:return T1.RESOURCE_EXHAUSTED;case J2.INTERNAL:return T1.INTERNAL;case J2.UNAVAILABLE:return T1.UNAVAILABLE;case J2.UNAUTHENTICATED:return T1.UNAUTHENTICATED;case J2.INVALID_ARGUMENT:return T1.INVALID_ARGUMENT;case J2.NOT_FOUND:return T1.NOT_FOUND;case J2.ALREADY_EXISTS:return T1.ALREADY_EXISTS;case J2.PERMISSION_DENIED:return T1.PERMISSION_DENIED;case J2.FAILED_PRECONDITION:return T1.FAILED_PRECONDITION;case J2.ABORTED:return T1.ABORTED;case J2.OUT_OF_RANGE:return T1.OUT_OF_RANGE;case J2.UNIMPLEMENTED:return T1.UNIMPLEMENTED;case J2.DATA_LOSS:return T1.DATA_LOSS;default:return S1()}}(e3=J2||(J2={}))[e3.OK=0]="OK",e3[e3.CANCELLED=1]="CANCELLED",e3[e3.UNKNOWN=2]="UNKNOWN",e3[e3.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e3[e3.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e3[e3.NOT_FOUND=5]="NOT_FOUND",e3[e3.ALREADY_EXISTS=6]="ALREADY_EXISTS",e3[e3.PERMISSION_DENIED=7]="PERMISSION_DENIED",e3[e3.UNAUTHENTICATED=16]="UNAUTHENTICATED",e3[e3.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e3[e3.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e3[e3.ABORTED=10]="ABORTED",e3[e3.OUT_OF_RANGE=11]="OUT_OF_RANGE",e3[e3.UNIMPLEMENTED=12]="UNIMPLEMENTED",e3[e3.INTERNAL=13]="INTERNAL",e3[e3.UNAVAILABLE=14]="UNAVAILABLE",e3[e3.DATA_LOSS=15]="DATA_LOSS";var o3=function(){function e(t,n){jg(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return Zg(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=Og(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){o0(this.inner,function(t,n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=Og(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return s0(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),s3=new u0(Y1.comparator);function u3(){return s3}var c3=new u0(Y1.comparator);function l3(){for(var e=c3,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function h3(e){var t=c3;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function f3(){return v3()}function d3(){return v3()}function v3(){return new o3(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var p3=new u0(Y1.comparator),g3=new h0(Y1.comparator);function y3(){for(var e=g3,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var m3=new h0(z1);function k3(){return m3}var _3=function(){function e(t,n,r,i,a){jg(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return Zg(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,C3.createSynthesizedTargetChangeForCurrentChange(t,n)),new e($1.min(),r,k3(),u3(),y3())}}]),e}(),C3=function(){function e(t,n,r,i,a){jg(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return Zg(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(v0.EMPTY_BYTE_STRING,n,y3(),y3(),y3())}}]),e}(),w3=Zg(function e(t,n,r,i){jg(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),b3=Zg(function e(t,n){jg(this,e),this.targetId=t,this.It=n}),E3=Zg(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v0.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;jg(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),S3=function(){function e(){jg(this,e),this.Tt=0,this.Et=T3(),this.At=v0.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return Zg(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=y3(),t=y3(),n=y3();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:S1()}}),new C3(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=T3()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),P3=function(){function e(t){jg(this,e),this.Mt=t,this.Ft=new Map,this.$t=u3(),this.Bt=O3(),this.Lt=new h0(z1)}return Zg(e,[{key:"Ut",value:function(e){var t,n=Gg(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=Gg(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:S1()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(Y0(i))if(0===n){var a=new Y1(i.path);this.Kt(t,a,$0.newNoDocument(a,$1.min()))}else P1(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&Y0(a.target)){var o=new Y1(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,$0.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=y3();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new _3(e,n,this.Lt,this.$t,r);return this.$t=u3(),this.Bt=O3(),this.Lt=new h0(z1),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new S3,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new h0(z1),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||C1("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new S3),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function O3(){return new u0(Y1.comparator)}function T3(){return new u0(Y1.comparator)}var I3={asc:"ASCENDING",desc:"DESCENDING"},A3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},R3=Zg(function e(t,n){jg(this,e),this.databaseId=t,this.dt=n});function x3(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function M3(e,t){return e.dt?t.toBase64():t.toUint8Array()}function N3(e,t){return x3(e,t.toTimestamp())}function D3(e){return P1(!!e),$1.fromTimestamp((t=g0(e),new G1(t.seconds,t.nanos)));var t}function L3(e,t){return(n=e,new j1(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function F3(e){var t=j1.fromString(e);return P1(t4(t)),t}function U3(e,t){return L3(e.databaseId,t.path)}function V3(e,t){var n=F3(t);if(n.get(1)!==e.databaseId.projectId)throw new I1(T1.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new I1(T1.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Y1(H3(n))}function B3(e,t){return L3(e.databaseId,t)}function z3(e){return new j1(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function H3(e){return P1(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function G3(e,t,n){return{name:U3(e,t),fields:n.value.mapValue.fields}}function $3(e,t){return{documents:[B3(e,t.path)]}}function q3(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=B3(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=B3(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(U0(e.value))return{unaryFilter:{field:K3(e.field),op:"IS_NAN"}};if(F0(e.value))return{unaryFilter:{field:K3(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(U0(e.value))return{unaryFilter:{field:K3(e.field),op:"IS_NOT_NAN"}};if(F0(e.value))return{unaryFilter:{field:K3(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:K3(e.field),op:Y3(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:K3((t=e).field),direction:Z3(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||E0(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function j3(e){var t=function(e){var t=F3(e);return 4===t.length?j1.emptyPath():H3(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){P1(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=W3(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new o2(Q3((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return E0(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new a2((c=n.startAt).values||[],!!c.before));var h=null;return n.endAt&&(h=function(e){return new a2(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new l2(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,h)}function W3(e){return e?void 0!==e.unaryFilter?[J3(e)]:void 0!==e.fieldFilter?[X3(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return W3(e)}).reduce(function(e,t){return e.concat(t)}):S1():[]}function Z3(e){return I3[e]}function Y3(e){return A3[e]}function K3(e){return{fieldPath:e.canonicalString()}}function Q3(e){return Z1.fromServerFormat(e.fieldPath)}function X3(e){return K0.create(Q3(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return S1()}}(e.fieldFilter.op),e.fieldFilter.value)}function J3(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Q3(e.unaryFilter.field);return K0.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Q3(e.unaryFilter.field);return K0.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Q3(e.unaryFilter.field);return K0.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Q3(e.unaryFilter.field);return K0.create(i,"!=",{nullValue:"NULL_VALUE"});default:return S1()}}function e4(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function t4(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var n4=function(){function e(t,n,r,i){jg(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return Zg(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&$2(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=Gg(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=q2(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=Gg(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=q2(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=d3();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=G2(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument($1.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},y3())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&H1(this.mutations,e.mutations,function(e,t){return W2(e,t)})&&H1(this.baseMutations,e.baseMutations,function(e,t){return W2(e,t)})}}]),e}(),r4=function(){function e(t,n,r,i){jg(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return Zg(e,null,[{key:"from",value:function(t,n,r){P1(t.mutations.length===r.length);for(var i=p3,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),i4=function(){function e(t,n){jg(this,e),this.largestBatchId=t,this.mutation=n}return Zg(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),a4=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:$1.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:$1.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:v0.EMPTY_BYTE_STRING;jg(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return Zg(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),o4=Zg(function e(t){jg(this,e),this.ne=t});function s4(e){var t=j3({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?y2(t,t.limit,"L"):t}var u4=function(){function e(){jg(this,e)}return Zg(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(y0(e.integerValue));else if("doubleValue"in e){var n=y0(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),S0(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(m0(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?z0(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):S1()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),Y1.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();u4.ye=new u4;var c4=function(){function e(){jg(this,e),this.ze=new l4}return Zg(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),n0.resolve()}},{key:"getCollectionParents",value:function(e,t){return n0.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return n0.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return n0.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return n0.resolve(null)}},{key:"getIndexType",value:function(e,t){return n0.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return n0.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return n0.resolve(null)}},{key:"getMinOffset",value:function(e,t){return n0.resolve(Q1.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return n0.resolve(Q1.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return n0.resolve()}},{key:"updateIndexEntries",value:function(e,t){return n0.resolve()}}]),e}(),l4=function(){function e(){jg(this,e),this.index={}}return Zg(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new h0(j1.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new h0(j1.comparator)).toArray()}}]),e}();new Uint8Array(0);var h4=function(){function e(t,n,r){jg(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return Zg(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();h4.DEFAULT_COLLECTION_PERCENTILE=10,h4.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,h4.DEFAULT=new h4(41943040,h4.DEFAULT_COLLECTION_PERCENTILE,h4.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),h4.DISABLED=new h4(-1,0,0);var f4=function(){function e(t){jg(this,e),this.En=t}return Zg(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),d4=Zg(function e(t,n){jg(this,e),this.overlayedDocument=t,this.mutatedFields=n}),v4=function(){function e(t,n,r,i){jg(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return Zg(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&q2(r.mutation,e,d0.empty(),G1.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,y3()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y3(),i=f3();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=l3();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=f3();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,y3())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=u3(),a=v3(),o=v3();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Y2)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),q2(o.mutation,t,o.mutation.getFieldMask(),G1.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new d4(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=v3(),i=new u0(function(e,t){return e-t}),a=y3();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=Gg(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||d0.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||y3()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=d3();c.forEach(function(e){if(!a.has(e)){var n=G2(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return n0.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return Y1.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):v2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):n0.resolve(f3()),s=-1,u=a;return o.next(function(t){return n0.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?n0.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,y3())}).next(function(e){return{batchId:s,changes:h3(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new Y1(t)).next(function(e){var t=l3();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=l3();return this.indexManager.getCollectionParents(e,i).next(function(o){return n0.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new l2(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,$0.newInvalidDocument(n)))});var n=l3();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&q2(a.mutation,i,d0.empty(),G1.now()),C2(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):n0.resolve($0.newInvalidDocument(t))}}]),e}(),p4=function(){function e(t){jg(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return Zg(e,[{key:"getBundleMetadata",value:function(e,t){return n0.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:D3(n.createTime)}),n0.resolve()}},{key:"getNamedQuery",value:function(e,t){return n0.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:s4(n.bundledQuery),readTime:D3(n.readTime)}),n0.resolve();var n}}]),e}(),g4=function(){function e(){jg(this,e),this.overlays=new u0(Y1.comparator),this.Xn=new Map}return Zg(e,[{key:"getOverlay",value:function(e,t){return n0.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=f3();return n0.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),n0.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),n0.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=f3(),i=t.length+1,a=new Y1(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return n0.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new u0(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=f3(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=f3(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return n0.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new i4(t,n));var a=this.Xn.get(t);void 0===a&&(a=y3(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),y4=function(){function e(){jg(this,e),this.Zn=new h0(m4.ts),this.es=new h0(m4.ns)}return Zg(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new m4(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new m4(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new Y1(new j1([])),r=new m4(n,e),i=new m4(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new Y1(new j1([])),n=new m4(t,e),r=new m4(t,e+1),i=y3();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new m4(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),m4=function(){function e(t,n){jg(this,e),this.key=t,this.ls=n}return Zg(e,null,[{key:"ts",value:function(e,t){return Y1.comparator(e.key,t.key)||z1(e.ls,t.ls)}},{key:"ns",value:function(e,t){return z1(e.ls,t.ls)||Y1.comparator(e.key,t.key)}}]),e}(),k4=function(){function e(t,n){jg(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new h0(m4.ts)}return Zg(e,[{key:"checkEmpty",value:function(e){return n0.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new n4(i,t,n,r);this.mutationQueue.push(a);var o,s=Gg(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new m4(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return n0.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return n0.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return n0.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return n0.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return n0.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new m4(t,0),i=new m4(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),n0.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new h0(z1);return t.forEach(function(e){var t=new m4(e,0),i=new m4(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),n0.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;Y1.isDocumentKey(i)||(i=i.child(""));var a=new m4(new Y1(i),0),o=new h0(z1);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),n0.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;P1(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return n0.forEach(t.mutations,function(i){var a=new m4(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new m4(t,0),r=this.ds.firstAfterOrEqual(n);return n0.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return n0.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),_4=function(){function e(t){jg(this,e),this.ps=t,this.docs=new u0(Y1.comparator),this.size=0}return Zg(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return n0.resolve(n?n.document.mutableCopy():$0.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=u3();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():$0.newInvalidDocument(e))}),n0.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=u3(),i=new Y1(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||X1(K1(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return n0.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){S1()}},{key:"Is",value:function(e,t){return n0.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new C4(this)}},{key:"getSize",value:function(e){return n0.resolve(this.size)}}]),e}(),C4=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).zn=e,r}return Zg(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),n0.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){jg(this,e),this.changes=new o3(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return Zg(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,$0.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?n0.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),w4=function(){function e(t){jg(this,e),this.persistence=t,this.Ts=new o3(function(e){return W0(e)},Z0),this.lastRemoteSnapshotVersion=$1.min(),this.highestTargetId=0,this.Es=0,this.As=new y4,this.targetCount=0,this.Rs=f4.An()}return Zg(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),n0.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return n0.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return n0.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),n0.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),n0.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new f4(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,n0.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),n0.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,n0.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),n0.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return n0.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return n0.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),n0.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),n0.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),n0.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return n0.resolve(n)}},{key:"containsKey",value:function(e,t){return n0.resolve(this.As.containsKey(t))}}]),e}(),b4=function(){function e(t,n){var r=this;jg(this,e),this.bs={},this.overlays={},this.Ps=new i0(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new w4(this),this.indexManager=new c4,this.remoteDocumentCache=new _4(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new o4(n),this.Ds=new p4(this.wt)}return Zg(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new g4,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new k4(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;C1("MemoryPersistence","Starting transaction:",e);var i=new E4(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return n0.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),E4=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return Zg(n)}(function(){function e(){jg(this,e),this.onCommittedListeners=[]}return Zg(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),S4=function(){function e(t){jg(this,e),this.persistence=t,this.ks=new y4,this.Os=null}return Zg(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw S1()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),n0.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),n0.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),n0.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return n0.forEach(this.Fs,function(r){var i=Y1.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,$1.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return n0.or([function(){return n0.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),P4=function(){function e(t,n,r,i){jg(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return Zg(e,null,[{key:"Vi",value:function(t,n){var r,i=y3(),a=y3(),o=Gg(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),O4=function(){function e(){jg(this,e),this.Si=!1}return Zg(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return n0.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual($1.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(_1()<=uz.DEBUG&&C1("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),_2(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=$1.fromTimestamp(1e9===r?new G1(n+1,0):new G1(n,r));return new Q1(i,Y1.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new h0(w2(e));return t.forEach(function(t,r){C2(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return _1()<=uz.DEBUG&&C1("QueryEngine","Using full collection scan to execute query:",_2(t)),this.Di.getDocumentsMatchingQuery(e,t,Q1.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),T4=function(){function e(t,n,r,i){jg(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new u0(z1),this.Bi=new o3(function(e){return W0(e)},Z0),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return Zg(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v4(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function I4(e,t){return A4.apply(this,arguments)}function A4(){return A4=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=O1(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=y3(),u=Gg(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,h=Gg(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;s=s.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=Gg(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=Gg(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),A4.apply(this,arguments)}function R4(e,t){var n=O1(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),h=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=h,s=a.batch,u=s.keys(),c=n0.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);P1(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return h.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=y3(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function x4(e){var t=O1(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function M4(e,t){var n=O1(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?f=f.withResumeToken(v0.EMPTY_BYTE_STRING,$1.min()).withLastLimboFreeSnapshotVersion($1.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(s,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,f))}});var s=u3(),u=y3();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=y3(),i=y3();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=u3();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual($1.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):C1("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual($1.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return n0.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function N4(e,t){var n=O1(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function D4(e,t){var n=O1(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,n0.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new a4(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function L4(e,t,n){return F4.apply(this,arguments)}function F4(){return F4=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=O1(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),r0(e.t1)){e.next=12;break}throw e.t1;case 12:C1("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),F4.apply(this,arguments)}function U4(e,t,n){var r=O1(e),i=$1.min(),a=y3();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=g2(t),c=O1(o),l=c.Bi.get(u),void 0!==l?n0.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:$1.min(),n?a:y3())}).next(function(e){return function(e,t,n){var r=$1.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var V4=function(){function e(){jg(this,e),this.activeTargetIds=k3()}return Zg(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),B4=function(){function e(){jg(this,e),this.Fr=new V4,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return Zg(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new V4,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),z4=function(){function e(){jg(this,e)}return Zg(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),H4=function(){function e(){var t=this;jg(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return Zg(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){C1("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Gg(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){C1("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Gg(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),G4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},$4=function(){function e(t){jg(this,e),this.jr=t.jr,this.Wr=t.Wr}return Zg(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),q4=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return Zg(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new p1;o.listenOnce(l1.COMPLETE,function(){try{switch(o.getLastErrorCode()){case c1.NO_ERROR:var t=o.getResponseJson();C1("Connection","XHR received:",JSON.stringify(t)),i(t);break;case c1.TIMEOUT:C1("Connection",'RPC "'+e+'" timed out'),a(new I1(T1.DEADLINE_EXCEEDED,"Request time out"));break;case c1.HTTP_ERROR:var n=o.getStatus();if(C1("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(T1).indexOf(c)>=0?c:T1.UNKNOWN);a(new I1(s,r.message))}else a(new I1(T1.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new I1(T1.UNAVAILABLE,"Connection failed."));break;default:S1()}}finally{C1("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=s1(),a=u1(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new d1({})),this.uo(o.initMessageHeaders,t,n),PB()||TB()||SB().indexOf("Electron/")>=0||IB()||SB().indexOf("MSAppHost/")>=0||OB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");C1("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,h=new $4({jr:function(e){l?C1("Connection","Not sending because WebChannel is closed:",e):(c||(C1("Connection","Opening WebChannel transport."),u.open(),c=!0),C1("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),f=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,v1.EventType.OPEN,function(){l||C1("Connection","WebChannel transport opened.")}),f(u,v1.EventType.CLOSE,function(){l||(l=!0,C1("Connection","WebChannel transport closed"),h.eo())}),f(u,v1.EventType.ERROR,function(e){l||(l=!0,b1("Connection","WebChannel transport errored:",e),h.eo(new I1(T1.UNAVAILABLE,"The operation could not be completed")))}),f(u,v1.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];P1(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){C1("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=J2[e];if(void 0!==t)return a3(t)}(a),s=i.message;void 0===o&&(o=T1.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,h.eo(new I1(o,s)),u.close()}else C1("Connection","WebChannel received:",n),h.no(n)}}),f(a,h1.STAT_EVENT,function(e){e.stat===f1.PROXY?C1("Connection","Detected buffering proxy"):e.stat===f1.NOPROXY&&C1("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Zr()},0),h}}]),n}(function(){function e(t){jg(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return Zg(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);C1("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return C1("RestConnection","Received: ",e),e},function(t){throw b1("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+m1,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(G4[e])}}]),e}());function j4(){return"undefined"!=typeof document?document:null}function W4(e){return new R3(e,!0)}var Z4=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;jg(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return Zg(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&C1("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),Y4=function(){function e(t,n,r,i,a,o,s,u){jg(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Z4(t,n)}return Zg(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===T1.RESOURCE_EXHAUSTED?(w1(t.toString()),w1("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===T1.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Og(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new I1(T1.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return C1("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(C1("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),K4=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return Zg(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:S1(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(P1(void 0===t||"string"==typeof t),v0.fromBase64String(t||"")):(P1(void 0===t||t instanceof Uint8Array),v0.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?T1.UNKNOWN:a3(e.code);return new I1(t,e.message||"")}(s);n=new E3(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=V3(e,c.document.name),h=D3(c.document.updateTime),f=new H0({mapValue:{fields:c.document.fields}}),d=$0.newFoundDocument(l,h,f);n=new w3(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=V3(e,v.document),g=v.readTime?D3(v.readTime):$1.min(),y=$0.newNoDocument(p,g);n=new w3([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=V3(e,m.document);n=new w3([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return S1();var _=t.filter,C=new r3(_.count||0);n=new b3(_.targetId,C)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return $1.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?$1.min():t.readTime?D3(t.readTime):$1.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=z3(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=Y0(i)?{documents:$3(t,i)}:{query:q3(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=M3(t,n.resumeToken):n.snapshotVersion.compareTo($1.min())>0&&(r.readTime=x3(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return S1()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=z3(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(Y4),Q4=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return Zg(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,xg(Bg(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(P1(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(P1(void 0!==t),e.map(function(e){return function(e,t){var n=D3(e.updateTime?e.updateTime:t);return n.isEqual($1.min())&&(n=D3(t)),new V2(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=D3(e.commitTime);return this.listener.Jo(n,t)}return P1(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=z3(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof Z2)n={update:G3(e,t.key,t.value)};else if(t instanceof t3)n={delete:U3(e,t.key)};else if(t instanceof Y2)n={update:G3(e,t.key,t.data),updateMask:e4(t.fieldMask)};else{if(!(t instanceof n3))return S1();n={verify:U3(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof A2)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof R2)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof M2)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof D2)return{fieldPath:t.field.canonicalString(),increment:n._t};throw S1()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:N3(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:S1()),n}(t.wt,e)})};this.Mo(n)}}]),n}(Y4),X4=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return Zg(n,[{key:"tu",value:function(){if(this.Zo)throw new I1(T1.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Og(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===T1.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new I1(T1.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=Og(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===T1.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new I1(T1.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return Zg(function e(){jg(this,e)})}()),J4=function(){function e(t,n){jg(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return Zg(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(w1(t),this.su=!1):C1("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),e5=Zg(function e(t,n,r,i,a){jg(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(oB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=h5(o),!e.t0){e.next=5;break}return C1("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=oB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=O1(t)).lu.add(4),e.next=4,r5(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,t5(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new J4(r,i)});function t5(e){return n5.apply(this,arguments)}function n5(){return n5=oB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!h5(t)){e.next=18;break}n=Gg(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),n5.apply(this,arguments)}function r5(e){return i5.apply(this,arguments)}function i5(){return i5=oB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Gg(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),i5.apply(this,arguments)}function a5(e,t){var n=O1(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),l5(n)?c5(n):V5(n).Co()&&s5(n,t))}function o5(e,t){var n=O1(e),r=V5(n);n.hu.delete(t),r.Co()&&u5(n,t),0===n.hu.size&&(r.Co()?r.ko():h5(n)&&n._u.set("Unknown"))}function s5(e,t){e.wu.Nt(t.targetId),V5(e).Qo(t)}function u5(e,t){e.wu.Nt(t),V5(e).jo(t)}function c5(e){e.wu=new P3({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),V5(e).start(),e._u.iu()}function l5(e){return h5(e)&&!V5(e).Do()&&e.hu.size>0}function h5(e){return 0===O1(e).lu.size}function f5(e){e.wu=void 0}function d5(e){return v5.apply(this,arguments)}function v5(){return v5=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){s5(t,e)});case 1:case"end":return e.stop()}},e)})),v5.apply(this,arguments)}function p5(e,t){return g5.apply(this,arguments)}function g5(){return g5=oB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:f5(t),l5(t)?(t._u.uu(n),c5(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),g5.apply(this,arguments)}function y5(e,t,n){return m5.apply(this,arguments)}function m5(){return m5=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof E3&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Gg(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),C1("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,k5(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof w3?t.wu.Ut(n):n instanceof b3?t.wu.zt(n):t.wu.Gt(n),r.isEqual($1.min())){e.next=29;break}return e.prev=14,e.next=17,x4(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(v0.EMPTY_BYTE_STRING,n.snapshotVersion)),u5(e,t);var r=new a4(n.target,t,1,n.sequenceNumber);s5(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),C1("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,k5(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),m5.apply(this,arguments)}function k5(e,t,n){return _5.apply(this,arguments)}function _5(){return _5=oB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r0(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,r5(t);case 5:t._u.set("Offline"),r||(r=function(){return x4(t.localStore)}),t.asyncQueue.enqueueRetryable(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C1("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,t5(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),_5.apply(this,arguments)}function C5(e,t){return t().catch(function(n){return k5(e,n,t)})}function w5(e){return b5.apply(this,arguments)}function b5(){return b5=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=O1(t),r=B5(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!E5(n)){e.next=19;break}return e.prev=3,e.next=6,N4(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,S5(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,k5(n,e.t0);case 17:e.next=2;break;case 19:P5(n)&&O5(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),b5.apply(this,arguments)}function E5(e){return h5(e)&&e.au.length<10}function S5(e,t){e.au.push(t);var n=B5(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function P5(e){return h5(e)&&!B5(e).Do()&&e.au.length>0}function O5(e){B5(e).start()}function T5(e){return I5.apply(this,arguments)}function I5(){return I5=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B5(t).Xo();case 1:case"end":return e.stop()}},e)})),I5.apply(this,arguments)}function A5(e){return R5.apply(this,arguments)}function R5(){return R5=oB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=B5(t),r=Gg(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),R5.apply(this,arguments)}function x5(e,t,n){return M5.apply(this,arguments)}function M5(){return M5=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=r4.from(i,n,r),e.next=3,C5(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,w5(t);case 5:case"end":return e.stop()}},e)})),M5.apply(this,arguments)}function N5(e,t){return D5.apply(this,arguments)}function D5(){return D5=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&B5(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i3(i=n.code)||i===T1.ABORTED){e.next=7;break}return r=t.au.shift(),B5(t).No(),e.next=5,C5(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,w5(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:P5(t)&&O5(t);case 5:case"end":return e.stop()}},e)})),D5.apply(this,arguments)}function L5(e,t){return F5.apply(this,arguments)}function F5(){return F5=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=O1(t)).asyncQueue.verifyOperationInProgress(),C1("RemoteStore","RemoteStore received new credentials"),i=h5(r),r.lu.add(3),e.next=6,r5(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,t5(r);case 12:case"end":return e.stop()}},e)})),F5.apply(this,arguments)}function U5(){return U5=oB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=O1(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,t5(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,r5(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),U5.apply(this,arguments)}function V5(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:d5.bind(null,e),Jr:p5.bind(null,e),Go:y5.bind(null,e)},(i=O1(t)).tu(),new K4(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=oB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),l5(e)?c5(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:f5(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function B5(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:T5.bind(null,e),Jr:N5.bind(null,e),Yo:A5.bind(null,e),Jo:x5.bind(null,e)},(i=O1(t)).tu(),new Q4(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=oB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,w5(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(C1("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var z5=function(){function e(t,n,r,i,a){jg(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new A1,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return Zg(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new I1(T1.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function H5(e,t){if(w1("AsyncQueue","".concat(t,": ").concat(e)),r0(e))return new I1(T1.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var G5=function(){function e(t){jg(this,e),this.comparator=t?function(e,n){return t(e,n)||Y1.comparator(e.key,n.key)}:function(e,t){return Y1.comparator(e.key,t.key)},this.keyedMap=l3(),this.sortedSet=new u0(this.comparator)}return Zg(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),$5=function(){function e(){jg(this,e),this.yu=new u0(Y1.comparator)}return Zg(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):S1():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),q5=function(){function e(t,n,r,i,a,o,s,u){jg(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return Zg(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&m2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,G5.emptySet(n),a,r,i,!0,!1)}}]),e}(),j5=Zg(function e(){jg(this,e),this.Iu=void 0,this.listeners=[]}),W5=Zg(function e(){jg(this,e),this.queries=new o3(function(e){return k2(e)},m2),this.onlineState="Unknown",this.Tu=new Set});function Z5(e,t){return Y5.apply(this,arguments)}function Y5(){return Y5=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=O1(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new j5),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=H5(e.t0,"Initialization of query '".concat(_2(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&e6(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),Y5.apply(this,arguments)}function K5(e,t){return Q5.apply(this,arguments)}function Q5(){return Q5=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=O1(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),Q5.apply(this,arguments)}function X5(e,t){var n,r=O1(e),i=!1,a=Gg(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=Gg(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&e6(r)}function J5(e,t,n){var r=O1(e),i=r.queries.get(t);if(i){var a,o=Gg(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function e6(e){e.Tu.forEach(function(e){e.next()})}var t6=function(){function e(t,n,r){jg(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return Zg(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Gg(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new q5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=q5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),n6=Zg(function e(t){jg(this,e),this.key=t}),r6=Zg(function e(t){jg(this,e),this.key=t}),i6=function(){function e(t,n){jg(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=y3(),this.mutatedKeys=y3(),this.Lu=w2(t),this.Uu=new G5(this.Lu)}return Zg(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new $5,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),h=C2(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Qu(l,h)||(r.track({type:2,doc:h}),v=!0,(u&&n.Lu(h,u)>0||c&&n.Lu(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return S1()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new q5(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new $5,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=y3(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new r6(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new n6(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=y3();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return q5.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),a6=Zg(function e(t,n,r){jg(this,e),this.query=t,this.targetId=n,this.view=r}),o6=Zg(function e(t){jg(this,e),this.key=t,this.Xu=!1}),s6=function(){function e(t,n,r,i,a,o){jg(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new o3(function(e){return k2(e)},m2),this.ec=new Map,this.nc=new Set,this.sc=new u0(Y1.comparator),this.ic=new Map,this.rc=new y4,this.oc={},this.uc=new Map,this.cc=f4.Rn(),this.onlineState="Unknown",this.ac=void 0}return Zg(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function u6(e,t){return c6.apply(this,arguments)}function c6(){return c6=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=L6(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,D4(r.localStore,g2(n));case 8:return s=e.sent,r.isPrimaryClient&&a5(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,l6(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),c6.apply(this,arguments)}function l6(e,t,n,r){return h6.apply(this,arguments)}function h6(){return h6=oB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=oB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,U4(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(T6(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,U4(t.localStore,n,!0);case 3:return a=e.sent,o=new i6(n,a.ji),s=o.Ku(a.documents),u=C3.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),T6(t,r,c.zu),l=new a6(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),h6.apply(this,arguments)}function f6(e,t){return d6.apply(this,arguments)}function d6(){return d6=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=O1(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!m2(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,L4(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),o5(r.remoteStore,i.targetId),P6(r,i.targetId)}).catch(e0);case 9:e.next=14;break;case 11:return P6(r,i.targetId),e.next=14,L4(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),d6.apply(this,arguments)}function v6(){return v6=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=F6(t),e.prev=1,e.next=4,function(e,t){var n,r,i=O1(e),a=G1.now(),o=t.reduce(function(e,t){return e.add(t.key)},y3());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=u3(),u=y3();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=Gg(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=j2(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new Y2(c.key,l,G0(l.value.mapValue),B2.exists(!0)))}}catch(h){u.e(h)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:h3(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),s=i,u=a.batchId,c=r,l=void 0,(l=s.oc[s.currentUser.toKey()])||(l=new u0(z1)),l=l.insert(u,c),s.oc[s.currentUser.toKey()]=l,e.next=9,R6(i,a.changes);case 9:return e.next=11,w5(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=H5(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}var s,u,c,l},e,null,[[1,13]])})),v6.apply(this,arguments)}function p6(e,t){return g6.apply(this,arguments)}function g6(){return g6=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=O1(t),e.prev=1,e.next=4,M4(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(P1(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?P1(n.Xu):e.removedDocuments.size>0&&(P1(n.Xu),n.Xu=!1))}),e.next=8,R6(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,e0(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),g6.apply(this,arguments)}function y6(e,t,n){var r=O1(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=O1(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=Gg(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&e6(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function m6(e,t,n){return k6.apply(this,arguments)}function k6(){return k6=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=O1(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new u0(Y1.comparator)).insert(o,$0.newNoDocument(o,$1.min())),u=y3().add(o),c=new _3($1.min(),new Map,new h0(z1),s,u),e.next=9,p6(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),A6(i),e.next=16;break;case 14:return e.next=16,L4(i.localStore,n,!1).then(function(){return P6(i,n,r)}).catch(e0);case 16:case"end":return e.stop()}},e)})),k6.apply(this,arguments)}function _6(e,t){return C6.apply(this,arguments)}function C6(){return C6=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=O1(t),i=n.batch.batchId,e.prev=1,e.next=4,R4(r.localStore,n);case 4:return a=e.sent,S6(r,i,null),E6(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,R6(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,e0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),C6.apply(this,arguments)}function w6(e,t,n){return b6.apply(this,arguments)}function b6(){return b6=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=O1(t),e.prev=1,e.next=4,function(e,t){var n=O1(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return P1(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,S6(i,n,r),E6(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,R6(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,e0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),b6.apply(this,arguments)}function E6(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function S6(e,t,n){var r=O1(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function P6(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Gg(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||O6(e,t)})}function O6(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(o5(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),A6(e))}function T6(e,t,n){var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof n6?(e.rc.addReference(a.key,t),I6(e,a)):a instanceof r6?(C1("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||O6(e,a.key)):S1()}}catch(o){i.e(o)}finally{i.f()}}function I6(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(C1("SyncEngine","New document in limbo: "+n),e.nc.add(r),A6(e))}function A6(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new Y1(j1.fromString(t)),r=e.cc.next();e.ic.set(r,new o6(n)),e.sc=e.sc.insert(n,r),a5(e.remoteStore,new a4(g2(h2(n.path)),r,2,i0.ot))}}function R6(e,t,n){return x6.apply(this,arguments)}function x6(){return x6=oB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=O1(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=P4.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=O1(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return n0.forEach(n,function(t){return n0.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return n0.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),r0(e.t0)){e.next=10;break}throw e.t0;case 10:C1("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Gg(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),x6.apply(this,arguments)}function M6(e,t){return N6.apply(this,arguments)}function N6(){return N6=oB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=O1(t)).currentUser.isEqual(n)){e.next=12;break}return C1("SyncEngine","User change. New user:",n.toKey()),e.next=5,I4(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new I1(T1.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,R6(r,i.Ki);case 12:case"end":return e.stop()}},e)})),N6.apply(this,arguments)}function D6(e,t){var n=O1(e),r=n.ic.get(t);if(r&&r.Xu)return y3().add(r.key);var i=y3(),a=n.ec.get(t);if(!a)return i;var o,s=Gg(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function L6(e){var t=O1(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=p6.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=D6.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=m6.bind(null,t),t.Zu.Go=X5.bind(null,t.eventManager),t.Zu.lc=J5.bind(null,t.eventManager),t}function F6(e){var t=O1(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=_6.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=w6.bind(null,t),t}var U6=function(){function e(){jg(this,e),this.synchronizeTabs=!1}return Zg(e,[{key:"initialize",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=W4(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new T4(e,t,n,r)}(this.persistence,new O4,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new b4(S4.Ms,this.wt)}},{key:"dc",value:function(e){return new B4}},{key:"terminate",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),V6=function(){function e(){jg(this,e)}return Zg(e,[{key:"initialize",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return y6(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=M6.bind(null,n.syncEngine),r.next=12,function(e,t){return U5.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new W5}},{key:"createDatastore",value:function(e){var t=W4(e.databaseInfo.databaseId),n=new q4(e.databaseInfo);return new X4(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return y6(o.syncEngine,e,0)},a=H4.V()?new H4:new z4,new e5(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new s6(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=oB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=O1(t),C1("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,r5(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),B6=function(){function e(t){jg(this,e),this.observer=t,this.muted=!1}return Zg(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),z6=function(){function e(t,n,r,i){var a=this;jg(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=y1.UNAUTHENTICATED,this.clientId=B1.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C1("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return C1("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return Zg(e,[{key:"getConfiguration",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new I1(T1.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new A1;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=H5(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function H6(e,t){return G6.apply(this,arguments)}function G6(){return G6=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),C1("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,I4(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),G6.apply(this,arguments)}function $6(e,t){return q6.apply(this,arguments)}function q6(){return q6=oB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,j6(t);case 3:return r=e.sent,C1("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return L5(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return L5(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),q6.apply(this,arguments)}function j6(e){return W6.apply(this,arguments)}function W6(){return W6=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return C1("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,H6(t,new U6);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),W6.apply(this,arguments)}function Z6(e){return Y6.apply(this,arguments)}function Y6(){return Y6=oB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return C1("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,$6(t,new V6);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),Y6.apply(this,arguments)}function K6(e){return Q6.apply(this,arguments)}function Q6(){return Q6=oB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z6(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=u6.bind(null,n.syncEngine),r.onUnlisten=f6.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),Q6.apply(this,arguments)}var X6=new Map;function J6(e,t,n){if(!n)throw new I1(T1.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function e8(e){if(!Y1.isDocumentKey(e))throw new I1(T1.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function t8(e){if(Y1.isDocumentKey(e))throw new I1(T1.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function n8(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":S1()}function r8(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new I1(T1.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=n8(e);throw new I1(T1.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var i8=function(){function e(t){var n;if(jg(this,e),void 0===t.host){if(void 0!==t.ssl)throw new I1(T1.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new I1(T1.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new I1(T1.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return Zg(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),a8=function(){function e(t,n,r){jg(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i8({}),this._settingsFrozen=!1,t instanceof b0?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new I1(T1.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new b0(e.options.projectId)}(t))}return Zg(e,[{key:"app",get:function(){if(!this._app)throw new I1(T1.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new I1(T1.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i8(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new x1;switch(e.type){case"gapi":var t=e.client;return P1(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new L1(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new I1(T1.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=X6.get(e))&&(C1("ComponentProvider","Removing Datastore"),X6.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();var o8=function(){function e(t,n,r){jg(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return Zg(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new u8(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),s8=function(){function e(t,n,r){jg(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return Zg(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),u8=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r,h2(i)))._path=i,a.type="collection",a}return Zg(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new o8(this.firestore,null,new Y1(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(s8);function c8(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ez(e),1===arguments.length&&(t=B1.I()),J6("doc","path",t),e instanceof a8){var a=j1.fromString.apply(j1,[t].concat(r));return e8(a),new o8(e,null,new Y1(a))}if(!(e instanceof o8||e instanceof u8))throw new I1(T1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(j1.fromString.apply(j1,[t].concat(r)));return e8(o),new o8(e.firestore,e instanceof u8?e.converter:null,new Y1(o))}var l8=function(){function e(){var t=this;jg(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Z4(this,"async_queue_retry"),this.Kc=function(){var e=j4();e&&C1("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=j4();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return Zg(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=j4();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new A1;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),r0(t.t0)){t.next=12;break}throw t.t0;case 12:C1("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,w1("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=z5.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&S1()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=Gg(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=Gg(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function h8(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var f8=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new l8,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return Zg(n,[{key:"_terminate",value:function(){return this._firestoreClient||v8(this),this._firestoreClient.terminate()}}]),n}(a8);function d8(e){return e._firestoreClient||v8(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function v8(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new w0(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new z6(e._authCredentials,e._appCheckCredentials,e._queue,a)}var p8=function(){function e(){jg(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new I1(T1.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Z1(n)}return Zg(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),g8=function(){function e(t){jg(this,e),this._byteString=t}return Zg(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(v0.fromBase64String(t))}catch(n){throw new I1(T1.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(v0.fromUint8Array(t))}}]),e}(),y8=Zg(function e(t){jg(this,e),this._methodName=t}),m8=function(){function e(t,n){if(jg(this,e),!isFinite(t)||t<-90||t>90)throw new I1(T1.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new I1(T1.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Zg(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return z1(this._lat,e._lat)||z1(this._long,e._long)}}]),e}(),k8=/^__.*__$/,_8=function(){function e(t,n,r){jg(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Zg(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Y2(e,this.data,this.fieldMask,t,this.fieldTransforms):new Z2(e,this.data,t,this.fieldTransforms)}}]),e}(),C8=function(){function e(t,n,r){jg(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Zg(e,[{key:"toMutation",value:function(e,t){return new Y2(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function w8(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw S1()}}var b8=function(){function e(t,n,r,i,a,o){jg(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return Zg(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return L8(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(w8(this.Zc)&&k8.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),E8=function(){function e(t,n,r){jg(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||W4(t)}return Zg(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new b8({Zc:e,methodName:t,ca:n,path:Z1.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function S8(e){var t=e._freezeSettings(),n=W4(e._databaseId);return new E8(e._databaseId,!!t.ignoreUndefinedProperties,n)}function P8(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);x8("Data must be an object, but it was:",o,r);var s,u,c=A8(r,o);if(a.merge)s=new d0(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=Gg(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=l.value,v=M8(t,d,n);if(!o.contains(v))throw new I1(T1.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));F8(h,v)||h.push(v)}}catch(p){f.e(p)}finally{f.f()}s=new d0(h),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new _8(new H0(c),s,u)}var O8=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(y8),T8=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"_toFieldTransform",value:function(e){return new U2(e.path,new A2)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(y8);function I8(e,t){if(R8(e=ez(e)))return x8("Unsupported field value:",t,e),A8(e,t);if(e instanceof y8)return function(e,t){if(!w8(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Gg(e);try{for(a.s();!(n=a.n()).done;){var o=I8(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=ez(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!S0(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?S2(t):E2(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=G1.fromDate(e);return{timestampValue:x3(t.wt,n)}}if(e instanceof G1){var r=new G1(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:x3(t.wt,r)}}if(e instanceof m8)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof g8)return{bytesValue:M3(t.wt,e._byteString)};if(e instanceof o8){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:L3(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(n8(e)))}(e,t)}function A8(e,t){var n={};return s0(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):o0(e,function(e,r){var i=I8(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function R8(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof G1||e instanceof m8||e instanceof g8||e instanceof o8||e instanceof y8)}function x8(e,t,n){if(!R8(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=n8(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function M8(e,t,n){if((t=ez(t))instanceof p8)return t._internalPath;if("string"==typeof t)return D8(e,t);throw L8("Field path arguments must be of type string or ",e,!1,void 0,n)}var N8=new RegExp("[~\\*/\\[\\]]");function D8(e,t,n){if(t.search(N8)>=0)throw L8("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Rg(p8,zg(t.split(".")))._internalPath}catch(r){throw L8("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function L8(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new I1(T1.INVALID_ARGUMENT,s+e+u)}function F8(e,t){return e.some(function(e){return e.isEqual(t)})}var U8=function(){function e(t,n,r,i,a){jg(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return Zg(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new o8(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new V8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(B8("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),V8=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"data",value:function(){return xg(Bg(n.prototype),"data",this).call(this)}}]),n}(U8);function B8(e,t){return"string"==typeof t?D8(e,t):t instanceof p8?t._internalPath:t._delegate._internalPath}var z8=function(){function e(t,n){jg(this,e),this.hasPendingWrites=t,this.fromCache=n}return Zg(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),H8=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return Zg(n,[{key:"exists",value:function(){return xg(Bg(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new G8(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(B8("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(U8),G8=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return xg(Bg(n.prototype),"data",this).call(this,e)}}]),n}(H8),$8=function(){function e(t,n,r,i){jg(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new z8(i.hasPendingWrites,i.fromCache),this.query=r}return Zg(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new G8(n._firestore,n._userDataWriter,r.key,r,new z8(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new I1(T1.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new G8(e._firestore,e._userDataWriter,t.doc.key,t.doc,new z8(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new G8(e._firestore,e._userDataWriter,t.doc.key,t.doc,new z8(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:q8(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function q8(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return S1()}}function j8(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new I1(T1.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var W8=Zg(function e(){jg(this,e)});var Z8=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return Zg(n,[{key:"_apply",value:function(e){var t,n,r,i=S8(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new I1(T1.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){X8(o,a);var u,c=[],l=Gg(o);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(Q8(r,e,h))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=Q8(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||X8(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return I8(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var f=K0.create(i,a,s);return function(e,t){if(t.ht()){var n=d2(e);if(null!==n&&!n.isEqual(t.field))throw new I1(T1.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=f2(e);null!==r&&J8(0,t.field,r)}var i=function(e,t){var n,r=Gg(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new I1(T1.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,f),f}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new s8(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new l2(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(W8);var Y8=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return Zg(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new I1(T1.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new I1(T1.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new o2(t,n);return function(e,t){if(null===f2(e)){var n=d2(e);null!==n&&J8(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new s8(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new l2(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(W8);var K8=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return Zg(n,[{key:"_apply",value:function(e){return new s8(e.firestore,e.converter,y2(e._query,this.ma,this.ga))}}]),n}(W8);function Q8(e,t,n){if("string"==typeof(n=ez(n))){if(""===n)throw new I1(T1.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v2(t)&&-1!==n.indexOf("/"))throw new I1(T1.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(j1.fromString(n));if(!Y1.isDocumentKey(r))throw new I1(T1.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return N0(e,new Y1(r))}if(n instanceof o8)return N0(e,n._key);throw new I1(T1.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(n8(n),"."))}function X8(e,t){if(!Array.isArray(e)||0===e.length)throw new I1(T1.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new I1(T1.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function J8(e,t,n){if(!n.isEqual(t))throw new I1(T1.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function e7(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var t7=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).firestore=e,r}return Zg(n,[{key:"convertBytes",value:function(e){return new g8(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new o8(this.firestore,null,t)}}]),n}(function(){function e(){jg(this,e)}return Zg(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(O0(e)){case 0:return null;case 1:return e.booleanValue;case 2:return y0(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(m0(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw S1()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return o0(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new m8(y0(e.latitude),y0(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=_0(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(C0(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=g0(e);return new G1(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=j1.fromString(e);P1(t4(n));var r=new b0(n.get(1),n.get(3)),i=new Y1(n.popFirst(5));return r.isEqual(t)||w1("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function n7(e,t){return n=d8(e),r=t,i=new A1,n.asyncQueue.enqueueAndForget(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return v6.apply(this,arguments)},e.next=3,function(e){return Z6(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function r7(e,t,n){var r=n.docs.get(t._key),i=new t7(e);return new H8(e,i,t._key,r,new z8(n.hasPendingWrites,n.fromCache),t.converter)}function i7(){return new T8("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];m1="9.9.0",Fz(new rz("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new f8(i,new N1(e.getProvider("auth-internal")),new U1(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),$z(g1,"3.4.12",e),$z(g1,"3.4.12","esm2017")}();var a7=Zg(function e(t){return jg(this,e),t}),o7=new K_("angularfire2.firestore-instances");function s7(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new a7(r)}}var u7={provide:Zg(function e(){return jg(this,e),Fq("firestore")}),deps:[[new EC,o7]]},c7={provide:a7,useFactory:function(e,t){var n=Lq("firestore",e,t);return n&&new a7(n)},deps:[[new EC,o7],Zq]},l7=function(){var e=Zg(function e(){jg(this,e),$z("angularfire",Iq.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[c7,u7]}),e}(),h7=Wq(function(e,t){var n=r8(e.firestore,f8),r=c8(e),i=e7(e.converter,t);return n7(n,[P8(S8(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,B2.exists(!1))]).then(function(){return r})},!0),f7=Wq(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ez(e),J6("collection","path",t),e instanceof a8){var a=j1.fromString.apply(j1,[t].concat(r));return t8(a),new u8(e,null,a)}if(!(e instanceof o8||e instanceof u8))throw new I1(T1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(j1.fromString.apply(j1,[t].concat(r)));return t8(o),new u8(e.firestore,null,o)},!0),d7=Wq(function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=r8(e,a8))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&b1("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=y1.MOCK_USER;else{o=EB(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new I1(T1.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new y1(u)}e._authCredentials=new M1(new R1(o,s))}},!0),v7=Wq(function(e){return n7(r8(e.firestore,f8),[new t3(e._key,B2.none())])},!0),p7=Wq(c8,!0),g7=Wq(function(e){e=r8(e,o8);var t=r8(e.firestore,f8);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new A1;return e.asyncQueue.enqueueAndForget(oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new B6({next:function(a){t.enqueueAndForget(function(){return K5(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new I1(T1.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new I1(T1.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new t6(h2(n.path),a,{includeMetadataChanges:!0,Du:!0});return Z5(e,o)},i.next=3,K6(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(d8(t),e._key).then(function(n){return r7(t,e,n)})},!0),y7=Wq(function(e){e=r8(e,s8);var t=r8(e.firestore,f8),n=d8(t),r=new t7(t);return j8(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new A1;return e.asyncQueue.enqueueAndForget(oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new B6({next:function(n){t.enqueueAndForget(function(){return K5(e,o)}),n.fromCache&&"server"===r.source?i.reject(new I1(T1.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new t6(n,a,{includeMetadataChanges:!0,Du:!0});return Z5(e,o)},i.next=3,K6(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new $8(t,r,e,n)})},!0),m7=Wq(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hz();return Uz(e,"firestore").getImmediate()},!0),k7=Wq(function(e){return function(e,t){if(t<=0)throw new I1(T1.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new K8("limit",e,"F")},!0),_7=Wq(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=ez(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||h8(n[u])||(s=n[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(h8(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof o8)l=r8(e.firestore,f8),h=h2(e._key.path),c={next:function(t){n[u]&&n[u](r7(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=r8(e,s8);l=r8(v.firestore,f8),h=v._query;var p=new t7(l);c={next:function(e){n[u]&&n[u](new $8(l,p,v,e))},error:n[u+1],complete:n[u+2]},j8(e._query)}return function(e,t,n,r){var i=new B6(r),a=new t6(t,i,n);return e.asyncQueue.enqueueAndForget(oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Z5,t.next=3,K6(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=K5,t.next=3,K6(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(d8(l),h,f,c)},!0),C7=Wq(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=B8("orderBy",e);return new Y8(r,n)},!0),w7=Wq(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),b7=Wq(function(e,t,n){e=r8(e,o8);var r=r8(e.firestore,f8),i=e7(e.converter,t,n);return n7(r,[P8(S8(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,B2.none())])},!0),E7=Wq(function(e,t,n){e=r8(e,o8);for(var r,i=r8(e.firestore,f8),a=S8(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=ez(t))||t instanceof p8?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[M8(t,r,n)],u=[i];if(a.length%2!=0)throw new I1(T1.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(M8(t,a[c])),u.push(a[c+1]);for(var l=[],h=H0.empty(),f=s.length-1;f>=0;--f)if(!F8(l,s[f])){var d=s[f],v=u[f];v=ez(v);var p=o.ia(d);if(v instanceof O8)l.push(d);else{var g=I8(v,p);null!=g&&(l.push(d),h.set(d,g))}}var y=new d0(l);return new C8(h,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);x8("Data must be an object, but it was:",i,r);var a=[],o=H0.empty();o0(r,function(e,r){var s=D8(t,e,n);r=ez(r);var u=i.ia(s);if(r instanceof O8)a.push(s);else{var c=I8(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new d0(a);return new C8(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),n7(i,[r.toMutation(e._key,B2.exists(!0))])},!0),S7=Wq(function(e,t,n){var r=t,i=B8("where",e);return new Z8(i,r,n)},!0),P7=function(){var e=function(){function e(t,n){jg(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=f7(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return Zg(e,[{key:"create",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h7(t.collection,e);case 2:return n.abrupt("return",n.sent.id);case 3:case"end":return n.stop()}},n)}))()}},{key:"read",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g7(p7(t.collection,e));case 2:return r=n.sent,n.abrupt("return",r.exists()?fB.of(sB.getNonNullable(r.data())):fB.empty());case 4:case"end":return n.stop()}},n)}))()}},{key:"exists",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.read(e);case 2:return n.abrupt("return",n.sent.isPresent());case 3:case"end":return n.stop()}},n)}))()}},{key:"update",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",E7(p7(n.collection,e),t));case 1:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){return v7(p7(this.collection,e))}},{key:"set",value:function(t,n){return uB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),b7(p7(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return _7(p7(this.collection,e),function(e){t(fB.ofNullable(e.data()))})}},{key:"findWhere",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,y7(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this,a=this.constructQuery(t,r);return _7(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(uB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(uB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(uB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))})}},{key:"constructQuery",value:function(e,t,n){var r=w7(this.collection);null!=t&&(r=w7(r,C7(t))),null!=n&&(r=w7(r,k7(n)));var i,a=Gg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=w7(r,S7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,r,e)}return Zg(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),O7=function(){function e(){jg(this,e)}return Zg(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&hB(this.get(),e.get())}}],[{key:"success",value:function(e){return new T7(e)}},{key:"failure",value:function(e){return new I7(e)}}]),e}(),T7=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).value=e,r}return Zg(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return fB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(O7),I7=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).reason=e,r}return Zg(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return fB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(O7),A7=function(){function e(t){jg(this,e),this.reason=t}return Zg(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?O7.success(e):O7.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return O7.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();A7.SUCCESS=new A7(null);var R7=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,"errors",e)}return Zg(n,[{key:"findErrors",value:function(e,t,n,r){return this.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}}]),n}(P7);return e.\u0275fac=function(t){return new(t||e)(gC(a7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),x7=Ig(5378),M7=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,x7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),N7=function(){function t(e,n,r){jg(this,t),this.errorDAO=e,this.router=n,this.messageDisplayer=r,t.setSingletonInstance(this)}return Zg(t,[{key:"logError",value:function(t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(e||(e=bg(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.errorDAO.findErrors(t,o,n,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:t,route:o,message:n,firstEncounter:i7(),lastEncounter:i7(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:i7(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(e){t.singleton=fB.of(e)}},{key:"logErrorAndFail",value:function(e,n,r){throw t.logError(e,n,r),new Error("".concat(e,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),A7.failure(e+": "+t)}}]),t}();function D7(e,t){if(!1===e)throw N7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}N7.singleton=fB.empty(),N7.\u0275fac=function(e){return new(e||N7)(gC(R7),gC(YL),gC(M7))},N7.\u0275prov=vm({token:N7,factory:N7.\u0275fac,providedIn:"root"});var L7=Zg(function e(t){jg(this,e),this.value=t});L7.HARD_DRAW=new L7(0),L7.RESIGN=new L7(1),L7.ESCAPE=new L7(2),L7.VICTORY=new L7(3),L7.TIMEOUT=new L7(4),L7.UNACHIEVED=new L7(5),L7.AGREED_DRAW_BY_ZERO=new L7(6),L7.AGREED_DRAW_BY_ONE=new L7(7);var F7=function(){function e(t,n){jg(this,e),this.id=t,this.data=n}return Zg(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===L7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===L7.AGREED_DRAW_BY_ZERO.value||this.data.result===L7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===L7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(D7(this.data.result===L7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),sB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===L7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===L7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===L7.RESIGN.value}},{key:"getWinner",value:function(){return fB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return fB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Sg(Sg({},this.data),{},{winner:t,loser:n}))}}]),e}(),U7=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),r=t.call(this,"parties",e),uB(n.VERBOSE,"PartDAO.constructor"),r}return Zg(n,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Sg(Sg({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"observeActiveParts",value:function(e){return this.observingWhere([["result","==",L7.UNACHIEVED.value]],e)}},{key:"userHasActivePart",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["playerZero","==",e],["result","==",L7.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.findWhere([["playerOne","==",e],["result","==",L7.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),n}(P7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(a7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),V7=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),r=t.call(this,"chats",e),uB(n.VERBOSE,"ChatDAO.constructor"),r}return Zg(n,[{key:"addMessage",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}}]),n}(P7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(a7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),B7=function(){var e=Zg(function e(){jg(this,e)});return e.CANNOT_SEND_MESSAGE=function(){return $localize(t||(t=bg(["You're not allowed to send a message here."])))},e.FORBIDDEN_MESSAGE=function(){return $localize(n||(n=bg(["This message is forbidden."])))},e}(),z7=function(){var e=function(){function e(t){jg(this,e),this.chatDAO=t,this.followedChatId=fB.empty(),uB(e.VERBOSE,"ChatService.constructor")}return Zg(e,[{key:"startObserving",value:function(t,n){uB(e.VERBOSE,"ChatService.startObserving "+t),this.followedChatId.isAbsent()?(uB(e.VERBOSE,"[start watching chat "+t),this.followedChatId=fB.of(t),this.followedChatUnsubscribe=this.chatDAO.subscribeToMessages(t,n)):this.followedChatId.equalsValue(t)?N7.logErrorAndFail("ChatService","Already observing same chat",{chatId:t}):N7.logErrorAndFail("ChatService","Already observing another chat",{chatId:t,followedChatId:this.followedChatId.get()})}},{key:"stopObserving",value:function(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");uB(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=fB.empty(),this.followedChatUnsubscribe()}},{key:"isObserving",value:function(){return this.followedChatId.isPresent()}},{key:"deleteChat",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(uB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.followedChatId.isAbsent()){i.next=2;break}return i.abrupt("return",A7.failure("Cannot send message if not observing chat"));case 2:if(a=r.followedChatId.get(),!1!==r.userCanSendMessage(e.name,a)){i.next=5;break}return i.abrupt("return",A7.failure(B7.CANNOT_SEND_MESSAGE()));case 5:if(!r.isForbiddenMessage(t)){i.next=7;break}return i.abrupt("return",A7.failure(B7.FORBIDDEN_MESSAGE()));case 7:return o={content:t,sender:e,postedTime:i7(),currentTurn:n},i.next=10,r.chatDAO.addMessage(a,o);case 10:return i.abrupt("return",A7.SUCCESS);case 11:case"end":return i.stop()}},i)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}},{key:"ngOnDestroy",value:function(){this.isObserving()&&this.stopObserving()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(V7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),H7=Zg(function e(t,n,r){jg(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),G7=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),r=t.call(this,n.COLLECTION_NAME,e),uB(n.VERBOSE,"UserDAO.constructor"),r}return Zg(n,[{key:"usernameIsAvailable",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markVerified",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUserByUsername",value:function(e,t){return this.observingWhere([["username","==",e]],t)}},{key:"observeActiveUsers",value:function(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}},{key:"updatePresenceToken",value:function(e){return this.update(e,{last_changed:i7()})}}]),n}(P7);return e.VERBOSE=!1,e.COLLECTION_NAME="joueurs",e.\u0275fac=function(t){return new(t||e)(gC(a7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),$7=function(){var e=function(){function e(t){jg(this,e),this.userDAO=t,this.activeUsersBS=new rN([]),this.activeUsersObs=this.activeUsersBS.asObservable()}return Zg(e,[{key:"startObserving",value:function(){var t=this;uB(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");var n=new H7(function(n){var r;uB(e.VERBOSE,"our DAO gave us "+n.length+" new user(s)");var i=(r=t.activeUsersBS.value).concat.apply(r,zg(n));t.activeUsersBS.next(t.sort(i))},function(n){var r=t.activeUsersBS.value;uB(e.VERBOSE,"our DAO updated "+n.length+" user(s)");var i,a=Gg(n);try{var o=function(){var e=i.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)}),r=t.sort(r)};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}t.activeUsersBS.next(r)},function(e){var n=t.activeUsersBS.value.filter(function(t){return!e.some(function(e){return e.id===t.id})});t.activeUsersBS.next(t.sort(n))});this.unsubscribe=this.userDAO.observeActiveUsers(n)}},{key:"stopObserving",value:function(){this.unsubscribe(),this.activeUsersBS.next([])}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=sB.getNonNullable(e.data).last_changed,r=sB.getNonNullable(n).seconds,i=sB.getNonNullable(t.data).last_changed;return r-sB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(G7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),q7=function(){var e=function(){function e(t,n){jg(this,e),this.activeUsersService=t,this.userDAO=n}return Zg(e,[{key:"getActiveUsersObs",value:function(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}},{key:"unSubFromActiveUsersObs",value:function(){this.activeUsersService.stopObserving()}},{key:"observeUserByUsername",value:function(e,t){return this.userDAO.observeUserByUsername(e,t)}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastChanged",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",fB.empty());case 5:return i=r.get().last_changed,n.abrupt("return",(D7(null!=i,"should not receive a last_changed equal to null"),fB.of(i)));case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC($7),gC(G7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),j7=function(e){Ng(n,e);var t=Lg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Eq;return jg(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return Zg(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),xg(Bg(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Cy),W7="@firebase/database",Z7="",Y7=function(){function e(t){jg(this,e),this.domStorage_=t,this.prefix_="firebase:"}return Zg(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),FB(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:LB(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),K7=function(){function e(){jg(this,e),this.cache_={},this.isInMemoryStorage=!0}return Zg(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return VB(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),Q7=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Y7(t)}}catch(n){}return new K7},X7=Q7("localStorage"),J7=Q7("sessionStorage"),e9=new dz("@firebase/database"),t9=function(){var e=1;return function(){return e++}}(),n9=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,dB(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new ZB;n.update(t);var r=n.digest();return gB.encodeByteArray(r)},r9=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=e.apply(null,r):t+="object"==typeof r?FB(r):r,t+=" "}return t},i9=null,a9=!0,o9=function(){if(!0===a9&&(a9=!1,null===i9&&!0===J7.get("logging_enabled")&&(dB(!0,"Can't turn on custom loggers persistently."),e9.logLevel=uz.VERBOSE,i9=e9.log.bind(e9))),i9){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=r9.apply(null,t);i9(r)}},s9=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];o9.apply(void 0,[e].concat(n))}},u9=function(){var e="FIREBASE INTERNAL ERROR: "+r9.apply(void 0,arguments);e9.error(e)},c9=function(){var e="FIREBASE FATAL ERROR: ".concat(r9.apply(void 0,arguments));throw e9.error(e),new Error(e)},l9=function(){var e="FIREBASE WARNING: "+r9.apply(void 0,arguments);e9.warn(e)},h9=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},f9="[MIN_NAME]",d9="[MAX_NAME]",v9=function(e,t){if(e===t)return 0;if(e===f9||t===d9)return-1;if(t===f9||e===d9)return 1;var n=w9(e),r=w9(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},p9=function(e,t){return e===t?0:e<t?-1:1},g9=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+FB(t))},y9=function e(t){if("object"!=typeof t||null===t)return FB(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=FB(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},m9=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function k9(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var _9=function(e){dB(!h9(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,1-o)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},C9=new RegExp("^-?(0*)\\d{1,10}$"),w9=function(e){if(C9.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},b9=function(e){try{e()}catch(t){setTimeout(function(){throw l9("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},E9=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},S9=function(){function e(t,n){var r=this;jg(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null==n?void 0:n.getImmediate({optional:!0}),this.appCheck||null==n||n.get().then(function(e){return r.appCheck=e})}return Zg(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(n,r){setTimeout(function(){t.appCheck?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(function(t){return t.addTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){l9('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" are invalid. This usually indicates your app was not initialized correctly.'))}}]),e}(),P9=function(){function e(t,n,r){var i=this;jg(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(function(e){return i.auth_=e})}return Zg(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(o9("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(n,r){setTimeout(function(){t.auth_?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)})}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',l9(e)}}]),e}(),O9=function(){var e=function(){function e(t){jg(this,e),this.accessToken=t}return Zg(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();return e.OWNER="owner",e}(),T9=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,I9="long_polling",A9=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];jg(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=X7.get("host:"+t)||this._host}return Zg(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&X7.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){return"".concat(this.secure?"https://":"http://").concat(this.host,"/").concat(this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"")}}]),e}();function R9(e,t,n){var r;if(dB("string"==typeof t,"typeof type must == string"),dB("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==I9)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return k9(n,function(e,t){i.push(e+"="+t)}),r+i.join("&")}var x9=function(){function e(){jg(this,e),this.counters_={}}return Zg(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;VB(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return _B(this.counters_)}}]),e}(),M9={},N9={};function D9(e){var t=e.toString();return M9[t]||(M9[t]=new x9),M9[t]}var L9=function(){function e(t){jg(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return Zg(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this,r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&b9(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),F9=function(){function e(t,n,r,i,a,o,s){var u=this;jg(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=s9(t),this.stats_=D9(n),this.urlFn=function(e){return u.appCheckToken&&(e.ac=u.appCheckToken),R9(n,I9,e)}}return Zg(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new L9(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new U9(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=a,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&T9.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=FB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=yB(t),r=m9(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},{key:"incrementIncomingBytes_",value:function(e){var t=FB(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!(!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),e}(),U9=function(){function e(t,n,r,i){jg(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=t9(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){o9("frame writing exception"),s.stack&&o9(s.stack),o9(s)}}return Zg(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})}},{key:"addTag",value:function(e,t){var n=this;setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;(!e||"loaded"===e||"complete"===e)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){o9("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||o9("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),V9=null;"undefined"!=typeof MozWebSocket?V9=MozWebSocket:"undefined"!=typeof WebSocket&&(V9=WebSocket);var B9=function(){var e=function(){function e(t,n,r,i,a,o,s){jg(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=s9(this.connId),this.stats_=D9(n),this.connURL=e.connectionURL_(n,o,s,i,r),this.nodeAdmin=n.nodeAdmin}return Zg(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,X7.set("previous_websocket_failure",!0);try{var r;this.mySock=new V9(this.connURL,[],undefined)}catch(r){this.log_("Error instantiating WebSocket.");var i=r.message||r.data;return i&&this.log_(i),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){X7.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=LB(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(dB(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=FB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=m9(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={v:"5"};return"undefined"!=typeof location&&location.hostname&&T9.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a.ac=r),i&&(a.p=i),R9(e,"websocket",a)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==V9&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return X7.isInMemoryStorage||!0===X7.get("previous_websocket_failure")}}]),e}();return e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),z9=function(){var e=function(){function e(t){jg(this,e),this.initTransports_(t)}return Zg(e,[{key:"initTransports_",value:function(t){var n=B9&&B9.isAvailable(),r=n&&!B9.previouslyFailed();if(t.webSocketOnly&&(n||l9("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[B9];else{var i,a=this.transports_=[],o=Gg(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var s=i.value;s&&s.isAvailable()&&a.push(s)}}catch(u){o.e(u)}finally{o.f()}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[F9,B9]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();return e.globalTransportInitialized_=!1,e}(),H9=function(){function e(t,n,r,i,a,o,s,u,c,l){jg(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=s9("c:"+this.id+":"),this.transportManager_=new z9(n),this.log_("Connection created"),this.start_()}return Zg(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=E9(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){this.sendData_({t:"d",d:e})}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=g9("t",e),n=g9("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=g9("t",e),n=g9("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=g9("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?u9("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):u9("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&l9("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),E9(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):E9(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(X7.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),G9=function(){function e(){jg(this,e)}return Zg(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),$9=function(){function e(t){jg(this,e),this.allowedEvents_=t,this.listeners_={},dB(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return Zg(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=zg(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){dB(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)}}]),e}(),q9=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!PB()&&(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return Zg(n,[{key:"getInitialEvent",value:function(e){return dB("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}($9),j9=function(){function e(t,n){if(jg(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return Zg(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function W9(){return new j9("")}function Z9(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Y9(e){return e.pieces_.length-e.pieceNum_}function K9(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new j9(e.pieces_,t)}function Q9(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function X9(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function J9(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new j9(t,0)}function eee(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof j9)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new j9(n,0)}function tee(e){return e.pieceNum_>=e.pieces_.length}function nee(e,t){var n=Z9(e),r=Z9(t);if(null===n)return t;if(n===r)return nee(K9(e),K9(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function ree(e,t){for(var n=X9(e,0),r=X9(t,0),i=0;i<n.length&&i<r.length;i++){var a=v9(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function iee(e,t){if(Y9(e)!==Y9(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function aee(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(Y9(e)>Y9(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var oee=Zg(function e(t,n){jg(this,e),this.errorPrefix_=n,this.parts_=X9(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=XB(this.parts_[r]);see(this)});function see(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+uee(e))}function uee(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var cee,lee,hee=function(e){Ng(n,e);var t=Lg(n);function n(){var e,r,i;return jg(this,n),e=t.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(i="visibilitychange",r="hidden"):void 0!==document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):void 0!==document.msHidden?(i="msvisibilitychange",r="msHidden"):void 0!==document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))},!1),e}return Zg(n,[{key:"getInitialEvent",value:function(e){return dB("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}($9),fee=1e3,dee=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s,u,c){var l;if(jg(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=s9("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=fee,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return hee.getInstance().on("visible",l.onVisible_,Ug(l)),-1===e.host.indexOf("fblocal")&&q9.getInstance().on("online",l.onOnline_,Ug(l)),Fg(l)}return Zg(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(FB(i)),dB(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new bB,n={p:e._path.toString(),q:e._queryObject};return this.outstandingGets_.push({action:"g",request:n,onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),dB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),dB(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,function(o){var s=o.d,u=o.s;n.warnOnListenWarnings_(s,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))})}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=UB(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=UB(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)})}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),dB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)})}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+FB(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):u9("Unrecognized action received from server: "+FB(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;dB(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=fee,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=fee,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=fee),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var r,i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.shouldReconnect_()){t.next=21;break}return e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null,r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),a=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+n.nextConnectionId_++,s=e.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,a())},e.realtime_={close:l,sendRequest:function(e){dB(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)}},h=e.forceTokenRefresh_,e.forceTokenRefresh_=!1,t.prev=8,t.next=11,Promise.all([e.authTokenProvider_.getToken(h),e.appCheckTokenProvider_.getToken(h)]);case 11:f=t.sent,d=Og(f,2),v=d[0],p=d[1],u?o9("getToken() completed but was canceled"):(o9("getToken() completed. Creating connection."),e.authToken_=v&&v.accessToken,e.appCheckToken_=p&&p.token,c=new H9(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,a,function(t){l9(t+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},s)),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(8),e.log_("Failed to get token: "+t.t0),u||(e.repoInfo_.nodeAdmin&&l9(t.t0),l());case 21:case"end":return t.stop()}},t,null,[[8,18]])}))()}},{key:"interrupt",value:function(e){o9("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){o9("Resuming connection for reason: "+e),delete this.interruptReasons_[e],zB(this.interruptReasons_)&&(this.reconnectDelay_=fee,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map(function(e){return y9(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new j9(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){o9("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){o9("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=Gg(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=Gg(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var s=0;s<this.outstandingGets_.length;s++)this.outstandingGets_[s]&&this.sendGet_(s)}},{key:"sendConnectStats_",value:function(){var e={};e["sdk.js."+Z7.replace(/\./g,"-")]=1,PB()?e["framework.cordova"]=1:TB()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=q9.getInstance().currentlyOnline();return zB(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&VB(e,"w")){var n=BB(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();l9("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ".concat(r," at ").concat(i," to your security rules for better performance."))}}}}]),n}(G9);return e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(),vee=function(){function e(t,n){jg(this,e),this.name=t,this.node=n}return Zg(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),pee=function(){function e(){jg(this,e)}return Zg(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new vee(f9,e),r=new vee(f9,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return vee.MIN}}]),e}(),gee=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"compare",value:function(e,t){return v9(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw vB("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return vee.MIN}},{key:"maxPost",value:function(){return new vee(d9,cee)}},{key:"makePost",value:function(e,t){return dB("string"==typeof e,"KeyIndex indexValue must always be a string."),new vee(e,cee)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return cee},set:function(e){cee=e}}]),n}(pee),yee=new gee,mee=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;jg(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return Zg(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),kee=function(){var e=function(){function e(t,n,r,i,a){jg(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:_ee.EMPTY_NODE,this.right=null!=a?a:_ee.EMPTY_NODE}return Zg(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return _ee.EMPTY_NODE;var e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return _ee.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();return e.RED=!0,e.BLACK=!1,e}(),_ee=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;jg(this,e),this.comparator_=t,this.root_=n}return Zg(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,kee.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,kee.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new mee(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new mee(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new mee(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new mee(this.root_,null,this.comparator_,!0,e)}}]),e}();function Cee(e,t){return v9(e.name,t.name)}function wee(e,t){return v9(e,t)}_ee.EMPTY_NODE=new(function(){function e(){jg(this,e)}return Zg(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new kee(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}());var bee,Eee,See,Pee,Oee,Tee=function(e){return"number"==typeof e?"number:"+_9(e):"string:"+e},Iee=function(e){if(e.isLeafNode()){var t=e.val();dB("string"==typeof t||"number"==typeof t||"object"==typeof t&&VB(t,".sv"),"Priority must be a string or number.")}else dB(e===lee||e.isEmpty(),"priority of unexpected type.");dB(e===lee||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Aee=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;jg(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,dB(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Iee(this.priorityNode_)}return Zg(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return tee(t)?this:".priority"===Z9(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=Z9(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(dB(".priority"!==r||1===Y9(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(K9(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Tee(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?_9(this.value_):this.value_,this.lazyHash_=n9(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(dB(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return dB(i>=0,"Unknown leaf type: "+n),dB(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return bee},set:function(e){bee=e}}]),e}();return e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),Ree=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?v9(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return vee.MIN}},{key:"maxPost",value:function(){return new vee(d9,new Aee("[PRIORITY-POST]",See))}},{key:"makePost",value:function(e,t){var n=Eee(e);return new vee(t,new Aee("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(pee)),xee=Math.log(2),Mee=function(){function e(t){var n=this;jg(this,e),this.count=parseInt(Math.log(t+1)/xee,10),this.current_=this.count-1;var r=parseInt(Array(n.count+1).join("1"),2);this.bits_=t+1&r}return Zg(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),Nee=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,s=i-r;if(0===s)return null;if(1===s)return a=e[r],o=n?n(a):a,new kee(o,a.node,kee.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,i);return a=e[u],o=n?n(a):a,new kee(o,a.node,kee.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],h=n?n(l):l;u(new kee(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,kee.BLACK):(s(h,kee.BLACK),s(h,kee.RED))}return a}(new Mee(e.length));return new _ee(r||t,a)},Dee={},Lee=function(){function e(t,n){jg(this,e),this.indexes_=t,this.indexSet_=n}return Zg(e,[{key:"get",value:function(e){var t=BB(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof _ee?t:null}},{key:"hasIndex",value:function(e){return VB(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){dB(t!==yee,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(vee.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?Nee(i,t.getCompare()):Dee;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var l=Object.assign({},this.indexes_);return l[u]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(HB(this.indexes_,function(e,i){var a=BB(r.indexSet_,i);if(dB(a,"Missing index implementation for "+i),e===Dee){if(a.isDefinedOn(t.node)){for(var o=[],s=n.getIterator(vee.Wrap),u=s.getNext();u;)u.name!==t.name&&o.push(u),u=s.getNext();return o.push(t),Nee(o,a.getCompare())}return Dee}var c=n.get(t.name),l=e;return c&&(l=l.remove(new vee(t.name,c))),l.insert(t,t.node)}),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(HB(this.indexes_,function(e){if(e===Dee)return e;var r=n.get(t.name);return r?e.remove(new vee(t.name,r)):e}),this.indexSet_)}}],[{key:"Default",get:function(){return dB(Dee&&Ree,"ChildrenNode.ts has not been loaded"),Pee=Pee||new e({".priority":Dee},{".priority":Ree})}}]),e}(),Fee=function(){var e=function(){function e(t,n,r){jg(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Iee(this.priorityNode_),this.children_.isEmpty()&&dB(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Zg(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||Oee}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Oee:t}},{key:"getChild",value:function(e){var t=Z9(e);return null===t?this:this.getImmediateChild(t).getChild(K9(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(dB(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new vee(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?Oee:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=Z9(e);if(null===n)return t;dB(".priority"!==Z9(e)||1===Y9(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(K9(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(Ree,function(o,s){n[o]=s.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1}),!t&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Tee(this.getPriority().val())+":"),this.forEachChild(Ree,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":n9(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new vee(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new vee(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new vee(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,vee.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,vee.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uee?-1:0}},{key:"withIndex",value:function(t){if(t===yee||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===yee||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Ree),r=t.getIterator(Ree),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===yee?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return Oee||(Oee=new e(new _ee(wee),null,Lee.Default))}}]),e}();return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Uee=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,new _ee(wee),Fee.EMPTY_NODE,Lee.Default)}return Zg(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return Fee.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(Fee));function Vee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return Fee.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),dB(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Aee(e,Vee(t));if(e instanceof Array){var n=Fee.EMPTY_NODE;return k9(e,function(t,r){if(VB(e,t)&&"."!==t.substring(0,1)){var i=Vee(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(t,i))}}),n.updatePriority(Vee(t))}var r=[],i=!1;if(k9(e,function(e,t){if("."!==e.substring(0,1)){var n=Vee(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new vee(e,n)))}}),0===r.length)return Fee.EMPTY_NODE;var a=Nee(r,Cee,function(e){return e.name},wee);if(i){var o=Nee(r,Ree.getCompare());return new Fee(a,Vee(t),new Lee({".priority":o},{".priority":Ree}))}return new Fee(a,Vee(t),Lee.Default)}Object.defineProperties(vee,{MIN:{value:new vee(f9,Fee.EMPTY_NODE)},MAX:{value:new vee(d9,Uee)}}),gee.__EMPTY_NODE=Fee.EMPTY_NODE,Aee.__childrenNodeConstructor=Fee,function(e){lee=e}(Uee),function(e){See=e}(Uee),function(e){Eee=e}(Vee);var Bee=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).indexPath_=e,dB(!tee(e)&&".priority"!==Z9(e),"Can't create PathIndex with empty path or .priority key"),r}return Zg(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?v9(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=Vee(e),r=Fee.EMPTY_NODE.updateChild(this.indexPath_,n);return new vee(t,r)}},{key:"maxPost",value:function(){var e=Fee.EMPTY_NODE.updateChild(this.indexPath_,Uee);return new vee(d9,e)}},{key:"toString",value:function(){return X9(this.indexPath_,0).join("/")}}]),n}(pee),zee=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?v9(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return vee.MIN}},{key:"maxPost",value:function(){return vee.MAX}},{key:"makePost",value:function(e,t){var n=Vee(e);return new vee(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(pee));function Hee(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var Gee=function(){function e(){jg(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ree}return Zg(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return dB(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return dB(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:f9}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return dB(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return dB(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:d9}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return dB(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===Ree}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function $ee(e){var t,n={};return e.isDefault()||(e.index_===Ree?t="$priority":e.index_===zee?t="$value":e.index_===yee?t="$key":(dB(e.index_ instanceof Bee,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=FB(t),e.startSet_&&(n.startAt=FB(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+FB(e.indexStartName_))),e.endSet_&&(n.endAt=FB(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+FB(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function qee(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Ree&&(t.i=e.index_.toString()),t}var jee=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=s9("p:rest:"),o.listens_={},o}return Zg(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=$ee(e._queryParams);this.restRequest_(o+".json",c,function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),BB(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=$ee(e._queryParams),r=e._path.toString(),i=new bB;return this.restRequest_(r+".json",n,function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(i){var a=Og(i,2),o=a[0],s=a[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var u=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+qB(n);t.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=LB(c.responseText)}catch(n){l9("Failed to parse JSON response for "+u+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&l9("Got unsuccessful REST response for "+u+" Status: "+c.status),r(c.status);r=null}},c.open("GET",u,!0),c.send()})}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(dB(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(G9),Wee=function(){function e(){jg(this,e),this.rootNode_=Fee.EMPTY_NODE}return Zg(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function Zee(){return{value:null,children:new Map}}function Yee(e,t,n){if(tee(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=Z9(t);e.children.has(r)||e.children.set(r,Zee()),Yee(e.children.get(r),t=K9(t),n)}}function Kee(e,t){if(tee(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(Ree,function(t,n){Yee(e,new j9(t),n)}),Kee(e,t)}if(e.children.size>0){var r=Z9(t);return t=K9(t),e.children.has(r)&&Kee(e.children.get(r),t)&&e.children.delete(r),0===e.children.size}return!0}function Qee(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(function(e,n){t(n,e)})}(e,function(e,r){Qee(r,new j9(t.toString()+"/"+e),n)})}var Xee=function(){function e(t){jg(this,e),this.collection_=t,this.last_=null}return Zg(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&k9(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t}}]),e}(),Jee=function(){function e(t,n){jg(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new Xee(t);var r=1e4+2e4*Math.random();E9(this.reportStats_.bind(this),Math.floor(r))}return Zg(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;k9(t,function(t,i){i>0&&VB(e.statsToReport_,t)&&(n[t]=i,r=!0)}),r&&this.server_.reportStats(n),E9(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}(),ete=(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ete||(ete={})),ete);function tte(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var nte,rte=function(){function e(t,n,r){jg(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=ete.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return Zg(e,[{key:"operationForChild",value:function(t){if(tee(this.path)){if(null!=this.affectedTree.value)return dB(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new j9(t));return new e(W9(),n,this.revert)}return dB(Z9(this.path)===t,"operationForChild called for unrelated child."),new e(K9(this.path),this.affectedTree,this.revert)}}]),e}(),ite=function(){function e(t,n,r){jg(this,e),this.source=t,this.path=n,this.snap=r,this.type=ete.OVERWRITE}return Zg(e,[{key:"operationForChild",value:function(t){return tee(this.path)?new e(this.source,W9(),this.snap.getImmediateChild(t)):new e(this.source,K9(this.path),this.snap)}}]),e}(),ate=function(){function e(t,n,r){jg(this,e),this.source=t,this.path=n,this.children=r,this.type=ete.MERGE}return Zg(e,[{key:"operationForChild",value:function(t){if(tee(this.path)){var n=this.children.subtree(new j9(t));return n.isEmpty()?null:n.value?new ite(this.source,W9(),n.value):new e(this.source,W9(),n)}return dB(Z9(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,K9(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),ote=function(){function e(t,n,r){jg(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return Zg(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(tee(e))return this.isFullyInitialized()&&!this.filtered_;var t=Z9(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}();function ste(e,t,n,r,i,a){var o=r.filter(function(e){return e.type===n});o.sort(function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw vB("Should only compare child_ events.");var r=new vee(t.childName,t.snapshotNode),i=new vee(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)}),o.forEach(function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach(function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function ute(e,t){return{eventCache:e,serverCache:t}}function cte(e,t,n,r){return ute(new ote(t,n,r),e.serverCache)}function lte(e,t,n,r){return ute(e.eventCache,new ote(t,n,r))}function hte(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function fte(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var dte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(nte||(nte=new _ee(p9)),nte);jg(this,e),this.value=t,this.children=n}return Zg(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:W9(),value:this.value};if(tee(e))return null;var n=Z9(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(K9(e),t);return null!=i?{path:eee(new j9(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})}},{key:"subtree",value:function(t){if(tee(t))return this;var n=Z9(t),r=this.children.get(n);return null!==r?r.subtree(K9(t)):new e(null)}},{key:"set",value:function(t,n){if(tee(t))return new e(n,this.children);var r=Z9(t),i=(this.children.get(r)||new e(null)).set(K9(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(tee(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=Z9(t),r=this.children.get(n);if(r){var i,a=r.remove(K9(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(tee(e))return this.value;var t=Z9(e),n=this.children.get(t);return n?n.get(K9(e)):null}},{key:"setTree",value:function(t,n){if(tee(t))return n;var r,i=Z9(t),a=(this.children.get(i)||new e(null)).setTree(K9(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(W9(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(eee(e,r),t)}),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,W9(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(tee(e))return null;var i=Z9(e),a=this.children.get(i);return a?a.findOnPath_(K9(e),eee(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,W9(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(tee(t))return this;this.value&&r(n,this.value);var i=Z9(t),a=this.children.get(i);return a?a.foreachOnPath_(K9(t),eee(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(W9(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(eee(e,n),t)}),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})}}],[{key:"fromObject",value:function(t){var n=new e(null);return k9(t,function(e,t){n=n.set(new j9(e),t)}),n}}]),e}(),vte=function(){function e(t){jg(this,e),this.writeTree_=t}return Zg(e,null,[{key:"empty",value:function(){return new e(new dte(null))}}]),e}();function pte(e,t,n){if(tee(t))return new vte(new dte(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=nee(i,t);return a=a.updateChild(o,n),new vte(e.writeTree_.set(i,a))}var s=new dte(n),u=e.writeTree_.setTree(t,s);return new vte(u)}function gte(e,t,n){var r=e;return k9(n,function(e,n){r=pte(r,eee(t,e),n)}),r}function yte(e,t){if(tee(t))return vte.empty();var n=e.writeTree_.setTree(t,new dte(null));return new vte(n)}function mte(e,t){return null!=kte(e,t)}function kte(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(nee(n.path,t)):null}function _te(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Ree,function(e,n){t.push(new vee(e,n))}):e.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new vee(e,n.value))}),t}function Cte(e,t){if(tee(t))return e;var n=kte(e,t);return new vte(null!=n?new dte(n):e.writeTree_.subtree(t))}function wte(e){return e.writeTree_.isEmpty()}function bte(e,t){return Ete(W9(),e.writeTree_,t)}function Ete(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(dB(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ete(eee(e,t),i,n)}),!n.getChild(e).isEmpty()&&null!==r&&(n=n.updateChild(eee(e,".priority"),r)),n}function Ste(e,t){return Lte(t,e)}function Pte(e,t){if(e.snap)return aee(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&aee(eee(e.path,n),t))return!0;return!1}function Ote(e){return e.visible}function Tte(e,t,n){for(var r=vte.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)aee(n,o)?r=pte(r,s=nee(n,o),a.snap):aee(o,n)&&(s=nee(o,n),r=pte(r,W9(),a.snap.getChild(s)));else{if(!a.children)throw vB("WriteRecord should have .snap or .children");if(aee(n,o))r=gte(r,s=nee(n,o),a.children);else if(aee(o,n))if(tee(s=nee(o,n)))r=gte(r,W9(),a.children);else{var u=BB(a.children,Z9(s));if(u){var c=u.getChild(K9(s));r=pte(r,W9(),c)}}}}}return r}function Ite(e,t,n,r,i){if(r||i){var a=Cte(e.visibleWrites,t);return!i&&wte(a)?n:i||null!=n||mte(a,W9())?bte(Tte(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(aee(e.path,t)||aee(t,e.path))},t),n||Fee.EMPTY_NODE):null}var o=kte(e.visibleWrites,t);if(null!=o)return o;var s=Cte(e.visibleWrites,t);return wte(s)?n:null!=n||mte(s,W9())?bte(s,n||Fee.EMPTY_NODE):null}function Ate(e,t,n,r){return Ite(e.writeTree,e.treePath,t,n,r)}function Rte(e,t){return function(e,t,n){var r=Fee.EMPTY_NODE,i=kte(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Ree,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var a=Cte(e.visibleWrites,t);return n.forEachChild(Ree,function(e,t){var n=bte(Cte(a,new j9(e)),t);r=r.updateImmediateChild(e,n)}),_te(a).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return _te(Cte(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function xte(e,t,n,r){return function(e,t,n,r,i){dB(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=eee(t,n);if(mte(e.visibleWrites,a))return null;var o=Cte(e.visibleWrites,a);return wte(o)?i.getChild(n):bte(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function Mte(e,t){return function(e,t){return kte(e.visibleWrites,t)}(e.writeTree,eee(e.treePath,t))}function Nte(e,t,n){return function(e,t,n,r){var i=eee(t,n),a=kte(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?bte(Cte(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Dte(e,t){return Lte(eee(e.treePath,t),e.writeTree)}function Lte(e,t){return{treePath:e,writeTree:t}}var Fte,Ute,Vte=function(){function e(){jg(this,e),this.changeMap=new Map}return Zg(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;dB("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),dB(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Hee(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,function(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw vB("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Hee(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),Bte=new(function(){function e(){jg(this,e)}return Zg(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),zte=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;jg(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return Zg(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new ote(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Nte(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:fte(this.viewCache_),i=function(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=Cte(e.visibleWrites,t),c=kte(u,W9());if(null!=c)s=c;else{if(null==n)return[];s=bte(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=f.getNext();d&&l.length<1;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,0,i,a)}(this.writes_,r,t,0,n,e);return 0===i.length?null:i[0]}}]),e}();function Hte(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=Mte(r,n))return t;if(tee(n))if(dB(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=fte(t),l=Rte(r,c instanceof Fee?c:Fee.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=Ate(r,fte(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=Z9(n);if(".priority"===f){dB(1===Y9(n),"Can't have a priority with additional path components");var d=u.getNode(),v=xte(r,n,d,s=t.serverCache.getNode());o=null!=v?e.filter.updatePriority(d,v):u.getNode()}else{var p,g=K9(n);if(u.isCompleteForChild(f)){s=t.serverCache.getNode();var y=xte(r,n,u.getNode(),s);p=null!=y?u.getNode().getImmediateChild(f).updateChild(g,y):u.getNode().getImmediateChild(f)}else p=Nte(r,f,t.serverCache);o=null!=p?e.filter.updateChild(u.getNode(),f,p,g,i,a):u.getNode()}}return cte(t,o,u.isFullyInitialized()||tee(n),e.filter.filtersNodes())}function Gte(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(tee(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=Z9(n);if(!c.isCompleteForPath(n)&&Y9(n)>1)return t;var d=K9(n),v=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),v):l.updateChild(c.getNode(),f,v,d,Bte,null)}var p=lte(t,u,c.isFullyInitialized()||tee(n),l.filtersNodes());return Hte(e,p,n,i,new zte(i,p,a),s)}function $te(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new zte(i,t,a);if(tee(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=cte(t,u,!0,e.filter.filtersNodes());else{var h=Z9(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=cte(t,u,c.isFullyInitialized(),c.isFiltered());else{var f,d=K9(n),v=c.getNode().getImmediateChild(h);if(tee(d))f=r;else{var p=l.getCompleteChild(h);f=null!=p?".priority"===Q9(d)&&p.getChild(J9(d)).isEmpty()?p:p.updateChild(d,r):Fee.EMPTY_NODE}s=v.equals(f)?t:cte(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function qte(e,t){return e.eventCache.isCompleteForChild(t)}function jte(e,t,n){return n.foreach(function(e,n){t=t.updateChild(e,n)}),t}function Wte(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=tee(n)?r:new dte(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal(function(n,r){if(l.hasChild(n)){var u=jte(0,t.serverCache.getNode().getImmediateChild(n),r);c=Gte(e,c,new j9(n),u,i,a,o,s)}}),u.children.inorderTraversal(function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=jte(0,t.serverCache.getNode().getImmediateChild(n),r);c=Gte(e,c,new j9(n),h,i,a,o,s)}}),c}function Zte(e,t){var n=fte(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!tee(t)&&!n.getImmediateChild(Z9(t)).isEmpty())?n.getChild(t):null}function Yte(e,t,n,r){t.type===ete.MERGE&&null!==t.source.queryId&&(dB(fte(e.viewCache_),"We should always have a full cache before handling merges"),dB(hte(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_,a=function(e,t,n,r,i){var a,o,s=new Vte;if(n.type===ete.OVERWRITE){var u=n;u.source.fromUser?a=$te(e,t,u.path,u.snap,r,i,s):(dB(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!tee(u.path),a=Gte(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===ete.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach(function(r,u){var c=eee(n,r);qte(t,Z9(c))&&(s=$te(e,s,c,u,i,a,o))}),r.foreach(function(r,u){var c=eee(n,r);qte(t,Z9(c))||(s=$te(e,s,c,u,i,a,o))}),s}(e,t,c.path,c.children,r,i,s):(dB(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=Wte(e,t,c.path,c.children,r,i,o,s))}else if(n.type===ete.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=Mte(r,n))return t;var s,u=new zte(r,t,i),c=t.eventCache.getNode();if(tee(n)||".priority"===Z9(n)){var l;if(t.serverCache.isFullyInitialized())l=Ate(r,fte(t));else{var h=t.serverCache.getNode();dB(h instanceof Fee,"serverChildren would be complete if leaf node"),l=Rte(r,h)}s=e.filter.updateFullNode(c,l,a)}else{var f=Z9(n),d=Nte(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(s=null!=d?e.filter.updateChild(c,f,d,K9(n),u,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,Fee.EMPTY_NODE,K9(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&((o=Ate(r,fte(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a)))}return o=t.serverCache.isFullyInitialized()||null!=Mte(r,W9()),cte(t,s,o,e.filter.filtersNodes())}(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=Mte(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(tee(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Gte(e,t,n,u.getNode().getChild(n),i,a,s,o);if(tee(n)){var c=new dte(null);return u.getNode().forEachChild(yee,function(e,t){c=c.set(new j9(e),t)}),Wte(e,t,n,c,i,a,s,o)}return t}var l=new dte(null);return r.foreach(function(e,t){var r=eee(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))}),Wte(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==ete.LISTEN_COMPLETE)throw vB("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache;return Hte(e,lte(t,a.getNode(),a.isFullyInitialized()||tee(n),a.isFiltered()),n,r,Bte,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=hte(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(function(e){return{type:"value",snapshotNode:e}}(hte(t)))}}(t,a,h),{viewCache:a,changes:h}}(e.processor_,i,t,n,r);return function(e,t){dB(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),dB(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}(e.processor_,a.viewCache),dB(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,function(e,t,n,r){return function(e,t,n,r){var i=[],a=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(function(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}(t.childName,t.snapshotNode))}),ste(e,i,"child_removed",t,r,n),ste(e,i,"child_added",t,r,n),ste(e,i,"child_moved",a,r,n),ste(e,i,"child_changed",t,r,n),ste(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,e.eventRegistrations_)}(e,a.changes,a.viewCache.eventCache.getNode())}function Kte(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return dB(null!=a,"SyncTree gave us an op for an invalid query."),Yte(a,t,n,r)}var o,s=[],u=Gg(e.views.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s=s.concat(Yte(c,t,n,r))}}catch(l){u.e(l)}finally{u.f()}return s}function Qte(e,t){var n,r=null,i=Gg(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||Zte(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}var Xte=Zg(function e(t){jg(this,e),this.listenProvider_=t,this.syncPointTree_=new dte(null),this.pendingWriteTree_={visibleWrites:vte.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map});function Jte(e,t,n,r,i){return function(e,t,n,r,i){dB(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=pte(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?rne(e,new ite({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function ene(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){var n=e.allWrites.findIndex(function(e){return e.writeId===t});dB(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&Pte(s,r.path)?i=!1:aee(r.path,s.path)&&(a=!0)),o--}return!!i&&(a?(function(e){e.visibleWrites=Tte(e.allWrites,Ote,W9()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=yte(e.visibleWrites,r.path):k9(r.children,function(t){e.visibleWrites=yte(e.visibleWrites,eee(r.path,t))}),!0))}(e.pendingWriteTree_,t)){var i=new dte(null);return null!=r.snap?i=i.set(W9(),!0):k9(r.children,function(e){i=i.set(new j9(e),!0)}),rne(e,new rte(r.path,i,n))}return[]}function tne(e,t,n){return rne(e,new ite({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function nne(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,function(e,n){var r=Qte(n,nee(e,t));if(r)return r});return Ite(r,t,i,n,!0)}function rne(e,t){return ine(t,e.syncPointTree_,null,Ste(e.pendingWriteTree_,W9()))}function ine(e,t,n,r){if(tee(e.path))return ane(e,t,n,r);var i=t.get(W9());null==n&&null!=i&&(n=Qte(i,W9()));var a=[],o=Z9(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=Dte(r,o);a=a.concat(ine(s,u,c,l))}return i&&(a=a.concat(Kte(i,e,r,n))),a}function ane(e,t,n,r){var i=t.get(W9());null==n&&null!=i&&(n=Qte(i,W9()));var a=[];return t.children.inorderTraversal(function(t,i){var o=n?n.getImmediateChild(t):null,s=Dte(r,t),u=e.operationForChild(t);u&&(a=a.concat(ane(u,i,o,s)))}),i&&(a=a.concat(Kte(i,e,r,n))),a}function one(e,t){return e.tagToQueryMap.get(t)}function sne(e){var t=e.indexOf("$");return dB(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new j9(e.substr(0,t))}}function une(e,t,n){var r=e.syncPointTree_.get(t);return dB(r,"Missing sync point for query tag that we're tracking"),Kte(r,n,Ste(e.pendingWriteTree_,t),null)}var cne=function(){function e(t){jg(this,e),this.node_=t}return Zg(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),lne=function(){function e(t,n){jg(this,e),this.syncTree_=t,this.path_=n}return Zg(e,[{key:"getImmediateChild",value:function(t){var n=eee(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return nne(this.syncTree_,this.path_)}}]),e}(),hne=function(e,t,n){return e&&"object"==typeof e?(dB(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?fne(e[".sv"],t,n):"object"==typeof e[".sv"]?dne(e[".sv"],t):void dB(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},fne=function(e,t,n){if("timestamp"===e)return n.timestamp;dB(!1,"Unexpected server value: "+e)},dne=function(e,t,n){e.hasOwnProperty("increment")||dB(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&dB(!1,"Unexpected increment value: "+r);var i=t.node();if(dB(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},vne=function(e,t,n){return pne(e,new cne(t),n)};function pne(e,t,n){var r,i=e.getPriority().val(),a=hne(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=hne(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new Aee(s,Vee(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new Aee(a))),u.forEachChild(Ree,function(e,i){var a=pne(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))}),r}var gne=Zg(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};jg(this,e),this.name=t,this.parent=n,this.node=r});function yne(e,t){for(var n=t instanceof j9?t:new j9(t),r=e,i=Z9(n);null!==i;){var a=BB(r.node.children,i)||{children:{},childCount:0};r=new gne(i,r,a),i=Z9(n=K9(n))}return r}function mne(e){return e.node.value}function kne(e,t){e.node.value=t,Ene(e)}function _ne(e){return e.node.childCount>0}function Cne(e,t){k9(e.node.children,function(n,r){t(new gne(n,e,r))})}function wne(e,t,n,r){n&&!r&&t(e),Cne(e,function(e){wne(e,t,!0,r)}),n&&r&&t(e)}function bne(e){return new j9(null===e.parent?e.name:bne(e.parent)+"/"+e.name)}function Ene(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===mne(e)&&!_ne(e)}(n),i=VB(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Ene(e)):!r&&!i&&(e.node.children[t]=n.node,e.node.childCount++,Ene(e))}(e.parent,e.name,e)}var Sne=/[\[\].#$\/\u0000-\u001F\u007F]/,Pne=/[\[\].#$\u0000-\u001F\u007F]/,One=10485760,Tne=function(e){return"string"==typeof e&&0!==e.length&&!Sne.test(e)},Ine=function(e){return"string"==typeof e&&0!==e.length&&!Pne.test(e)},Ane=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!h9(e)||e&&"object"==typeof e&&VB(e,".sv")},Rne=function(e,t,n,r){r&&void 0===t||xne(QB(e,"value"),t,n)},xne=function e(t,n,r){var i=r instanceof j9?new oee(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+uee(i));if("function"==typeof n)throw new Error(t+"contains a function "+uee(i)+" with contents = "+n.toString());if(h9(n))throw new Error(t+"contains "+n.toString()+" "+uee(i));if("string"==typeof n&&n.length>One/3&&XB(n)>One)throw new Error(t+"contains a string greater than "+One+" utf8 bytes "+uee(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var a=!1,o=!1;if(k9(n,function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!Tne(n)))throw new Error(t+" contains an invalid key ("+n+") "+uee(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=XB(t),see(e)})(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=XB(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)}),a&&o)throw new Error(t+' contains ".value" child '+uee(i)+" in addition to actual children.")}},Mne=function(e,t,n,r){if(!(r&&void 0===n||Ine(n)))throw new Error(QB(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Nne=function(e,t){if(".info"===Z9(t))throw new Error(e+" failed = Can't modify data under /.info/")},Dne=Zg(function e(){jg(this,e),this.eventLists_=[],this.recursionDepth_=0});function Lne(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null!==n&&!iee(a,n.path)&&(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function Fne(e,t,n){Lne(e,n),function(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(Une(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,function(e){return aee(e,t)||aee(t,e)})}function Une(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();i9&&o9("event: "+n.toString()),b9(r)}}}var Vne=function(){function e(t,n,r,i){jg(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Dne,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Zee(),this.transactionQueueTree_=new gne,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return Zg(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function Bne(e){var t=e.infoData_.getNode(new j9(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function zne(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:Bne(e)})}function Hne(e,t,n,r,i){e.dataUpdateCount++;var a=new j9(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=HB(n,function(e){return Vee(e)});o=function(e,t,n,r){var i=one(e,r);if(i){var a=sne(i),o=a.path,s=a.queryId,u=nee(o,t),c=dte.fromObject(n);return une(e,o,new ate(tte(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=Vee(n);o=function(e,t,n,r){var i=one(e,r);if(null!=i){var a=sne(i),o=a.path,s=a.queryId,u=nee(o,t);return une(e,o,new ite(tte(s),u,n))}return[]}(e.serverSyncTree_,a,u,i)}else if(r){var c=HB(n,function(e){return Vee(e)});o=function(e,t,n){var r=dte.fromObject(n);return rne(e,new ate({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=Vee(n);o=tne(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=Xne(e,a)),Fne(e.eventQueue_,h,o)}function Gne(e,t){$ne(e,"connected",t),!1===t&&function(e){Zne(e,"onDisconnectEvents");var t=zne(e),n=Zee();Qee(e.onDisconnect_,W9(),function(r,i){var a=function(e,t,n,r){return pne(t,new lne(n,e),r)}(r,i,e.serverSyncTree_,t);Yee(n,r,a)});var r=[];Qee(n,W9(),function(t,n){r=r.concat(tne(e.serverSyncTree_,t,n));var i=rre(e,t);Xne(e,i)}),e.onDisconnect_=Zee(),Fne(e.eventQueue_,W9(),r)}(e)}function $ne(e,t,n){var r=new j9("/.info/"+t),i=Vee(n);e.infoData_.updateSnapshot(r,i);var a=tne(e.infoSyncTree_,r,i);Fne(e.eventQueue_,r,a)}function qne(e){return e.nextWriteId_++}function jne(e,t,n){e.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&Kee(e.onDisconnect_,t),Yne(0,n,r,i)})}function Wne(e,t,n,r){var i=Vee(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),function(n,a){"ok"===n&&Yee(e.onDisconnect_,t,i),Yne(0,r,n,a)})}function Zne(e){for(var t="",n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.persistentConnection_&&(t=e.persistentConnection_.id+":"),o9.apply(void 0,[t].concat(r))}function Yne(e,t,n,r){t&&b9(function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}})}function Kne(e,t,n){return nne(e.serverSyncTree_,t,n)||Fee.EMPTY_NODE}function Qne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||nre(e,t),mne(t)){var n=ere(e,t);dB(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(e,t,n){for(var r=n.map(function(e){return e.currentWriteId}),i=Kne(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];dB(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=nee(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,function(r){Zne(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(ene(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push(function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)}),n[t].unwatcher()},s=0;s<n.length;s++)o(s);nre(e,yne(e.transactionQueueTree_,t)),Qne(e,e.transactionQueueTree_),Fne(e.eventQueue_,t,i);for(var u=0;u<a.length;u++)b9(a[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)n[c].status=3===n[c].status?4:0;else{l9("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}Xne(e,t)}},o)}(e,bne(t),n)}else _ne(t)&&Cne(t,function(t){Qne(e,t)})}function Xne(e,t){var n=Jne(e,t),r=bne(n);return function(e,t,n){if(0!==t.length){for(var r=[],i=[],a=t.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),o=function(o){var s=t[o],u=nee(n,s.path),c=void 0,l=!1;if(dB(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)l=!0,c=s.abortReason,i=i.concat(ene(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)l=!0,c="maxretry",i=i.concat(ene(e.serverSyncTree_,s.currentWriteId,!0));else{var h=Kne(e,s.path,a);s.currentInputSnapshot=h;var f=t[o].update(h.val());if(void 0!==f){xne("transaction failed: Data returned ",f,s.path);var d=Vee(f);"object"==typeof f&&null!=f&&VB(f,".priority")||(d=d.updatePriority(h.getPriority()));var v=s.currentWriteId,p=zne(e),g=vne(d,h,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=g,s.currentWriteId=qne(e),a.splice(a.indexOf(v),1),i=(i=i.concat(Jte(e.serverSyncTree_,s.path,g,s.currentWriteId,s.applyLocally))).concat(ene(e.serverSyncTree_,v,!0))}else l=!0,c="nodata",i=i.concat(ene(e.serverSyncTree_,s.currentWriteId,!0))}Fne(e.eventQueue_,n,i),i=[],l&&(t[o].status=2,setTimeout(t[o].unwatcher,Math.floor(0)),t[o].onComplete&&r.push("nodata"===c?function(){return t[o].onComplete(null,!1,t[o].currentInputSnapshot)}:function(){return t[o].onComplete(new Error(c),!1,null)}))},s=0;s<t.length;s++)o(s);nre(e,e.transactionQueueTree_);for(var u=0;u<r.length;u++)b9(r[u]);Qne(e,e.transactionQueueTree_)}}(e,ere(e,n),r),r}function Jne(e,t){var n,r=e.transactionQueueTree_;for(n=Z9(t);null!==n&&void 0===mne(r);)r=yne(r,n),n=Z9(t=K9(t));return r}function ere(e,t){var n=[];return tre(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function tre(e,t,n){var r=mne(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Cne(t,function(t){tre(e,t,n)})}function nre(e,t){var n=mne(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,kne(t,n.length>0?n:void 0)}Cne(t,function(t){nre(e,t)})}function rre(e,t){var n=bne(Jne(e,t)),r=yne(e.transactionQueueTree_,t);return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,function(t){ire(e,t)}),ire(e,r),wne(r,function(t){ire(e,t)}),n}function ire(e,t){var n=mne(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(dB(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(dB(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ene(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?kne(t,void 0):n.length=a+1,Fne(e.eventQueue_,bne(t),i);for(var s=0;s<r.length;s++)b9(r[s])}}var are=function(e,t){var n=ore(e),r=n.namespace;return"firebase.com"===n.domain&&c9(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&c9("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&l9("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new A9(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,t,"",r!==n.subdomain),path:new j9(n.pathString)}},ore=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=Gg(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):l9("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},sre=function(){function e(t,n){jg(this,e),this._repo=t,this._path=n}return Zg(e,[{key:"cancel",value:function(){var e=new bB;return jne(this._repo,this._path,e.wrapCallback(function(){})),e.promise}},{key:"remove",value:function(){Nne("OnDisconnect.remove",this._path);var e=new bB;return Wne(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise}},{key:"set",value:function(e){Nne("OnDisconnect.set",this._path),Rne("OnDisconnect.set",e,this._path,!1);var t=new bB;return Wne(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}},{key:"setWithPriority",value:function(e,t){Nne("OnDisconnect.setWithPriority",this._path),Rne("OnDisconnect.setWithPriority",e,this._path,!1),function(e,t,n){if(h9(t))throw new Error(QB(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ane(t))throw new Error(QB(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}("OnDisconnect.setWithPriority",t);var n=new bB;return function(e,t,n,r,i){var a=Vee(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),function(n,r){"ok"===n&&Yee(e.onDisconnect_,t,a),Yne(0,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(function(){})),n.promise}},{key:"update",value:function(e){Nne("OnDisconnect.update",this._path),function(e,t,n,r){var i=QB("OnDisconnect.update","values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];k9(t,function(e,t){var r=new j9(e);if(xne(i,t,eee(n,r)),".priority"===Q9(r)&&!Ane(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=X9(r=t[n]),a=0;a<i.length;a++)if((".priority"!==i[a]||a!==i.length-1)&&!Tne(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(ree);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&aee(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}(0,e,this._path);var t=new bB;return function(e,t,n,r){if(zB(n))return o9("onDisconnect().update() called with empty data.  Don't do anything."),void Yne(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,function(i,a){"ok"===i&&k9(n,function(n,r){var i=Vee(r);Yee(e.onDisconnect_,eee(t,n),i)}),Yne(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}}]),e}(),ure=function(){function e(t,n,r,i){jg(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return Zg(e,[{key:"key",get:function(){return tee(this._path)?null:Q9(this._path)}},{key:"ref",get:function(){return new cre(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=qee(this._queryParams),t=y9(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return qee(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=ez(t))instanceof e))return!1;var n=this._repo===t._repo,r=iee(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}(),cre=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r,new Gee,!1)}return Zg(n,[{key:"parent",get:function(){var e=J9(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(ure);(function(e){dB(!Fte,"__referenceConstructor has already been defined"),Fte=e})(cre),function(e){dB(!Ute,"__referenceConstructor has already been defined"),Ute=e}(cre);var lre={};var hre=function(){function e(t,n){jg(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return Zg(e,[{key:"_repo",get:function(){return this._instanceStarted||(function(e,t,n){if(e.stats_=D9(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new jee(e.repoInfo_,function(t,n,r,i){Hne(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(function(){return Gne(e,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{FB(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new dee(e.repoInfo_,t,function(t,n,r,i){Hne(e,t,n,r,i)},function(t){Gne(e,t)},function(t){!function(e,t){k9(t,function(t,n){$ne(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(function(t){e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){var n=e.toString();return N9[n]||(N9[n]=t()),N9[n]}(e.repoInfo_,function(){return new Jee(e.stats_,e.server_)}),e.infoData_=new Wee,e.infoSyncTree_=new Xte({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=tne(e.infoSyncTree_,t._path,o),setTimeout(function(){i("ok")},0)),a},stopListening:function(){}}),$ne(e,"connected",!1),e.serverSyncTree_=new Xte({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,function(n,r){var a=i(n,r);Fne(e.eventQueue_,t._path,a)}),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new cre(this._repo,W9())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(function(e,t){var n=lre[t];(!n||n[e.key]!==e)&&c9("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&c9("Cannot call "+e+" on a deleted database.")}}]),e}();var fre={".sv":"timestamp"};function dre(){return fre}dee.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},dee.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Z7="9.9.0",Fz(new rz("database",function(e,t){var n=t.instanceIdentifier;return function(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||c9("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),o9("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s,u=are(a,i),c=u.repoInfo;"undefined"!=typeof process&&process.env&&(s=process.env.FIREBASE_DATABASE_EMULATOR_HOST),s?(o=!0,a="http://".concat(s,"?ns=").concat(c.namespace),c=(u=are(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new O9(O9.OWNER):new P9(e.name,e.options,t);(function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Tne(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ine(e)}(n))throw new Error(QB("Invalid Firebase Database URL","url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})(0,u),tee(u.path)||c9("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=lre[t.name];i||(i={},lre[t.name]=i);var a=i[e.toURLString()];return a&&c9("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new Vne(e,!1,n,r),i[e.toURLString()]=a,a}(c,e,l,new S9(e.name,n));return new hre(h,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),$z(W7,"0.13.3",void 0),$z(W7,"0.13.3","esm2017");var vre=Zg(function e(t){return jg(this,e),t}),pre=new K_("angularfire2.database-instances");function gre(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new vre(r)}}var yre={provide:Zg(function e(){return jg(this,e),Fq("database")}),deps:[[new EC,pre]]},mre={provide:vre,useFactory:function(e,t){var n=Lq("database",e,t);return n&&new vre(n)},deps:[[new EC,pre],Zq]},kre=function(){var e=Zg(function e(){jg(this,e),$z("angularfire",Iq.full,"rtdb")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({providers:[mre,yre]}),e}(),_re=Wq(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=ez(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&c9("Cannot call useEmulator() after instance has already been initialized.");var i,a=e._repoInternal;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&c9('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new O9(O9.OWNER);else if(r.mockUserToken){var o="string"==typeof r.mockUserToken?r.mockUserToken:EB(r.mockUserToken,e.app.options.projectId);i=new O9(o)}!function(e,t,n,r){e.repoInfo_=new A9("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(a,t,n,i)},!0),Cre=Wq(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hz(),t=arguments.length>1?arguments[1]:void 0;return Uz(e,"database").getImmediate({identifier:t})},!0),wre=Wq(function(e){return e=ez(e),new sre(e._repo,e._path)},!0),bre=Wq(function(e,t){return(e=ez(e))._checkNotDeleted("ref"),void 0!==t?function(e,t){return null===Z9((e=ez(e))._path)?(n=t,n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Mne("child","path",n,!1)):Mne("child","path",t,!1),new cre(e._repo,eee(e._path,t));var n}(e._root,t):e._root},!0),Ere=Wq(function(e,t){e=ez(e),Nne("set",e._path),Rne("set",t,e._path,!1);var n=new bB;return function(e,t,n,r,i){Zne(e,"set",{path:t.toString(),value:n,priority:null});var a=zne(e),o=Vee(n,null),s=nne(e.serverSyncTree_,t),u=vne(o,s,a),c=qne(e),l=Jte(e.serverSyncTree_,t,u,c,!0);Lne(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),function(n,r){var a="ok"===n;a||l9("set at "+t+" failed: "+n);var o=ene(e.serverSyncTree_,c,!a);Fne(e.eventQueue_,t,o),Yne(0,i,n,r)});var h=rre(e,t);Xne(e,h),Fne(e.eventQueue_,h,[])}(e._repo,e._path,t,0,n.wrapCallback(function(){})),n.promise},!0),Sre=function(){function e(t){jg(this,e),this.db=t}return Zg(e,[{key:"setOffline",value:function(t){return Ere(bre(this.db,"/status/"+t),e.OFFLINE)}},{key:"launchAutomaticPresenceUpdate",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=bre(n.db,"/status/"+t),r.next=3,Ere(i,e.ONLINE);case 3:return r.next=5,wre(i).set(e.OFFLINE);case 5:case"end":return r.stop()}},r)}))()}}]),e}();Sre.OFFLINE={last_changed:dre()},Sre.ONLINE={last_changed:dre()},Sre.\u0275fac=function(e){return new(e||Sre)(gC(vre))},Sre.\u0275prov=vm({token:Sre,factory:Sre.\u0275fac,providedIn:"root"});var Pre=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return rK(e,t,n)}},{key:"sendEmailVerification",value:function(e){return oK(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return sK(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,uK(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,cK(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return lK(e,t)}}]),e}(),Ore=function(){function e(t,n,r,i){jg(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return Zg(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();Ore.NOT_CONNECTED=new Ore("",fB.empty(),fB.empty(),!1);var Tre=function(){var e=function(){function e(t,n,r){jg(this,e);var i,a=this;this.userDAO=t,this.auth=n,this.connectivityDAO=r,this.user=fB.empty(),this.userUnsubscribe=fB.empty(),uB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new j7(1),this.userObs=this.userRS.asObservable(),this.unsubscribeFromAuth=aK(this.auth,(i=oB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){t.next=4;break}uB(e.VERBOSE,"User is not connected"),a.userUnsubscribe.isPresent()&&a.userUnsubscribe.get()(),a.userRS.next(Ore.NOT_CONNECTED),a.user=fB.empty(),t.next=8;break;case 4:return D7(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),t.next=7,a.connectivityDAO.launchAutomaticPresenceUpdate(n.uid);case 7:a.userUnsubscribe=fB.of(a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;uB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userDAO.markVerified(n.uid);var o=new Ore(n.uid,fB.ofNullable(n.email),fB.ofNullable(r),i);a.user=fB.of(o),a.userRS.next(o)}}));case 8:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)}))}return Zg(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pre.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",A7.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",A7.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return oB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return uB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userDAO.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=O7.failure($localize(r||(r=bg(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Pre.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,o=sB.getNonNullable(a.user),i.next=7,r.createUser(o.uid,e);case 7:return i.abrupt("return",O7.success(o));case 10:return i.prev=10,i.t0=i.catch(0),i.abrupt("return",O7.failure(r.mapFirebaseError(i.t0)));case 13:case"end":return i.stop()}},i,null,[[0,10]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=bg(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=bg(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=bg(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=bg(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=bg(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=bg(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=bg(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(h||(h=bg(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return N7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(uB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=fB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",N7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",N7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,Pre.sendEmailVerification(r.get());case 9:return n.abrupt("return",A7.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",A7.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return uB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,Pre.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",A7.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",A7.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=A7,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new yZ).addScope("profile"),n.addScope("email"),t.next=5,Pre.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",O7.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",O7.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=fB.ofNullable(e.auth.currentUser)).isPresent()){t.next=8;break}return r=n.get().uid,t.next=5,e.connectivityDAO.setOffline(r);case 5:return t.next=7,e.auth.signOut();case 7:return t.abrupt("return",A7.SUCCESS);case 8:return t.abrupt("return",A7.failure("Cannot disconnect a non-connected user"));case 9:case"end":return t.stop()}},t)}))()}},{key:"getUserObs",value:function(){return this.userObs}},{key:"setUsername",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",A7.failure($localize(f||(f=bg(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userDAO.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",A7.failure($localize(d||(d=bg(["This username is already in use, please select a different one."])))));case 9:return r=sB.getNonNullable(t.auth.currentUser),n.next=12,Pre.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userDAO.setUsername(r.uid,e);case 14:return n.next=16,t.userDAO.markVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",A7.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",A7.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=sB.getNonNullable(t.auth.currentUser),n.next=4,Pre.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",A7.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",A7.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=sB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return D7(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return D7(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return D7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userDAO.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userUnsubscribe.isPresent()&&this.userUnsubscribe.get()(),this.unsubscribeFromAuth()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(G7),gC(ZY),gC(Sre))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ire=function(){function e(t){jg(this,e),this.value=t}return Zg(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return D7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();Ire.CREATOR=new Ire("CREATOR"),Ire.RANDOM=new Ire("RANDOM"),Ire.CHOSEN_PLAYER=new Ire("CHOSEN_PLAYER");var Are=function(){function e(t){jg(this,e),this.value=t}return Zg(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();Are.STANDARD=new Are("STANDARD"),Are.BLITZ=new Are("BLITZ"),Are.CUSTOM=new Are("CUSTOM"),Are.NORMAL_MOVE_DURATION=120,Are.NORMAL_PART_DURATION=1800,Are.BLITZ_MOVE_DURATION=30,Are.BLITZ_PART_DURATION=900;var Rre=Zg(function e(t){jg(this,e),this.value=t});Rre.PART_CREATED=new Rre(0),Rre.CONFIG_PROPOSED=new Rre(2),Rre.PART_STARTED=new Rre(3),Rre.PART_FINISHED=new Rre(4);var xre=Zg(function e(){jg(this,e)}),Mre=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return D7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){Ng(s,n);var o=Lg(s);function s(){return jg(this,s),o.apply(this,arguments)}return Zg(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=sB.getNonNullable(n).type,a=sB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(xre),Nre=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return D7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){Ng(a,n);var i=Lg(a);function a(){return jg(this,a),i.apply(this,arguments)}return Zg(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){Ng(a,n);var i=Lg(a);function a(){return jg(this,a),i.apply(this,arguments)}return Zg(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){Ng(a,n);var i=Lg(a);function a(){return jg(this,a),i.apply(this,arguments)}return Zg(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){Ng(r,t);var n=Lg(r);function r(){return jg(this,r),n.apply(this,arguments)}return Zg(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(Mre);Nre.booleanEncoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(Nre));var Dre=function(){function e(){jg(this,e),this.value=2}return Zg(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PlayerNone"}},{key:"equals",value:function(e){return this===e}}]),e}();Dre.NONE=new Dre;var Lre,Fre=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(sB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(sB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();Fre.numberEncoder=Nre.ofN(2,function(e){return e.value},function(e){return 2===e?Lre.NONE:Fre.of(e)}),Fre.ZERO=new Fre(0),Fre.ONE=new Fre(1),Fre.PLAYERS=[Fre.ZERO,Fre.ONE],function(e){e.ZERO=Fre.ZERO,e.ONE=Fre.ONE,e.NONE=Dre.NONE}(Lre||(Lre={}));var Ure=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"rematchAccepted",value:function(e,t){return Vre("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return Fre.of(sB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return sB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return sB.getNonNullable(e.data).partId}}]),e}();function Vre(e,t){return{code:e,data:t}}function Bre(e){return function(t){return Vre(e,{player:t.value})}}Ure.drawProposed=Bre("DrawProposed"),Ure.drawAccepted=Vre("DrawAccepted",{}),Ure.drawRefused=Bre("DrawRefused"),Ure.takeBackAsked=Bre("TakeBackAsked"),Ure.takeBackRefused=Bre("TakeBackRefused"),Ure.takeBackAccepted=Bre("TakeBackAccepted"),Ure.rematchProposed=Bre("RematchProposed"),Ure.addTurnTime=Bre("AddTurnTime"),Ure.addGlobalTime=Bre("AddGlobalTime");var zre=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===hB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),Hre=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),r=t.call(this,"joiners",e),uB(n.VERBOSE,"JoinerDAO.constructor"),r}return Zg(n)}(P7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(a7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Gre=function(){var e=function(){function e(t){jg(this,e),this.joinerDAO=t,this.joinerUnsubscribe=fB.empty(),uB(e.VERBOSE,"JoinerService.constructor")}return Zg(e,[{key:"subscribeToChanges",value:function(e,t){this.observedJoinerId=e,this.joinerUnsubscribe=fB.of(this.joinerDAO.subscribeToChanges(e,t))}},{key:"unsubscribe",value:function(){D7(this.joinerUnsubscribe.isPresent(),"JoinerService cannot unsubscribe if no joiner is observed"),this.joinerUnsubscribe.get()(),this.joinerUnsubscribe=fB.empty()}},{key:"createInitialJoiner",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(uB(e.VERBOSE,"JoinerService.createInitialJoiner("+t.id+", "+n+")"),r.set(n,{candidates:[],chosenOpponent:null,firstPlayer:Ire.RANDOM.value,partType:Are.STANDARD.value,partStatus:Rre.PART_CREATED.value,maximalMoveDuration:Are.NORMAL_MOVE_DURATION,totalPartDuration:Are.NORMAL_PART_DURATION,creator:t})));case 1:case"end":return i.stop()}},i)}))()}},{key:"joinGame",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return uB(e.VERBOSE,"JoinerService.joinGame("+t+", "+n.id+")"),i.next=3,r.joinerDAO.read(t);case 3:if(!(a=i.sent).isAbsent()){i.next=6;break}return i.abrupt("return",A7.failure(e.GAME_DOES_NOT_EXIST()));case 6:if(!(o=zre.copyImmutableArray(a.get().candidates)).some(function(e){return e.id===n.id})){i.next=11;break}i.t0=A7.failure(e.USER_ALREADY_IN_GAME()),i.next=17;break;case 11:if(i.t1=n.id===a.get().creator.id,i.t1){i.next=16;break}return o[o.length]=n,i.next=16,r.joinerDAO.update(t,{candidates:o});case 16:i.t0=A7.SUCCESS;case 17:return i.abrupt("return",i.t0);case 18:case"end":return i.stop()}},i)}))()}},{key:"cancelJoining",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(uB(e.VERBOSE,"JoinerService.cancelJoining("+t.name+"); this.observedJoinerId = "+n.observedJoinerId),null!=n.observedJoinerId){r.next=2;break}throw new Error("cannot cancel joining when not observing a joiner");case 2:return r.next=4,n.joinerDAO.read(n.observedJoinerId);case 4:if((i=r.sent).isAbsent()){r.next=15;break}if(o=i.get(),s=zre.copyImmutableArray(o.candidates),u=s.findIndex(function(e){return e.id===t.id}),c=o.chosenOpponent,l=o.partStatus,s.splice(u,1),(null===(a=c)||void 0===a?void 0:a.id)!==t.id){r.next=12;break}c=null,l=Rre.PART_CREATED.value,r.next=14;break;case 12:if(-1!==u){r.next=14;break}throw new Error("someone that was not candidate nor ChosenOpponent just left the chat: "+t.name);case 14:return r.abrupt("return",n.joinerDAO.update(n.observedJoinerId,{chosenOpponent:c,partStatus:l,candidates:s}));case 15:case"end":return r.stop()}},r)}))()}},{key:"updateCandidates",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return uB(e.VERBOSE,"JoinerService.reviewConfig"),D7(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),i={candidates:t},r.abrupt("return",n.joinerDAO.update(sB.getNonNullable(n.observedJoinerId),i));case 3:case"end":return r.stop()}},r)}))()}},{key:"deleteJoiner",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(uB(e.VERBOSE,"JoinerService.deleteJoiner(); this.observedJoinerId = "+t.observedJoinerId),D7(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.delete(sB.getNonNullable(t.observedJoinerId))));case 1:case"end":return n.stop()}},n)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a){var o=this;return oB(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(uB(e.VERBOSE,{joinerService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:a}}),uB(e.VERBOSE,"this.followedJoinerId: "+o.observedJoinerId),D7(null!=o.observedJoinerId,"JoinerService is not observing a joiner"),o.joinerDAO.update(sB.getNonNullable(o.observedJoinerId),{partStatus:Rre.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:a,firstPlayer:i.value})));case 1:case"end":return s.stop()}},s)}))()}},{key:"setChosenOpponent",value:function(t){return uB(e.VERBOSE,"JoinerService.setChosenOpponent(".concat(t.name,")")),D7(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(sB.getNonNullable(this.observedJoinerId),{chosenOpponent:t})}},{key:"reviewConfig",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(uB(e.VERBOSE,"JoinerService.reviewConfig"),D7(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.update(sB.getNonNullable(t.observedJoinerId),{partStatus:Rre.PART_CREATED.value})));case 1:case"end":return n.stop()}},n)}))()}},{key:"reviewConfigAndRemoveChosenOpponentAndUpdateCandidates",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(uB(e.VERBOSE,"JoinerService.reviewConfig"),D7(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(sB.getNonNullable(n.observedJoinerId),{partStatus:Rre.PART_CREATED.value,candidates:t,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(){return uB(e.VERBOSE,"JoinerService.acceptConfig"),D7(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(sB.getNonNullable(this.observedJoinerId),{partStatus:Rre.PART_STARTED.value})}},{key:"createJoiner",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(uB(e.VERBOSE,"JoinerService.create("+JSON.stringify(t)+")"),n.joinerDAO.create(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"readJoinerById",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return uB(e.VERBOSE,"JoinerService.readJoinerById("+t+")"),r.next=3,n.joinerDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}},{key:"set",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(uB(e.VERBOSE,"JoinerService.set("+t+", "+JSON.stringify(n)+")"),r.joinerDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"updateJoinerById",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(uB(e.VERBOSE,{joinerService_updateJoinerById:{partId:t,update:n}}),r.joinerDAO.update(t,n)));case 1:case"end":return i.stop()}},i)}))()}}]),e}();return e.VERBOSE=!1,e.USER_ALREADY_IN_GAME=function(){return $localize(v||(v=bg(["You cannot join this game because you are already in another one."])))},e.GAME_DOES_NOT_EXIST=function(){return $localize(p||(p=bg(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(gC(Hre))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),$re=function(){var e=function(){function e(t,n,r){jg(this,e),this.partDAO=t,this.joinerService=n,this.chatService=r,this.followedPartId=fB.empty(),uB(e.VERBOSE,"GameService.constructor")}return Zg(e,[{key:"getPartValidity",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?A7.failure("NONEXISTENT_PART"):i.get().typeGame===t?A7.SUCCESS:A7.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t,n){return uB(e.VERBOSE,"GameService.createPart("+t.name+", "+n+")"),this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:n,playerZero:t.name,turn:-1,result:L7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return uB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartJoinerAndChat",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return uB(e.VERBOSE,"GameService.createGame(".concat(t.id,", ").concat(n,")")),i.next=3,r.createUnstartedPart(t,n);case 3:return a=i.sent,i.next=6,r.joinerService.createInitialJoiner(t,a);case 6:return i.next=8,r.createChat(a);case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}},i)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){uB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=Ire.of(e.firstPlayer);return r===Ire.RANDOM&&(r=Math.random()<.5?Ire.CREATOR:Ire.CHOSEN_PLAYER),r===Ire.CREATOR?(t=e.creator.name,n=sB.getNonNullable(e.chosenOpponent).name):(t=sB.getNonNullable(e.chosenOpponent).name,n=e.creator.name),{playerZero:t,playerOne:n,turn:0,beginning:i7(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(uB(e.VERBOSE,"GameService.deletePart("+t+")"),n.partDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return uB(e.VERBOSE,{gameService_acceptConfig:{partId:t,joiner:n}}),i.next=3,r.joinerService.acceptConfig();case 3:return i.abrupt("return",r.startGameWithConfig(t,Fre.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"startObserving",value:function(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");uB(e.VERBOSE,"[start watching part "+t),this.followedPartId=fB.of(t),this.followedPartUnsubscribe=this.partDAO.subscribeToChanges(t,n)}},{key:"resign",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:L7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:L7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,Ure.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===Fre.ZERO?L7.AGREED_DRAW_BY_ZERO:L7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,Ure.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,Ure.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return uB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=sB.getNonNullable(t.data),a.next=4,i.joinerService.readJoinerById(t.id);case 4:return s=a.sent,u=o.playerZero===s.creator.name?Ire.CHOSEN_PLAYER:Ire.CREATOR,c=Sg(Sg({},s),{},{candidates:[],firstPlayer:u.value,partStatus:Rre.PART_STARTED.value}),a.next=9,i.joinerService.createJoiner(c);case 9:return l=a.sent,h=i.getStartingConfig(c),f=Sg({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:L7.UNACHIEVED.value,listMoves:[]},h),a.next=14,i.partDAO.set(l,f);case 14:return a.next=16,i.createChat(l);case 16:return a.abrupt("return",i.sendRequest(t.id,r,n,Ure.rematchAccepted(o.typeGame,l)));case 17:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,Ure.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return D7(Ure.getPlayer(sB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=Ure.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:i7(),remainingMsForZero:sB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:sB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.partDAO.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=Ure.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:Ure.addGlobalTime(r.getOpponent())},o=r===Fre.ZERO?Sg(Sg({},o),{},{remainingMsForOne:sB.getNonNullable(n.remainingMsForOne)+3e5}):Sg(Sg({},o),{},{remainingMsForZero:sB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.partDAO.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:Ure.addTurnTime(e.getOpponent())},i.next=3,r.partDAO.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"stopObserving",value:function(){uB(e.VERBOSE,"GameService.stopObserving();"),this.followedPartId=fB.empty(),this.followedPartUnsubscribe()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return oB(regeneratorRuntime.mark(function l(){var h,f,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return uB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return h=l.sent.get(),f=h.lastUpdate.index,d=h.turn+1,(v=zre.copyImmutableArray(h.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:i7()},p=c.updateScore(p,a),p=c.substractMs(p,h,i),null!=s?p=Sg(Sg({},p),{},{winner:s,loser:u,result:L7.VICTORY.value}):!0===o&&(p=Sg(Sg({},p),{},{result:L7.HARD_DRAW.value})),l.next=14,c.partDAO.updateAndBumpIndex(t,n,f,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Sg(Sg({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Sg(Sg({},e),{},{remainingMsForZero:sB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Sg(Sg({},e),{},{remainingMsForOne:sB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(gC(U7),gC(Gre),gC(z7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),qre={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},jre={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Wre={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},Zre=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),Yre=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return fB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return Zre.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Kre=function(){var e=function(){function e(t,n){jg(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return Zg(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return fB.of(t)}return fB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(xI),gC(Yre))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Qre={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},Xre={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},Jre={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},eie={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},tie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},nie={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},rie={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function iie(e){return(iie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){aie(e,t,n[t])})}return e}function sie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var uie={},cie={};try{"undefined"!=typeof window&&(uie=window),"undefined"!=typeof document&&(cie=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(Qwe){}var lie=(uie.navigator||{}).userAgent,hie=void 0===lie?"":lie,fie=uie,die=cie,vie=!!die.documentElement&&!!die.head&&"function"==typeof die.addEventListener&&"function"==typeof die.createElement,pie=(~hie.indexOf("MSIE")||hie.indexOf("Trident/"),"___FONT_AWESOME___"),gie="svg-inline--fa",yie=[1,2,3,4,5,6,7,8,9,10],mie=yie.concat([11,12,13,14,15,16,17,18,19,20]),kie={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},_ie=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",kie.GROUP,kie.SWAP_OPACITY,kie.PRIMARY,kie.SECONDARY].concat(yie.map(function(e){return"".concat(e,"x")})).concat(mie.map(function(e){return"w-".concat(e)})),fie.FontAwesomeConfig||{});die&&"function"==typeof die.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=sie(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=die.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(_ie[n]=r)});var Cie=oie({},{familyPrefix:"fa",replacementClass:gie,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},_ie);Cie.autoReplaceSvg||(Cie.observeMutations=!1);var wie=oie({},Cie);fie.FontAwesomeConfig=wie;var bie=fie||{};bie[pie]||(bie[pie]={}),bie[pie].styles||(bie[pie].styles={}),bie[pie].hooks||(bie[pie].hooks={}),bie[pie].shims||(bie[pie].shims=[]);var Eie=bie[pie],Sie=[];vie&&((die.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(die.readyState)||die.addEventListener("DOMContentLoaded",function e(){die.removeEventListener("DOMContentLoaded",e),Sie.map(function(e){return e()})}));var Pie,Oie="pending",Tie="fulfilled",Iie="rejected",Aie=function(){},Rie="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,xie="undefined"==typeof setImmediate?setTimeout:setImmediate,Mie=[];function Nie(){for(var e=0;e<Mie.length;e++)Mie[e][0](Mie[e][1]);Mie=[],Pie=!1}function Die(e,t){Mie.push([e,t]),Pie||(Pie=!0,xie(Nie,0))}function Lie(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=Tie;try{r=i(r)}catch(o){Bie(a,o)}}Fie(a,r)||(n===Tie&&Uie(a,r),n===Iie&&Bie(a,r))}function Fie(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===iie(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?Vie(e,r):Uie(e,r))},function(t){n||(n=!0,Bie(e,t))}),!0}}catch(i){return n||Bie(e,i),!0}return!1}function Uie(e,t){(e===t||!Fie(e,t))&&Vie(e,t)}function Vie(e,t){e._state===Oie&&(e._state="settled",e._data=t,Die(Hie,e))}function Bie(e,t){e._state===Oie&&(e._state="settled",e._data=t,Die(Gie,e))}function zie(e){e._then=e._then.forEach(Lie)}function Hie(e){e._state=Tie,zie(e)}function Gie(e){e._state=Iie,zie(e),!e._handled&&Rie&&global.process.emit("unhandledRejection",e._data,e)}function $ie(e){global.process.emit("rejectionHandled",e)}function qie(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof qie))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){Bie(t,e)}try{e(function(e){Uie(t,e)},n)}catch(r){n(r)}}(e,this)}qie.prototype={constructor:qie,_state:Oie,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(Aie),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Iie&&Rie&&Die($ie,this)),this._state===Tie||this._state===Iie?Die(Lie,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},qie.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new qie(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},qie.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new qie(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},qie.resolve=function(e){return e&&"object"===iie(e)&&e.constructor===qie?e:new qie(function(t){t(e)})},qie.reject=function(e){return new qie(function(t,n){n(e)})};var jie={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Wie(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function Zie(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Yie(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function Kie(e){return e.size!==jie.size||e.x!==jie.x||e.y!==jie.y||e.rotate!==jie.rotate||e.flipX||e.flipY}function Qie(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var Xie={x:0,y:0,width:"100%",height:"100%"};function Jie(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function eae(e){return"g"===e.tag?e.children:[e]}function tae(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,h=e.extra,f=e.watchable,d=void 0!==f&&f,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[wie.replacementClass,a?"".concat(wie.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:oie({},h.attributes,{"data-prefix":i,"data-icon":a,class:k,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},C=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(_.attributes["data-fa-i2svg"]=""),u&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(l||Wie())},children:[u]});var w=oie({},_,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:oie({},C,h.styles)}),b=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=Qie({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:oie({},Xie,{fill:"white"})},l=o.children?{children:o.children.map(Jie)}:{},h={tag:"g",attributes:oie({},u.inner),children:[Jie(oie({tag:o.tag,attributes:oie({},o.attributes,u.path)},l))]},f={tag:"g",attributes:oie({},u.outer),children:[h]},d="mask-".concat(a||Wie()),v="clip-".concat(a||Wie()),p={tag:"mask",attributes:oie({},Xie,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,f]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:eae(s)},p]};return t.push(g,{tag:"rect",attributes:oie({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},Xie)}),{children:t,attributes:n}}(w):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=Yie(e.styles);if(a.length>0&&(n.style=a),Kie(i)){var o=Qie({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:oie({},o.outer),children:[{tag:"g",attributes:oie({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:oie({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(w),E=b.attributes;return w.children=b.children,w.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:oie({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(wie.familyPrefix,"-").concat(t):r}),children:n}]}]}(w):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(Kie(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=Yie(oie({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(w)}var nae=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function rae(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof Eie.hooks.addPack||i?Eie.styles[e]=oie({},Eie.styles[e]||{},a):Eie.hooks.addPack(e,a),"fas"===e&&rae("fa",t)}var iae=Eie.styles,aae=Eie.shims,oae=function(){var e=function(e){return nae(iae,function(t,n,r){return t[r]=nae(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in iae;nae(aae,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function sae(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function uae(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?Zie(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(Zie(e[n]),'" ')},"").trim()}(r),">").concat(a.map(uae).join(""),"</").concat(t,">")}function cae(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}oae(),(cae.prototype=Object.create(Error.prototype)).constructor=cae;var lae={fill:"currentColor"},hae={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},fae=(oie({},lae,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),oie({},hae,{attributeName:"opacity"}));function dae(e){var t=e[0],n=e[1],r=sie(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(wie.familyPrefix,"-").concat(kie.GROUP)},children:[{tag:"path",attributes:{class:"".concat(wie.familyPrefix,"-").concat(kie.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(wie.familyPrefix,"-").concat(kie.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}oie({},lae,{cx:"256",cy:"364",r:"28"}),oie({},hae,{attributeName:"r",values:"28;14;28;28;14;28;"}),oie({},fae,{values:"1;0;1;1;0;1;"}),oie({},lae,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),oie({},fae,{values:"1;0;0;0;0;1;"}),oie({},lae,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),oie({},fae,{values:"0;0;1;1;0;0;"});var vae=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=oie({},e.definitions[t]||{},i[t]),rae(t,i[t]),oae()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function pae(){wie.autoAddCss&&!kae&&(function(e){if(e&&vie){var t=die.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=die.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}die.head.insertBefore(t,r)}}(function(){var e="fa",t=gie,n=wie.familyPrefix,r=wie.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),kae=!0)}function gae(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return uae(e)})}}),Object.defineProperty(e,"node",{get:function(){if(vie){var t=die.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function yae(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return sae(mae.definitions,n,r)||sae(Eie.styles,n,r)}var mae=new vae,kae=!1,_ae=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:yae(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:yae(i||{})),e(r,oie({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?jie:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,h=void 0===l?null:l,f=t.titleId,d=void 0===f?null:f,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var _=e.prefix,C=e.iconName,w=e.icon;return gae(oie({type:"icon"},e),function(){return pae(),wie.autoA11y&&(h?y["aria-labelledby"]="".concat(wie.replacementClass,"-title-").concat(d||Wie()):(y["aria-hidden"]="true",y.focusable="false")),tae({icons:{main:dae(w),mask:s?dae(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:C,transform:oie({},jie,r),symbol:a,title:h,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Cae=["*"],wae=function(e){var t,n=(Pg(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Pg(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Pg(t,"fa-pull-".concat(e.pull),null!==e.pull),Pg(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},bae=function(){var e=Zg(function e(){jg(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Eae=function(){var e=function(){function e(){jg(this,e),this.definitions={}}return Zg(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=Gg(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,zg(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Sae=function(){var e=function(){function e(){jg(this,e),this.stackItemSize="1x"}return Zg(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Km({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[ck]}),e}(),Pae=function(){var e=function(){function e(t,n){jg(this,e),this.renderer=t,this.elementRef=n}return Zg(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(fO),XE(cO))},e.\u0275cmp=$m({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[ck],ngContentSelectors:Cae,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Mk()[16][6];if(!t.projection)for(var n=t.projection=rC(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Mk(),i=Nk(),a=Pb(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),zk(),64!=(64&a.flags)&&function(e,t,n){tb(t[11],0,t,n,Fw(e,n,t),Gw(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),Oae=function(){var e=function(){function e(t,n,r,i,a){jg(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return Zg(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(zg(wae(e)),zg(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=_ae(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(CR),XE(bae),XE(Eae),XE(Sae,8),XE(Pae,8))},e.\u0275cmp=$m({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(GS("innerHTML",t.renderedIconHTML,uw),qE("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[ck],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Tae=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e}),e.\u0275inj=pm({}),e}();function Iae(e,t){if(1&e&&(iS(0),rS(1,"fa-icon",24),aS()),2&e){var n=fS();gb(1),JE("icon",n.faSpinner)}}function Aae(e,t){if(1&e){var n=oS();iS(0),tS(1,"div",9),tS(2,"a",10),US(3),nS(),tS(4,"div",12),tS(5,"a",26),cS("click",function(){return Dk(n),fS(2).logout()}),jP(6,27),nS(),nS(),nS(),aS()}if(2&e){var r=fS(2);gb(3),VS(r.username.get())}}var Rae=function(){return["/register"]},xae=function(){return["/login"]};function Mae(e,t){1&e&&(tS(0,"div",28),tS(1,"a",29),tS(2,"strong"),jP(3,30),nS(),nS(),tS(4,"a",31),jP(5,32),nS(),nS()),2&e&&(gb(1),JE("routerLink",oT(2,Rae)),gb(3),JE("routerLink",oT(3,xae)))}function Nae(e,t){if(1&e&&(KE(0,Aae,7,1,"ng-container",22),KE(1,Mae,6,4,"ng-template",null,25,MT)),2&e){var n=QE(2);JE("ngIf",fS().username.isPresent())("ngIfElse",n)}}var Dae=function(){return["/"]},Lae=function(){return["/play"]},Fae=function(){return["/lobby"]},Uae=function(){return["/local"]},Vae=function(){return["/tutorial"]},Bae=function(){return["/settings"]},zae=function(){var e=function(){function e(t,n,r){jg(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.loading=!0,this.username=fB.empty(),this.faCog=Xre,this.faSpinner=rie,this.showMenu=!1}return Zg(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.getUserObs().subscribe(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email})}},{key:"logout",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL),XE(Tre),XE(q7))},e.\u0275cmp=$m({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(g||(g=bg(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(y||(y=bg(["Play online"]))),[1,"navbar-dropdown"],$localize(m||(m=bg(["Create a game"]))),$localize(k||(k=bg(["Join a game"]))),$localize(_||(_=bg(["Play offline"]))),$localize(C||(C=bg(["Create a game"]))),$localize(w||(w=bg(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(b||(b=bg(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(E||(E=bg(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(S||(S=bg(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(P||(P=bg(["Log in"])))]},template:function(e,t){if(1&e&&(tS(0,"nav",0),tS(1,"div",1),tS(2,"a",2),rS(3,"img",3),nS(),tS(4,"a",4),cS("click",function(){return t.showMenu=!t.showMenu}),rS(5,"span",5),rS(6,"span",5),rS(7,"span",5),nS(),nS(),tS(8,"div",6),cS("click",function(){return t.showMenu=!t.showMenu}),tS(9,"div",7),tS(10,"a",2),jP(11,8),nS(),tS(12,"div",9),tS(13,"a",10),jP(14,11),nS(),tS(15,"div",12),tS(16,"a",2),jP(17,13),nS(),tS(18,"a",2),jP(19,14),nS(),nS(),nS(),tS(20,"div",9),tS(21,"a",10),jP(22,15),nS(),tS(23,"div",12),tS(24,"a",2),jP(25,16),nS(),tS(26,"a",2),jP(27,17),nS(),nS(),nS(),nS(),tS(28,"div",18),tS(29,"a",19),rS(30,"fa-icon",20),nS(),tS(31,"div",21),KE(32,Iae,2,1,"ng-container",22),KE(33,Nae,3,2,"ng-template",null,23,MT),nS(),nS(),nS(),nS()),2&e){var n=QE(34);gb(2),JE("routerLink",oT(12,Dae)),gb(2),JE("ngClass",t.showMenu?"is-active":""),gb(4),JE("ngClass",t.showMenu?"is-active":""),gb(2),JE("routerLink",oT(13,Dae)),gb(6),JE("routerLink",oT(14,Lae)),gb(2),JE("routerLink",oT(15,Fae)),gb(6),JE("routerLink",oT(16,Uae)),gb(2),JE("routerLink",oT(17,Vae)),gb(3),JE("routerLink",oT(18,Bae)),gb(1),JE("icon",t.faCog),gb(2),JE("ngIf",t.loading)("ngIfElse",n)}},directives:[XL,DA,Oae,VA],encapsulation:2}),e}(),Hae=function(){var e=Zg(function e(t,n){jg(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=Wre,this.faFacebook=qre,this.faGithub=jre});return e.\u0275fac=function(t){return new(t||e)(XE(Kre),XE(N7))},e.\u0275cmp=$m({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(O||(O=bg(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(rS(0,"app-header"),tS(1,"main",0),rS(2,"router-outlet"),nS(),tS(3,"footer",1),tS(4,"div",2),tS(5,"p"),tS(6,"span"),$P(7,3),rS(8,"strong"),qP(),nS(),US(9," \xa0 "),tS(10,"a",4),rS(11,"fa-icon",5),nS(),US(12,"\xa0 "),tS(13,"a",6),rS(14,"fa-icon",5),nS(),US(15,"\xa0 "),tS(16,"a",7),rS(17,"fa-icon",5),nS(),nS(),nS(),nS()),2&e&&(gb(11),JE("icon",t.faGithub),gb(3),JE("icon",t.faTwitter),gb(3),JE("icon",t.faFacebook))},directives:[zae,eF,Oae],encapsulation:2}),e}(),Gae=function(){function e(t,n){jg(this,e),this.x=t,this.y=n}return Zg(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),$ae=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(Gae),qae=function(){function e(){jg(this,e)}return Zg(e,[{key:"of",value:function(e,t){var n,r=Gg(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return O7.success(i)}}catch(a){r.e(a)}finally{r.f()}return O7.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?O7.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):O7.failure(Zae.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return O7.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return O7.failure("Invalid int direction: ".concat(e))}}}]),e}(),jae=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}($ae);jae.UP=new jae(0,-1),jae.UP_RIGHT=new jae(1,-1),jae.RIGHT=new jae(1,0),jae.DOWN_RIGHT=new jae(1,1),jae.DOWN=new jae(0,1),jae.DOWN_LEFT=new jae(-1,1),jae.LEFT=new jae(-1,0),jae.UP_LEFT=new jae(-1,-1),jae.factory=new(function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).all=[jae.UP,jae.UP_RIGHT,jae.RIGHT,jae.DOWN_RIGHT,jae.DOWN,jae.DOWN_LEFT,jae.LEFT,jae.UP_LEFT],e}return Zg(n)}(qae)),jae.DIRECTIONS=jae.factory.all,jae.DIAGONALS=[jae.UP_RIGHT,jae.DOWN_RIGHT,jae.DOWN_LEFT,jae.UP_LEFT],jae.ORTHOGONALS=[jae.UP,jae.RIGHT,jae.DOWN,jae.LEFT],jae.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return D7("string"==typeof e,"Invalid encoded direction"),jae.factory.fromString(e).get()}}]),n}(xre));var Wae=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}($ae);Wae.UP=new Wae(0,-1),Wae.RIGHT=new Wae(1,0),Wae.DOWN=new Wae(0,1),Wae.LEFT=new Wae(-1,0),Wae.factory=new(function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).all=[Wae.UP,Wae.RIGHT,Wae.DOWN,Wae.LEFT],e}return Zg(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?O7.success(Wae.UP):1===e&&0===t?O7.success(Wae.RIGHT):0===e&&1===t?O7.success(Wae.DOWN):-1===e&&0===t?O7.success(Wae.LEFT):O7.failure("Invalid orthogonal from x and y")}}]),n}(qae)),Wae.ORTHOGONALS=Wae.factory.all,Wae.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return D7("string"==typeof e,"Invalid encoded orthogonal"),Wae.factory.fromString(e).get()}}]),n}(xre));var Zae=function(){var e=Zg(function e(){jg(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(T||(T=bg(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),Yae=function(){function e(t,n){jg(this,e),this.x=t,this.y=n}return Zg(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return jae.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return Nre.tuple([Nre.numberEncoder(t),Nre.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();Yae.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return D7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new Yae(t.x,t.y)}}]),n}(xre));var Kae=function(){var e=function(){function e(t){jg(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=fB.empty(),this.imagesLocation="assets/images/"}return Zg(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?A7.SUCCESS:(this.messageDisplayer.gameMessage(e),A7.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case Fre.ZERO:return"player0";case Fre.ONE:return"player1";default:return sB.expectToBe(e,Lre.NONE),""}}},{key:"pass",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",N7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qae=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new Yae(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=Gg(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new Yae(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(Kae);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275cmp=$m({type:t,selectors:[["ng-component"]],features:[xE],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Xae=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===Fre.ZERO?e.ZERO:(sB.expectToBe(t,Fre.ONE),e.ONE)}}]),e}();Xae.ZERO=new Xae(Fre.ZERO.value),Xae.ONE=new Xae(Fre.ONE.value),Xae.EMPTY=new Xae(Lre.NONE.value),Xae.UNREACHABLE=new Xae(3);var Jae=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return sB.expectToBe(e,n.LEFT),300}}}]),n}($ae);Jae.UP=new Jae(0,-1),Jae.LEFT=new Jae(-1,0),Jae.UP_RIGHT=new Jae(1,-1),Jae.DOWN_LEFT=new Jae(-1,1),Jae.RIGHT=new Jae(1,0),Jae.DOWN=new Jae(0,1),Jae.factory=new(function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).all=[Jae.UP,Jae.UP_RIGHT,Jae.RIGHT,Jae.DOWN,Jae.DOWN_LEFT,Jae.LEFT],e}return Zg(n)}(qae)),Jae.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case Jae.UP:return 0;case Jae.UP_RIGHT:return 1;case Jae.RIGHT:return 2;case Jae.DOWN:return 3;case Jae.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return D7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),Jae.factory.all[e]}}]),n}(Nre));var eoe=function(){function e(t,n,r){jg(this,e),this.size=t,this.origin=n,this.orientation=r}return Zg(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new Yae(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new Yae(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new Yae(t.x+i.x,t.y+i.y))}return n}}]),e}(),toe=Zg(function e(){jg(this,e)}),noe=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return Zg(n)}(toe);noe.INSTANCE=new noe;var roe=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return Zg(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(toe);roe.INSTANCE=new roe;var ioe=function(){var e=Zg(function e(){jg(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(I||(I=bg(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(A||(A=bg(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(R||(R=bg(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(x||(x=bg(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(M||(M=bg(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(N||(N=bg(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(D||(D=bg(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(L||(L=bg(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(F||(F=bg(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(U||(U=bg(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(V||(V=bg(["There is a piece between the piece you chose and its landing space."])))},e}(),aoe=function(){function e(t,n){jg(this,e),this.ruler=t,this.name=n}return Zg(e,[{key:"toString",value:function(){return this.name}}]),e}(),ooe=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),soe=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return hB(t,e)})||t.push(e)}),t}}]),e}(),uoe=function(e){function t(e){jg(this,t),this.values=void 0===e?[]:soe.toComparableSet(e)}return Zg(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=Gg(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=Gg(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=Gg(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=Gg(this.values);try{for(n.s();!(t=n.n()).done;){if(hB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=Gg(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?fB.of(this.values[0]):fB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),coe=function(){function e(t){jg(this,e),this.turn=t}return Zg(e,[{key:"getCurrentPlayer",value:function(){return Fre.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?Fre.ZERO:Fre.ONE}}]),e}(),loe=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,r)).board=e,i}return Zg(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?fB.of(this.board[e.y][e.x]):fB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new Yae(e,t))}},{key:"forEachCoord",value:function(e){var t,n=Gg(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Og(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new Yae(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return zre.copyBiArray(this.board)}}]),n}(coe),hoe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==Xae.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===Xae.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Xae.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=Xae.EMPTY,t=Xae.UNREACHABLE,r=Xae.ZERO,i=Xae.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(loe),foe=Zg(function e(){jg(this,e)}),doe=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).coord=new Yae(e,r),i}return Zg(n)}(foe),voe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;if(jg(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return Fg(a)}return Zg(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return O7.success(new n(e,t,fB.empty()))}catch(r){return O7.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];zre.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=Jae.factory.fromDelta(a.x,a.y);if(o.isFailure())return O7.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?O7.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):O7.success(new n(i[1],r,fB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(doe);voe.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=Jae.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new Yae(i,r);if(0===e)return voe.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new Yae(s,o);return voe.fromDoubleCoord(a,u,n).get()}}]),n}(Nre));var poe=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(poe||(poe={})),poe),goe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];jg(this,e),this.map=t,this.isImmutable=n}return Zg(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=Gg(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(hB(r.key,e))return fB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return fB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=Gg(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=Gg(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(hB(i.key,e)){var a=i.value;return i.value=t,fB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),fB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return hB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new uoe(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=Gg(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(hB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=Gg(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=Gg(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(D7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===hB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),yoe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"reverse",value:function(){var e,t=new n,r=Gg(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new uoe;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(goe),moe=function(){var e=Zg(function e(){jg(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),koe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fB.empty(),i=arguments.length>3?arguments[3]:void 0;if(jg(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=fB.empty(),this.hopedValue=new goe,this.ownValue=new goe,this.possibleMoves=new goe,this.ownValue=new goe,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}moe.createdNodes++,uB(e.VERBOSE||!1,"creating "+this.myToString())}return Zg(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return moe.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return uB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return uB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);D7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=fB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new uoe(n)),new uoe(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===Fre.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,h=c===Fre.ZERO?function(e,t){return e<t}:function(e,t){return e>t},f=Gg(e);try{for(f.s();!(s=f.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(h(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&h(l,c===Fre.ZERO?n:r))break;c===Fre.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){f.e(g)}finally{f.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();D7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=fB.of(new e(o,fB.of(this),fB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){D7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=Gg(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return fB.of(r)}}catch(i){n.e(i)}finally{n.f()}return fB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=Gg(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(uB(e.VERBOSE||n,"VICTORY"),poe.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(uB(e.VERBOSE||n,"PRE_VICTORY_MIN"),poe.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(uB(e.VERBOSE||n,"PRE_VICTORY_MAX"),poe.PRE_VICTORY):(uB(e.VERBOSE||n,"DEFAULT"),poe.DEFAULT)}}]),e}();koe.VERBOSE=!1,koe.minimaxes=new goe;var _oe=function(){function e(t,n){jg(this,e),this.isEndGame=t,this.winner=n}return Zg(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===Fre.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===Fre.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();_oe.ZERO_WON=new _oe(!0,Fre.ZERO),_oe.ONE_WON=new _oe(!0,Fre.ONE),_oe.DRAW=new _oe(!0,Lre.NONE),_oe.ONGOING=new _oe(!1,Lre.NONE);var Coe=function(){function e(t){jg(this,e),this.stateType=t,this.setInitialBoard()}return Zg(e,[{key:"choose",value:function(e){var t=!1;uB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){uB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return D7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),uB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(uB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return uB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;uB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new koe(i,fB.of(this.node),fB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();koe.ruler=this,this.node=new koe(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=Gg(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);D7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),woe=function(){var e=Zg(function e(){jg(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(B||(B=bg(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(z||(z=bg(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(H||(H=bg(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(G||(G=bg(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize($||($=bg(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize(q||(q=bg(["This space is not aligned with the current line."])))},e}(),boe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return new hoe(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?A7.failure(ioe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Xae.ofPlayer(t.getCurrentOpponent())?A7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):A7.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=Xae.ofPlayer(t.getCurrentPlayer()),o=Xae.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?O7.failure(woe.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?O7.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=Xae.ofPlayer(n.getCurrentOpponent()),s=Xae.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?O7.failure(woe.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===Xae.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?O7.failure(woe.CANNOT_PUSH_YOUR_OWN_PIECES()):O7.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=Xae.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return O7.failure(woe.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=Xae.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return O7.failure(woe.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===Xae.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return O7.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?_oe.ZERO_WON:t[1]>5?_oe.ONE_WON:_oe.ONGOING}}]),n}(Coe),Eoe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new Yae(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=Gg(Jae.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=voe.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var h,f=Gg(Jae.factory.all);try{for(f.s();!(h=f.n()).done;)for(var d=h.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=voe.fromDoubleCoord(o,p,c).get();boe.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){f.e(y)}finally{f.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new uoe(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=boe.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new hoe(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=boe.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var n=e.gameState.getScores();return new ooe(n[1]-n[0])}}]),n}(aoe),Soe=function(){function e(t,n,r){jg(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=fB.empty()}return Zg(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=fB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Ooe(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Ioe(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new Toe(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new Aoe(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Roe(e,t,n)}}]),e}(),Poe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return Zg(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Soe),Ooe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,D7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return Zg(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Poe),Toe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return Zg(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(Poe),Ioe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return Zg(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Poe),Aoe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return Zg(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(Poe),Roe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isInformation",value:function(){return!0}}]),n}(Soe),xoe=Xae.EMPTY,Moe=Xae.UNREACHABLE,Noe=Xae.ZERO,Doe=Xae.ONE,Loe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(j||(j=bg(["Initial board and goal of the game"]))),$localize(W||(W=bg(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),hoe.getInitialState()),Soe.anyMove($localize(Z||(Z=bg(["Moving a piece"]))),$localize(Y||(Y=bg(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),hoe.getInitialState(),voe.fromSingleCoord(new Yae(2,6),Jae.UP).get(),$localize(K||(K=bg(["Congratulations!"])))),Soe.fromMove($localize(Q||(Q=bg(["Pushing"]))),$localize(X||(X=bg(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new hoe([[Moe,Moe,Moe,Moe,xoe,Noe,Noe,Doe,Doe],[Moe,Moe,Moe,xoe,xoe,xoe,xoe,xoe,xoe],[Moe,Moe,xoe,Noe,Noe,Noe,Doe,Noe,xoe],[Moe,xoe,xoe,xoe,xoe,xoe,xoe,xoe,xoe],[xoe,xoe,xoe,xoe,Noe,Noe,Noe,Doe,Doe],[xoe,xoe,xoe,xoe,xoe,xoe,xoe,xoe,Moe],[xoe,xoe,xoe,xoe,Noe,Doe,xoe,Moe,Moe],[xoe,xoe,xoe,Noe,xoe,xoe,Moe,Moe,Moe],[xoe,xoe,Noe,xoe,xoe,Moe,Moe,Moe,Moe]],0),[voe.fromSingleCoord(new Yae(4,4),Jae.RIGHT).get()],$localize(J||(J=bg(["Congratulations! You know everything you need to start a game!"]))),$localize(ee||(ee=bg(["Failed!"]))))]});function Foe(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",6),cS("click",function(){Dk(n);var e=fS(2).index,t=fS().index;return fS().onPieceClick(e,t)}),nS()}if(2&e){var r=fS(2).index,i=fS().index,a=fS();pS("id","piece_",r,"_",i,""),JE("ngClass",a.getPieceClasses(r,i)),qE("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function Uoe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"polyline",4),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onCaseClick(e,t)}),nS(),KE(2,Foe,1,6,"circle",5),nS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();gb(1),pS("id","case_",i,"_",o,""),JE("ngClass",s.getSquareClasses(i,o)),qE("points",s.getHexaCoordsBy(i,o)),gb(1),JE("ngIf",s.isPiece(a))}}function Voe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Uoe,3,5,"g",3),nS()),2&e){var n=t.$implicit,r=fS(2);gb(1),JE("ngIf",r.isBoard(n))}}function Boe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Voe,2,1,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function zoe(e,t){1&e&&(l_(),tS(0,"marker",7),rS(1,"polygon",8),nS()),2&e&&vS("id","arrowhead_",t.$implicit.dir.toString(),"")}function Hoe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),rS(1,"line",9),tS(2,"line",10),cS("click",function(){var e=Dk(n).$implicit;return fS().chooseDirection(e.dir)}),nS(),tS(3,"polygon",11),cS("click",function(){var e=Dk(n).$implicit;return fS().chooseDirection(e.dir)}),nS(),nS()}if(2&e){var r=t.$implicit;gb(1),vS("id","line_start_",r.dir.toString(),""),qE("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),gb(1),vS("id","line_end_",r.dir.toString(),""),qE("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),gb(1),vS("id","direction_",r.dir.toString(),""),qE("transform",r.transformation)}}var Goe=Zg(function e(t,n,r,i,a,o){jg(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),$oe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new boe(hoe),r.availableMinimaxes=[new Eoe(r.rules,"Dummy")],r.encoder=voe.encoder,r.tutorial=(new Loe).tutorial,r.scores=fB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new eoe(r.SPACE_SIZE,new Yae(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),noe.INSTANCE),r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=fB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=A7.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new Yae(e,t)],n.showPossibleDirections(),A7.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=Xae.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=Gg(Jae.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?voe.fromSingleCoord(i,u).get():voe.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),h=this.getCenterAt(c),f=this.getMiddleOfArrow(u,c,h),d=h.x+" "+h.y,v=Jae.getAngle(u)+150,p=new Goe(l,f,h,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new Yae(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==Xae.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==Xae.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new Yae(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),A7.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(woe.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),A7.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Yae(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),A7.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=jae.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=jae.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),zre.sortByDescending(r.selecteds,voe.sortCoord),r.showPossibleDirections(),A7.SUCCESS):r.cancelMove(woe.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(woe.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),A7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?voe.fromSingleCoord(a,e).get():voe.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new Yae(e,t),a=Gg(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",A7.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Yae(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new Yae(e,t),r=Fre.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(Qae);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-abalone"]],features:[xE],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Boe,2,1,"g",1),tS(2,"defs"),KE(3,zoe,2,1,"marker",2),nS(),KE(4,Hoe,4,12,"g",1),nS()),2&e&&(gb(1),JE("ngForOf",t.hexaBoard),gb(2),JE("ngForOf",t.directions),gb(1),JE("ngForOf",t.directions))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),qoe=function(){function e(t){jg(this,e),this.x=t}return Zg(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return D7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();qoe.ZERO=new qoe(0),qoe.ONE=new qoe(1),qoe.TWO=new qoe(2),qoe.THREE=new qoe(3);var joe=function(){var e=Zg(function e(){jg(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(te||(te=bg(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(ne||(ne=bg(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(re||(re=bg(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(ie||(ie=bg(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(ae||(ae=bg(["There is no possible transfer from that square!"])))},e}(),Woe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return Zg(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return sB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(fB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return O7.failure(joe.PIECE_SHOULD_MOVE_DOWNWARD());var r=sB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(fB.empty())&&n.starting.equals(fB.of(e))}));return O7.success(r)}}]),n}(foe);Woe.ALL_MOVES=[new Woe(qoe.ZERO,fB.of(Fre.ZERO),fB.empty()),new Woe(qoe.ONE,fB.of(Fre.ZERO),fB.empty()),new Woe(qoe.TWO,fB.of(Fre.ZERO),fB.empty()),new Woe(qoe.THREE,fB.of(Fre.ZERO),fB.empty()),new Woe(qoe.ZERO,fB.of(Fre.ONE),fB.empty()),new Woe(qoe.ONE,fB.of(Fre.ONE),fB.empty()),new Woe(qoe.TWO,fB.of(Fre.ONE),fB.empty()),new Woe(qoe.THREE,fB.of(Fre.ONE),fB.empty()),new Woe(qoe.TWO,fB.empty(),fB.of(qoe.THREE)),new Woe(qoe.ONE,fB.empty(),fB.of(qoe.THREE)),new Woe(qoe.ZERO,fB.empty(),fB.of(qoe.THREE)),new Woe(qoe.ONE,fB.empty(),fB.of(qoe.TWO)),new Woe(qoe.ZERO,fB.empty(),fB.of(qoe.TWO)),new Woe(qoe.ZERO,fB.empty(),fB.of(qoe.ONE))],Woe.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return Woe.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=Woe.ALL_MOVES.findIndex(function(t){return t.equals(e)});return D7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return D7(e<Woe.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),Woe.ALL_MOVES[e]}}]),n}(Nre));var Zoe=function(){function e(t){jg(this,e),this.containing=t}return Zg(e,[{key:"isFull",value:function(){return this.count(Fre.ZERO)+this.count(Fre.ONE)>=this.count(Lre.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(Fre.ZERO),r=this.count(Fre.ONE),i=this.count(Lre.NONE);return t===Fre.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(Fre.ZERO),r=this.count(Fre.ONE),i=this.count(Lre.NONE);return t===Fre.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(Fre.ZERO),t=this.count(Fre.ONE);return e>t?Fre.ZERO:t>e?Fre.ONE:Lre.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return O7.failure("invalid starting space");var i=new goe([{key:Fre.ZERO,value:t},{key:Fre.ONE,value:n},{key:Lre.NONE,value:r}]);i.makeImmutable();var a=new e(i);return O7.success(a)}}]),e}(),Yoe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return Zg(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&zre.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=Zoe.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new goe;return u.set(Fre.ZERO,r),u.set(Fre.ONE,i),new n(e,a,u)}}]),n}(coe);return e.PIECES_PER_PLAYER=10,e}(),Koe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new Yoe(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===qoe.THREE)return i.updateAt(e.landing,o);var s=qoe.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new Yoe(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?O7.failure(joe.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?O7.failure(joe.NO_PIECE_REMAINING_TO_DROP()):O7.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?O7.failure(joe.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(qoe.from(n)).isFull())return _oe.ONGOING;var r=t.getPieceAt(qoe.THREE).getDominatingPlayer();return D7(r.isPlayer(),"winner can only be a player if the game is finished"),_oe.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n(Yoe))),this.singleton.get()}}]),n}(Coe);Koe.singleton=fB.empty();var Qoe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return Woe.ALL_MOVES.filter(function(e){return Koe.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=Koe.get().getGameStatus(e);if(t.isEndGame)return ooe.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new ooe(n.getScoreModifier()):new ooe(0)}}]),n}(aoe),Xoe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(oe||(oe=bg(["Initial board and goal of the game"]))),$localize(se||(se=bg(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),Yoe.getInitialState()),Soe.anyMove($localize(ue||(ue=bg(["Drop"]))),$localize(ce||(ce=bg(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),Yoe.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),Woe.drop(qoe.ZERO,Fre.ZERO),$localize(le||(le=bg(["Congratulations!"])))),Soe.fromPredicate($localize(he||(he=bg(["Transfer"]))),$localize(fe||(fe=bg(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),Yoe.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),Woe.transfer(qoe.TWO,qoe.ZERO).get(),function(e,t){return e.isDrop()?A7.failure($localize(de||(de=bg(["This move is a drop, please do a transfer!"])))):A7.SUCCESS},$localize(ve||(ve=bg(["Congratulations!"])))),Soe.fromPredicate($localize(pe||(pe=bg(["Victory"]))),$localize(ge||(ge=bg(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),Yoe.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),Woe.drop(qoe.TWO,Fre.ONE),function(e,t){return e.isDrop()?e.piece.equalsValue(Fre.ONE)?A7.SUCCESS:A7.failure($localize(ye||(ye=bg(["You actively made your opponent win!"])))):A7.failure($localize(me||(me=bg(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(ke||(ke=bg(["Congratulations!"]))))]});function Joe(e,t){if(1&e&&(l_(),rS(0,"circle",5)),2&e){var n=t.$implicit,r=fS();qE("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function ese(e,t){if(1&e){var n=oS();l_(),tS(0,"polygon",7),cS("click",function(){Dk(n);var e=fS().index,t=fS();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),nS()}if(2&e){var r=fS().index,i=fS();vS("id","dropArrow_zero_",r,""),JE("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),qE("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ZERO))}}function tse(e,t){if(1&e){var n=oS();l_(),tS(0,"polygon",7),cS("click",function(){Dk(n);var e=fS().index,t=fS();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),nS()}if(2&e){var r=fS().index,i=fS();vS("id","dropArrow_one_",r,""),JE("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),qE("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ONE))}}function nse(e,t){if(1&e){var n=oS();l_(),iS(0),tS(1,"circle",8),cS("click",function(){Dk(n);var e=fS().index;return fS().onSquareClick(e)}),nS(),aS()}if(2&e){var r=t.$implicit,i=fS(),a=i.index,o=i.$implicit,s=fS();gb(1),gS("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),JE("ngClass",s.getPieceClasses(a,r,o)),qE("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function rse(e,t){if(1&e){var n=oS();l_(),iS(0),KE(1,ese,1,4,"polygon",6),KE(2,tse,1,4,"polygon",6),tS(3,"rect",7),cS("click",function(){var e=Dk(n).index;return fS().onSquareClick(e)}),nS(),KE(4,nse,2,6,"ng-container",3),aS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();gb(1),JE("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),gb(1),JE("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),gb(1),vS("id","square_",i,""),JE("ngClass",a.getSquareClasses(i)),qE("x",i*a.SPACE_SIZE)("y",(5-i)*a.SPACE_SIZE*.25)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),gb(1),JE("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}function ise(e,t){if(1&e&&(l_(),rS(0,"circle",9)),2&e){var n=t.$implicit,r=fS();qE("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var ase=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).PlayerOrNone=Lre,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=Yoe.PIECES_PER_PLAYER,r.selectedPiece=fB.empty(),r.leftPiece=fB.empty(),r.droppedPiece=fB.empty(),r.displayableArrow=[],r.rules=new Koe(Yoe),r.availableMinimaxes=[new Qoe(r.rules,"ApagosDummyMinimax")],r.encoder=Woe.encoder,r.tutorial=(new Xoe).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return Zg(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=fB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(Fre.ZERO).get(),this.remainingOne=e.remaining.get(Fre.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=fB.empty(),this.leftPiece=fB.empty(),this.selectedPiece=fB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=fB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===Fre.ZERO?n-1:e.count(Lre.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=fB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=fB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(Fre.ZERO).get()>0&&this.displayableArrow.push({x:t,player:Fre.ZERO}),e.remaining.get(Fre.ONE).get()>0&&this.displayableArrow.push({x:t,player:Fre.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(Lre.NONE))return new Yae(r,i);var a=n.count(Lre.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new Yae(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===Fre.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===Fre.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=qoe.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=Woe.transfer(qoe.from(s),a).get()):o=Woe.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(Fre.ZERO),o=n.count(Fre.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===Fre.ZERO?a++:o++}var s=n.count(Lre.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),A7.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(joe.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=fB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(joe.NO_POSSIBLE_TRANSFER_REMAINS()):A7.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(Kae);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-apagos"]],features:[xE],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Joe,1,3,"circle",1),tS(2,"g",2),KE(3,rse,5,9,"ng-container",3),nS(),KE(4,ise,1,3,"circle",4),nS()),2&e&&(gb(1),JE("ngForOf",t.range(t.remainingZero)),gb(1),qE("transform","translate(0, "+2*t.PIECE_RADIUS+")"),gb(1),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.range(t.remainingOne)))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ose=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n)}(Kae);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275cmp=$m({type:t,selectors:[["ng-component"]],features:[xE],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),sse=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).captured=i,a}return Zg(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(zre.createTable(6,2,4),0,[0,0])}}]),n}(loe),use=function(){var e=Zg(function e(){jg(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(_e||(_e=bg(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NONEMPTY_HOUSE=function(){return $localize(Ce||(Ce=bg(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(we||(we=bg(["You should distribute but you do not."])))},e}(),cse=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,r){uB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer().value,o=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,a,s);if(u.y===a)return new sse(s,t.turn+1,t.captured);var c=[0,0],l=zre.copyBiArray(s);return c[a]=n.capture(u.x,o,a,s),c[a]>0&&n.isStarving(o,s)&&(s=l,c=[0,0]),n.isStarving(a,s)&&!1===n.canDistribute(o,s)&&(c[o]+=n.mansoon(o,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new sse(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,a=e.x;if(0===t.getPieceAtXY(a,r))return O7.failure(use.MUST_CHOOSE_NONEMPTY_HOUSE());var o=n.isStarving(i,t.board),s=!1===n.doesDistribute(a,r,t.board);return o&&s?O7.failure(use.SHOULD_DISTRIBUTE()):O7.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new Yae(e,t)}},{key:"capture",value:function(e,t,n,r){D7(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;0===n&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?_oe.ZERO_WON:t.captured[1]>24?_oe.ONE_WON:24===t.captured[0]&&24===t.captured[1]?_oe.DRAW:_oe.ONGOING}}]),n}(Coe);return e.VERBOSE=!1,e}(),lse=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).x=e,r}return Zg(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return D7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(foe);lse.ZERO=new lse(0),lse.ONE=new lse(1),lse.TWO=new lse(2),lse.THREE=new lse(3),lse.FOUR=new lse(4),lse.FIVE=new lse(5),lse.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return lse.from(e)}}]),n}(Nre));var hse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=lse.from(a),cse.isLegal(t,r).isSuccess()&&(t=lse.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return zre.sortByDescending(t,function(t){var i,a=e.gameState.getCopiedBoard(),o=a[n][t.x],s=cse.distribute(t.x,n,a),u=0;return s.y===n?(i=0,o<=6&&(u=10)):i=cse.capture(s.x,r,n,a),100*i+u-o}),t}},{key:"getBoardValue",value:function(e){var t=cse.getGameStatus(e);if(t.isEndGame)return ooe.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new ooe(n[1]-n[0])}}]),n}(aoe),fse=Zg(function e(){jg(this,e),this.tutorial=[Soe.anyMove($localize(be||(be=bg(["Sowing"]))),$localize(Ee||(Ee=bg(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),sse.getInitialState(),lse.ZERO,$localize(Se||(Se=bg(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Soe.anyMove($localize(Pe||(Pe=bg(["Big sowing"]))),$localize(Oe||(Oe=bg(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new sse([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),lse.ONE,$localize(Te||(Te=bg(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Soe.fromMove($localize(Ie||(Ie=bg(["Simple capture"]))),$localize(Ae||(Ae=bg(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new sse([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[lse.ZERO],$localize(Re||(Re=bg(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(xe||(xe=bg(["Failed. Try again and sow from the leftmost house."])))),Soe.fromMove($localize(Me||(Me=bg(["Multiple captures"]))),$localize(Ne||(Ne=bg(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new sse([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[lse.ZERO],$localize(De||(De=bg(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(Le||(Le=bg(["Failed. Try again."])))),Soe.fromMove($localize(Fe||(Fe=bg(["Interrupted capture"]))),$localize(Ue||(Ue=bg(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new sse([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[lse.ZERO],$localize(Ve||(Ve=bg(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Be||(Be=bg(["Failed. Try again."])))),Soe.fromMove($localize(ze||(ze=bg(["Capture on the other side only"]))),$localize(He||(He=bg(["Try to capture the two leftmost houses of the opponent."]))),new sse([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[lse.ONE],$localize(Ge||(Ge=bg(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize($e||($e=bg(["You have only captured one house, try again!"])))),Soe.fromMove($localize(qe||(qe=bg(["Do not starve"]))),$localize(je||(je=bg(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new sse([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[lse.ZERO],$localize(We||(We=bg(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(Ze||(Ze=bg(["Failed. Try again."])))),Soe.anyMove($localize(Ye||(Ye=bg(["Feeding is mandatory"]))),$localize(Ke||(Ke=bg(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new sse([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),lse.THREE,$localize(Qe||(Qe=bg(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Soe.anyMove($localize(Xe||(Xe=bg(["End of the game"]))),$localize(Je||(Je=bg(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new sse([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),lse.FIVE,$localize(et||(et=bg(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function dse(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"circle",4),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(),tS(2,"text",5),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),US(3),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","click_",i,"_",a,""),JE("ngClass",o.getSquareClasses(i,a)),qE("cx",50+100*i)("cy",50+120*a),gb(1),qE("x",50+100*i)("y",66+120*a),gb(1),BS(" ",r," ")}}function vse(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,dse,4,8,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}var pse=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).last=fB.empty(),r.captured=[],r.moved=[],r.scores=fB.of([0,0]),r.rules=new cse(sse),r.availableMinimaxes=[new hse(r.rules,"AwaleMinimax")],r.encoder=lse.encoder,r.tutorial=(new fse).tutorial,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=fB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=fB.of(new Yae(t.get().x,n)),this.showPreviousMove()}else this.last=fB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new Yae(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(use.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=fB.empty(),a=lse.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Yae(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-awale-component"]],features:[xE],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),rS(1,"rect",1),KE(2,vse,2,1,"g",2),rS(3,"line",3),nS()),2&e&&(gb(2),JE("ngForOf",t.board))},directives:[FA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),gse=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;if(jg(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(ioe.MOVE_CANNOT_BE_STATIC());return i.end=r,Fg(i)}return Zg(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return jae.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){Ng(a,r);var i=Lg(a);function a(){var n;return jg(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return Zg(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Yae((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new Yae((r-=r%1)%e,o);return n(s,a)}}]),a}(Nre))}}]),n}(doe),yse=function(){var e=Zg(function e(){jg(this,e)});return e.LANDING_ON_OCCUPIED_CASE=function(){return $localize(tt||(tt=bg(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(nt||(nt=bg(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(rt||(rt=bg(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(it||(it=bg(["Tafl moves must be orthogonal."])))},e}(),mse=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;if(jg(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(yse.MOVE_MUST_BE_ORTHOGONAL());return Fg(i)}return Zg(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(gse),kse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return O7.success(r)}catch(r){return O7.failure(r.message)}}}]),n}(mse);kse.encoder=gse.getEncoder(7,7,kse.of);var _se={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:Fre.ZERO},Cse=function(){function e(t,n){jg(this,e),this.owner=t,this.king=n}return Zg(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Cse.UNOCCUPIED=new Cse(Lre.NONE,!1),Cse.PLAYER_ONE_KING=new Cse(Fre.ONE,!0),Cse.INVADERS=new Cse(Fre.ZERO,!1),Cse.DEFENDERS=new Cse(Fre.ONE,!1);var wse=Zg(function e(t){jg(this,e),this.value=t});wse.NONE=new wse("NONE"),wse.OPPONENT=new wse("OPPONENT"),wse.PLAYER=new wse("PLAYER");var bse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new Yae(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===Lre.NONE?wse.NONE:e===n?wse.PLAYER:wse.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(loe),Ese=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Cse.UNOCCUPIED,t=Cse.INVADERS,r=Cse.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Cse.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(bse),Sse=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return Zg(n,[{key:"isLegal",value:function(e,t){uB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?O7.failure(i.getReason()):O7.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===wse.NONE)return A7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE());if(r===wse.OPPONENT)return A7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==wse.NONE)return A7.failure(yse.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return A7.failure(yse.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return A7.failure(yse.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Cse.UNOCCUPIED)return A7.failure(ioe.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return A7.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===wse.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):fB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,h=a.right,f=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,h,i):s===wse.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,h):s===wse.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,h,f):fB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):wse.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):wse.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):wse.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===wse.PLAYER?1:0;return 2===(i+=t===wse.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(uB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),fB.of(r)):fB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return fB.of(t)}else{var i=r===wse.PLAYER,a=n===wse.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return fB.of(t)}return fB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=wse.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===wse.NONE?!1===this.isThrone(i,s)?(uB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),fB.empty()):(uB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.of(o)):u===wse.PLAYER?(uB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.of(o)):(uB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return fB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===wse.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===wse.PLAYER||l&&s)?(uB(n.VERBOSE||!1,"king captured by 4 invaders"),fB.of(t)):fB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){uB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Cse.UNOCCUPIED;var u,c=Gg(Wae.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=this.tryCapture(a,e.end,l,t);h.isPresent()&&(i[h.get().y][h.get().x]=Cse.UNOCCUPIED)}}catch(f){c.e(f)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?_oe.getVictory(t.get()):_oe.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return uB(t,"The king is dead, victory to invader"),fB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(uB(t,"The king escape, victory to defender"),fB.of(this.getDefender())):this.isPlayerImmobilized(Fre.ZERO,e)?(uB(t,"Zero has no move, victory to one"),fB.of(Fre.ONE)):this.isPlayerImmobilized(Fre.ONE,e)?(uB(t,"One has no move, victory to zero"),fB.of(Fre.ZERO)):(uB(t,"no victory"),fB.empty())}},{key:"getKingCoord",value:function(e){uB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return fB.of(new Yae(r,t));return fB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);uB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=Gg(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=Gg(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,h=this.generateMove(u,l);r.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new Yae(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=Gg(Wae.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===Lre.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(Coe);return e.VERBOSE=!1,e}(),Pse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,Ese,_se,kse.of)}return Zg(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),koe.ruler=this.singleton,n.singleton}}]),n}(Sse),Ose=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=Cse.UNOCCUPIED,a.captureds=[],a.chosen=new Yae(-1,-1),a.lastMove=fB.empty(),a}return Zg(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){uB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=Gg(Wae.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===wse.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===Cse.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===Lre.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return uB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(uB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,a=new Yae(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(o.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(o.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return uB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===Cse.UNOCCUPIED?this.cancelMove(ioe.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new Yae(e,t),this.updateViewInfo(),uB(this.VERBOSE,"selected piece = ("+e+", "+t+")"),A7.SUCCESS):this.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new Yae(e,t);return n.getRelativeOwner(r,i)===wse.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new Yae(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new Yae(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new Yae(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new Yae(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new Yae(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new Yae(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Cse.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(ose),Tse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){uB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?zre.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):zre.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new ooe(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(Fre.ZERO,t).length,i=this.ruler.getPlayerListPawns(Fre.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=Fre.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=Fre.ONE.getScoreModifier(),new ooe(r*a+i*o)}}]),n}(aoe),Ise=function(){function e(t,n){jg(this,e),this.directThreats=t,this.mover=n}return Zg(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),Ase=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,new uoe([e]),r)).directThreat=e,i.mover=r,i}return Zg(n)}(Ise),Rse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){Ng(r,e);var n=Lg(r);function r(e){var t;if(jg(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=Gg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return Fg(t)}return Zg(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=Gg(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=Gg(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(uoe,Symbol.iterator)),xse=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return Zg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var n,r=e.gameState,i=Cse.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=Gg(Fre.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,h=n.value,f=Gg(o.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=h.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=Gg(Wae.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*h.getScoreModifier()}}}catch(k){f.e(k)}finally{f.f()}}}catch(k){c.e(k)}finally{c.f()}return new ooe(a)}},{key:"getPiecesMap",value:function(e){for(var t=Cse.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new Yae(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===Fre.ZERO?n.push(o):r.push(o))}return new goe([{key:Fre.ZERO,value:new Rse(n)},{key:Fre.ONE,value:new Rse(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new goe,i=Gg(Fre.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Gg(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new uoe(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);D7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=Gg(Wae.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],h=Gg(Wae.ORTHOGONALS);try{for(h.s();!(c=h.n()).done;){var f=c.value;if(f!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===Cse.UNOCCUPIED;)d=d.getNext(f);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){h.e(v)}finally{h.f()}a.push(new Ase(u,new Rse(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==Fre.ONE&&t.getPieceAt(e)!==Cse.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=Gg(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new goe,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Rse(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=Gg(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),h=[],f=Gg(l);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=Gg(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(w){g.e(w)}finally{g.f()}p.length>0&&h.push(new Ase(d.directThreat,new Rse(p)))}}}catch(w){f.e(w)}finally{f.f()}h.length>0&&r.set(c,new uoe(h))}}catch(w){s.e(w)}finally{s.f()}var m,k=Gg(o);try{for(k.s();!(m=k.n()).done;){var _=m.value,C=e.get(_).get();r.set(_,C)}}catch(w){k.e(w)}finally{k.f()}return r}}]),n}(Tse),Mse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=Cse.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),h=Gg(Fre.PLAYERS);try{for(h.s();!(r=h.n()).done;){var f,d=r.value,v=new Rse,p=Gg(u.get(d).get());try{for(p.s();!(f=p.n()).done;){var g=f.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=Gg(Wae.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,_=g.getNext(k,1);_.isInRange(a,a)&&i.getPieceAt(_)===o;)v.add(_),_=_.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var C,w=Gg(v);try{for(w.s();!(C=w.n()).done;){var b=C.value,E=n.CONTROL_VALUE[b.y][b.x];s+=d.getScoreModifier()*E}}catch(S){w.e(S)}finally{w.f()}}}catch(S){h.e(S)}finally{h.f()}return new ooe(s)}}]),n}(xse);Mse.SCORE_BY_THREATENED_PIECE=530,Mse.SCORE_BY_SAFE_PIECE=16*Mse.SCORE_BY_THREATENED_PIECE+1,Mse.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Nse=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=Cse.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),h=this.filterThreatMap(l,r),f=Gg(Fre.PLAYERS);try{for(f.s();!(n=f.n()).done;){var d,v=n.value,p=new Rse,g=Gg(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(h.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=Gg(Wae.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var _=m.value,C=y.getNext(_,1);C.isInRange(i,i)&&r.getPieceAt(C)===a;)p.add(C),C=C.getNext(_,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var w,b=Gg(p);try{for(b.s();!(w=b.n()).done;){var E=w.value,S=Mse.CONTROL_VALUE[E.y][E.x];u+=v.getScoreModifier()*S}}catch(O){b.e(O)}finally{b.f()}}}catch(O){f.e(O)}finally{f.f()}var P=this.getStepForEscape(r);return new ooe(531*P*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?fB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?fB.of(t):(t++,r.push.apply(r,zg(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=Gg(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Gg(Wae.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Cse.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return a}}]),n}(Mse);Nse.SCORE_BY_THREATENED_PIECE=530,Nse.SCORE_BY_SAFE_PIECE=16*Mse.SCORE_BY_THREATENED_PIECE+1,Nse.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Dse=Cse.UNOCCUPIED,Lse=Cse.INVADERS,Fse=Cse.DEFENDERS,Use=Cse.PLAYER_ONE_KING,Vse=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(at||(at=bg(["Goal of the game"]))),$localize(ot||(ot=bg(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Ese.getInitialState()),Soe.anyMove($localize(st||(st=bg(["Moving"]))),$localize(ut||(ut=bg(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Ese.getInitialState(),kse.of(new Yae(3,1),new Yae(1,1)),$localize(ct||(ct=bg(["Congratulations!"])))),Soe.fromMove($localize(lt||(lt=bg(["Capturing a soldier (1/2)"]))),$localize(ht||(ht=bg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Ese([[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Lse,Dse,Dse,Fse,Dse,Dse,Dse],[Dse,Dse,Fse,Use,Fse,Lse,Lse],[Dse,Dse,Lse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Fse,Dse,Lse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse]],1),[kse.of(new Yae(3,5),new Yae(2,5))],$localize(ft||(ft=bg(["Congratulations, that will teach him a lesson!"]))),$localize(dt||(dt=bg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Soe.fromMove($localize(vt||(vt=bg(["Capturing a soldier (2/2)"]))),$localize(pt||(pt=bg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Ese([[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Dse,Dse,Lse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Fse,Dse,Dse,Dse],[Lse,Fse,Dse,Dse,Fse,Lse,Lse],[Dse,Fse,Dse,Dse,Dse,Dse,Dse],[Dse,Lse,Dse,Use,Dse,Lse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse]],12),[kse.of(new Yae(2,1),new Yae(3,1)),kse.of(new Yae(3,0),new Yae(3,1))],$localize(gt||(gt=bg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(yt||(yt=bg(["Failed, you did not do the expected move."])))),Soe.fromMove($localize(mt||(mt=bg(["Capturing the king on his throne"]))),$localize(kt||(kt=bg(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Ese([[Dse,Dse,Dse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Fse,Dse,Dse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Dse,Lse,Dse,Use,Lse,Dse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Dse,Fse,Dse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Dse,Dse,Dse,Dse]],72),[kse.of(new Yae(1,3),new Yae(2,3))],$localize(_t||(_t=bg(["Congratulations, you won!"]))),$localize(Ct||(Ct=bg(["Failed, you let the king run away."])))),Soe.fromMove($localize(wt||(wt=bg(["Capturing the king next to his throne"]))),$localize(bt||(bt=bg(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Ese([[Dse,Dse,Lse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Dse,Dse,Dse,Use,Lse,Dse,Dse],[Dse,Lse,Fse,Dse,Fse,Dse,Dse],[Dse,Dse,Dse,Lse,Dse,Dse,Dse],[Dse,Dse,Dse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Dse,Dse,Dse,Dse]],72),[kse.of(new Yae(2,0),new Yae(2,2))],$localize(Et||(Et=bg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(St||(St=bg(["Failed!"])))),Soe.fromMove($localize(Pt||(Pt=bg(["Capturing the king far from his throne"]))),$localize(Ot||(Ot=bg(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Ese([[Dse,Dse,Dse,Dse,Dse,Dse,Dse],[Dse,Dse,Dse,Dse,Dse,Dse,Dse],[Dse,Lse,Dse,Lse,Dse,Dse,Dse],[Lse,Dse,Dse,Dse,Fse,Dse,Dse],[Dse,Dse,Dse,Fse,Dse,Dse,Dse],[Dse,Dse,Dse,Dse,Dse,Dse,Dse],[Dse,Use,Dse,Lse,Dse,Dse,Dse]],72),[kse.of(new Yae(3,6),new Yae(2,6))],$localize(Tt||(Tt=bg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(It||(It=bg(["Failed!"]))))]});function Bse(e,t){1&e&&(l_(),rS(0,"polyline",8))}function zse(e,t){1&e&&(l_(),rS(0,"polyline",9))}function Hse(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Bse,1,0,"polyline",6),KE(2,zse,1,0,"ng-template",null,7,MT),nS()),2&e){var n=QE(3),r=fS().index,i=fS().index,a=fS();gb(1),JE("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Gse(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"line",10),rS(2,"line",10),rS(3,"line",10),rS(4,"line",10),rS(5,"line",10),nS()),2&e){var n=fS(2).index,r=fS().index,i=fS();gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function $se(e,t){if(1&e&&(l_(),rS(0,"polyline",15)),2&e){var n=fS(3).index,r=fS().index;JE("ngClass",fS().viewInfo.pieceClasses[r][n])}}function qse(e,t){if(1&e&&(l_(),rS(0,"line",10),rS(1,"line",10),rS(2,"line",10),rS(3,"line",10)),2&e){var n=fS(3).index,r=fS().index,i=fS();JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function jse(e,t){if(1&e&&(l_(),KE(0,$se,1,1,"polyline",13),KE(1,qse,4,20,"ng-template",null,14,MT)),2&e){var n=QE(2),r=fS(2).index,i=fS().index;JE("ngIf",fS().isKing(r,i))("ngIfElse",n)}}function Wse(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"circle",10),KE(2,Gse,6,25,"g",11),KE(3,jse,3,2,"ng-template",null,12,MT),nS()),2&e){var n=QE(4),r=fS().index,i=fS().index,a=fS();gb(1),JE("ngClass",a.viewInfo.pieceClasses[i][r]),qE("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),gb(1),JE("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Zse(e,t){if(1&e){var n=oS();l_(),tS(0,"g",3),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),rS(1,"rect",4),KE(2,Hse,4,2,"g",5),KE(3,Wse,5,6,"g",5),nS()}if(2&e){var r=t.index,i=fS().index,a=fS();pS("id","click_",r,"_",i,""),qE("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),gb(1),JE("ngClass",a.getRectClasses(r,i)),qE("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),gb(1),JE("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),gb(1),JE("ngIf",a.board[i][r]!==a.EMPTY)}}function Yse(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Zse,4,8,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Kse(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",16),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e.x,e.y)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),pS("id","click_",r.x,"_",r.y,""),qE("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Qse=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e,!1,kse.from)).rules=Pse.get(),r.availableMinimaxes=[new Tse(r.rules,"DummyBot"),new xse(r.rules,"Piece > Influence"),new Mse(r.rules,"Piece > Control"),new Nse(r.rules,"Escape > Piece > Control")],r.encoder=kse.encoder,r.tutorial=(new Vse).tutorial,r}return Zg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-brandhub"]],features:[xE],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Yse,2,1,"g",1),KE(2,Kse,2,6,"g",1),nS()),2&e&&(qE("viewBox",t.getViewBox()),gb(1),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.getClickables()))},directives:[FA,DA,VA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Xse=function(){var e,t=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return Zg(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Yae(.5*this.SPACE_SIZE*e,i);return[o,new Yae(n,a),new Yae(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Yae(.5*this.SPACE_SIZE*e,a);return[o,new Yae(n,i),new Yae(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(Kae);return t.\u0275fac=function(n){return(e||(e=q_(t)))(n||t)},t.\u0275cmp=$m({type:t,selectors:[["ng-component"]],features:[xE],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Jse=function(){var e=Zg(function e(){jg(this,e)});return e.INVALID_DISTANCE=function(){return $localize(At||(At=bg(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(Rt||(Rt=bg(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(xt||(xt=bg(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Mt||(Mt=bg(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(Nt||(Nt=bg(["You cannot capture your own pieces."])))},e}(),eue=function(){function e(t,n){jg(this,e),this.direction=t,this.str=n}return Zg(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(Jse.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();eue.LEFT=new eue(new Gae(-2,0),"LEFT"),eue.UP_LEFT=new eue(jae.UP_LEFT,"UP_LEFT"),eue.UP_RIGHT=new eue(jae.UP_RIGHT,"UP_RIGHT"),eue.RIGHT=new eue(new Gae(2,0),"RIGHT"),eue.DOWN_LEFT=new eue(jae.DOWN_LEFT,"DOWN_LEFT"),eue.DOWN_RIGHT=new eue(jae.DOWN_RIGHT,"DOWN_RIGHT"),eue.STEPS=[eue.LEFT,eue.UP_LEFT,eue.UP_RIGHT,eue.RIGHT,eue.DOWN_LEFT,eue.DOWN_RIGHT];var tue=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return Zg(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new Yae(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(fB.of(e),fB.of(t),fB.of(r),fB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(fB.empty(),fB.empty(),fB.empty(),fB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=eue.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(foe);tue.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?tue.fromTilesExchange(new Yae(n,t)):tue.fromMovement(new Yae(n,t),eue.STEPS[e-1])}}]),n}(Nre));var nue=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"getNeighbors",value:function(e){var t=new Yae(e.x-1,e.y),n=new Yae(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new Yae(e.x,e.y-1)]:[t,n,new Yae(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new Yae(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return fB.of(o);s++}a++}return fB.empty()}}]),e}(),rue=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=Gg(nue.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(loe),iue=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return Zg(n,[{key:"applyLegalMovement",value:function(e){uB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=Xae.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Xae.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){uB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=Gg(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return nue.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,Xae.EMPTY).length}},{key:"capture",value:function(e){uB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return uB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=Xae.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){uB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=Gg(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===Xae.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){D7(this.getPieceAt(e)!==Xae.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new Gae(n,t),1);if(this.getPieceAt(r)!==Xae.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=fB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==Xae.UNREACHABLE&&(r.isAbsent()&&(r=fB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){uB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=Xae.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=Gg(eue.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===Xae.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new Yae(n,t),Xae.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new Yae(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new Yae(e.x+1,e.y-1),new Yae(e.x+3,e.y+0),new Yae(e.x+3,e.y+1),new Yae(e.x+1,e.y+2),new Yae(e.x-1,e.y+1),new Yae(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=Xae.EMPTY,t=Xae.UNREACHABLE,r=Xae.ZERO,i=Xae.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(rue);iue.VERBOSE=!1,iue.NEIGHBORS_TILES_DIRECTIONS=[new Gae(0,-2),new Gae(3,-1),new Gae(3,1),new Gae(0,2),new Gae(-3,1),new Gae(-3,-1)],iue.isInRange=function(e){return e.isInRange(15,10)};var aue=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=Xae.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new iue(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new iue(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return uB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new iue(a.board,t.turn+1,a.tiles,a.captures);return uB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return O7.failure(Jse.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===Xae.UNREACHABLE||n===Xae.EMPTY?O7.failure(Jse.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?O7.failure(Jse.CANNOT_CAPTURE_OWN_PIECES()):O7.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===Xae.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return O7.failure(n)}if(t.getPieceAt(e.landingCoord.get())===Xae.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return O7.failure(r)}var i=t.getPieceAt(e.start.get());return i===Xae.EMPTY?O7.failure(ioe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?O7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?_oe.ZERO_WON:t.captures[1]>=18?_oe.ONE_WON:_oe.ONGOING}}]),n}(Coe);return e.VERBOSE=!1,e}(),oue=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=Xae.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new Yae(o,a);if(n.getPieceAt(s)===i){var u=tue.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Yae(a,i);if(n.getPieceAt(o).is(r)){var s,u=Gg(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=tue.fromCoordToCoord(o,c);t.push(l)}}catch(h){u.e(h)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=aue.getGameStatus(e);if(t.isEndGame)return ooe.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new ooe(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return zre.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(aoe),sue=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=aue.getGameStatus(e);if(t.isEndGame)return ooe.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=Gg(Fre.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,h=r.value,f=Gg(a.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;s.get(d).isPresent()?u+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){f.e(v)}finally{f.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new ooe(u)}},{key:"getPiecesMap",value:function(e){for(var t=new goe,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Yae(a,i),s=e.getPieceAt(o);s===Xae.ZERO?n.push(o):s===Xae.ONE&&r.push(o)}return t.set(Fre.ZERO,new Rse(n)),t.set(Fre.ONE,new Rse(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new goe,i=Gg(Fre.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Gg(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=Fre.of(t.getPieceAt(e).value).getOpponent(),i=fB.empty(),a=fB.empty(),o=[],s=nue.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=Gg(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=fB.of(c));else if(l===Xae.EMPTY){if(i.isPresent())return fB.empty();i=fB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var h,f=[],d=Gg(eue.STEPS);try{var v=function(){var e=h.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&f.push(n)};for(d.s();!(h=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(f.length>0)return fB.of(new Ise(new Rse(o),new Rse(f)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new Rse(o);return fB.of(new Ise(p,new Rse([a.get()])))}return fB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=fB.empty(),a=iue.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new Gae(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=fB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=iue.getTilesUpperLeftCoord(e),i=Gg(eue.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=iue.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===Xae.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new goe,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Rse(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=Gg(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),h=fB.empty(),f=Gg(l.directThreats);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=Gg(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(w){g.e(w)}finally{g.f()}p.length>0&&(h=fB.of(new Ise(l.directThreats,new Rse(p))))}}}catch(w){f.e(w)}finally{f.f()}h.isPresent()&&r.set(c,h.get())}}catch(w){s.e(w)}finally{s.f()}var m,k=Gg(o);try{for(k.s();!(m=k.n()).done;){var _=m.value,C=e.get(_).get();r.set(_,C)}}catch(w){k.e(w)}finally{k.f()}return r}}]),n}(oue);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),uue=Xae.EMPTY,cue=Xae.UNREACHABLE,lue=Xae.ZERO,hue=Xae.ONE,fue=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Dt||(Dt=bg(["Board and goal of the game"]))),$localize(Lt||(Lt=bg(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),iue.getInitialState()),Soe.anyMove($localize(Ft||(Ft=bg(["Move"]))),$localize(Ut||(Ut=bg(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),iue.getInitialState(),tue.fromCoordToCoord(new Yae(3,5),new Yae(5,5)),$localize(Vt||(Vt=bg(["Congratulations! Let's see captures now."])))),Soe.fromMove($localize(Bt||(Bt=bg(["Capture"]))),$localize(zt||(zt=bg(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new iue([[cue,cue,cue,cue,cue,cue,lue,uue,lue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,lue,uue,uue,uue,uue,uue,lue,uue,uue,cue,cue,cue],[uue,hue,uue,hue,lue,hue,uue,uue,lue,uue,uue,hue,uue,hue,uue],[hue,uue,uue,uue,uue,uue,uue,uue,uue,uue,hue,uue,uue,uue,hue],[uue,hue,uue,hue,uue,uue,uue,uue,uue,uue,uue,hue,uue,hue,uue],[uue,lue,uue,lue,uue,uue,uue,uue,uue,uue,uue,lue,uue,lue,uue],[lue,uue,uue,uue,lue,uue,uue,uue,uue,uue,lue,uue,uue,uue,lue],[uue,lue,uue,lue,uue,uue,hue,uue,hue,uue,uue,lue,uue,lue,uue],[cue,cue,cue,uue,uue,hue,uue,uue,uue,hue,uue,uue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,hue,uue,hue,cue,cue,cue,cue,cue,cue]],3,[0,0],[0,0]),[tue.fromCoordToCoord(new Yae(5,2),new Yae(4,1)),tue.fromCoordToCoord(new Yae(3,4),new Yae(4,3))],$localize(Ht||(Ht=bg(["Congratulations!"]))),$localize(Gt||(Gt=bg(["Failed, you have not captured any piece."])))),Soe.fromMove($localize($t||($t=bg(["Gain a tile"]))),$localize(qt||(qt=bg(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new iue([[cue,cue,cue,cue,cue,cue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,hue,uue,uue,cue,cue,cue,cue,cue,cue],[uue,uue,uue,cue,cue,cue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[uue,uue,hue,uue,uue,uue,uue,lue,uue,cue,cue,cue,cue,cue,cue],[uue,uue,uue,hue,uue,uue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[uue,uue,uue,uue,uue,uue,uue,uue,uue,uue,uue,lue,cue,cue,cue],[uue,uue,lue,uue,uue,hue,uue,uue,uue,uue,lue,uue,uue,uue,lue],[uue,uue,uue,uue,uue,uue,hue,uue,hue,uue,uue,lue,uue,lue,uue],[cue,cue,cue,uue,uue,hue,uue,uue,uue,hue,uue,uue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,hue,uue,hue,cue,cue,cue,cue,cue,cue]],2,[0,0],[0,0]),[tue.fromCoordToCoord(new Yae(2,6),new Yae(4,6)),tue.fromCoordToCoord(new Yae(2,6),new Yae(3,5)),tue.fromCoordToCoord(new Yae(2,6),new Yae(3,7))],$localize(jt||(jt=bg(["Congratulations!"]))),$localize(Wt||(Wt=bg(["Failed, you have not gained the two tiles that you could, try again!"])))),Soe.fromMove($localize(Zt||(Zt=bg(["Exchanging a tile"]))),$localize(Yt||(Yt=bg(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new iue([[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,uue,lue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,uue,uue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,uue,uue,hue,uue,hue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,uue,hue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,hue,uue,hue,cue,cue,cue,cue,cue,cue]],1,[0,2],[0,0]),[tue.fromTilesExchange(new Yae(5,5))],$localize(Kt||(Kt=bg(["Congratulations!"]))),$localize(Qt||(Qt=bg(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Soe.fromMove($localize(Xt||(Xt=bg(["Special capture"]))),$localize(Jt||(Jt=bg(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new iue([[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,uue,uue,lue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,uue,lue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,lue,hue,uue,hue,uue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,hue,lue,uue,uue,uue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,uue,uue,hue,cue,cue,cue,cue,cue,cue,cue,cue,cue],[cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue,cue]],1,[0,0],[0,0]),[tue.fromCoordToCoord(new Yae(7,6),new Yae(6,5)),tue.fromCoordToCoord(new Yae(7,6),new Yae(8,5))],$localize(en||(en=bg(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(tn||(tn=bg(["Failed!"]))))]});function due(e,t){if(1&e&&(l_(),rS(0,"polygon",13)),2&e){var n=fS().index,r=fS().index,i=fS();JE("ngClass",i.getPyramidClass(n,r)),qE("points",i.getPyramidCoordinate(n,r))}}function vue(e,t){if(1&e&&(l_(),rS(0,"polygon",15)),2&e){var n=fS(2).index,r=fS().index,i=fS();JE("ngClass",i.getEmptyClass(n,r)),qE("points",i.getTriangleCoordinate(n,r))}}function pue(e,t){if(1&e&&(l_(),KE(0,vue,1,2,"polygon",14)),2&e){var n=fS().index,r=fS().index;JE("ngIf",fS().isEmptyCase(n,r))}}function gue(e,t){if(1&e&&(l_(),rS(0,"polygon",16)),2&e){var n=fS().index,r=fS().index,i=fS();pS("id","dark_line_",n,"_",r,""),qE("points",i.getLineCoordinate(n,r))}}function yue(e,t){if(1&e&&(l_(),rS(0,"polygon",17)),2&e){var n=fS().index,r=fS().index,i=fS();pS("id","dark_line_",n,"_",r,""),qE("points",i.getLineCoordinate(n,r))}}function mue(e,t){if(1&e){var n=oS();l_(),tS(0,"g",8),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),KE(1,due,1,2,"polygon",9),KE(2,pue,1,1,"ng-template",null,10,MT),KE(4,gue,1,3,"polygon",11),KE(5,yue,1,3,"polygon",12),nS()}if(2&e){var r=t.$implicit,i=t.index,a=QE(3),o=fS().index,s=fS();pS("id","click_",i,"_",o,""),gb(1),JE("ngIf",s.isPyramid(i,o))("ngIfElse",a),gb(3),JE("ngIf",r!==s.NONE),gb(1),JE("ngIf",r!==s.NONE)}}function kue(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,mue,6,6,"g",7),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function _ue(e,t){if(1&e&&(l_(),rS(0,"polygon",18)),2&e){var n=t.$implicit;qE("points",fS().getTriangleCoordinate(n.x,n.y))}}function Cue(e,t){if(1&e&&(l_(),rS(0,"polygon",19)),2&e){var n=fS();qE("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function wue(e,t){if(1&e&&(l_(),rS(0,"polygon",19)),2&e){var n=fS();qE("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function bue(e,t){if(1&e&&(l_(),rS(0,"polygon",20)),2&e){var n=fS();qE("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Eue(e,t){if(1&e&&(l_(),tS(0,"g",21),rS(1,"polygon",22),tS(2,"text",23),US(3),nS(),nS()),2&e){var n=fS();gb(1),qE("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),gb(1),qE("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),gb(1),VS(n.tiles[0])}}function Sue(e,t){if(1&e&&(l_(),tS(0,"g",24),rS(1,"polygon",25),tS(2,"text",26),US(3),nS(),nS()),2&e){var n=fS();gb(1),qE("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),gb(1),qE("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),gb(1),VS(n.tiles[1])}}var Pue=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=Xae.UNREACHABLE,r.chosenCoord=fB.empty(),r.lastStart=fB.empty(),r.lastEnd=fB.empty(),r.highlights=[],r.scores=fB.of([0,0]),r.rules=new aue(iue),r.availableMinimaxes=[new oue(r.rules,"Normal"),new sue(r.rules,"Piece > Threat > Tiles")],r.encoder=tue.encoder,r.tutorial=(new fue).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){this.chosenCoord=fB.empty(),this.state=this.rules.node.gameState,this.scores=fB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=fB.empty(),this.lastEnd=fB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Yae(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=tue.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=fB.of(e),t.showHighlight(),A7.SUCCESS):t.cancelMove(Jse.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),A7.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=tue.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(Jse.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===Xae.ZERO?this.getPlayerClass(Fre.ZERO):n===Xae.ONE?this.getPlayerClass(Fre.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===Xae.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===Xae.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===Xae.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===Xae.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(Xse);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-coerceo"]],features:[xE],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,kue,2,1,"g",1),KE(2,_ue,1,1,"polygon",2),KE(3,Cue,1,1,"polygon",3),KE(4,wue,1,1,"polygon",3),KE(5,bue,1,1,"polygon",4),KE(6,Eue,4,6,"g",5),KE(7,Sue,4,6,"g",6),nS()),2&e&&(qE("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),gb(1),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.highlights),gb(1),JE("ngIf",t.lastStart.isPresent()),gb(1),JE("ngIf",t.lastEnd.isPresent()),gb(1),JE("ngIf",t.chosenCoord.isPresent()),gb(1),JE("ngIf",t.mustShowTilesOf(0)),gb(1),JE("ngIf",t.mustShowTilesOf(1)))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Oue=function(){var e=Zg(function e(){jg(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(nn||(nn=bg(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(rn||(rn=bg(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(an||(an=bg(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(on||(on=bg(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(sn||(sn=bg(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(un||(un=bg(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(cn||(cn=bg(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Tue=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(zre.createTable(n.WIDTH,n.HEIGHT,Lre.NONE),0)}}]),n}(loe);Tue.WIDTH=17,Tue.HEIGHT=17,Tue.CENTRAL_ZONE_TOP_LEFT=new Yae(4,6),Tue.CENTRAL_ZONE_BOTTOM_RIGHT=new Yae(12,10),Tue.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Tue.ALL_SHELTERS=new uoe(Tue.SHELTERS_INDICES.flatMap(function(e){return[new Yae(e,0),new Yae(e,Tue.HEIGHT-1),new Yae(0,e),new Yae(Tue.WIDTH-1,e)]})).toList();var Iue=function(e){Ng(n,e);var t=Lg(n);function n(e){return jg(this,n),t.call(this,e.x,e.y)}return Zg(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Tue.WIDTH,Tue.HEIGHT)?O7.success(new n(e)):O7.failure("Move out of board")}}]),n}(doe);Iue.encoder=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){Ng(a,r);var i=Lg(a);function a(){var e;return jg(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return Zg(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Yae((r-=r%1)%e,i);return n(a)}}]),a}(Nre))}}]),e}().getEncoder(Tue.WIDTH,Tue.HEIGHT,function(e){return Iue.of(e).get()});var Aue=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Tue.WIDTH,Tue.HEIGHT)&&t.isInRange(Tue.WIDTH,Tue.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?O7.success(new n(e,t)):O7.failure(Oue.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):O7.failure("Move out of board")}}]),n}(gse);Aue.encoder=gse.getEncoder(Tue.WIDTH,Tue.HEIGHT,function(e,t){return Aue.of(e,t).get()});var Rue=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).coords=e,r}return Zg(n,[{key:"addJump",value:function(e){var t=zre.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return O7.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=Gg(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Tue.WIDTH,Tue.HEIGHT))return O7.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return O7.failure(Oue.INVALID_JUMP());return new Rse(e).size()===e.length?O7.success(new n(e)):O7.failure(Oue.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(foe);Rue.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).coordEncoder=Yae.numberEncoder(Tue.WIDTH,Tue.HEIGHT),e}return Zg(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){D7(null!=sB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=sB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Rue.of(t).get()}}]),n}(Mre));var xue=Mre.disjunction3(Iue.encoder,Aue.encoder,Rue.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Mue=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,Tue)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=Lre.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=Lre.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Tue(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?O7.failure(Oue.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?O7.failure(Oue.MUST_DROP_IN_CENTRAL_ZONE()):O7.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?O7.failure(Oue.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE()):O7.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return O7.failure(Oue.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE());var n,r=Gg(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===Lre.NONE)return O7.failure(Oue.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=Gg(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return O7.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new Yae(e.x+2,e.y),new Yae(e.x-2,e.y),new Yae(e.x,e.y+2),new Yae(e.x,e.y-2),new Yae(e.x+2,e.y+2),new Yae(e.x+2,e.y-2),new Yae(e.x-2,e.y+2),new Yae(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Rue.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=Gg(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=Gg(Tue.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return _oe.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return _oe.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(Coe);Mue.singleton=fB.empty();var Nue=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Tue.CENTRAL_ZONE_TOP_LEFT,r=Tue.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===Lre.NONE&&t.push(Iue.of(new Yae(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Tue.HEIGHT;r++)for(var i=0;i<Tue.WIDTH;i++){var a=new Yae(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new Yae(t.x+1,t.y),new Yae(t.x-1,t.y),new Yae(t.x,t.y+1),new Yae(t.x,t.y-1),new Yae(t.x+1,t.y+1),new Yae(t.x+1,t.y-1),new Yae(t.x-1,t.y+1),new Yae(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=Aue.of(t,a);o.isSuccess()&&Mue.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new uoe,i=Gg(Mue.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Rue.of([t,a]).get();Mue.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Mue.get().nextJumps(t,e),i=new uoe(r),a=Gg(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new goe([{key:Fre.ZERO,value:0},{key:Fre.ONE,value:0}]),i=0;i<Tue.HEIGHT;i++)for(var a=0;a<Tue.WIDTH;a++){var o=new Yae(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new ooe(s.getVictoryValue())}else{var u,c=100,l=Gg(Tue.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(t.getPieceAt(h)===Lre.NONE){var f=o.getOrthogonalDistance(h);c=Math.min(c,f)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new ooe(n)}}]),n}(aoe),Due=Lre.NONE,Lue=Lre.ZERO,Fue=Lre.ONE,Uue=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(ln||(ln=bg(["Board and aim of the game"]))),$localize(hn||(hn=bg(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Tue.getInitialState()),Soe.anyMove($localize(fn||(fn=bg(["Initial phase"]))),$localize(dn||(dn=bg(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Tue.getInitialState(),Iue.of(new Yae(7,7)).get(),$localize(vn||(vn=bg(["Congratulations!"])))),Soe.fromPredicate($localize(pn||(pn=bg(["Simple move"]))),$localize(gn||(gn=bg(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Tue([[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Lue,Fue,Fue,Lue,Lue,Fue,Lue,Fue,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Fue,Lue,Fue,Lue,Lue,Lue,Lue,Fue,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Fue,Due,Due,Due,Due,Due,Fue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Fue,Lue,Lue,Fue,Fue,Fue,Lue,Lue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Fue,Lue,Fue,Fue,Fue,Fue,Fue,Fue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due]],40),Aue.of(new Yae(4,6),new Yae(3,5)).get(),function(e,t){return e.isSimple()?A7.SUCCESS:A7.failure($localize(yn||(yn=bg(["You have made a jump, not a simple move. Try again!"]))))},$localize(mn||(mn=bg(["Congratulations!"])))),Soe.fromPredicate($localize(kn||(kn=bg(["Jumps"]))),$localize(_n||(_n=bg(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Tue([[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Lue,Fue,Fue,Lue,Lue,Fue,Lue,Fue,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Fue,Lue,Fue,Lue,Lue,Lue,Lue,Fue,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Fue,Due,Due,Due,Due,Due,Fue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Fue,Lue,Lue,Fue,Fue,Fue,Lue,Lue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Fue,Lue,Fue,Fue,Fue,Fue,Fue,Fue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due]],40),Rue.of([new Yae(6,7),new Yae(6,5)]).get(),function(e,t){return e.isJump()?A7.SUCCESS:A7.failure($localize(Cn||(Cn=bg(["You have not performed a jump. Try again!"]))))},$localize(wn||(wn=bg(["Congratulations!"])))),Soe.fromMove($localize(bn||(bn=bg(["Chaining jumps in a single move"]))),$localize(En||(En=bg(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Tue([[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Fue,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Fue,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Fue,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Lue,Due,Fue,Lue,Lue,Fue,Lue,Fue,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Due,Lue,Fue,Lue,Lue,Lue,Lue,Fue,Due,Due,Due,Due],[Due,Due,Due,Due,Lue,Fue,Due,Due,Due,Due,Due,Fue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Fue,Lue,Lue,Fue,Fue,Fue,Lue,Lue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Fue,Lue,Fue,Fue,Fue,Fue,Fue,Fue,Lue,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due],[Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due,Due]],40),[Rue.of([new Yae(8,6),new Yae(6,4),new Yae(6,2),new Yae(6,0)]).get()],$localize(Sn||(Sn=bg(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Pn||(Pn=bg(["You have not performed a triple jump. Try again!"]))))]});function Vue(e,t){if(1&e){var n=oS();l_(),tS(0,"rect",9),cS("click",function(){Dk(n);var e=fS().$implicit;return fS(2).onClick(e.coord)}),nS()}if(2&e){var r=fS().$implicit,i=fS(2);qE("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function Bue(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",6),cS("click",function(){Dk(n);var e=fS().$implicit;return fS(2).onClick(e.coord)}),nS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();pS("id","piece_",i,"_",o,""),JE("ngClass",a.pieceClasses),qE("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function zue(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",6),cS("click",function(){var e=Dk(n).$implicit;return fS(2).onClick(e.coord)}),nS(),KE(2,Vue,1,4,"rect",7),KE(3,Bue,1,6,"circle",8),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","click_",i,"_",a,""),JE("ngClass",r.squareClasses),qE("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r.isShelter),gb(1),JE("ngIf",r.hasPiece)}}function Hue(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,zue,4,9,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Gue(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",10),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),JE("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),qE("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function $ue(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=t.$implicit,r=fS();vS("id","sidePiece_0_",n,""),qE("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function que(e,t){if(1&e&&(l_(),rS(0,"circle",12)),2&e){var n=t.$implicit,r=fS();vS("id","sidePiece_1_",n,""),qE("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function jue(e,t){if(1&e&&(l_(),rS(0,"rect",13)),2&e){var n=fS();qE("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var Wue=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).ALL_SHELTERS=Tue.ALL_SHELTERS,r.CENTRAL_ZONE_START=Tue.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new Gae(Tue.CENTRAL_ZONE_BOTTOM_RIGHT.x-Tue.CENTRAL_ZONE_TOP_LEFT.x+1,Tue.CENTRAL_ZONE_BOTTOM_RIGHT.y-Tue.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=fB.empty(),r.jumpInConstruction=fB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=Mue.get(),r.availableMinimaxes=[new Nue(r.rules,"ConspirateursMinimax")],r.encoder=xue,r.tutorial=(new Uue).tutorial,r}return Zg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Tue.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Tue.WIDTH;n++){var r=new Yae(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=Gg(Tue.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=Gg(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Mue.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=Gg(Tue.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=Gg(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=fB.empty(),this.selected=fB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=fB.of(e),t.jumpInConstruction=fB.empty(),t.updateViewInfo(),A7.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Iue.of(e),n.abrupt("return",(D7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(ioe.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=fB.of(e),t.updateViewInfo(),A7.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=Aue.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Rue.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(Kae);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-conspirateurs"]],features:[xE],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Hue,2,1,"g",1),KE(2,Gue,2,5,"g",1),KE(3,$ue,1,4,"circle",2),KE(4,que,1,4,"circle",3),KE(5,jue,1,4,"rect",4),rS(6,"polyline",5),nS()),2&e&&(gb(1),JE("ngForOf",t.viewInfo.boardInfo),gb(1),JE("ngForOf",t.ALL_SHELTERS),gb(1),JE("ngForOf",t.range(t.viewInfo.sidePieces[0])),gb(1),JE("ngForOf",t.range(t.viewInfo.sidePieces[1])),gb(1),JE("ngIf",t.viewInfo.dropPhase),gb(1),qE("points",t.viewInfo.lastMoveArrow))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Zue=function(){function e(t,n){jg(this,e),this.owner=t,this.otherPieceType=n}return Zg(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===Fre.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===Fre.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();Zue.encoder=Nre.tuple([Fre.numberEncoder,Nre.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return Zue.of(e[0],e[1])}),Zue.EMPTY=new Zue(Lre.NONE,!1),Zue.ZERO_FIRST=new Zue(Fre.ZERO,!1),Zue.ZERO_SECOND=new Zue(Fre.ZERO,!0),Zue.ONE_FIRST=new Zue(Fre.ONE,!1),Zue.ONE_SECOND=new Zue(Fre.ONE,!0),Zue.PLAYER_PIECES=[Zue.ZERO_FIRST,Zue.ZERO_SECOND,Zue.ONE_FIRST,Zue.ONE_SECOND];var Yue=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;if(jg(this,n),(i=t.call(this)).target=e,i.piece=r,r===Zue.EMPTY)throw new Error("Cannot drop an empty piece");return Fg(i)}return Zg(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(foe);Yue.encoder=Nre.tuple([Nre.numberEncoder(7),Zue.encoder],function(e){return[e.target,e.piece]},function(e){return new Yue(e[0],e[1])});var Kue=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return Zg(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new Yae(e.x,3-e.y),t)}}]),n}(foe);Kue.encoder=Nre.tuple([Yae.numberEncoder(8,4),Nre.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new Kue(e[0],e[1]?"clockwise":"counterclockwise")});var Que=Nre.disjunction(Yue.encoder,Kue.encoder,function(e){return e.isDrop()}),Xue=function(){var e=Zg(function e(){jg(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(On||(On=bg(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(Tn||(Tn=bg(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(In||(In=bg(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(An||(An=bg(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(Rn||(Rn=bg(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),Jue=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return Zg(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==Zue.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=Zue.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==Zue.EMPTY&&i[n.pieceIndex(s)]--}return D7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case Zue.ZERO_FIRST:return 0;case Zue.ZERO_SECOND:return 1;case Zue.ONE_FIRST:return 2;default:return sB.expectToBe(e,Zue.ONE_SECOND),3}}}]),n}(loe);return e.WIDTH=8,e.HEIGHT=4,e}(),ece=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,Jue)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=zre.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=zre.copyImmutableArray(t.remainingPieces);return r[Jue.pieceIndex(e.piece)]-=1,new Jue(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=zre.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<Jue.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==Zue.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=Zue.EMPTY,i++,a++;return new Jue(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?O7.failure(Xue.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===Jue.HEIGHT?O7.failure(Xue.SPACE_IS_FULL()):O7.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Jue.HEIGHT?O7.failure(Xue.TARGET_STACK_TOO_HIGH()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return D7(n.owner.isPlayer(),"highest alignment is owned by a player"),_oe.getVictory(n.owner)}return _oe.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<Jue.WIDTH/2;t++)for(var n=Jue.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+Jue.WIDTH/2,n);if(r!==Zue.EMPTY&&r===i)return fB.of(new Yae(t,n))}return fB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new Kue(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new Kue(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(Coe);ece.singleton=fB.empty();var tce=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=Gg(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new Kue(i,"clockwise"),new Kue(i,"counterclockwise")];a<o.length;a++){var s=o[a];ece.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<Jue.WIDTH;r++){var i,a=Gg(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new Yue(r,o);ece.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=Gg(Zue.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Jue.HEIGHT;r++)for(var i=0;i<Jue.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new Yae(i,r));return t}},{key:"getBoardValue",value:function(e){var t=ece.get().getGameStatus(e);return new ooe(t.isEndGame?t.toBoardValue():0)}}]),n}(aoe),nce=Zue.EMPTY,rce=Zue.ZERO_FIRST,ice=Zue.ZERO_SECOND,ace=Zue.ONE_FIRST,oce=Zue.ONE_SECOND,sce=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(xn||(xn=bg(["Initial board and player pieces"]))),$localize(Mn||(Mn=bg(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),Jue.getInitialState()),Soe.fromMove($localize(Nn||(Nn=bg(["Goal of the game"]))),$localize(Dn||(Dn=bg(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),Jue.fromRepresentation([[nce,nce,nce,nce,nce,nce,nce,nce],[nce,nce,nce,nce,nce,nce,nce,nce],[nce,nce,nce,nce,ace,nce,nce,nce],[rce,nce,nce,nce,rce,nce,nce,nce]],3),[new Yue(0,Zue.ONE_FIRST)],$localize(Ln||(Ln=bg(["Congratulations, you won!"]))),$localize(Fn||(Fn=bg(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Soe.fromMove($localize(Un||(Un=bg(["Types of move"]))),$localize(Vn||(Vn=bg(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),Jue.fromRepresentation([[nce,nce,nce,nce,nce,nce,nce,nce],[nce,nce,nce,nce,oce,nce,nce,nce],[nce,nce,nce,nce,rce,nce,nce,nce],[ace,nce,nce,nce,ice,nce,nce,nce]],4),[Kue.fromRepresentation(new Yae(4,3),"counterclockwise"),Kue.fromRepresentation(new Yae(4,3),"clockwise"),Kue.fromRepresentation(new Yae(4,2),"counterclockwise"),Kue.fromRepresentation(new Yae(4,2),"clockwise")],$localize(Bn||(Bn=bg(["Congratulations!"]))),$localize(zn||(zn=bg(["Failed, try to move one of your piece that is already on the board."])))),Soe.fromMove($localize(Hn||(Hn=bg(["Special case"]))),$localize(Gn||(Gn=bg(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),Jue.fromRepresentation([[nce,nce,nce,nce,rce,nce,nce,nce],[nce,nce,nce,nce,oce,nce,nce,rce],[nce,nce,nce,nce,rce,nce,nce,oce],[nce,ace,nce,nce,ice,nce,nce,ace]],8),[Kue.fromRepresentation(new Yae(4,2),"counterclockwise")],$localize($n||($n=bg(["Congratulations!"]))),$localize(qn||(qn=bg(["Failed, try to shift a stack of pieces to the left."]))))]});function uce(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"path",6),cS("click",function(){var e=Dk(n).$implicit;return fS().onSpaceClick(e)}),nS(),tS(2,"path",7),cS("click",function(){var e=Dk(n).$implicit;return fS().onSpaceClick(e)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),vS("id","click_",r,""),JE("ngClass",i.viewInfo.boardInfo[r].spaceClasses),qE("d",i.BOARD_PATHS[r]),gb(1),JE("ngClass",i.viewInfo.boardInfo[r].spaceClasses),qE("d",i.DECORATION_PATHS[r])}}function cce(e,t){if(1&e){var n=oS();l_(),tS(0,"g",9),cS("click",function(){var e=Dk(n).$implicit,t=fS().$implicit;return fS().onPieceInGameClick(t,e.y)}),rS(1,"use",10),rS(2,"use",11),nS()}if(2&e){var r=t.$implicit;pS("id","click_",fS().$implicit,"_",r.y,""),JE("ngClass",r.foregroundClasses),gb(1),JE("ngClass",r.backgroundClasses),qE("x",r.drawPosition.x)("y",r.drawPosition.y),gb(1),qE("x",r.drawPosition.x)("y",r.drawPosition.y)}}function lce(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,cce,3,8,"g",8),nS()),2&e){var n=t.$implicit,r=fS();gb(1),JE("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function hce(e,t){if(1&e){var n=oS();l_(),tS(0,"g",12),cS("click",function(){var e=Dk(n).$implicit;return fS().onRemainingPieceClick(e.actualPiece)}),rS(1,"use",10),rS(2,"use",11),nS()}if(2&e){var r=t.$implicit;pS("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),JE("ngClass",r.foregroundClasses),gb(1),JE("ngClass",r.backgroundClasses),qE("x",r.drawPosition.x)("y",r.drawPosition.y),gb(1),qE("x",r.drawPosition.x)("y",r.drawPosition.y)}}var fce=function(){return[0,1,2,3,4,5,6,7]},dce=function(){return[2,1,3,0,4,7,5,6]},vce=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=fB.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=ece.get(),r.availableMinimaxes=[new tce(r.rules,"DiamDummyMinimax")],r.encoder=Que,r.tutorial=(new sce).tutorial,r}return Zg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new Yue(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%Jue.WIDTH!==e){n.next=10;break}i=new Kue(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(Jue.WIDTH-1))%Jue.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(Xue.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new Kue(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(Xue.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=fB.of({type:"pieceFromBoard",position:new Yae(e,t)}),n.updateViewInfo(),A7.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(ioe.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=fB.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),A7.SUCCESS):t.cancelMove(ioe.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new Yae(r,i);return[{start:fB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<Jue.HEIGHT&&t.getPieceAtXY(n,o)!==Zue.EMPTY;o++,i++)a.push({start:fB.of(new Yae(n,o)),end:new Yae(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<Jue.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;D7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<Jue.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;D7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=Gg(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=Gg(Zue.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===Fre.ZERO?-100:600,i=e.otherPieceType?100:450,new Yae(r,i).getNext(new Gae(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<Jue.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new Yae(e,i);if(a!==Zue.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new Gae(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=fB.empty(),this.updateBoard()}}]),n}(Kae);vce.CENTER=[new Yae(40,160),new Yae(100,50),new Yae(255,2),new Yae(400,50),new Yae(460,160),new Yae(400,270),new Yae(255,320),new Yae(100,270)],vce.PIECE_HEIGHT=36,vce.\u0275fac=function(e){return new(e||vce)(XE(M7))},vce.\u0275cmp=$m({type:vce,selectors:[["app-diam"]],features:[xE],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"defs"),tS(2,"g",1),rS(3,"path",2),rS(4,"ellipse",3),nS(),nS(),KE(5,uce,3,5,"g",4),KE(6,lce,2,1,"g",4),KE(7,hce,3,8,"g",5),nS()),2&e&&(gb(5),JE("ngForOf",oT(3,fce)),gb(1),JE("ngForOf",oT(4,dce)),gb(1),JE("ngForOf",t.viewInfo.remainingPieces))},directives:[FA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var pce=function(){function e(t,n){jg(this,e),this.offset=t,this.constant=n}return Zg(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return Jae.DOWN;case"r":return Jae.RIGHT;case"s":return Jae.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?fB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?fB.of(e.constantR(a)):r!==i&&a!==o&&s===u?fB.of(e.constantS(s)):fB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=Gg(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),gce=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,D7(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return Zg(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=Gg(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(pce.constantQ(t));for(var n=0;n<this.height;n++)e.push(pce.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(pce.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new Yae(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new Yae(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new Yae(e.offset,0):new Yae(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=N7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new Yae(e.x+t,e.y-t),new Yae(e.x+t,e.y),new Yae(e.x-t,e.y+t),new Yae(e.x-t,e.y),new Yae(e.x,e.y+t),new Yae(e.x,e.y-t)]}}]),n}(loe),yce=function(){function e(t,n,r){jg(this,e),this.owner=t,this.size=n,this.source=r}return Zg(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();yce.sizeEncoder=Nre.numberEncoder(49),yce.encoder=Nre.tuple([Nre.booleanEncoder,Fre.numberEncoder,yce.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new yce(e[1],e[2],e[0])}),yce.MAX_SIZE=49,yce.EMPTY=new yce(Lre.NONE,0,!1),yce.UNREACHABLE=new yce(Lre.NONE,-1,!1),yce.PLAYER_ZERO=new yce(Fre.ZERO,1,!1),yce.PLAYER_ONE=new yce(Fre.ONE,1,!1),yce.SOURCE=new yce(Lre.NONE,1,!0);var mce=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_CASES,yce.EMPTY)).alreadyPassed=i,a}return Zg(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new Yae(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return gce.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=zre.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==yce.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=yce.UNREACHABLE,t=yce.PLAYER_ZERO,n=yce.PLAYER_ONE,r=yce.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==yce.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(gce);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_CASES=[2,1],e}(),kce=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!mce.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!mce.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(gse);kce.PASS=new kce(new Yae(-1,-1),new Yae(-2,-2)),kce.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return kce.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new kce(new Yae((e=e/16|0)%16,r),new Yae(n,t))}}]),n}(Nre));var _ce=function(){var e=Zg(function e(){jg(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(jn||(jn=bg(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(Wn||(Wn=bg(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(Zn||(Zn=bg(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(Yn||(Yn=bg(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Kn||(Kn=bg(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Qn||(Qn=bg(["The stack must land on an occupied space."])))},e}(),Cce=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isMovablePiece",value:function(e,t){D7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?A7.failure(_ce.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?A7.failure(_ce.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?A7.SUCCESS:A7.failure(_ce.CANT_REACH_TARGET()):A7.failure(_ce.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;gce.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=zre.createTable(mce.WIDTH,mce.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,yce.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===kce.PASS)return new mce(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,yce.EMPTY).setAt(e.end,yce.append(r,i));return this.removeDisconnectedPieces(new mce(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==kce.PASS||t.alreadyPassed?O7.failure(ioe.MUST_PASS()):O7.success(void 0);if(e===kce.PASS)return O7.failure(ioe.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?O7.failure(_ce.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?O7.failure(_ce.EMPTY_TARGET_STACK()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?_oe.ZERO_WON:r[0]<r[1]?_oe.ONE_WON:_oe.DRAW:_oe.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==gce.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return gce.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(Fre.ZERO)?t+=i.getSize():i.belongsTo(Fre.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(Coe),wce=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Cce.getMovablePieces(n).forEach(function(e){return Cce.pieceTargets(n,e).forEach(function(t){var n=kce.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(kce.PASS)&&r.push(kce.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Cce.getScores(t);return 0===Cce.getMovablePieces(t).length?new ooe(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new ooe(n[0]-n[1])}}]),n}(aoe),bce=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=xg(Bg(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return zre.sortByDescending(r,function(e){D7(e!==kce.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Cce.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var n=e.gameState,r=Cce.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(Fre.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(Fre.ONE)}).length;return new ooe((s*r[1]-o*r[0])/a)}}]),n}(wce),Ece=yce.EMPTY,Sce=yce.UNREACHABLE,Pce=yce.SOURCE,Oce=yce.PLAYER_ZERO,Tce=yce.PLAYER_ONE,Ice=new yce(Fre.ZERO,2,!1),Ace=new yce(Fre.ONE,2,!1),Rce=new yce(Fre.ZERO,4,!1),xce=new yce(Fre.ONE,4,!1),Mce=Zg(function e(){jg(this,e),this.tutorial=[Soe.anyMove($localize(Xn||(Xn=bg(["Moving"]))),$localize(Jn||(Jn=bg(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),mce.getInitialState(),kce.of(new Yae(2,0),new Yae(3,0)),$localize(er||(er=bg(["Congratulations!"])))),Soe.fromPredicate($localize(tr||(tr=bg(["Disconnection"]))),$localize(nr||(nr=bg(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new mce([[Sce,Sce,Tce,Pce,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Sce,Ece,Oce,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,xce,Ece,Ece,Ece,Ece,Tce,Pce,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce,Sce]],0,!1),kce.of(new Yae(2,1),new Yae(2,0)),function(e,t){return e.end.equals(new Yae(3,0))?A7.failure($localize(rr||(rr=bg(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(D7(e.end.equals(new Yae(2,0)),"player made an impossible move"),A7.SUCCESS)},$localize(ir||(ir=bg(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Soe.fromPredicate($localize(ar||(ar=bg(["Moving on a source"]))),$localize(or||(or=bg(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new mce([[Sce,Sce,Pce,Tce,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Sce,Oce,Oce,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Tce,Oce,Tce,Ece,Ece,Oce,Ace,Pce,Ece,Ece],[Ece,Ece,Tce,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce,Sce]],0,!1),kce.of(new Yae(2,1),new Yae(2,0)),function(e,t){return e.end.equals(new Yae(2,0))?A7.SUCCESS:A7.failure($localize(sr||(sr=bg(["You have not taken possession of a source, try again."]))))},$localize(ur||(ur=bg(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Soe.informational($localize(cr||(cr=bg(["Passing"]))),$localize(lr||(lr=bg(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new mce([[Sce,Sce,Pce,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Sce,Ece,Ice,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ace,Ece,Ece,Ece,Ece,Ace,Pce,Rce,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce,Sce]],0,!1)),Soe.fromMove($localize(hr||(hr=bg(["End of the game"]))),$localize(fr||(fr=bg(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new mce([[Sce,Sce,Pce,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Sce,Ece,Oce,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Pce,Rce,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce,Sce]],0,!1),[kce.of(new Yae(2,1),new Yae(2,0))],$localize(dr||(dr=bg(["Congratulations, you won 6 - 0!"]))),$localize(vr||(vr=bg(["Bad idea, by moving on the source you would have won a point."]))))]});function Nce(e,t){if(1&e&&(l_(),rS(0,"circle",10)),2&e){var n=fS().$implicit,r=fS().$implicit,i=fS();JE("ngClass",i.getPieceClasses(n)),qE("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Dce(e,t){if(1&e&&(l_(),rS(0,"polygon",11)),2&e){var n=fS().$implicit,r=fS().$implicit,i=fS();qE("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function Lce(e,t){if(1&e){var n=oS();l_(),tS(0,"text",12),cS("click",function(){Dk(n);var e=fS(2).$implicit;return fS().onClick(e.x,e.y)}),US(1),nS()}if(2&e){var r=fS().$implicit,i=fS().$implicit,a=fS();qE("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),gb(1),VS(r.getSize())}}function Fce(e,t){if(1&e){var n=oS();l_(),tS(0,"g",5),cS("click",function(){Dk(n);var e=fS().$implicit;return fS().onClick(e.x,e.y)}),rS(1,"polyline",6),KE(2,Nce,1,4,"circle",7),KE(3,Dce,1,1,"polygon",8),KE(4,Lce,2,3,"text",9),nS()}if(2&e){var r=t.$implicit,i=fS().$implicit,a=fS();pS("id","click_",i.x,"_",i.y,""),gb(1),qE("points",a.getHexaCoordsAt(i)),gb(1),JE("ngIf",r.getSize()>0),gb(1),JE("ngIf",r.containsSource()),gb(1),JE("ngIf",r.getSize()>1)}}var Uce=function(e){return[e]};function Vce(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Fce,5,6,"g",4),nS()),2&e){var n=t.$implicit,r=fS();gb(1),JE("ngForOf",sT(1,Uce,r.state.getPieceAt(n)))}}function Bce(e,t){if(1&e&&(l_(),tS(0,"text",16),US(1),nS()),2&e){var n=fS().$implicit,r=fS();qE("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),gb(1),VS(n.caseContent.getSize())}}function zce(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"polyline",13),rS(2,"circle",14),KE(3,Bce,2,3,"text",15),nS()),2&e){var n=t.$implicit,r=fS();gb(1),qE("points",r.getHexaCoordsAt(n.coord)),gb(1),pS("id","captured_",n.coord.x,"_",n.coord.y,""),JE("ngClass",r.getPieceClasses(n.caseContent)),qE("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),gb(1),JE("ngIf",n.caseContent.getSize()>1)}}function Hce(e,t){if(1&e&&(l_(),iS(0),rS(1,"polyline",17),rS(2,"polyline",17),aS()),2&e){var n=fS();gb(1),qE("points",n.getHexaCoordsAt(n.lastMove.get().coord)),gb(1),qE("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function Gce(e,t){if(1&e&&(l_(),rS(0,"polyline",18)),2&e){var n=fS();qE("points",n.getHexaCoordsAt(n.chosen.get()))}}var $ce=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).lastMove=fB.empty(),r.chosen=fB.empty(),r.disconnecteds=[],r.rules=new Cce(mce),r.availableMinimaxes=[new wce(r.rules,"DvonnMinimax"),new bce(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=kce.encoder,r.tutorial=(new Mce).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=fB.of(Cce.getScores(r.rules.node.gameState)),r.hexaLayout=new eoe(1.5*r.SPACE_SIZE,new Yae(-r.SPACE_SIZE,2*r.SPACE_SIZE),noe.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return Zg(n,[{key:"hideLastMove",value:function(){this.lastMove=fB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=fB.of(Cce.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new Yae(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new Yae(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=fB.empty()}},{key:"pass",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(kce.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new Yae(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),A7.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new Yae(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=fB.of(n),A7.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Yae(e,t),o=kce.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(Qae);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-dvonn"]],features:[xE],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Vce,2,3,"g",1),KE(2,zce,4,8,"g",1),KE(3,Hce,3,2,"ng-container",2),KE(4,Gce,1,1,"polyline",3),nS()),2&e&&(gb(1),JE("ngForOf",t.state.allCoords()),gb(1),JE("ngForOf",t.disconnecteds),gb(1),JE("ngIf",t.lastMove.isPresent()),gb(1),JE("ngIf",t.chosen.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),qce=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(qce||(qce={})),qce),jce=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return Fre.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return Fre.ONE;default:return Lre.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return qce.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return qce.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return qce.SMALL;default:return sB.expectToBe(this,e.NONE),qce.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return sB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===Fre.ZERO&&t===qce.BIG?e.BIG_DARK:n===Fre.ZERO&&t===qce.MEDIUM?e.MEDIUM_DARK:n===Fre.ZERO&&t===qce.SMALL?e.SMALL_DARK:n===Fre.ONE&&t===qce.BIG?e.BIG_LIGHT:n===Fre.ONE&&t===qce.MEDIUM?e.MEDIUM_LIGHT:n===Fre.ONE&&t===qce.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();jce.SMALL_DARK=new jce(0),jce.SMALL_LIGHT=new jce(1),jce.MEDIUM_DARK=new jce(2),jce.MEDIUM_LIGHT=new jce(3),jce.BIG_DARK=new jce(4),jce.BIG_LIGHT=new jce(5),jce.NONE=new jce(6);var Wce=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return Zg(n,[{key:"getRemainingPieces",value:function(){return zre.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new Zce(Lre.NONE,Lre.NONE,Lre.NONE).encode(),t=zre.createTable(3,3,e);return new n(zre.mapBiArray(t,function(e){return Zce.decode(e)}),0,[jce.BIG_DARK,jce.BIG_DARK,jce.BIG_LIGHT,jce.BIG_LIGHT,jce.MEDIUM_DARK,jce.MEDIUM_DARK,jce.MEDIUM_LIGHT,jce.MEDIUM_LIGHT,jce.SMALL_DARK,jce.SMALL_DARK,jce.SMALL_LIGHT,jce.SMALL_LIGHT])}}]),n}(loe),Zce=function(){function e(t,n,r){jg(this,e),this.small=t,this.medium=n,this.big=r}return Zg(e,[{key:"isEmpty",value:function(){return this.small===Lre.NONE&&this.medium===Lre.NONE&&this.big===Lre.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(jce.ofSizeAndPlayer(qce.SMALL,this.small)),this.medium.isPlayer()&&e.push(jce.ofSizeAndPlayer(qce.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(jce.ofSizeAndPlayer(qce.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=jce.ofSizeAndPlayer(qce.SMALL,this.small),t=jce.ofSizeAndPlayer(qce.MEDIUM,this.medium),n=jce.ofSizeAndPlayer(qce.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===Fre.ZERO?jce.BIG_DARK:this.big===Fre.ONE?jce.BIG_LIGHT:this.medium===Fre.ZERO?jce.MEDIUM_DARK:this.medium===Fre.ONE?jce.MEDIUM_LIGHT:this.small===Fre.ZERO?jce.SMALL_DARK:this.small===Fre.ONE?jce.SMALL_LIGHT:jce.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===jce.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?fB.of(this.put(e)):fB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===jce.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case qce.BIG:t=new e(this.small,this.medium,Lre.NONE);break;case qce.MEDIUM:t=new e(this.small,Lre.NONE,Lre.NONE);break;default:sB.expectToBe(r,qce.SMALL),t=new e(Lre.NONE,Lre.NONE,Lre.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===jce.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case qce.BIG:return new e(this.small,this.medium,n);case qce.MEDIUM:return D7(this.big===Lre.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return sB.expectToBe(r,qce.SMALL),D7(this.big===Lre.NONE,"Cannot put a piece on top of a bigger one"),D7(this.medium===Lre.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){D7(t%1==0,"EncapsuleCase must be encoded as integer: "+t),D7(t>=0,"To small representation for EncapsuleCase: "+t),D7(t<=26,"To big representation for EncapsuleCase: "+t);var n=Fre.numberEncoder.decodeNumber(t%3);t-=n.value;var r=Fre.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,Fre.numberEncoder.decodeNumber(t/=3))}}]),e}();Zce.EMPTY=new Zce(Lre.NONE,Lre.NONE,Lre.NONE);var Yce=function(){var e=Zg(function e(){jg(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(pr||(pr=bg(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(gr||(gr=bg(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(yr||(yr=bg(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(mr||(mr=bg(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(kr||(kr=bg(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(_r||(_r=bg(["You are performing a move, you must select a landing square."])))},e}(),Kce=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=Zce.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=Zce.decode(c).removeBiggest();i[u.y][u.x]=Zce.decode(l.removedCase.encode()),r=l.removedPiece}return new Wce(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=Gg(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return fB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===Lre.NONE?fB.empty():t[0]===t[1]&&t[1]===t[2]?fB.of(t[0]):fB.empty()}},{key:"isLegal",value:function(e,t){var n;if(uB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return O7.failure(Yce.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?O7.success(i.get()):O7.failure(Yce.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?_oe.getVictory(t.get()):_oe.ONGOING}}]),n}(Coe);Kce.LINES=[[new Yae(0,0),new Yae(0,1),new Yae(0,2)],[new Yae(1,0),new Yae(1,1),new Yae(1,2)],[new Yae(2,0),new Yae(2,1),new Yae(2,2)],[new Yae(0,0),new Yae(1,0),new Yae(2,0)],[new Yae(0,1),new Yae(1,1),new Yae(2,1)],[new Yae(0,2),new Yae(1,2),new Yae(2,2)],[new Yae(0,0),new Yae(1,1),new Yae(2,2)],[new Yae(0,2),new Yae(1,1),new Yae(2,0)]];var Qce=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return Zg(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(fB.of(e),t,fB.empty())}},{key:"fromDrop",value:function(e,t){return new n(fB.empty(),t,fB.of(e))}}]),n}(foe);Qce.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new Yae(r,n);if(0===t){var a=jce.of(e);return Qce.fromDrop(a,i)}var o=e%3;e-=o;var s=new Yae((e/=3)%3,o);return Qce.fromMove(s,i)}}]),n}(Nre));var Xce=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=Kce.getGameStatus(e);return new ooe(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=soe.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new Yae(s,o),l=Gg(a);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=Qce.fromDrop(h,c);Kce.isLegal(f,n).isSuccess()&&t.push(f)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new Yae(v,d);if(!p.equals(c)){var g=Qce.fromMove(c,p);Kce.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(aoe),Jce=new Zce(Lre.NONE,Lre.NONE,Lre.NONE),ele=new Zce(Fre.ZERO,Lre.NONE,Lre.NONE),tle=new Zce(Lre.NONE,Fre.ZERO,Lre.NONE),nle=new Zce(Lre.NONE,Lre.NONE,Fre.ZERO),rle=new Zce(Fre.ONE,Lre.NONE,Lre.NONE),ile=new Zce(Lre.NONE,Lre.NONE,Fre.ONE),ale=new Zce(Fre.ONE,Fre.ZERO,Lre.NONE),ole=new Zce(Fre.ZERO,Fre.ZERO,Lre.NONE),sle=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Cr||(Cr=bg(["Goal of the game"]))),$localize(wr||(wr=bg(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new Wce([[ele,rle,ile],[Jce,tle,Jce],[Jce,Jce,nle]],0,[jce.SMALL_DARK,jce.MEDIUM_DARK,jce.BIG_DARK,jce.SMALL_LIGHT,jce.MEDIUM_LIGHT,jce.MEDIUM_LIGHT,jce.BIG_LIGHT])),Soe.anyMove($localize(br||(br=bg(["Putting a piece"]))),$localize(Er||(Er=bg(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),Wce.getInitialState(),Qce.fromDrop(jce.SMALL_DARK,new Yae(1,1)),$localize(Sr||(Sr=bg(["Congratulations!"])))),Soe.fromMove($localize(Pr||(Pr=bg(["Moving"]))),$localize(Or||(Or=bg(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new Wce([[ele,ile,Jce],[Jce,Jce,Jce],[Jce,Jce,Jce]],0,[]),[Qce.fromMove(new Yae(0,0),new Yae(2,0)),Qce.fromMove(new Yae(0,0),new Yae(0,1)),Qce.fromMove(new Yae(0,0),new Yae(1,1)),Qce.fromMove(new Yae(0,0),new Yae(2,1)),Qce.fromMove(new Yae(0,0),new Yae(0,2)),Qce.fromMove(new Yae(0,0),new Yae(1,2)),Qce.fromMove(new Yae(0,0),new Yae(2,2))],$localize(Tr||(Tr=bg(["Congratulations!"]))),$localize(Ir||(Ir=bg(["Failed. Try again."])))),Soe.fromPredicate($localize(Ar||(Ar=bg(["Particularity"]))),$localize(Rr||(Rr=bg(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new Wce([[ale,Jce,rle],[ole,ile,ile],[Jce,Jce,Jce]],0,[jce.MEDIUM_DARK,jce.BIG_DARK,jce.MEDIUM_LIGHT,jce.MEDIUM_LIGHT]),Qce.fromMove(new Yae(0,1),new Yae(0,2)),function(e,t){if(e.landingCoord.equals(new Yae(0,2))){if(e.isDropping())return A7.failure($localize(xr||(xr=bg(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new Yae(0,1)))return A7.SUCCESS}return A7.failure($localize(Mr||(Mr=bg(["Failed. Try again."]))))},$localize(Nr||(Nr=bg(["Congratulations!"]))))]});function ule(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"circle",5),cS("click",function(){var e=Dk(n),t=e.$implicit,r=e.index;return fS().onPieceClick(0,t,r)}),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();gb(1),vS("id","piece_0_",r.toString(),""),JE("ngClass",a.getSidePieceClasses(r,i)),qE("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function cle(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",8),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onBoardClick(e,t)}),nS()}if(2&e){var r=t.$implicit,i=fS().index,a=fS().index,o=fS();JE("ngClass",o.getPieceClasses(r)),qE("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function lle(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",6),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onBoardClick(e,t)}),nS(),KE(2,cle,1,4,"circle",7),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","click_",i,"_",a,""),JE("ngClass",o.getRectClasses(i,a)),qE("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngForOf",o.getListPieces(r))}}function hle(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,lle,3,8,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function fle(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",9),cS("click",function(){var e=Dk(n).$implicit;return fS().onBoardClick(e.x,e.y)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),qE("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function dle(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"circle",5),cS("click",function(){var e=Dk(n),t=e.$implicit,r=e.index;return fS().onPieceClick(1,t,r)}),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();gb(1),vS("id","piece_1_",r.toString(),""),JE("ngClass",a.getSidePieceClasses(r,i)),qE("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var vle=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=fB.empty(),r.lastStartingCoord=fB.empty(),r.chosenCoord=fB.empty(),r.chosenPiece=fB.empty(),r.remainingPieceLeftX=[],r.rules=new Kce(Wce),r.availableMinimaxes=[new Xce(r.rules,"EncapsuleMinimax")],r.encoder=Qce.encoder,r.tutorial=(new sle).tutorial,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=fB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=fB.empty(),this.lastStartingCoord=fB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(Fre.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Yae(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=fB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=Qce.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(Yce.INVALID_PIECE_SELECTED()):A7.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",n.cancelMove(Yce.SAME_DEST_AS_ORIGIN()));case 11:return u=Qce.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.chosenPiece=fB.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",a.isFailure()?r.cancelMove(a.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(Yce.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=fB.of(t),r.chosenPieceIndex=n,A7.SUCCESS):r.cancelMove(Yce.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new Yae(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return D7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case qce.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case qce.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return sB.expectToBe(e.getSize(),qce.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-encapsule"]],features:[xE],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"g",null,1),KE(3,ule,2,5,"g",2),nS(),tS(4,"g",null,3),KE(6,hle,2,1,"g",2),KE(7,fle,2,4,"g",2),nS(),tS(8,"g",null,4),KE(10,dle,2,5,"g",2),nS(),nS()),2&e&&(gb(1),qE("transform","translate("+t.STROKE_WIDTH+", 0)"),gb(2),JE("ngForOf",t.getRemainingPieces(0)),gb(1),qE("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),gb(2),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.getHighlightedCases()),gb(1),qE("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),gb(2),JE("ngForOf",t.getRemainingPieces(1)))},directives:[FA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ple=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;if(jg(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return Fg(s)}return Zg(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(doe);ple.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=jae.factory.fromInt(t);return new ple(a,i,r+1,n+1,o.get())}}]),n}(Nre));var gle=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=Lre.NONE,t=Lre.ZERO,r=Lre.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(loe),yle=function(){var e=Zg(function e(){jg(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Dr||(Dr=bg(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Lr||(Lr=bg(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Fr||(Fr=bg(["Your phalanx must be bigger than the one you are capturing."])))},e.CASE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Ur||(Ur=bg(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Vr||(Vr=bg(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Br||(Br=bg(["A single piece cannot make a capture."])))},e.CASE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(zr||(zr=bg(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Hr||(Hr=bg(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=function(){return $localize(Gr||(Gr=bg(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize($r||($r=bg(["A phalanx cannot contain a piece of the opponent."])))},e}(),mle=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new gle(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(Fre.ZERO,0),r=t.count(Fre.ONE,11);if(t.turn%2==0){if(n>r)return _oe.ZERO_WON}else if(r>n)return _oe.ONE_WON;return!1===t.doesOwnPiece(Fre.ZERO)?_oe.ONE_WON:!1===t.doesOwnPiece(Fre.ONE)?_oe.ZERO_WON:_oe.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return O7.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=zre.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:O7.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return A7.failure(yle.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===Lre.NONE)return A7.failure(yle.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(a===i)return A7.failure(yle.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return A7.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=Lre.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return O7.failure(yle.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return O7.failure(yle.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?O7.failure(yle.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?O7.failure(ioe.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=Lre.NONE,n[a.y][a.x]=r,O7.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=Lre.NONE),++a>=n.movedPieces)return O7.failure(yle.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return O7.success(t)}}]),n}(Coe),kle=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return zre.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new ooe(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new Yae(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[jae.UP_LEFT,jae.UP,jae.UP_RIGHT];c<l.length;c++)for(var h=l[c],f=o.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)t+=1*u,f=f.getNext(h,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=Lre.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new Yae(u,s);if(o.getPieceAt(c)===n){var l,h=Gg(jae.DIRECTIONS);try{for(h.s();!(l=h.n()).done;){for(var f=l.value,d=1,v=c.getNext(f,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(f,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new ple(u,s,d,p,f),a=this.addMove(a,t,o),p++,v=v.getNext(f,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new ple(u,s,d,p,f),a=this.addMove(a,t,o))}}catch(g){h.e(g)}finally{h.f()}}}return a}},{key:"addMove",value:function(e,t,n){return mle.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(aoe),_le=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=kle.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return zre.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new ooe(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new Yae(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===Fre.ZERO?(o=12-n,s=[jae.UP_LEFT,jae.UP,jae.UP_RIGHT]):(o=n+1,s=[jae.DOWN_LEFT,jae.DOWN,jae.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=Gg(s);try{for(l.s();!(c=l.n()).done;)for(var h=c.value,f=i.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===a;)t+=337*u,f=f.getNext(h,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(aoe),Cle=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return Zg(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Yae(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Yae(n,11))===Fre.ZERO&&(t+=Fre.ZERO.getScoreModifier()),e.getPieceAt(new Yae(n,0))===Fre.ONE&&(t+=Fre.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Yae(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new Yae(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===Lre.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Yae(n,0))===Fre.ZERO&&(t+=Fre.ZERO.getScoreModifier()),e.getPieceAt(new Yae(n,11))===Fre.ONE&&(t+=Fre.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Yae(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new Yae(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=Gg(jae.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,h=1,f=o.getNext(l,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)h+=1,f=f.getNext(l,1);for(var d=1;f.isInRange(14,12)&&d<=h&&e.getPieceAt(f)===Lre.NONE;)d++,f=f.getNext(l,1);t+=d*d*s.getScoreModifier(),s===Fre.ZERO?n=Math.max(n,d):s===Fre.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*Fre.ZERO.getScoreModifier()+r*Fre.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new ooe(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new ooe(r+i+a+o+s+u)}}]),n}(kle),wle=Lre.NONE,ble=Lre.ZERO,Ele=Lre.ONE,Sle=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(qr||(qr=bg(["Initial board"]))),$localize(jr||(jr=bg(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),gle.getInitialState()),Soe.informational($localize(Wr||(Wr=bg(["Goal of the game (1/2)"]))),$localize(Zr||(Zr=bg(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new gle([[wle,wle,wle,wle,wle,ble,wle,wle,Ele,Ele,Ele,Ele,Ele,Ele],[wle,wle,wle,wle,wle,ble,wle,wle,wle,wle,wle,wle,Ele,Ele],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,Ele,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,ble,ble,ble,ble,wle,wle,wle]],0)),Soe.informational($localize(Yr||(Yr=bg(["Goal of the game (2/2)"]))),$localize(Kr||(Kr=bg(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new gle([[wle,wle,wle,wle,wle,ble,wle,wle,wle,wle,Ele,Ele,Ele,Ele],[wle,wle,wle,wle,wle,ble,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,Ele,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,Ele,Ele,wle,wle,wle,ble,ble,wle,ble,ble,ble,ble]],1)),Soe.fromPredicate($localize(Qr||(Qr=bg(["Moving a piece"]))),$localize(Xr||(Xr=bg(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),gle.getInitialState(),new ple(0,10,1,1,jae.UP),function(e,t){return 1===e.movedPieces?A7.SUCCESS:A7.failure($localize(Jr||(Jr=bg(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(ei||(ei=bg(["This is how you move a single piece."])))),Soe.fromPredicate($localize(ti||(ti=bg(["Moving a phalanx"]))),$localize(ni||(ni=bg(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),gle.getInitialState(),new ple(0,11,2,1,jae.UP),function(e,t){return e.movedPieces>1?A7.SUCCESS:A7.failure($localize(ri||(ri=bg(["Failed! You moved only one piece."]))))},$localize(ii||(ii=bg(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Soe.fromMove($localize(ai||(ai=bg(["Capture"]))),$localize(oi||(oi=bg(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new gle([[wle,wle,wle,wle,wle,wle,wle,wle,Ele,Ele,Ele,Ele,Ele,Ele],[wle,wle,wle,wle,wle,wle,Ele,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,Ele,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,Ele,wle,Ele,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,Ele,Ele,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,Ele,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,ble,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,ble,wle,wle,wle,wle,Ele,wle,wle,wle,wle,wle,wle],[wle,wle,ble,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,ble,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle,wle],[wle,wle,wle,wle,wle,wle,wle,ble,ble,ble,ble,ble,ble,ble]],0),[new ple(2,10,4,2,jae.UP)],$localize(si||(si=bg(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(ui||(ui=bg(["Failed, you have not captured the phalanx."]))))]});function Ple(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",4),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),nS()}if(2&e){var r=fS().index,i=fS().index,a=fS();JE("ngClass",a.getPieceClasses(r,i)),qE("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function Ole(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",2),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(),KE(2,Ple,1,4,"circle",3),nS()}if(2&e){var r=t.index,i=fS().index,a=fS();gb(1),pS("id","click_",r,"_",i,""),JE("ngClass",a.getRectClasses(r,i)),qE("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),gb(1),JE("ngIf",a.board[i][r]!==a.NONE)}}function Tle(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Ole,3,8,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Ile(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",5),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e.x,e.y)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),qE("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Ale=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).NONE=Lre.NONE,r.firstPiece=fB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=fB.empty(),r.phalanxDirection=fB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new mle(gle),r.availableMinimaxes=[new kle(r.rules,"Normal"),new _le(r.rules,"Positional"),new Cle(r.rules,"Attack")],r.encoder=ple.encoder,r.tutorial=(new Sle).tutorial,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){this.firstPiece=fB.empty(),this.lastPiece=fB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=fB.of(new Yae(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),A7.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(sB.expectToBe(n.board[t][e],Lre.NONE),n.cancelMove(ioe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=Gg(jae.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=jae.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=jae.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptyCases()}},{key:"getNeighboringEmptyCases",value:function(){var e,t=[],n=Gg(jae.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===Lre.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=fB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=fB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Yae(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),A7.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(yle.CASE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===Lre.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new ple(a.x,a.y,1,1,c)):n.cancelMove(yle.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(yle.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return sB.expectToBe(n.board[t][e],s),l=new ple(a.x,a.y,u,1,c),h=mle.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=fB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=fB.of(c),A7.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new Yae(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(yle.CASE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=jae.factory.fromMove(o,s).get(),c=jae.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=fB.of(s),n.lastPiece=fB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(yle.CASE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=fB.of(a),l=n.firstPiece.get().getDistance(a)+1,h=new ple(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),f=mle.getPhalanxValidity(n.rules.node.gameState,h),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),A7.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,v=n.lastPiece.get().getDistance(a),p=new ple(n.firstPiece.get().x,n.firstPiece.get().y,d,v,u),r.abrupt("return",n.tryMove(p));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=fB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",A7.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=fB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),A7.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=fB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=fB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),A7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new Yae(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new Yae(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new Yae(r,n));return e}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-epaminondas"]],features:[xE],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Tle,2,1,"g",1),KE(2,Ile,2,4,"g",1),nS()),2&e&&(gb(1),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.getHighlightedCoords()))},directives:[FA,DA,VA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Rle(e){return new(function(t){Ng(r,t);var n=Lg(r);function r(){return jg(this,r),n.apply(this,arguments)}return Zg(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?fB.empty():fB.of(e.decode(t))}}]),r}(xre))}var xle=function(){function e(t){if(jg(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===pce.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=zre.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=fB.empty(),i=Gg(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=fB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return Zg(e,[{key:"toString",value:function(){var e,t="",n=Gg(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return pce.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();xle.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return Yae.encoder.encode(e)})}},{key:"decode",value:function(e){return new xle(e.map(function(e){return Yae.encoder.decode(e)}))}}]),n}(xre));var Mle=function(){function e(t,n){jg(this,e),this.coord=t,this.direction=n}return Zg(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Mle.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Rle(Jae.encoder),e}return Zg(n,[{key:"encode",value:function(e){return{coord:Yae.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return D7(null!=t.coord,"Invalid encoded GipfPlacement"),new Mle(Yae.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(xre));var Nle=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return Zg(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===zre.compareArray(this.initialCaptures,e.initialCaptures)||!1===zre.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(foe);Nle.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encodeMove",value:function(e){var t={placement:Mle.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=xle.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=xle.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return D7(null!=t.placement,"Invalid encoded GipfMove"),new Nle(Mle.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",xle.encoder.decode),this.decodeArray(t,"finalCapture",xle.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(Mre));var Dle=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,r,e,7,7,[3,2,1],Xae.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return Zg(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&zre.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=zre.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Xae.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=Xae.EMPTY,t=Xae.UNREACHABLE,r=Xae.ZERO,i=Xae.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(gce),Lle=function(){var e=Zg(function e(){jg(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(ci||(ci=bg(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(li||(li=bg(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(hi||(hi=bg(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(fi||(fi=bg(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(di||(di=bg(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(vi||(vi=bg(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(pi||(pi=bg(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(gi||(gi=bg(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(yi||(yi=bg(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(mi||(mi=bg(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),Fle=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return new Dle(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==Xae.EMPTY;)o.push(s),s=s.getNext(a);return D7(i.isOnBoard(s)&&i.getPieceAt(s)===Xae.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():O7.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=Gg(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return A7.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return A7.failure(Lle.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?A7.SUCCESS:A7.failure(Lle.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?A7.SUCCESS:A7.failure(Lle.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==Xae.EMPTY){if(t.direction.isAbsent())return A7.failure(Lle.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return A7.failure(Lle.PLACEMENT_ON_COMPLETE_LINE());var i,a=Gg(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return A7.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return A7.failure(Lle.INVALID_PLACEMENT_DIRECTION())}return A7.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return roe.INSTANCE.isOnBorder(e,t)?A7.SUCCESS:A7.failure(Lle.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,Fre.ZERO),i=n.getPlayerScore(t,Fre.ONE);return r.isAbsent()?_oe.ONE_WON:i.isAbsent()?_oe.ZERO_WON:_oe.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,Xae.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Dle(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return roe.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===Xae.EMPTY?t.push(new Mle(r,fB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Mle(r,fB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===Xae.EMPTY)return fB.of(r);return fB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=Xae.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==Xae.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==Xae.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new Dle(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(roe.INSTANCE.isTopLeftCorner(e,t))return[Jae.RIGHT,Jae.DOWN,Jae.UP_RIGHT];if(roe.INSTANCE.isTopCorner(e,t))return[Jae.DOWN,Jae.DOWN_LEFT,Jae.RIGHT];if(roe.INSTANCE.isTopRightCorner(e,t))return[Jae.DOWN_LEFT,Jae.DOWN,Jae.LEFT];if(roe.INSTANCE.isBottomLeftCorner(e,t))return[Jae.UP_RIGHT,Jae.UP,Jae.RIGHT];if(roe.INSTANCE.isBottomCorner(e,t))return[Jae.UP,Jae.LEFT,Jae.UP_RIGHT];if(roe.INSTANCE.isBottomRightCorner(e,t))return[Jae.LEFT,Jae.UP,Jae.DOWN_LEFT];if(roe.INSTANCE.isOnTopLeftBorder(e,t))return[Jae.RIGHT,Jae.DOWN];if(roe.INSTANCE.isOnLeftBorder(e,t))return[Jae.UP_RIGHT,Jae.RIGHT];if(roe.INSTANCE.isOnBottomLeftBorder(e,t))return[Jae.UP,Jae.UP_RIGHT];if(roe.INSTANCE.isOnBottomRightBorder(e,t))return[Jae.LEFT,Jae.UP];if(roe.INSTANCE.isOnRightBorder(e,t))return[Jae.LEFT,Jae.DOWN_LEFT];if(roe.INSTANCE.isOnTopRightBorder(e,t))return[Jae.DOWN_LEFT,Jae.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return fB.of({0:o,1:s,2:a});return fB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==Xae.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==Xae.EMPTY;c=c.getNext(a))n.push(c);return new xle(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return fB.empty();var i=e.getNumberOfPiecesCaptured(t);return fB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,Fre.ZERO),r=n.getPlayerScore(e,Fre.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(Coe),Ule=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=Fle.getPlayerScore(t,Fre.ZERO),r=Fle.getPlayerScore(t,Fre.ONE);return n.isAbsent()?new ooe(Fre.ONE.getVictoryValue()):r.isAbsent()?new ooe(Fre.ZERO.getVictoryValue()):new ooe(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return Fle.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=Fle.applyCaptures(r,e);Fle.getPlacements(i).forEach(function(e){var a=Fle.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Nle(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=Fle.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=Gg(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(zre.copyImmutableArray(u)):o?(a.push(zre.copyImmutableArray(u)),u.push(n),a.push(zre.copyImmutableArray(u))):(u.push(n),a.push(zre.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(aoe),Vle=Zg(function e(t,n,r,i,a,o){jg(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),Ble=Xae.UNREACHABLE,zle=Xae.EMPTY,Hle=Xae.ZERO,Gle=Xae.ONE,$le=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(ki||(ki=bg(["Goal of the game"]))),$localize(_i||(_i=bg(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Dle.getInitialState()),Soe.anyMove($localize(Ci||(Ci=bg(["Pushing"]))),$localize(wi||(wi=bg(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Dle.getInitialState(),new Nle(new Mle(new Yae(3,0),fB.of(Jae.DOWN)),[],[]),$localize(bi||(bi=bg(["Congratulations!"])))),Soe.fromMove($localize(Ei||(Ei=bg(["Capture (1/3)"]))),$localize(Si||(Si=bg(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Dle([[Ble,Ble,Ble,Hle,Gle,zle,zle],[Ble,Ble,zle,zle,zle,zle,zle],[Ble,zle,zle,zle,zle,zle,zle],[Hle,Hle,Hle,zle,zle,zle,zle],[Gle,zle,zle,zle,zle,zle,Ble],[zle,zle,zle,Gle,zle,Ble,Ble],[zle,zle,zle,Gle,Ble,Ble,Ble]],42,[8,8],[0,0]),[new Nle(new Mle(new Yae(0,3),fB.of(Jae.RIGHT)),[],[new xle([new Yae(0,3),new Yae(1,3),new Yae(2,3),new Yae(3,3)])])],$localize(Pi||(Pi=bg(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(Oi||(Oi=bg(["Failed!"])))),Soe.fromMove($localize(Ti||(Ti=bg(["Capture (2/3)"]))),$localize(Ii||(Ii=bg(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Dle([[Ble,Ble,Ble,zle,zle,zle,zle],[Ble,Ble,zle,Gle,zle,zle,zle],[Ble,zle,zle,Hle,zle,zle,zle],[Hle,Hle,Hle,Gle,zle,zle,zle],[zle,zle,zle,Hle,zle,zle,Ble],[zle,zle,zle,Hle,zle,Ble,Ble],[zle,zle,zle,Gle,Ble,Ble,Ble]],42,[8,4],[2,3]),[new Nle(new Mle(new Yae(0,3),fB.of(Jae.RIGHT)),[],[new xle([new Yae(3,1),new Yae(3,2),new Yae(3,3),new Yae(3,4),new Yae(3,5),new Yae(3,6)])])],$localize(Ai||(Ai=bg(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ri||(Ri=bg(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Soe.fromMove($localize(xi||(xi=bg(["Capture (3/3)"]))),$localize(Mi||(Mi=bg(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Dle([[Ble,Ble,Ble,Hle,zle,zle,Hle],[Ble,Ble,zle,Hle,zle,zle,Hle],[Ble,Hle,Hle,zle,Hle,Gle,Hle],[zle,zle,zle,Hle,zle,zle,Hle],[zle,zle,zle,Hle,zle,zle,Ble],[Hle,Hle,Hle,Gle,Gle,Ble,Ble],[zle,zle,zle,Hle,Ble,Ble,Ble]],42,[8,4],[2,3]),[new Nle(new Mle(new Yae(3,6),fB.of(Jae.UP)),[new xle([new Yae(6,0),new Yae(6,1),new Yae(6,2),new Yae(6,3)])],[new xle([new Yae(0,5),new Yae(1,5),new Yae(2,5),new Yae(3,5),new Yae(4,5)]),new xle([new Yae(1,2),new Yae(2,2),new Yae(3,2),new Yae(4,2),new Yae(5,2)])]),new Nle(new Mle(new Yae(4,6),fB.of(Jae.UP)),[new xle([new Yae(6,0),new Yae(6,1),new Yae(6,2),new Yae(6,3)])],[new xle([new Yae(0,5),new Yae(1,5),new Yae(2,5),new Yae(3,5),new Yae(4,5)]),new xle([new Yae(3,0),new Yae(3,1),new Yae(3,2),new Yae(3,3),new Yae(3,4)])]),new Nle(new Mle(new Yae(3,6),fB.of(Jae.UP)),[new xle([new Yae(6,0),new Yae(6,1),new Yae(6,2),new Yae(6,3)])],[new xle([new Yae(1,2),new Yae(2,2),new Yae(3,2),new Yae(4,2),new Yae(5,2)]),new xle([new Yae(0,5),new Yae(1,5),new Yae(2,5),new Yae(3,5),new Yae(4,5)])])],$localize(Ni||(Ni=bg(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Di||(Di=bg(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function qle(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=fS().$implicit,r=fS();JE("ngClass",r.getPieceClass(n)),qE("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function jle(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"g",8),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e)}),rS(2,"polyline",9),KE(3,qle,1,4,"circle",10),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),pS("id","click_",r.x,"_",r.y,""),gb(1),pS("id","case_",r.x,"_",r.y,""),JE("ngClass",i.getSpaceClass(r)),qE("points",i.getHexaCoordsAt(r)),gb(1),JE("ngIf",i.isPiece(r))}}function Wle(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",14),cS("click",function(){var e=Dk(n).$implicit;return fS(2).onClick(e)}),nS()}if(2&e){var r=t.$implicit;qE("points",fS(2).getHexaCoordsAt(r))}}function Zle(e,t){if(1&e&&(l_(),tS(0,"g",12),KE(1,Wle,1,1,"polyline",13),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n.capturedSpaces)}}function Yle(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"line",15),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e.destination)}),nS(),nS()}if(2&e){var r=t.$implicit;gb(1),qE("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function Kle(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"circle",16),nS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS();gb(1),pS("id","piece_",r,"_",n,""),JE("ngClass",i.getSidePieceClass(r)),qE("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function Qle(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Kle,2,6,"g",5),nS()),2&e){var n=t.$implicit,r=fS();gb(1),JE("ngForOf",r.getPlayerSidePieces(n))}}function Xle(e,t){if(1&e&&(l_(),rS(0,"line",17)),2&e){var n=fS();qE("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var Jle=function(){return[0,1]},ehe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).inserted=fB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=fB.empty(),r.placementEntrance=fB.empty(),r.finalCaptures=[],r.scores=fB.of([0,0]),r.rules=new Fle(Dle),r.availableMinimaxes=[new Ule(r.rules,"GipfMinimax")],r.encoder=Nle.encoder,r.tutorial=(new $le).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new eoe(1.5*r.SPACE_SIZE,new Yae(2*r.SPACE_SIZE,0),roe.INSTANCE),r}return Zg(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=fB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=fB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new Vle(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(Fre.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==Xae.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(sB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(a=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(Lle.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===a.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(Lle.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return o=Jae.factory.fromMove(a,e),r.abrupt("return",t.selectPlacementDirection(o.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(Lle.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(Lle.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=Fle.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=Fle.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():A7.SUCCESS):(sB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):A7.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,A7.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=Fle.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,A7.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=Fle.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,A7.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=Gg(Fle.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===Fle.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new Vle(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=fB.of(e),t.constructedState.getPieceAt(e)===Xae.EMPTY?t.selectPlacementDirection(fB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(Lle.NO_DIRECTIONS_AVAILABLE()),A7.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=fB.of(new Mle(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=Fle.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Nle(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=fB.empty(),this.placement=fB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(Fre.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(Fre.of(e))}}]),n}(Qae);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-gipf"]],features:[xE],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"defs"),tS(2,"marker",1),rS(3,"polygon",2),nS(),tS(4,"marker",3),rS(5,"polygon",4),nS(),nS(),KE(6,jle,4,7,"g",5),KE(7,Zle,2,1,"g",6),KE(8,Yle,2,4,"g",5),KE(9,Qle,2,1,"g",5),KE(10,Xle,1,4,"line",7),nS()),2&e&&(gb(6),JE("ngForOf",t.getAllCoords()),gb(1),JE("ngForOf",t.possibleCaptures),gb(1),JE("ngForOf",t.arrows),gb(1),JE("ngForOf",oT(5,Jle)),gb(1),JE("ngIf",t.inserted.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),the=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(doe);the.PASS=new the(-1,0),the.ACCEPT=new the(-2,0),the.PASS_NUMBER=-1,the.ACCEPT_NUMBER=-2,the.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===the.PASS_NUMBER)return the.PASS;var t=e%19;return new the(t,(e-t)/19)}}]),n}(Nre));var nhe=function(){function e(t,n){jg(this,e),this.player=t,this.type=n}return Zg(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return D7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return D7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===Fre.ZERO?e.DARK:e.LIGHT}}]),e}();nhe.DARK=new nhe(Fre.ZERO,"alive"),nhe.LIGHT=new nhe(Fre.ONE,"alive"),nhe.EMPTY=new nhe(Lre.NONE,"empty"),nhe.DEAD_DARK=new nhe(Fre.ZERO,"dead"),nhe.DEAD_LIGHT=new nhe(Fre.ONE,"dead"),nhe.DARK_TERRITORY=new nhe(Lre.NONE,"territory"),nhe.LIGHT_TERRITORY=new nhe(Lre.NONE,"territory");var rhe=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(rhe||(rhe={})),rhe),ihe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return Zg(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,fB.empty(),rhe.PLAYING)}},{key:"getStartingBoard",value:function(){return zre.createTable(n.WIDTH,n.HEIGHT,nhe.EMPTY)}}]),n}(loe);return e.WIDTH=13,e.HEIGHT=13,e}(),ahe=function(){var e=function(){function e(t){jg(this,e),this.color=t}return Zg(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),ohe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return Zg(n,[{key:"getCoords",value:function(){return this.color===nhe.DARK?this.darkCoords:this.color===nhe.LIGHT?this.lightCoords:this.color===nhe.DEAD_DARK?this.deadDarkCoords:this.color===nhe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch(D7(!1===this.contains(e),"This group already contains "+e.toString()),t){case nhe.DARK:this.darkCoords=ahe.insertAsEntryPoint(this.darkCoords,e);break;case nhe.LIGHT:this.lightCoords=ahe.insertAsEntryPoint(this.lightCoords,e);break;case nhe.DEAD_DARK:this.deadDarkCoords=ahe.insertAsEntryPoint(this.deadDarkCoords,e);break;case nhe.DEAD_LIGHT:this.deadLightCoords=ahe.insertAsEntryPoint(this.deadLightCoords,e);break;default:sB.expectToBeMultiple(t,[nhe.EMPTY,nhe.DARK_TERRITORY,nhe.LIGHT_TERRITORY]),this.emptyCoords=ahe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new goe;e.set(nhe.EMPTY,this.emptyCoords.length),e.set(nhe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(nhe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==nhe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==nhe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==nhe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==nhe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==nhe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(ahe),she=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getNewInstance",value:function(e){return new ohe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return Wae.ORTHOGONALS}}]),n}(function(){function e(){jg(this,e)}return Zg(e,[{key:"getGroupDatas",value:function(e,t){uB(ahe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){uB(ahe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=Gg(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),uhe=function(){var e=Zg(function e(){jg(this,e)});return e.ILLEGAL_KO=function(){return $localize(Li||(Li=bg(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Fi||(Fi=bg(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Ui||(Ui=bg(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Vi||(Vi=bg(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Bi||(Bi=bg(["You cannot commit suicide."])))},e}(),che=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return uB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(uB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(uB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(uB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(uB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(uB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===rhe.PLAYING,a=t.phase===rhe.PASSED;return uB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?O7.success([]):O7.failure(uhe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===rhe.ACCEPT;return t.phase===rhe.COUNTING||o?O7.success([]):O7.failure(uhe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(uB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?O7.success([]):O7.failure(uhe.OCCUPIED_INTERSECTION())):(uB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new she).getGroupDatas(i,t),s=o.emptyCoords,u=nhe.pieceBelongTo(a,Fre.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return fB.of(r)}return fB.empty()}},{key:"markTerritoryAndCount",value:function(e){uB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=Gg(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===nhe.LIGHT){a[1]+=s.emptyCoords.length;var c,l=Gg(s.getCoords());try{for(l.s();!(c=l.n()).done;){var h=c.value;r[h.y][h.x]=nhe.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{D7(u===nhe.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var f,d=Gg(s.getCoords());try{for(d.s();!(f=d.n()).done;){var v=f.value;r[v.y][v.x]=nhe.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new ihe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===nhe.DARK_TERRITORY?(n[i][a]=nhe.EMPTY,r[0]=r[0]-1):t===nhe.LIGHT_TERRITORY&&(n[i][a]=nhe.EMPTY,r[1]=r[1]-1);return new ihe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new she,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new Yae(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===nhe.DEAD_DARK?r++:t===nhe.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();D7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new she).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case nhe.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=Gg(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=nhe.DARK}}catch(y){o.e(y)}finally{o.f()}break;case nhe.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=Gg(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=nhe.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case nhe.LIGHT:i[0]+=2*r.lightCoords.length;var h,f=Gg(r.lightCoords);try{for(f.s();!(h=f.n()).done;){var d=h.value;n[d.y][d.x]=nhe.DEAD_LIGHT}}catch(y){f.e(y)}finally{f.f()}break;default:sB.expectToBe(r.color,nhe.DARK),i[1]+=2*r.darkCoords.length;var v,p=Gg(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=nhe.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new ihe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===rhe.FINISHED?t.captured[0]>t.captured[1]?_oe.ZERO_WON:t.captured[1]>t.captured[0]?_oe.ONE_WON:_oe.DRAW:_oe.ONGOING}},{key:"isPass",value:function(e){return e.equals(the.PASS)}},{key:"isAccept",value:function(e){return e.equals(the.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===rhe.COUNTING||t.phase===rhe.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return O7.failure(uhe.ILLEGAL_KO());[rhe.COUNTING,rhe.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(lhe.isCapturing(i))return O7.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?nhe.DARK:nhe.LIGHT;var a=0===(new she).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=nhe.EMPTY,a?O7.failure(uhe.CANNOT_COMMIT_SUICIDE()):O7.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){uB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new lhe,o=Gg(Wae.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?nhe.LIGHT:nhe.DARK)){uB(n.VERBOSE||!1,"a group could be captured");var o=(new she).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return uB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===rhe.PASSED?(t=rhe.COUNTING,r=new ihe(i,a,o+1,fB.empty(),t),r=n.markTerritoryAndCount(r)):(D7(e.phase===rhe.PLAYING,"Cannot pass in counting phase!"),t=rhe.PASSED,r=new ihe(i,a,o+1,fB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===rhe.COUNTING?rhe.ACCEPT:rhe.FINISHED,new ihe(n,e.getCapturedCopy(),e.turn+1,fB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;uB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[rhe.COUNTING,rhe.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=nhe.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var h,f=Gg(r);try{for(f.s();!(h=f.n()).done;){var d=h.value;s[d.y][d.x]=nhe.EMPTY}}catch(g){f.e(g)}finally{f.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new ihe(s,p,l,v,rhe.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new Yae(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){uB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new ihe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,fB.empty(),rhe.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(Coe);return e.VERBOSE=!1,e}(),lhe=function(){function e(){jg(this,e),this.capturedCoords=[]}return Zg(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),hhe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){uB(che.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===rhe.PLAYING||t.phase===rhe.PASSED)return n.push(the.PASS),n;uB(che.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[the.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new the(i,r),e.getPieceAt(t.coord)===nhe.EMPTY&&che.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=Gg(che.getGroupsDatasWhere(r,function(e){return e!==nhe.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new the(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===nhe.DARK?nhe.DEAD_DARK:e===nhe.LIGHT?nhe.DEAD_LIGHT:e.isTerritory()?nhe.EMPTY:e}),n=new ihe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=che.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Gg(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=che.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=che.getGameStatus(e);if(n.isEndGame)return new ooe(n.toBoardValue());uB(che.VERBOSE||!1,"GoRules.getBoardValue");var r=che.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new ooe(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(aoe),fhe=nhe.LIGHT,dhe=nhe.DARK,vhe=nhe.DEAD_LIGHT,phe=nhe.LIGHT_TERRITORY,ghe=nhe.DARK_TERRITORY,yhe=nhe.EMPTY,mhe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(zi||(zi=bg(["Preliminary information"]))),$localize(Hi||(Hi=bg(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),ihe.getInitialState()),Soe.informational($localize(Gi||(Gi=bg(["Goal of the game"]))),$localize($i||($i=bg(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new ihe([[yhe,dhe,yhe,yhe,fhe,fhe],[yhe,dhe,yhe,yhe,fhe,yhe],[yhe,dhe,dhe,fhe,fhe,yhe],[yhe,yhe,dhe,fhe,yhe,yhe],[yhe,yhe,dhe,fhe,yhe,yhe],[yhe,yhe,dhe,fhe,yhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING)),Soe.fromMove($localize(qi||(qi=bg(["Simple capture"]))),$localize(ji||(ji=bg(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new ihe([[yhe,yhe,yhe,yhe,yhe],[yhe,yhe,dhe,yhe,yhe],[yhe,dhe,fhe,yhe,yhe],[yhe,yhe,dhe,yhe,yhe],[yhe,yhe,yhe,yhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING),[new the(3,2)],$localize(Wi||(Wi=bg(["Congratulations, you have earned one point."]))),$localize(Zi||(Zi=bg(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Soe.fromMove($localize(Yi||(Yi=bg(["Capturing multiple stones"]))),$localize(Ki||(Ki=bg(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new ihe([[yhe,dhe,yhe,yhe,yhe],[dhe,fhe,yhe,yhe,yhe],[dhe,fhe,fhe,dhe,yhe],[yhe,dhe,dhe,yhe,yhe],[yhe,yhe,yhe,yhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING),[new the(2,1)],$localize(Qi||(Qi=bg(["Congratulations, you have earned three points and formed a territory."]))),$localize(Xi||(Xi=bg(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Soe.informational($localize(Ji||(Ji=bg(["Suicide"]))),$localize(ea||(ea=bg(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new ihe([[yhe,dhe,yhe,yhe,yhe],[dhe,yhe,yhe,yhe,yhe],[dhe,yhe,yhe,yhe,fhe],[fhe,dhe,yhe,fhe,yhe],[yhe,fhe,yhe,fhe,dhe]],[0,0],0,fB.empty(),rhe.PLAYING)),Soe.informational($localize(ta||(ta=bg(["Life and death (death)"]))),$localize(na||(na=bg(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new ihe([[yhe,yhe,yhe,yhe,yhe],[dhe,dhe,dhe,yhe,yhe],[fhe,fhe,dhe,yhe,yhe],[yhe,fhe,dhe,yhe,yhe],[fhe,fhe,dhe,yhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING)),Soe.informational($localize(ra||(ra=bg(["Life and death (eyes)"]))),$localize(ia||(ia=bg(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new ihe([[yhe,dhe,fhe,yhe,yhe],[fhe,dhe,fhe,yhe,yhe],[dhe,dhe,fhe,yhe,yhe],[fhe,dhe,fhe,yhe,yhe],[yhe,dhe,fhe,yhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING)),Soe.informational($localize(aa||(aa=bg(["Seki"]))),$localize(oa||(oa=bg(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new ihe([[yhe,fhe,dhe,yhe,fhe,dhe,yhe],[yhe,fhe,dhe,dhe,fhe,dhe,yhe],[yhe,fhe,dhe,dhe,fhe,dhe,yhe],[yhe,fhe,dhe,dhe,fhe,dhe,yhe],[yhe,fhe,dhe,fhe,fhe,dhe,yhe],[yhe,fhe,dhe,fhe,fhe,dhe,yhe],[yhe,fhe,dhe,yhe,fhe,dhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING)),Soe.fromMove($localize(sa||(sa=bg(["Ko"]))),$localize(ua||(ua=bg(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new ihe([[yhe,yhe,yhe,yhe,yhe,yhe,yhe],[yhe,yhe,yhe,yhe,yhe,yhe,yhe],[yhe,yhe,yhe,dhe,fhe,yhe,yhe],[yhe,yhe,dhe,fhe,yhe,fhe,yhe],[yhe,yhe,yhe,dhe,fhe,yhe,yhe],[yhe,yhe,yhe,yhe,yhe,yhe,yhe],[yhe,yhe,yhe,yhe,yhe,yhe,yhe]],[0,0],0,fB.empty(),rhe.PLAYING),[new the(4,3)],$localize(ca||(ca=bg(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(la||(la=bg(["Failed!"])))),Soe.fromMove($localize(ha||(ha=bg(["End of the game"]))),$localize(fa||(fa=bg(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new ihe([[fhe,dhe,dhe,dhe,dhe,dhe,ghe,ghe,ghe],[fhe,fhe,fhe,fhe,dhe,dhe,dhe,ghe,ghe],[fhe,phe,fhe,fhe,dhe,vhe,vhe,dhe,ghe],[dhe,fhe,fhe,fhe,fhe,dhe,ghe,ghe,ghe],[yhe,fhe,phe,fhe,dhe,dhe,vhe,dhe,ghe],[fhe,phe,fhe,fhe,dhe,dhe,dhe,dhe,dhe],[fhe,fhe,dhe,dhe,dhe,fhe,fhe,dhe,fhe],[dhe,dhe,dhe,fhe,fhe,fhe,phe,fhe,fhe],[ghe,ghe,dhe,dhe,dhe,fhe,fhe,phe,phe]],[0,0],0,fB.empty(),rhe.COUNTING),[new the(0,3)],$localize(da||(da=bg(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(va||(va=bg(["Failed, try again."]))))]});function khe(e,t){if(1&e&&(l_(),rS(0,"circle",10)),2&e){var n=fS(2).index,r=fS().index;qE("cx",25+50*n)("cy",25+50*r)("r",22)}}function _he(e,t){if(1&e){var n=oS();l_(),tS(0,"line",11),cS("click",function(){Dk(n);var e=fS(2).index,t=fS().index;return fS().onClick(e,t)}),nS()}if(2&e){var r=fS(2).index,i=fS().index;qE("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Che(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"circle",7),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),nS(),KE(2,khe,1,3,"circle",8),KE(3,_he,1,4,"line",9),nS()}if(2&e){var r=fS().index,i=fS().index,a=fS();gb(1),JE("ngClass",a.getSpaceClass(r,i)),qE("cx",25+50*r)("cy",25+50*i)("r",22),gb(1),JE("ngIf",a.isLastCase(r,i)),gb(1),JE("ngIf",a.isDead(r,i))}}function whe(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",15),cS("click",function(){Dk(n);var e=fS(2).index,t=fS().index;return fS().onClick(e,t)}),nS()}if(2&e){var r=fS(2),i=r.index,a=r.$implicit,o=fS().index,s=fS();qE("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1":"player0")}}function bhe(e,t){if(1&e){var n=oS();l_(),tS(0,"rect",12),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),nS(),tS(1,"line",13),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),nS(),tS(2,"line",13),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().onClick(e,t)}),nS(),KE(3,whe,1,4,"circle",14)}if(2&e){var r=fS().index,i=fS().index,a=fS();pS("id","click_",r,"_",i,""),qE("x",50*r)("y",50*i),gb(1),qE("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),gb(1),qE("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),gb(1),JE("ngIf",a.isTerritory(r,i))}}function Ehe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Che,4,6,"g",5),KE(2,bhe,4,13,"ng-template",null,6,MT),nS()),2&e){var n=t.index,r=QE(3),i=fS().index,a=fS();gb(1),JE("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function She(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Ehe,4,2,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Phe(e,t){if(1&e&&(l_(),rS(0,"rect",16)),2&e){var n=fS();qE("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Ohe(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",17),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e.x,e.y)}),nS()}if(2&e){var r=t.$implicit;qE("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var The=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).ko=fB.empty(),r.last=fB.empty(),r.captures=[],r.GoPiece=nhe,r.scores=fB.of([0,0]),r.rules=new che(ihe),r.availableMinimaxes=[new hhe(r.rules,"GoMinimax")],r.encoder=the.encoder,r.tutorial=(new mhe).tutorial,r.canPass=!0,r.updateBoard(),r}return Zg(n,[{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=fB.empty(),a=new the(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){uB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=fB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==rhe.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new Yae(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===nhe.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===rhe.PLAYING||n===rhe.PASSED?e.onClick(the.PASS.coord.x,the.PASS.coord.y):(D7(n===rhe.COUNTING||n===rhe.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(the.ACCEPT.coord.x,the.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==nhe.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new Yae(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new Yae(e,t))}}]),n}(ose);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-go"]],features:[xE],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),rS(1,"rect",1),KE(2,She,2,1,"g",2),KE(3,Phe,1,2,"rect",3),KE(4,Ohe,1,3,"circle",4),nS()),2&e&&(qE("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),gb(1),qE("width",50*t.board.length)("height",50*t.board.length),gb(1),JE("ngForOf",t.board),gb(1),JE("ngIf",t.ko.isPresent()),gb(1),JE("ngForOf",t.captures))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ihe=function(){function e(t,n,r){jg(this,e),this.value=t,this.name=n,this.rgb=r}return Zg(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return sB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();Ihe.ANY=new Ihe(0,"any","#000"),Ihe.ORANGE=new Ihe(1,"orange","#d67421"),Ihe.BLUE=new Ihe(2,"blue","#006bac"),Ihe.PURPLE=new Ihe(3,"purple","#6f3787"),Ihe.PINK=new Ihe(4,"pink","#d2719e"),Ihe.YELLOW=new Ihe(5,"yellow","#e2c200"),Ihe.RED=new Ihe(6,"red","#d23339"),Ihe.GREEN=new Ihe(7,"green","#009157"),Ihe.BROWN=new Ihe(8,"brown","#562500");var Ahe=function(){function e(t,n){jg(this,e),this.player=t,this.color=n}return Zg(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(Lre.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,Ihe.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,Ihe.ORANGE),BLUE:new e(t,Ihe.BLUE),PURPLE:new e(t,Ihe.PURPLE),PINK:new e(t,Ihe.PINK),YELLOW:new e(t,Ihe.YELLOW),RED:new e(t,Ihe.RED),GREEN:new e(t,Ihe.GREEN),BROWN:new e(t,Ihe.BROWN)}}}]),e}();Ahe.EMPTY=new Ahe(Lre.NONE,Ihe.ANY),Ahe.ZERO=Ahe.createPlayerColors(Fre.ZERO),Ahe.ONE=Ahe.createPlayerColors(Fre.ONE);var Rhe=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=Ahe.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return Ahe.of(Fre.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return Ahe.of(Fre.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(Ahe.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new Yae(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Rhe.INITIAL=Rhe.getInitialBoard(),Rhe.SIZE=8,Rhe.COLORS=zre.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Ihe.of);var xhe=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return this===n.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Rhe.SIZE,Rhe.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Rhe.SIZE,Rhe.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(gse);xhe.PASS=new xhe(new Yae(-2,-2),new Yae(-3,-3)),xhe.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return xhe.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new xhe(new Yae((e=e/16|0)%16,r),new Yae(n,t))}}]),n}(Nre));var Mhe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o){var s;return jg(this,n),(s=t.call(this,zre.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return Zg(n,null,[{key:"getInitialState",value:function(){return new n(0,Ihe.ANY,fB.empty(),!1,Rhe.INITIAL)}}]),n}(loe),Nhe=function(){var e=Zg(function e(){jg(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(pa||(pa=bg(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(ga||(ga=bg(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(ya||(ya=bg(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(ma||(ma=bg(["You must play with the selected piece."])))},e}(),Dhe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"nextCoordToPlay",value:function(e,t){return fB.ofNullable(Rhe.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e===xhe.PASS){var r=this.nextCoordToPlay(t,t.colorToPlay);return new Mhe(t.turn+1,t.colorToPlay,r,!0,t.board)}var i=e.coord,a=e.end,o=t.getCopiedBoard();o[a.y][a.x]=o[i.y][i.x],o[i.y][i.x]=Ahe.EMPTY;var s=Rhe.getColorAt(a.x,a.y),u=this.nextCoordToPlay(t,s);return new Mhe(t.turn+1,s,u,!1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return _oe.getDefeat(r);var i=Og(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?_oe.ONE_WON:0===a?_oe.ZERO_WON:_oe.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new Yae(0,7),new Yae(1,7),new Yae(2,7),new Yae(3,7),new Yae(4,7),new Yae(5,7),new Yae(6,7),new Yae(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=Gg(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Rhe.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===Fre.ONE?[jae.DOWN,jae.DOWN_LEFT,jae.DOWN_RIGHT]:[jae.UP,jae.UP_LEFT,jae.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===Fre.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(D7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[xhe.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=Gg(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Gg(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,h=1;h<Rhe.SIZE;h++){var f=u.getNext(l,h);if(!e.isOnBoard(f)||!Rhe.isEmptyAt(e.board,f))break;var d=xhe.of(u,f);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Rhe.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);D7(i!==Ahe.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===Fre.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){var r=e.coord,i=e.end,a=t.colorToPlay;if(e===xhe.PASS)return this.isLegalPass(t);if(n.isVictory(t))return O7.failure("You should never see this message");var o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE());if(a!==Ihe.ANY&&o.color!==a)return O7.failure(Nhe.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return O7.failure(ioe.MUST_CLICK_ON_EMPTY_SPACE());var s=jae.factory.fromMove(r,i);if(s.isFailure())return O7.failure(Nhe.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return O7.failure(Nhe.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return O7.failure(Nhe.MOVE_BLOCKED());return O7.success(void 0)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?O7.success(void 0):O7.failure(ioe.CANNOT_PASS())}},{key:"isVictory",value:function(e){var t=Og(this.getFurthestPiecePositions(e),2),n=t[0],r=t[1];return 0===n||7===r}}]),n}(Coe),Lhe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=Dhe.getListMovesFromState(e.gameState);return zre.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Dhe.mustPass(t)&&t.alreadyPassed)return new ooe(n.getDefeatValue());var r=Og(Dhe.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new ooe(7===a?Fre.ONE.getVictoryValue():0===i?Fre.ZERO.getVictoryValue():a-(7-i))}}]),n}(aoe),Fhe=Ahe.EMPTY,Uhe=Ahe.ZERO.ORANGE,Vhe=Ahe.ONE.ORANGE,Bhe=Ahe.ZERO.BLUE,zhe=Ahe.ONE.BLUE,Hhe=Ahe.ZERO.PURPLE,Ghe=Ahe.ONE.PURPLE,$he=Ahe.ZERO.PINK,qhe=Ahe.ONE.PINK,jhe=Ahe.ZERO.YELLOW,Whe=Ahe.ONE.YELLOW,Zhe=Ahe.ZERO.RED,Yhe=Ahe.ONE.RED,Khe=Ahe.ZERO.GREEN,Qhe=Ahe.ONE.GREEN,Xhe=Ahe.ZERO.BROWN,Jhe=Ahe.ONE.BROWN,efe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(ka||(ka=bg(["Goal of the game"]))),$localize(_a||(_a=bg(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Mhe(5,Ihe.ORANGE,fB.empty(),!1,[[Xhe,zhe,Ghe,qhe,Whe,Yhe,Qhe,Jhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Vhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Khe,Zhe,jhe,$he,Hhe,Bhe,Uhe]])).withPreviousMove(xhe.of(new Yae(0,7),new Yae(0,0))),Soe.anyMove($localize(Ca||(Ca=bg(["Initial board and initial move"]))),$localize(wa||(wa=bg(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Mhe.getInitialState(),xhe.of(new Yae(7,7),new Yae(3,3)),$localize(ba||(ba=bg(["Perfect! Note that each of your piece has a different color."])))),Soe.fromMove($localize(Ea||(Ea=bg(["Moving"]))),$localize(Sa||(Sa=bg(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Mhe(1,Ihe.PINK,fB.of(new Yae(3,0)),!1,[[Vhe,zhe,Ghe,qhe,Whe,Yhe,Qhe,Jhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Bhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Xhe,Khe,Zhe,jhe,$he,Hhe,Fhe,Uhe]]),[xhe.of(new Yae(3,0),new Yae(3,6)),xhe.of(new Yae(3,0),new Yae(4,1))],$localize(Pa||(Pa=bg(["Congratulations!"]))),$localize(Oa||(Oa=bg(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(xhe.of(new Yae(6,7),new Yae(6,5))),Soe.informational($localize(Ta||(Ta=bg(["Stuck situation"]))),$localize(Ia||(Ia=bg(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Mhe(1,Ihe.PINK,fB.of(new Yae(3,6)),!1,[[Vhe,zhe,Ghe,Fhe,Whe,Yhe,Qhe,Jhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Bhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,qhe,Fhe,Fhe,Fhe,Fhe],[Xhe,Khe,Zhe,jhe,$he,Hhe,Fhe,Uhe]])).withPreviousMove(xhe.of(new Yae(6,5),new Yae(7,4))),Soe.fromMove($localize(Aa||(Aa=bg(["Victory by blocking"]))),$localize(Ra||(Ra=bg(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Mhe(2,Ihe.RED,fB.of(new Yae(2,4)),!1,[[Fhe,zhe,Ghe,Fhe,Fhe,Yhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Whe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,qhe,Fhe,Ghe,Fhe,Fhe],[Fhe,Fhe,Fhe,jhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Zhe,Fhe,Fhe,Fhe,Fhe,Fhe],[Fhe,Fhe,Fhe,Fhe,Fhe,Fhe,Qhe,Fhe],[Vhe,Fhe,Fhe,Fhe,Fhe,$he,Fhe,Jhe],[Xhe,Khe,Fhe,Fhe,Fhe,Fhe,Bhe,Uhe]]),[xhe.of(new Yae(2,4),new Yae(0,2))],$localize(xa||(xa=bg(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Ma||(Ma=bg(["Failed!"])))).withPreviousMove(xhe.of(new Yae(4,0),new Yae(3,1)))]});function tfe(e,t){if(1&e&&(l_(),rS(0,"circle",8)),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().index,o=fS();qE("cx",o.SPACE_SIZE/2+r*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("fill",o.pieceColor(i))("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function nfe(e,t){if(1&e&&(l_(),rS(0,"rect",9)),2&e){var n=fS(),r=n.$implicit,i=n.index,a=fS().index,o=fS();JE("ngClass",o.piecePlayerClass(r)),qE("x",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(r)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(r)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)}}function rfe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"g",4),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),rS(2,"rect",5),KE(3,tfe,1,4,"circle",6),KE(4,nfe,1,7,"rect",7),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","click_",i,"_",a,""),gb(1),qE("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),gb(1),JE("ngIf",r!==o.UNOCCUPIED),gb(1),JE("ngIf",r!==o.UNOCCUPIED)}}function ife(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,rfe,5,9,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function afe(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"rect",10),rS(2,"rect",10),nS()),2&e){var n=fS();gb(1),qE("x",n.lastMove.get().coord.x*n.SPACE_SIZE)("y",n.lastMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),gb(1),qE("x",n.lastMove.get().end.x*n.SPACE_SIZE)("y",n.lastMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function ofe(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=fS();qE("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)}}var sfe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).UNOCCUPIED=Ahe.EMPTY,r.lastMove=fB.empty(),r.chosen=fB.empty(),r.chosenAutomatically=!1,r.rules=new Dhe(Mhe),r.availableMinimaxes=[new Lhe(r.rules,"KamisadoMinimax")],r.encoder=xhe.encoder,r.tutorial=(new efe).tutorial,r.canPass=!1,r.updateBoard(),r}return Zg(n,[{key:"backgroundColor",value:function(e,t){return Rhe.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===Fre.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=Dhe.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=fB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(D7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(xhe.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Yae(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(ioe.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),A7.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Nhe.PLAY_WITH_SELECTED_PIECE()):(n.chosen=fB.of(a),A7.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=fB.of(new Yae(e,t)),A7.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Yae(e,t),o=xhe.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=fB.empty())}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-kamisado"]],features:[xE],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,ife,2,1,"g",1),KE(2,afe,3,8,"g",2),KE(3,ofe,1,2,"circle",3),nS()),2&e&&(qE("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),gb(1),JE("ngForOf",t.board),gb(1),JE("ngIf",t.lastMove.isPresent()),gb(1),JE("ngIf",t.chosen.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ufe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,null,[{key:"getInitialState",value:function(){var e=Lre.NONE,t=Lre.ZERO,r=Lre.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(loe);return e.SIZE=8,e}(),cfe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).direction=i,a.direction=jae.factory.fromMove(e,r).get(),a}return Zg(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=jae.factory.fromMove(e,t);return r.isFailure()?O7.failure(r.getReason()):e.isNotInRange(ufe.SIZE,ufe.SIZE)?O7.failure("start coord is not in range"):t.isNotInRange(ufe.SIZE,ufe.SIZE)?O7.failure("end coord is not in range"):O7.success(new n(e,t,r.get()))}}]),n}(gse);cfe.encoder=gse.getEncoder(ufe.SIZE,ufe.SIZE,function(e,t){return cfe.of(e,t).get()});var lfe=function(){var e=Zg(function e(){jg(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Na||(Na=bg(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Da||(Da=bg(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(La||(La=bg(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(Fa||(Fa=bg(["A move must be orthogonal or diagonal."])))},e}(),hfe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=Lre.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new ufe(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Og(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?_oe.ZERO_WON:i>1&&1===a?_oe.ONE_WON:_oe.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<ufe.SIZE;r++)for(var i=0;i<ufe.SIZE;i++){var a=new Yae(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=Gg(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=cfe.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=zre.createTable(ufe.SIZE,ufe.SIZE,-1),r=[0,0],i=0,a=0;a<ufe.SIZE;a++)for(var o=0;o<ufe.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new Yae(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new Yae(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=sB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=Gg(jae.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=o.getNext(l);e.isOnBoard(h)&&i.push(h)}}catch(f){c.e(f)}finally{c.f()}}else s===Lre.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?O7.failure(lfe.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?O7.failure(lfe.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?O7.failure(ioe.CANNOT_SELF_CAPTURE()):O7.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=Gg(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];ufe.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case jae.UP:case jae.DOWN:return[new Yae(e.x,0),jae.DOWN];case jae.LEFT:case jae.RIGHT:return[new Yae(0,e.y),jae.RIGHT];case jae.UP_RIGHT:case jae.DOWN_LEFT:return[new Yae(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),jae.UP_RIGHT];default:return sB.expectToBeMultiple(t,[jae.UP_LEFT,jae.DOWN_RIGHT]),[new Yae(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),jae.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Og(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?fB.of(Lre.NONE):1===r?fB.of(Fre.ZERO):1===i?fB.of(Fre.ONE):fB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=Gg(jae.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=cfe.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(Coe),ffe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){return hfe.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Og(hfe.getNumberOfGroups(t),2),r=n[0],i=n[1];return new ooe(1===r&&i>1?Fre.ZERO.getVictoryValue():r>1&&1===i?Fre.ONE.getVictoryValue():100/r*Fre.ZERO.getScoreModifier()+100/i*Fre.ONE.getScoreModifier())}}]),n}(aoe),dfe=Lre.NONE,vfe=Lre.ZERO,pfe=Lre.ONE,gfe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Ua||(Ua=bg(["Goal of the game"]))),$localize(Va||(Va=bg(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new ufe([[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[pfe,dfe,dfe,dfe,vfe,dfe,dfe,pfe],[dfe,dfe,vfe,vfe,pfe,dfe,dfe,dfe],[dfe,dfe,dfe,vfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe]],0)),Soe.anyMove($localize(Ba||(Ba=bg(["Initial board and initial move"]))),$localize(za||(za=bg(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),ufe.getInitialState(),cfe.of(new Yae(1,7),new Yae(1,5)).get(),$localize(Ha||(Ha=bg(["Congratulations!"])))),Soe.fromMove($localize(Ga||(Ga=bg(["Jumping"]))),$localize($a||($a=bg(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new ufe([[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,pfe,vfe,vfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,vfe]],0),[cfe.of(new Yae(3,1),new Yae(6,1)).get()],$localize(qa||(qa=bg(["Congratulations!"]))),$localize(ja||(ja=bg(["Failed. You did not jump over one of your pieces."])))),Soe.fromMove($localize(Wa||(Wa=bg(["Moving"]))),$localize(Za||(Za=bg(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new ufe([[dfe,dfe,dfe,dfe,dfe,dfe,pfe,dfe],[dfe,dfe,dfe,dfe,dfe,vfe,dfe,dfe],[dfe,dfe,dfe,dfe,pfe,dfe,dfe,dfe],[dfe,dfe,dfe,vfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,dfe,dfe,dfe,dfe,pfe,dfe,pfe],[dfe,dfe,dfe,vfe,dfe,dfe,pfe,pfe],[dfe,dfe,dfe,vfe,dfe,dfe,dfe,dfe]],0),[cfe.of(new Yae(3,3),new Yae(3,0)).get(),cfe.of(new Yae(3,3),new Yae(0,0)).get(),cfe.of(new Yae(3,3),new Yae(2,3)).get(),cfe.of(new Yae(3,3),new Yae(4,3)).get()],$localize(Ya||(Ya=bg(["Congratulations!"]))),$localize(Ka||(Ka=bg(["Failed. This was not one of the expected moves."])))),Soe.fromMove($localize(Qa||(Qa=bg(["Capturing"]))),$localize(Xa||(Xa=bg(["If a move ends on an opponent's pieces, this one is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new ufe([[dfe,vfe,dfe,vfe,vfe,vfe,vfe,dfe],[pfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,dfe,vfe,dfe,pfe,dfe,dfe,dfe],[pfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[pfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[pfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[pfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,vfe,vfe,vfe,vfe,vfe,vfe,dfe]],0),[cfe.of(new Yae(2,2),new Yae(4,2)).get()],$localize(Ja||(Ja=bg(["Congratulations!"]))),$localize(eo||(eo=bg(["Failed!"])))),Soe.fromMove($localize(to||(to=bg(["Tie"]))),$localize(no||(no=bg(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new ufe([[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe],[vfe,dfe,dfe,vfe,pfe,vfe,dfe,dfe],[dfe,dfe,dfe,vfe,dfe,dfe,dfe,pfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,pfe],[dfe,dfe,dfe,dfe,dfe,dfe,dfe,dfe]],0),[cfe.of(new Yae(0,2),new Yae(4,2)).get()],$localize(ro||(ro=bg(["Congratulations!"]))),$localize(io||(io=bg(["Failed!"]))))]});function yfe(e,t){if(1&e&&(l_(),rS(0,"circle",3)),2&e){var n=fS().index,r=fS().index,i=fS();JE("ngClass",i.getPieceClasses(n,r)),qE("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function mfe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"g",2),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),rS(2,"rect",3),KE(3,yfe,1,4,"circle",4),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","click_",i,"_",a,""),gb(1),JE("ngClass",o.getSquareClasses(i,a)),qE("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r!==o.EMPTY)}}function kfe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,mfe,4,8,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function _fe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",5),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e.x,e.y)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),qE("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var Cfe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=Lre.NONE,r.targets=[],r.selected=fB.empty(),r.lastMove=fB.empty(),r.captured=fB.empty(),r.rules=new hfe(ufe),r.availableMinimaxes=[new ffe(r.rules,"LinesOfActionMinimax")],r.encoder=cfe.encoder,r.tutorial=(new gfe).tutorial,r.updateBoard(),r}return Zg(n,[{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Yae(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(a)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(a));case 7:return o=cfe.of(n.selected.get(),new Yae(e,t)),r.abrupt("return",o.isSuccess()?n.chooseMove(o.get(),n.rules.node.gameState):n.cancelMove(lfe.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(a));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(ioe.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=fB.of(e),t.targets=hfe.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(lfe.PIECE_CANNOT_MOVE()):A7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?fB.of(e.end):fB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=fB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new Yae(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new Yae(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-linesofaction"]],features:[xE],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,kfe,2,1,"g",1),KE(2,_fe,2,4,"g",1),nS()),2&e&&(gb(1),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.targets))},directives:[FA,DA,VA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),wfe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return jg(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return Zg(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(doe);wfe.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encodeMove",value:function(e){return{coord:Yae.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return D7(null!=t.coord,"Invalid encoded LodestoneMove"),D7(null!=t.direction,"Invalid encoded LodestoneMove"),D7(null!=t.orientation,"Invalid encoded LodestoneMove"),D7(null!=t.captures,"Invalid encoded LodestoneMove"),new wfe(Yae.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(Mre));var bfe=function(){var e=Zg(function e(){jg(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(ao||(ao=bg(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(oo||(oo=bg(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(so||(so=bg(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(uo||(uo=bg(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(co||(co=bg(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(lo||(lo=bg(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),Efe=function(){function e(t){jg(this,e),this.unreachable=t}return Zg(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();Efe.UNREACHABLE=new Efe(!0),Efe.EMPTY=new Efe(!1);var Sfe=function(){function e(t){jg(this,e),this.owner=t}return Zg(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===Fre.ZERO?e.ZERO:e.ONE}}]),e}();Sfe.ZERO=new Sfe(Fre.ZERO),Sfe.ONE=new Sfe(Fre.ONE);var Pfe=function(){function e(t,n,r){jg(this,e),this.owner=t,this.direction=n,this.orientation=r}return Zg(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();Pfe.LODESTONES={0:{push:{diagonal:new Pfe(Fre.ZERO,"push","diagonal"),orthogonal:new Pfe(Fre.ZERO,"push","orthogonal")},pull:{diagonal:new Pfe(Fre.ZERO,"pull","diagonal"),orthogonal:new Pfe(Fre.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Pfe(Fre.ONE,"push","diagonal"),orthogonal:new Pfe(Fre.ONE,"push","orthogonal")},pull:{diagonal:new Pfe(Fre.ONE,"pull","diagonal"),orthogonal:new Pfe(Fre.ONE,"pull","orthogonal")}}};var Ofe=function(){function e(t,n){jg(this,e),this.width=t,this.pieces=n}return Zg(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):(D7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),fB.empty());for(var r=zre.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(Sfe.of(t));return fB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:Efe.EMPTY}}]),e}();Ofe.POSITIONS=["top","bottom","left","right"],Ofe.EMPTY_5=new Ofe(5,[]),Ofe.EMPTY_3=new Ofe(3,[]);var Tfe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return Zg(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=Gg(Ofe.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return fB.empty();var n=this.getPieceAt(t.get());switch(D7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return fB.of("pull");case"pull":return fB.of("push")}}}],[{key:"getInitialState",value:function(){var e=Efe.EMPTY,t=Sfe.ZERO,r=Sfe.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new goe,{top:fB.of(Ofe.EMPTY_5),bottom:fB.of(Ofe.EMPTY_5),left:fB.of(Ofe.EMPTY_5),right:fB.of(Ofe.EMPTY_5)})}}]),n}(loe);return e.SIZE=8,e}(),Ife=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,Tfe)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=zre.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=Sg({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new Tfe(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=Gg(Ofe.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(Tfe.SIZE,Tfe.SIZE);i=i.getNext(n)){var a,o=Gg(Fre.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=Efe.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return O7.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return O7.failure(bfe.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=Gg(Ofe.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return O7.failure(bfe.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return O7.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=zre.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=Efe.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=Pfe.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=Gg("diagonal"===r?jae.DIAGONALS:jae.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,h=n.getNext(l);e.isOnBoard(h);h=h.getNext(l)){var f=t[h.y][h.x],d=h.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(f.isEmpty()?(u.push(h),t[h.y][h.x]=v,u.push(d),t[d.y][d.x]=Efe.EMPTY):f.isPlayerPiece()&&f.owner===o&&(s.push(h),t[h.y][h.x]=v,u.push(d),t[d.y][d.x]=Efe.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=Gg("diagonal"===r?jae.DIAGONALS:jae.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,Tfe.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var h=t[l.y][l.x];if(h.isPlayerPiece()&&h.owner===a){var f=l.getNext(c);if(e.isOnBoard(f)){var d=t[f.y][f.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=Efe.EMPTY):d.isEmpty()&&(s.push(f),t[f.y][f.x]=h,s.push(l),t[l.y][l.x]=Efe.EMPTY)}else o.push(l),t[l.y][l.x]=Efe.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?A7.failure(bfe.MUST_FLIP_LODESTONE()):A7.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return A7.failure(bfe.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return A7.failure(ioe.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?A7.failure(ioe.MUST_CLICK_ON_EMPTY_SQUARE()):A7.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?_oe.DRAW:0===t[0]?_oe.ONE_WON:0===t[1]?_oe.ZERO_WON:_oe.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(Coe);Ife.THREATENED_COORD_RANGE=goe.from({top:{startForBigPlate:new Yae(0,0),startForSmallPlate:new Yae(0,1),direction:jae.RIGHT},bottom:{startForBigPlate:new Yae(0,Tfe.SIZE-1),startForSmallPlate:new Yae(0,Tfe.SIZE-2),direction:jae.RIGHT},left:{startForBigPlate:new Yae(0,0),startForSmallPlate:new Yae(1,0),direction:jae.DOWN},right:{startForBigPlate:new Yae(Tfe.SIZE-1,0),startForSmallPlate:new Yae(Tfe.SIZE-2,0),direction:jae.DOWN}}),Ife.singleton=fB.empty();var Afe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=Gg(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],h=Ife.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,f=Gg(t.captureCombinations(n,h));try{for(f.s();!(c=f.n()).done;){var d=c.value;i.push(new wfe(e,o,l,d))}}catch(v){f.e(v)}finally{f.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new uoe([{top:0,bottom:0,left:0,right:0}]);var n,r=new uoe,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=Gg(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add(Sg(Sg({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add(Sg(Sg({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add(Sg(Sg({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add(Sg(Sg({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<Tfe.SIZE;r++)for(var i=0;i<Tfe.SIZE;i++){var a=new Yae(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?Fre.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?Fre.ONE.getVictoryValue():n[0]*Fre.ZERO.getScoreModifier()+n[1]*Fre.ONE.getScoreModifier(),new ooe(t)}}]),n}(aoe),Rfe=Efe.UNREACHABLE,xfe=Efe.EMPTY,Mfe=Sfe.ZERO,Nfe=Sfe.ONE,Dfe=Pfe.of(Fre.ONE,{direction:"push",orientation:"orthogonal"}),Lfe={top:fB.of(Ofe.EMPTY_5),bottom:fB.of(Ofe.EMPTY_5),left:fB.of(Ofe.EMPTY_5),right:fB.of(Ofe.EMPTY_5)},Ffe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(ho||(ho=bg(["Board and aim of the game"]))),$localize(fo||(fo=bg(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),Tfe.getInitialState()),Soe.forClick($localize(vo||(vo=bg(["Selecting a lodestone"]))),$localize(po||(po=bg(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),Tfe.getInitialState(),["#lodestone_push_diagonal"],$localize(go||(go=bg(["Congratulations!"]))),$localize(yo||(yo=bg(["This is not the right lodestone, try again."])))),Soe.informational($localize(mo||(mo=bg(["The repelling lodestone"]))),$localize(ko||(ko=bg(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),Tfe.getInitialState()),Soe.informational($localize(_o||(_o=bg(["The attracting lodestone"]))),$localize(Co||(Co=bg(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),Tfe.getInitialState()),Soe.informational($localize(wo||(wo=bg(["Flipping the lodestone"]))),$localize(bo||(bo=bg(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),Tfe.getInitialState()),Soe.fromPredicate($localize(Eo||(Eo=bg(["Capturing"]))),$localize(So||(So=bg(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),Tfe.getInitialState(),new wfe(new Yae(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t){return 32===t.remainingSpaces()?A7.failure($localize(Po||(Po=bg(["You have not captured any of the opponent's pieces, try again!"])))):A7.SUCCESS},"Congratulations!"),Soe.fromPredicate($localize(Oo||(Oo=bg(["Crumbling a first pressure plate"]))),$localize(To||(To=bg(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new Tfe([[xfe,xfe,xfe,xfe,Nfe,xfe,xfe,xfe],[xfe,xfe,Mfe,xfe,xfe,Nfe,xfe,xfe],[xfe,xfe,Dfe,xfe,xfe,xfe,xfe,Mfe],[xfe,xfe,xfe,xfe,Nfe,xfe,xfe,Mfe],[xfe,xfe,xfe,xfe,xfe,Mfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe]],0,new goe([{key:Fre.ONE,value:new Yae(2,2)}]),Sg(Sg({},Lfe),{},{top:Ofe.EMPTY_5.addCaptured(Fre.ONE,4)})),new wfe(new Yae(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t){return 5===t.pressurePlates.top.get().width?A7.failure($localize(Io||(Io=bg(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):A7.SUCCESS},"Congratulations!"),Soe.fromPredicate($localize(Ao||(Ao=bg(["Crumbling a second pressure plate"]))),$localize(Ro||(Ro=bg(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new Tfe([[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,Mfe],[xfe,xfe,xfe,xfe,xfe,Mfe,xfe,Mfe],[xfe,Dfe,xfe,xfe,Nfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,Nfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe]],0,new goe([{key:Fre.ONE,value:new Yae(1,4)}]),Sg(Sg({},Lfe),{},{top:Ofe.EMPTY_3.addCaptured(Fre.ONE,2)})),new wfe(new Yae(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t){return t.pressurePlates.top.isPresent()?A7.failure($localize(xo||(xo=bg(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):A7.SUCCESS},"Congratulations!"),Soe.informational($localize(Mo||(Mo=bg(["Minimal board"]))),$localize(No||(No=bg(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new Tfe([[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe],[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe],[Rfe,Rfe,Mfe,Nfe,xfe,xfe,Rfe,Rfe],[Rfe,Rfe,Dfe,Nfe,xfe,xfe,Rfe,Rfe],[Rfe,Rfe,xfe,Mfe,Mfe,xfe,Rfe,Rfe],[Rfe,Rfe,Mfe,xfe,xfe,xfe,Rfe,Rfe],[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe],[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe]],0,new goe([{key:Fre.ONE,value:new Yae(2,3)}]),{top:fB.empty(),bottom:fB.empty(),left:fB.empty(),right:fB.empty()})),Soe.fromMove($localize(Do||(Do=bg(["Making the lodestone fall"]))),$localize(Lo||(Lo=bg(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new Tfe([[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,Nfe,xfe,xfe],[xfe,xfe,xfe,Dfe,xfe,xfe,Mfe,xfe],[xfe,xfe,Mfe,Mfe,Nfe,xfe,xfe,Mfe],[xfe,xfe,xfe,xfe,xfe,Mfe,xfe,xfe],[xfe,xfe,Mfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,Nfe,xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe,xfe,xfe,xfe]],0,new goe([{key:Fre.ONE,value:new Yae(3,2)}]),Sg(Sg({},Lfe),{},{top:Ofe.EMPTY_5.addCaptured(Fre.ONE,4)})),[new wfe(new Yae(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(Fo||(Fo=bg(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(Uo||(Uo=bg(["Failed, try again."])))),Soe.fromMove($localize(Vo||(Vo=bg(["End of the game"]))),$localize(Bo||(Bo=bg(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new Tfe([[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe],[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe],[Rfe,Nfe,Mfe,Nfe,xfe,xfe,Rfe,Rfe],[Rfe,Nfe,Dfe,xfe,Nfe,xfe,Rfe,Rfe],[Rfe,xfe,xfe,Mfe,Mfe,xfe,Rfe,Rfe],[Rfe,Nfe,Mfe,xfe,Nfe,xfe,Rfe,Rfe],[Rfe,xfe,xfe,xfe,Mfe,xfe,Rfe,Rfe],[Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe,Rfe]],0,new goe([{key:Fre.ONE,value:new Yae(2,3)}]),{top:fB.empty(),bottom:Ofe.EMPTY_3.addCaptured(Fre.ZERO,2),left:fB.of(Ofe.EMPTY_3),right:fB.empty()}),[new wfe(new Yae(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(zo||(zo=bg(["Congratulations, you won!"]))),$localize(Ho||(Ho=bg(["This is not the winning move. Try again."]))))]});function Ufe(e,t){if(1&e&&(l_(),rS(0,"circle",10)),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();pS("id","piece_",r,"_",a,""),JE("ngClass",i.pieceClasses),qE("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Vfe(e,t){if(1&e&&(l_(),rS(0,"polygon",15)),2&e){var n=fS().$implicit,r=fS(3).$implicit,i=fS(2);YE("transform","rotate(",90*n,")"),JE("ngClass",r.lodestone.movingClass),qE("points",i.TRIANGLE_OUT)}}function Bfe(e,t){if(1&e&&(l_(),rS(0,"polygon",15)),2&e){var n=fS().$implicit,r=fS(3).$implicit,i=fS(2);YE("transform","rotate(",90*n,")"),JE("ngClass",r.lodestone.movingClass),qE("points",i.TRIANGLE_IN)}}function zfe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Vfe,1,3,"polygon",14),KE(2,Bfe,1,3,"polygon",14),nS()),2&e){var n=fS(3).$implicit;gb(1),JE("ngIf","push"===n.lodestone.direction),gb(1),JE("ngIf","pull"===n.lodestone.direction)}}var Hfe=function(){return[0,1,2,3]};function Gfe(e,t){if(1&e&&(l_(),tS(0,"g",11),rS(1,"circle",12),rS(2,"circle",13),tS(3,"g"),KE(4,zfe,3,2,"g",1),nS(),nS()),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();qE("transform",o.getSquareTransform(r,a)),gb(1),JE("ngClass",i.lodestone.selectedClass),qE("r",o.PIECE_RADIUS),gb(1),JE("ngClass",i.lodestone.pieceClasses),qE("r",o.PIECE_RADIUS/4),gb(1),YE("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),gb(1),JE("ngForOf",oT(7,Hfe))}}function $fe(e,t){if(1&e){var n=oS();l_(),tS(0,"g",6),cS("click",function(){Dk(n);var e=fS().$implicit;return fS(2).selectCoord(e.coord)}),rS(1,"rect",7),KE(2,Ufe,1,6,"circle",8),KE(3,Gfe,5,8,"g",9),nS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();pS("id","square_",i,"_",o,""),gb(1),JE("ngClass",a.squareClasses),qE("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),gb(1),JE("ngIf",a.hasPiece),gb(1),JE("ngIf",a.lodestone)}}function qfe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,$fe,4,9,"g",5),nS()),2&e){var n=t.$implicit;gb(1),JE("ngIf",!1===n.crumbled)}}function jfe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,qfe,2,1,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Wfe(e,t){if(1&e&&(l_(),tS(0,"g",16),rS(1,"circle",17),nS()),2&e){var n=t.$implicit,r=t.index,i=fS();vS("id","capture_",r,""),qE("transform",i.getCaptureTransform(r)),gb(1),JE("ngClass",n.pieceClasses),qE("r",i.PIECE_RADIUS)}}function Zfe(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"polygon",15),nS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS();gb(1),YE("transform","rotate(",90*n,")"),JE("ngClass",r.movingClass),qE("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Yfe(e,t){if(1&e){var n=oS();l_(),tS(0,"g",6),cS("click",function(){var e=Dk(n).$implicit;return fS().selectLodestone(e)}),rS(1,"circle",12),rS(2,"circle",13),tS(3,"g"),KE(4,Zfe,2,3,"g",1),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS();pS("id","lodestone_",r.direction,"_",r.orientation,""),qE("transform",a.getAvailableLodestoneTransform(i)),gb(1),JE("ngClass",r.selectedClass),qE("r",a.PIECE_RADIUS),gb(1),JE("ngClass",r.pieceClasses),qE("r",a.PIECE_RADIUS/4),gb(1),YE("transform","rotate(","diagonal"===r.orientation?45:0,")"),gb(1),JE("ngForOf",oT(9,Hfe))}}function Kfe(e,t){if(1&e&&(l_(),rS(0,"circle",10)),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().$implicit,o=fS();pS("id","platePiece_",a.position,"_",r,""),JE("ngClass",i.pieceClasses),qE("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Qfe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"g",6),cS("click",function(){var e=Dk(n),t=e.$implicit,r=e.index,i=fS().$implicit;return fS().onPressurePlateClick(t.temporary,i.position,r)}),rS(2,"rect",18),KE(3,Kfe,1,6,"circle",8),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().$implicit,o=fS();qE("transform",o.getPressurePlateTransform(a.position)),gb(1),pS("id","plate_",a.position,"_",i,""),gb(1),pS("id","plateSquare_",a.position,"_",i,""),JE("ngClass",r.squareClasses),qE("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r.hasPiece)}}function Xfe(e,t){if(1&e&&(l_(),tS(0,"g",16),KE(1,Qfe,4,11,"g",1),nS()),2&e){var n=t.$implicit;vS("id","pressurePlate_",n.position,""),gb(1),JE("ngForOf",n.coords)}}function Jfe(e,t){if(1&e&&(l_(),rS(0,"rect",19)),2&e){var n=fS();pS("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),qE("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var ede=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;jg(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:fB.empty(),pressurePlateShift:{top:new Gae(0,0),left:new Gae(0,0),right:new Gae(0,0),bottom:new Gae(0,0)}},r.stateAfterPlacingLodestone=fB.empty(),r.lastInfos=fB.empty(),r.capturesToPlace=0,r.selectedCoord=fB.empty(),r.selectedLodestone=fB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=Ife.get(),r.tutorial=(new Ffe).tutorial,r.availableMinimaxes=[new Afe(r.rules,"LodestoneDummyMinimax")],r.encoder=wfe.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.rules.node.gameState,r.scores=fB.of([0,0]),r}return Zg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(bfe.MUST_PLACE_CAPTURES()));case 5:return i=Ife.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedLodestone.isPresent()?(t.selectedCoord=fB.of(e),t.putLodestone()):(t.selectedCoord=fB.of(e),t.updateViewInfo(),A7.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return D7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),n.abrupt("return",(t.selectedLodestone=fB.of(Pfe.of(i,e)),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),A7.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.selectedCoord.isPresent(),"coord should have been selected"),D7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),D7(Ife.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=Ife.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=fB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=fB.of(e.displayedState),e.updateViewInfo(),A7.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.selectedCoord.isPresent(),"coord should have been selected"),D7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new wfe(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(bfe.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=zre.copyBiArray(a.board),u=Sg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Ife.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new Tfe(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),A7.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=zre.copyBiArray(a.board),u=Sg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Ife.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new Tfe(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),A7.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=fB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=fB.empty(),this.lastInfos=fB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=zre.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=Efe.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=fB.empty(),this.selectedLodestone=fB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<Tfe.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<Tfe.SIZE;t++){var n=new Yae(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:fB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=Pfe.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=Gg(Ofe.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),h="";l.isPlayerPiece()&&(h=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(f){t.e(f)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=fB.of(Ife.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=Gg(Ofe.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=sB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,h=Gg(o.coords);try{for(h.s();!(l=h.n()).done;){l.value.squareClasses.push("moved")}}catch(f){h.e(f)}finally{h.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=Gg(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}}catch(s){n.e(s)}finally{n.f()}var i,a=Gg(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Yae(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new Yae(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new Yae(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new Yae(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(Tfe.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(Tfe.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(Kae);ede.PRESSURE_PLATE_EXTRA_SHIFT=.2,ede.PRESSURE_PLATES_POSITIONS=goe.from({top:{startForBigPlate:new Yae(.5,-1-ede.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new Yae(1.5,0-ede.PRESSURE_PLATE_EXTRA_SHIFT),direction:jae.RIGHT},bottom:{startForBigPlate:new Yae(.5,8+ede.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new Yae(1.5,7+ede.PRESSURE_PLATE_EXTRA_SHIFT),direction:jae.RIGHT},left:{startForBigPlate:new Yae(-1-ede.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new Yae(0-ede.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:jae.DOWN},right:{startForBigPlate:new Yae(8+ede.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new Yae(7+ede.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:jae.DOWN}}),ede.\u0275fac=function(e){return new(e||ede)(XE(M7))},ede.\u0275cmp=$m({type:ede,selectors:[["app-lodestone"]],features:[xE],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected",3,"id"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,jfe,2,1,"g",1),KE(2,Wfe,2,4,"g",2),KE(3,Yfe,5,10,"g",3),KE(4,Xfe,2,2,"g",2),KE(5,Jfe,1,6,"rect",4),nS()),2&e&&(gb(1),JE("ngForOf",t.viewInfo.boardInfo),gb(1),JE("ngForOf",t.viewInfo.capturesToPlace),gb(1),JE("ngForOf",t.viewInfo.availableLodestones),gb(1),JE("ngForOf",t.viewInfo.pressurePlates),gb(1),JE("ngIf",t.viewInfo.selected.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var tde=function(){var e=Zg(function e(){jg(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(Go||(Go=bg(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize($o||($o=bg(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize(qo||(qo=bg(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(jo||(jo=bg(["Drones must move one or two steps in any direction."])))},e}(),nde=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return Zg(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return O7.failure(tde.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return O7.failure(tde.END_COORD_OUT_OF_RANGE());if(t.equals(e))return O7.failure(ioe.MOVE_CANNOT_BE_STATIC());var i=jae.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?O7.failure(i.getReason()):O7.success(new n(e,t,r))}}]),n}(gse);nde.encoder=Nre.tuple([Yae.numberEncoder(4,8),Yae.numberEncoder(4,8),Nre.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return nde.from(e[0],e[1],e[2]).get()});var rde=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){D7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?fB.of(e.from(r)):fB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(sB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();rde.EMPTY=new rde(0),rde.PAWN=new rde(1),rde.DRONE=new rde(2),rde.QUEEN=new rde(3);var ide=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,r)).ruler=e,i}return Zg(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=Gg(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case rde.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case rde.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case rde.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new Yae(t,n),a=[],o=Gg(jae.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(rde.DRONE),s=!1===e.isTherePieceOnPlayerSide(rde.QUEEN),u=e.lastMove,c=Gg(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=e.getPieceAt(l);if(h===rde.EMPTY)this.add(i,nde.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var f=rde.tryMerge(h,a);if(f.isPresent()){var d=f.get(),v=nde.from(t,l).get();(d===rde.DRONE&&o||d===rde.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,nde.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new Yae(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=Gg(jae.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(rde.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(rde.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(h){a.e(h)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new Yae(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(Fre.ZERO);t=e.gameState.getScoreOf(Fre.ONE)-r}return new ooe(t)}}]),n}(aoe),ade=function(){function e(t){jg(this,e),this.captures=t,t.makeImmutable()}return Zg(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new goe,i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),ode=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fB.empty(),s=arguments.length>4?arguments[4]:void 0;return jg(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new goe([{key:Fre.ZERO,value:ade.from([])},{key:Fre.ONE,value:ade.from([])}])),s.makeImmutable(),i.captured=s,i}return Zg(n,[{key:"getPlayerTerritory",value:function(e){return e===Fre.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=Gg(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(Fre.ZERO)?fB.of(Fre.ZERO):this.isTerritoryEmpty(Fre.ONE)?fB.of(Fre.ONE):fB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=Gg(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==rde.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(Fre.fromTurn(e)).get();return[t.captures.get(rde.PAWN).getOrElse(0),t.captures.get(rde.DRONE).getOrElse(0),t.captures.get(rde.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=rde.EMPTY,t=rde.PAWN,r=rde.DRONE,i=rde.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,fB.empty())}}]),n}(loe);ode.PLAYER_ZERO_TERRITORY=new uoe([0,1,2,3]),ode.PLAYER_ONE_TERRITORY=new uoe([4,5,6,7]);var sde=function(){var e=Zg(function e(){jg(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(Wo||(Wo=bg(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(Zo||(Zo=bg(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(Yo||(Yo=bg(["You cannot perform a move that is the reverse of the previous one."])))},e}(),ude=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=rde.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=fB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new ode(i,t.turn+1,fB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return O7.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return O7.failure(sde.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return O7.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){D7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==rde.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==rde.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return O7.failure(sde.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return O7.failure(sde.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return O7.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return O7.failure(sde.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===rde.EMPTY)return O7.failure(ioe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===rde.PAWN)return e.isValidForPawn()?O7.success(void 0):O7.failure(tde.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===rde.DRONE&&!1===e.isValidForDrone())return O7.failure(tde.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=Gg(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==rde.EMPTY)return O7.failure(ioe.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return O7.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return rde.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,_oe.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=_oe.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return _oe.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(Fre.ZERO),r=e.getScoreOf(Fre.ONE);return n>r?_oe.ZERO_WON:r>n?_oe.ONE_WON:t}}]),n}(Coe);ude.STARTING_COUNT_DOWN=fB.of(7);var cde=function(){var e=Zg(function e(){jg(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(Ko||(Ko=bg(["Failed, you did not capture any piece."])))},e}(),lde=rde.EMPTY,hde=rde.PAWN,fde=rde.DRONE,dde=rde.QUEEN,vde=function(){return $localize(Qo||(Qo=bg(["This is not a field promotion!"])))},pde=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Xo||(Xo=bg(["Goal of the game"]))),$localize(Jo||(Jo=bg(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),ode.getInitialState()),Soe.informational($localize(es||(es=bg(["The pieces"]))),$localize(ts||(ts=bg(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),ode.getInitialState()),Soe.fromPredicate($localize(ns||(ns=bg(["Moving pawns"]))),$localize(rs||(rs=bg(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),ode.getInitialState(),nde.from(new Yae(1,2),new Yae(2,3)).get(),function(e,t){return t.getPieceAt(e.end)===rde.PAWN?A7.SUCCESS:A7.failure($localize(is||(is=bg(["This is not a pawn!"]))))},$localize(as||(as=bg(["Congratulations!"])))),Soe.fromPredicate($localize(os||(os=bg(["Moving drones"]))),$localize(ss||(ss=bg(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),ode.getInitialState(),nde.from(new Yae(2,0),new Yae(3,0)).get(),function(e,t){return t.getPieceAt(e.end)===rde.DRONE?A7.SUCCESS:A7.failure($localize(us||(us=bg(["This is not a drone!"]))))},$localize(cs||(cs=bg(["Congratulations!"])))),Soe.fromPredicate($localize(ls||(ls=bg(["Moving queens"]))),$localize(hs||(hs=bg(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new ode([[fde,hde,lde,lde],[dde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,dde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[dde,fde,hde,lde]],0),nde.from(new Yae(2,3),new Yae(2,7)).get(),function(e,t){return t.getPieceAt(e.end)===rde.QUEEN?A7.SUCCESS:A7.failure($localize(fs||(fs=bg(["This is not a queen!"]))))},$localize(ds||(ds=bg(["Congratulations!"])))),Soe.fromMove($localize(vs||(vs=bg(["Capture"]))),$localize(ps||(ps=bg(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new ode([[fde,hde,hde,lde],[lde,lde,lde,lde],[dde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,hde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,fde,hde,lde]],0),[nde.from(new Yae(0,2),new Yae(2,4)).get()],$localize(gs||(gs=bg(["Congratulations! By capturing that pawn, you won one point."]))),cde.YOU_DID_NOT_CAPTURE_ANY_PIECE()),Soe.fromMove($localize(ys||(ys=bg(["Field Promotion (1/2)"]))),$localize(ms||(ms=bg(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new ode([[lde,lde,lde,dde],[lde,hde,lde,lde],[lde,lde,hde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,dde],[lde,lde,fde,lde],[lde,hde,lde,lde]],0),[nde.from(new Yae(1,1),new Yae(2,2)).get(),nde.from(new Yae(2,2),new Yae(1,1)).get()],$localize(ks||(ks=bg(["Congratulations!"]))),vde()),Soe.fromPredicate($localize(_s||(_s=bg(["Field Promotion (2/2)"]))),$localize(Cs||(Cs=bg(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new ode([[hde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,fde,lde],[lde,hde,lde,lde]],1),nde.from(new Yae(1,7),new Yae(2,6)).get(),function(e,t){return t.getPieceAt(e.end)===rde.QUEEN?A7.SUCCESS:A7.failure(vde())},$localize(ws||(ws=bg(["Congratulations!"])))),Soe.fromPredicate($localize(bs||(bs=bg(["Call the clock"]))),$localize(Es||(Es=bg(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),ode.getInitialState(),nde.from(new Yae(2,2),new Yae(3,3),!0).get(),function(e,t){return e.calledTheClock?A7.SUCCESS:A7.failure($localize(Ss||(Ss=bg(["You did not call the clock!"]))))},$localize(Ps||(Ps=bg(["Congratulations!"])))),Soe.fromMove($localize(Os||(Os=bg(["Restarting the clock"]))),$localize(Ts||(Ts=bg(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new ode([[lde,lde,lde,lde],[lde,hde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,hde],[lde,lde,fde,lde],[lde,hde,lde,lde]],14,fB.empty(),fB.of(1)),[nde.from(new Yae(1,1),new Yae(2,2)).get()],$localize(Is||(Is=bg(["Congratulations!"]))),$localize(As||(As=bg(["This is not a capture, the game is now over, please retry!"])))),Soe.anyMove($localize(Rs||(Rs=bg(["End game (by clock)"]))),$localize(xs||(xs=bg(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new ode([[lde,lde,lde,dde],[lde,hde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[fde,lde,lde,lde],[lde,lde,lde,lde],[lde,fde,lde,lde]],14,fB.empty(),fB.of(1)),nde.from(new Yae(1,1),new Yae(2,2)).get(),$localize(Ms||(Ms=bg(["Congratulations!"])))),Soe.fromPredicate($localize(Ns||(Ns=bg(["End by emptyness"]))),$localize(Ds||(Ds=bg(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new ode([[lde,lde,lde,dde],[lde,hde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,hde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde],[lde,lde,lde,lde]],1),nde.from(new Yae(2,4),new Yae(1,3)).get(),function(e,t){return 3===e.end.y?A7.SUCCESS:A7.failure($localize(Ls||(Ls=bg(["Your piece is still in you territory!"]))))},$localize(Fs||(Fs=bg(["Congratulations!"]))))]});function gde(e,t){if(1&e&&(l_(),rS(0,"g",20)),2&e){var n=fS(2).index,r=fS().index,i=fS();OS(i.style),pS("mainShapeId","pawn_",n,"_",r,""),JE("pieceClasses",i.getPieceClasses(n,r))}}function yde(e,t){if(1&e&&(l_(),rS(0,"g",21)),2&e){var n=fS(2).index,r=fS().index,i=fS();OS(i.style),pS("mainShapeId","drone_",n,"_",r,""),JE("pieceClasses",i.getPieceClasses(n,r))}}function mde(e,t){if(1&e&&(l_(),rS(0,"g",22)),2&e){var n=fS(2).index,r=fS().index,i=fS();OS(i.style),pS("mainShapeId","queen_",n,"_",r,""),JE("pieceClasses",i.getPieceClasses(n,r))}}function kde(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,gde,1,5,"g",17),KE(2,yde,1,5,"g",18),KE(3,mde,1,5,"g",19),nS()),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().index,o=fS();qE("transform",o.getPieceLocation(r,a)),gb(1),JE("ngIf",i===o.pieces.PAWN),gb(1),JE("ngIf",i===o.pieces.DRONE),gb(1),JE("ngIf",i===o.pieces.QUEEN)}}function _de(e,t){if(1&e){var n=oS();l_(),tS(0,"g",15),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),rS(1,"rect",16),KE(2,kde,4,4,"g",14),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();pS("id","click_",i,"_",a,""),qE("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),gb(1),pS("id","square_",i,"_",a,""),JE("ngClass",o.getSquareClasses(i,a)),qE("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r!==o.pieces.EMPTY)}}function Cde(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",23),cS("click",function(){var e=Dk(n).$implicit;return fS(3).onClick(e.x,e.y)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS(3);gb(1),pS("id","indicator_",r.x,"_",r.y,""),qE("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function wde(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Cde,2,7,"g",1),nS()),2&e){var n=fS(2);gb(1),JE("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function bde(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,_de,3,11,"g",13),KE(2,wde,2,1,"g",14),nS()),2&e){var n=t.$implicit,r=fS();qE("transform","translate("+r.SPACE_SIZE+", 0)"),gb(1),JE("ngForOf",n),gb(1),JE("ngIf",r.selectedPieceInfo.isPresent())}}function Ede(e,t){if(1&e&&(l_(),tS(0,"text",24),US(1),nS()),2&e){var n=fS();JE("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),qE("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),gb(1),VS(n.countDown.get())}}function Sde(e,t){if(1&e&&(l_(),rS(0,"polyline",25)),2&e){var n=fS();JE("ngClass",n.getClockCircleClasses()),qE("points",n.clockNeedlesPoints)}}var Pde=function(e){return[e]};function Ode(e,t){if(1&e){var n=oS();l_(),iS(0),tS(1,"g",28),cS("click",function(){var e=Dk(n).index;return fS(2).chooseStyle(e)}),nS(),aS()}if(2&e){var r=t.$implicit,i=t.index,a=fS(2);gb(1),OS(r.style),JE("id",r.name)("pieceClasses",sT(5,Pde,"player"+a.getCurrentPlayer().value)),qE("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function Tde(e,t){if(1&e&&(l_(),tS(0,"g",26),rS(1,"rect",27),KE(2,Ode,2,7,"ng-container",1),nS()),2&e){var n=fS();gb(1),qE("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),gb(1),JE("ngForOf",n.listOfStyles)}}function Ide(e,t){if(1&e&&(l_(),tS(0,"text",34),US(1),nS()),2&e){var n=fS(2).$implicit,r=fS().$implicit,i=fS();JE("ngClass","player"+(0===r?1:0)),qE("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),gb(1),VS(n+" x ")}}function Ade(e,t){if(1&e&&(l_(),rS(0,"g",35)),2&e){var n=fS(3).$implicit;OS(fS().style),JE("pieceClasses",sT(3,Pde,"player"+(0===n?1:0)))}}function Rde(e,t){if(1&e&&(l_(),rS(0,"g",36)),2&e){var n=fS(3).$implicit;OS(fS().style),JE("pieceClasses",sT(3,Pde,"player"+(0===n?1:0)))}}function xde(e,t){if(1&e&&(l_(),rS(0,"g",37)),2&e){var n=fS(3).$implicit;OS(fS().style),JE("pieceClasses",sT(3,Pde,"player"+(0===n?1:0)))}}function Mde(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Ide,2,4,"text",30),tS(2,"g",29),KE(3,Ade,1,5,"g",31),KE(4,Rde,1,5,"g",32),KE(5,xde,1,5,"g",33),nS(),nS()),2&e){var n=fS(),r=n.index,i=n.$implicit,a=fS().$implicit,o=fS();qE("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),gb(1),JE("ngIf",i>1),gb(1),pS("id","piece_",r,"_player_",a,""),qE("transform","translate("+o.SPACE_SIZE+", 0)"),gb(1),JE("ngIf",0===r),gb(1),JE("ngIf",1===r),gb(1),JE("ngIf",2===r)}}function Nde(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Mde,6,8,"g",14),nS()),2&e){var n=t.$implicit;gb(1),JE("ngIf",n>0)}}function Dde(e,t){if(1&e&&(l_(),tS(0,"g"),tS(1,"g",29),KE(2,Nde,2,1,"g",1),nS(),nS()),2&e){var n=t.$implicit,r=fS();gb(1),vS("id","capture_of_player_",n,""),qE("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),gb(1),JE("ngForOf",r.state.getCapturesOf(n))}}var Lde=function(){return[0,1]},Fde=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=rde,r.selectedPieceInfo=fB.empty(),r.countDown=fB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.rules=new ude(ode),r.availableMinimaxes=[new ide(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=nde.encoder,r.tutorial=(new pde).tutorial,r.scores=fB.of([0,0]),r.updateBoard(),r}return Zg(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board;var e=this.state.getScoreOf(Fre.ZERO),t=this.state.getScoreOf(Fre.ONE);this.countDown=this.state.countDown,this.scores=fB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new Yae(e,t),r=[];return r.push(t<=3?"player0":"player1"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("highlighted"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==rde.EMPTY&&this.rules.node.gameState.isInOpponentTerritory(new Yae(0,t))&&r.push("highlighted"),r}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new Yae(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),A7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=fB.of({selectedPiece:e,legalLandings:r}),A7.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===rde.PAWN?jae.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===rde.DRONE?2:8)).filter(function(n){var r=nde.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return jae.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===rde.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),A7.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return D7((i=nde.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.rules.node.gameState,n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=nde.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==rde.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=fB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),A7.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("highlighted"),this.getCurrentPlayer()===Fre.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new Yae(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===rde.EMPTY||i.gameState.isInOpponentTerritory(new Yae(0,t))?r.push("moved"):r.push("captured"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new Yae(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new Yae(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(ose);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-martian-chess"]],features:[xE],decls:15,vars:25,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","canal",3,"ngClass"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,bde,3,3,"g",1),tS(2,"g",2),cS("click",function(){return t.onClockClick()}),rS(3,"rect",3),rS(4,"circle",4),KE(5,Ede,2,5,"text",5),KE(6,Sde,1,2,"polyline",6),nS(),rS(7,"line",7),tS(8,"g",8),tS(9,"g",9),cS("click",function(){return t.onModeCogClick()}),rS(10,"rect",3),rS(11,"path",10),nS(),KE(12,Tde,3,5,"g",11),nS(),tS(13,"g",12),KE(14,Dde,3,3,"g",1),nS(),nS()),2&e&&(qE("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT),gb(1),JE("ngForOf",t.board),gb(1),qE("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),gb(1),qE("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),gb(1),JE("ngClass",t.getClockCircleClasses()),qE("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),gb(1),JE("ngIf",t.countDown.isPresent()),gb(1),JE("ngIf",t.countDown.isAbsent()),gb(1),JE("ngClass","player"+t.getCurrentPlayer().value),qE("x1",t.SPACE_SIZE)("y1",5*t.SPACE_SIZE+8)("x2",5*t.SPACE_SIZE)("y2",5*t.SPACE_SIZE+8)("stroke-width",2*t.STROKE_WIDTH),gb(1),qE("transform",t.configViewTranslation),gb(2),qE("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),gb(1),JE("ngClass","player"+t.getCurrentPlayer().value),qE("transform",t.configCogTransformation),gb(1),JE("ngIf",t.displayModePanel),gb(2),JE("ngForOf",oT(24,Lde)))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ude=Number.MAX_SAFE_INTEGER,Vde=Number.MIN_SAFE_INTEGER,Bde=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,zre.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return Zg(n,null,[{key:"getInitialState",value:function(){return new n(0,new Yae(0,0))}}]),n}(loe);Bde.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Bde.BOARD_1=[[0,+Ude,-1,-1],[1,2,+Ude,-1],[+Vde,3,4,-1],[-1,+Vde,+Vde,-1]],Bde.BOARD_2=[[0,+Ude,-1,-1],[+Ude,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Bde.BOARD_3=[[0,1,+Vde,-1],[1,+Vde,-1,-1],[+Vde,-1,-1,-1],[-1,-1,-1,-1]],Bde.BOARD_4=[[0,1,+Vde,-1],[1,+Vde,-1,-1],[+Vde,-1,-1,-1],[-1,-1,-1,1]],Bde.initialBoard=Bde.BOARD_0;var zde=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new Yae(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Bde(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?O7.failure("incorrect move"):O7.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===Fre.ZERO.getVictoryValue()?_oe.ZERO_WON:n===Fre.ONE.getVictoryValue()?_oe.ONE_WON:t.location.equals(new Yae(3,3))?0===n?_oe.DRAW:n>0?_oe.ONE_WON:_oe.ZERO_WON:_oe.ONGOING}}]),n}(Coe),Hde=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).right=e,r}return Zg(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(foe);Hde.RIGHT=new Hde(!0),Hde.DOWN=new Hde(!1),Hde.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Hde.RIGHT:Hde.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(Nre));var Gde=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=zde.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var n=e.gameState;return new ooe(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Hde.RIGHT),n.location.y<3&&t.push(Hde.DOWN),t}}]),n}(aoe);function $de(e,t){1&e&&(iS(0),US(1,"("),aS())}function qde(e,t){1&e&&(iS(0),US(1,")"),aS())}function jde(e,t){if(1&e&&(tS(0,"td"),KE(1,$de,2,0,"ng-container",3),US(2),KE(3,qde,2,0,"ng-container",3),nS()),2&e){var n=t.$implicit,r=t.index,i=fS().index,a=fS();gb(1),JE("ngIf",a.coord.x===r&&a.coord.y===i),gb(1),BS(" ",n," "),gb(1),JE("ngIf",a.coord.x===r&&a.coord.y===i)}}function Wde(e,t){if(1&e&&(tS(0,"tr"),KE(1,jde,4,3,"td",0),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}var Zde=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).coord=new Yae(-1,-1),r.rules=new zde(Bde),r.availableMinimaxes=[new Gde(r.rules,"MinimaxTestingMinimax")],r.encoder=Hde.encoder,r}return Zg(n,[{key:"chooseRight",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Hde.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Hde.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-minimax-testing"]],features:[xE],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(tS(0,"table"),KE(1,Wde,2,1,"tr",0),tS(2,"div",1),cS("click",function(){return t.chooseRight()}),US(3," goRight "),nS(),tS(4,"div",2),cS("click",function(){return t.chooseDown()}),US(5," goDown "),nS(),tS(6,"div"),US(7),nS(),nS()),2&e&&(gb(1),JE("ngForOf",t.board),gb(6),BS(" ",t.coord," "))},directives:[FA,VA],encapsulation:2}),e}(),Yde=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,null,[{key:"getInitialState",value:function(){return new n(zre.createTable(7,6,Lre.NONE),0)}}]),n}(loe),Kde=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this)).x=e,r}return Zg(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(foe);Kde.ZERO=new Kde(0),Kde.ONE=new Kde(1),Kde.TWO=new Kde(2),Kde.THREE=new Kde(3),Kde.FOUR=new Kde(4),Kde.FIVE=new Kde(5),Kde.SIX=new Kde(6),Kde.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Kde.of(e)}}]),n}(Nre));var Qde=function(){var e=Zg(function e(){jg(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(Us||(Us=bg(["Please put your piece in an incomplete column."])))},e}(),Xde=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Yde(a,s+1)}},{key:"isLegal",value:function(e,t){return uB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?O7.failure(Qde.COLUMN_IS_FULL()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new Yae(r,i));if(koe.getScoreStatus(a)===poe.VICTORY)return _oe.getVictory(t.getCurrentOpponent())}return 42===t.turn?_oe.DRAW:_oe.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new Yae(r,i));(a===Fre.ZERO.getVictoryValue()||a===Fre.ONE.getVictoryValue())&&t.push(new Yae(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){uB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new Yae(r,i));if(koe.getScoreStatus(a)!==poe.DEFAULT)return uB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new ooe(a);t+=a}return new ooe(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===Lre.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new Yae(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return D7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===Fre.ONE?Fre.ZERO:Fre.ONE}},{key:"getSquareScore",value:function(e,t){uB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),uB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new goe,u=new goe,c=Gg(jae.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,h[0]),u.set(l,h[1])}}catch(y){c.e(y)}finally{c.f()}for(var f=0,d=[jae.UP,jae.UP_RIGHT,jae.RIGHT,jae.DOWN_RIGHT];f<d.length;f++){var v=d[f],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return uB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){uB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===Lre.NONE){var a=Kde.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return uB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(Coe);return e.VERBOSE=!1,e}(),Jde=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){return Xde.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return uB(Xde.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Xde.getBoardValue(t)}}]),n}(aoe),eve=Lre.NONE,tve=Lre.ZERO,nve=Lre.ONE,rve=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Vs||(Vs=bg(["Goal of the game"]))),$localize(Bs||(Bs=bg(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Yde.getInitialState()),Soe.anyMove($localize(zs||(zs=bg(["Dropping a piece"]))),$localize(Hs||(Hs=bg(["Click on any space in any column."]))),Yde.getInitialState(),Kde.THREE,$localize(Gs||(Gs=bg(["As you can see, the piece falls at the bottom of the column."])))),Soe.fromMove($localize($s||($s=bg(["Victory"]))),$localize(qs||(qs=bg(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Yde([[eve,eve,eve,eve,eve,eve,eve],[eve,eve,eve,eve,eve,eve,eve],[eve,eve,eve,eve,eve,eve,eve],[eve,eve,eve,nve,eve,eve,eve],[eve,eve,eve,nve,eve,eve,eve],[eve,eve,tve,tve,tve,nve,eve]],0),[Kde.of(1)],$localize(js||(js=bg(["You won!"]))),$localize(Ws||(Ws=bg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Soe.fromMove($localize(Zs||(Zs=bg(["Other victory"]))),$localize(Ys||(Ys=bg(["You can also align 4 pieces diagonally or vertically."]))),new Yde([[eve,eve,eve,eve,eve,eve,eve],[eve,eve,eve,eve,eve,eve,eve],[eve,eve,eve,eve,eve,eve,eve],[eve,eve,eve,tve,nve,eve,eve],[eve,eve,tve,tve,nve,eve,eve],[eve,tve,nve,tve,tve,eve,eve]],0),[Kde.of(3),Kde.of(4)],$localize(Ks||(Ks=bg(["You won!"]))),$localize(Qs||(Qs=bg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function ive(e,t){if(1&e&&(l_(),rS(0,"circle",8)),2&e){var n=fS().index,r=fS().index,i=fS();JE("ngClass",i.getSquareFillClass(n,r)),qE("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function ave(e,t){if(1&e){var n=oS();l_(),tS(0,"g",5),cS("click",function(){var e=Dk(n).index;return fS(2).onClick(e)}),rS(1,"rect",6),KE(2,ive,1,4,"circle",7),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();vS("id","click_",i,""),gb(1),qE("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r!==o.EMPTY_CASE)}}function ove(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,ave,3,6,"g",4),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function sve(e,t){if(1&e&&(l_(),rS(0,"rect",9)),2&e){var n=fS();qE("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function uve(e,t){if(1&e&&(l_(),rS(0,"rect",10)),2&e){var n=t.$implicit,r=fS();pS("id","victory_coord_",n.x,"_",n.y,""),qE("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var cve=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).EMPTY_CASE=Lre.NONE,r.victoryCoords=[],r.rules=new Xde(Yde),r.availableMinimaxes=[new Jde(r.rules,"P4Minimax")],r.encoder=Kde.encoder,r.tutorial=(new rve).tutorial,r.updateBoard(),r}return Zg(n,[{key:"onClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Kde.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Xde.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Xde.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=fB.of(new Yae(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=fB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(ose);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-p4"]],features:[xE],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,ove,2,1,"g",1),KE(2,sve,1,4,"rect",2),KE(3,uve,1,6,"rect",3),nS()),2&e&&(gb(1),JE("ngForOf",t.board),gb(1),JE("ngIf",t.last.isPresent()),gb(1),JE("ngForOf",t.victoryCoords))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),lve=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(jg(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return Fg(a)}return Zg(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,fB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,fB.empty())}}]),n}(doe);lve.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encodeMove",value:function(e){var t={coord:Yae.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=Yae.encoder.decode(t.coord),r=fB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return lve.withRotation(n.x,n.y,r.get(),i)}return lve.rotationless(n.x,n.y)}}]),n}(Mre));var hve=function(){var e=Zg(function e(){jg(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(Xs||(Xs=bg(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(Js||(Js=bg(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),fve=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return Zg(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(jae.UP,1)),i=this.getPieceAt(t.getNext(jae.UP_LEFT,1));return this.getPieceAt(t.getNext(jae.RIGHT,1))===r&&this.getPieceAt(t.getNext(jae.DOWN,1))===r&&this.getPieceAt(t.getNext(jae.LEFT,1))===r&&this.getPieceAt(t.getNext(jae.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(jae.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(jae.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=Gg(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var h,f=Gg(n.ROTATION_MAP);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){f.e(y)}finally{f.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(zre.createTable(6,6,Lre.NONE),0)}},{key:"getBlockCenter",value:function(e){return new Yae(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(loe);fve.ROTATION_MAP=[[new Yae(-1,-1),new Yae(1,-1)],[new Yae(0,-1),new Yae(1,0)],[new Yae(1,-1),new Yae(1,1)],[new Yae(1,0),new Yae(0,1)],[new Yae(1,1),new Yae(-1,1)],[new Yae(0,1),new Yae(-1,0)],[new Yae(-1,1),new Yae(-1,-1)],[new Yae(-1,0),new Yae(0,-1)]];var dve=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return O7.failure(hve.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return O7.failure(hve.CANNOT_ROTATE_NEUTRAL_BLOCK())}return O7.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=Gg(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var h=a[0].getPrevious(a[1],1);e.getPieceAt(h)===o&&(s.push(h),r=r.concat(s))}}}}catch(f){i.e(f)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?_oe.DRAW:_oe.ZERO_WON:!0===r[1]?_oe.ONE_WON:36===t.turn?_oe.DRAW:_oe.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n(fve))),n.singleton.get()}}]),n}(Coe);dve.singleton=fB.empty(),dve.VICTORY_SOURCE=[[new Yae(1,0),new Gae(1,1),!1],[new Yae(0,1),new Gae(1,1),!1],[new Yae(4,0),new Gae(-1,1),!1],[new Yae(5,1),new Gae(-1,1),!1],[new Yae(1,1),new Gae(1,1),!0],[new Yae(4,1),new Gae(-1,1),!0],[new Yae(0,1),new Gae(0,1),!0],[new Yae(1,1),new Gae(0,1),!0],[new Yae(2,1),new Gae(0,1),!0],[new Yae(3,1),new Gae(0,1),!0],[new Yae(4,1),new Gae(0,1),!0],[new Yae(5,1),new Gae(0,1),!0],[new Yae(1,0),new Gae(1,0),!0],[new Yae(1,1),new Gae(1,0),!0],[new Yae(1,2),new Gae(1,0),!0],[new Yae(1,3),new Gae(1,0),!0],[new Yae(1,4),new Gae(1,0),!0],[new Yae(1,5),new Gae(1,0),!0]];var vve=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=Gg(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=lve.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=Gg(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var h=o.value;t.push(lve.withRotation(s.x,s.y,h[0],h[1]))}}catch(f){l.e(f)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(f){a.e(f)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new Yae(r,n);e.getPieceAt(i)===Lre.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new ooe(dve.get().getGameStatus(e).toBoardValue())}}]),n}(aoe);vve.FIRST_TURN_MOVES=[lve.rotationless(0,0),lve.rotationless(1,0),lve.rotationless(2,0),lve.rotationless(0,1),lve.rotationless(1,1),lve.rotationless(0,2)];var pve=Lre.NONE,gve=Lre.ZERO,yve=Lre.ONE,mve=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(eu||(eu=bg(["Initial board"]))),$localize(tu||(tu=bg(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),fve.getInitialState()),Soe.informational($localize(nu||(nu=bg(["Goal of the game"]))),$localize(ru||(ru=bg(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new fve([[gve,pve,pve,gve,yve,pve],[gve,yve,pve,pve,pve,pve],[gve,pve,yve,pve,pve,pve],[gve,pve,pve,pve,pve,yve],[gve,pve,pve,pve,yve,pve],[pve,pve,pve,pve,pve,pve]],10)).withPreviousMove(lve.withRotation(0,0,0,!1)),Soe.fromPredicate($localize(iu||(iu=bg(["Simple move"]))),$localize(au||(au=bg(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new fve([[pve,pve,pve,pve,pve,pve],[pve,gve,pve,pve,yve,pve],[pve,pve,pve,pve,pve,pve],[pve,pve,pve,pve,pve,pve],[pve,yve,pve,pve,gve,pve],[pve,pve,pve,pve,pve,pve]],10),lve.rotationless(2,2),function(e,t){return e.blockTurned.isPresent()?A7.failure($localize(ou||(ou=bg(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):A7.SUCCESS},$localize(su||(su=bg(["Congratulations!"])))),Soe.fromPredicate($localize(uu||(uu=bg(["Move with rotation"]))),$localize(cu||(cu=bg(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new fve([[pve,pve,pve,pve,pve,pve],[pve,gve,pve,pve,yve,pve],[pve,pve,pve,pve,pve,pve],[pve,pve,pve,pve,pve,pve],[pve,yve,pve,pve,gve,pve],[pve,pve,pve,pve,pve,pve]],10),lve.withRotation(0,0,0,!0),function(e,t){return e.blockTurned.isPresent()?A7.SUCCESS:A7.failure($localize(lu||(lu=bg(["You made a move without rotation, try again!"]))))},$localize(hu||(hu=bg(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function kve(e,t){if(1&e){var n=oS();l_(),iS(0),tS(1,"circle",9),cS("click",function(){var e=Dk(n).$implicit,t=fS().$implicit,r=fS().index,i=fS().index;return fS().onClick(3*r+e,3*i+t)}),nS(),aS()}if(2&e){var r=t.$implicit,i=fS().$implicit,a=fS(),o=a.index,s=a.$implicit,u=fS(),c=u.index,l=u.$implicit,h=fS();gb(1),pS("id","click_",3*o+r,"_",3*c+i,""),JE("ngClass",h.getSquareClasses(3*o+r,3*c+i)),qE("cx",s+2*h.STROKE_WIDTH+(r+.5)*h.SPACE_SIZE)("cy",l+2*h.STROKE_WIDTH+(i+.5)*h.SPACE_SIZE)("r",(h.SPACE_SIZE-h.STROKE_WIDTH)/2)}}var _ve=function(){return[0,1,2]};function Cve(e,t){1&e&&(l_(),iS(0),KE(1,kve,2,6,"ng-container",3),aS()),2&e&&(gb(1),JE("ngForOf",oT(1,_ve)))}function wve(e,t){if(1&e&&(l_(),iS(0),rS(1,"rect",8),KE(2,Cve,2,2,"ng-container",3),aS()),2&e){var n=t.$implicit,r=t.index,i=fS(),a=i.index,o=i.$implicit,s=fS();gb(1),JE("ngClass",s.getBlockClasses(r,a)),qE("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),gb(1),JE("ngForOf",oT(8,_ve))}}var bve=function(e){return[0,e]};function Eve(e,t){if(1&e&&(l_(),iS(0),KE(1,wve,3,9,"ng-container",3),aS()),2&e){var n=fS();gb(1),JE("ngForOf",sT(1,bve,n.BLOCK_SEPARATION))}}function Sve(e,t){if(1&e&&(l_(),rS(0,"circle",10)),2&e){var n=fS();pS("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),JE("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),qE("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function Pve(e,t){if(1&e){var n=oS();l_(),tS(0,"path",11),cS("click",function(){var e=Dk(n).$implicit;return fS().rotate(e)}),nS()}if(2&e){var r=t.$implicit,i=fS();pS("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),qE("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function Ove(e,t){if(1&e&&(l_(),rS(0,"circle",12)),2&e){var n=t.$implicit,r=fS();pS("id","victoryCoord_",n.x,"_",n.y,""),JE("ngClass",r.getSquareClasses(n.x,n.y)),qE("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function Tve(e,t){if(1&e){var n=oS();l_(),tS(0,"g",13),cS("click",function(){return Dk(n),fS().skipRotation()}),rS(1,"circle",14),rS(2,"line",15),nS()}if(2&e){var r=fS();gb(1),qE("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),gb(1),qE("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var Ive=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new dve(fve),r.availableMinimaxes=[new vve(r.rules,"PentagoMinimax")],r.encoder=lve.encoder,r.tutorial=(new mve).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new Yae(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new Yae(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?sB.getNonNullable(fve.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:sB.getNonNullable(fve.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new Gae(i%2==0?1:4,i<2?1:4),1),this.lastDrop=fB.of(r)}else this.lastDrop=fB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=fB.empty(),this.movedBlock=fB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=fB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(ioe.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=lve.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=fB.of(new Yae(e,t)),n.displayArrows(s.neutralBlocks),A7.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new Yae(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=lve.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=lve.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-pentago"]],features:[xE],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"defs"),tS(2,"marker",1),rS(3,"polygon",2),nS(),nS(),KE(4,Eve,2,3,"ng-container",3),KE(5,Sve,1,6,"circle",4),KE(6,Pve,1,4,"path",5),KE(7,Ove,1,7,"circle",6),KE(8,Tve,3,9,"g",7),nS()),2&e&&(gb(4),JE("ngForOf",sT(5,bve,t.BLOCK_SEPARATION)),gb(1),JE("ngIf",t.currentDrop.isPresent()),gb(1),JE("ngForOf",t.arrows),gb(1),JE("ngForOf",t.victoryCoords),gb(1),JE("ngIf",t.canSkipRotation))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ave=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;if(jg(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return Fg(a)}return Zg(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new Yae(this.x-1,this.y-1),r=new Yae(this.x,this.y-1),i=new Yae(this.x-1,this.y),a=new Yae(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new Yae(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?fB.empty():fB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?fB.empty():fB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(Yae),Rve=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return Zg(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=fB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=fB.empty(),n=fB.empty();if(e.length>0&&(t=fB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=fB.of(e[1]),e[1].isUpperThan(e[0])&&(t=fB.of(e[1]),n=fB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=fB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(foe);Rve.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=Ave.encode(e.landingCoord),n=Ave.encodeOptional(e.startingCoord),r=Ave.encodeOptional(e.firstCapture);return 270400*Ave.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=Ave.decode(e%64);e-=e%64;var n=Ave.decodeToOptional((e/=64)%65);e-=e%65;var r=Ave.decodeToOptional((e/=65)%65);e-=e%65;var i=Ave.decodeToOptional(e/=65);return new Rve(n,t,r,i)}}]),n}(Nre));var xve=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,r)).boards=e,i}return Zg(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:Lre.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:Lre.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:Lre.NONE}),t=n?this.turn+1:this.turn,this.setBoardAts(r,t)}},{key:"setBoardAts",value:function(e,t){var r,i=[zre.copyBiArray(this.boards[0]),zre.copyBiArray(this.boards[1]),zre.copyBiArray(this.boards[2]),zre.copyBiArray(this.boards[3])],a=Gg(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=Gg(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===Lre.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=Gg(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[Lre.NONE.value]=0,e[Fre.ZERO.value]=0,e[Fre.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new Ave(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removeCoord",value:function(e){return this.setBoardAts([{coord:e,value:Lre.NONE}],this.turn)}},{key:"applyDrop",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAts([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=Gg(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=Gg(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,h=new Ave(l,u,r);this.getPieceAt(h).equals(t)&&!1===this.isSupporting(h)&&e.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([zre.createTable(4,4,Lre.NONE),zre.createTable(3,3,Lre.NONE),zre.createTable(2,2,Lre.NONE),[[Lre.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return sB.expectToBe(e,2),[0,1]}}}]),n}(coe),Mve=function(){var e=Zg(function e(){jg(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(fu||(fu=bg(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(du||(du=bg(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(vu||(vu=bg(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(pu||(pu=bg(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(gu||(gu=bg(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(yu||(yu=bg(["Your second capture is invalid."])))},e}(),Nve=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return O7.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return O7.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:O7.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return O7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===Lre.NONE)return O7.failure(ioe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removeCoord(e.startingCoord.get());return O7.success(a)}return O7.failure(Mve.CANNOT_MOVE_SUPPORTING_PIECE())}return O7.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?O7.success(t.applyDrop(e.landingCoord)):O7.failure(Mve.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return O7.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return O7.failure(Mve.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removeCoord(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?O7.success(void 0):O7.failure(Mve.INVALID_SECOND_CAPTURE())}return O7.failure(Mve.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new Ave(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=Gg(e.freeToMove);try{var i=function(){var r,i=t.value,a=Gg(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=Rve.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=Gg(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Rve.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[Wae.UP,Wae.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[Wae.LEFT,Wae.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var h=a.getOpposite(),f=l.get().getNextValid(h).get();if(e.getPieceAt(f)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new uoe,r=Gg(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new uoe([i]));var a,o=Gg(e.removeCoord(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new uoe([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[Fre.ZERO.value]?_oe.ONE_WON:15===t[Fre.ONE.value]?_oe.ZERO_WON:_oe.ONGOING}}]),n}(Coe),Dve=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Nve.getGameStatus(e);if(t.isEndGame)return new ooe(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new ooe(n[Fre.ZERO.value]-n[Fre.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Nve.getStateInfo(n),a=Nve.getClimbingMoves(i),o=Nve.getDropMoves(i),s=Gg(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new uoe;Nve.canCapture(c,u.landingCoord)?l=Nve.getPossibleCaptures(c):r.push(u);var h,f=Gg(l);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=Rve.changeCapture(u,d.toList());r.push(v)}}catch(p){f.e(p)}finally{f.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(aoe),Lve=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t=Dve.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(Dve),Fve=Lre.NONE,Uve=Lre.ZERO,Vve=Lre.ONE,Bve=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(mu||(mu=bg(["Goal of the game"]))),$localize(ku||(ku=bg(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),xve.getInitialState()),Soe.anyMove($localize(_u||(_u=bg(["Dropping a piece"]))),$localize(Cu||(Cu=bg(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),xve.getInitialState(),Rve.fromDrop(new Ave(1,1,0),[]),$localize(wu||(wu=bg(["There you go, as simple as that."])))),Soe.fromMove($localize(bu||(bu=bg(["Climbing"]))),$localize(Eu||(Eu=bg(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new xve([[[Uve,Vve,Fve,Fve],[Vve,Uve,Fve,Fve],[Fve,Fve,Fve,Fve],[Fve,Fve,Fve,Uve]],[[Fve,Fve,Fve],[Fve,Fve,Fve],[Fve,Fve,Fve]],[[Fve,Fve],[Fve,Fve]],[[Fve]]],0),[Rve.fromClimb(new Ave(3,3,0),new Ave(0,0,1),[])],$localize(Su||(Su=bg(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(Pu||(Pu=bg(["Failed!"])))),Soe.fromMove($localize(Ou||(Ou=bg(["Square (1/2)"]))),$localize(Tu||(Tu=bg(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new xve([[[Uve,Uve,Fve,Fve],[Fve,Uve,Fve,Fve],[Fve,Fve,Fve,Fve],[Fve,Fve,Fve,Fve]],[[Fve,Fve,Fve],[Fve,Fve,Fve],[Fve,Fve,Fve]],[[Fve,Fve],[Fve,Fve]],[[Fve]]],0),[Rve.fromDrop(new Ave(0,1,0),[new Ave(0,0,0)]),Rve.fromDrop(new Ave(0,1,0),[new Ave(0,1,0)]),Rve.fromDrop(new Ave(0,1,0),[new Ave(1,0,0)]),Rve.fromDrop(new Ave(0,1,0),[new Ave(1,1,0)])],$localize(Iu||(Iu=bg(["Congratulations, you have saved up one piece."]))),$localize(Au||(Au=bg(["Failed!"])))),Soe.fromPredicate($localize(Ru||(Ru=bg(["Square (2/2)"]))),$localize(xu||(xu=bg(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new xve([[[Uve,Uve,Fve,Fve],[Fve,Uve,Fve,Fve],[Fve,Fve,Fve,Fve],[Fve,Fve,Fve,Fve]],[[Fve,Fve,Fve],[Fve,Fve,Fve],[Fve,Fve,Fve]],[[Fve,Fve],[Fve,Fve]],[[Fve]]],0),Rve.fromDrop(new Ave(0,1,0),[new Ave(0,0,0),new Ave(1,0,0)]),function(e,t){return e.secondCapture.isPresent()?A7.SUCCESS:e.firstCapture.isPresent()?A7.failure($localize(Mu||(Mu=bg(["Failed, you only captured one piece."])))):A7.failure(cde.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(Nu||(Nu=bg(["Congratulations, you have saved up two pieces."]))))]});function zve(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"circle",4),nS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS();gb(1),pS("id","piece_",r,"_",n,""),JE("ngClass",i.getPlayerPieceClass(r)),qE("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Hve(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,zve,2,6,"g",1),nS()),2&e){var n=t.$implicit,r=fS();gb(1),JE("ngForOf",r.getPlayerSidePieces(n))}}function Gve(e,t){if(1&e){var n=oS();l_(),tS(0,"circle",8),cS("click",function(){Dk(n);var e=fS(2).$implicit,t=fS().$implicit,r=fS().$implicit;return fS().onPieceClick(e,t,r)}),nS()}if(2&e){var r=fS(2).$implicit,i=fS().$implicit,a=fS().$implicit,o=fS();gS("id","piece_",r,"_",i,"_",a,""),JE("ngClass",o.getPieceClasses(r,i,a)),qE("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function $ve(e,t){if(1&e){var n=oS();l_(),tS(0,"rect",8),cS("click",function(){Dk(n);var e=fS(2).$implicit,t=fS().$implicit,r=fS().$implicit;return fS().onDrop(e,t,r)}),nS()}if(2&e){var r=fS(2).$implicit,i=fS().$implicit,a=fS().$implicit,o=fS();gS("id","drop_",r,"_",i,"_",a,""),JE("ngClass",o.getSquareClasses(r,i,a)),qE("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function qve(e,t){if(1&e&&(l_(),iS(0),KE(1,Gve,1,7,"circle",6),KE(2,$ve,1,8,"ng-template",null,7,MT),aS()),2&e){var n=QE(3),r=fS().$implicit,i=fS().$implicit,a=fS().$implicit,o=fS();gb(1),JE("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function jve(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,qve,4,2,"ng-container",5),nS()),2&e){var n=t.$implicit,r=fS().$implicit,i=fS().$implicit,a=fS();gb(1),JE("ngIf",a.mustDraw(n,r,i))}}function Wve(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,jve,2,1,"g",1),nS()),2&e){var n=fS().$implicit,r=fS();gb(1),JE("ngForOf",r.getLevelRange(n))}}function Zve(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Wve,2,1,"g",1),nS()),2&e){var n=t.$implicit,r=fS();gb(1),JE("ngForOf",r.getLevelRange(n))}}function Yve(e,t){if(1&e&&(l_(),rS(0,"rect",9)),2&e){var n=fS();gS("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),qE("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var Kve=function(){return[0,1]},Qve=function(){return[0,1,2]},Xve=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).lastLandingCoord=fB.empty(),r.lastStartingCoord=fB.empty(),r.lastFirstCapture=fB.empty(),r.lastSecondCapture=fB.empty(),r.highCapture=fB.empty(),r.chosenStartingCoord=fB.empty(),r.chosenLandingCoord=fB.empty(),r.chosenFirstCapture=fB.empty(),r.lastMove=fB.empty(),r.remainingPieces={0:15,1:15},r.rules=new Nve(xve),r.availableMinimaxes=[new Dve(r.rules,"PylosMinimax"),new Lve(r.rules,"PylosOrderedMinimax")],r.encoder=Rve.encoder,r.tutorial=(new Bve).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return Zg(n,[{key:"getLevelRange",value:function(e){return xve.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new Ave(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Ave(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(Mve.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=fB.of(e),t.constructedState=t.constructedState.removeCoord(e),A7.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=fB.of(e),t.constructedState=t.constructedState.removeCoord(e),A7.SUCCESS):t.chosenFirstCapture.equalsValue(e)?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?Rve.fromDrop(t.chosenLandingCoord.get(),e):Rve.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=fB.empty(),this.chosenLandingCoord=fB.empty(),this.chosenFirstCapture=fB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Ave(e,t,n),i.abrupt("return",Nve.canCapture(r.constructedState,o)?(r.chosenLandingCoord=fB.of(o),r.constructedState=r.constructedState.applyDrop(o),A7.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=fB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Mve.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new Ave(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}else if(this.justClimbed(r))return["moved"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new Ave(e,t,n);if(this.justClimbed(r))return!1;var i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new Ave(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(Fre.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=fB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=fB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=fB.empty(),this.lastLandingCoord=fB.empty(),this.lastFirstCapture=fB.empty(),this.lastSecondCapture=fB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(Kae);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-pylos"]],features:[xE],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Hve,2,1,"g",1),rS(2,"rect",2),KE(3,Zve,2,1,"g",1),KE(4,Yve,1,7,"rect",3),nS()),2&e&&(gb(1),JE("ngForOf",oT(3,Kve)),gb(2),JE("ngForOf",oT(4,Qve)),gb(1),JE("ngIf",t.highCapture.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Jve=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();Jve.AAAA=new Jve(0),Jve.AAAB=new Jve(1),Jve.AABA=new Jve(2),Jve.AABB=new Jve(3),Jve.ABAA=new Jve(4),Jve.ABAB=new Jve(5),Jve.ABBA=new Jve(6),Jve.ABBB=new Jve(7),Jve.BAAA=new Jve(8),Jve.BAAB=new Jve(9),Jve.BABA=new Jve(10),Jve.BABB=new Jve(11),Jve.BBAA=new Jve(12),Jve.BBAB=new Jve(13),Jve.BBBA=new Jve(14),Jve.BBBB=new Jve(15),Jve.EMPTY=new Jve(16),Jve.pieces=[Jve.AAAA,Jve.AAAB,Jve.AABA,Jve.AABB,Jve.ABAA,Jve.ABAB,Jve.ABBA,Jve.ABBB,Jve.BAAA,Jve.BAAB,Jve.BABA,Jve.BABB,Jve.BBAA,Jve.BBAB,Jve.BBBA,Jve.BBBB];var epe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).piece=i,a}return Zg(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(doe);epe.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new epe(e/=4,n,Jve.fromInt(t))}}]),n}(Nre));var tpe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return Zg(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=Gg(Jve.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(zre.createTable(4,4,Jve.EMPTY),0,Jve.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(loe),npe=function(){var e=Zg(function e(){jg(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Du||(Du=bg(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Lu||(Lu=bg(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(Fu||(Fu=bg(["You cannot give the piece that was in your hands."])))},e}(),rpe=function(){function e(t){jg(this,e),this.subCriterion=[fB.empty(),fB.empty(),fB.empty(),fB.empty()],this.subCriterion[0]=fB.of(8==(8&t.value)),this.subCriterion[1]=fB.of(4==(4&t.value)),this.subCriterion[2]=fB.of(2==(2&t.value)),this.subCriterion[3]=fB.of(1==(1&t.value))}return Zg(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=fB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),ipe=function(){function e(t,n){jg(this,e),this.initialCoord=t,this.direction=n}return Zg(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),ape=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new tpe(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:poe.DEFAULT,sensitiveSquares:new Rse},a=Gg(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===poe.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=Gg(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Jve.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?A7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE()):a===Jve.EMPTY?15===t.turn?A7.SUCCESS:A7.failure(npe.MUST_GIVE_A_PIECE()):tpe.isAlreadyOnBoard(a,o)?A7.failure(npe.PIECE_ALREADY_ON_BOARD()):s===a?A7.failure(npe.CANNOT_GIVE_PIECE_IN_HAND()):A7.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===poe.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:poe.VICTORY,sensitiveSquares:new Rse}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new rpe(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:poe.VICTORY,sensitiveSquares:new Rse};a.get().matchPiece(t.pieceInHand)&&(r.score=poe.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=fB.empty(),a=fB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Jve.EMPTY){if(!i.isAbsent())return{sensitiveCoord:fB.of(o),commonCriterion:a,boardStatus:fB.of(r)};i=fB.of(o)}else a.isAbsent()?(a=fB.of(new rpe(u)),uB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),uB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:fB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=Fre.of(t%2);return e===poe.VICTORY?_oe.getDefeat(n):16===t?_oe.DRAW:_oe.ONGOING}}]),n}(Coe);ape.VERBOSE=!1,ape.lines=[new ipe(new Yae(0,0),jae.DOWN),new ipe(new Yae(1,0),jae.DOWN),new ipe(new Yae(2,0),jae.DOWN),new ipe(new Yae(3,0),jae.DOWN),new ipe(new Yae(0,0),jae.RIGHT),new ipe(new Yae(0,1),jae.RIGHT),new ipe(new Yae(0,2),jae.RIGHT),new ipe(new Yae(0,3),jae.RIGHT),new ipe(new Yae(0,0),jae.DOWN_RIGHT),new ipe(new Yae(0,3),jae.UP_RIGHT)];var ope=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Jve.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new epe(s,o,Jve.EMPTY);return t.push(u),t}var c,l=Gg(i);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=new epe(s,o,h);t.push(f)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:poe.DEFAULT,sensitiveSquares:new Rse},a=Gg(ape.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=ape.updateBoardStatus(o,r,i)).score===poe.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===poe.DEFAULT)return new ooe(0);var n=Fre.of(t%2);return new ooe(e===poe.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(aoe),spe=Jve.AABA,upe=Jve.AABB,cpe=Jve.ABAA,lpe=Jve.ABAB,hpe=Jve.ABBA,fpe=Jve.BAAA,dpe=Jve.BAAB,vpe=Jve.BABB,ppe=Jve.BBAA,gpe=Jve.BBAB,ype=Jve.BBBA,mpe=Jve.BBBB,kpe=Jve.EMPTY,_pe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Uu||(Uu=bg(["Goal of the game"]))),$localize(Vu||(Vu=bg(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new tpe([[ype,ppe,cpe,spe],[kpe,kpe,kpe,kpe],[kpe,kpe,kpe,kpe],[kpe,kpe,kpe,kpe]],7,Jve.ABAB)),Soe.anyMove($localize(Bu||(Bu=bg(["Placement"]))),$localize(zu||(zu=bg(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new tpe([[ype,upe,hpe,kpe],[kpe,kpe,kpe,kpe],[kpe,fpe,kpe,kpe],[kpe,kpe,kpe,kpe]],7,Jve.ABAA),new epe(2,2,Jve.BAAB),$localize(Hu||(Hu=bg(["Perfect!"])))),Soe.fromMove($localize(Gu||(Gu=bg(["Situation"]))),$localize($u||($u=bg(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new tpe([[mpe,ype,gpe,kpe],[cpe,vpe,ppe,kpe],[lpe,fpe,dpe,kpe],[kpe,kpe,kpe,kpe]],7,Jve.AABA),[new epe(3,3,Jve.AABB)],$localize(qu||(qu=bg(["Well done!"]))),$localize(ju||(ju=bg(["Failed!"]))))]});function Cpe(e,t){if(1&e&&(l_(),rS(0,"rect",11)),2&e){var n=fS(2),r=n.$implicit,i=n.index,a=fS().index,o=fS();JE("ngClass",o.getPieceClasses(r.value)),qE("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function wpe(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=fS(2),r=n.$implicit,i=n.index,a=fS().index,o=fS();JE("ngClass",o.getPieceClasses(r.value)),qE("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function bpe(e,t){if(1&e&&(l_(),rS(0,"circle")),2&e){var n=fS(2).index,r=fS().index,i=fS();qE("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Epe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Cpe,1,5,"rect",9),KE(2,wpe,1,4,"ng-template",null,10,MT),KE(4,bpe,1,3,"circle",3),nS()),2&e){var n=QE(3),r=fS().$implicit,i=fS(2);gb(1),JE("ngIf",r.isRectangle())("ngIfElse",n),gb(3),JE("ngIf",i.pieceHasDot(r.value))}}function Spe(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",8),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().chooseCoord(e,t)}),nS(),KE(2,Epe,5,3,"g",3),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","chooseCoord_",i,"_",a,""),JE("ngClass",o.getSquareClasses(i,a)),qE("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r!==o.EMPTY)}}function Ppe(e,t){if(1&e&&(l_(),tS(0,"g",null,7),KE(2,Spe,3,8,"g",2),nS()),2&e){var n=t.$implicit;gb(2),JE("ngForOf",n)}}function Ope(e,t){if(1&e&&(l_(),rS(0,"rect",15)),2&e){var n=fS(2);JE("ngClass",n.getPieceClasses(n.pieceInHand.value)),qE("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Tpe(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=fS(2);JE("ngClass",n.getPieceClasses(n.pieceInHand.value)),qE("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function Ipe(e,t){if(1&e&&(l_(),rS(0,"circle")),2&e){var n=fS(2);qE("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function Ape(e,t){if(1&e&&(l_(),tS(0,"g",null,12),rS(2,"rect",13),KE(3,Ope,1,5,"rect",14),KE(4,Tpe,1,4,"ng-template",null,10,MT),KE(6,Ipe,1,3,"circle",3),nS()),2&e){var n=QE(5),r=fS();qE("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),gb(2),qE("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),gb(1),JE("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),gb(3),JE("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Rpe(e,t){if(1&e&&(l_(),tS(0,"g",null,16),rS(2,"rect",17),nS()),2&e){var n=t.$implicit,r=fS();gb(2),qE("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function xpe(e,t){if(1&e&&(l_(),rS(0,"rect",11)),2&e){var n=fS(2);JE("ngClass",n.getPieceClasses(n.pieceInHand.value)),qE("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Mpe(e,t){if(1&e&&(l_(),rS(0,"circle",19)),2&e){var n=fS(2);JE("ngClass",n.getPieceClasses(n.pieceInHand.value)),qE("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Npe(e,t){1&e&&(l_(),rS(0,"circle",20)),2&e&&qE("cy",.75*fS(2).SPACE_SIZE)("r",10)}function Dpe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,xpe,1,6,"rect",9),KE(2,Mpe,1,3,"ng-template",null,10,MT),KE(4,Npe,1,2,"circle",18),nS()),2&e){var n=QE(3),r=fS();gb(1),JE("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),gb(3),JE("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Lpe(e,t){if(1&e&&(l_(),rS(0,"rect",27)),2&e){var n=fS(2).index,r=fS().index,i=fS();qE("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Fpe(e,t){if(1&e&&(l_(),rS(0,"rect",11)),2&e){var n=fS(2).index,r=fS().index,i=fS();JE("ngClass",i.getPieceClasses(4*r+n)),qE("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Upe(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=fS(2).index,r=fS().index,i=fS();JE("ngClass",i.getPieceClasses(4*r+n)),qE("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Vpe(e,t){if(1&e&&(l_(),rS(0,"circle")),2&e){var n=fS(2).index,r=fS().index,i=fS();qE("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Bpe(e,t){if(1&e){var n=oS();l_(),tS(0,"g",25),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().choosePiece(4*t+e)}),KE(1,Lpe,1,4,"rect",26),KE(2,Fpe,1,5,"rect",9),KE(3,Upe,1,4,"ng-template",null,10,MT),KE(5,Vpe,1,3,"circle",3),nS()}if(2&e){var r=QE(4),i=fS().index,a=fS().index,o=fS();vS("id","choosePiece_",4*a+i,""),gb(1),JE("ngIf",o.pieceToGive.value===4*a+i),gb(1),JE("ngIf",(4*a+i)%4<2)("ngIfElse",r),gb(3),JE("ngIf",o.pieceHasDot(4*a+i))}}function zpe(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Bpe,6,5,"g",24),nS()),2&e){var n=t.index,r=fS().index,i=fS();gb(1),JE("ngIf",i.isRemaining(4*r+n))}}function Hpe(e,t){if(1&e&&(l_(),tS(0,"g",null,21),rS(2,"rect",22,23),KE(4,zpe,2,1,"g",2),nS()),2&e){var n=t.$implicit,r=fS();qE("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),gb(2),qE("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),gb(2),JE("ngForOf",n)}}var Gpe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).EMPTY=Jve.EMPTY,r.chosen=fB.empty(),r.lastMove=fB.empty(),r.pieceInHand=Jve.EMPTY,r.pieceToGive=Jve.EMPTY,r.victoriousCoords=[],r.rules=new ape(tpe),r.availableMinimaxes=[new ope(r.rules,"QuartoMinimax")],r.encoder=epe.encoder,r.tutorial=(new _pe).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=fB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Jve.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new epe(e,t,Jve.EMPTY),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(n.pieceToGive!==Jve.EMPTY){r.next=9;break}return r.abrupt("return",A7.SUCCESS);case 9:return o=new epe(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(ioe.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=Jve.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",A7.SUCCESS);case 5:return i=t.chosen.get(),a=new epe(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=fB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=Jve.EMPTY}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=fB.of(new Yae(e,t))}},{key:"isRemaining",value:function(e){return tpe.isGivable(Jve.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new Yae(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Jve.EMPTY.value&&e%8<4}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-quarto"]],features:[xE],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"g",1),KE(2,Ppe,3,1,"g",2),KE(3,Ape,7,6,"g",3),KE(4,Rpe,3,3,"g",2),tS(5,"g",null,4),rS(7,"rect",5,6),KE(9,Dpe,5,3,"g",3),nS(),KE(10,Hpe,5,6,"g",2),nS(),nS()),2&e&&(qE("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),gb(2),JE("ngForOf",t.board),gb(1),JE("ngIf",t.chosen.isPresent()),gb(1),JE("ngForOf",t.victoriousCoords),gb(1),qE("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),gb(2),qE("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),gb(2),JE("ngIf",t.chosen.isAbsent()),gb(1),JE("ngForOf",t.board))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),$pe=function(){var e=Zg(function e(){jg(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(Wu||(Wu=bg(["You must pick a space from the edge of the board."])))},e}(),qpe=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;jg(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===Wae.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===Wae.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===Wae.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===Wae.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return Zg(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?A7.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?A7.failure($pe.NO_INSIDE_CLICK()):A7.SUCCESS}}]),n}(doe);qpe.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=Wae.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new qpe(e/=5,n,t)}}]),n}(Nre));var jpe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(zre.createTable(5,5,Lre.NONE),0)}}]),n}(loe),Wpe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?O7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[Fre.ZERO.value]),a=n.getFullestLine(r[Fre.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===Fre.ZERO||a<5)?_oe.ZERO_WON:5===a?_oe.ONE_WON:_oe.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new Yae(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new Yae(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new Yae(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new Yae(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(Wae.LEFT),0!==e.y&&t.push(Wae.UP),4!==e.x&&t.push(Wae.RIGHT),4!==e.y&&t.push(Wae.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[Fre.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[Fre.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new Yae(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new Yae(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new Yae(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new Yae(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,zg(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(Coe),Zpe=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Wpe.getVerticalCoords(e),i=Gg(Wpe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Gg(Wpe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new qpe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Wpe.getLinesSums(t),r=Wpe.getFullestLine(n[Fre.ZERO.value]),i=Wpe.getFullestLine(n[Fre.ONE.value]),a=t.getCurrentPlayer();return new ooe(5===r&&(a===Fre.ZERO||i<5)?Fre.ZERO.getVictoryValue():5===i?Fre.ONE.getVictoryValue():i-r)}}]),n}(aoe),Ype=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case Wae.UP:r=0,i=-1,a=-90;break;case Wae.DOWN:r=0,i=1,a=90;break;case Wae.LEFT:r=-1,i=0,a=180;break;default:sB.expectToBe(n,Wae.RIGHT),r=1,i=0,a=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(a,")")].join(" ")}}]),e}(),Kpe=Lre.NONE,Qpe=Lre.ZERO,Xpe=Lre.ONE,Jpe=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Zu||(Zu=bg(["Goal of the game."]))),$localize(Yu||(Yu=bg(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),jpe.getInitialState()),Soe.fromMove($localize(Ku||(Ku=bg(["What a move looks like (without animation)"]))),$localize(Qu||(Qu=bg(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new jpe([[Kpe,Kpe,Kpe,Kpe,Kpe],[Kpe,Kpe,Kpe,Kpe,Kpe],[Kpe,Kpe,Kpe,Kpe,Kpe],[Kpe,Kpe,Kpe,Kpe,Kpe],[Qpe,Qpe,Qpe,Qpe,Kpe]],1),[new qpe(4,4,Wae.LEFT)],$localize(Xu||(Xu=bg(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(Ju||(Ju=bg(["Failed!"])))),Soe.fromMove($localize(ec||(ec=bg(["Victory"]))),$localize(tc||(tc=bg(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new jpe([[Kpe,Xpe,Kpe,Xpe,Xpe],[Kpe,Qpe,Qpe,Kpe,Qpe],[Xpe,Xpe,Xpe,Qpe,Xpe],[Qpe,Kpe,Qpe,Xpe,Xpe],[Xpe,Qpe,Kpe,Xpe,Qpe]],31),[new qpe(3,0,Wae.DOWN)],$localize(nc||(nc=bg(["Congratulations, you won!"]))),$localize(rc||(rc=bg(["Failed!"]))))]});function ege(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"circle",4),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onBoardClick(e,t)}),nS(),nS()}if(2&e){var r=t.index,i=fS().index,a=fS();gb(1),pS("id","click_",r,"_",i,""),JE("ngClass",a.getPieceClasses(r,i)),qE("cx",50+100*r)("cy",50+100*i)}}function tge(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,ege,2,5,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function nge(e,t){if(1&e){var n=oS();l_(),tS(0,"use",6),cS("click",function(){var e=Dk(n).$implicit;return fS(2).chooseDirection(e)}),nS()}if(2&e){var r=t.$implicit,i=fS(2);vS("id","chooseDirection_",r,""),qE("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function rge(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,nge,1,2,"use",5),nS()),2&e){var n=fS();gb(1),JE("ngForOf",n.getPossiblesDirections())}}var ige=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).lastMoveCoord=fB.empty(),r.chosenCoord=fB.empty(),r.victoriousCoords=[],r.rules=new Wpe(jpe),r.availableMinimaxes=[new Zpe(r.rules,"QuixoMinimax")],r.encoder=qpe.encoder,r.tutorial=(new Jpe).tutorial,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Wpe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new Yae(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new Yae(e,t),i=qpe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=fB.of(r),A7.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=Wae.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new qpe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return Ype.getArrowTransform(this.SPACE_SIZE,e,Wae.factory.fromString(t).get())}}]),n}(ose);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-quixo"]],features:[xE],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"defs"),rS(2,"polygon",1),nS(),KE(3,tge,2,1,"g",2),KE(4,rge,2,1,"g",3),nS()),2&e&&(gb(3),JE("ngForOf",t.board),gb(1),JE("ngIf",t.chosenCoord.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),age=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=zre.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,Lre.NONE);return e[3][3]=Fre.ZERO,e[4][4]=Fre.ZERO,e[3][4]=Fre.ONE,e[4][3]=Fre.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new Yae(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(loe);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),oge=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(doe);oge.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return(age.BOARD_HEIGHT-1)*age.BOARD_WIDTH+(age.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*age.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%age.BOARD_WIDTH;return new oge(t,(e-t)/age.BOARD_WIDTH)}}]),n}(Nre)),oge.PASS=new oge(-1,-1),oge.PASS_NUMBER=oge.encoder.encodeNumber(oge.PASS);var sge=function(){var e=Zg(function e(){jg(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(ic||(ic=bg(["Your move should switch at least one piece."])))},e}(),uge=Zg(function e(t,n){jg(this,e),this.move=t,this.switched=n}),cge=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(oge.PASS))return new age(a,r+1);var o,s=Gg(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new age(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(oge.PASS))return n.playerCanOnlyPass(t)?O7.success([]):O7.failure(ioe.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return uB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),O7.failure(ioe.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return uB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?O7.failure(sge.NO_ELEMENT_SWITCHED()):O7.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return _oe.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?_oe.ZERO_WON:i>0?_oe.ONE_WON:_oe.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=Gg(jae.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(age.BOARD_WIDTH,age.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,h=Gg(n.getSandwicheds(t,u,c,r));try{for(h.s();!(l=h.n()).done;){var f=l.value;a.push(f)}}catch(d){h.e(d)}finally{h.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(age.BOARD_WIDTH,age.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===Lre.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(oge.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new age(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===Lre.NONE&&(t=e.getCopiedBoard(),age.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new oge(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,h=Gg(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;D7(i!==e.getPieceAt(f),f+"was already switched!"),t[f.y][f.x]=i}}catch(d){h.e(d)}finally{h.f()}t[o][s]=i,r.push(new uge(u,c.length))}}return 0===r.length&&r.push(new uge(oge.PASS,0)),r}}]),n}(Coe);return e.VERBOSE=!1,e}(),lge=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=cge.getGameStatus(e);if(t.isEndGame)return ooe.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<age.BOARD_HEIGHT;a++)for(var o=0;o<age.BOARD_WIDTH;o++){var s=(0===o||o===age.BOARD_WIDTH-1?4:1)*(0===a||a===age.BOARD_HEIGHT-1?4:1);n[a][o]===Fre.ZERO&&(r+=s),n[a][o]===Fre.ONE&&(i+=s)}return r*=Fre.ZERO.getScoreModifier(),i*=Fre.ONE.getScoreModifier(),new ooe(i+r)}},{key:"getListMoves",value:function(e){var t=cge.getListMoves(e.gameState);return zre.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(aoe);lge.bestCoords=[new Yae(0,0),new Yae(0,age.BOARD_HEIGHT-1),new Yae(age.BOARD_WIDTH-1,0),new Yae(age.BOARD_WIDTH-1,age.BOARD_HEIGHT-1)];var hge=Lre.NONE,fge=Lre.ZERO,dge=Lre.ONE,vge=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(ac||(ac=bg(["Goal of the game"]))),$localize(oc||(oc=bg(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new age([[fge,fge,fge,fge,fge,fge,fge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,fge,fge,fge,fge,fge,fge,fge]],60)),Soe.anyMove($localize(sc||(sc=bg(["Capture (1/2)"]))),$localize(uc||(uc=bg(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),age.getInitialState(),new oge(2,4),$localize(cc||(cc=bg(["Congratulations!"])))),Soe.fromMove($localize(lc||(lc=bg(["Capture (2/2)"]))),$localize(hc||(hc=bg(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new age([[hge,hge,hge,hge,hge,hge,hge,hge],[hge,hge,hge,hge,hge,hge,hge,hge],[hge,hge,hge,hge,hge,hge,hge,hge],[hge,hge,hge,hge,dge,hge,hge,hge],[hge,hge,hge,fge,hge,hge,hge,hge],[hge,hge,fge,hge,hge,hge,hge,hge],[fge,fge,hge,hge,hge,hge,hge,hge],[hge,fge,dge,fge,dge,fge,hge,hge]],1),[new oge(0,7)],$localize(fc||(fc=bg(["Congratulations!"]))),$localize(dc||(dc=bg(["Lower and more to the left, please."])))),Soe.informational($localize(vc||(vc=bg(["Passing a turn"]))),$localize(pc||(pc=bg(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new age([[dge,fge,fge,fge,fge,fge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[fge,dge,dge,dge,dge,dge,dge,fge],[dge,dge,dge,dge,dge,dge,hge,hge],[fge,fge,fge,fge,fge,fge,hge,hge]],60))]});function pge(e,t){if(1&e&&(l_(),rS(0,"circle",4)),2&e){var n=fS().index,r=fS().index,i=fS();JE("ngClass",i.getPieceClass(n,r)),qE("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function gge(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",2),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),nS(),KE(2,pge,1,4,"circle",3),nS()}if(2&e){var r=t.index,i=fS().index,a=fS();gb(1),pS("id","click_",r,"_",i,""),JE("ngClass",a.getRectClasses(r,i)),qE("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),gb(1),JE("ngIf",a.board[i][r]!==a.EMPTY)}}function yge(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,gge,3,8,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}var mge=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).EMPTY=Lre.NONE,r.lastMove=new Yae(-2,-2),r.captureds=[],r.scores=fB.of([2,2]),r.rules=new cge(age),r.availableMinimaxes=[new lge(r.rules,"ReversiMinimax")],r.encoder=oge.encoder,r.tutorial=(new vge).tutorial,r.canPass=!1,r.updateBoard(),r}return Zg(n,[{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new oge(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new Yae(-2,-2),this.scores=fB.of(e.countScore()),this.canPass=cge.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=Gg(jae.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(age.BOARD_WIDTH,age.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new Yae(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(D7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(oge.PASS.coord.x,oge.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-reversi"]],features:[xE],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,yge,2,1,"g",1),nS()),2&e&&(qE("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),gb(1),JE("ngForOf",t.board))},directives:[FA,DA,VA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),kge=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,null,[{key:"getInitialState",value:function(){var e=Xae.UNREACHABLE,t=Xae.ZERO,r=Xae.ONE,i=Xae.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(rue);return e.HEIGHT=6,e.WIDTH=11,e}(),_ge=function(){var e=Zg(function e(){jg(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(gc||(gc=bg(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(yc||(yc=bg(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(mc||(mc=bg(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(kc||(kc=bg(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(_c||(_c=bg(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Cc||(Cc=bg(["Those two spaces have no intermediary neighbor."])))},e}(),Cge=function(e){Ng(n,e);var t=Lg(n);function n(e,r){return jg(this,n),t.call(this,e,r)}return Zg(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return A7.failure(ioe.MOVE_CANNOT_BE_STATIC());if(1===n){var r=nue.getFakeNeighbors(e);if(t.equals(r))return A7.failure(_ge.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return A7.failure($localize(wc||(wc=bg(["You can move one or two spaces, not ","."])),n));if((e.x+e.y)%2==0)return A7.failure(_ge.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return A7.failure(_ge.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return A7.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(kge.WIDTH,kge.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(kge.WIDTH,kge.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():O7.success(new n(e,t))}}]),n}(gse);Cge.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 396*kge.WIDTH+66*kge.HEIGHT+6*kge.WIDTH+kge.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,Cge.from(new Yae(e/=6,r),new Yae(n,t)).get()}}]),n}(Nre));var wge=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,r){uB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=Xae.EMPTY,new kge(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return O7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==Xae.EMPTY)return O7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE());var n=nue.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===Xae.EMPTY?O7.success(void 0):O7.failure(_ge.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):O7.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,Fre.ZERO),i=n.getBoardValuesFor(t,Fre.ONE);return n.getGameStatusFromFreedoms(r,i)}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<kge.HEIGHT;r++)for(var i=0;i<kge.WIDTH;i++)e[r][i].is(t)&&n.push(new Yae(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=Gg(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=rue.getEmptyNeighbors(e,o,Xae.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?_oe.ONE_WON:0===t[0]?_oe.ZERO_WON:_oe.ONGOING}}]),n}(Coe);return e.VERBOSE=!1,e}(),bge=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=Gg(wge.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=Gg(rue.getEmptyNeighbors(r,s,Xae.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Cge.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=Xae.EMPTY,n.push(l),(c.y+c.x)%2==0){var h,f=Gg(rue.getEmptyNeighbors(r,c,Xae.EMPTY));try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!d.equals(s)){var v=Cge.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=Xae.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=Xae.EMPTY}}}catch(p){f.e(p)}finally{f.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=Xae.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=wge.getBoardValuesFor(t,Fre.ZERO),r=wge.getBoardValuesFor(t,Fre.ONE),i=wge.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return ooe.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new ooe(r[a%6]-n[a%6])}}]),n}(aoe),Ege=Xae.UNREACHABLE,Sge=Xae.ZERO,Pge=Xae.ONE,Oge=Xae.EMPTY,Tge=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(bc||(bc=bg(["Initial board"]))),$localize(Ec||(Ec=bg(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),kge.getInitialState()),Soe.informational($localize(Sc||(Sc=bg(["Goal of the game"]))),$localize(Pc||(Pc=bg(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new kge([[Ege,Ege,Oge,Oge,Pge,Oge,Oge,Sge,Pge,Ege,Ege],[Ege,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Ege],[Pge,Sge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Sge],[Sge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Pge],[Ege,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Oge,Ege],[Ege,Ege,Pge,Sge,Oge,Oge,Oge,Pge,Sge,Ege,Ege]],3)),Soe.fromPredicate($localize(Oc||(Oc=bg(["Simple step"]))),$localize(Tc||(Tc=bg(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),kge.getInitialState(),Cge.from(new Yae(2,0),new Yae(2,1)).get(),function(e,t){return e.isSimpleStep()?A7.SUCCESS:A7.failure($localize(Ic||(Ic=bg(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Ac||(Ac=bg(["Congratulations!"])))),Soe.fromPredicate($localize(Rc||(Rc=bg(["Double step"]))),$localize(xc||(xc=bg(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),kge.getInitialState(),Cge.from(new Yae(7,0),new Yae(5,0)).get(),function(e,t){return e.isSimpleStep()?A7.failure($localize(Mc||(Mc=bg(["Failed! You have made a single step."])))):A7.SUCCESS},$localize(Nc||(Nc=bg(["Congratulations!"]))))]});function Ige(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"polyline",6),nS()),2&e){var n=fS().index,r=fS().index,i=fS();gb(1),JE("ngClass",i.getPlayerClassFor(n,r)),qE("points",i.getPyramidCoordinate(n,r))}}function Age(e,t){if(1&e&&(l_(),rS(0,"polyline",9)),2&e){var n=fS(2).index,r=fS().index;qE("points",fS().getTriangleCoordinate(n,r))}}function Rge(e,t){if(1&e&&(l_(),rS(0,"polyline",10)),2&e){var n=fS(2).index,r=fS().index;qE("points",fS().getTriangleCoordinate(n,r))}}function xge(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Age,1,1,"polyline",7),KE(2,Rge,1,1,"polyline",8),nS()),2&e){var n=fS().index,r=fS().index;gb(1),JE("ngIf",(n+r)%2==1),gb(1),JE("ngIf",(n+r)%2==0)}}function Mge(e,t){if(1&e){var n=oS();l_(),tS(0,"g",5),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),KE(1,Ige,2,2,"g",2),KE(2,xge,3,2,"g",2),nS()}if(2&e){var r=t.$implicit;pS("id","click_",t.index,"_",fS().index,""),gb(1),JE("ngIf",r.isPlayer()),gb(1),JE("ngIf",2===r.value)}}function Nge(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Mge,3,4,"g",4),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Dge(e,t){if(1&e&&(l_(),iS(0),rS(1,"polyline",11),rS(2,"polyline",11),aS()),2&e){var n=fS();gb(1),qE("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),gb(1),qE("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Lge(e,t){if(1&e&&(l_(),rS(0,"polyline",12)),2&e){var n=fS();qE("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}var Fge=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).lastCoord=fB.empty(),r.lastMoved=fB.empty(),r.chosenCoord=fB.empty(),r.rules=new wge(kge),r.availableMinimaxes=[new bge(r.rules,"SaharaMinimax")],r.encoder=Cge.encoder,r.tutorial=(new Tge).tutorial,r.updateBoard(),r}return Zg(n,[{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty()}},{key:"onClick",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return this.board[t][e]===Xae.EMPTY?this.cancelMove(_ge.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=fB.of(new Yae(e,t)),A7.SUCCESS):this.cancelMove(_ge.MUST_CHOOSE_OWN_PYRAMID())}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Yae(e,t),a=n.rules.node.gameState.getCurrentPlayer(),o=Xae.ofPlayer(a),n.board[t][e]!==o){r.next=3;break}return r.abrupt("return",(n.chosenCoord=fB.of(new Yae(e,t)),A7.SUCCESS));case 3:if(!(s=Cge.from(n.chosenCoord.get(),i)).isFailure()){r.next=8;break}r.t0=n.cancelMove(s.getReason()),r.next=11;break;case 8:return r.next=10,n.chooseMove(s.get(),n.rules.node.gameState);case 10:r.t0=r.sent;case 11:return r.abrupt("return",r.t0);case 12:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.chosenCoord=fB.empty();var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(Fre.of(this.board[t][e].value))}}]),n}(Xse);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-sahara"]],features:[xE],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Nge,2,1,"g",1),KE(2,Dge,3,2,"ng-container",2),KE(3,Lge,1,1,"polyline",3),nS()),2&e&&(gb(1),JE("ngForOf",t.board),gb(1),JE("ngIf",t.lastMoved.isPresent()),gb(1),JE("ngIf",t.chosenCoord.isPresent()))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Uge=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return Zg(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(doe);Uge.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?fB.empty():Wae.factory.fromInt(r).toOptional();e-=r;var a=Wae.factory.fromInt(e/=5).get();return new Uge(n-1,t-1,i,a)}}]),n}(Nre));var Vge=function(){function e(t){jg(this,e),this.value=t}return Zg(e,[{key:"belongTo",value:function(e){return e===Fre.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?Fre.ZERO:5<=this.value&&this.value<=8?Fre.ONE:Lre.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return fB.empty();case 1:case 5:return fB.of(Wae.UP);case 2:case 6:return fB.of(Wae.RIGHT);case 3:case 7:return fB.of(Wae.DOWN);case 4:case 8:return fB.of(Wae.LEFT);default:return sB.expectToBe(this.value,9),fB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return sB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===Fre.ZERO?t===Wae.UP?e.LIGHT_UP:t===Wae.RIGHT?e.LIGHT_RIGHT:t===Wae.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===Wae.UP?e.DARK_UP:t===Wae.RIGHT?e.DARK_RIGHT:t===Wae.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();Vge.EMPTY=new Vge(0),Vge.LIGHT_UP=new Vge(1),Vge.LIGHT_RIGHT=new Vge(2),Vge.LIGHT_DOWN=new Vge(3),Vge.LIGHT_LEFT=new Vge(4),Vge.DARK_UP=new Vge(5),Vge.DARK_RIGHT=new Vge(6),Vge.DARK_DOWN=new Vge(7),Vge.DARK_LEFT=new Vge(8),Vge.MOUNTAIN=new Vge(9);var Bge=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=zre.createTable(5,5,Vge.EMPTY);return e[2][1]=Vge.MOUNTAIN,e[2][2]=Vge.MOUNTAIN,e[2][3]=Vge.MOUNTAIN,new n(e,0)}}]),n}(loe),zge=function(){var e=Zg(function e(){jg(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Dc||(Dc=bg(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Lc||(Lc=bg(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(Fc||(Fc=bg(["You do not have enough strength to push."])))},e.ILLEGAL_ROTATION=function(){return $localize(Uc||(Uc=bg(["You cannot push and turn at the same time."])))},e.ILLEGAL_PUSH=function(){return $localize(Vc||(Vc=bg(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_INSERT_OR_CHOOSE_YOUR_PIECE=function(){return $localize(Bc||(Bc=bg(["You should insert or choose one of your pieces!"])))},e}(),Hge=Zg(function e(t,n){jg(this,e),this.resultingBoard=t,this.moved=n}),Gge=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"isLegal",value:function(e,t){if(uB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return O7.failure(ioe.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return uB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){uB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return O7.failure(i.legal.getReason());r=i.insertedPiece}else uB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?A7.SUCCESS:A7.failure(zge.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){uB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return O7.failure(zge.ILLEGAL_ROTATION());var o=t.getCopiedBoard();return o[r.y][r.x]=Vge.of(e.landingOrientation,a),O7.success(new Hge(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=zre.copyBiArray(n.resultingBoard);return new Bge(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?_oe.getVictory(r):_oe.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return Vge.of(-1===e.x?Wae.RIGHT:-1===e.y?Wae.DOWN:5===e.x?Wae.LEFT:Wae.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){uB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Vge.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Vge.EMPTY&&!1===n.isStraight(r,e))return uB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),O7.failure(zge.ILLEGAL_PUSH());var u=fB.of(o),c=o.getOpposite(),l=0,h=t.getCopiedBoard();e.coord.isInRange(5,5)&&(h[e.coord.y][e.coord.x]=Vge.EMPTY,i.push(e.coord));for(var f=s.isInRange(5,5)&&a!==Vge.EMPTY;f;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,uB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=h[s.y][s.x];d===Vge.MOUNTAIN&&(l-=.9),h[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),f=s.isInRange(5,5)&&a!==Vge.EMPTY&&l>0}return s.isNotInRange(5,5)&&(uB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(uB(n.VERBOSE,"This move is an illegal push: "+h),O7.failure(zge.NOT_ENOUGH_FORCE_TO_PUSH())):(uB(n.VERBOSE,"This move is a legal push: "+h),O7.success(new Hge(h,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===Fre.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=t.getCurrentPlayer(),f=Gg(u);try{for(f.s();!(s=f.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(Fre.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):h===Fre.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){f.e(v)}finally{f.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,h)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Vge.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):Lre.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return uB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Vge.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){uB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=Gg(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=Wae.DOWN,l=new Yae(u,4);o.push({direction:c,fallingCoord:l}),c=Wae.UP,l=new Yae(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var h,f=Gg(r);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=Wae.LEFT,p=new Yae(0,d);o.push({direction:v,fallingCoord:p}),v=Wae.RIGHT,p=new Yae(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){f.e(k)}finally{f.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return uB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){uB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=fB.empty(),c=!1,l=!1,h=0;s.isInRange(5,5)&&!1===c;){var f=e.getPieceAt(s);if(f.isEmptyOrMountain())f===Vge.MOUNTAIN?(h+=.9,l=!0):a++;else{var d=f.getDirection();d===r?l&&((h-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(h+=1,l||a++):l?(u=fB.of(s),o!==Vge.EMPTY&&a++):a++}o=f,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,h-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(h-=1,5===e.countPlayerPawn())||h>0?fB.empty():fB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new Uge(-1,a,fB.of(Wae.RIGHT),Wae.RIGHT)),i.push(Vge.of(Wae.RIGHT,n)),r.push(new Uge(5,a,fB.of(Wae.LEFT),Wae.LEFT)),i.push(Vge.of(Wae.LEFT,n)),r.push(new Uge(a,-1,fB.of(Wae.DOWN),Wae.DOWN)),i.push(Vge.of(Wae.DOWN,n)),r.push(new Uge(a,5,fB.of(Wae.UP),Wae.UP)),i.push(Vge.of(Wae.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e.gameState,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.gameState.getCurrentPlayer(),a=1;a<=3;a++)t=new Uge(-1,a,fB.of(Wae.RIGHT),Wae.UP),n=Vge.of(Wae.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Uge(-1,a,fB.of(Wae.RIGHT),Wae.DOWN),n=Vge.of(Wae.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Uge(5,a,fB.of(Wae.LEFT),Wae.UP),n=Vge.of(Wae.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Uge(5,a,fB.of(Wae.LEFT),Wae.DOWN),n=Vge.of(Wae.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));for(var o=1;o<=3;o++)t=new Uge(o,-1,fB.of(Wae.DOWN),Wae.LEFT),n=Vge.of(Wae.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Uge(o,-1,fB.of(Wae.DOWN),Wae.RIGHT),n=Vge.of(Wae.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Uge(o,5,fB.of(Wae.UP),Wae.LEFT),n=Vge.of(Wae.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Uge(o,5,fB.of(Wae.UP),Wae.RIGHT),n=Vge.of(Wae.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new Yae(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}}]),n}(Coe);return e.VERBOSE=!1,e}(),$ge=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){return new ooe(Gge.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t,n=[],r=e.gameState.getCurrentPlayer(),i=0;i<5;i++)for(var a=0;a<5;a++)if((t=e.gameState.getPieceAtXY(a,i)).belongTo(r)){var o,s=t.getDirection(),u=Gg(Wae.ORTHOGONALS);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c!==s){var l=e.gameState.getCopiedBoard(),h=new Uge(a,i,fB.empty(),c);l[i][a]=Vge.of(c,r),n.push(h)}var f,d=Gg(new Yae(a+c.x,i+c.y).isInRange(5,5)?Wae.ORTHOGONALS:[c]);try{for(d.s();!(f=d.n()).done;){var v=f.value,p=new Uge(a,i,fB.of(c),v);Gge.isLegalForwarding(p,e.gameState,t).isSuccess()&&n.push(p)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){u.e(g)}finally{u.f()}}return e.gameState.countPlayerPawn()<5&&(n=(n=n.concat(Gge.getPushingInsertions(e))).concat(Gge.getDerapingInsertions(e))),uB(Gge.VERBOSE,{getListMovesResult:n}),n}}]),n}(aoe),qge=Vge.EMPTY,jge=Vge.MOUNTAIN,Wge=Vge.LIGHT_UP,Zge=Vge.LIGHT_LEFT,Yge=Vge.LIGHT_RIGHT,Kge=Vge.LIGHT_DOWN,Qge=Vge.DARK_UP,Xge=Vge.DARK_LEFT,Jge=Vge.DARK_RIGHT,eye=Vge.DARK_DOWN,tye=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(zc||(zc=bg(["Goal of the game"]))),$localize(Hc||(Hc=bg(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Bge.getInitialState()),Soe.anyMove($localize(Gc||(Gc=bg(["Inserting a piece"]))),$localize($c||($c=bg(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Bge.getInitialState(),new Uge(2,-1,fB.of(Wae.DOWN),Wae.DOWN),$localize(qc||(qc=bg(["Congratulations!"])))),Soe.fromMove($localize(jc||(jc=bg(["Moving a piece"]))),$localize(Wc||(Wc=bg(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Bge([[qge,qge,qge,qge,qge],[qge,qge,qge,qge,qge],[qge,jge,jge,jge,qge],[qge,qge,qge,qge,qge],[qge,qge,Wge,qge,qge]],0),[new Uge(2,4,fB.of(Wae.UP),Wae.DOWN)],$localize(Zc||(Zc=bg(["Congratulations, you made a side-slip!"]))),$localize(Yc||(Yc=bg(["Failed!"])))),Soe.fromMove($localize(Kc||(Kc=bg(["Moving a piece out of the board"]))),$localize(Qc||(Qc=bg(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Bge([[qge,qge,qge,qge,qge],[qge,qge,qge,qge,qge],[qge,jge,jge,jge,qge],[qge,qge,qge,qge,qge],[qge,qge,Wge,qge,qge]],0),[new Uge(2,4,fB.of(Wae.DOWN),Wae.DOWN)],$localize(Xc||(Xc=bg(["Congratulations, even if in this context it was not a useful move."]))),$localize(Jc||(Jc=bg(["Failed, the piece is still on the board."])))),Soe.fromMove($localize(el||(el=bg(["Pushing"]))),$localize(tl||(tl=bg(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Bge([[Yge,jge,jge,Xge,Zge],[qge,qge,qge,qge,qge],[qge,qge,qge,jge,qge],[qge,qge,qge,qge,qge],[qge,qge,Jge,Xge,Zge]],0),[new Uge(4,4,fB.of(Wae.LEFT),Wae.LEFT)],$localize(nl||(nl=bg(["Congratulations!"]))),$localize(rl||(rl=bg(["Failed!"])))),Soe.fromMove($localize(il||(il=bg(["Victory"]))),$localize(al||(al=bg(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Bge([[qge,qge,qge,qge,qge],[qge,qge,qge,qge,qge],[jge,Qge,Zge,qge,Kge],[qge,qge,qge,qge,eye],[qge,qge,qge,qge,jge]],0),[new Uge(2,2,fB.of(Wae.LEFT),Wae.LEFT)],$localize(ol||(ol=bg(["Congratulations, you won!"]))),$localize(sl||(sl=bg(["Failed, you lost."]))))]});function nye(e,t){if(1&e){var n=oS();l_(),tS(0,"use",7),cS("click",function(){var e=Dk(n).$implicit;return fS(3).insertAt(e.x,e.y)}),nS()}if(2&e){var r=t.$implicit,i=fS(3);pS("id","insertAt_",r.x,"_",r.y,""),qE("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var rye=function(e,t){return{dir:"DOWN",x:e,y:t}},iye=function(e){return{dir:"UP",x:e,y:5}},aye=function(e,t){return{dir:"RIGHT",x:e,y:t}},oye=function(e){return{dir:"LEFT",x:5,y:e}},sye=function(e,t,n,r){return[e,t,n,r]};function uye(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,nye,1,3,"use",6),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=$E(e,t,n,r);return $E(e,t+2,i,a)||o}(e,c,i,a,o,s)?HE(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):cT(e,c+4)}(Mk(),$k(),e,t,n,r,i,a,o)}(11,sye,uT(1,rye,n,-1),sT(4,iye,n),uT(6,aye,-1,n),sT(9,oye,n)))}}var cye=function(){return[0,1,2,3,4]};function lye(e,t){1&e&&(l_(),iS(0),KE(1,uye,2,16,"g",5),aS()),2&e&&(gb(1),JE("ngForOf",oT(1,cye)))}function hye(e,t){if(1&e){var n=oS();l_(),tS(0,"use",13),cS("click",function(){var e=Dk(n).$implicit;return fS(5).chooseDirection(e)}),nS()}if(2&e){var r=t.$implicit,i=fS(3).index,a=fS().index,o=fS();vS("id","chooseDirection_",r,""),qE("transform",o.getArrowTransform(i+1,a+1,r))}}var fye=function(){return["RIGHT","DOWN","LEFT","UP"]};function dye(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"circle",11),cS("click",function(){return Dk(n),fS(4).chooseDirection("")}),nS(),KE(2,hye,1,2,"use",12),nS()}if(2&e){var r=fS(2).index,i=fS().index,a=fS();gb(1),qE("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),gb(1),JE("ngForOf",oT(3,fye))}}function vye(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"use",10),cS("click",function(){Dk(n);var e=fS().index,t=fS().index;return fS().clickPiece(e,t)}),nS(),KE(2,dye,3,4,"g",4),nS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index,s=fS();gb(1),pS("id","clickPiece_",i,"_",o,""),JE("ngClass",s.getPieceClasses(a)),qE("transform",s.getPieceTransform(i,o)),gb(1),JE("ngIf",s.choosingDirection(i,o))}}function pye(e,t){if(1&e&&(l_(),rS(0,"use",14)),2&e){var n=fS().index,r=fS().index,i=fS();qE("transform","translate("+(n+1)*i.SPACE_SIZE+" "+(r+1)*i.SPACE_SIZE+")")}}function gye(e,t){if(1&e){var n=oS();l_(),tS(0,"use",13),cS("click",function(){var e=Dk(n).$implicit;return fS(4).chooseOrientation(e)}),nS()}if(2&e){var r=t.$implicit,i=fS(2).index,a=fS().index,o=fS();vS("id","chooseOrientation_",r,""),qE("transform",o.getArrowTransform(i+1,a+1,r))}}function yye(e,t){1&e&&(l_(),tS(0,"g"),KE(1,gye,1,2,"use",12),nS()),2&e&&(gb(1),JE("ngForOf",oT(1,fye)))}function mye(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",8),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().insertAt(e,t)}),nS(),KE(2,vye,3,5,"g",4),KE(3,pye,1,1,"use",9),KE(4,yye,2,2,"g",4),nS()}if(2&e){var r=t.$implicit,i=t.index,a=fS().index,o=fS();gb(1),pS("id","insertAt_",i,"_",a,""),JE("ngClass",o.getSquareClasses(i,a)),qE("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),gb(1),JE("ngIf",r.isPiece()),gb(1),JE("ngIf",o.isMountain(r)),gb(1),JE("ngIf",o.choosingOrientation(i,a))}}function kye(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,mye,5,10,"g",5),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}var _ye=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).lastMove=fB.empty(),r.chosenCoord=fB.empty(),r.landingCoord=fB.empty(),r.chosenDirection=fB.empty(),r.chosenOrientation=fB.empty(),r.movedPieces=[],r.rules=new Gge(Bge),r.availableMinimaxes=[new $ge(r.rules,"SiamMinimax")],r.encoder=Uge.encoder,r.tutorial=(new tye).tutorial,r.updateBoard(),r}return Zg(n,[{key:"updateBoard",value:function(){if(uB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.chosenDirection=fB.empty(),this.landingCoord=fB.empty(),this.chosenOrientation=fB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(ioe.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=fB.of(new Yae(e,t)),A7.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(uB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=fB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=Wae.factory.fromString(e).get(),t.chosenDirection=fB.of(a),t.landingCoord=fB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return uB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=fB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",A7.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(uB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=fB.of(Wae.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(uB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(zge.CANNOT_INSERT_WHEN_SELECTED()));case 6:if(o=new Yae(e,t),!r.getState().isOnBoard(o)||!r.getState().getPieceAtXY(e,t).isEmptyOrMountain()){i.next=9;break}return i.abrupt("return",r.cancelMove(zge.MUST_INSERT_OR_CHOOSE_YOUR_PIECE()));case 9:return r.chosenCoord=fB.of(o),s=Gge.getCoordDirection(e,t,r.rules.node.gameState),i.abrupt("return",(r.chosenDirection=fB.of(s),r.landingCoord=fB.of(r.chosenCoord.get().getNext(s)),A7.SUCCESS));case 12:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Uge(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Vge.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new Yae(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(uB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new Yae(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(uB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(Wae.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return Ype.getArrowTransform(this.SPACE_SIZE,new Yae(e,t),Wae.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new Yae(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(ose);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-siam"]],features:[xE],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],["class","arrow selected-fill no-stroke",0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),tS(1,"defs"),rS(2,"polygon",1),rS(3,"polygon",2),rS(4,"polygon",3),nS(),KE(5,lye,2,2,"ng-container",4),KE(6,kye,2,1,"g",5),nS()),2&e&&(gb(5),JE("ngIf",t.isPlayerTurn()),gb(1),JE("ngForOf",t.board))},directives:[VA,FA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Cye=function(){var e=Zg(function e(){jg(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(ul||(ul=bg(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(cl||(cl=bg(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(ll||(ll=bg(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(hl||(hl=bg(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(fl||(fl=bg(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(dl||(dl=bg(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(vl||(vl=bg(["You must put this piece next to another piece."])))},e}(),wye=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;jg(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return Zg(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Gg(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new yoe,u=new Gae(-t,-r);if(0!==t||0!==r){var c,l=Gg(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value,f=this.pieces.delete(h),d=h.getNext(u);s.set(d,f)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=zre.createTable(this.width,this.height,Lre.NONE.value),n=Gg(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?A7.failure(ioe.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?A7.SUCCESS:A7.failure(Cye.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=Gg(Jae.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():Lre.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new yoe;if(t.size()>0){i=new yoe;var a,o=Gg(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(Fre.ZERO).getOrElse(new Rse),n=e.get(Fre.ONE).getOrElse(new Rse);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);N7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[Fre.ZERO.value],[Fre.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new yoe,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==Lre.NONE.value&&i.set(new Yae(o,a),Fre.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new yoe,a=0,o=Gg(Jae.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(f){o.e(f)}finally{o.f()}for(var c=i.reverse(),l=new uoe,h=0;h<c.size();h++)l.add(c.getByIndex(h).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=Gg(Jae.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(coe),bye=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;if(jg(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return Fg(a)}return Zg(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(fB.empty(),e,fB.empty())}},{key:"fromMovement",value:function(e,t){return new n(fB.of(e),t,fB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(fB.of(e),t,fB.of(r))}}]),n}(foe);bye.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?Yae.encoder.encode(e.start.get()):null,landing:Yae.encoder.encode(e.landing),keep:e.keep.isPresent()?Yae.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=Yae.encoder.decode(t.landing);if(null==t.start)return bye.fromDrop(n);var r=Yae.encoder.decode(t.start);if(null==t.keep)return bye.fromMovement(r,n);var i=Yae.encoder.decode(t.keep);return bye.fromCut(r,n,i)}}]),n}(Mre));var Eye=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){uB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?O7.failure(Cye.NO_MOVEMENT_BEFORE_TURN_40()):O7.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return _oe.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?_oe.ONE_WON:o<a?_oe.ZERO_WON:_oe.DRAW:a<6?_oe.getDefeat(Fre.ZERO):o<6?_oe.getDefeat(Fre.ONE):_oe.ONGOING}return _oe.ONGOING}},{key:"startSearchingVictorySources",value:function(){uB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(uB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){uB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Jae.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(Jae.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Jae.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){uB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Jae.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=Jae.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){uB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Jae.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=Jae.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Rse,r=Gg(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=Gg(Jae.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===Lre.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return O7.failure(Cye.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case Lre.NONE:return O7.failure(ioe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return O7.failure(ioe.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=wye.deplacePiece(t,e),i=wye.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?O7.failure(Cye.CANNOT_CHOOSE_TO_KEEP()):O7.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return O7.success(new Rse)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new uoe,i=Gg(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new uoe([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return O7.failure(Cye.MUST_CUT());if(n.get(e.get()).isAbsent())return O7.failure(Cye.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=Gg(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return O7.success(o)}}catch(s){a.e(s)}finally{a.f()}return O7.failure(Cye.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(Coe),Sye=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:poe.DEFAULT,victory:fB.empty(),preVictory:fB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===poe.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===poe.VICTORY)return r;n={status:r.status,victory:fB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(aoe),Pye=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return Zg(n)}(ooe),Oye=function(e){Ng(n,e);var t=Lg(n);function n(){var e;return jg(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Zg(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=Eye.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){uB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=bye.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){uB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=Gg(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=Gg(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=bye.fromMovement(s,c);if(e.isCoordConnected(c,fB.of(s))){var h=wye.deplacePiece(e,l),f=wye.getGroups(h,l.start.get());if(Eye.isSplit(f)){var d,v=Gg(f);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=bye.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=Gg(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Rse(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=bye.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===poe.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=bye.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:poe.DEFAULT,victory:fB.empty(),preVictory:fB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=fB.empty();if(a.status===poe.DEFAULT&&a.preVictory.isPresent()&&(o=fB.of(a.preVictory.get())),a.status===poe.VICTORY)return new Pye(i,fB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new Pye(u<c?Fre.ONE.getVictoryValue():c<u?Fre.ZERO.getVictoryValue():0,fB.empty()):u<6?new Pye(Fre.ZERO.getDefeatValue(),fB.empty()):c<6?new Pye(Fre.ONE.getDefeatValue(),fB.empty()):new Pye(u-c,o)}return new Pye(a.status===poe.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){uB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(uB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){uB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Jae.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:poe.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(Jae.factory.all[o],1)}return{status:poe.VICTORY,victory:fB.of(i),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Jae.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:poe.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:poe.VICTORY,victory:fB.of(o),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){uB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Jae.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:poe.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};a.length%2==0&&(i=Jae.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:poe.VICTORY,victory:fB.of(a),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){uB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Jae.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:poe.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};a.push(o),a.length%2==0&&(i=Jae.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:poe.VICTORY,victory:fB.of(a),preVictory:fB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){uB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){uB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(Jae.factory.all[e],1),s=0,u=fB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var h=Jae.factory.all[l];c===Lre.NONE?(s+=.16,u=fB.of(o)):s++,o=o.getNext(h,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(uB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:poe.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};i=t}else if(5===e)return{status:poe.VICTORY,victory:fB.of(n),preVictory:fB.empty(),sum:0};return{status:r.status,victory:fB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){uB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=Jae.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=fB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var h=r.status,f=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:poe.VICTORY,victory:fB.of(o),preVictory:fB.empty(),sum:0};5.16===p&&h===poe.DEFAULT&&(f.isPresent()?(D7(!1===f.equals(u),"Impossible to have point aligned with differents line to a same point"),h=poe.PRE_VICTORY):f=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:h,victory:fB.of(o),preVictory:f,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),fB.empty();case Lre.NONE:return n.push(.16),fB.of(t);default:return n.push(1),fB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){uB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Jae.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=fB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Lre.NONE?(u+=.16,c=fB.of(s)):u++,o.length%2==0&&(a=Jae.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){uB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Jae.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=fB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Lre.NONE?(u+=.16,c=fB.of(s)):u++,o.push(s),o.length%2==0&&(a=Jae.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new Eye(wye);n.singleton=fB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(Sye);Oye.singleton=fB.empty();var Tye=Lre.NONE.value,Iye=Fre.ZERO.value,Aye=Fre.ONE.value,Rye=function(){var e=Zg(function e(){jg(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(pl||(pl=bg(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(gl||(gl=bg(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),xye=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(yl||(yl=bg(["Six"]))),$localize(ml||(ml=bg(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),wye.getInitialState()),Soe.fromMove($localize(kl||(kl=bg(["Victory (line)"]))),$localize(_l||(_l=bg(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),wye.fromRepresentation([[Iye,Aye,Aye,Aye,Aye,Iye],[Tye,Iye,Aye,Tye,Iye,Tye],[Aye,Aye,Iye,Tye,Tye,Tye],[Tye,Tye,Iye,Tye,Tye,Tye],[Tye,Iye,Tye,Tye,Tye,Tye],[Iye,Tye,Tye,Tye,Tye,Tye]],0),[bye.fromDrop(new Yae(3,2))],$localize(Cl||(Cl=bg(["Congratulations!"]))),$localize(wl||(wl=bg(["Failed!"])))),Soe.fromMove($localize(bl||(bl=bg(["Victory (circle)"]))),$localize(El||(El=bg(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),wye.fromRepresentation([[Tye,Tye,Tye,Aye,Tye,Tye],[Tye,Tye,Aye,Aye,Iye,Iye],[Tye,Aye,Tye,Iye,Aye,Tye],[Aye,Iye,Iye,Iye,Iye,Aye]],0),[bye.fromDrop(new Yae(5,2))],$localize(Sl||(Sl=bg(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(Pl||(Pl=bg(["Failed!"])))),Soe.fromMove($localize(Ol||(Ol=bg(["Victory (triangle)"]))),$localize(Tl||(Tl=bg(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),wye.fromRepresentation([[Tye,Tye,Tye,Aye,Tye,Tye],[Tye,Iye,Aye,Iye,Iye,Iye],[Tye,Iye,Tye,Iye,Iye,Tye],[Aye,Aye,Aye,Tye,Aye,Tye]],0),[bye.fromDrop(new Yae(3,3))],$localize(Il||(Il=bg(["Congratulations!"]))),$localize(Al||(Al=bg(["Failed!"])))),Soe.fromPredicate($localize(Rl||(Rl=bg(["Second phase"]))),$localize(xl||(xl=bg(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),wye.fromRepresentation([[Tye,Tye,Tye,Tye,Tye,Tye,Tye,Aye,Tye],[Tye,Tye,Tye,Tye,Tye,Tye,Iye,Tye,Tye],[Tye,Tye,Tye,Tye,Iye,Iye,Iye,Tye,Tye],[Tye,Tye,Tye,Tye,Aye,Aye,Tye,Aye,Iye],[Tye,Iye,Aye,Aye,Iye,Iye,Aye,Tye,Tye],[Iye,Iye,Iye,Iye,Aye,Aye,Aye,Iye,Tye],[Aye,Aye,Iye,Tye,Aye,Aye,Iye,Tye,Tye],[Tye,Iye,Tye,Iye,Iye,Tye,Tye,Tye,Tye],[Aye,Aye,Aye,Aye,Tye,Tye,Tye,Tye,Tye],[Tye,Iye,Tye,Aye,Tye,Tye,Tye,Tye,Tye]],40),bye.fromMovement(new Yae(6,1),new Yae(5,1)),function(e,t){var n=t.countPieces();return 19===n[0]?18===n[1]?A7.SUCCESS:A7.failure(Rye.MOVEMENT_NOT_DISCONNECTING()):A7.failure(Rye.MOVEMENT_SELF_DISCONNECTING())},$localize(Ml||(Ml=bg(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Soe.fromPredicate($localize(Nl||(Nl=bg(["Victory by disconnection"]))),$localize(Dl||(Dl=bg(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),wye.fromRepresentation([[Tye,Tye,Tye,Tye,Tye,Aye],[Tye,Tye,Tye,Tye,Iye,Aye],[Tye,Tye,Tye,Aye,Iye,Iye],[Tye,Tye,Iye,Tye,Aye,Iye],[Aye,Aye,Tye,Tye,Tye,Iye],[Iye,Aye,Tye,Tye,Tye,Tye],[Iye,Tye,Tye,Tye,Tye,Tye]],40),bye.fromMovement(new Yae(2,3),new Yae(3,3)),function(e,t){return e.start.equalsValue(new Yae(2,3))?A7.SUCCESS:A7.failure(Rye.MOVEMENT_NOT_DISCONNECTING())},$localize(Ll||(Ll=bg(["Congratulations, you won!"])))),Soe.fromPredicate($localize(Fl||(Fl=bg(["Special disconnection"]))),$localize(Ul||(Ul=bg(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),wye.fromRepresentation([[Tye,Tye,Tye,Tye,Tye,Aye],[Tye,Tye,Tye,Tye,Iye,Aye],[Tye,Tye,Tye,Aye,Iye,Iye],[Iye,Tye,Iye,Tye,Tye,Aye],[Aye,Aye,Tye,Tye,Tye,Tye],[Iye,Iye,Tye,Tye,Tye,Tye],[Iye,Tye,Tye,Tye,Tye,Tye]],40),bye.fromCut(new Yae(2,3),new Yae(2,5),new Yae(2,5)),function(e,t){return e.keep.isAbsent()?A7.failure($localize(Vl||(Vl=bg(["This move has not cut the board in two equal halves."])))):t.getPieceAt(e.landing.getNext(t.offset))===Lre.NONE?A7.failure($localize(Bl||(Bl=bg(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):A7.SUCCESS},$localize(zl||(zl=bg(["Congratulations, you won!"]))))]});function Mye(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",10),cS("click",function(){var e=Dk(n).$implicit;return fS().onPieceClick(e)}),nS()}if(2&e){var r=t.$implicit,i=fS();pS("id","piece_",r.x,"_",r.y,""),JE("ngClass",i.getPieceClass(r)),qE("points",i.getHexaCoordsAt(r))}}function Nye(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",11),cS("click",function(){var e=Dk(n).$implicit;return fS().onNeighborClick(e)}),nS()}if(2&e){var r=t.$implicit,i=fS();pS("id","neighbor_",r.x,"_",r.y,""),qE("points",i.getHexaCoordsAt(r))}}function Dye(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",10),cS("click",function(){Dk(n);var e=fS();return e.onPieceClick(e.chosenLanding.get())}),nS()}if(2&e){var r=fS();pS("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),JE("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),qE("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Lye(e,t){if(1&e&&(l_(),rS(0,"polyline",12)),2&e){var n=t.$implicit,r=fS();pS("id","disconnected_",n.x,"_",n.y,""),qE("points",r.getHexaCoordsAt(n))}}function Fye(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",13),cS("click",function(){Dk(n);var e=fS();return e.onNeighborClick(e.leftCoord.get())}),nS()}if(2&e){var r=fS();pS("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),qE("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Uye(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",14),cS("click",function(){Dk(n);var e=fS();return e.onPieceClick(e.lastDrop.get())}),nS()}if(2&e){var r=fS();pS("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),qE("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Vye(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",15),cS("click",function(){Dk(n);var e=fS();return e.onPieceClick(e.selectedPiece.get())}),nS()}if(2&e){var r=fS();pS("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),JE("ngClass",r.getSelectedPieceClass()),qE("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Bye(e,t){if(1&e&&(l_(),rS(0,"polyline",16)),2&e){var n=t.$implicit,r=fS();pS("id","victoryCoord_",n.x,"_",n.y,""),qE("points",r.getHexaCoordsAt(n))}}function zye(e,t){if(1&e){var n=oS();l_(),tS(0,"g",19),cS("click",function(){var e=Dk(n).$implicit;return fS(2).onPieceClick(e)}),rS(1,"polyline",20),nS()}if(2&e){var r=t.$implicit,i=fS(2);gb(1),pS("id","cuttable_",r.x,"_",r.y,""),qE("points",i.getHexaCoordsAt(r))}}function Hye(e,t){if(1&e&&(l_(),tS(0,"g",17),KE(1,zye,2,3,"g",18),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}var Gye=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=fB.empty(),r.lastDrop=fB.empty(),r.selectedPiece=fB.empty(),r.chosenLanding=fB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new Eye(wye),r.availableMinimaxes=[new Oye(r.rules,"SixMinimax")],r.encoder=bye.encoder,r.tutorial=(new xye).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new eoe(1.5*r.SPACE_SIZE,new Yae(2*r.SPACE_SIZE,0),roe.INSTANCE),r.updateBoard(),r}return Zg(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=fB.empty(),this.chosenLanding=fB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=fB.empty(),this.lastDrop=fB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=Gg(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Gg(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=fB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?fB.of(e.start.get().getNext(this.state.offset,1)):fB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=Gg(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=Eye.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(Cye.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(ioe.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=fB.of(e),A7.SUCCESS));case 7:return i=bye.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(Cye.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(bye.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(Cye.CAN_NO_LONGER_DROP()));case 9:return i=bye.fromMovement(t.selectedPiece.get(),e),a=Eye.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=fB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,A7.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===Cye.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=bye.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=wye.deplacePiece(this.state,e),n=wye.getGroups(t,e.start.get()),r=Eye.getBiggerGroups(n);this.cuttableGroups=[];var i,a=Gg(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(Qae);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-six"]],features:[xE],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,Mye,1,4,"polyline",1),KE(2,Nye,1,3,"polyline",2),KE(3,Dye,1,4,"polyline",3),KE(4,Lye,1,3,"polyline",4),KE(5,Fye,1,3,"polyline",5),KE(6,Uye,1,3,"polyline",6),KE(7,Vye,1,4,"polyline",7),KE(8,Bye,1,3,"polyline",8),KE(9,Hye,2,1,"g",9),nS()),2&e&&(qE("viewBox",t.viewBox),gb(1),JE("ngForOf",t.pieces),gb(1),JE("ngForOf",t.neighbors),gb(1),JE("ngIf",t.chosenLanding.isPresent()),gb(1),JE("ngForOf",t.disconnecteds),gb(1),JE("ngIf",t.leftCoord.isPresent()),gb(1),JE("ngIf",t.lastDrop.isPresent()),gb(1),JE("ngIf",t.selectedPiece.isPresent()),gb(1),JE("ngForOf",t.victoryCoords),gb(1),JE("ngForOf",t.cuttableGroups))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),$ye=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return O7.success(r)}catch(r){return O7.failure(r.message)}}}]),n}(mse);$ye.encoder=gse.getEncoder(9,9,$ye.of);var qye={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:Fre.ZERO},jye=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Cse.UNOCCUPIED,t=Cse.INVADERS,r=Cse.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Cse.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(bse),Wye=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.call(this,jye,qye,$ye.of)}return Zg(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),koe.ruler=this.singleton,n.singleton}}]),n}(Sse),Zye=Cse.UNOCCUPIED,Yye=Cse.INVADERS,Kye=Cse.DEFENDERS,Qye=Cse.PLAYER_ONE_KING,Xye=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(Hl||(Hl=bg(["Goal of the game"]))),$localize(Gl||(Gl=bg(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),jye.getInitialState()),Soe.anyMove($localize($l||($l=bg(["Moving"]))),$localize(ql||(ql=bg(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),jye.getInitialState(),$ye.of(new Yae(4,1),new Yae(1,1)),$localize(jl||(jl=bg(["Congratulations!"])))),Soe.fromMove($localize(Wl||(Wl=bg(["Capturing a soldier (1/2)"]))),$localize(Zl||(Zl=bg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new jye([[Zye,Zye,Zye,Yye,Yye,Yye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Yye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Kye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Yye,Kye,Zye,Zye,Zye,Yye],[Yye,Yye,Kye,Kye,Qye,Kye,Kye,Yye,Yye],[Zye,Zye,Zye,Zye,Kye,Zye,Zye,Zye,Yye],[Zye,Zye,Zye,Zye,Kye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Yye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Yye,Yye,Yye,Zye,Zye,Zye]],1),[$ye.of(new Yae(2,4),new Yae(2,3)),$ye.of(new Yae(4,2),new Yae(3,2))],$localize(Yl||(Yl=bg(["Congratulations, that will teach him a lesson!"]))),$localize(Kl||(Kl=bg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Soe.fromMove($localize(Ql||(Ql=bg(["Capturing a soldier (2/2)"]))),$localize(Xl||(Xl=bg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new jye([[Zye,Zye,Zye,Yye,Yye,Yye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Yye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Kye,Zye,Zye,Zye,Zye],[Zye,Zye,Kye,Zye,Qye,Zye,Kye,Zye,Yye],[Yye,Yye,Zye,Kye,Zye,Kye,Kye,Yye,Yye],[Zye,Zye,Zye,Zye,Kye,Zye,Zye,Zye,Yye],[Zye,Zye,Zye,Zye,Kye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Yye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Yye,Yye,Yye,Zye,Zye,Zye]],12),[$ye.of(new Yae(1,4),new Yae(2,4))],$localize(Jl||(Jl=bg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(eh||(eh=bg(["Failed, you did not do the expected move."])))),Soe.fromMove($localize(th||(th=bg(["Capturing the king (1/2)"]))),$localize(nh||(nh=bg(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new jye([[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Yye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Yye,Qye,Zye,Yye,Zye,Zye,Zye,Zye,Zye],[Zye,Yye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye]],72),[$ye.of(new Yae(3,4),new Yae(2,4))],$localize(rh||(rh=bg(["Congratulations, you won!"]))),$localize(ih||(ih=bg(["Failed, you let the king run away."])))),Soe.fromMove($localize(ah||(ah=bg(["Capturing the king (2/2)"]))),$localize(oh||(oh=bg(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new jye([[Zye,Zye,Yye,Qye,Yye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Yye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye],[Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye,Zye]],72),[$ye.of(new Yae(3,3),new Yae(3,1))],$localize(sh||(sh=bg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(uh||(uh=bg(["Failed!"]))))]});function Jye(e,t){1&e&&(l_(),rS(0,"polyline",8))}function eme(e,t){1&e&&(l_(),rS(0,"polyline",9))}function tme(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Jye,1,0,"polyline",6),KE(2,eme,1,0,"ng-template",null,7,MT),nS()),2&e){var n=QE(3),r=fS().index,i=fS().index,a=fS();gb(1),JE("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function nme(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"line",10),rS(2,"line",10),rS(3,"line",10),rS(4,"line",10),rS(5,"line",10),nS()),2&e){var n=fS(2).index,r=fS().index,i=fS();gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function rme(e,t){if(1&e&&(l_(),rS(0,"polyline",15)),2&e){var n=fS(3).index,r=fS().index;JE("ngClass",fS().viewInfo.pieceClasses[r][n])}}function ime(e,t){if(1&e&&(l_(),rS(0,"line",10),rS(1,"line",10),rS(2,"line",10),rS(3,"line",10)),2&e){var n=fS(3).index,r=fS().index,i=fS();JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),gb(1),JE("ngClass",i.viewInfo.pieceClasses[r][n]),qE("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function ame(e,t){if(1&e&&(l_(),KE(0,rme,1,1,"polyline",13),KE(1,ime,4,20,"ng-template",null,14,MT)),2&e){var n=QE(2),r=fS(2).index,i=fS().index;JE("ngIf",fS().isKing(r,i))("ngIfElse",n)}}function ome(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"circle",10),KE(2,nme,6,25,"g",11),KE(3,ame,3,2,"ng-template",null,12,MT),nS()),2&e){var n=QE(4),r=fS().index,i=fS().index,a=fS();gb(1),JE("ngClass",a.viewInfo.pieceClasses[i][r]),qE("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),gb(1),JE("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function sme(e,t){if(1&e){var n=oS();l_(),tS(0,"g",3),cS("click",function(){var e=Dk(n).index,t=fS().index;return fS().onClick(e,t)}),rS(1,"rect",4),KE(2,tme,4,2,"g",5),KE(3,ome,5,6,"g",5),nS()}if(2&e){var r=t.index,i=fS().index,a=fS();pS("id","click_",r,"_",i,""),qE("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),gb(1),JE("ngClass",a.getRectClasses(r,i)),qE("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),gb(1),JE("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),gb(1),JE("ngIf",a.board[i][r]!==a.EMPTY)}}function ume(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,sme,4,8,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function cme(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",16),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e.x,e.y)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),pS("id","click_",r.x,"_",r.y,""),qE("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var lme=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e,!1,$ye.from)).rules=Wye.get(),r.availableMinimaxes=[new Tse(r.rules,"DummyBot"),new xse(r.rules,"Piece > Influence"),new Mse(r.rules,"Piece > Control"),new Nse(r.rules,"Escape > Piece > Control")],r.encoder=$ye.encoder,r.tutorial=(new Xye).tutorial,r.updateBoard(),r}return Zg(n)}(Ose);return e.\u0275fac=function(t){return new(t||e)(XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["app-tablut"]],features:[xE],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,ume,2,1,"g",1),KE(2,cme,2,6,"g",1),nS()),2&e&&(qE("viewBox",t.getViewBox()),gb(1),JE("ngForOf",t.board),gb(1),JE("ngForOf",t.getClickables()))},directives:[FA,DA,VA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hme=Zg(function e(){jg(this,e)});hme.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(ch||(ch=bg(["You cannot put a new ring after the tenth turn."])))},hme.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(lh||(lh=bg(["You cannot put a marker in a ring before placing all of your rings."])))},hme.MISSING_CAPTURES=Lle.MISSING_CAPTURES,hme.MOVE_DIRECTION_INVALID=function(){return $localize(hh||(hh=bg(["The direction of your move is invalid: a move is made along a straight line."])))},hme.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(fh||(fh=bg(["You can only capture your own markers."])))},hme.SHOULD_SELECT_PLAYER_RING=function(){return $localize(dh||(dh=bg(["You must pick one of your own rings to move."])))},hme.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(vh||(vh=bg(["Your ring must land on an empty space."])))},hme.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(ph||(ph=bg(["A ring can only jump over markers or empty spaces, not over another ring."])))},hme.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(gh||(gh=bg(["Your ring must land on the first empty space after a group of markers."])))},hme.AMBIGUOUS_CAPTURE_COORD=Lle.AMBIGUOUS_CAPTURE_COORD,hme.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(yh||(yh=bg(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var fme=function(){function e(t,n){jg(this,e),this.player=t,this.isRing=n}return Zg(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return D7(!1===this.isRing,"cannot flip a ring (it should never happen)"),D7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return sB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===Lre.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();fme.encoder=Nre.tuple([Fre.numberEncoder,Nre.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return fme.of(e[0],e[1])}),fme.UNREACHABLE=new fme(Lre.NONE,!1),fme.EMPTY=new fme(Lre.NONE,!1),fme.MARKER_ZERO=new fme(Fre.ZERO,!1),fme.MARKER_ONE=new fme(Fre.ONE,!1),fme.MARKERS=[fme.MARKER_ZERO,fme.MARKER_ONE],fme.RING_ZERO=new fme(Fre.ZERO,!0),fme.RING_ONE=new fme(Fre.ONE,!0),fme.RINGS=[fme.RING_ZERO,fme.RING_ONE];var dme=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i){var a;return jg(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],fme.EMPTY)).sideRings=r,a}return Zg(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&zre.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==fme.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=zre.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=fme.EMPTY,t=fme.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(gce);return e.SIZE=11,e}(),vme=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;if(jg(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=fB.ofNullable(r),Fg(i)}return Zg(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===xg(Bg(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=Jae.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(xle);vme.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return Yae.encoder.encode(e)}),ringTaken:Yae.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return D7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new vme(t.captured.map(function(e){return Yae.encoder.decode(e)}),Yae.encoder.decode(t.ringTaken))}}]),n}(xre));var pme=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a){var o;return jg(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return Zg(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===zre.compareArray(this.initialCaptures,e.initialCaptures)||!1===zre.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Gg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(foe);pme.coordOptionalEncoder=Rle(Yae.encoder),pme.encoder=new(function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"encodeMove",value:function(e){var t={moveStart:Yae.encoder.encode(e.start),moveEnd:pme.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=vme.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=vme.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return D7(null!=t.moveStart,"Invalid encoded YinshMove"),new pme(this.decodeArray(t,"initialCapture",vme.encoder.decode),Yae.encoder.decode(t.moveStart),pme.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",vme.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(Mre));var gme=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?ooe.fromWinner(t.winner):new ooe(e.gameState.sideRings[0]*Fre.ZERO.getScoreModifier()+e.gameState.sideRings[1]*Fre.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=Gg(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Og(i.value,2),s=o[0];o[1]===fme.EMPTY&&n.push(new pme([],s,fB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new pme(e,r.start,fB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Ule.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){jg(this,e)}return Zg(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return D7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=Gg(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new vme(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=Gg(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Gg(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===fme.RINGS[t]&&n.push(e)}),n}}]),n}(aoe),yme=function(e){Ng(n,e);var t=Lg(n);function n(){return jg(this,n),t.apply(this,arguments)}return Zg(n,[{key:"applyLegalMove",value:function(e,t,n){return new dme(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new dme(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,fme.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new dme(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,fme.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===fme.RINGS[n]?A7.SUCCESS:A7.failure(hme.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,fme.MARKERS[r]);i=i.setAt(t,fme.RINGS[r]);for(var a=Jae.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==fme.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return O7.failure(hme.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():O7.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return O7.failure(hme.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==fme.EMPTY)return O7.failure(ioe.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,fme.of(n,!0)).board,a=new dme(i,r,e.turn);return O7.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==fme.RINGS[n]?A7.failure(hme.SHOULD_SELECT_PLAYER_RING()):A7.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==fme.EMPTY)return A7.failure(hme.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=Jae.factory.fromMove(t,n);if(i.isFailure())return A7.failure(hme.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===fme.EMPTY){if(o)return A7.failure(hme.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return A7.failure(hme.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return A7.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=Gg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return A7.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=Gg(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==fme.MARKERS[r])return A7.failure(hme.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==fme.RINGS[r]?A7.failure(hme.CAPTURE_SHOULD_TAKE_RING()):A7.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?A7.SUCCESS:A7.failure(hme.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?fB.of({start:s,end:r,dir:o}):fB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(vme.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=Gg(Jae.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===fme.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?_oe.ONGOING:e.gameState.sideRings[0]>=3?_oe.ZERO_WON:e.gameState.sideRings[1]>=3?_oe.ONE_WON:_oe.ONGOING}}]),n}(Coe),mme=fme.EMPTY,kme=fme.UNREACHABLE,_me=fme.MARKER_ZERO,Cme=fme.RING_ZERO,wme=fme.MARKER_ONE,bme=fme.RING_ONE,Eme=function(){var e=Zg(function e(){jg(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(mh||(mh=bg(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(kh||(kh=bg(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),Sme=Zg(function e(){jg(this,e),this.tutorial=[Soe.informational($localize(_h||(_h=bg(["Goal of the game"]))),$localize(Ch||(Ch=bg(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new dme([[kme,kme,kme,kme,kme,kme,mme,mme,mme,mme,kme],[kme,kme,kme,kme,mme,mme,mme,mme,mme,mme,mme],[kme,kme,kme,_me,bme,mme,mme,mme,mme,mme,mme],[kme,kme,mme,_me,mme,bme,mme,wme,mme,mme,mme],[kme,mme,Cme,wme,mme,mme,bme,_me,mme,mme,mme],[kme,mme,mme,_me,wme,mme,mme,mme,mme,mme,kme],[mme,mme,mme,_me,mme,mme,mme,bme,mme,mme,kme],[mme,mme,mme,wme,_me,Cme,mme,mme,mme,kme,kme],[mme,mme,mme,mme,mme,mme,mme,mme,kme,kme,kme],[mme,mme,mme,mme,mme,mme,mme,kme,kme,kme,kme],[kme,mme,mme,mme,mme,kme,kme,kme,kme,kme,kme]],[3,1],20)),Soe.anyMove($localize(wh||(wh=bg(["Initial board and placement phase"]))),$localize(bh||(bh=bg(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new dme(dme.getInitialState().board,[5,5],0),new pme([],new Yae(5,5),fB.empty(),[]),$localize(Eh||(Eh=bg(["Congratulations!"])))),Soe.anyMove($localize(Sh||(Sh=bg(["Putting a marker"]))),$localize(Ph||(Ph=bg(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new dme([[kme,kme,kme,kme,kme,kme,mme,mme,mme,mme,kme],[kme,kme,kme,kme,mme,mme,mme,mme,mme,mme,mme],[kme,kme,kme,bme,mme,mme,mme,mme,mme,mme,mme],[kme,kme,bme,mme,mme,bme,mme,mme,mme,mme,mme],[kme,mme,Cme,wme,mme,mme,bme,mme,mme,mme,mme],[kme,mme,mme,wme,mme,mme,mme,mme,mme,mme,kme],[mme,mme,mme,mme,Cme,mme,mme,bme,mme,mme,kme],[mme,mme,mme,mme,mme,Cme,mme,mme,mme,kme,kme],[mme,mme,mme,Cme,mme,mme,mme,kme,kme,kme,kme],[mme,mme,mme,mme,mme,mme,mme,kme,kme,kme,kme],[kme,mme,mme,mme,mme,kme,kme,kme,kme,kme,kme]],[0,0],20),new pme([],new Yae(2,4),fB.of(new Yae(4,4)),[]),$localize(Oh||(Oh=bg(["Congratulations!"])))),Soe.fromPredicate($localize(Th||(Th=bg(["Getting a ring by aligning 5 markers"]))),$localize(Ih||(Ih=bg(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new dme([[kme,kme,kme,kme,kme,kme,mme,mme,mme,mme,kme],[kme,kme,kme,kme,mme,mme,mme,mme,mme,mme,mme],[kme,kme,kme,bme,mme,mme,mme,mme,mme,mme,mme],[kme,kme,bme,mme,mme,bme,mme,mme,mme,mme,mme],[kme,mme,_me,_me,Cme,wme,wme,mme,mme,mme,mme],[kme,mme,mme,bme,mme,mme,mme,mme,mme,mme,kme],[mme,mme,mme,mme,Cme,mme,mme,bme,mme,mme,kme],[mme,mme,mme,mme,mme,Cme,mme,mme,mme,kme,kme],[mme,mme,mme,Cme,mme,mme,mme,Cme,kme,kme,kme],[mme,mme,mme,mme,mme,mme,mme,kme,kme,kme,kme],[kme,mme,mme,mme,mme,kme,kme,kme,kme,kme,kme]],[0,0],20),new pme([],new Yae(4,4),fB.of(new Yae(7,4)),[vme.of(new Yae(2,4),new Yae(6,4),new Yae(7,4))]),function(e,t){return 1===t.sideRings[Fre.ZERO.value]?A7.SUCCESS:A7.failure(Eme.MUST_ALIGN_FIVE())},$localize(Ah||(Ah=bg(["Congratulations!"])))),Soe.fromPredicate($localize(Rh||(Rh=bg(["Compound captures"]))),$localize(xh||(xh=bg(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new dme([[kme,kme,kme,kme,kme,kme,mme,mme,mme,mme,kme],[kme,kme,kme,kme,Cme,mme,mme,bme,bme,Cme,mme],[kme,kme,kme,Cme,mme,mme,wme,bme,mme,Cme,mme],[kme,kme,mme,Cme,mme,mme,mme,mme,mme,bme,mme],[kme,mme,mme,mme,mme,_me,mme,mme,bme,mme,mme],[kme,mme,mme,mme,_me,_me,mme,wme,mme,mme,kme],[mme,mme,mme,_me,mme,_me,mme,mme,mme,mme,kme],[mme,mme,_me,mme,mme,_me,mme,mme,mme,kme,kme],[mme,_me,mme,mme,mme,_me,mme,mme,kme,kme,kme],[mme,mme,mme,mme,mme,_me,mme,kme,kme,kme,kme],[kme,mme,mme,mme,mme,kme,kme,kme,kme,kme,kme]],[0,0],10),new pme([vme.of(new Yae(5,4),new Yae(1,8),new Yae(3,2)),vme.of(new Yae(5,9),new Yae(5,5),new Yae(3,3))],new Yae(4,1),fB.of(new Yae(4,2)),[]),function(e,t){return 2===t.sideRings[Fre.ZERO.value]?A7.SUCCESS:A7.failure(Eme.MUST_CAPTURE_TWO())},$localize(Mh||(Mh=bg(["Congratulations!"]))))]});function Pme(e,t){if(1&e&&(l_(),rS(0,"circle",9)),2&e){var n=fS(2).$implicit,r=fS(2);qE("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function Ome(e,t){if(1&e&&(l_(),rS(0,"circle",10)),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();pS("id","ring_",r,"_",a,""),JE("ngClass",i.ringClasses),qE("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function Tme(e,t){if(1&e&&(l_(),rS(0,"circle",9)),2&e){var n=fS(2).$implicit,r=fS(2);qE("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function Ime(e,t){if(1&e&&(l_(),rS(0,"circle",11)),2&e){var n=fS(2),r=n.index,i=n.$implicit,a=fS().index,o=fS();pS("id","marker_",r,"_",a,""),JE("ngClass",i.markerClasses),qE("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Ame(e,t){if(1&e){var n=oS();l_(),tS(0,"g",3),cS("click",function(){Dk(n);var e=fS().$implicit;return fS(2).onClick(e.coord)}),rS(1,"polyline",4),tS(2,"g",5),KE(3,Pme,1,3,"circle",6),KE(4,Ome,1,6,"circle",7),KE(5,Tme,1,3,"circle",6),KE(6,Ime,1,6,"circle",8),nS(),nS()}if(2&e){var r=fS(),i=r.index,a=r.$implicit,o=fS().index;pS("id","click_",i,"_",o,""),gb(1),pS("id","space_",i,"_",o,""),JE("ngClass",a.spaceClasses),qE("points",a.coordinates),gb(1),pS("id","pieceGroup_",i,"_",o,""),JE("ngClass",a.removedClass),gb(1),JE("ngIf",a.isRing),gb(1),JE("ngIf",a.isRing),gb(1),JE("ngIf",a.isRing),gb(1),JE("ngIf",a.isMarker)}}function Rme(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Ame,7,13,"g",2),nS()),2&e){var n=t.$implicit;gb(1),JE("ngIf",null!=n)}}function xme(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Rme,2,1,"g",1),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}function Mme(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"polyline",12),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),pS("id","selected_",r.x,"_",r.y,""),qE("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Nme(e,t){if(1&e){var n=oS();l_(),tS(0,"polyline",14),cS("click",function(){Dk(n);var e=fS().$implicit;return fS().onClick(e)}),nS()}if(2&e){var r=fS().$implicit,i=fS();pS("id","selectable_",r.x,"_",r.y,""),qE("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Dme(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Nme,1,3,"polyline",13),nS()),2&e){var n=fS();gb(1),JE("ngIf",n.isPlayerTurn())}}function Lme(e,t){if(1&e){var n=oS();l_(),tS(0,"g"),tS(1,"rect",15),cS("click",function(){var e=Dk(n).$implicit;return fS().onClick(e)}),nS(),nS()}if(2&e){var r=t.$implicit,i=fS();gb(1),qE("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Fme(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"circle",16),rS(2,"circle",9),rS(3,"circle",17),nS()),2&e){var n=t.index,r=fS().$implicit,i=fS();gb(1),pS("id","player_",r,"_sideRing_",n+1,""),qE("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),gb(1),qE("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),gb(1),JE("ngClass",i.viewInfo.sideRingClass[r]),qE("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var Ume=function(){return[]};function Vme(e,t){if(1&e&&(l_(),tS(0,"g"),KE(1,Fme,4,12,"g",1),nS()),2&e){var n=t.$implicit,r=fS();gb(1),JE("ngForOf",oT(1,Ume).constructor(r.viewInfo.sideRings[n]))}}var Bme=function(){return[0,1]},zme=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=fB.empty(),r.moveEnd=fB.empty(),r.currentlyMoved=[],r.currentCapture=fB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=fB.of([0,0]),r.rules=new yme(dme),r.availableMinimaxes=[new gme(r.rules,"YinshMinimax")],r.encoder=pme.encoder,r.tutorial=(new Sme).tutorial,r.hexaLayout=new eoe(1.5*n.RING_OUTER_SIZE,new Yae(2*n.RING_OUTER_SIZE,0),roe.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return Zg(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=fB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=Gg(Fre.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=Gg(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=Gg(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=Gg(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=Gg(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==fme.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=fB.empty(),this.moveStart=fB.empty(),this.moveEnd=fB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=Gg(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=Jae.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==fme.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=Gg(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),A7.SUCCESS}},{key:"onClick",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(hme.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",A7.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=Gg(e);try{for(n.s();!(t=n.n()).done;){var r,i=Gg(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(sB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(hme.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(hme.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=fB.of(e),this.constructedState=new dme(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(D7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),A7.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=Gg(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,fme.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,fme.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=fB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),A7.SUCCESS)):(sB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),A7.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),A7.SUCCESS}},{key:"tryMove",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new pme(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=fB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=fB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",A7.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=fB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),A7.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(Qae);function Hme(e,t){if(1&e&&(tS(0,"option",5),US(1),nS()),2&e){var n=t.$implicit;JE("value",n.urlName),gb(1),VS(n.name)}}zme.RING_OUTER_SIZE=40,zme.RING_MID_SIZE=34,zme.RING_INNER_SIZE=28,zme.MARKER_SIZE=zme.RING_INNER_SIZE,zme.INDICATOR_SIZE=10,zme.\u0275fac=function(e){return new(e||zme)(XE(M7))},zme.\u0275cmp=$m({type:zme,selectors:[["app-yinsh"]],features:[xE],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(l_(),tS(0,"svg",0),KE(1,xme,2,1,"g",1),KE(2,Mme,2,3,"g",1),KE(3,Dme,2,1,"g",1),KE(4,Lme,2,4,"g",1),KE(5,Vme,2,2,"g",1),nS()),2&e&&(gb(1),JE("ngForOf",t.viewInfo.spaceInfo),gb(1),JE("ngForOf",t.viewInfo.selectedCoords),gb(1),JE("ngForOf",t.viewInfo.selectableCoords),gb(1),JE("ngForOf",t.viewInfo.targets),gb(1),JE("ngForOf",oT(5,Bme)))},directives:[FA,VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Gme=function(){var e=Zg(function e(){jg(this,e)});return e.ABALONE=function(){return $localize(Nh||(Nh=bg(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Dh||(Dh=bg(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(Lh||(Lh=bg(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(Fh||(Fh=bg(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(Uh||(Uh=bg(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(Vh||(Vh=bg(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(Bh||(Bh=bg(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(zh||(zh=bg(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(Hh||(Hh=bg(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(Gh||(Gh=bg(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize($h||($h=bg(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(qh||(qh=bg(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(jh||(jh=bg(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(Wh||(Wh=bg(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(Zh||(Zh=bg(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(Yh||(Yh=bg(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(Kh||(Kh=bg(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(Qh||(Qh=bg(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(Xh||(Xh=bg(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(Jh||(Jh=bg(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(ef||(ef=bg(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(tf||(tf=bg(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(nf||(nf=bg(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(rf||(rf=bg(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(af||(af=bg(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(of||(of=bg(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(sf||(sf=bg(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),$me=function(){var e=Zg(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];jg(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Zde,new Date("1970-01-01"),"",!1),new e($localize(uf||(uf=bg(["Four in a Row"]))),"P4",cve,new Date("2018-08-28"),Gme.P4()),new e($localize(cf||(cf=bg(["Awal\xe9"]))),"Awale",pse,new Date("2018-11-29"),Gme.AWALE()),new e($localize(lf||(lf=bg(["Quarto"]))),"Quarto",Gpe,new Date("2018-12-09"),Gme.QUARTO()),new e($localize(hf||(hf=bg(["Tablut"]))),"Tablut",lme,new Date("2018-12-27"),Gme.TABLUT()),new e($localize(ff||(ff=bg(["Reversi"]))),"Reversi",mge,new Date("2019-01-16"),Gme.REVERSI()),new e($localize(df||(df=bg(["Go"]))),"Go",The,new Date("2019-12-21"),Gme.GO()),new e($localize(vf||(vf=bg(["Encapsule"]))),"Encapsule",vle,new Date("2019-12-30"),Gme.ENCAPSULE()),new e($localize(pf||(pf=bg(["Siam"]))),"Siam",_ye,new Date("2020-01-11"),Gme.SIAM()),new e($localize(gf||(gf=bg(["Sahara"]))),"Sahara",Fge,new Date("2020-02-29"),Gme.SAHARA()),new e($localize(yf||(yf=bg(["Pylos"]))),"Pylos",Xve,new Date("2020-10-02"),Gme.PYLOS()),new e($localize(mf||(mf=bg(["Kamisado"]))),"Kamisado",sfe,new Date("2020-10-03"),Gme.KAMISADO()),new e($localize(kf||(kf=bg(["Quixo"]))),"Quixo",ige,new Date("2020-10-15"),Gme.QUIXO()),new e($localize(_f||(_f=bg(["Dvonn"]))),"Dvonn",$ce,new Date("2020-10-21"),Gme.DVONN()),new e($localize(Cf||(Cf=bg(["Epaminondas"]))),"Epaminondas",Ale,new Date("2021-01-16"),Gme.EPAMINONDAS()),new e($localize(wf||(wf=bg(["Gipf"]))),"Gipf",ehe,new Date("2021-02-22"),Gme.GIPF()),new e($localize(bf||(bf=bg(["Coerceo"]))),"Coerceo",Pue,new Date("2021-03-21"),Gme.COERCEO()),new e($localize(Ef||(Ef=bg(["Six"]))),"Six",Gye,new Date("2021-04-08"),Gme.SIX()),new e($localize(Sf||(Sf=bg(["Lines of Action"]))),"LinesOfAction",Cfe,new Date("2021-04-28"),Gme.LINES_OF_ACTION()),new e($localize(Pf||(Pf=bg(["Pentago"]))),"Pentago",Ive,new Date("2021-05-23"),Gme.PENTAGO()),new e($localize(Of||(Of=bg(["Abalone"]))),"Abalone",$oe,new Date("2021-07-13"),Gme.ABALONE()),new e($localize(Tf||(Tf=bg(["Yinsh"]))),"Yinsh",zme,new Date("2021-07-31"),Gme.YINSH()),new e($localize(If||(If=bg(["Apagos"]))),"Apagos",ase,new Date("2021-11-04"),Gme.APAGOS()),new e($localize(Af||(Af=bg(["Diam"]))),"Diam",vce,new Date("2021-11-30"),Gme.DIAM()),new e($localize(Rf||(Rf=bg(["Brandhub"]))),"Brandhub",Qse,new Date("2021-12-07"),Gme.BRANDHUB()),new e($localize(xf||(xf=bg(["Conspirateurs"]))),"Conspirateurs",Wue,new Date("2021-12-30"),Gme.CONSPIRATEURS()),new e($localize(Mf||(Mf=bg(["Lodestone"]))),"Lodestone",ede,new Date("2022-06-24"),Gme.LODESTONE()),new e($localize(Nf||(Nf=bg(["Martian Chess"]))),"MartianChess",Fde,new Date("2022-07-01"),Gme.MARTIAN_CHESS())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),qme=function(){var e=function(){function e(){jg(this,e),this.games=$me.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new yT}return Zg(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=$m({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(Df||(Df=bg(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"select",1),cS("change",function(e){return t.onChange(e)}),tS(2,"option",2),jP(3,3),nS(),KE(4,Hme,2,2,"option",4),nS(),nS()),2&e&&(gb(4),JE("ngForOf",t.games))},directives:[sM,hM,FA],encapsulation:2}),e}();function jme(e,t){if(1&e){var n=oS();tS(0,"div",26),tS(1,"div",27),cS("click",function(){return Dk(n),fS().closeInfo()}),nS(),tS(2,"div",28),tS(3,"header",29),tS(4,"p",30),US(5),nS(),tS(6,"button",31),cS("click",function(){return Dk(n),fS().closeInfo()}),nS(),nS(),tS(7,"section",32),tS(8,"div",6),tS(9,"div",33),tS(10,"p",34),rS(11,"img",35),nS(),nS(),tS(12,"div",7),tS(13,"div",13),US(14),nS(),nS(),nS(),tS(15,"div",6),tS(16,"div",33),tS(17,"a",36),cS("click",function(){Dk(n);var e=fS();return e.createGame(e.gameInfoDetails.get().urlName)}),rS(18,"fa-icon",37),US(19,"\xa0"),tS(20,"span"),jP(21,38),nS(),nS(),nS(),tS(22,"div",33),tS(23,"a",36),cS("click",function(){Dk(n);var e=fS();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),rS(24,"fa-icon",37),US(25,"\xa0"),tS(26,"span"),jP(27,39),nS(),nS(),nS(),tS(28,"div",33),tS(29,"a",36),cS("click",function(){Dk(n);var e=fS();return e.createTutorial(e.gameInfoDetails.get().urlName)}),rS(30,"fa-icon",37),US(31,"\xa0"),tS(32,"span"),jP(33,40),nS(),nS(),nS(),nS(),nS(),nS(),nS()}if(2&e){var r=fS();gb(5),VS(r.gameInfoDetails.get().name),gb(6),pS("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",cw),gb(3),BS(" ",r.gameInfoDetails.get().description," "),gb(4),JE("icon",r.iconOnlineGame),gb(6),JE("icon",r.iconLocalGame),gb(6),JE("icon",r.iconTutorial)}}function Wme(e,t){if(1&e){var n=oS();tS(0,"div",8),tS(1,"div",9),tS(2,"p",10),US(3),nS(),nS(),tS(4,"div",42),tS(5,"figure",34),tS(6,"img",43),cS("click",function(){var e=Dk(n).$implicit;return fS(2).openInfo(e)}),nS(),tS(7,"figcaption",44),cS("click",function(){var e=Dk(n).$implicit;return fS(2).openInfo(e)}),tS(8,"div",45),US(9,"?"),nS(),nS(),tS(10,"figcaption",46),tS(11,"a",47),cS("click",function(){var e=Dk(n).$implicit;return fS(2).createGame(e.urlName)}),rS(12,"fa-icon",37),nS(),tS(13,"a",48),cS("click",function(){var e=Dk(n).$implicit;return fS(2).createLocalGame(e.urlName)}),rS(14,"fa-icon",37),nS(),tS(15,"a",49),cS("click",function(){var e=Dk(n).$implicit;return fS(2).createTutorial(e.urlName)}),rS(16,"fa-icon",37),nS(),nS(),nS(),nS(),tS(17,"div",50),US(18),nS(),nS()}if(2&e){var r=t.$implicit,i=fS(2);gb(3),VS(r.name),gb(3),vS("id","image_",r.urlName,""),pS("src","assets/images/",i.theme,"/",r.urlName,".png",cw),gb(5),vS("id","playOnline_",r.urlName,""),gb(1),JE("icon",i.iconOnlineGame),gb(1),vS("id","playLocally_",r.urlName,""),gb(1),JE("icon",i.iconLocalGame),gb(1),vS("id","startTutorial_",r.urlName,""),gb(1),JE("icon",i.iconTutorial),gb(2),BS(" ",r.description," ")}}function Zme(e,t){if(1&e&&(tS(0,"div",7),KE(1,Wme,19,11,"div",41),nS()),2&e){var n=t.$implicit;gb(1),JE("ngForOf",n)}}var Yme=function(){var e=function(){function e(t,n){jg(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=tie,this.iconLocalGame=Jre,this.iconTutorial=Qre,this.gameInfoDetails=fB.empty(),this.theme=n.getTheme();for(var r=$me.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return Zg(e,[{key:"createGame",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=fB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=fB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL),XE(Kre))},e.\u0275cmp=$m({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Lf||(Lf=bg(["EveryBoard"]))),[1,"subtitle"],$localize(Ff||(Ff=bg(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Uf||(Uf=bg(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Vf||(Vf=bg(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Bf||(Bf=bg(["See the game list"]))),$localize(zf||(zf=bg(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Hf||(Hf=bg(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Gf||(Gf=bg(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize($f||($f=bg(["Play online"]))),$localize(qf||(qf=bg(["Play offline"]))),$localize(jf||(jf=bg(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(Wf||(Wf=bg(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(Zf||(Zf=bg(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(Yf||(Yf=bg(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(tS(0,"section",0),tS(1,"div",1),tS(2,"p",2),jP(3,3),nS(),tS(4,"p",4),$P(5,5),rS(6,"br"),qP(),nS(),nS(),tS(7,"div",6),tS(8,"div",7),tS(9,"div",8),tS(10,"header",9),tS(11,"p",10),jP(12,11),nS(),nS(),tS(13,"div",12),tS(14,"div",13),tS(15,"button",14),jP(16,15),nS(),tS(17,"button",16),jP(18,17),nS(),nS(),nS(),nS(),nS(),tS(19,"div",7),tS(20,"div",8),tS(21,"header",9),tS(22,"p",10),jP(23,18),nS(),nS(),tS(24,"div",12),tS(25,"div",19),tS(26,"button",20),jP(27,21),nS(),tS(28,"button",22),jP(29,23),nS(),nS(),nS(),nS(),nS(),nS(),KE(30,jme,34,7,"div",24),tS(31,"div",6),KE(32,Zme,2,1,"div",25),nS(),nS()),2&e&&(gb(30),JE("ngIf",t.gameInfoDetails.isPresent()),gb(2),JE("ngForOf",t.games))},directives:[QL,VA,FA,Oae],encapsulation:2}),e}(),Kme=function(){var e=function(){function e(t){jg(this,e),this.element=t}return Zg(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(cO))},e.\u0275dir=Km({type:e,selectors:[["","autofocus",""]]}),e}(),Qme=function(){var e=function(){function e(t){var n=this;jg(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return Zg(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(cO))},e.\u0275dir=Km({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Xme(e,t){if(1&e&&(tS(0,"div",29),tS(1,"div",30),jP(2,31),nS(),tS(3,"div",32),US(4),nS(),nS()),2&e){var n=fS();gb(4),VS(n.errorMessage)}}var Jme=function(){return["/register"]},eke=function(){return["/reset-password"]},tke=function(){var e=function(){function e(t,n){jg(this,e),this.router=t,this.connectedUserService=n,this.faEye=eie,this.loginForm=new zx({email:new Bx,password:new Bx})}return Zg(e,[{key:"ngOnInit",value:function(){var e,t=this;this.connectedUserService.getUserObs().subscribe((e=oB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==Ore.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL),XE(Tre))},e.\u0275cmp=$m({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(Kf||(Kf=bg(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Qf||(Qf=bg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(Xf||(Xf=bg(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(Jf||(Jf=bg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(ed||(ed=bg(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(td||(td=bg(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(nd||(nd=bg(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(rd||(rd=bg(["No account?"]))),[3,"routerLink"],$localize(id||(id=bg(["Register"]))),$localize(ad||(ad=bg(["Forgot your password?"]))),$localize(od||(od=bg(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(sd||(sd=bg(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"p",1),jP(2,2),nS(),tS(3,"form",3),tS(4,"div",4),tS(5,"div",5),tS(6,"label",6),jP(7,7),nS(),nS(),tS(8,"div",8),tS(9,"div",9),tS(10,"div",10),rS(11,"input",11),nS(),nS(),nS(),nS(),tS(12,"div",4),tS(13,"div",5),tS(14,"label",12),jP(15,13),nS(),nS(),tS(16,"div",8),tS(17,"div",9),tS(18,"div",14),rS(19,"input",15),tS(20,"span",16),rS(21,"fa-icon",17),nS(),nS(),nS(),nS(),nS(),tS(22,"div",4),rS(23,"div",5),tS(24,"div",8),tS(25,"div",9),tS(26,"div",10),tS(27,"button",18),cS("click",function(){return t.loginWithEmail(t.loginForm.value)}),jP(28,19),nS(),nS(),nS(),nS(),nS(),tS(29,"div",4),rS(30,"div",5),tS(31,"div",8),tS(32,"div",9),tS(33,"div",10),tS(34,"button",20),cS("click",function(){return t.loginWithGoogle()}),jP(35,21),nS(),nS(),nS(),nS(),nS(),KE(36,Xme,5,1,"div",22),tS(37,"p",23),iS(38),jP(39,24),aS(),US(40,"\xa0 "),tS(41,"a",25),jP(42,26),nS(),nS(),tS(43,"p",23),iS(44),jP(45,27),aS(),US(46,"\xa0 "),tS(47,"a",25),jP(48,28),nS(),nS(),nS(),nS()),2&e&&(gb(3),JE("formGroup",t.loginForm),gb(18),JE("icon",t.faEye),gb(6),JE("disabled",!t.canLogin()),gb(9),JE("ngIf",t.errorMessage),gb(5),JE("routerLink",oT(6,Jme)),gb(6),JE("routerLink",oT(7,eke)))},directives:[Yx,yx,tM,BR,gx,rM,Kme,dM,Oae,Qme,VA,XL],encapsulation:2}),e}(),nke=function(){var e=function(){function e(t){jg(this,e),this.partDAO=t,this.unsubscribe=fB.empty(),this.activePartsBS=new rN([]),this.activePartsObs=this.activePartsBS.asObservable()}return Zg(e,[{key:"getActivePartsObs",value:function(){return this.activePartsObs}},{key:"startObserving",value:function(){var e=this;D7(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");var t=new H7(function(t){var n,r=(n=e.activePartsBS.value).concat.apply(n,zg(t));e.activePartsBS.next(r)},function(t){var n,r=e.activePartsBS.value,i=Gg(t);try{var a=function(){var e=n.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)},function(t){var n,r=[],i=Gg(e.activePartsBS.value);try{var a=function(){var e=n.value;t.some(function(t){return t.id===e.id})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)});this.unsubscribe=fB.of(this.partDAO.observeActiveParts(t))}},{key:"stopObserving",value:function(){D7(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=fB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(U7))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),rke=function(){var e=function(){function e(t){jg(this,e),this.router=t}return Zg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL))},e.\u0275cmp=$m({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ud||(ud=bg(["Create an online game"])))]},template:function(e,t){1&e&&(tS(0,"app-pick-game",0),cS("pickGame",function(e){return t.pickGame(e)}),nS(),tS(1,"button",1),cS("click",function(){return t.navigateToOnlineGameCreation()}),jP(2,2),nS()),2&e&&(gb(1),JE("disabled",!t.selectedGame))},directives:[qme],encapsulation:2}),e}(),ike=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"transform",value:function(e){return gA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Qm({name:"firebaseDate",type:e,pure:!0}),e}(),ake=["chatDiv"];function oke(e,t){1&e&&(iS(0),jP(1,5),aS())}function ske(e,t){1&e&&jP(0,6),2&e&&(WP(fS().unreadMessagesText),ZP(0))}function uke(e,t){if(1&e){var n=oS();tS(0,"button",11),cS("click",function(){return Dk(n),fS(2).scrollToBottom()}),US(1),nS()}if(2&e){var r=fS(2);gb(1),BS("",r.unreadMessagesText," \u2193")}}function cke(e,t){if(1&e&&(tS(0,"p"),US(1),fT(2,"firebaseDate"),tS(3,"b",12),US(4),nS(),tS(5,"span",13),US(6),nS(),nS()),2&e){var n=t.$implicit;gb(1),BS(" [",dT(2,3,n.postedTime),"] "),gb(3),BS("",n.sender.name," : "),gb(2),VS(n.content)}}function lke(e,t){if(1&e){var n=oS();tS(0,"div"),KE(1,uke,2,1,"button",7),tS(2,"div",8,9),cS("scroll",function(){return Dk(n),fS().updateCurrentScrollPosition()}),KE(4,cke,7,5,"p",10),nS(),nS()}if(2&e){var r=fS();gb(1),JE("ngIf",r.showUnreadMessagesButton),gb(3),JE("ngForOf",r.chat)}}var hke=function(){return{standalone:!0}};function fke(e,t){if(1&e){var n=oS();tS(0,"form",14),cS("onSubmit",function(){return Dk(n),fS().sendMessage()}),tS(1,"div",15),tS(2,"div",16),tS(3,"input",17,18),cS("ngModelChange",function(e){return Dk(n),fS().userMessage=e}),nS(),tS(5,"p",19),US(6),nS(),nS(),tS(7,"div",20),tS(8,"button",21),cS("click",function(){return Dk(n),fS().sendMessage()}),rS(9,"fa-icon",22),nS(),nS(),nS(),tS(10,"div",23),tS(11,"p"),tS(12,"strong"),jP(13,24),nS(),nS(),nS(),nS()}if(2&e){var r=QE(4),i=fS();gb(3),JE("ngModel",i.userMessage)("ngModelOptions",oT(4,hke)),gb(3),BS("",r.value.length,"/128"),gb(3),JE("icon",i.faReply)}}var dke=function(){var e=function(){function e(t,n){jg(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=nie,this.isNearBottom=!0,this.notYetScrolled=!0,uB(e.VERBOSE,"ChatComponent constructor")}return Zg(e,[{key:"ngOnInit",value:function(){uB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),D7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new H7(t,t,function(){});this.chatService.startObserving(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(cd||(cd=bg(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(ld||(ld=bg(["1 new message"]))):$localize(hd||(hd=bg([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatService.stopObserving()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(z7),XE(Tre))},e.\u0275cmp=$m({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&AT(ake,5),2&e)&&(IT(n=RT())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(fd||(fd=bg(["Hide chat"]))),$localize(dd||(dd=bg(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(vd||(vd=bg(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(pd||(pd=bg(["Be polite"])))]},template:function(e,t){if(1&e&&(tS(0,"div"),tS(1,"button",0),cS("click",function(){return t.switchChatVisibility()}),KE(2,oke,2,0,"ng-container",1),KE(3,ske,1,1,"ng-template",null,2,MT),nS(),KE(5,lke,5,2,"div",3),KE(6,fke,14,5,"form",4),nS()),2&e){var n=QE(4);gb(2),JE("ngIf",t.visible)("ngIfElse",n),gb(3),JE("ngIf",t.visible),gb(1),JE("ngIf",t.visible)}},directives:[VA,FA,Yx,yx,qx,BR,pM,gx,Zx,Oae],pipes:[ike],encapsulation:2}),e}();function vke(e,t){if(1&e&&(iS(0),US(1),aS()),2&e){var n=fS().$implicit;gb(1),VS(n.data.playerOne)}}function pke(e,t){1&e&&(iS(0),jP(1,26),aS())}function gke(e,t){if(1&e){var n=oS();tS(0,"tr",22),cS("click",function(){var e=Dk(n).$implicit;return fS(2).joinGame(e.id,e.data.typeGame)}),tS(1,"td",23),US(2),nS(),tS(3,"td",23),US(4),nS(),tS(5,"td",23),KE(6,vke,2,1,"ng-container",24),KE(7,pke,2,0,"ng-template",null,25,MT),nS(),tS(9,"td",23),US(10),nS(),nS()}if(2&e){var r=t.$implicit,i=t.index,a=QE(8);vS("id","part_",i,""),gb(2),VS(r.data.typeGame),gb(2),VS(r.data.playerZero),gb(2),JE("ngIf",r.data.playerOne)("ngIfElse",a),gb(4),VS(r.data.turn)}}function yke(e,t){if(1&e&&(tS(0,"div",13),tS(1,"div",14),tS(2,"table",15),tS(3,"thead"),tS(4,"tr"),tS(5,"th",16),jP(6,17),nS(),tS(7,"th",16),jP(8,18),nS(),tS(9,"th",16),jP(10,19),nS(),tS(11,"th",16),jP(12,20),nS(),nS(),nS(),tS(13,"tbody"),KE(14,gke,11,6,"tr",21),nS(),nS(),nS(),nS()),2&e){var n=fS();gb(14),JE("ngForOf",n.activeParts)}}function mke(e,t){1&e&&(tS(0,"div",27),rS(1,"app-online-game-selection",28),nS())}function kke(e,t){if(1&e&&(tS(0,"li",39),US(1),fT(2,"firebaseDate"),nS()),2&e){var n=fS().$implicit;dS("id",n.data.username),gb(1),zS("",n.data.username,": ",dT(2,3,n.data.last_changed),"")}}function _ke(e,t){if(1&e&&(iS(0),KE(1,kke,3,5,"li",38),aS()),2&e){var n=t.$implicit;gb(1),JE("ngIf",n.data.last_changed)}}function Cke(e,t){if(1&e&&(tS(0,"div",29),tS(1,"div",30),tS(2,"div",31),rS(3,"app-chat",32),nS(),nS(),tS(4,"div",33),tS(5,"div",34),tS(6,"p"),jP(7,35),nS(),tS(8,"ul",36),KE(9,_ke,2,1,"ng-container",37),nS(),nS(),nS(),nS()),2&e){var n=fS();gb(3),JE("turn",-1),gb(6),JE("ngForOf",n.activeUsers)}}var wke=function(){var e=function(){function e(t,n,r){jg(this,e),this.router=t,this.userService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return Zg(e,[{key:"ngOnInit",value:function(){var t=this;uB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(function(e){t.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){uB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}},{key:"joinGame",value:function(e,t){var n=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(YL),XE(q7),XE(nke))},e.\u0275cmp=$m({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(gd||(gd=bg(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(yd||(yd=bg(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(md||(md=bg(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(kd||(kd=bg(["Game"]))),$localize(_d||(_d=bg(["First player"]))),$localize(Cd||(Cd=bg(["Second player"]))),$localize(wd||(wd=bg(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(bd||(bd=bg(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize(Ed||(Ed=bg(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"ul"),tS(2,"li",1),tS(3,"a",2),cS("click",function(){return t.selectTab("games")}),jP(4,3),nS(),nS(),tS(5,"li",4),tS(6,"a",5),cS("click",function(){return t.selectTab("create")}),jP(7,6),nS(),nS(),tS(8,"li",7),tS(9,"a",8),cS("click",function(){return t.selectTab("chat")}),jP(10,9),nS(),nS(),nS(),nS(),KE(11,yke,15,1,"div",10),KE(12,mke,2,0,"div",11),KE(13,Cke,10,2,"div",12)),2&e&&(gb(11),JE("ngIf","games"===t.currentTab),gb(1),JE("ngIf","create"===t.currentTab),gb(1),JE("ngIf","chat"===t.currentTab))},directives:[DA,VA,FA,rke,dke],pipes:[ike],encapsulation:2}),e}(),bke=function(){var e=Zg(function e(t){var n;jg(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(Sd||(Sd=bg(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(XE(TD))},e.\u0275cmp=$m({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Pd||(Pd=bg(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"div",1),jP(2,2),nS(),tS(3,"div",3),US(4),nS(),nS()),2&e&&(gb(4),VS(t.message))},encapsulation:2}),e}();function Eke(e,t){}var Ske=function(){var e=Zg(function e(t){jg(this,e),this.viewContainerRef=t,uB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(jO))},e.\u0275cmp=$m({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&KE(0,Eke,0,0,"ng-template")},encapsulation:2}),e}(),Pke=function(){var e=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(Od||(Od=bg(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(Td||(Td=bg(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Id||(Id=bg(["You cannot clone a game. This feature might be implemented later."])))},e}(),Oke=function(){var e=function(){function e(t,n,r,i,a){jg(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[fB.empty(),fB.empty()],this.endGame=!1,uB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return Zg(e,[{key:"getMatchingComponent",value:function(t){return uB(e.VERBOSE,"GameWrapper.getMatchingComponent"),fB.ofNullable($me.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return uB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&t.gameComponent.rules.setInitialBoard(),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(uB(e.VERBOSE,"GameWrapper.createGameComponent"),r=sB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",Pke.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return D7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.gameComponent.observerRole=t.observerRole,t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(uB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",A7.failure(Pke.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",A7.failure($localize(Ad||(Ad=bg(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),A7.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:uB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=A7.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===Lre.NONE.value){var t=Pke.NO_CLONING_FEATURE();return A7.failure(t)}return this.isPlayerTurn()?A7.SUCCESS:A7.failure(Pke.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===Lre.NONE.value||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayerName();return uB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,username:r,observer:this.observerRole,areYouPlayer:this.players[n].equalsValue(r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(aO),XE(TD),XE(Tre),XE(YL),XE(M7))},e.\u0275cmp=$m({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&AT(Ske,5),2&e)&&(IT(n=RT())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Tke=function(){function e(t,n,r){jg(this,e),this.added=t,this.modified=n,this.removed=r}return Zg(e,[{key:"addNewKeys",value:function(e,t){var n,r=Gg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=Gg(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{D7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),D7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=Gg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Sg({},n),r;if(null==n)return r.removed=Sg({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function Ike(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Ake(e,t){return Ike(t)-Ike(e)}function Rke(e){return Ey(function(t,n){By(e).subscribe(new Sy(n,function(){return n.complete()},ay)),!n.closed&&t.subscribe(n)})}var xke=function(){var e=function(){function e(){jg(this,e)}return Zg(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Rd||(Rd=bg([""," hours"])),r)):1===r&&i.push($localize(xd||(xd=bg(["1 hour"])))),n>1?i.push($localize(Md||(Md=bg([""," minutes"])),n)):1===n&&i.push($localize(Nd||(Nd=bg(["1 minute"])))),t>1?i.push($localize(Dd||(Dd=bg([""," seconds"])),t)):1===t&&i.push($localize(Ld||(Ld=bg(["1 second"])))),0===i.length)return $localize(Fd||(Fd=bg(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(Ud||(Ud=bg([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Qm({name:"humanDuration",type:e,pure:!0}),e}();function Mke(e,t){if(1&e&&(iS(0),US(1),aS()),2&e){var n=fS(3);gb(1),VS(n.viewInfo.chosenOpponent)}}function Nke(e,t){1&e&&jP(0,44)}function Dke(e,t){if(1&e&&(tS(0,"div",45),tS(1,"div",8),tS(2,"label",46),iS(3),jP(4,47),aS(),tS(5,"output"),US(6),fT(7,"humanDuration"),nS(),nS(),tS(8,"div",37),rS(9,"input",48),nS(),nS(),tS(10,"div",8),tS(11,"label",49),$P(12,50),rS(13,"output"),fT(14,"humanDuration"),qP(),nS(),tS(15,"div",37),rS(16,"input",51),nS(),nS(),nS()),2&e){var n=fS(3);gb(6),VS(dT(7,2,n.viewInfo.maximalMoveDuration||0)),gb(8),WP(dT(14,4,n.viewInfo.totalPartDuration||0)),ZP(12)}}function Lke(e,t){1&e&&(tS(0,"div"),$P(1,52),rS(2,"br"),qP(),nS())}function Fke(e,t){1&e&&(tS(0,"button",64),jP(1,65),nS())}function Uke(e,t){if(1&e){var n=oS();tS(0,"tr",60),cS("click",function(){var e=Dk(n).$implicit;return fS(4).selectOpponent(e)}),tS(1,"td",61),US(2),nS(),tS(3,"td",62),KE(4,Fke,2,0,"button",63),nS(),nS()}if(2&e){var r=t.$implicit,i=fS(4);vS("id","presenceOf_",r,""),JE("ngClass",i.viewInfo.candidateClasses[r]),gb(1),JE("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),gb(1),VS(r),gb(2),JE("ngIf",i.viewInfo.chosenOpponent!==r)}}function Vke(e,t){if(1&e&&(iS(0),jP(1,53),aS(),tS(2,"div",54),tS(3,"table",55),tS(4,"thead"),tS(5,"tr"),tS(6,"th",56),jP(7,57),nS(),tS(8,"th",56),jP(9,58),nS(),nS(),nS(),tS(10,"tbody"),KE(11,Uke,5,5,"tr",59),nS(),nS(),nS()),2&e){var n=fS(3);gb(11),JE("ngForOf",n.viewInfo.candidates)}}function Bke(e,t){if(1&e){var n=oS();tS(0,"button",66),cS("click",function(){return Dk(n),fS(3).changeConfig()}),jP(1,67),nS()}}function zke(e,t){if(1&e){var n=oS();tS(0,"div"),tS(1,"h1",4),jP(2,5),nS(),tS(3,"form",6),tS(4,"fieldset",7),tS(5,"div",8),tS(6,"label",9),jP(7,10),nS(),tS(8,"div",11),tS(9,"button",12),cS("click",function(){return Dk(n),fS(2).selectFirstPlayer("RANDOM")}),jP(10,13),nS(),tS(11,"button",14),cS("click",function(){return Dk(n),fS(2).selectFirstPlayer("CREATOR")}),jP(12,15),nS(),tS(13,"button",16),cS("click",function(){return Dk(n),fS(2).selectFirstPlayer("CHOSEN_PLAYER")}),KE(14,Mke,2,1,"ng-container",17),KE(15,Nke,1,0,"ng-template",null,18,MT),nS(),nS(),nS(),tS(17,"div",8),tS(18,"label",9),jP(19,19),nS(),tS(20,"div",11),tS(21,"div",20),cS("click",function(){return Dk(n),fS(2).selectPartType("STANDARD")}),tS(22,"div",21),tS(23,"span"),jP(24,22),nS(),nS(),tS(25,"div",23),tS(26,"div",24),tS(27,"div",25),tS(28,"p"),iS(29),jP(30,26),aS(),tS(31,"strong"),US(32),fT(33,"humanDuration"),nS(),rS(34,"br"),iS(35),$P(36,27),rS(37,"strong"),fT(38,"humanDuration"),qP(),aS(),nS(),nS(),nS(),nS(),nS(),tS(39,"div",28),cS("click",function(){return Dk(n),fS(2).selectPartType("BLITZ")}),tS(40,"div",21),tS(41,"span"),jP(42,29),nS(),nS(),tS(43,"div",23),tS(44,"div",24),tS(45,"div",25),tS(46,"p"),iS(47),jP(48,30),aS(),tS(49,"strong"),US(50),fT(51,"humanDuration"),nS(),rS(52,"br"),iS(53),$P(54,31),rS(55,"strong"),fT(56,"humanDuration"),qP(),aS(),nS(),nS(),nS(),nS(),nS(),tS(57,"button",32),cS("click",function(){return Dk(n),fS(2).selectPartType("CUSTOM")}),jP(58,33),nS(),nS(),nS(),KE(59,Dke,17,6,"div",34),tS(60,"div",8),tS(61,"label",35),jP(62,36),nS(),tS(63,"div",37),KE(64,Lke,3,0,"div",17),KE(65,Vke,12,1,"ng-template",null,38,MT),nS(),nS(),nS(),tS(67,"div",8),tS(68,"div",11),tS(69,"button",39),cS("click",function(){return Dk(n),fS(2).proposeConfig()}),jP(70,40),nS(),KE(71,Bke,2,0,"button",41),tS(72,"button",42),cS("click",function(){return Dk(n),fS(2).cancelGameCreation()}),jP(73,43),nS(),nS(),nS(),nS(),nS()}if(2&e){var r=QE(16),i=QE(66),a=fS(2);gb(3),JE("formGroup",a.configFormGroup),gb(1),JE("disabled",!a.viewInfo.canEditConfig),gb(5),JE("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),gb(2),JE("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),gb(2),JE("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),gb(1),JE("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),gb(7),JE("ngClass",a.viewInfo.partTypeClasses.STANDARD),gb(11),VS(dT(33,19,a.partType.NORMAL_MOVE_DURATION)),gb(6),WP(dT(38,21,a.partType.NORMAL_PART_DURATION)),ZP(36),gb(1),JE("ngClass",a.viewInfo.partTypeClasses.BLITZ),gb(11),VS(dT(51,23,a.partType.BLITZ_MOVE_DURATION)),gb(6),WP(dT(56,25,a.partType.BLITZ_PART_DURATION)),ZP(54),gb(1),JE("ngClass",a.viewInfo.partTypeClasses.CUSTOM),gb(2),JE("ngIf",a.viewInfo.showCustomTime),gb(5),JE("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),gb(5),JE("disabled",!a.viewInfo.canProposeConfig),gb(2),JE("ngIf",a.viewInfo.canReviewConfig)}}function Hke(e,t){if(1&e&&(tS(0,"div",74),tS(1,"p"),$P(2,75),rS(3,"br"),qP(),nS(),nS()),2&e){var n=fS(3);gb(3),WP(n.viewInfo.creator),ZP(2)}}function Gke(e,t){if(1&e&&(tS(0,"span"),jP(1,81),nS()),2&e){var n=fS(4);gb(1),WP(n.viewInfo.creator),ZP(1)}}function $ke(e,t){1&e&&(tS(0,"span"),jP(1,82),nS())}function qke(e,t){1&e&&(tS(0,"span"),jP(1,83),nS())}function jke(e,t){if(1&e){var n=oS();tS(0,"div",74),tS(1,"p"),jP(2,76),nS(),tS(3,"ul"),tS(4,"li"),KE(5,Gke,2,1,"span",2),KE(6,$ke,2,0,"span",2),KE(7,qke,2,0,"span",2),nS(),tS(8,"li"),$P(9,77),rS(10,"strong"),fT(11,"humanDuration"),qP(),nS(),tS(12,"li"),$P(13,78),rS(14,"strong"),fT(15,"humanDuration"),qP(),nS(),nS(),tS(16,"button",79),cS("click",function(){return Dk(n),fS(3).acceptConfig()}),jP(17,80),nS(),nS()}if(2&e){var r=fS(3);gb(2),WP(r.viewInfo.creator)(r.viewInfo.partTypeName),ZP(2),gb(3),JE("ngIf","CREATOR"===r.viewInfo.firstPlayer),gb(1),JE("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),gb(1),JE("ngIf","RANDOM"===r.viewInfo.firstPlayer),gb(4),WP(dT(11,7,r.viewInfo.maximalMoveDuration||0)),ZP(9),gb(4),WP(dT(15,9,r.viewInfo.totalPartDuration||0)),ZP(13)}}function Wke(e,t){if(1&e&&(tS(0,"div"),tS(1,"div",68),tS(2,"div",69),tS(3,"p"),jP(4,70),nS(),nS(),tS(5,"div",71),KE(6,Hke,4,1,"div",72),KE(7,jke,18,11,"ng-template",null,73,MT),nS(),nS(),nS()),2&e){var n=QE(8),r=fS(2);gb(6),JE("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Zke(e,t){if(1&e&&(iS(0),jP(1,86),aS()),2&e){var n=fS(3);gb(1),WP(n.viewInfo.creator),ZP(1)}}function Yke(e,t){if(1&e&&jP(0,87),2&e){var n=fS(3);WP(n.viewInfo.creator)(n.viewInfo.chosenOpponent),ZP(0)}}function Kke(e,t){if(1&e&&(tS(0,"div",68),tS(1,"div",69),tS(2,"p"),jP(3,84),nS(),nS(),tS(4,"div",71),tS(5,"p"),KE(6,Zke,2,1,"ng-container",17),KE(7,Yke,1,2,"ng-template",null,85,MT),nS(),nS(),nS()),2&e){var n=QE(8),r=fS(2);gb(6),JE("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Qke(e,t){if(1&e&&(tS(0,"div",1),KE(1,zke,74,27,"div",2),KE(2,Wke,9,2,"div",2),KE(3,Kke,9,2,"div",3),nS()),2&e){var n=fS();gb(1),JE("ngIf",n.viewInfo.userIsCreator),gb(1),JE("ngIf",n.viewInfo.userIsChosenOpponent),gb(1),JE("ngIf",n.viewInfo.userIsObserver)}}var Xke=function(){function e(t,n,r,i,a,o,s,u){jg(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.joinerService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=Are,this.gameStartNotification=new yT,this.gameStarted=!1,this.gameExists=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentJoiner=null,this.ngUnsubscribe=new Cy,this.allUserInterval=fB.empty(),this.ownTokenInterval=fB.empty(),this.selfSubscription=function(){},this.allDocDeleted=!1,uB(e.VERBOSE,"PartCreationComponent constructed")}return Zg(e,[{key:"ngOnInit",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return uB(e.VERBOSE,"PartCreationComponent.ngOnInit for "+t.connectedUserService.user.get().username.get()),t.checkInputs(),t.createForms(),r=t.connectedUserService.user.get().toMinimalUser(),n.next=4,t.joinerService.joinGame(t.partId,r);case 4:if(!(i=n.sent).isFailure()){n.next=10;break}a=i.getReason(),t.messageDisplayer.criticalMessage(a),n.next=18;break;case 10:return n.next=12,t.updateUserDocWithObservedPart();case 12:return n.next=14,t.startSendingPresenceTokens();case 14:t.gameExists=!0,t.subscribeToJoinerDoc(),t.subscribeToFormElements(),uB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 18:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;D7(e.isPresent()&&e.get()!==Ore.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),D7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Ire.RANDOM.value,jR.required],maximalMoveDuration:[Are.NORMAL_MOVE_DURATION,jR.required],partType:["STANDARD",jR.required],totalPartDuration:[Are.NORMAL_PART_DURATION,jR.required],chosenOpponent:["",jR.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return uB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToJoinerDoc",value:function(){var e,t=this,n=(e=oB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentJoinerUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)});this.joinerService.subscribeToChanges(this.partId,n)}},{key:"getForm",value:function(e){return sB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(Rke(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=sB.getNonNullable(e.currentJoiner).partStatus;e.viewInfo.canProposeConfig=n!==Rre.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(Rke(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(Rke(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(Rke(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(Rke(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=sB.getNonNullable(this.currentJoiner),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===Rre.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==Rre.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==Rre.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=n.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Vd||(Vd=bg(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(Bd||(Bd=bg(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(zd||(zd=bg(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===e.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(Are.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Are.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(Are.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Are.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return uB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.joinerService.setChosenOpponent(i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=sB.getNonNullable(this.currentJoiner).candidates.find(function(t){return t.name===e});return sB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.joinerService.reviewConfig());case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.joinerService.proposeConfig(s,Are.of(r),i,Ire.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return uB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return uB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.joinerService.deleteJoiner();case 9:return uB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and joiner deleted"),n.next=12,t.gameService.deletePart(t.partId);case 12:uB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, joiner, and part deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentJoinerUpdate",value:function(t){var n=this;return oB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(uB(e.VERBOSE,{PartCreationComponent_onCurrentJoinerUpdate:{before:JSON.stringify(n.currentJoiner),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(uB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=sB.getNonNullable(n.currentJoiner),a=sB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(Hd||(Hd=bg([""," left the game, please pick another opponent."])),a))),n.currentJoiner=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observeNeededPlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(uB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentJoiner&&null!=this.currentJoiner.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return uB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(Gd||(Gd=bg(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return sB.getNonNullable(this.currentJoiner).partStatus===Rre.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=sB.getNonNullable(this.currentJoiner);uB(e.VERBOSE,{partCreationComponent_onGameStarted:{joiner:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,uB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observeNeededPlayers",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=sB.getNonNullable(t.currentJoiner),i=t.connectedUserService.user.get().id,uB(e.VERBOSE,{PartCreationComponent_updateJoiner:{joiner:r}}),t.allUserInterval=fB.of(window.setInterval(oB(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=sB.getNonNullable(t.currentJoiner),r=t.lastToken,i!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(r);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(r);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 2:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=sB.getNonNullable(t.currentJoiner),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(0==(sB.getNonNullable(e.currentJoiner).partStatus===Rre.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),D7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=sB.getNonNullable(t.currentJoiner),i=Gg(r.candidates),n.prev=2,i.s();case 4:if((a=i.n()).done){n.next=14;break}return o=a.value,n.next=8,t.didUserTimeout(o.id,e);case 8:if(n.t0=n.sent,!n.t0){n.next=12;break}return n.next=12,t.removeCandidateFromLobby(o.id);case 12:n.next=4;break;case 14:n.next=19;break;case 16:n.prev=16,n.t1=n.catch(2),i.e(n.t1);case 19:return n.prev=19,i.f(),n.finish(19);case 22:case"end":return n.stop()}},n,null,[[2,16,19,22]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return oB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastChanged(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(N7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Ake(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:D7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=fB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){D7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.last_changed&&(t.lastToken=n.last_changed)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=fB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return D7(-1!==(i=sB.getNonNullable(t.currentJoiner)).candidates.findIndex(function(t){return t.id===e}),"PartCreationComponent: attempting to remove a user not in the lobby"),a=i.candidates.filter(function(t){return t.id!==e}),n.abrupt("return",(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id)===e?t.joinerService.reviewConfigAndRemoveChosenOpponentAndUpdateCandidates(a):t.joinerService.updateCandidates(a));case 4:case"end":return n.stop()}},n)}))()}},{key:"acceptConfig",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(uB(e.VERBOSE,"PartCreationComponent.acceptConfig"),t.gameService.acceptConfig(t.partId,sB.getNonNullable(t.currentJoiner))));case 1:case"end":return n.stop()}},n)}))()}},{key:"ngOnDestroy",value:function(){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(uB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),t.gameExists&&t.joinerService.unsubscribe(),r=t.connectedUserService.user.get(),!0===t.gameStarted){n.next=18;break}if(null!==t.currentJoiner){n.next=5;break}return n.abrupt("return",void uB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"));case 5:if(r.id!==t.currentJoiner.creator.id){n.next=11;break}return uB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=9,t.cancelGameCreation();case 9:n.next=18;break;case 11:if(n.t0=!1===t.allDocDeleted,!n.t0){n.next=18;break}return uB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(joiner) about to cancel game joining"),n.next=16,t.connectedUserService.removeObservedPart();case 16:return n.next=18,t.joinerService.cancelJoining(r.toMinimalUser());case 18:case"end":return n.stop()}},n)}))()}}]),e}();function Jke(e,t){if(1&e){var n=oS();tS(0,"button",3),cS("click",function(){return Dk(n),fS().addTime()}),jP(1,4),nS()}if(2&e){var r=fS();gb(1),WP(r.timeToAdd),ZP(1)}}Xke.VERBOSE=!1,Xke.TOKEN_INTERVAL=5e3,Xke.TOKEN_TIMEOUT=2*Xke.TOKEN_INTERVAL,Xke.\u0275fac=function(e){return new(e||Xke)(XE(YL),XE(Tre),XE($re),XE(Gre),XE(z7),XE(q7),XE(kM),XE(M7))},Xke.\u0275cmp=$m({type:Xke,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize($d||($d=bg(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(qd||(qd=bg(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(jd||(jd=bg(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(Wd||(Wd=bg(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(Zd||(Zd=bg(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(Yd||(Yd=bg(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(Kd||(Kd=bg(["Maximal turn duration: "]))),$localize(Qd||(Qd=bg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(Xd||(Xd=bg(["Blitz"]))),$localize(Jd||(Jd=bg(["Maximal turn duration: "]))),$localize(ev||(ev=bg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(tv||(tv=bg(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(nv||(nv=bg(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(rv||(rv=bg(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(iv||(iv=bg(["Cancel game"]))),$localize(av||(av=bg(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(ov||(ov=bg(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(sv||(sv=bg(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(uv||(uv=bg(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(cv||(cv=bg(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(lv||(lv=bg(["Name"]))),$localize(hv||(hv=bg(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(fv||(fv=bg(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(dv||(dv=bg(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(vv||(vv=bg(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(pv||(pv=bg(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(gv||(gv=bg(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(yv||(yv=bg(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(mv||(mv=bg(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(kv||(kv=bg(["Accept and start"]))),$localize(_v||(_v=bg(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Cv||(Cv=bg(["you play first"]))),$localize(wv||(wv=bg(["the first player is selected randomly"]))),$localize(bv||(bv=bg(["One moment..."]))),["proposalSent",""],$localize(Ev||(Ev=bg(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Sv||(Sv=bg(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&KE(0,Qke,4,3,"div",0),2&e&&JE("ngIf",t.viewInfo)},directives:[VA,Yx,yx,tM,DA,BR,Xx,gx,rM,FA],pipes:[xke],encapsulation:2});var e_e=function(){var e=function(){function e(){jg(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new yT,this.addTimeToOpponent=new yT,this.cssClasses=e.SAFE_TIME}return Zg(e,[{key:"ngOnInit",value:function(){uB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(uB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(uB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(uB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){uB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(uB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(uB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){uB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=$m({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Pv||(Pv=bg(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"p",1),US(2),fT(3,"number"),nS(),KE(4,Jke,2,1,"button",2),nS()),2&e&&(JE("ngClass",t.getTimeClass()),gb(2),zS("",t.displayedMinute,":",function(e,t,n,r){var i=Mk(),a=Ek(i,23);return pT(i,vT(i,23)?hT(i,$k(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),gb(2),JE("ngIf",t.canAddTime))},directives:[DA,VA],pipes:[HA],encapsulation:2}),e}(),t_e=["partCreation"],n_e=["chatComponent"],r_e=["chronoZeroGlobal"],i_e=["chronoOneGlobal"],a_e=["chronoZeroTurn"],o_e=["chronoOneTurn"];function s_e(e,t){if(1&e){var n=oS();tS(0,"app-part-creation",5,6),cS("gameStartNotification",function(e){return Dk(n),fS().startGame(e)}),nS()}2&e&&JE("partId",fS().currentPartId)}function u_e(e,t){1&e&&(iS(0),jP(1,40),aS())}function c_e(e,t){if(1&e&&(iS(0),jP(1,41),aS()),2&e){var n=fS(4);gb(1),WP(n.currentPlayer),ZP(1)}}function l_e(e,t){if(1&e&&(tS(0,"p",37),KE(1,u_e,2,0,"ng-container",38),KE(2,c_e,2,1,"ng-template",null,39,MT),nS()),2&e){var n=QE(3),r=fS(3);gb(1),JE("ngIf",r.currentPlayer===r.getPlayerName())("ngIfElse",n)}}function h_e(e,t){if(1&e&&(tS(0,"div",33),tS(1,"p",34),jP(2,35),nS(),KE(3,l_e,4,2,"p",36),nS()),2&e){var n=fS(2);gb(2),WP(n.currentPart.getTurn()+1),ZP(2),gb(1),JE("ngIf",!1===n.endGame)}}function f_e(e,t){if(1&e&&(tS(0,"p",42),US(1),nS()),2&e){var n=fS(2);JE("ngClass",n.getPlayerNameClass(0)),gb(1),VS(n.players[0].get())}}function d_e(e,t){if(1&e&&(tS(0,"p",43),jP(1,44),nS()),2&e){var n=fS(2);gb(1),WP(n.gameComponent.scores.get()[0]),ZP(1)}}function v_e(e,t){if(1&e&&(tS(0,"p",45),US(1),nS()),2&e){var n=fS(2);JE("ngClass",n.getPlayerNameClass(1)),gb(1),VS(n.players[1].get())}}function p_e(e,t){if(1&e&&(tS(0,"p",46),jP(1,47),nS()),2&e){var n=fS(2);gb(1),WP(n.gameComponent.scores.get()[1]),ZP(1)}}function g_e(e,t){if(1&e){var n=oS();tS(0,"button",56),cS("click",function(){return Dk(n),fS(3).resign()}),jP(1,57),nS()}}function y_e(e,t){if(1&e){var n=oS();tS(0,"button",58),cS("click",function(){return Dk(n),fS(3).proposeDraw()}),jP(1,59),nS()}}function m_e(e,t){if(1&e){var n=oS();tS(0,"button",60),cS("click",function(){return Dk(n),fS(3).acceptDraw()}),jP(1,61),nS()}}function k_e(e,t){if(1&e){var n=oS();tS(0,"button",62),cS("click",function(){return Dk(n),fS(3).refuseDraw()}),jP(1,63),nS()}}function __e(e,t){if(1&e){var n=oS();tS(0,"button",64),cS("click",function(){return Dk(n),fS(3).gameComponent.pass()}),jP(1,65),nS()}}function C_e(e,t){if(1&e){var n=oS();tS(0,"button",66),cS("click",function(){return Dk(n),fS(3).acceptTakeBack()}),jP(1,67),nS()}}function w_e(e,t){if(1&e){var n=oS();tS(0,"button",68),cS("click",function(){return Dk(n),fS(3).refuseTakeBack()}),jP(1,69),nS()}}function b_e(e,t){if(1&e){var n=oS();tS(0,"button",70),cS("click",function(){return Dk(n),fS(3).askTakeBack()}),jP(1,71),nS()}}function E_e(e,t){if(1&e&&(iS(0),KE(1,g_e,2,0,"button",48),KE(2,y_e,2,0,"button",49),KE(3,m_e,2,0,"button",50),KE(4,k_e,2,0,"button",51),KE(5,__e,2,0,"button",52),KE(6,C_e,2,0,"button",53),KE(7,w_e,2,0,"button",54),KE(8,b_e,2,0,"button",55),aS()),2&e){var n=fS(2);gb(1),JE("ngIf",n.canResign()),gb(1),JE("ngIf",n.canProposeDraw()),gb(1),JE("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),gb(1),JE("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),gb(1),JE("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&n.currentPlayer===n.getPlayerName()),gb(1),JE("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),gb(1),JE("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),gb(1),JE("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function S_e(e,t){1&e&&(tS(0,"div"),tS(1,"p",73),jP(2,74),nS(),nS())}function P_e(e,t){1&e&&(tS(0,"p",78),jP(1,79),nS())}function O_e(e,t){1&e&&(tS(0,"p",80),jP(1,81),nS())}function T_e(e,t){1&e&&(tS(0,"p",82),jP(1,83),nS())}function I_e(e,t){if(1&e&&(tS(0,"div"),KE(1,P_e,2,0,"p",75),KE(2,O_e,2,0,"p",76),KE(3,T_e,2,0,"p",77),nS()),2&e){var n=fS(3);gb(1),JE("ngIf",n.currentPart.getDrawAccepter()===n.getPlayerName()),gb(1),JE("ngIf",n.currentPart.getDrawAccepter()!==n.getPlayerName()&&n.isPlaying()),gb(1),JE("ngIf",!1===n.isPlaying())}}function A_e(e,t){1&e&&(tS(0,"p",86),jP(1,87),nS())}function R_e(e,t){1&e&&(tS(0,"p",88),jP(1,89),nS())}function x_e(e,t){if(1&e&&(tS(0,"p",88),jP(1,90),nS()),2&e){var n=fS(4);gb(1),WP(n.currentPart.getWinner().get()),ZP(1)}}function M_e(e,t){if(1&e&&(tS(0,"div"),KE(1,A_e,2,0,"p",84),KE(2,R_e,2,0,"p",85),KE(3,x_e,2,1,"p",85),nS()),2&e){var n=fS(3);gb(1),JE("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),gb(1),JE("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),gb(1),JE("ngIf",!1===n.isPlaying())}}function N_e(e,t){if(1&e&&(tS(0,"p",86),jP(1,91),nS()),2&e){var n=fS(4);gb(1),WP(n.currentPart.getLoser().get()),ZP(1)}}function D_e(e,t){1&e&&(tS(0,"p",88),jP(1,92),nS())}function L_e(e,t){if(1&e&&(tS(0,"p",88),jP(1,93),nS()),2&e){var n=fS(4);gb(1),WP(n.currentPart.getLoser().get()),ZP(1)}}function F_e(e,t){if(1&e&&(tS(0,"div"),KE(1,N_e,2,1,"p",84),KE(2,D_e,2,0,"p",85),KE(3,L_e,2,1,"p",85),nS()),2&e){var n=fS(3);gb(1),JE("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),gb(1),JE("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),gb(1),JE("ngIf",!1===n.isPlaying())}}function U_e(e,t){1&e&&(tS(0,"p",95),jP(1,96),nS())}function V_e(e,t){if(1&e&&(tS(0,"p",95),jP(1,97),nS()),2&e){var n=fS(4);gb(1),WP(n.currentPart.getLoser().get()),ZP(1)}}function B_e(e,t){if(1&e&&(tS(0,"div"),KE(1,U_e,2,0,"p",94),KE(2,V_e,2,1,"p",94),nS()),2&e){var n=fS(3);gb(1),JE("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),gb(1),JE("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get()===n.getPlayerName())}}function z_e(e,t){if(1&e&&(tS(0,"div",72),rS(1,"hr"),KE(2,S_e,3,0,"div",26),KE(3,I_e,4,3,"div",26),KE(4,M_e,4,3,"div",26),KE(5,F_e,4,3,"div",26),KE(6,B_e,3,2,"div",26),nS()),2&e){var n=fS(2);gb(2),JE("ngIf",n.currentPart.isHardDraw()),gb(1),JE("ngIf",n.currentPart.isAgreedDraw()),gb(1),JE("ngIf",n.currentPart.isWin()),gb(1),JE("ngIf",n.currentPart.isTimeout()),gb(1),JE("ngIf",n.currentPart.isResign())}}function H_e(e,t){1&e&&(tS(0,"button",98),jP(1,99),nS())}function G_e(e,t){if(1&e){var n=oS();tS(0,"button",100),cS("click",function(){return Dk(n),fS(2).proposeRematch()}),jP(1,101),nS()}}function $_e(e,t){if(1&e){var n=oS();tS(0,"button",102),cS("click",function(){return Dk(n),fS(2).acceptRematch()}),jP(1,103),nS()}}function q_e(e,t){if(1&e){var n=oS();tS(0,"div",7),tS(1,"div",8),tS(2,"div",9),KE(3,h_e,4,2,"div",10),tS(4,"div",11),KE(5,f_e,2,2,"p",12),KE(6,d_e,2,1,"p",13),tS(7,"app-count-down",14,15),cS("outOfTimeAction",function(){return Dk(n),fS().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Dk(n),fS().addGlobalTime()}),nS(),tS(9,"app-count-down",16,17),cS("outOfTimeAction",function(){return Dk(n),fS().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Dk(n),fS().addTurnTime()}),nS(),nS(),tS(11,"p",18),jP(12,19),nS(),tS(13,"div",11),KE(14,v_e,2,2,"p",20),KE(15,p_e,2,1,"p",21),tS(16,"app-count-down",22,23),cS("outOfTimeAction",function(){return Dk(n),fS().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Dk(n),fS().addGlobalTime()}),nS(),tS(18,"app-count-down",24,25),cS("outOfTimeAction",function(){return Dk(n),fS().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Dk(n),fS().addTurnTime()}),nS(),nS(),rS(20,"hr"),KE(21,E_e,9,8,"ng-container",26),KE(22,z_e,7,5,"div",27),KE(23,H_e,2,0,"button",28),KE(24,G_e,2,0,"button",29),KE(25,$_e,2,0,"button",30),nS(),nS(),tS(26,"div",31),tS(27,"div",32),rS(28,"app-game-includer"),nS(),nS(),nS()}if(2&e){var r=fS();gb(3),JE("ngIf",r.currentPart),gb(2),JE("ngIf",r.players[0].isPresent()),gb(1),JE("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),gb(1),JE("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),gb(2),JE("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),gb(5),JE("ngIf",r.players[1].isPresent()),gb(1),JE("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),gb(1),JE("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),gb(2),JE("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),gb(3),JE("ngIf",r.isPlaying()),gb(1),JE("ngIf",r.endGame),gb(1),JE("ngIf",r.endGame),gb(1),JE("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),gb(1),JE("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),gb(1),JE("ngClass",r.getBoardHighlight())}}var j_e=function(){var e=Zg(function e(){jg(this,e)});return e.NO_MATCHING_PART=function(){return $localize(Ov||(Ov=bg(["The game you tried to join does not exist."])))},e}(),W_e=Zg(function e(t){jg(this,e),this.value=t});W_e.PRE_START_DOC=new W_e("PRE_START_DOC"),W_e.STARTING_DOC=new W_e("STARTING_DOC"),W_e.DUPLICATE=new W_e("DUPLICATE"),W_e.MOVE_WITHOUT_TIME=new W_e("MOVE_WITHOUT_TIME"),W_e.MOVE=new W_e("MOVE"),W_e.REQUEST=new W_e("REQUEST"),W_e.END_GAME=new W_e("END_GAME"),W_e.END_GAME_WITHOUT_TIME=new W_e("END_GAME_WITHOUT_TIME"),W_e.ACCEPT_TAKE_BACK_WITHOUT_TIME=new W_e("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Z_e=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s,u){var c;return jg(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=fB.empty(),c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(Tv||(Tv=bg(["5 minutes"]))),c.turnTimeMessage=$localize(Iv||(Iv=bg(["30 seconds"]))),uB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return Zg(n,[{key:"extractPartIdFromURL",value:function(){return sB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return sB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole===Fre.ZERO.value||this.observerRole===Fre.ONE.value}},{key:"getPlayer",value:function(){return Fre.of(this.observerRole)}},{key:"getPlayerName",value:function(){return sB.getNonNullable(this.authUser.username.get())}},{key:"isPlayer",value:function(e){return this.observerRole===e.value}},{key:"isOpponent",value:function(e){return this.observerRole!==e.value}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!$me.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=j_e.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=Pke.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return uB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=oB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof wN,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.getUserObs().subscribe(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:uB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),D7(!1===t.gameStarted,"Should not start already started game"),t.joiner=e,t.gameStarted=!0,window.setTimeout(oB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=D7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;uB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,(e=oB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return D7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new F7(t.currentPartId,e),uB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,uB(n.VERBOSE,a===W_e.REQUEST?"UpdateType: Request("+sB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===W_e.REQUEST?8:r.t0===W_e.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===W_e.DUPLICATE?12:r.t0===W_e.END_GAME_WITHOUT_TIME?13:r.t0===W_e.END_GAME?14:r.t0===W_e.MOVE_WITHOUT_TIME?15:r.t0===W_e.MOVE?16:r.t0===W_e.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(sB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:case 13:case 15:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 14:return r.abrupt("return",t.applyEndGame());case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void D7(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(D7(a===W_e.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(Fre.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=Tke.from(null!=this.currentPart?this.currentPart.data:null,e.data);uB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return W_e.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?W_e.ACCEPT_TAKE_BACK_WITHOUT_TIME:W_e.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?W_e.MOVE_WITHOUT_TIME:W_e.MOVE:null==t.modified.lastUpdateTime?W_e.MOVE_WITHOUT_TIME:W_e.MOVE;if(null==e.data.beginning)return W_e.PRE_START_DOC;if(e.data.result!==L7.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?W_e.END_GAME_WITHOUT_TIME:W_e.END_GAME}return D7(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),W_e.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);D7(null!=r,"TODO: OLD_TIME WAS NULL, UNDO COMMENT AND TEST!"),D7(null!=i,"TODO UPDATE_TIME WAS NULL, UNDO COMMENT AND TEST!");var a=Fre.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(sB.getNonNullable(r),sB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=Ake(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){uB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.joiner.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.joiner.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){this.switchPlayer();for(var t=zre.copyImmutableArray(e.data.listMoves),n=this.gameComponent.rules;n.node.gameState.turn<t.length;){var r=n.node.gameState.turn,i=this.gameComponent.encoder.decode(t[r]),a=n.isLegal(i,n.node.gameState),o="We received an incorrect db move: "+i.toString()+" in "+t+" at turn "+r+'because "'+a.getReasonOr("")+'"';D7(a.isSuccess(),o),n.choose(i)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){uB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=Fre.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(uB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=Fre.fromTurn(e.data.turn);this.endGame=!0,[L7.VICTORY,L7.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(D7(!0===[L7.RESIGN,L7.TIMEOUT,L7.HARD_DRAW,L7.AGREED_DRAW_BY_ZERO,L7.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),uB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){this.endGame=!0;var n=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,n,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){uB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);r===_oe.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(D7(r===_oe.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0;var i=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,i,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return D7(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.currentPart.data.request.data.player===this.getPlayer().getOpponent().value)&&this.getTakeBackRequester()===Lre.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return Lre.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?Ure.getPlayer(e):Lre.NONE}},{key:"canProposeDraw",value:function(){return D7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&Ure.getPlayer(this.currentPart.data.request)===this.getPlayer().getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===Lre.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==Lre.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return Lre.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?Ure.getPlayer(e):Lre.NONE}},{key:"onRequest",value:function(e,t){var r=this;return oB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(uB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:"AddGlobalTime"===i.t0?18:21;break;case 3:case 14:return i.abrupt("break",24);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",24);case 6:return r.rematchProposed=!0,a=Ure.getPlayer(e).getOpponent(),r.isPlayer(a)&&(uB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",24);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",Ure.getTypeGame(e),Ure.getPartId(e)]);case 15:return 3e4,o=Fre.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",24);case 18:return 3e5,s=Fre.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",24);case 21:return sB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=24,r.acceptDraw();case 24:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=Fre.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;uB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[fB.of(e.data.playerZero),fB.ofNullable(e.data.playerOne)],D7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=fB.empty();if(this.players[0].equalsValue(this.getPlayerName())?(this.observerRole=Fre.ZERO.value,r=this.players[1]):this.players[1].equalsValue(this.getPlayerName())?(this.observerRole=Fre.ONE.value,r=this.players[0]):this.observerRole=Lre.NONE.value,r.isPresent()){var i=function(e){t.opponent=e[0].data},a=new H7(i,i,function(e){throw new Error("OnlineGameWrapper: Opponent was deleted, what sorcery is this: "+JSON.stringify(e))});this.opponentSubscription=fB.of(this.userService.observeUserByUsername(r.get(),a))}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return oB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(uB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return oB(regeneratorRuntime.mark(function a(){var o,s,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=i.gameComponent.encoder.encodeMove(e),uB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),!(s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node)).isEndGame){a.next=5;break}return a.abrupt("return",s===_oe.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r));case 5:return u=i.getPlayer(),a.abrupt("return",i.gameService.updateDBBoard(i.currentPartId,u,o,t,r));case 7:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLastIndex(),r=e.getPlayer(),i=e.players[e.observerRole%2].get(),a=e.players[(e.observerRole+1)%2].get(),t.next=3,e.gameService.resign(e.currentPartId,n,r,a,i);case 3:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(uB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.getPlayer(),t.stopCountdownsFor(Fre.of(e)),o=sB.getNonNullable(t.opponent),e!==t.observerRole){r.next=10;break}return s=sB.getNonNullable(o.username),r.next=8,t.notifyTimeoutVictory(s,a,i,t.getPlayerName());case 8:r.next=15;break;case 10:if(D7(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=15;break}return u=sB.getNonNullable(o.username),r.next=14,t.notifyTimeoutVictory(t.getPlayerName(),a,e,u);case 14:t.endGame=!0;case 15:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new F7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.getPlayer());case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.getPlayer());case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptDraw",value:function(){return this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"refuseDraw",value:function(){return this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"askTakeBack",value:function(){return this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptTakeBack",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getPlayer(),t.next=3,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 3:e.msToSubstract=[0,0];case 4:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"startCountDownFor",value:function(e){uB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===Fre.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];uB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===Fre.ZERO?(this.chronoZeroGlobal.changeDuration(sB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(sB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.joiner.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];uB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===Fre.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){uB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===Fre.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":0===e?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return D7(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.getPlayer(),t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){var e=this.getPlayer();return this.gameService.addTurnTime(e,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=Fre.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===Fre.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===Fre.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving())}}]),n}(Oke);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(aO),XE(TD),XE(YL),XE(M7),XE(Tre),XE(q7),XE($re))},e.\u0275cmp=$m({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(AT(t_e,5),AT(n_e,5),AT(r_e,5),AT(i_e,5),AT(a_e,5),AT(o_e,5)),2&e)&&(IT(n=RT())&&(t.partCreation=n.first),IT(n=RT())&&(t.chatComponent=n.first),IT(n=RT())&&(t.chronoZeroGlobal=n.first),IT(n=RT())&&(t.chronoOneGlobal=n.first),IT(n=RT())&&(t.chronoZeroTurn=n.first),IT(n=RT())&&(t.chronoOneTurn=n.first))},features:[xE],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Av||(Av=bg(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Rv||(Rv=bg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(xv||(xv=bg(["It is your turn."]))),$localize(Mv||(Mv=bg(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(Nv||(Nv=bg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(Dv||(Dv=bg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Lv||(Lv=bg(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Fv||(Fv=bg(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Uv||(Uv=bg(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Vv||(Vv=bg(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Bv||(Bv=bg(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(zv||(zv=bg(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Hv||(Hv=bg(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(Gv||(Gv=bg(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize($v||($v=bg(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(qv||(qv=bg(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(jv||(jv=bg(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(Wv||(Wv=bg(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(Zv||(Zv=bg(["You won."]))),[1,"title"],$localize(Yv||(Yv=bg(["You lost."]))),$localize(Kv||(Kv=bg(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(Qv||(Qv=bg(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(Xv||(Xv=bg(["You reached your time limit."]))),$localize(Jv||(Jv=bg(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(ep||(ep=bg(["You resigned."]))),$localize(tp||(tp=bg(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(np||(np=bg(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(rp||(rp=bg(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(ip||(ip=bg(["Accept to play again"])))]},template:function(e,t){1&e&&(KE(0,s_e,2,1,"app-part-creation",0),KE(1,q_e,29,27,"div",1),tS(2,"div",2),tS(3,"div",3),rS(4,"app-chat",4),nS(),nS()),2&e&&(JE("ngIf",!1===t.gameStarted),gb(1),JE("ngIf",t.gameStarted),gb(3),JE("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[VA,dke,Xke,e_e,DA,Ske,QL],encapsulation:2}),e}();function Y_e(e,t){if(1&e&&(tS(0,"option",25),US(1),nS()),2&e){var n=t.$implicit;JE("value",n.name),gb(1),VS(n.name)}}function K_e(e,t){if(1&e&&(tS(0,"option",25),jP(1,29),nS()),2&e){var n=t.$implicit;JE("value",n),gb(1),WP(n),ZP(1)}}var Q_e=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function X_e(e,t){if(1&e){var n=oS();tS(0,"select",26),cS("ngModelChange",function(e){return Dk(n),fS(2).aiDepths[0]=e})("change",function(){return Dk(n),fS(2).updatePlayer(0)}),tS(1,"option",27),jP(2,28),nS(),KE(3,K_e,2,2,"option",16),nS()}2&e&&(JE("ngModel",fS(2).aiDepths[0]),gb(3),JE("ngForOf",oT(2,Q_e)))}function J_e(e,t){if(1&e&&(tS(0,"p",30),jP(1,31),nS()),2&e){var n=fS(2);gb(1),WP(n.gameComponent.scores.get()[0]),ZP(1)}}function eCe(e,t){if(1&e&&(tS(0,"option",25),US(1),nS()),2&e){var n=t.$implicit;JE("value",n.name),gb(1),VS(n.name)}}function tCe(e,t){if(1&e&&(tS(0,"option",25),jP(1,34),nS()),2&e){var n=t.$implicit;JE("value",n),gb(1),WP(n),ZP(1)}}function nCe(e,t){if(1&e){var n=oS();tS(0,"select",32),cS("ngModelChange",function(e){return Dk(n),fS(2).aiDepths[1]=e})("change",function(){return Dk(n),fS(2).updatePlayer(1)}),tS(1,"option",27),jP(2,33),nS(),KE(3,tCe,2,2,"option",16),nS()}2&e&&(JE("ngModel",fS(2).aiDepths[1]),gb(3),JE("ngForOf",oT(2,Q_e)))}function rCe(e,t){if(1&e&&(tS(0,"p",35),jP(1,36),nS()),2&e){var n=fS(2);gb(1),WP(n.gameComponent.scores.get()[1]),ZP(1)}}function iCe(e,t){if(1&e&&(tS(0,"h4"),jP(1,40),nS()),2&e){var n=fS(3);gb(1),WP(n.winner.get()),ZP(1)}}function aCe(e,t){1&e&&(tS(0,"h4",41),jP(1,42),nS())}function oCe(e,t){if(1&e&&(tS(0,"div",37),KE(1,iCe,2,1,"h4",38),KE(2,aCe,2,0,"h4",39),nS()),2&e){var n=fS(2);gb(1),JE("ngIf",n.winner.isPresent()),gb(1),JE("ngIf",n.winner.isAbsent())}}function sCe(e,t){if(1&e){var n=oS();tS(0,"div",6),tS(1,"div",7),tS(2,"p",8),jP(3,9),nS(),nS(),tS(4,"div",10),tS(5,"div",11),tS(6,"div",12),tS(7,"select",13),cS("change",function(){return Dk(n),fS().updatePlayer(0)})("ngModelChange",function(e){return Dk(n),fS().playerSelection[0]=e}),tS(8,"option",14),jP(9,15),nS(),KE(10,Y_e,2,2,"option",16),nS(),nS(),tS(11,"div",12),KE(12,X_e,4,3,"select",17),nS(),KE(13,J_e,2,1,"p",18),nS(),tS(14,"div",19),tS(15,"div",12),tS(16,"select",20),cS("change",function(){return Dk(n),fS().updatePlayer(1)})("ngModelChange",function(e){return Dk(n),fS().playerSelection[1]=e}),tS(17,"option",14),jP(18,21),nS(),KE(19,eCe,2,2,"option",16),nS(),nS(),tS(20,"div",12),KE(21,nCe,4,3,"select",22),nS(),KE(22,rCe,2,1,"p",23),nS(),nS(),KE(23,oCe,3,2,"div",24),nS()}if(2&e){var r=fS();gb(3),WP(r.gameComponent.rules.node.gameState.turn+1),ZP(3),gb(4),JE("ngModel",r.playerSelection[0]),gb(3),JE("ngForOf",r.gameComponent.availableMinimaxes),gb(2),JE("ngIf",!1===r.players[0].equalsValue("human")),gb(1),JE("ngIf",r.gameComponent.scores.isPresent()),gb(3),JE("ngModel",r.playerSelection[1]),gb(3),JE("ngForOf",r.gameComponent.availableMinimaxes),gb(2),JE("ngIf",!1===r.players[1].equalsValue("human")),gb(1),JE("ngIf",r.gameComponent.scores.isPresent()),gb(1),JE("ngIf",r.endGame)}}function uCe(e,t){if(1&e&&(iS(0),US(1),rS(2,"br"),aS()),2&e){var n=t.$implicit,r=fS(3);gb(1),BS(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function cCe(e,t){if(1&e&&(iS(0),KE(1,uCe,3,1,"ng-container",48),US(2),rS(3,"br"),US(4),rS(5,"br"),aS()),2&e){var n=fS(2);gb(1),JE("ngForOf",n.gameComponent.availableMinimaxes),gb(1),BS(" Created ",n.getCreatedNodes()," nodes."),gb(2),BS(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function lCe(e,t){if(1&e){var n=oS();tS(0,"button",49),cS("click",function(){return Dk(n),fS(2).gameComponent.pass()}),jP(1,50),nS()}}function hCe(e,t){if(1&e){var n=oS();tS(0,"button",51),cS("click",function(){return Dk(n),fS(2).takeBack()}),jP(1,52),nS()}}function fCe(e,t){if(1&e){var n=oS();tS(0,"div",43),KE(1,cCe,6,3,"ng-container",38),KE(2,lCe,2,0,"button",44),KE(3,hCe,2,0,"button",45),tS(4,"button",46),cS("click",function(){return Dk(n),fS().restartGame()}),jP(5,47),nS(),nS()}if(2&e){var r=fS();gb(1),JE("ngIf",r.gameComponent.rules.node.move),gb(1),JE("ngIf",!1===r.endGame&&r.gameComponent.canPass),gb(1),JE("ngIf",r.canTakeBack())}}var dCe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=fB.empty(),u.botTimeOut=1e3,u.players=[fB.of(u.playerSelection[0]),fB.of(u.playerSelection[1])],uB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return Zg(n,[{key:"getCreatedNodes",value:function(){return moe.createdNodes}},{key:"getMinimaxTime",value:function(){return moe.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e]=fB.of(this.playerSelection[e]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:uB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=fB.of($localize(ap||(ap=bg(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return fB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?fB.empty():fB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].equalsValue(n.name)}))}},{key:"doAIMove",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return D7((r=t.gameComponent.rules).getGameStatus(r.node)===_oe.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),A7.SUCCESS):(t.messageDisplayer.criticalMessage($localize(op||(op=bg(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),N7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new koe(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=fB.empty(),this.proposeAIToPlay()}},{key:"getPlayerName",value:function(){return"human"}}]),n}(Oke);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(aO),XE(TD),XE(Tre),XE(YL),XE(M7),XE(DO))},e.\u0275cmp=$m({type:e,selectors:[["app-local-game-wrapper"]],features:[xE],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(sp||(sp=bg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(up||(up=bg(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(cp||(cp=bg(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(lp||(lp=bg(["Pick the level"]))),$localize(hp||(hp=bg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(fp||(fp=bg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(dp||(dp=bg(["Pick the level"]))),$localize(vp||(vp=bg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(pp||(pp=bg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(gp||(gp=bg(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(yp||(yp=bg(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(mp||(mp=bg(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(kp||(kp=bg(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(_p||(_p=bg(["Take back move"])))]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"div",1),KE(2,sCe,24,10,"div",2),KE(3,fCe,6,3,"div",3),nS(),tS(4,"div",4),tS(5,"div",5),rS(6,"app-game-includer"),nS(),nS(),nS()),2&e&&(gb(2),JE("ngIf",t.gameComponent),gb(1),JE("ngIf",t.gameComponent),gb(1),JE("ngClass",t.getBoardHighlight()))},directives:[VA,DA,Ske,oM,gx,Zx,sM,hM,FA],encapsulation:2,changeDetection:0}),e}(),vCe=function(){var e=Zg(function e(){jg(this,e)});return e.STEP_FINISHED=function(){return $localize(Cp||(Cp=bg(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(wp||(wp=bg(["This step is not expecting any move from your part."])))},e}();function pCe(e,t){if(1&e&&(tS(0,"div",20),tS(1,"div",21),jP(2,22),nS(),tS(3,"div",23),US(4),nS(),nS()),2&e){var n=fS();gb(4),VS(n.currentReason.get())}}function gCe(e,t){if(1&e){var n=oS();tS(0,"button",24),cS("click",function(){return Dk(n),fS().retry()}),jP(1,25),nS()}}function yCe(e,t){1&e&&(iS(0),jP(1,30),aS())}function mCe(e,t){1&e&&(iS(0),jP(1,31),aS())}function kCe(e,t){if(1&e&&KE(0,mCe,2,0,"ng-container",27),2&e){fS();var n=QE(5),r=fS();JE("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function _Ce(e,t){1&e&&(iS(0),jP(1,32),aS())}function CCe(e,t){if(1&e){var n=oS();tS(0,"button",26),cS("click",function(){return Dk(n),fS().next()}),KE(1,yCe,2,0,"ng-container",27),KE(2,kCe,1,2,"ng-template",null,28,MT),KE(4,_Ce,2,0,"ng-template",null,29,MT),nS()}if(2&e){var r=QE(3),i=fS();gb(1),JE("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function wCe(e,t){if(1&e){var n=oS();tS(0,"button",33),cS("click",function(){return Dk(n),fS().start()}),jP(1,34),nS()}}function bCe(e,t){if(1&e){var n=oS();tS(0,"button",35),cS("click",function(){return Dk(n),fS().playLocally()}),jP(1,36),nS()}}function ECe(e,t){if(1&e){var n=oS();tS(0,"button",37),cS("click",function(){return Dk(n),fS().createGame()}),jP(1,38),nS()}}function SCe(e,t){if(1&e){var n=oS();tS(0,"button",39),cS("click",function(){return Dk(n),fS().showSolution()}),jP(1,40),nS()}}function PCe(e,t){if(1&e&&(iS(0),tS(1,"option",42),US(2),nS(),aS()),2&e){var n=fS(),r=n.index,i=n.$implicit;gb(1),vS("id","step_",r,""),JE("value",r),gb(1),VS(i.title)}}function OCe(e,t){1&e&&(iS(0),US(1,"v "),aS())}function TCe(e,t){1&e&&US(0,"x ")}function ICe(e,t){if(1&e&&(tS(0,"option",43),KE(1,OCe,2,0,"ng-container",27),KE(2,TCe,1,0,"ng-template",null,44,MT),tS(4,"span",45),US(5),nS(),nS()),2&e){var n=QE(3),r=fS(),i=r.index,a=r.$implicit,o=fS();JE("value",i),gb(1),JE("ngIf",o.stepFinished[i])("ngIfElse",n),gb(3),vS("id","step_",i,""),gb(1),VS(a.title)}}function ACe(e,t){if(1&e&&(iS(0),KE(1,PCe,3,3,"ng-container",27),KE(2,ICe,6,5,"ng-template",null,41,MT),aS()),2&e){var n=t.index,r=QE(3),i=fS();gb(1),JE("ngIf",n===i.stepIndex)("ngIfElse",r)}}var RCe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r,i,a,o,s){var u;return jg(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(bp||(bp=bg(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=fB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,uB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u}return Zg(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return uB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){uB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){uB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=fB.empty(),this.gameComponent.rules.node=new koe(t.state,fB.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:uB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],D7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),uB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.gameState,(o=sB.getNonNullable(i.predicate)(e,a)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=fB.of(o.getReason())):i.isAnyMove()?(uB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(D7(i.isMove(),"cannot reach here with a click step"),(s=i).acceptedMoves.some(function(t){return t.equals(e)})?(uB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(uB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=fB.of(s.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){uB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(uB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=fB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return A7.failure(vCe.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,sB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),A7.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),A7.SUCCESS):A7.failure(vCe.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){uB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=fB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){uB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=Gg(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:uB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),D7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof foe?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=sB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=sB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayerName",value:function(){return""}}]),n}(Oke);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(XE(aO),XE(TD),XE(YL),XE(M7),XE(DO),XE(Tre))},e.\u0275cmp=$m({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[xE],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Ep||(Ep=bg(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Sp||(Sp=bg(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Pp||(Pp=bg(["Ok"]))),$localize(Op||(Op=bg(["Continue"]))),$localize(Tp||(Tp=bg(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Ip||(Ip=bg(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Ap||(Ap=bg(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Rp||(Rp=bg(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(xp||(xp=bg(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"div",1),tS(2,"div",2),rS(3,"progress",3),tS(4,"div",4),tS(5,"p",5),US(6),nS(),rS(7,"p",6),nS(),KE(8,pCe,5,1,"div",7),tS(9,"div",8),KE(10,gCe,2,0,"button",9),KE(11,CCe,6,2,"button",10),KE(12,wCe,2,0,"button",11),KE(13,bCe,2,0,"button",12),KE(14,ECe,2,0,"button",13),KE(15,SCe,2,0,"button",14),tS(16,"div",15),tS(17,"select",16),cS("change",function(e){return t.changeStep(e)}),KE(18,ACe,4,2,"ng-container",17),nS(),nS(),nS(),nS(),nS(),tS(19,"div",18),tS(20,"div",19),rS(21,"app-game-includer"),nS(),nS(),nS()),2&e&&(gb(3),qE("value",t.successfulSteps)("max",t.getNumberOfSteps()),gb(3),HS("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),gb(1),JE("innerHTML",t.currentMessage,uw),gb(1),JE("ngIf",t.currentReason.isPresent()),gb(2),JE("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),gb(1),JE("ngIf",!1===t.tutorialOver),gb(1),JE("ngIf",t.tutorialOver),gb(1),JE("ngIf",t.tutorialOver),gb(1),JE("ngIf",t.tutorialOver),gb(1),JE("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),gb(3),JE("ngForOf",t.steps),gb(1),JE("ngClass",t.getBoardHighlight()))},directives:[VA,FA,DA,Ske,sM,hM],encapsulation:2,changeDetection:0}),e}();function xCe(e,t){if(1&e&&(tS(0,"div",35),tS(1,"div",36),jP(2,37),nS(),tS(3,"div",38),US(4),nS(),nS()),2&e){var n=fS();gb(4),VS(n.errorMessage)}}var MCe=function(){return["/login"]},NCe=function(){var e=function(){function e(t,n){jg(this,e),this.authService=t,this.router=n,this.faEye=eie,this.registrationForm=new zx({email:new Bx,username:new Bx,password:new Bx})}return Zg(e,[{key:"registerWithEmail",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Mp||(Mp=bg(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(Tre),XE(YL))},e.\u0275cmp=$m({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(Np||(Np=bg(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Dp||(Dp=bg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(Lp||(Lp=bg(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(Fp||(Fp=bg(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(Up||(Up=bg(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(Vp||(Vp=bg(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(Bp||(Bp=bg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(zp||(zp=bg(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(Hp||(Hp=bg(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Gp||(Gp=bg(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize($p||($p=bg(["Register with Google"]))),[1,"help","level-right"],$localize(qp||(qp=bg(["Have an account?"]))),[3,"routerLink"],$localize(jp||(jp=bg(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Wp||(Wp=bg(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"p",1),jP(2,2),nS(),tS(3,"form",3),tS(4,"div",4),tS(5,"div",5),tS(6,"label",6),jP(7,7),nS(),nS(),tS(8,"div",8),tS(9,"div",9),tS(10,"div",10),rS(11,"input",11),tS(12,"p",12),jP(13,13),nS(),nS(),nS(),nS(),nS(),tS(14,"div",4),tS(15,"div",5),tS(16,"label",14),jP(17,15),nS(),nS(),tS(18,"div",8),tS(19,"div",9),tS(20,"div",10),rS(21,"input",16),nS(),nS(),nS(),nS(),tS(22,"div",4),tS(23,"div",5),tS(24,"label",17),jP(25,18),nS(),nS(),tS(26,"div",8),tS(27,"div",9),tS(28,"div",19),rS(29,"input",20),tS(30,"span",21),rS(31,"fa-icon",22),nS(),tS(32,"p",23),jP(33,24),nS(),nS(),nS(),nS(),nS(),tS(34,"div",4),rS(35,"div",5),tS(36,"div",8),tS(37,"div",9),tS(38,"div",10),tS(39,"button",25),cS("click",function(){return t.registerWithEmail()}),jP(40,26),nS(),nS(),nS(),nS(),nS(),tS(41,"div",4),rS(42,"div",5),tS(43,"div",27),KE(44,xCe,5,1,"div",28),nS(),nS(),tS(45,"div",4),rS(46,"div",5),tS(47,"div",8),tS(48,"button",29),cS("click",function(){return t.registerWithGoogle()}),jP(49,30),nS(),nS(),nS(),tS(50,"p",31),iS(51),jP(52,32),aS(),US(53,"\xa0 "),tS(54,"a",33),jP(55,34),nS(),nS(),nS(),nS()),2&e&&(gb(3),JE("formGroup",t.registrationForm),gb(28),JE("icon",t.faEye),gb(1),JE("ngClass",t.getPasswordHelpClass()),gb(7),JE("disabled",!t.canRegister()),gb(5),JE("ngIf",t.errorMessage),gb(10),JE("routerLink",oT(6,MCe)))},directives:[Yx,yx,tM,BR,gx,rM,Kme,dM,Oae,Qme,DA,VA,XL],encapsulation:2}),e}(),DCe=function(){var e=function(){function e(t){jg(this,e),this.router=t}return Zg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL))},e.\u0275cmp=$m({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Zp||(Zp=bg(["Play offline"])))]},template:function(e,t){1&e&&(tS(0,"app-pick-game",0),cS("pickGame",function(e){return t.pickGame(e)}),nS(),tS(1,"button",1),cS("click",function(){return t.playLocally()}),jP(2,2),nS()),2&e&&(gb(1),JE("disabled",!t.selectedGame))},directives:[qme],encapsulation:2}),e}(),LCe=function(){var e=function(){function e(t){jg(this,e),this.router=t}return Zg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(YL))},e.\u0275cmp=$m({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Yp||(Yp=bg(["Learn the rules"])))]},template:function(e,t){1&e&&(tS(0,"app-pick-game",0),cS("pickGame",function(e){return t.pickGame(e)}),nS(),tS(1,"button",1),cS("click",function(){return t.launchTutorial()}),jP(2,2),nS()),2&e&&(gb(1),JE("disabled",!t.selectedGame))},directives:[qme],encapsulation:2}),e}(),FCe=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=$m({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(Kp||(Kp=bg(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(tS(0,"p"),jP(1,0),nS())},encapsulation:2}),e}();function UCe(e,t){if(1&e&&(l_(),rS(0,"polygon",4)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("points",n.MartianChessQueenComponent.HEPTAGON)}}function VCe(e,t){if(1&e&&(l_(),rS(0,"polygon",4)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function BCe(e,t){if(1&e&&(l_(),rS(0,"circle",5)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function zCe(e,t){if(1&e&&(iS(0),l_(),rS(1,"circle",6),rS(2,"circle",6),rS(3,"circle",6),aS()),2&e){var n=fS();gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function HCe(e,t){if(1&e&&(l_(),tS(0,"g"),rS(1,"circle",7),rS(2,"circle",7),rS(3,"circle",7),nS()),2&e){var n=fS();gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),gb(1),qE("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),gb(1),qE("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function GCe(e,t){if(1&e&&(l_(),tS(0,"g",8),rS(1,"circle",9),rS(2,"circle",9),rS(3,"circle",9),nS()),2&e){var n=fS();JE("ngClass",n.pieceClasses),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var $Ce=Zg(function e(){jg(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=Fde,this.horizontalDotsRadius=Fde.SPACE_SIZE/15});function qCe(e,t){if(1&e&&(l_(),rS(0,"polygon",4)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("points",n.MartianChessDroneComponent.PENTAGON)}}function jCe(e,t){if(1&e&&(l_(),rS(0,"polygon",4)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function WCe(e,t){if(1&e&&(l_(),rS(0,"circle",5)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function ZCe(e,t){if(1&e&&(iS(0),l_(),rS(1,"circle",6),rS(2,"circle",6),aS()),2&e){var n=fS();gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function YCe(e,t){if(1&e&&(l_(),tS(0,"g",7),rS(1,"circle",8),rS(2,"circle",8),nS()),2&e){var n=fS();JE("ngClass",n.pieceClasses),gb(1),qE("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),gb(1),qE("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function KCe(e,t){if(1&e&&(l_(),tS(0,"g",7),rS(1,"circle",9),rS(2,"circle",9),nS()),2&e){var n=fS();JE("ngClass",n.pieceClasses),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}$Ce.HEPTAGON=Fde.getRegularPolygon(7),$Ce.EIGHT_POINTED_STAR=Fde.getNPointedStar(8,0),$Ce.\u0275fac=function(e){return new(e||$Ce)},$Ce.\u0275cmp=$m({type:$Ce,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(KE(0,UCe,1,3,"polygon",0),KE(1,VCe,1,3,"polygon",0),KE(2,BCe,1,5,"circle",1),KE(3,zCe,4,9,"ng-container",2),KE(4,HCe,4,9,"g",2),KE(5,GCe,4,10,"g",3)),2&e&&(JE("ngIf","Polygon"===t.style.shape),gb(1),JE("ngIf","Star"===t.style.shape),gb(1),JE("ngIf","Circle"===t.style.shape),gb(1),JE("ngIf","Concentric Circles"===t.style.points),gb(1),JE("ngIf","Dots"===t.style.points),gb(1),JE("ngIf","Horizontal Points"===t.style.points))},directives:[VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var QCe=Zg(function e(){jg(this,e),this.MartianChessComponent=Fde,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=Fde.SPACE_SIZE/15});function XCe(e,t){if(1&e&&(l_(),rS(0,"polygon",5)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("points",n.MartianChessPawnComponent.TRIANGLE)}}function JCe(e,t){if(1&e&&(l_(),rS(0,"polygon",5)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function ewe(e,t){if(1&e&&(l_(),rS(0,"circle",6)),2&e){var n=fS();JE("id",n.mainShapeId)("ngClass",n.pieceClasses),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function twe(e,t){if(1&e&&(l_(),rS(0,"circle",7)),2&e){var n=fS();qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function nwe(e,t){if(1&e&&(l_(),rS(0,"circle",8)),2&e){var n=fS();qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function rwe(e,t){if(1&e&&(l_(),tS(0,"g",9),rS(1,"circle",10),nS()),2&e){var n=fS();JE("ngClass",n.pieceClasses),gb(1),qE("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}QCe.FOUR_POINTED_STAR_VERTICAL=Fde.getNPointedStar(4,0),QCe.PENTAGON=Fde.getRegularPolygon(5),QCe.\u0275fac=function(e){return new(e||QCe)},QCe.\u0275cmp=$m({type:QCe,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(KE(0,qCe,1,3,"polygon",0),KE(1,jCe,1,3,"polygon",0),KE(2,WCe,1,5,"circle",1),KE(3,ZCe,3,6,"ng-container",2),KE(4,YCe,3,7,"g",3),KE(5,KCe,3,7,"g",3)),2&e&&(JE("ngIf","Polygon"===t.style.shape),gb(1),JE("ngIf","Star"===t.style.shape),gb(1),JE("ngIf","Circle"===t.style.shape),gb(1),JE("ngIf","Concentric Circles"===t.style.points),gb(1),JE("ngIf","Dots"===t.style.points),gb(1),JE("ngIf","Horizontal Points"===t.style.points))},directives:[VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var iwe=function(){function e(){jg(this,e),this.MartianChessComponent=Fde,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=Fde.SPACE_SIZE/15}return Zg(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return Fde.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=Fde.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();iwe.FOUR_POINTED_STAR_DIAGONAL=Fde.getNPointedStar(4,45),iwe.TRIANGLE_Y_OFFSET=iwe.yOffsetForVerticalCentering(),iwe.TRIANGLE=iwe.getTriangle(),iwe.\u0275fac=function(e){return new(e||iwe)},iwe.\u0275cmp=$m({type:iwe,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(KE(0,XCe,1,3,"polygon",0),KE(1,JCe,1,3,"polygon",0),KE(2,ewe,1,5,"circle",1),KE(3,twe,1,3,"circle",2),KE(4,nwe,1,3,"circle",3),KE(5,rwe,2,4,"g",4)),2&e&&(JE("ngIf","Polygon"===t.style.shape),gb(1),JE("ngIf","Star"===t.style.shape),gb(1),JE("ngIf","Circle"===t.style.shape),gb(1),JE("ngIf","Concentric Circles"===t.style.points),gb(1),JE("ngIf","Dots"===t.style.points),gb(1),JE("ngIf","Horizontal Points"===t.style.points))},directives:[VA,DA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var awe={production:!0,test:!1,root:"/",firebaseConfig:{apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631"},useEmulators:!1},owe=function(){var e=function(){function e(t){jg(this,e),this.authService=t}return Zg(e,[{key:"canActivate",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.getUserObs().subscribe((n=oB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(gC(Tre))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),swe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e)).router=r,i}return Zg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(owe);return e.\u0275fac=function(t){return new(t||e)(gC(Tre),gC(YL))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function uwe(e,t){1&e&&(tS(0,"p",20),jP(1,21),nS())}function cwe(e,t){if(1&e){var n=oS();tS(0,"div",7),tS(1,"p",8),jP(2,9),nS(),tS(3,"div",10),tS(4,"p",11),jP(5,12),nS(),tS(6,"button",13),cS("click",function(){return Dk(n),fS().finalizeEmailVerification()}),jP(7,14),nS(),nS(),tS(8,"div",15),tS(9,"p",11),jP(10,16),nS(),tS(11,"button",17),cS("click",function(){return Dk(n),fS().sendEmailVerification()}),jP(12,18),nS(),nS(),KE(13,uwe,2,0,"p",19),nS()}if(2&e){var r=fS();gb(2),WP(r.emailAddress),ZP(2),gb(11),JE("ngIf",r.success)}}function lwe(e,t){if(1&e){var n=oS();tS(0,"div",24),tS(1,"div",8),jP(2,25),nS(),tS(3,"form",26),tS(4,"div",27),tS(5,"div",28),rS(6,"input",29),nS(),tS(7,"div",28),tS(8,"button",30),cS("click",function(){Dk(n);var e=fS(2);return e.pickUsername(e.usernameForm.value)}),jP(9,31),nS(),nS(),nS(),nS(),nS()}if(2&e){var r=fS(2);gb(3),JE("formGroup",r.usernameForm)}}var hwe=function(){return["/lobby"]};function fwe(e,t){1&e&&(tS(0,"div",32),$P(1,33),rS(2,"a",34),qP(),nS()),2&e&&(gb(2),JE("routerLink",oT(1,hwe)))}function dwe(e,t){if(1&e&&(iS(0),KE(1,lwe,10,1,"div",22),KE(2,fwe,3,2,"div",23),aS()),2&e){var n=fS();gb(1),JE("ngIf",!n.success),gb(1),JE("ngIf",n.success)}}function vwe(e,t){if(1&e&&(tS(0,"div",35),tS(1,"div",36),US(2),nS(),nS()),2&e){var n=fS();gb(2),VS(n.errorMessage)}}var pwe=function(){var e=function(){function e(t,n){jg(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new zx({username:new Bx})}return Zg(e,[{key:"ngOnInit",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.getUserObs().subscribe(function(){var t=oB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(Qp||(Qp=bg(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(Tre),XE(YL))},e.\u0275cmp=$m({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(Xp||(Xp=bg(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(Jp||(Jp=bg(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(eg||(eg=bg(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(tg||(tg=bg(["Finalize email verification"]))),[1,"level-left"],$localize(ng||(ng=bg(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(rg||(rg=bg(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(ig||(ig=bg(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(ag||(ag=bg(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(og||(og=bg(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(sg||(sg=bg(["Pick username"]))),["id","success",1,"message-body"],$localize(ug||(ug=bg(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"div",1),tS(2,"div",2),jP(3,3),nS(),KE(4,cwe,14,2,"div",4),KE(5,dwe,3,2,"ng-container",5),nS(),KE(6,vwe,3,1,"div",6),nS()),2&e&&(gb(4),JE("ngIf","send-email"===t.verificationType),gb(1),JE("ngIf","enter-username"===t.verificationType),gb(1),JE("ngIf",t.errorMessage))},directives:[VA,Yx,yx,tM,BR,dM,gx,rM,XL],encapsulation:2}),e}(),gwe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e)).router=r,i}return Zg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(owe);return e.\u0275fac=function(t){return new(t||e)(gC(Tre),gC(YL))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ywe=function(){var e=function(e){Ng(n,e);var t=Lg(n);function n(e,r){var i;return jg(this,n),(i=t.call(this,e)).router=r,i}return Zg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(owe);return e.\u0275fac=function(t){return new(t||e)(gC(Tre),gC(YL))},e.\u0275prov=vm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function mwe(e,t){1&e&&(tS(0,"p",12),jP(1,13),nS())}function kwe(e,t){if(1&e&&(tS(0,"div",14),tS(1,"div",15),jP(2,16),nS(),tS(3,"div",17),US(4),nS(),nS()),2&e){var n=fS();gb(4),VS(n.errorMessage.get())}}var _we=function(){return{standalone:!0}},Cwe=function(){var e=function(){function e(t){jg(this,e),this.authService=t,this.success=!1,this.errorMessage=fB.empty(),this.email=""}return Zg(e,[{key:"resetPassword",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return D7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=fB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=fB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(Tre))},e.\u0275cmp=$m({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(cg||(cg=bg(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(lg||(lg=bg(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(hg||(hg=bg(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(fg||(fg=bg(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(dg||(dg=bg(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(vg||(vg=bg(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"p",1),jP(2,2),nS(),tS(3,"div",3),tS(4,"div",4),tS(5,"input",5),cS("ngModelChange",function(e){return t.email=e}),nS(),tS(6,"p",6),jP(7,7),nS(),KE(8,mwe,2,0,"p",8),nS(),nS(),tS(9,"button",9),cS("click",function(){return t.resetPassword()}),jP(10,10),nS(),KE(11,kwe,5,1,"div",11),nS()),2&e&&(gb(5),JE("ngModel",t.email)("ngModelOptions",oT(5,_we)),gb(3),JE("ngIf",t.success),gb(1),JE("disabled",""===t.email),gb(2),JE("ngIf",t.errorMessage.isPresent()))},directives:[BR,Kme,dM,gx,Zx,VA],encapsulation:2}),e}();function wwe(e,t){if(1&e&&(tS(0,"option",13),US(1),nS()),2&e){var n=t.$implicit,r=fS();JE("value",n.value)("selected",n.value===r.currentTheme),gb(1),BS(" ",n.name," ")}}function bwe(e,t){if(1&e&&(tS(0,"option",13),US(1),nS()),2&e){var n=t.$implicit,r=fS();JE("value",n.value)("selected",n.value===r.currentLanguage),gb(1),BS(" ",n.name," ")}}var Ewe=function(){var e=function(){function e(t,n){jg(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(pg||(pg=bg(["Light"])))},{value:"dark",name:$localize(gg||(gg=bg(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return Zg(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(Yre),XE(Kre))},e.\u0275cmp=$m({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(yg||(yg=bg(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(mg||(mg=bg(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(kg||(kg=bg(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(tS(0,"div",0),tS(1,"p",1),jP(2,2),nS(),tS(3,"div",3),tS(4,"label",4),jP(5,5),nS(),tS(6,"div",6),tS(7,"div",7),tS(8,"select",8),cS("change",function(e){return t.changeTheme(e)}),KE(9,wwe,2,3,"option",9),nS(),nS(),nS(),nS(),tS(10,"div",3),tS(11,"label",10),jP(12,11),nS(),tS(13,"div",6),tS(14,"div",7),tS(15,"select",12),cS("change",function(e){return t.changeLanguage(e)}),KE(16,bwe,2,3,"option",9),nS(),nS(),nS(),nS(),nS()),2&e&&(gb(9),JE("ngForOf",t.availableThemes),gb(7),JE("ngForOf",t.availableLanguages))},directives:[FA,sM,hM],encapsulation:2}),e}(),Swe=function(){var e=Zg(function e(){jg(this,e)});return e.ALREADY_INGAME=function(){return $localize(_g||(_g=bg(["You are already in a game. Finish it or cancel it first."])))},e}(),Pwe=function(){var e=function(){function e(t,n,r,i,a,o){jg(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.partDAO=a,this.gameService=o}return Zg(e,[{key:"ngOnInit",value:function(){var e=this;return oB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return sB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(D7((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",Pke.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:case 19:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i.name);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartJoinerAndChat(i,e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(Swe.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return fB.ofNullable($me.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return oB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.partDAO.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(XE(TD),XE(YL),XE(Tre),XE(M7),XE(U7),XE($re))},e.\u0275cmp=$m({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Cg||(Cg=bg(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(tS(0,"p"),jP(1,0),nS())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[KS.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),jS[t]=e,n&&(jS[t][KS.ExtraData]=n)}(e,void 0,void 0)}(iB());var Owe=[{path:"login",component:tke},{path:"lobby",component:wke,canActivate:[swe]},{path:"settings",component:Ewe},{path:"register",component:NCe,canActivate:[ywe]},{path:"reset-password",component:Cwe,canActivate:[ywe]},{path:"notFound/:message",component:bke},{path:"nextGameLoading",component:FCe,canActivate:[swe]},{path:"verify-account",component:pwe,canActivate:[gwe]},{path:"play",component:rke,canActivate:[swe]},{path:"play/:compo",component:Pwe,canActivate:[swe]},{path:"play/:compo/:id",component:Z_e,canActivate:[swe]},{path:"local",component:DCe},{path:"local/:compo",component:dCe},{path:"tutorial",component:LCe},{path:"tutorial/:compo",component:RCe},{path:"",component:Yme},{path:"**",component:bke}],Twe=function(){function e(){jg(this,e)}return Zg(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:ej,providers:[{provide:Kq,useFactory:Jq(e),multi:!0,deps:[tI,AE,zq].concat(n)}]}}(function(){return awe.useEmulators&&(awe.firebaseConfig.databaseURL="http://localhost:9000?ns=default"),tj(awe.firebaseConfig)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:l7,providers:[{provide:o7,useFactory:s7(e),multi:!0,deps:[tI,AE,zq,Yq,[new EC,YY],[new EC,Nj]].concat(n)}]}}(function(){var e=m7(),t=e.toJSON().settings.host;return awe.useEmulators&&"localhost:8080"!==t&&d7(e,"localhost",8080),e})}},{key:"database",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:kre,providers:[{provide:pre,useFactory:gre(e),multi:!0,deps:[tI,AE,zq,Yq,[new EC,YY],[new EC,Nj]].concat(n)}]}}(function(){var e=Cre();return awe.useEmulators&&!1===e._instanceStarted&&_re(e,"localhost",9e3),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:tK,providers:[{provide:KY,useFactory:QY(e),multi:!0,deps:[tI,AE,zq,Yq,[new EC,Nj]].concat(n)}]}}(function(){var e=iK();return awe.useEmulators&&null==e.config.emulator&&nK(e,"http://localhost:9099",{disableWarnings:!0}),e})}}]),e}(),Iwe=function(){var e=Zg(function e(){jg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Zm({type:e,bootstrap:[Hae]}),e.\u0275inj=pm({providers:[Tre,$re,Gre,q7,z7,U7,Kre,{provide:GT,useValue:Zre.getLocale()}],imports:[[Twe.app(),Twe.firestore(),Twe.auth(),Twe.database(),PR,nN,lF.forRoot(Owe,{useHash:!1}),mM,yM,nB,Tae]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map(qm)},r.pipeDefs=function(){return n.map(jm)}}(Fde,[FA,DA,VA,iwe,QCe,$Ce],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var Awe=function(){function e(t){jg(this,e),this.digits=t}return Zg(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),Rwe=function(){function e(t){jg(this,e),this.powerOfTwos=[t]}return Zg(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=Awe.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),xwe=function(){function e(t){jg(this,e),this.base=t,this.exponents=[new Rwe(Awe.one())]}return Zg(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new Rwe(n)}return this.exponents[e]}}]),e}();function Mwe(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=Nwe(t,0),r=Nwe(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Nwe(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=Dwe(r=Fwe(r,zwe(e,n,Lwe.Little)),i=Fwe(i,zwe(e,n+4,Lwe.Little)),t=Fwe(t,zwe(e,n+8,Lwe.Little)));r=o[0],i=o[1],t=o[2]}return r=Fwe(r,zwe(e,n,Lwe.Little)),i=Fwe(i,zwe(e,n+4,Lwe.Little)),t=Fwe(t,a),Dwe(r,i,t=Fwe(t,zwe(e,n+8,Lwe.Little)<<8))[2]}function Dwe(e,t,n){return e=Vwe(e,t),e=Vwe(e,n),e^=n>>>13,t=Vwe(t,n),t=Vwe(t,e),t^=e<<8,n=Vwe(n,e),n=Vwe(n,t),n^=t>>>13,e=Vwe(e,t),e=Vwe(e,n),e^=n>>>12,t=Vwe(t,n),t=Vwe(t,e),t^=e<<16,n=Vwe(n,e),n=Vwe(n,t),n^=t>>>5,e=Vwe(e,t),e=Vwe(e,n),e^=n>>>3,t=Vwe(t,n),t=Vwe(t,e),t^=e<<10,n=Vwe(n,e),n=Vwe(n,t),[e,t,n^=t>>>15]}var Lwe=((Lwe=Lwe||{})[Lwe.Little=0]="Little",Lwe[Lwe.Big=1]="Big",Lwe);function Fwe(e,t){return Uwe(e,t)[1]}function Uwe(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function Vwe(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Bwe(e,t){return t>=e.length?0:e[t]}function zwe(e,t,n){var r=0;if(n===Lwe.Big)for(var i=0;i<4;i++)r+=Bwe(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Bwe(e,t+a)<<8*a;return r}var Hwe=new xwe(256);function Gwe(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function $we(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var qwe=function(e){Ng(n,e);var t=Lg(n);function n(e){var r;return jg(this,n),(r=t.call(this,"No translation found for ".concat(Wwe(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return Zg(n)}(Ag(Error));function jwe(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Wwe(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Zwe(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=Gwe(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=wg(i.split("\u241f")),o=a[0],s=a.slice(1),u=Og(o.split("@@",2),2),c=u[0],l=u[1],h=Og(c.split("|",2),2),f=h[0],d=h[1];return void 0===d&&(d=f,f=void 0),""===d&&(d=void 0),{text:r,meaning:f,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,h=1;h<e.length;h++){var f=Gwe(e[h],e.raw[h]),d=f.text,v=f.block,p=void 0===v?$we(h):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[h-1],o[p]=i[h-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Mwe(e);if(t){var r=Mwe(t);n=function(e,t){var n=e[0],r=t[0],i=Uwe(e[1],t[1]),a=i[0],o=i[1];return[Fwe(Fwe(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=Hwe.toThePowerOf(0).multiplyBy(t);return Hwe.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new qwe(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(Wwe(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Ywe(){awe.production&&function(){if(dI)throw new Error("Cannot enable prod mode after platform setup.");fI=!1}(),ER().bootstrapModule(Iwe).catch(function(e){return console.error(e)})}var Kwe=Zre.getLocale();"en"!==Kwe?fetch(awe.root+"assets/"+Kwe+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Zwe),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:jwe(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Ywe()}).catch(function(e){console.log(e)}):Ywe()}},function(e){e(e.s=5615)}])}();